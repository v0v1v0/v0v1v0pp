<div class="container">

<table style="width: 100%;"><tr>
<td>pai</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>Predictive Accuracy Index</h2>

<h3>Description</h3>

<p>Given a set of predictions and observed counts, returns the PAI (predictive accuracy index),
PEI (predictive efficiency index), and the RRI (recovery rate index)
</p>


<h3>Usage</h3>

<pre><code class="language-R">pai(dat, count, pred, area, other = c())
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>dat</code></td>
<td>
<p>data frame with the predictions, observed counts, and area sizes (can be a vector of ones)</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>count</code></td>
<td>
<p>character specifying the column name for the observed counts (e.g. the out of sample crime counts)</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>pred</code></td>
<td>
<p>character specifying the column name for the predicted counts (e.g. predictions based on a model)</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>area</code></td>
<td>
<p>character specifying the column name for the area sizes (could also be street segment distances, see Drawve &amp; Wooditch, 2019)</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>other</code></td>
<td>
<p>vector of strings for any other column name you want to keep (e.g. an ID variable), defaults to empty <code>c()</code></p>
</td>
</tr>
</table>
<h3>Details</h3>

<p>Given predictions over an entire sample, this returns a dataframe with the sorted best PAI (sorted by density of predicted counts per area).
PAI is defined as:
</p>
<p style="text-align: center;"><code class="reqn">PAI = \frac{c_t/C}{a_t/A}</code>
</p>

<p>Where the numerator is the percent of crimes in cumulative t areas, and the denominator is the percent of the area encompassed.
PEI is the observed PAI divided by the best possible PAI if you were a perfect oracle, so is scaled between 0 and 1.
RRI is <code>predicted/observed</code>, so if you have very bad predictions can return Inf or undefined!
See Wheeler &amp; Steenbeek (2019) for the definitions of the different metrics.
User note, PEI may behave funny with different sized areas.
</p>


<h3>Value</h3>

<p>A dataframe with the columns:
</p>

<ul>
<li> <p><code>Order</code>, The order of the resulting rankings
</p>
</li>
<li> <p><code>Count</code>, the counts for the original crimes you specified
</p>
</li>
<li> <p><code>Pred</code>, the original predictions
</p>
</li>
<li> <p><code>Area</code>, the area for the units of analysis
</p>
</li>
<li> <p><code style="white-space: pre;">⁠Cum*⁠</code>, the cumulative totals for Count/Pred/Area
</p>
</li>
<li> <p><code style="white-space: pre;">⁠PCum*⁠</code>, the proportion cumulative totals, e.g. <code>CumCount/sum(Count)</code>
</p>
</li>
<li> <p><code>PAI</code>, the PAI stat
</p>
</li>
<li> <p><code>PEI</code>, the PEI stat
</p>
</li>
<li> <p><code>RRI</code>, the RRI stat (probably should analyze/graph the <code>log(RRI)</code>)!
</p>
</li>
</ul>
<p>Plus any additional variables specified by <code>other</code> at the end of the dataframe.
</p>


<h3>References</h3>

<p>Drawve, G., &amp; Wooditch, A. (2019). A research note on the methodological and theoretical considerations for assessing crime forecasting accuracy with the predictive accuracy index. <em>Journal of Criminal Justice</em>, 64, 101625.
</p>
<p>Wheeler, A. P., &amp; Steenbeek, W. (2021). Mapping the risk terrain for crime using machine learning. <em>Journal of Quantitative Criminology</em>, 37(2), 445-480.
</p>


<h3>See Also</h3>

<p><code>pai_summary()</code> for a summary table of metrics for multiple pai tables given fixed N thresholds
</p>


<h3>Examples</h3>

<pre><code class="language-R">
# Making some very simple fake data
crime_dat &lt;- data.frame(id=1:6,
                        obs=c(6,7,3,2,1,0),
                        pred=c(8,4,4,2,1,0))
crime_dat$const &lt;- 1
p1 &lt;- pai(crime_dat,'obs','pred','const')
print(p1)

# Combining multiple predictions, making
# A nice table
crime_dat$rand &lt;- sample(crime_dat$obs,nrow(crime_dat),FALSE)
p2 &lt;- pai(crime_dat,'obs','rand','const')
pai_summary(list(p1,p2),c(1,3,5),c('one','two'))

</code></pre>


</div>