<div class="container">

<table style="width: 100%;"><tr>
<td>stepDownTrendTest</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>Step Down Trend Tests</h2>

<h3>Description</h3>

<p>Performs step-down trend test procedures for monotone responses
to detect NOEC (LOEC) according to OECD (2006).
</p>


<h3>Usage</h3>

<pre><code class="language-R">stepDownTrendTest(x, ...)

## Default S3 method:
stepDownTrendTest(
  x,
  g,
  test = c("leTest", "spearmanTest", "jonckheereTest", "cuzickTest", "chackoTest",
    "johnsonTest"),
  alternative = c("two.sided", "greater", "less"),
  continuity = FALSE,
  ...
)

## S3 method for class 'formula'
stepDownTrendTest(
  formula,
  data,
  subset,
  na.action,
  test = c("leTest", "spearmanTest", "jonckheereTest", "cuzickTest", "chackoTest",
    "johnsonTest"),
  alternative = c("two.sided", "greater", "less"),
  continuity = FALSE,
  ...
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>x</code></td>
<td>
<p>a numeric vector of data values, or a list of numeric data
vectors.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>...</code></td>
<td>
<p>further arguments to be passed to or from methods.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>g</code></td>
<td>
<p>a vector or factor object giving the group for the
corresponding elements of <code>"x"</code>.
Ignored with a warning if <code>"x"</code> is a list.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>test</code></td>
<td>
<p>the trend test that shall be performed. Defaults to <code>"leTest"</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>alternative</code></td>
<td>
<p>the alternative hypothesis. Defaults to <code>"two.sided"</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>continuity</code></td>
<td>
<p>logical indicator whether a continuity correction
shall be performed. Only relevant for <code>"jonckheereTest"</code>. Defaults to <code>FALSE</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>formula</code></td>
<td>
<p>a formula of the form <code>response ~ group</code> where
<code>response</code> gives the data values and <code>group</code> a vector or
factor of the corresponding groups.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>data</code></td>
<td>
<p>an optional matrix or data frame (or similar: see
<code>model.frame</code>) containing the variables in the
formula <code>formula</code>.  By default the variables are taken from
<code>environment(formula)</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>subset</code></td>
<td>
<p>an optional vector specifying a
subset of observations to be used.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>na.action</code></td>
<td>
<p>a function which indicates what should happen when
the data contain <code>NA</code>s.  Defaults to <code>getOption("na.action")</code>.</p>
</td>
</tr>
</table>
<h3>Details</h3>

<p>According to OECD 2006 one can perform a test for trend
on responses from all dose groups including the control.
If the trend test is significant at the 0.05 level, the
high dose group is omitted, and the trend
statistic with the remaining dose groups is re-compute
The procedure is continued until the trend test is
first non-significant at the 0.05 level, then stop.
</p>
<p>The NOEC is the highest dose
remaining at this stage. If this test is significant
when only the lowest dose and control remain,
then a NOEC cannot be established from the data.
</p>


<h3>Value</h3>

<p>A list with class <code>"trendPMCMR"</code> containing the following components:
</p>

<dl>
<dt>method</dt>
<dd>
<p>a character string indicating what type of test was performed.</p>
</dd>
<dt>data.name</dt>
<dd>
<p>a character string giving the name(s) of the data.</p>
</dd>
<dt>statistic</dt>
<dd>
<p>lower-triangle matrix of the estimated
quantiles of the pairwise test statistics.</p>
</dd>
<dt>p.value</dt>
<dd>
<p>lower-triangle matrix of the p-values for the pairwise tests.</p>
</dd>
<dt>alternative</dt>
<dd>
<p>a character string describing the alternative hypothesis.</p>
</dd>
<dt>p.adjust.method</dt>
<dd>
<p>a character string describing the method for p-value
adjustment.</p>
</dd>
<dt>dist</dt>
<dd>
<p>a string that denotes the test distribution.</p>
</dd>
</dl>
<h3>Note</h3>

<p>Factor labels for <code>g</code> must be assigned in such a way,
that they can be increasingly ordered from zero-dose
control to the highest dose level, e.g. integers {0, 1, 2, ..., k} or
letters {a, b, c, ...}. Otherwise the function may not
select the correct values for intended zero-dose control.
</p>
<p>It is safer, to i) label the factor levels as given above,
and to ii) sort the data according to increasing dose-levels
prior to call the function (see <code>order</code>, <code>factor</code>).
</p>


<h3>References</h3>

<p>OECD (2006) <em>Current Approaches in the Statistical
Analysis of Ecotoxicity Data: A Guidance to Application</em>,
OECD Series on Testing and Assessment <b>52</b>,
Paris: Organisation for Econonomic Co-operation and Development.
</p>


<h3>See Also</h3>

<p><code>leTest</code>, <code>jonckheereTest</code>,
<code>spearmanTest</code>, <code>cuzickTest</code>,
<code>chackoTest</code>, <code>johnsonTest</code>
</p>


<h3>Examples</h3>

<pre><code class="language-R">res &lt;- stepDownTrendTest(Y ~ DOSE, data = trout,
                         test = "jonckheereTest",
                         alternative = "less")
## print method
res
## summary method
summary(res)
</code></pre>


</div>