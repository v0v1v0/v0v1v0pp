<div class="container">

<table style="width: 100%;"><tr>
<td>phylo.spindles</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>Plots a phylogenetic tree with spindle-diagrams, optimized for showing taxonomic diversity.</h2>

<h3>Description</h3>

<p>Plots a phylogenetic tree with spindle-diagrams, optimized for showing taxonomic diversity.
</p>


<h3>Usage</h3>

<pre><code class="language-R">phylo.spindles(
  phylo0,
  occ,
  stat = divdistr_,
  prefix = "sptab_",
  pos = NULL,
  ages = NULL,
  xlimits = NULL,
  res = 1,
  weights = 1,
  dscale = 0.002,
  col = add.alpha("black"),
  fill = col,
  lwd = 1,
  lty = 1,
  cex.txt = 1,
  col.txt = add.alpha(col, 1),
  axis = TRUE,
  labels = TRUE,
  txt.y = 0.5,
  txt.x = NULL,
  adj.x = 0,
  add = FALSE,
  tbmar = 0.2,
  smooth = 0,
  italicize = character()
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>phylo0</code></td>
<td>
<p>A time-calibrated phylogenetic tree to plot with spindle diagrams, or a character vector of taxonomic names for which to plot spindle diagrams.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>occ</code></td>
<td>
<p>Either a list()-object containing taxon-range tables for plotting diversity, or a matrix() or data.frame()-object that contains numerical plotting statistics. If the latter is provided, the default use of divdistr_() is overridden and the function will look for a column named "x" and columns matching the phylogeny tip.labels to plot the spindles.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>stat</code></td>
<td>
<p>Plotting statistic to be passed on to viol(). Defaults to use divdistr_().</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>prefix</code></td>
<td>
<p>Prefix for taxon-range tables in occ. Defaults to "sptab_"</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>pos</code></td>
<td>
<p>Position at which to draw spindles. If NULL (default), then spindles are drawn at c(1:n) where n is the number of taxa in phylo0.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>ages</code></td>
<td>
<p>Optional matrix with lower and upper age limits for each spindle, formatted like the output of tree.ages() (most commonly the same calibration matrix used to time-calibrate the tree)</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>xlimits</code></td>
<td>
<p>Limits for plotting the on the x axis.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>res</code></td>
<td>
<p>Temporal resolution of diversity estimation (if occ is a matrix or data.frame containing plotting statistics, this is ignored)</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>weights</code></td>
<td>
<p>Weights for diversity estimation. Must have the same length as the range of xlimits divided by res. For details, see divdistr_()</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>dscale</code></td>
<td>
<p>Scale value of the spindles on the y axis. Should be adjusted manually to optimize visibility of results.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>col</code></td>
<td>
<p>Color to use for the border of the plotted spindles</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>fill</code></td>
<td>
<p>Color to use for the fill of the plotted spindles. Defaults to col.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>lwd</code></td>
<td>
<p>Line width for the plotted spindles.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>lty</code></td>
<td>
<p>Line type for the plotted spindles.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>cex.txt</code></td>
<td>
<p>Adjustment for tip label text size</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>col.txt</code></td>
<td>
<p>tip label text color, defaults to be same as col, but with no transparency</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>axis</code></td>
<td>
<p>Logical indicating whether to plot (temporal) x axis (defaults to TRUE)</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>labels</code></td>
<td>
<p>Logical indicating whether to plot tip labels of phylogeny (defaults to TRUE)</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>txt.y</code></td>
<td>
<p>y axis alignment of tip labels</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>txt.x</code></td>
<td>
<p>x coordinates for plotting tip labels. Can be a single value applicable to all labels, or a vector of the same length as phylo0$tip.label</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>adj.x</code></td>
<td>
<p>Numeric value giving alignment on x axis, defaults to 0 (left-aligned) but can also be 0.5 (centered) or 1 (right-aligned).</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>add</code></td>
<td>
<p>Logical indicating whether to add to an existing plot, in which case only the spindles are plotted on top of an existing phylogeny, or not, in which case the phylogeny is plotted along with the spindles.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>tbmar</code></td>
<td>
<p>Top and bottom margin around the plot. Numeric of either length 1 or 2</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>smooth</code></td>
<td>
<p>Smoothing parameter to be passed on to divdistr_()</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>italicize</code></td>
<td>
<p>Character or numeric vector specifying which labels to italicize, if any.</p>
</td>
</tr>
</table>
<h3>Details</h3>

<p>The phylo.spindles() function allows the plotting of a phylogeny with spindle diagrams at each of its terminal branches. Various data can be represented (e.g. disparity, abundance, various diversity measures, such as those output by the divDyn package, etc.) depending on the settings for occ and stat, but the function is optimized to plot the results of divdistr_() and does so by default.
If another function is used as an argument to stat, it has to be able to take the sequence resulting from xlimits and res as its first, and occ as its 'table' argument and return a vector of the same length as range(xlimits)/res to be plotted. If occ is a list() object containing multiple dataframes, occurrence datasets or taxon range tables are automatically converted to work with abdistr_() or divdistr_() respectively (if the plot contains a phylogeny). If occ is a matrix or data.frame, the x values must already be converted (e.g. using tsconv()) to match the phylogeny.
</p>


<h3>Value</h3>

<p>A plotted phylogeny with spindle diagrams plotted at each of its terminal branches.
</p>


<h3>Examples</h3>

<pre><code class="language-R">data(archosauria)
data(tree_archosauria)
data(ages_archosauria)
data(diversity_table)
phylo.spindles(tree_archosauria,occ=archosauria,dscale=0.005,ages=ages_archosauria,txt.x=66)
phylo.spindles(tree_archosauria,occ=diversity_table,dscale=0.005,ages=ages_archosauria,txt.x=66)
</code></pre>


</div>