<div class="container">

<table style="width: 100%;"><tr>
<td>bisection</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>Bisection algorithm for bootstrap calibration of prediction intervals</h2>

<h3>Description</h3>

<p>This helper function returns a bootstrap calibrated coefficient for the calculation
of prediction intervals (and limits).
</p>


<h3>Usage</h3>

<pre><code class="language-R">bisection(
  y_star_hat,
  pred_se,
  y_star,
  alternative,
  quant_min,
  quant_max,
  n_bisec,
  tol,
  alpha,
  traceplot = TRUE
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>y_star_hat</code></td>
<td>
<p>a list of length <code class="reqn">B</code> that contains the expected future observations.
Each entry in this list has to be a numeric vector of length <code class="reqn">M</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>pred_se</code></td>
<td>
<p>a list of length <code class="reqn">B</code> that contains the standard errors of the prediction.
Each entry in this list has to be a numeric vector of length <code class="reqn">M</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>y_star</code></td>
<td>
<p>a list of length <code class="reqn">B</code> that contains the future observations.
Each entry in this list has to be a numeric vector of length <code class="reqn">M</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>alternative</code></td>
<td>
<p>either "both", "upper" or "lower".
<code>alternative</code> specifies if a prediction interval or
an upper or a lower prediction limit should be computed</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>quant_min</code></td>
<td>
<p>lower start value for bisection</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>quant_max</code></td>
<td>
<p>upper start value for bisection</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>n_bisec</code></td>
<td>
<p>maximal number of bisection steps</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>tol</code></td>
<td>
<p>tolerance for the coverage probability in the bisection</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>alpha</code></td>
<td>
<p>defines the level of confidence (<code class="reqn">1-\alpha</code>)</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>traceplot</code></td>
<td>
<p>if <code>TRUE</code>: Plot for visualization of the bisection process</p>
</td>
</tr>
</table>
<h3>Details</h3>

<p>This function is an implementation of the bisection algorithm of Menssen
and Schaarschmidt 2022. It returns a calibrated coefficient <code class="reqn">q^{calib}</code> for the
calculation of pointwise and simultaneous prediction intervals
</p>
<p style="text-align: center;"><code class="reqn">[l,u] = \hat{y}^*_m  \pm q^{calib} \hat{se}(Y_m - y^*_m),</code>
</p>

<p>lower prediction limits
</p>
<p style="text-align: center;"><code class="reqn">l = \hat{y}^*_m - q^{calib} \hat{se}(Y_m - y^*_m)</code>
</p>

<p>or upper prediction limits
</p>
<p style="text-align: center;"><code class="reqn">u = \hat{y}^*_m  + q^{calib} \hat{se}(Y_m - y^*_m)</code>
</p>

<p>that cover all of <code class="reqn">m=1, ... , M</code> future observations. <br></p>
<p>In this notation, <code class="reqn">\hat{y}^*_m</code> are the expected future observations for each of
the <code class="reqn">m</code> future clusters, <code class="reqn">q^{calib}</code> is the
calibrated coefficient and <code class="reqn">\hat{se}(Y_m - y^*_m)</code>
are the standard errors of the prediction. <br></p>


<h3>Value</h3>

<p>This function returns <code class="reqn">q^{calib}</code> in the equation above.
</p>


<h3>References</h3>

<p>Menssen and Schaarschmidt (2022): Prediction intervals for all of M future
observations based on linear random effects models. Statistica Neerlandica. <br><a href="https://doi.org/10.1111/stan.12260">doi:10.1111/stan.12260</a>
</p>


</div>