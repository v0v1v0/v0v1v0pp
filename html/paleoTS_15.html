<div class="container">

<table style="width: 100%;"><tr>
<td>fitGpunc</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>Fit trait evolution model with punctuations estimated from the data</h2>

<h3>Description</h3>

<p>Fit trait evolution model with punctuations estimated from the data
</p>


<h3>Usage</h3>

<pre><code class="language-R">fitGpunc(
  y,
  ng = 2,
  minb = 7,
  pool = TRUE,
  oshare = TRUE,
  method = c("Joint", "AD"),
  silent = FALSE,
  hess = FALSE,
  parallel = FALSE,
  ...
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>y</code></td>
<td>
<p>a <code>paleoTS</code> object</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>ng</code></td>
<td>
<p>number of groups (segments) in the sequence</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>minb</code></td>
<td>
<p>minimum number of populations within each segment</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>pool</code></td>
<td>
<p>if TRUE, sample variances are substituted with their pooled estimate</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>oshare</code></td>
<td>
<p>logical, if TRUE, variance assumed to be shared (equal) across segments</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>method</code></td>
<td>
<p>parameterization to use: <code>Joint</code> or <code>AD</code>; see Details</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>silent</code></td>
<td>
<p>logical, if TRUE, progress updates are suppressed</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>hess</code></td>
<td>
<p>if TRUE, standard errors computed from the Hessian matrix are returned</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>parallel</code></td>
<td>
<p>logical, if TRUE, the analysis is done in parallel</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>...</code></td>
<td>
<p>other arguments, passed to optimization functions</p>
</td>
</tr>
</table>
<h3>Details</h3>

<p>This function tests all possible shift points for punctuations, subject to the
constraint that the number of populations in each segment is always &gt;= <code>minb</code>. The
shiftpoint yielding the highest log-likelihood is returned as the solution, along with
the log-likelihoods (<code>all.logl</code>) of all tested shift points (<code>GG</code>). <br><br></p>
<p>The function uses <code>opt.punc</code> (if <code>method = "AD"</code>) or <code>opt.joint.punc</code>
(if <code>method = "Joint"</code>) to do the fitting.
</p>


<h3>Value</h3>

<p>a <code>paleoTSfit</code> object with the results of the model-fitting.
</p>


<h3>Note</h3>

<p>Calculations can be speeded up by setting <code>parallel = TRUE</code>, which uses
package <code>doParallel</code> to run the bootstrap replicates in parallel, using
one fewer than the number of detected cores.
</p>


<h3>See Also</h3>

<p><code>fit9models</code>, <code>sim.punc</code>
</p>


<h3>Examples</h3>

<pre><code class="language-R">x &lt;- sim.punc(ns = c(15, 15), theta = c(0,3), omega = c(0.1, 0.1))
w.punc &lt;- fitGpunc(x, oshare = TRUE)
plot(x, modelFit = w.punc)
</code></pre>


</div>