<div class="container">

<table style="width: 100%;"><tr>
<td>dub</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>
Sample sizes for a double sampling design
</h2>

<h3>Description</h3>

<p>Compute samples sizes at each phase of a two-phase design where strata are created using the first phase.
</p>


<h3>Usage</h3>

<pre><code class="language-R">dub(c1, c2, Ctot, Nh, Sh, Yh.bar)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>c1</code></td>
<td>
<p>cost per unit in phase-1</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>c2</code></td>
<td>
<p>cost per unit in phase-2</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>Ctot</code></td>
<td>
<p>Total variable cost</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>Nh</code></td>
<td>
<p>Vector of stratum population counts or proportions</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>Sh</code></td>
<td>
<p>Vector of stratum population standard deviations</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>Yh.bar</code></td>
<td>
<p>Vector of stratum population means</p>
</td>
</tr>
</table>
<h3>Details</h3>

<p>Compute the first and second phase sample sizes for a double sampling design. A first phase sample is selected by simple random sampling (<em>srs</em>). Strata are formed based on information collected in the first phase. The Neyman allocation to strata of the second phase sample is computed ignoring costs. Optimal total sample sizes are computed for the first and second phases, given per-unit costs for the first and second phases and a fixed total budget for both phases combined.</p>


<h3>Value</h3>

<p>A list object with elements:
</p>
<table>
<tr style="vertical-align: top;">
<td><code>V1</code></td>
<td>
<p>Variance component associated with phase-1</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>V2</code></td>
<td>
<p>Variance component associated with phase-2</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>n1</code></td>
<td>
<p>Phase-1 sample size</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>n2</code></td>
<td>
<p>Total phase-2 sample across all strata</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>"n2/n1"</code></td>
<td>
<p>Fraction that phase-2 is of phase-1</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>ney.alloc</code></td>
<td>
<p>Vector of stratum sample sizes for phase-2 sample</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>Vopt</code></td>
<td>
<p>Variance of mean with the calculated phase-1 and phase-2 sample sizes</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>nsrs</code></td>
<td>
<p>Size of an <em>srs</em> that has cost <code>Ctot</code>, assuming each unit costs <code>c2</code></p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>Vsrs</code></td>
<td>
<p>Variance of mean in an <em>srs</em> of cost <code>Ctot</code>, assuming each unit costs <code>c2</code></p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>Vratio</code></td>
<td>
<p>Ratio of <code>Vopt</code> to <code>Vsrs</code></p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>Ctot</code></td>
<td>
<p>Input value of total cost</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>cost.chk</code></td>
<td>
<p>Computed value of phase-1 plus phase-2 sample with optimal sample sizes; should agree with Ctot</p>
</td>
</tr>
</table>
<h3>Author(s)</h3>

<p>Richard Valliant, Jill A. Dever, Frauke Kreuter
</p>


<h3>References</h3>

<p>Cochran W (1977, sect. 12.3) <em>Sampling Techniques</em>. New York: John Wiley &amp; Sons, Inc.
</p>
<p>Neyman J (1938) Contribution to the theory of sampling human populations. <em>Journal
of the American Statistical Association</em>, 33(201), 101-116.
</p>
<p>Valliant, R., Dever, J., Kreuter, F. (2018, sect. 17.5.2).  <em>Practical Tools for Designing and Weighting Survey Samples, 2nd edition</em>. New York: Springer.
</p>


<h3>Examples</h3>

<pre><code class="language-R">Wh &lt;- rep(0.25,4)
Ph &lt;- c(0.02,0.12,0.37,0.54)
Sh &lt;- sqrt(Ph*(1-Ph))
c1 &lt;- 10
c2 &lt;- 50
Ctot &lt;- 20000
dub(c1, c2, Ctot, Nh=Wh, Sh, Yh.bar=Ph)
</code></pre>


</div>