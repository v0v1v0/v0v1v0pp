<div class="container">

<table style="width: 100%;"><tr>
<td>label_switchPLMIX</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>Label switching adjustment  of the Gibbs sampling simulations for Bayesian mixtures of Plackett-Luce models</h2>

<h3>Description</h3>

<p>Remove the label switching phenomenon from the MCMC samples of Bayesian mixtures of Plackett-Luce models with <code class="reqn">G&gt;1</code> components.
</p>


<h3>Usage</h3>

<pre><code class="language-R">label_switchPLMIX(pi_inv, seq_G, MCMCsampleP, MCMCsampleW, MAPestP,
  MAPestW, parallel = FALSE)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>pi_inv</code></td>
<td>
<p>An object of class <code>top_ordering</code>, collecting the numeric <code class="reqn">N</code><code class="reqn">\times</code><code class="reqn">K</code> data matrix of partial orderings, or an object that can be coerced with <code>as.top_ordering</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>seq_G</code></td>
<td>
<p>Numeric vector with the number of components of the Plackett-Luce mixtures to be assessed.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>MCMCsampleP</code></td>
<td>
<p>List of size <code>length(seq_G)</code>, whose generic element is a numeric <code class="reqn">L</code><code class="reqn">\times</code><code class="reqn">(G*K)</code> matrix with the MCMC samples of the component-specific support parameters to be processed.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>MCMCsampleW</code></td>
<td>
<p>List of size <code>length(seq_G)</code>, whose generic element is a numeric <code class="reqn">L</code><code class="reqn">\times</code><code class="reqn">G</code> matrix with the MCMC samples of the mixture weights to be processed.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>MAPestP</code></td>
<td>
<p>List of size <code>length(seq_G)</code>, whose generic element is a numeric <code class="reqn">G</code><code class="reqn">\times</code><code class="reqn">K</code> matrix with the MAP estimates of the component-specific support parameters to be used as a pivot in the PRA method (see 'Details').</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>MAPestW</code></td>
<td>
<p>List of size <code>length(seq_G)</code>, whose generic element is a numeric vector with the MAP estimates of the <code class="reqn">G</code> mixture weights to be used as a pivot in the PRA method (see 'Details').</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>parallel</code></td>
<td>
<p>Logical: whether parallelization should be used. Default is <code>FALSE</code>.</p>
</td>
</tr>
</table>
<h3>Details</h3>

<p>The <code>label_switchPLMIX</code> function performs the label switching adjustment of the MCMC samples via the Pivotal Reordering Algorithm (PRA) described in Marin et al (2005), by recalling the <code>pra</code> function from the <code>label.switching</code> package.
</p>


<h3>Value</h3>

<p>A list of named objects:
</p>
<table>
<tr style="vertical-align: top;">
<td><code>final_sampleP</code></td>
<td>
<p> List of size <code>length(seq_G)</code>, whose generic element is a numeric <code class="reqn">G</code><code class="reqn">\times</code><code class="reqn">K</code><code class="reqn">\times</code><code class="reqn">L</code> array with the MCMC samples of the component-specific support parameters adjusted for label switching.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>final_sampleW</code></td>
<td>
<p> List of size <code>length(seq_G)</code>, whose generic element is a numeric <code class="reqn">L</code><code class="reqn">\times</code><code class="reqn">G</code> matrix with the MCMC samples of the mixture weights adjusted for label switching.</p>
</td>
</tr>
</table>
<h3>Author(s)</h3>

<p>Cristina Mollica and Luca Tardella
</p>


<h3>References</h3>

<p>Mollica, C. and Tardella, L. (2017). Bayesian Plackett-Luce mixture models for partially ranked data. <em>Psychometrika</em>, <b>82</b>(2), pages 442–458, ISSN: 0033-3123, DOI: 10.1007/s11336-016-9530-0.
</p>
<p>Papastamoulis, P. (2016). label.switching: An R Package for Dealing with the Label Switching Problem in MCMC Outputs. <em>Journal of Statistical Software</em>, <b>69</b>(1), pages 1–24, DOI: 10.18637/jss.v069.c01.
</p>
<p>Marin, J. M., Mengersen, K. and Robert, C.P. (2005). Bayesian modelling and inference on mixtures of distributions. <em>Handbook of Statistics</em> (25), D. Dey and C.R. Rao (eds). Elsevier-Sciences.
</p>


<h3>See Also</h3>

<p><code>pra</code>
</p>


<h3>Examples</h3>

<pre><code class="language-R">
data(d_carconf)
K &lt;- ncol(d_carconf)

## Fit 1- and 2-component PL mixtures via MAP estimation
MAP_1 &lt;- mapPLMIX_multistart(pi_inv=d_carconf, K=K, G=1, 
                             n_start=2, n_iter=400*1)

MAP_2 &lt;- mapPLMIX_multistart(pi_inv=d_carconf, K=K, G=2, 
                             n_start=2, n_iter=400*2)
                                   
MAP_3 &lt;- mapPLMIX_multistart(pi_inv=d_carconf, K=K, G=3, 
                             n_start=2, n_iter=400*3)
                                   
mcmc_iter &lt;- 30
burnin &lt;- 10

## Fit 1- and 2-component PL mixtures via Gibbs sampling procedure
GIBBS_1 &lt;- gibbsPLMIX(pi_inv=d_carconf, K=K, G=1, n_iter=mcmc_iter, 
                      n_burn=burnin, init=list(p=MAP_1$mod$P_map,
                      z=binary_group_ind(MAP_1$mod$class_map,G=1)))
GIBBS_2 &lt;- gibbsPLMIX(pi_inv=d_carconf, K=K, G=2, n_iter=mcmc_iter, 
                      n_burn=burnin, init=list(p=MAP_2$mod$P_map,
                      z=binary_group_ind(MAP_2$mod$class_map,G=2)))
GIBBS_3 &lt;- gibbsPLMIX(pi_inv=d_carconf, K=K, G=3, n_iter=mcmc_iter, 
                      n_burn=burnin, init=list(p=MAP_3$mod$P_map,
                      z=binary_group_ind(MAP_3$mod$class_map,G=3)))
                            
## Adjusting the MCMC samples for label switching
LS &lt;- label_switchPLMIX(pi_inv=d_carconf, seq_G=1:3, 
                   MCMCsampleP=list(GIBBS_1$P, GIBBS_2$P, GIBBS_3$P), 
                   MCMCsampleW=list(GIBBS_1$W, GIBBS_2$W, GIBBS_3$W), 
                   MAPestP=list(MAP_1$mod$P_map, MAP_2$mod$P_map, MAP_3$mod$P_map), 
                   MAPestW=list(MAP_1$mod$W_map, MAP_2$mod$W_map, MAP_3$mod$W_map))
str(LS)       
</code></pre>


</div>