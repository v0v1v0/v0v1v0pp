<div class="container">

<table style="width: 100%;"><tr>
<td>likPOUMMGivenTreeVTips</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>Density of observed tip-values given a tree, assuming Ornstein-Uhlenbeck 
process for the genetic contributions along the tree and normally distributed
environmental deviations.</h2>

<h3>Description</h3>

<p>Calculates the (log-)probability density of trait values at the
tip-nodes given the tree and assuming that the trait value at the tips is the
sum of a genetic contribution, g, that evolved on the tree according to an OU
process with parameters alpha, theta, sigma and an environmental deviation, 
e, that is distributed normally and independently between the tips of the 
tree. Note: Without additional assumptions for the distribution of the value
at the root of the tree, the likelihood is not defined at alpha=0, although 
this corresponds to the limiting Brownian motion process with mean value 
theta and unit time variance sigma^2. Considering the observed data and tree as
a fixed parameter and the POUMM parameters as variables, this function is
interpreted as the POUMM likelihood.
</p>


<h3>Usage</h3>

<pre><code class="language-R">likPOUMMGivenTreeVTips(
  z,
  tree,
  alpha,
  theta,
  sigma,
  sigmae = 0,
  g0 = NA,
  g0Prior = NULL,
  log = TRUE,
  pruneInfo = pruneTree(tree, z),
  usempfr = 0,
  maxmpfr = 2,
  precbits = 128,
  debug = FALSE
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>z</code></td>
<td>
<p>A numeric vector of size length(tree$tip.label) representing the
trait values at the tip-nodes.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>tree</code></td>
<td>
<p>an object of class phylo</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>alpha</code></td>
<td>
<p>the strength of the selection</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>theta</code></td>
<td>
<p>long term mean value of the OU process</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>sigma</code></td>
<td>
<p>the unit-time standard deviation of the random component in the
OU process.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>sigmae</code></td>
<td>
<p>the standard deviation of the environmental deviation added to
the genetic contribution at each tip, by default 0, meaning no
environmental deviation.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>g0</code></td>
<td>
<p>Numeric, NA or NaN, either a fixed genotypic value at the root of 
tree or NA or NaN. A NA "Not Available" will cause to analytically
calculate the value of g0 that would maximize the conditional likelihood of
the data given g0. A NaN "Not a Number" will cause integration over g0
taking values in (-Inf,+Inf) assuming that g0 is normally distributed with
mean g0Prior$mean and variance g0Prior$var (see parameter g0Prior).</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>g0Prior</code></td>
<td>
<p>Either NULL or a list with named numeric or character members
"mean" and "var". Specifies a prior normal distribution for the parameter g0.
If characters, the members mean and var are evaluated as R-expressions.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>log</code></td>
<td>
<p>Logical indicating whether log-likelihood should be returned
instead of likelihood, default is TRUE.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>pruneInfo</code></td>
<td>
<p>list returned by pruneTree(tree) to be passed in explicit
calls to dVGivenTreeOU.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>usempfr</code></td>
<td>
<p>integer indicating if and how mpfr should be used for small 
parameter values (any(c(alpha, sigma, sigmae) &lt; 0.01)). Using the mpfr 
package can be forced by specifying an integer greater or equal to 2. 
Setting usempfr=0 (default) causes high precision likelihood 
calculation to be done on each encounter of parameters with at least 1 bigger
log-likelihood value than any of the currently found
maximum log-likelihood or the previously calculated log-likelihood value
Requires the Rmpfr package. Note that using mpfr may increase the time for 
one likelihood calculation more than 100-fold. Set usempfr to -1 or less
to completely disable Rmpfr functionality.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>maxmpfr</code></td>
<td>
<p>integer (not used)</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>precbits</code></td>
<td>
<p>integer specifying precision bits for mpfr. Default is 512.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>debug</code></td>
<td>
<p>logical, if set to TRUE some debugging information is printed 
during likelihood calculation</p>
</td>
</tr>
</table>
<h3>Value</h3>

<p>A numeric with attributes "g0" and "g0LogPrior".
</p>


</div>