<div class="container">

<table style="width: 100%;"><tr>
<td>draw.sim</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>Draw a sim object</h2>

<h3>Description</h3>

<p>Draws species longevities for a paleobuddy simulation (a <code>sim</code> object -
see <code>?sim</code>) in the graphics window. Allows for the assignment of 
speciation and sampling events, and further customization.
</p>


<h3>Usage</h3>

<pre><code class="language-R">draw.sim(sim, fossils = NULL, sortBy = "TS", lwdLin = 4, showLabel = TRUE, ...)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>sim</code></td>
<td>
<p>A <code>sim</code> object, containing extinction times, speciation 
times, parent, and status information for each species in the simulation. 
See <code>?sim</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>fossils</code></td>
<td>
<p>A <code>data.frame</code> containing the fossil occurrences of 
each lineage, e.g. as returned by the <code>sample.clade</code> function. The
format of this argument will define the way fossils are drawn (see below).</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>sortBy</code></td>
<td>
<p>A single character or integer vector indicating how lineages 
should be sorted in the plot. If it is a string (see example 3), it 
indicates which element in the <code>sim</code> object that should be used to sort
lineages in the plot. If it is a vector of integers, it directly specifies
the order in which lineages should be drawn, from the bottom (i.e. the
first integer) to the upper side (#th integer, with # = number of lineages
in <code>sim</code>) of the figure. Default value of this parameter is "TS", so by
default species will be sorted by order of origination in the simulation.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>lwdLin</code></td>
<td>
<p>The relative thickness/size of all elements (i.e., lines and 
points in the plot. Default value is 4 (i.e. equal to <code>lwd = 4</code> for 
the black horizontal lines).</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>showLabel</code></td>
<td>
<p>A <code>logical</code> on whether to draw species labels (i.e. 
species 1 being t1, species 2 t2 etc.). Default is <code>TRUE</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>...</code></td>
<td>
<p>Further arguments to be passed to <code>plot</code></p>
</td>
</tr>
</table>
<h3>Value</h3>

<p>A plot of the simulation in the graphics window. If the 
<code>fossils</code> data.frame is supplied, its format will dictate how fossil
occurrences will be plotted. If <code>fossils</code> has a <code>SampT</code> column
(i.e. the occurrence times are exact), fossil occurrences are assigned as 
dots. If <code>fossils</code> has columns <code>MaxT</code> and <code>MinT</code> (i.e. the 
early and late stage bounds associated with each occurrence), fossil 
occurrences are represented as slightly jittered, semitransparent bars 
indicating the early and late bounds of each fossil occurrence.
</p>


<h3>Author(s)</h3>

<p>Matheus Januario
</p>


<h3>Examples</h3>

<pre><code class="language-R">
###
# we start drawing a simple simulation

# maximum simulation time
tMax &lt;- 10

# set seed
set.seed(1)

# run a simulation
sim &lt;- bd.sim(n0 = 1, lambda = 0.6, mu = 0.55, tMax = tMax, 
              nFinal = c(10,20)) 
              
# draw it
draw.sim(sim)

###
# we can add fossils to the drawing

# maximum simulation time
tMax &lt;- 10

# set seed
set.seed(1)

# run a simulation
sim &lt;- bd.sim(n0 = 1, lambda = 0.6, mu = 0.55, tMax = tMax, 
              nFinal = c(10,20)) 

# set seed
set.seed(1)

# simulate data resulting from a fossilization process
# with exact occurrence times
fossils &lt;- sample.clade(sim = sim, rho = 4, tMax = tMax, returnTrue = TRUE)

# draw it
draw.sim(sim, fossils = fossils)

# we can order the vertical drawing of species based on
# any element of sim
draw.sim(sim, fossils = fossils, sortBy = "PAR")
# here we cluster lineages with their daughters by
# sorting them by the "PAR" list of the sim object

draw.sim(sim, fossils = fossils, sortBy = "TE")
# here we sort lineages by their extinction times

###
# try with fossil ranges

# maximum simulation time
tMax &lt;- 10

# set seed
set.seed(1)

# run birth-death simulation
sim &lt;- bd.sim(n0 = 1, lambda = 0.6, mu = 0.55, tMax = tMax, 
              nFinal = c(10,20)) 

# simulate data resulting from a fossilization process
# with fossil occurrence time ranges

# set seed
set.seed(20)

# create time bins randomly
bins &lt;- c(tMax, 0, runif(n = rpois(1, lambda = 6), min = 0, max = tMax))

# set seed
set.seed(1)

# simulate fossil sampling
fossils &lt;- sample.clade(sim = sim, rho = 2, tMax = tMax, 
                        returnTrue = FALSE, bins = bins)

# draw it, sorting lineages by their parent
draw.sim(sim, fossils = fossils, sortBy = "PAR")

# adding the bounds of the simulated bins
abline(v = bins, lty = 2, col = "blue", lwd = 0.5)

###
# we can control how to sort displayed species exactly

# maximum simulation time
tMax &lt;- 10

# set seed
set.seed(1)

# run birth-death simulations
sim &lt;- bd.sim(n0 = 1, lambda = 0.6, mu = 0.55, tMax = tMax, 
              nFinal = c(10,20)) 

# set seed
set.seed(1)  

# simulate fossil sampling
fossils &lt;- sample.clade(sim = sim, rho = 4, tMax = tMax, returnTrue = TRUE)

# draw it with random sorting (in pratice this could be a trait
# value, for instance)
draw.sim(sim, fossils = fossils, sortBy = sample(1:length(sim$TS)))

</code></pre>


</div>