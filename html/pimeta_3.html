<div class="container">

<table style="width: 100%;"><tr>
<td>cima</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>Calculating Confidence Intervals</h2>

<h3>Description</h3>

<p>This function calculates confidence intervals.
</p>


<h3>Usage</h3>

<pre><code class="language-R">cima(y, se, v = NULL, alpha = 0.05, method = c("boot", "DL", "HK",
  "SJ", "KR", "APX", "PL", "BC"), B = 25000, parallel = FALSE,
  seed = NULL, maxit1 = 1e+05, eps = 10^(-10), lower = 0,
  upper = 1000, maxit2 = 1000, tol = .Machine$double.eps^0.25,
  rnd = NULL, maxiter = 100)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>y</code></td>
<td>
<p>the effect size estimates vector</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>se</code></td>
<td>
<p>the within studies standard errors vector</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>v</code></td>
<td>
<p>the within studies variance estimates vector</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>alpha</code></td>
<td>
<p>the alpha level of the prediction interval</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>method</code></td>
<td>
<p>the calculation method for the pretiction interval (default = "boot").
</p>

<ul>
<li> <p><code>boot</code>: A parametric bootstrap confidence interval
(Nagashima et al., 2018).
</p>
</li>
<li> <p><code>DL</code>: A Wald-type t-distribution confidence interval
(the DerSimonian &amp; Laird estimator for <code class="reqn">\tau^2</code> with
an approximate variance estimator for the average effect,
<code class="reqn">(1/\sum{\hat{w}_i})^{-1}</code>, <code class="reqn">df=K-1</code>).
</p>
</li>
<li> <p><code>HK</code>: A Wald-type t-distribution confidence interval
(the REML estimator for <code class="reqn">\tau^2</code> with
the Hartung (1999)'s varance estimator [the Hartung and
Knapp (2001)'s estimator] for the average effect,
<code class="reqn">df=K-1</code>).
</p>
</li>
<li> <p><code>SJ</code>: A Wald-type t-distribution confidence interval
(the REML estimator for <code class="reqn">\tau^2</code> with
the Sidik and Jonkman (2006)'s bias coreccted SE estimator
for the average effect, <code class="reqn">df=K-1</code>).
</p>
</li>
<li> <p><code>KR</code>: Partlettâ€“Riley (2017) confidence interval /
(the REML estimator for <code class="reqn">\tau^2</code> with
the Kenward and Roger (1997)'s approach
for the average effect, <code class="reqn">df=\nu</code>).
</p>
</li>
<li> <p><code>APX</code>: A Wald-type t-distribution confidence interval /
(the REML estimator for <code class="reqn">\tau^2</code> with
an approximate variance estimator for the average
effect, <code class="reqn">df=K-1</code>).
</p>
</li>
<li> <p><code>PL</code>: Profile likelihood confidence interval
(Hardy &amp; Thompson, 1996).
</p>
</li>
<li> <p><code>BC</code>: Profile likelihood confidence interval with
Bartlett-type correction (Noma, 2011).            
</p>
</li>
</ul>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>B</code></td>
<td>
<p>the number of bootstrap samples</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>parallel</code></td>
<td>
<p>the number of threads used in parallel computing, or FALSE that means single threading</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>seed</code></td>
<td>
<p>set the value of random seed</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>maxit1</code></td>
<td>
<p>the maximum number of iteration for the exact distribution function of <code class="reqn">Q</code></p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>eps</code></td>
<td>
<p>the desired level of accuracy for the exact distribution function of <code class="reqn">Q</code></p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>lower</code></td>
<td>
<p>the lower limit of random numbers of <code class="reqn">\tau^2</code></p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>upper</code></td>
<td>
<p>the lower upper of random numbers of <code class="reqn">\tau^2</code></p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>maxit2</code></td>
<td>
<p>the maximum number of iteration for numerical inversions</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>tol</code></td>
<td>
<p>the desired level of accuracy for numerical inversions</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>rnd</code></td>
<td>
<p>a vector of random numbers from the exact distribution of <code class="reqn">\tau^2</code></p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>maxiter</code></td>
<td>
<p>the maximum number of iteration for REML estimation</p>
</td>
</tr>
</table>
<h3>Details</h3>

<p>Excellent reviews of heterogeneity variance estimation
have been published (e.g., Veroniki, et al., 2018).
</p>


<h3>Value</h3>


<ul>
<li> <p><code>K</code>: the number of studies.
</p>
</li>
<li> <p><code>muhat</code>: the average treatment effect estimate <code class="reqn">\hat{\mu}</code>.
</p>
</li>
<li> <p><code>lci</code>, <code>uci</code>: the lower and upper confidence limits <code class="reqn">\hat{\mu}_l</code> and <code class="reqn">\hat{\mu}_u</code>.
</p>
</li>
<li> <p><code>tau2h</code>: the estimate for <code class="reqn">\tau^2</code>.
</p>
</li>
<li> <p><code>i2h</code>: the estimate for <code class="reqn">I^2</code>.
</p>
</li>
<li> <p><code>nuc</code>: degrees of freedom for the confidence interval.
</p>
</li>
<li> <p><code>vmuhat</code>: the variance estimate for <code class="reqn">\hat{\mu}</code>.
</p>
</li>
</ul>
<h3>References</h3>

<p>Veroniki, A. A., Jackson, D., Bender, R., Kuss, O.,
Langan, D., Higgins, J. P. T., Knapp, G.,  and Salanti, J. (2016).
Methods to calculate uncertainty in the estimated overall effect
size from a random-effects meta-analysis
<em>Res Syn Meth.</em>
<em>In press</em>.
<a href="https://doi.org/10.1002/jrsm.1319">https://doi.org/10.1002/jrsm.1319</a>.
</p>
<p>Nagashima, K., Noma, H., and Furukawa, T. A. (2018).
Prediction intervals for random-effects meta-analysis:
a confidence distribution approach.
<em>Stat Methods Med Res</em>.
<em>In press</em>.
<a href="https://doi.org/10.1177/0962280218773520">https://doi.org/10.1177/0962280218773520</a>.
</p>
<p>Higgins, J. P. T, Thompson, S. G., Spiegelhalter, D. J. (2009).
A re-evaluation of random-effects meta-analysis.
<em>J R Stat Soc Ser A Stat Soc.</em>
<strong>172</strong>(1): 137-159.
<a href="https://doi.org/10.1111/j.1467-985X.2008.00552.x">https://doi.org/10.1111/j.1467-985X.2008.00552.x</a>
</p>
<p>Partlett, C, and Riley, R. D. (2017).
Random effects meta-analysis: Coverage performance of 95
confidence and prediction intervals following REML estimation.
<em>Stat Med.</em>
<strong>36</strong>(2): 301-317.
<a href="https://doi.org/10.1002/sim.7140">https://doi.org/10.1002/sim.7140</a>
</p>
<p>Hartung, J., and Knapp, G. (2001).
On tests of the overall treatment effect in meta-analysis with
normally distributed responses.
<em>Stat Med.</em>
<strong>20</strong>(12): 1771-1782.
<a href="https://doi.org/10.1002/sim.791">https://doi.org/10.1002/sim.791</a>
</p>
<p>Sidik, K., and Jonkman, J. N. (2006).
Robust variance estimation for random effects meta-analysis.
<em>Comput Stat Data Anal.</em>
<strong>50</strong>(12): 3681-3701.
<a href="https://doi.org/10.1016/j.csda.2005.07.019">https://doi.org/10.1016/j.csda.2005.07.019</a>
</p>
<p>Noma H. (2011)
Confidence intervals for a random-effects meta-analysis
based on Bartlett-type corrections.
<em>Stat Med.</em>
<strong>30</strong>(28): 3304-3312.
<a href="https://doi.org/10.1002/sim.4350">https://doi.org/10.1002/sim.4350</a>
</p>


<h3>See Also</h3>

<p><code>pima</code>
</p>


<h3>Examples</h3>

<pre><code class="language-R">data(sbp, package = "pimeta")
set.seed(20161102)

# Nagashima-Noma-Furukawa confidence interval
pimeta::cima(sbp$y, sbp$sigmak, seed = 3141592)

# A Wald-type t-distribution confidence interval
# An approximate variance estimator &amp; DerSimonian-Laird estimator for tau^2
pimeta::cima(sbp$y, sbp$sigmak, method = "DL")

# A Wald-type t-distribution confidence interval
# The Hartung variance estimator &amp; REML estimator for tau^2
pimeta::cima(sbp$y, sbp$sigmak, method = "HK")

# A Wald-type t-distribution confidence interval
# The Sidik-Jonkman variance estimator &amp; REML estimator for tau^2
pimeta::cima(sbp$y, sbp$sigmak, method = "SJ")

# A Wald-type t-distribution confidence interval
# The Kenward-Roger approach &amp; REML estimator for tau^2
pimeta::cima(sbp$y, sbp$sigmak, method = "KR")

# A Wald-type t-distribution confidence interval
# An approximate variance estimator &amp; REML estimator for tau^2
pimeta::cima(sbp$y, sbp$sigmak, method = "APX")

# Profile likelihood confidence interval
# Maximum likelihood estimators of variance for the average effect &amp; tau^2
pimeta::cima(sbp$y, sbp$sigmak, method = "PL")

# Profile likelihood confidence interval with a Bartlett-type correction
# Maximum likelihood estimators of variance for the average effect &amp; tau^2
pimeta::cima(sbp$y, sbp$sigmak, method = "BC")
</code></pre>


</div>