<div class="container">

<table style="width: 100%;"><tr>
<td>average</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>Extract and average the best supported models from a phylogenetic path
analysis.</h2>

<h3>Description</h3>

<p>Extract and average the best supported models from a phylogenetic path
analysis.
</p>


<h3>Usage</h3>

<pre><code class="language-R">average(phylopath, cut_off = 2, avg_method = "conditional", ...)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>phylopath</code></td>
<td>
<p>An object of class <code>phylopath</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>cut_off</code></td>
<td>
<p>The CICc cut-off used to select the best models. Use
<code>Inf</code> to average over all models. Use the <code>best()</code> function to
only use the top model, or <code>choice()</code> to select any single model.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>avg_method</code></td>
<td>
<p>Either <code>"full"</code> or <code>"conditional"</code>. The methods
differ in how they deal with averaging a path coefficient where the path is
absent in some of the models. The full method sets the coefficient (and the
variance) for the missing paths to zero, meaning paths that are missing in
some models will shrink towards zero. The conditional method only averages
over models where the path appears, making it more sensitive to small
effects. Following von Hardenberg &amp; Gonzalez-Voyer 2013, conditional
averaging is set as the default.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>...</code></td>
<td>
<p>Arguments to pass to phylolm::phylolm and phylolm::phyloglm. Provide <code>boot = K</code>
parameter to enable bootstrapping, where <code>K</code> is the number of bootstrap replicates. If you
specified other options in the original phylo_path call you don't need to specify them again.</p>
</td>
</tr>
</table>
<h3>Value</h3>

<p>An object of class <code>fitted_DAG</code>.
</p>


<h3>Examples</h3>

<pre><code class="language-R">  candidates &lt;- define_model_set(
    A = NL ~ RS,
    B = RS ~ NL + BM,
    .common = c(LS ~ BM, DD ~ NL, NL ~ BM)
  )
  p &lt;- phylo_path(candidates, rhino, rhino_tree)
  summary(p)

  # Models A and B have similar support, so we may decide to take
  # their average.

  avg_model &lt;- average(p)
  # Print the average model to see coefficients, se and ci:
  avg_model

  ## Not run: 
  # Plot to show the weighted graph:
  plot(avg_model)

  # One can see that an averaged model is not necessarily a DAG itself.
  # This model actually has a path in two directions.

  # Note that coefficients that only occur in one of the models become much
  # smaller when we use full averaging:

  coef_plot(avg_model)
  coef_plot(average(p, method = 'full'))
  
## End(Not run)

</code></pre>


</div>