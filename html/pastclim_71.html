<div class="container">

<table style="width: 100%;"><tr>
<td>location_series</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>Extract a time series of bioclimatic variables for one or more locations.</h2>

<h3>Description</h3>

<p>This function extract a time series of local climate for
a set of locations. Note that this function does not apply any interpolation
(as opposed to <code>location_slice()</code>). If you have a coastal location that just
falls into the water for the reconstructions, you will have to amend the coordinates
to put it more firmly on land.
</p>


<h3>Usage</h3>

<pre><code class="language-R">location_series(
  x,
  time_bp = NULL,
  time_ce = NULL,
  coords = NULL,
  bio_variables,
  dataset,
  path_to_nc = NULL,
  nn_interpol = FALSE,
  buffer = FALSE,
  directions = 8
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>x</code></td>
<td>
<p>a data.frame with columns of x and y coordinates (and an optional <code>name</code> column),
or a vector of cell numbers. See <code>coords</code> for standard coordinate names, or
how to use custom ones.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>time_bp</code></td>
<td>
<p>time slices in years before present (negative values represent
time before present, positive values time in the future). This parameter can
be a vector of times (the slices need
to exist in the dataset), a list with a min and max element setting the
range of values, or left to NULL to retrieve all time steps.
To check which slices are available, you can use
<code>get_time_bp_steps()</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>time_ce</code></td>
<td>
<p>time slice in years CE (see <code>time_bp</code> for options).
For available time slices in years CE, use <code>get_time_ce_steps()</code>.
Only one of <code>time_bp</code> or <code>time_ce</code> should be used.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>coords</code></td>
<td>
<p>a vector of length two giving the names of the "x" and "y"
coordinates, as found in <code>data</code>. If left to NULL, the function will
try to guess the columns based on standard names <code>c("x", "y")</code>, <code>c("X","Y")</code>,
<code>c("longitude", "latitude")</code>, or <code>c("lon", "lat")</code></p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>bio_variables</code></td>
<td>
<p>vector of names of variables to be extracted.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>dataset</code></td>
<td>
<p>string defining the dataset to use. If set to "custom",
then a single nc file is used from "path_to_nc"</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>path_to_nc</code></td>
<td>
<p>the path to the custom nc file containing the palaeoclimate
reconstructions. All the variables of interest need to be included in
this file.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>nn_interpol</code></td>
<td>
<p>boolean determining whether nearest neighbour
interpolation is used to estimate climate for cells that lack such
information (i.e. they are under water or ice). By default, interpolation is only
performed from the first ring of nearest neighbours; if climate is not
available, NA will be returned for that location. The number of neighbours
can be changed with the argument <code>directions</code>. <code>nn_interpol</code> defaults to FALSE
(this is DIFFERENT from <code>location_slice()</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>buffer</code></td>
<td>
<p>boolean determining whether the variable will be returned
as the mean of a buffer around the focal cell. If set to TRUE, it overrides
<code>nn_interpol</code> (which provides the same estimates as <code>buffer</code> but only for
locations that are in cells with an NA). The buffer size is determined
by the argument <code>directions</code>. <code>buffer</code> defaults to FALSE.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>directions</code></td>
<td>
<p>character or matrix to indicate the directions in which
cells are considered connected when using <code>nn_interpol</code> or <code>buffer</code>.
The following character values are allowed: "rook" or "4" for the
horizontal and vertical neighbours; "bishop" to get the diagonal neighbours;
"queen" or "8" to get the vertical, horizontal and diagonal neighbours;
or "16" for knight and one-cell queen move neighbours. If directions
is a matrix it should have odd dimensions and have logical (or 0, 1) values.</p>
</td>
</tr>
</table>
<h3>Value</h3>

<p>a data.frame with the climatic variables of interest
</p>


</div>