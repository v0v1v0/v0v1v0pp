<div class="container">

<table style="width: 100%;"><tr>
<td>appendPed</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>Simulate new generations from an existing pedigree</h2>

<h3>Description</h3>

<p>Simulate pedigree, genetic merits and phenotypes with random/assortative/disassortative matings
followed by random/non-random selection of males and females with similar/different selection patterns in males and females,
starting from an existing pedigree.
</p>


<h3>Usage</h3>

<pre><code class="language-R">appendPed(
  ped,
  Va0,
  Ve,
  littersize = 1,
  ngen,
  mort.rate = 0,
  overlap.s = 0,
  overlap.d = 0,
  f.rate = 1,
  m.rate = 1,
  fsel = "R",
  msel = "R",
  f.order = "fsel",
  m.order = "msel",
  seed = NA
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>ped</code></td>
<td>
<p>: The input pedigree <code>data.frame</code> with 9 columns: ID, SIRE, DAM, SEX,
GEN (generation), PA (parent average), MS (Mendelian Sampling), E (environment and residuals), and P (phenotype).
Note that PA + MS + E = P - <code class="reqn">\mu</code>, where <code class="reqn">\mu</code> is the population mean,
and PA + MS = BV (genetic merit or breeding value).
If MS and E are unknown, those can be set to 0.
PA should be equal to the average of sire BV (SBV) and dam BV (DBV).
If this condition is not met, PA - (SBV + DBV)/2 is added to MS and (SBV + DBV)/2 replaces PA.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>Va0</code></td>
<td>
<p>: Additive genetic variance in the base generation (i.e., F0).</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>Ve</code></td>
<td>
<p>: Residual variance, constant across generations.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>littersize</code></td>
<td>
<p>: Litter size, default = 1.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>ngen</code></td>
<td>
<p>: Number of generations to simulate after the founder generation.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>mort.rate</code></td>
<td>
<p>: Mortality rate per generation, after the availability of phenotype (e.g., birth weight, weaning weight)
and before the age of maturity (i.e., before mating), default = 0. Maximum <code>mort.rate</code> = 0.5.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>overlap.s</code></td>
<td>
<p>: Number of overlapping generations for sires, default = 0 for no generation overlap.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>overlap.d</code></td>
<td>
<p>: Number of overlapping generations for dams, default = 0 for no generation overlap.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>f.rate</code></td>
<td>
<p>: Proportion of females selected as dams, default = 1.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>m.rate</code></td>
<td>
<p>: Proportion of males (<code>&lt;= f.rate</code>) selected as sires, default = 1.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>fsel</code></td>
<td>
<p>: If <code>"R"</code> (default), random selection on females;
if <code>"P"</code>, selection on phenotypes or true breeding values if <code>Ve</code> = 0;
if <code>"PA"</code>, selection on true parent averages.
<code>"-P"</code> and <code>"-PA"</code> work in opposite direction of <code>"P"</code> and <code>"PA"</code>, respectively.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>msel</code></td>
<td>
<p>: If <code>"R"</code> (default), random selection on males;
if <code>"P"</code>, selection on phenotypes or true breeding values if <code>Ve</code> = 0;
if <code>"PA"</code>, selection on true parent averages.
<code>"-P"</code> and <code>"-PA"</code> work in opposite direction of <code>"P"</code> and <code>"PA"</code>, respectively.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>f.order</code></td>
<td>
<p>: Ordering selected females for mating;
if <code>"fsel"</code> (default), same as the selection order;
if <code>"R"</code> random ordering;
if <code>"P"</code>, ordering based on phenotypes or true breeding values if <code>Ve</code> = 0;
if <code>"PA"</code>, ordering based on true parent averages.
<code>"-P"</code> and <code>"-PA"</code> work in opposite direction of <code>"P"</code> and <code>"PA"</code>, respectively.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>m.order</code></td>
<td>
<p>: Ordering selected males for mating;
if <code>"msel"</code> (default), same as the selection order;
if <code>"R"</code> random ordering;
if <code>"P"</code>, ordering based on phenotypes or true breeding values if <code>Ve</code> = 0;
if <code>"PA"</code>, ordering based on true parent averages.
<code>"-P"</code> and <code>"-PA"</code> work in opposite direction of <code>"P"</code> and <code>"PA"</code>, respectively.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>seed</code></td>
<td>
<p>: A numeric variable input to the random number generator for reproducible simulations,
default = 'NA' for non-reproducible simulations.</p>
</td>
</tr>
</table>
<h3>Value</h3>

<p>ped2 : New generations appended to the input pedigree <code>data.frame</code>.
</p>


<h3>Examples</h3>

<pre><code class="language-R">ped = simulatePed(
    F0size = 100,
    Va0 = 9,
    Ve = 36,
    littersize = 2,
    ngen = 4,
    mort.rate = 0.05,
    overlap.s = 1,
    overlap.d = 0,
    f.rate = 0.8,
    m.rate = 0.5,
    fsel = "P",
    msel = "PA"
)
ped2 = appendPed(
    ped = ped,
    Va0 = 9,
    Ve = 36,
    littersize = 2,
    ngen = 2,
    mort.rate = 0.05,
    overlap.s = 1,
    overlap.d = 0,
    f.rate = 0.8,
    m.rate = 0.5,
    fsel = "R",
    msel = "R",
    f.order = "P",
    m.order = "PA",
    seed = 76
)

</code></pre>


</div>