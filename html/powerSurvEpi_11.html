<div class="container">

<table style="width: 100%;"><tr>
<td>powerEpi.default</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2> Power Calculation for Cox Proportional Hazards Regression with Two Covariates for Epidemiological Studies</h2>

<h3>Description</h3>

<p>Power calculation for Cox proportional hazards regression with two covariates for epidemiological Studies. The covariate of interest should be a binary variable. The other covariate can be either binary or non-binary. The formula takes
into account competing risks and the correlation between the two covariates.
</p>


<h3>Usage</h3>

<pre><code class="language-R">powerEpi.default(n, 
		 theta, 
		 p, 
		 psi, 
		 rho2, 
		 alpha = 0.05)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>n</code></td>
<td>
<p>integer. total number of subjects </p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>theta</code></td>
<td>
<p>numeric. postulated hazard ratio </p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>p</code></td>
<td>
<p>numeric. proportion of subjects taking the value one for the covariate of interest. </p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>psi</code></td>
<td>
<p>numeric. proportion of subjects died of the disease of interest. </p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>rho2</code></td>
<td>
<p>numeric. square of the correlation between the covariate of interest and the other covariate. </p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>alpha</code></td>
<td>
<p>numeric. type I error rate. </p>
</td>
</tr>
</table>
<h3>Details</h3>

<p>This is an implementation of the power calculation formula 
derived by Latouche et al. (2004)
for the following Cox proportional hazards regression in the epidemiological
studies:
</p>
<p style="text-align: center;"><code class="reqn">h(t|x_1, x_2)=h_0(t)\exp(\beta_1 x_1+\beta_2 x_2),</code>
</p>

<p>where the covariate <code class="reqn">X_1</code> is of our interest. The covariate <code class="reqn">X_1</code> should be
a binary variable taking two possible values: zero and one, while the 
covariate <code class="reqn">X_2</code> can be binary or continuous.
</p>
<p>Suppose we want to check if the hazard of <code class="reqn">X_1=1</code> is equal to 
the hazard of <code class="reqn">X_1=0</code> or not. Equivalently, we want to check if 
the hazard ratio of <code class="reqn">X_1=1</code> to <code class="reqn">X_1=0</code> is equal to <code class="reqn">1</code> 
or is equal to <code class="reqn">\exp(\beta_1)=\theta</code>.
Given the type I error rate <code class="reqn">\alpha</code> for a two-sided test, the power
required to detect a hazard ratio as small as <code class="reqn">\exp(\beta_1)=\theta</code> is
</p>
<p style="text-align: center;"><code class="reqn">power=\Phi\left(-z_{1-\alpha/2}+\sqrt{n[\log(\theta)]^2
p (1-p) \psi (1-\rho^2)}\right),</code>
</p>

<p>where  <code class="reqn">z_{a}</code> is the <code class="reqn">100 a</code>-th percentile of the standard normal distribution, <code class="reqn">\psi</code> is the proportion of subjects died of
the disease of interest, and 
</p>
<p style="text-align: center;"><code class="reqn">\rho=corr(X_1, X_2)=(p_1-p_0)\times \sqrt{\frac{q(1-q)}{p(1-p)}},</code>
</p>
 
<p>and
<code class="reqn">p=Pr(X_1=1)</code>, <code class="reqn">q=Pr(X_2=1)</code>, <code class="reqn">p_0=Pr(X_1=1|X_2=0)</code>,
and <code class="reqn">p_1=Pr(X_1=1 | X_2=1)</code>.
</p>


<h3>Value</h3>

<p>The power of the test.
</p>


<h3>Note</h3>

 
<p>(1) The formula can be used to calculate
power for a randomized trial study by setting <code>rho2=0</code>.
</p>
<p>(2) When <code>rho2=0</code>, the formula derived by Latouche et al. (2004)
looks the same as that derived by Schoenfeld (1983). Latouche et al. (2004) pointed out that in this situation, the interpretations are different hence
the two formulae are actually different. In Latouched et al. (2004), the
hazard ratio <code class="reqn">\theta</code> measures the difference of effect of a covariate 
at two different levels on  the subdistribution hazard for a particular failure, 
while in Schoenfeld (1983), the hazard ratio <code class="reqn">\theta</code> measures 
the difference of effect on the cause-specific hazard.
</p>


<h3>References</h3>

 
<p>Schoenfeld DA. (1983).
Sample-size formula for the proportional-hazards regression model.
<em>Biometrics</em>. 39:499-503.
</p>
<p>Latouche A., Porcher R. and Chevret S. (2004).
Sample size formula for proportional hazards modelling of competing risks.
<em>Statistics in Medicine</em>. 23:3263-3274.
</p>


<h3>See Also</h3>

 <p><code>powerEpi</code> </p>


<h3>Examples</h3>

<pre><code class="language-R">  # Example at the end of Section 5.2 of Latouche et al. (2004)
  # for a cohort study.
  powerEpi.default(n = 139, 
		   theta = 2, 
		   p = 0.39, 
		   psi = 0.505,
                   rho2 = 0.132^2, 
		   alpha = 0.05)

</code></pre>


</div>