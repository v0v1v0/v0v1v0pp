<div class="container">

<table style="width: 100%;"><tr>
<td>pvargmm</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>GMM Estimation of Panel VAR Models</h2>

<h3>Description</h3>

<p>Estimates a panel vector autoregressive (PVAR) model with fixed effects.
</p>


<h3>Usage</h3>

<pre><code class="language-R">pvargmm(
  dependent_vars,
  lags,
  predet_vars,
  exog_vars,
  transformation = "fd",
  data,
  panel_identifier = c(1, 2),
  steps,
  system_instruments = FALSE,
  system_constant = TRUE,
  pca_instruments = FALSE,
  pca_eigenvalue = 1,
  max_instr_dependent_vars,
  max_instr_predet_vars,
  min_instr_dependent_vars = 2L,
  min_instr_predet_vars = 1L,
  collapse = FALSE,
  tol = 1e-09,
  progressbar = TRUE
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>dependent_vars</code></td>
<td>
<p>Dependent variables</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>lags</code></td>
<td>
<p>Number of lags of dependent variables</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>predet_vars</code></td>
<td>
<p>Predetermined variables</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>exog_vars</code></td>
<td>
<p>Exogenous variables</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>transformation</code></td>
<td>
<p>First-difference <code>"fd"</code> or forward orthogonal deviations <code>"fod"</code></p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>data</code></td>
<td>
<p>Data set</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>panel_identifier</code></td>
<td>
<p>Vector of panel identifiers</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>steps</code></td>
<td>
<p><code>"onestep"</code>, <code>"twostep"</code> or <code>"mstep"</code>   estimation</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>system_instruments</code></td>
<td>
<p>System GMM estimator</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>system_constant</code></td>
<td>
<p>Constant only available with the System GMM estimator in each equation</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>pca_instruments</code></td>
<td>
<p>Apply PCA to instruments matrix</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>pca_eigenvalue</code></td>
<td>
<p>Cut-off eigenvalue for PCA analysis</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>max_instr_dependent_vars</code></td>
<td>
<p>Maximum number of instruments for dependent variables</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>max_instr_predet_vars</code></td>
<td>
<p>Maximum number of instruments for predetermined variables</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>min_instr_dependent_vars</code></td>
<td>
<p>Minimum number of instruments for dependent variables</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>min_instr_predet_vars</code></td>
<td>
<p>Minimum number of instruments for predetermined variables</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>collapse</code></td>
<td>
<p>Use collapse option</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>tol</code></td>
<td>
<p>relative tolerance to detect zero singular values in <code>"ginv"</code></p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>progressbar</code></td>
<td>
<p>show progress bar</p>
</td>
</tr>
</table>
<h3>Details</h3>

<p>The first vector autoregressive panel model (PVAR) was introduced by Holtz-Eakin et al. (1988). Binder et al. (2005) extend their equation-by-equation estimator for a PVAR model with only endogenous variables that are lagged by one period. We further improve this model in Sigmund and Ferstl (2021) to allow for <code class="reqn">p</code> lags of <code class="reqn">m</code> endogenous variables, <code class="reqn">k</code> predetermined variables and <code class="reqn">n</code> strictly exogenous variables.
</p>
<p>Therefore, we consider the following stationary PVAR with fixed effects.
</p>
<b>y</b><sub><i>i,t</i></sub> = <b>μ</b><sub><i>i</i></sub> + ∑<sub><i>l=1</i></sub><sup>p</sup><b>A</b><sub><i>l</i></sub><b>y</b><sub><i>i,t-l</i></sub> + <b>B</b><b>x</b><sub><i>i,t</i></sub> + <b>C</b><b>s</b><sub><i>i,t</i></sub> + <b>ε</b><sub><i>i,t</i></sub><p></p>
Let <b>y</b><sub><i>i,t</i></sub> ∈ ℜ<sup><i>m</i></sup> be an <i>m×1</i> vector of <b>endogenous variables</b> for the <i>i</i>th cross-sectional unit at time <i>t</i>. Let <b>y</b><sub><i>i,t-l</i></sub> ∈ ℜ<sup><i>m</i></sup> be an <i>m×1</i> vector of <b>lagged endogenous variables</b>. Let <b>x</b><sub><i>i,t</i></sub> ∈ ℜ<sup><i>k</i></sup> be an <i>k×1</i> vector of <b>predetermined variables</b> that are potentially correlated with past errors. Let <b>s</b><sub><i>i,t</i></sub> ∈ ℜ<sup><i>n</i></sup> be an <i>n×1</i> vector of <b>strictly exogenous variables</b> that neither depend on <b>ε</b><sub><i>i,t</i></sub> nor on <b>ε</b><sub><i>i,t-s</i></sub> for <i>s = 1,…,T</i>. The idiosyncratic error vector <b>ε</b><sub><i>i,t</i></sub> ∈ ℜ<sup><i>m</i></sup> is assumed to be well-behaved and independent from both the regressors <b>x</b><sub><i>i,t</i></sub>  and <b>s</b><sub><i>i,t</i></sub> and the individual error component <b>μ</b><sub><i>i</i></sub>. Stationarity requires that all unit roots of the PVAR model fall inside the unit circle, which therefore places some constraints on the <b>fixed effect</b> <b>μ</b><sub><i>i</i></sub>. The cross section <i>i</i> and the time section <i>t</i>  are defined as follows: <i>i = 1,…,N</i> and <i>t = 1,…T</i>. In this specification we assume parameter homogeneity for <b>A</b><sub><i>l</i></sub><i>(m×m)</i>, <b>B</b> <i>(m×k)</i> and <b>C</b> <i>(m×n)</i> for all <i>i</i>.
<p>A PVAR model is hence a combination of a single equation dynamic panel model (DPM) and a vector autoregressive model (VAR).
</p>
<p>First difference and system GMM estimators for single equation dynamic panel data models have been implemented in the STATA package <code>xtabond2</code> by Roodman (2009) and some of the features are also available in the R package <span class="pkg">plm</span>.
</p>
<p>For more technical details on the estimation, please refer to our paper Sigmund and Ferstl (2021).
</p>
<p>There we define the first difference moment conditions (see Holtz-Eakin et al., 1988; Arellano and Bond, 1991), formalize the ideas to reduce the number of moment conditions by linear transformations of the instrument matrix and define the one- and two-step GMM estimator. Furthermore, we setup the system moment conditions as defined in Blundell and Bond (1998) and present the extended GMM estimator. In addition to the GMM-estimators we contribute to the literature by providing specification tests (Hansen overidentification test, lag selection criterion and stability test of the PVAR polynomial) and classical structural analysis for PVAR models such as orthogonal and generalized impulse response functions, bootstrapped confidence intervals for impulse response analysis and forecast error variance decompositions. Finally, we implement the first difference and the forward orthogonal transformation to remove the fixed effects.
</p>


<h3>Value</h3>

<p>A <code>pvargmm</code> object containing the estimation results.
</p>


<h3>References</h3>

<p>Arellano, M., Bond, S. (1991) Some Tests of Specification for Panel Sata: Monte Carlo Evidence and an Application to Employment Equations <em>The Review of Economic Studies</em>, <b>58</b>(2), 277–297, <a href="https://doi.org/10.2307/2297968">doi:10.2307/2297968</a>
</p>
<p>Binder M., Hsiao C., Pesaran M.H. (2005) Estimation and Inference in Short Panel Vector Autoregressions with Unit Roots and Cointegration <em>Econometric Theory</em>, <b>21</b>(4), 795–837, <a href="https://doi.org/10.1017/S0266466605050413">doi:10.1017/S0266466605050413</a>
</p>
<p>Blundell R., Bond S. (1998). Initial Conditions and Moment Restrictions in Dynamic Panel Data Models <em>Journal of Econometrics</em>, <b>87</b>(1), 115–143, <a href="https://doi.org/10.1016/S0304-4076%2898%2900009-8">doi:10.1016/S0304-4076(98)00009-8</a>
</p>
<p>Holtz-Eakin D., Newey W., Rosen H.S. (1988) Estimating Vector Autoregressions with Panel Data, <em>Econometrica</em>, <b>56</b>(6), 1371–1395, <a href="https://doi.org/10.2307/1913103">doi:10.2307/1913103</a>
</p>
<p>Roodman, D. (2009) How to Do xtabond2: An Introduction to Difference and System GMM in Stata <em>The Stata Journal</em>, <b>9</b>(1), 86–136, <a href="https://www.stata-journal.com/article.html?article=st0159">https://www.stata-journal.com/article.html?article=st0159</a>
</p>
<p>Sigmund, M., Ferstl, R. (2021) Panel Vector Autoregression in R with the Package panelvar <em>The Quarterly Review of Economics and Finance</em> <a href="https://doi.org/10.1016/j.qref.2019.01.001">doi:10.1016/j.qref.2019.01.001</a>
</p>


<h3>See Also</h3>

<p><code>stability</code> for stability tests
</p>
<p><code>oirf</code> and <code>girf</code> for orthogonal and generalized impulse response functions (including bootstrapped confidence intervals)
</p>
<p><code>coef.pvargmm</code>, <code>se</code>, <code>pvalue</code>, <code>fixedeffects</code> for extrator functions for the most important results
</p>
<p><code>fevd_orthogonal</code> for forecast error variance decomposition
</p>


<h3>Examples</h3>

<pre><code class="language-R">## Not run: 
library(panelvar)
data(abdata)
ex3_abdata &lt;-pvargmm(
 dependent_vars = c("emp"),
 lags = 4,
 predet_vars = c("wage"),
 exog_vars = c("cap"),
 transformation = "fd",
 data = abdata,
 panel_identifier = c("id", "year"),
 steps = c("twostep"),
 system_instruments = TRUE,
 max_instr_dependent_vars = 99,
 max_instr_predet_vars = 99,
 min_instr_dependent_vars = 2L,
 min_instr_predet_vars = 1L,
 collapse = FALSE
)

## End(Not run)
data("ex3_abdata")
summary(ex3_abdata)

data("Dahlberg")
## Not run: 
ex1_dahlberg_data &lt;- pvargmm(dependent_vars = c("expenditures", "revenues", "grants"),
                             lags = 1,
                             transformation = "fod",
                             data = Dahlberg,
                             panel_identifier=c("id", "year"),
                             steps = c("twostep"),
                             system_instruments = FALSE,
                             max_instr_dependent_vars = 99,
                             max_instr_predet_vars = 99,
                             min_instr_dependent_vars = 2L,
                             min_instr_predet_vars = 1L,
                             collapse = FALSE
)

## End(Not run)
data("ex1_dahlberg_data")
summary(ex1_dahlberg_data)
</code></pre>


</div>