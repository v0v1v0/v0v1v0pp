<div class="container">

<table style="width: 100%;"><tr>
<td>dag2essgraph</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>Convert a DAG to an Essential Graph</h2>

<h3>Description</h3>

<p>Convert a DAG to an (interventional or observational) essential graph.
</p>


<h3>Usage</h3>

<pre><code class="language-R">dag2essgraph(dag, targets = list(integer(0)))
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>dag</code></td>
<td>
<p>The DAG whose essential graph has to be calculated.  Different
representations are possible: <code>dag</code> can be an 
object of <code>graphNEL</code> (package <span class="pkg">graph</span>) or 
an instance of a class derived from <code>ParDAG</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>targets</code></td>
<td>
<p>List of intervention targets with respect to which the 
essential graph has to be calculated.  An observational setting is
represented by one single empty target (<code>list(integer(0))</code>).</p>
</td>
</tr>
</table>
<h3>Details</h3>

<p>This function converts a DAG to its corresponding (interventional or 
observational) essential graph, using the algorithm of Hauser and Bühlmann
(2012).
</p>
<p>The essential graph is a partially directed graph that represents the
(interventional or observational) Markov equivalence class of a DAG.  It has
the same has the same skeleton as the DAG; a directed edge represents an
arrow that has a common orientation in all representatives of the 
(interventional or observational) Markov equivalence class, whereas an
undirected edge represents an arrow that has different orientations in
different representatives of the equivalence class.  In the observational 
case, the essential graph is also known as “CPDAG” (Spirtes <em>et al.</em>,
2000).
</p>
<p>In a purely observational setting (<em>i.e.</em>, if <code>targets = 
  list(integer(0))</code>), the function yields the same graph as 
<code>dag2cpdag</code>.
</p>


<h3>Value</h3>

<p>Depending on the class of <code>dag</code>, the essential graph is returned as
</p>

<ul>
<li>
<p>an instance of <code>graphNEL</code>, if <code>dag</code> is an 
instance of <code>graphNEL</code>,
</p>
</li>
<li>
<p>an instance of <code>EssGraph</code>, if <code>dag</code> is
an instance of a class derived from <code>ParDAG</code>.
</p>
</li>
</ul>
<h3>Author(s)</h3>

<p>Alain Hauser (<a href="mailto:alain.hauser@bfh.ch">alain.hauser@bfh.ch</a>)
</p>


<h3>References</h3>

<p>A. Hauser and P. Bühlmann (2012).  Characterization and greedy learning of 
interventional Markov equivalence classes of directed acyclic graphs.
<em>Journal of Machine Learning Research</em> <b>13</b>, 2409–2464.
</p>
<p>P. Spirtes, C.N. Glymour, and R. Scheines (2000).  <em>Causation,
Prediction, and Search</em>, MIT Press, Cambridge (MA).
</p>


<h3>See Also</h3>

<p><code>dag2cpdag</code>, <code>Score</code>, <code>EssGraph</code>
</p>


<h3>Examples</h3>

<pre><code class="language-R">p &lt;- 10     # Number of random variables
s &lt;- 0.4    # Sparseness of the DAG

## Generate a random DAG
set.seed(42)
require(graph)
dag &lt;- randomDAG(p, s)
nodes(dag) &lt;- sprintf("V%d", 1:p)

## Calculate observational essential graph
res.obs &lt;- dag2essgraph(dag)

## Different argument classes
res2 &lt;- dag2essgraph(as(dag, "GaussParDAG"))
str(res2)

## Calculate interventional essential graph for intervention targets
## {1} and {3}
res.int &lt;- dag2essgraph(dag, as.list(c(1, 3)))
</code></pre>


</div>