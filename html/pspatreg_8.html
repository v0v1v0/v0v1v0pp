<div class="container">

<table style="width: 100%;"><tr>
<td>fit_terms</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>Compute terms of the non-parametric covariates in the
semiparametric regression models.</h2>

<h3>Description</h3>

<p>The <code>fit_terms</code> function compute both:
</p>

<ul>
<li>
<p> Non-parametric spatial (2d) or spatio-temporal (3d) trends 
including the decomposition in main and interaction trends 
when the model is ANOVA.
</p>
</li>
<li>
<p> Smooth functions <code class="reqn">f(x_i)</code> for non-parametric covariates 
in semiparametric models. It also includes standard errors and the 
decomposition of each non-parametric
term in fixed and random parts.
</p>
</li>
</ul>
<h3>Usage</h3>

<pre><code class="language-R">fit_terms(object, variables, intercept = FALSE)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>object</code></td>
<td>
<p>object fitted using <code>pspatfit</code> function.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>variables</code></td>
<td>
<p>vector including names of non-parametric covariates. 
To fit the terms of non-parametric spatial (2d) or spatio-temporal 
(3d) trend this argument must be set equal to 'spttrend'. 
See <code>examples</code> in this function.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>intercept</code></td>
<td>
<p>add intercept to fitted term. Default = FALSE.</p>
</td>
</tr>
</table>
<h3>Value</h3>

<p>A list including:
</p>

<table>
<tr>
<td style="text-align: left;">
    <em>fitted_terms</em> </td>
<td style="text-align: left;"> Matrix including terms in columns. </td>
</tr>
<tr>
<td style="text-align: left;">
    <em>se_fitted_terms</em> </td>
<td style="text-align: left;"> Matrix including standard errors of terms 
      in columns. </td>
</tr>
<tr>
<td style="text-align: left;">
    <em>fitted_terms_fixed</em> </td>
<td style="text-align: left;"> Matrix including fixed part of terms 
      in columns. </td>
</tr>
<tr>
<td style="text-align: left;">
    <em>se_fitted_terms_fixed</em> </td>
<td style="text-align: left;"> Matrix including standard errors of 
      fixed part of terms in columns. </td>
</tr>
<tr>
<td style="text-align: left;">
    <em>fitted_terms_random</em> </td>
<td style="text-align: left;"> Matrix including random part of terms 
      in columns. </td>
</tr>
<tr>
<td style="text-align: left;">
    <em>se_fitted_terms_random</em> </td>
<td style="text-align: left;"> Matrix including standard errors of 
      random part of terms in columns.</td>
</tr>
<tr>
<td style="text-align: left;">
 </td>
</tr>
</table>
<p>This object can be used as an argument of <code>plot_terms</code> function
to make plots of both non-parametric trends and smooth functions of 
covariates. See <em>examples</em> below.
</p>


<h3>Author(s)</h3>


<table>
<tr>
<td style="text-align: left;"> 
  Roman Minguez  </td>
<td style="text-align: left;"> <a href="mailto:roman.minguez@uclm.es">roman.minguez@uclm.es</a> </td>
</tr>
<tr>
<td style="text-align: left;">
  Roberto Basile </td>
<td style="text-align: left;"> <a href="mailto:roberto.basile@univaq.it">roberto.basile@univaq.it</a> </td>
</tr>
<tr>
<td style="text-align: left;"> Maria Durban </td>
<td style="text-align: left;">
  <a href="mailto:mdurban@est-econ.uc3m.es">mdurban@est-econ.uc3m.es</a> </td>
</tr>
<tr>
<td style="text-align: left;"> Gonzalo Espana-Heredia </td>
<td style="text-align: left;">
  <a href="mailto:gehllanza@gmail.com">gehllanza@gmail.com</a> </td>
</tr>
<tr>
<td style="text-align: left;"> 
 </td>
</tr>
</table>
<h3>References</h3>

 
<ul>
<li>
<p> Lee, D. and Durban, M. (2011). P-Spline ANOVA Type Interaction 
Models for Spatio-Temporal Smoothing. <em>Statistical Modelling</em>, 
(11), 49-69. &lt;doi:10.1177/1471082X1001100104&gt;
</p>
</li>
<li>
<p> Eilers, P. and Marx, B. (2021). <em>Practical Smoothing. 
The Joys of P-Splines</em>. Cambridge University Press.
</p>
</li>
<li>
<p> Fahrmeir, L.; Kneib, T.;  Lang, S.; and Marx, B. (2021). 
<em>Regression. Models, Methods and Applications (2nd Ed.)</em>.
Springer.
</p>
</li>
<li>
<p> Wood, S.N. (2017). <em>Generalized Additive Models. 
An Introduction with <code>R</code></em> (second edition). CRC Press, Boca Raton.
</p>
</li>
</ul>
<h3>See Also</h3>


<ul>
<li> <p><code>pspatfit</code> estimate spatial or spatio-temporal 
semiparametric regression models. The model can be of type <em>ps-sim</em>,
<em>ps-sar</em>, <em>ps-slx</em>, <em>ps-sem</em>, <em>ps-sdm</em> or 
<em>ps-sarar</em>.
</p>
</li>
<li> <p><code>plot_terms</code> plot smooth functions of non-parametric
covariates.
</p>
</li>
</ul>
<h3>Examples</h3>

<pre><code class="language-R">###################### Examples using a panel data of rate of unemployment 
###################### in 103 Italian provinces during the period 1996-2014.
library(pspatreg)
data(unemp_it, package = "pspatreg")
lwsp_it &lt;- spdep::mat2listw(Wsp_it)
#######  No Spatial Trend: PSAR including a spatial 
#######  lag of the dependent variable
form1 &lt;- unrate ~ partrate + agri + cons + 
                  pspl(serv, nknots = 15) +
                  pspl(empgrowth, nknots = 20)  
gamsar &lt;- pspatfit(form1, data = unemp_it, 
                    type = "sar", listw = lwsp_it)
summary(gamsar)

######  Fit non-parametric terms 
######  (spatial trend must be name "spttrend")
list_varnopar &lt;- c("serv", "empgrowth")
terms_nopar &lt;- fit_terms(gamsar, list_varnopar)

######################  Plot non-parametric terms
plot_terms(terms_nopar, unemp_it)
 
</code></pre>


</div>