<div class="container">

<table style="width: 100%;"><tr>
<td>rarecol</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>Rarefaction curve of colonization events</h2>

<h3>Description</h3>

<p>A creation of rarefaction curves considering both genetic and field data.
First, the function samples variable positions and then samples populations
for each variable position. Second, it samples populations and then samples
variable positions for each population.
</p>


<h3>Usage</h3>

<pre><code class="language-R">rarecol(data, network, replicates_field = 10,
        replicates_genetic = 10, mode = c(1, 2), monitor = TRUE,
        file = NULL)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>data</code></td>
<td>

<p>a data frame containing the occurrence matrix of haplotypes in the
islands of an archipelago (applicable to any island-like system). The
first two columns indicate islands and populations sampled. Successive
columns indicate haplotype occurrences (one column per haplotype). If
present, missing haplotypes must also be included (i.e. columns without
occurrences).
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>network</code></td>
<td>

<p>a data frame containing the genealogy of haplotypes. The first column
indicates the haplotype, the second column indicates its ancestral
haplotype and the third column indicates the variable position changed
between an haplotype and its ancestral haplotype. If present, missing
haplotypes must also be included. The ancestral haplotype must be
connected to an outgroup named <code>"OUT"</code>, located in the first row of
the data frame, and has a variable position not shared with other
connections.
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>replicates_field</code></td>
<td>

<p>numeric. Number of replicates for field resampling. Each replicate adds
populations from one to the total number of populations in the dataset
and infers the corresponding number of colonization events.
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>replicates_genetic</code></td>
<td>

<p>numeric. Number of replicates for genetic resampling. Each replicate
adds variable positions from none (chorology) to the total number of
variable positions in the dataset and infers the corresponding number of
colonization events.
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>monitor</code></td>
<td>

<p>logical. If <code>TRUE</code> it shows progress in the console.
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>mode</code></td>
<td>

<p>numeric vector. Indicates which estimations must be conducted. 1 for
genetic estimation and 2 for field estimation. By default the function
conducts both processes.
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>file</code></td>
<td>

<p>character string determining the name of the file to save rarefaction
curves built by this function. Two files are created, one for genetic
estimation and one for field estimation. If a file name is indicated,
the function does not return any result, all the results are saved in
the indicated files. If set to <code>NULL</code>, the data are showed as
output.
</p>
</td>
</tr>
</table>
<h3>Value</h3>

<p><code>rarecol</code> returns an object of <code>class</code>
<code>"rarecol"</code>. The return is a list containing information about the two
rarefaction curves generated.
</p>


<h3>References</h3>

<p>Coello, A.J., Fernandez-Mazuecos, M., Heleno, R.H., Vargas, P. (2022).
PAICE: A new R package to estimate the number of inter-island colonizations
considering haplotype data and sample size. <em>Journal of Biogeography</em>,
49(4), 577-589.DOI:
<a href="https://onlinelibrary.wiley.com/doi/10.1111/jbi.14341">10.1111/jbi.14341</a>
</p>


<h3>See Also</h3>

<p>To describe the number of colonization events observed in the most complete
case, use the function <code>colonization</code>. <code>maxCol</code>,
which estimates the number of colonization events of data generated by this
funtion. <code>plot.rarecol</code> to plot the result of this function.
<code>read.rarecol</code> to import files generated from this function.
</p>


<h3>Examples</h3>

<pre><code class="language-R">
data(CmonsData)
data(CmonsNetwork)
# Build rarefaction curves with 5 field and genetic replicates
## Note: more replicates are needed to build accurate curves
## Note: 5 replicates are relatively fast and adequate to
##       explore the data
rcol &lt;- rarecol(data = CmonsData, network = CmonsNetwork,
                replicates_field = 5, replicates_genetic = 5,
                monitor = TRUE, mode = c(1, 2))
old.par &lt;- par(no.readonly = TRUE) # To restore previous options
par(mfrow = c(1, 2))
plot(rcol) # Plotting results
par(old.par)
</code></pre>


</div>