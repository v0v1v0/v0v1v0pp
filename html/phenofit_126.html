<div class="container">

<table style="width: 100%;"><tr>
<td>qcFUN</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>Initial weights according to qc</h2>

<h3>Description</h3>


<ul>
<li> <p><code>getBits</code>: Extract bitcoded QA information from bin value
</p>
</li>
<li> <p><code>qc_summary</code>: Initial weigths based on Quality reliability of VI pixel,
suit for MOD13A1, MOD13A2 and MOD13Q1 (SummaryQA band).
</p>
</li>
<li> <p><code>qc_5l</code>: Initial weights based on Quality control of five-level
confidence score, suit for MCD15A3H(LAI, FparLai_QC), MOD17A2H(GPP, Psn_QC)
and MOD16A2(ET, ET_QC).
</p>
</li>
<li> <p><code>qc_StateQA</code>: Initial weights based on <code>StateQA</code>, suit for MOD09A1, MYD09A1.
</p>
</li>
<li> <p><code>qc_FparLai</code>: For MODIS LAI
</p>
</li>
<li> <p><code>qc_NDVI3g</code>: For AVHRR NDVI3g
</p>
</li>
<li> <p><code>qc_NDVIv4</code>: For AVHRR NDVIv4
</p>
</li>
</ul>
<h3>Usage</h3>

<pre><code class="language-R">getBits(x, start, end = start)

qc_summary(QA, wmin = 0.2, wmid = 0.5, wmax = 1)

qc_StateQA(QA, wmin = 0.2, wmid = 0.5, wmax = 1)

qc_FparLai(QA, FparLai_QC = NULL, wmin = 0.2, wmid = 0.5, wmax = 1)

qc_5l(QA, wmin = 0.2, wmid = 0.5, wmax = 1)

qc_NDVIv4(QA, wmin = 0.2, wmid = 0.5, wmax = 1)

qc_NDVI3g(QA, wmin = 0.2, wmid = 0.5, wmax = 1)

qc_SPOT(QA, wmin = 0.2, wmid = 0.5, wmax = 1)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>x</code></td>
<td>
<p>Binary value</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>start</code></td>
<td>
<p>Bit starting position, count from zero</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>end</code></td>
<td>
<p>Bit ending position</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>QA</code></td>
<td>
<p>quality control variable</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>wmin</code></td>
<td>
<p>Double, minimum weigth (i.e. weight of snow, ice and cloud).</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>wmid</code></td>
<td>
<p>Dougle, middle weight, i.e. marginal</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>wmax</code></td>
<td>
<p>Double, maximum weight, i.e. good</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>FparLai_QC</code></td>
<td>
<p>Another QC flag of <code>MCD15A3H</code></p>
</td>
</tr>
</table>
<h3>Details</h3>

<p>If <code>FparLai_QC</code> specified, <code>I_margin = SCF_QC &gt;= 2 &amp; SCF_QC &lt;= 3</code>.
</p>


<h3>Value</h3>

<p>A list object with
</p>

<ul>
<li> <p><code>weigths</code>: Double vector, initial weights.
</p>
</li>
<li> <p><code>QC_flag</code>: Factor vector, with the level of
<code>c("snow", "cloud", "shadow", "aerosol", "marginal", "good")</code>
</p>
</li>
</ul>
<h3>Note</h3>

<p><code>qc_5l</code> and <code>qc_NDVIv4</code> only returns <code>weight</code>, without <code>QC_flag</code>.
</p>


<h3>References</h3>

<p>https://developers.google.com/earth-engine/datasets/catalog/MODIS_006_MOD13A1
</p>
<p>https://developers.google.com/earth-engine/datasets/catalog/MODIS_006_MCD15A3H
</p>
<p>Erwin Wolters, Else Swinnen, Carolien Tot√©, Sindy Sterckx.
SPOT-VGT COLLECTION 3 PRODUCTS USER MANUAL V1.2, 2018, P47
</p>


<h3>See Also</h3>

<p><code>qc_sentinel2()</code>
</p>


<h3>Examples</h3>

<pre><code class="language-R">set.seed(100)
QA &lt;- as.integer(runif(100, 0, 2^7))

r1 &lt;- qc_summary(QA, wmin = 0.2, wmid = 0.5, wmax = 1)
r2 &lt;- qc_StateQA(QA, wmin = 0.2, wmid = 0.5, wmax = 1)
r_5l &lt;- qc_5l(QA, wmin = 0.2, wmid = 0.5, wmax = 1)
r_NDVI3g &lt;- qc_NDVI3g(QA, wmin = 0.2, wmid = 0.5, wmax = 1)
r_NDVIv4 &lt;- qc_NDVIv4(QA, wmin = 0.2, wmid = 0.5, wmax = 1)
</code></pre>


</div>