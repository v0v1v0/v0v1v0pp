<div class="container">

<table style="width: 100%;"><tr>
<td>lm.phylog</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>Linear Models from Simulated Data Sets</h2>

<h3>Description</h3>

<p>Fit a linear model to the data from a read.sim.data.
</p>


<h3>Usage</h3>

<pre><code class="language-R">lm.phylog(formula, data, max.num=0, weights=NULL, exclude.tips=NULL,
          lapply.size=100)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>formula</code></td>
<td>
<p> a formula with the same syntax as for any other linear
model in R (see help for lm: ?lm). </p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>data</code></td>
<td>
<p>a data frame —with a particular structure— with the observations; it will often be the
name of a data frame created using read.sim.data. </p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>max.num</code></td>
<td>
<p> if different from 0, maximum number of simulations to analyze</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>weights</code></td>
<td>
<p> an optional vector of weights to perform weighted least squares; can be a
column from the data frame or a vector in the parent environment (of
same length as any column of data before the data is reduced, if
appropriate, with exclude.tips and max.num arguments).</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>exclude.tips</code></td>
<td>
<p> an optional vector giving the names of tips to
exclude from the analyses.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>lapply.size</code></td>
<td>
<p> a tuning parameter that can affect the speed of
calculations; see Details</p>
</td>
</tr>
</table>
<h3>Details</h3>

<p>This function uses a loop over lapply calls (I got the idea from
Venables and Ripley (2000), ”S  programming”). By changing the
lapply.size you can change the size of the block over which lapply is
used. Changes can make a difference in speed; for instance, in my
machine from about 1 sec per simulation for a set with 49 species to less than 0.5
sec. The default value worked well in my machine, but your mileage
will vary.
</p>


<h3>Value</h3>

<p>A list of class phylog.lm with components
</p>
<table>
<tr style="vertical-align: top;">
<td><code>call</code></td>
<td>
<p>the function call.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>Fits</code></td>
<td>
<p>a data frame with the fitted coefficients for that model; the coefficients
for the non-simulated (”real”) data correspond to sim.counter=0.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>MarginalTests</code></td>
<td>
<p>a data frame with the F-tests.  The first column is the overall F-test for
the model, the rest are the marginal F-tests, respecting the
marginality principle or hierarchy of terms included.  The
coefficients for the non-simulated (”real”) data correspond to sim.counter=0.</p>
</td>
</tr>
</table>
<h3>Note</h3>

<p> The marginal F-tests returned are obtained from drop1, and thus
respect the marginality principle.  For instance,
if your model is y <code class="reqn">\sim</code>  x1 + x2*x3 you will see an F for x1 and an F
for x2:x3 but no F's for x2 or x3.  Discussion can be found,
for example, in Venables &amp; Ripley, (1999), ch. 6; see also Searle,
(1987), ch. 6, for the ANCOVA case.
</p>


<h3>Author(s)</h3>

<p>Ramon Diaz-Uriarte and Theodore Garland, Jr.</p>


<h3>References</h3>

<p>Diaz-Uriarte, R., and Garland, T., Jr., in prep. PHYLOGR:
an R package for the analysis of comparative data via Monte Carlo
simulations and generalized least squares approaches.
</p>
<p>Searle, S. R. (1987) <em>Linear models for unbalanced data.</em> Wiley
</p>
<p>Venables, W. N. and Ripley, B. D. (1999) <em>Modern applied
statistics with S-Plus, 3rd ed.</em> Springer-Verlag.
</p>
<p>Venables, W. N. and Ripley, B. D. (2000) <em>S programming.</em> Springer-Verlag.
</p>


<h3>See Also</h3>

 <p><code>summary.phylog.lm</code>, <code>plot.phylog.lm</code>,<code>read.sim.data</code>, <code>drop1</code></p>


<h3>Examples</h3>

<pre><code class="language-R">data(SimulExample)
ex1.lm &lt;- lm.phylog(y ~ x1+diet, weights=x2, max.num=20,
                    exclude.tips=c("La","Ls"), data=SimulExample)
ex1.lm
summary(ex1.lm)
par(mfrow=c(2,2))
plot(ex1.lm)


</code></pre>


</div>