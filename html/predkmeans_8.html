<div class="container">

<table style="width: 100%;"><tr>
<td>predictML.predkmeans</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>Prediction of Cluster Membership</h2>

<h3>Description</h3>

<p>Predicts cluster membership using either multinomial logistic
regression or SVMs.
</p>


<h3>Usage</h3>

<pre><code class="language-R">## S3 method for class 'predkmeans'
predictML(
  object = NULL,
  centers = object$centers,
  K = nrow(centers),
  R,
  Rstar,
  Xstar = NULL,
  tr.assign = object$cluster,
  muStart = "random",
  maxitMlogit = 500,
  verbose = 1,
  nMlogitStarts = 1,
  mlogit.control = list(suppressFittedWarning = TRUE),
  ...
)

## S3 method for class 'predkmeans'
predictSVM(
  object = NULL,
  centers = object$centers,
  R,
  Rstar,
  K = nrow(centers),
  Xstar = NULL,
  tr.assign = object$cluster,
  svm.control = list(gamma = c(1/(2:1), 2), cost = seq(20, 100, by = 20)),
  ...
)

## S3 method for class 'predkmeans'
predictMixExp(object, R, Rstar = NULL, ...)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>object</code></td>
<td>
<p>A predkmeans object, from which the cluster centers will be extracted.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>centers</code></td>
<td>
<p>Matrix of cluster centers, assumed to be K-by-p</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>K</code></td>
<td>
<p>Number of clusters</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>R</code></td>
<td>
<p>matrix of covariates for observations to be predicted at.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>Rstar</code></td>
<td>
<p>matrix of covariates at training locations</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>Xstar</code></td>
<td>
<p>matrix of observation at training locations.  Either this or <code>tr.assign</code> is required.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>tr.assign</code></td>
<td>
<p>vector of cluster assignments at training locations.  By default, extracted from <code>object</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>muStart</code></td>
<td>
<p>starting value for cluster centers in mlogit optimization (IDEA: change to pull from predkmeans object?).  If not provided, starting values are selected randomly.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>maxitMlogit</code></td>
<td>
<p>Maximum number of iterations for <code>mlogit</code> in prediction</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>verbose</code></td>
<td>
<p>integer indicating amount of output to be displayed</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>nMlogitStarts</code></td>
<td>
<p>number of mlogit starts to use in estimation of parameters</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>mlogit.control</code></td>
<td>
<p>list of control parameters to be passes to <code>mlogit</code></p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>...</code></td>
<td>
<p>Unused additional arguments</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>svm.control</code></td>
<td>
<p>list of options for <code>best.svm</code></p>
</td>
</tr>
</table>
<h3>Details</h3>

<p>Function for predicting cluster membership in clusters identified by k-means or predictive k-means using multinomial logistic regression or support vector machines (SVMs).  For multinomial logitic regression, parameter estimation is handled by <code>mlogit</code>.  The SVMs are fit using <code>best.svm</code> from <code>e1071</code> package.
</p>
<p>Because this prediction includes return information about cluster assignment
and prediction model parameters, this method is deliberately distinct from
the generic <code>predict</code> functions.
</p>
<p>The <code>predictMixExp</code> funciton provides predictions from 
the 'working' cluster assignments created as part of the 
mixture of experts algorithm from <code>predkmeans</code>.
</p>


<h3>Value</h3>

<p>A list containing some or all of the following elements:
</p>
<table>
<tr style="vertical-align: top;">
<td><code>tr.assign</code></td>
<td>
<p>Cluster assignments at training locations</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>mlfit</code></td>
<td>
<p>A subset of the mlogit object returned by the function of that name</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>beta</code></td>
<td>
<p>Estimated model parameters</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>test.pred</code></td>
<td>
<p>Predicted cluster assignments at test locations</p>
</td>
</tr>
</table>
<h3>Author(s)</h3>

<p>Joshua Keller
</p>


<h3>See Also</h3>

<p><code>mlogit</code>, <code>predkmeans</code>, <code>predictionMetrics</code>
</p>
<p>Other methods for predkmeans objects: 
<code>relevel.predkmeans()</code>
</p>


<h3>Examples</h3>

<pre><code class="language-R">n &lt;- 200
r1 &lt;- rnorm(n)
r2 &lt;- rnorm(n)
u1 &lt;- rbinom(n, size=1,prob=0)
cluster &lt;- ifelse(r1&lt;0, ifelse(u1, "A", "B"), ifelse(r2&lt;0, "C", "D"))
mu1 &lt;- c(A=2, B=2, C=-2, D=-2)
mu2 &lt;- c(A=1, B=-1, C=-1, D=-1)
x1 &lt;- rnorm(n, mu1[cluster], 4)
x2 &lt;- rnorm(n, mu2[cluster], 4)
R &lt;- cbind(1, r1, r2)
X &lt;- cbind(x1, x2)
pkm &lt;- predkmeans(X=cbind(x1, x2), R=R, K=4)
n_pred &lt;- 50
Rnew &lt;- cbind(1, r1=rnorm(n_pred), r2=rnorm(n_pred))
pkmPred &lt;- predictML(pkm, R=Rnew, Rstar=R)
pkmPred$test.pred 
</code></pre>


</div>