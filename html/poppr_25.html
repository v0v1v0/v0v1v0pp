<div class="container">

<table style="width: 100%;"><tr>
<td>clonecorrect</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>Remove potential bias caused by cloned genotypes in genind or genclone 
object.</h2>

<h3>Description</h3>

<p>This function removes any duplicated multilocus genotypes from any specified 
population strata.
</p>


<h3>Usage</h3>

<pre><code class="language-R">clonecorrect(pop, strata = 1, combine = FALSE, keep = 1)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>pop</code></td>
<td>
<p>a <code>genind</code>, <code>genclone</code>, or
<code>snpclone</code> object</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>strata</code></td>
<td>
<p>a hierarchical formula or numeric vector. This will define the
columns of the data frame in the strata slot to use.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>combine</code></td>
<td>
<p><code>logical</code>. When set to TRUE, the strata will be combined
to create a new population for the clone-corrected genind or genclone
object.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>keep</code></td>
<td>
<p><code>integer</code>. When <code>combine</code> is set to <code>FALSE</code>, you 
can use this flag to choose the levels of your population strata. For 
example: if your clone correction strata is set to "Pop", "Subpop", and 
"Year", and you want to analyze your populations with respect to year, you 
can set <code>keep = c(1,3)</code>.</p>
</td>
</tr>
</table>
<h3>Details</h3>

<p>This function will clone correct based on the stratification 
provided. To clone correct indiscriminately of population structure, set 
<code>strata = NA</code>.
</p>


<h3>Value</h3>

<p>a clone corrected <code>genclone</code>, 
<code>snpclone</code>, or <code>genind</code> object.
</p>


<h3>Author(s)</h3>

<p>Zhian N. Kamvar
</p>


<h3>Examples</h3>

<pre><code class="language-R"># LOAD A. euteiches data set
data(Aeut)

# Redefine it as a genclone object
Aeut &lt;- as.genclone(Aeut)
strata(Aeut) &lt;- other(Aeut)$population_hierarchy[-1]

# Check the number of multilocus genotypes
mlg(Aeut)
popNames(Aeut)

# Clone correct at the population level.
Aeut.pop &lt;- clonecorrect(Aeut, strata =  ~Pop)
mlg(Aeut.pop)
popNames(Aeut.pop)

## Not run: 
# Clone correct at the subpopulation level with respect to population and
# combine.
Aeut.subpop &lt;- clonecorrect(Aeut, strata = ~Pop/Subpop, combine=TRUE)
mlg(Aeut.subpop)
popNames(Aeut.subpop)

# Do the same, but set to the population level.
Aeut.subpop2 &lt;- clonecorrect(Aeut, strata = ~Pop/Subpop, keep=1)
mlg(Aeut.subpop2)
popNames(Aeut.subpop2)

# LOAD H3N2 dataset
data(H3N2)

strata(H3N2) &lt;- other(H3N2)$x

# Extract only the individuals located in China
country &lt;- clonecorrect(H3N2, strata =  ~country)

# How many isolates did we have from China before clone correction?
sum(strata(H3N2, ~country) == "China") # 155

# How many unique isolates from China after clone correction?
sum(strata(country, ~country) == "China") # 79

# Something a little more complicated. (This could take a few minutes on
# slower computers)

# setting the hierarchy to be Country &gt; Year &gt; Month  
c.y.m &lt;- clonecorrect(H3N2, strata =  ~year/month/country)

# How many isolates in the original data set?
nInd(H3N2) # 1903

# How many after we clone corrected for country, year, and month?
nInd(c.y.m) # 1190

## End(Not run)
</code></pre>


</div>