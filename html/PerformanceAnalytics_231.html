<div class="container">

<table style="width: 100%;"><tr>
<td>StructuredMoments</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>Functions for calculating structured comoments of financial time series</h2>

<h3>Description</h3>

<p>calculates covariance, coskewness and cokurtosis matrices as structured estimators
</p>


<h3>Usage</h3>

<pre><code class="language-R">M2.struct(R, struct = c("Indep", "IndepId", "observedfactor", "CC"), f = NULL)

M3.struct(
  R,
  struct = c("Indep", "IndepId", "observedfactor", "CC", "latent1factor", "CS"),
  f = NULL,
  unbiasedMarg = FALSE,
  as.mat = TRUE
)

M4.struct(
  R,
  struct = c("Indep", "IndepId", "observedfactor", "CC"),
  f = NULL,
  as.mat = TRUE
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>R</code></td>
<td>
<p>an xts, vector, matrix, data frame, timeSeries or zoo object of
asset returns</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>struct</code></td>
<td>
<p>string containing the preferred method. See Details.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>f</code></td>
<td>
<p>vector or matrix with observations of the factor, to be used with 'observedfactor'. See Details.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>unbiasedMarg</code></td>
<td>
<p>TRUE/FALSE whether to use a correction to have an unbiased
estimator for the marginal skewness values, in case of 'Indep' or 'IndepId', default FALSE</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>as.mat</code></td>
<td>
<p>TRUE/FALSE whether to return the full moment matrix or only
the vector with the unique elements (the latter is advised for speed), default
TRUE</p>
</td>
</tr>
</table>
<h3>Details</h3>

<p>The coskewness and cokurtosis matrices are defined as the matrices of dimension 
p x p^2 and p x p^3 containing the third and fourth order central moments. They
are useful for measuring nonlinear dependence between different assets of the 
portfolio and computing modified VaR and modified ES of a portfolio.
</p>
<p>Structured estimation is based on the assumption that the underlying data-generating
process is known, or at least resembles the assumption. The first four structured estimators correspond to the models 'independent marginals', 
'independent and identical marginals', 'observed multi-factor model' and 'constant correlation'. 
Coskewness estimation includes an additional model based on the latent 1-factor model
proposed in Simaan (1993).
</p>
<p>The constant correlation and 1-factor coskewness and cokurtosis matrices can be found in 
Martellini and Ziemann (2010). If f is a matrix containing multiple factors, 
then the multi-factor model of Boudt, Lu and Peeters (2915) is used. For information
about the other structured matrices, we refer to Boudt, Cornilly and Verdonck (2017)
</p>


<h3>Author(s)</h3>

<p>Dries Cornilly
</p>


<h3>References</h3>

<p>Boudt, Kris, Lu, Wanbo and Peeters, Benedict. 2015. Higher order comoments of multifactor 
models and asset allocation. Finance Research Letters, 13, 225-233.
</p>
<p>Boudt, Kris, Brian G. Peterson, and Christophe Croux. 2008.
Estimation and Decomposition of Downside Risk for Portfolios with Non-Normal
Returns. Journal of Risk. Winter.
</p>
<p>Boudt, Kris, Cornilly, Dries and Verdonck, Tim. 2017. A Coskewness Shrinkage 
Approach for Estimating the Skewness of Linear Combinations of Random Variables. 
Submitted. Available at SSRN: https://ssrn.com/abstract=2839781
</p>
<p>Ledoit, Olivier and Wolf, Michael. 2003. Improved estimation of the covariance matrix 
of stock returns with an application to portfolio selection. Journal of empirical 
finance, 10(5), 603-621.
</p>
<p>Martellini, Lionel and Ziemann, V\"olker. 2010. Improved estimates of higher-order 
comoments and implications for portfolio selection. Review of Financial 
Studies, 23(4), 1467-1502.
</p>
<p>Simaan, Yusif. 1993. Portfolio selection and asset pricing: three-parameter framework. 
Management Science, 39(5), 68-577.
</p>


<h3>See Also</h3>

<p><code>CoMoments</code> <br><code>ShrinkageMoments</code> <br><code>EWMAMoments</code> <br><code>MCA</code>
</p>


<h3>Examples</h3>

<pre><code class="language-R">
data(edhec)

# structured estimation with constant correlation model
# 'as.mat = F' would speed up calculations in higher dimensions
sigma &lt;- M2.struct(edhec, "CC")
m3 &lt;- M3.struct(edhec, "CC")
m4 &lt;- M4.struct(edhec, "CC")

# compute equal-weighted portfolio modified ES
mu &lt;- colMeans(edhec)
p &lt;- length(mu)
ES(p = 0.95, portfolio_method = "component", weights = rep(1 / p, p), mu = mu, 
    sigma = sigma, m3 = m3, m4 = m4)

# compare to sample method
sigma &lt;- cov(edhec)
m3 &lt;- M3.MM(edhec)
m4 &lt;- M4.MM(edhec)
ES(p = 0.95, portfolio_method = "component", weights = rep(1 / p, p), mu = mu, 
    sigma = sigma, m3 = m3, m4 = m4)

</code></pre>


</div>