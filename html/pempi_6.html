<div class="container">

<table style="width: 100%;"><tr>
<td>moment_estimator</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>Compute moment-based estimator.</h2>

<h3>Description</h3>

<p>Proportion estimated using the moment-based estimator and confidence intervals based the asymptotic distribution of the estimator as well as
the Clopper-Pearson approach.
</p>


<h3>Usage</h3>

<pre><code class="language-R">moment_estimator(
  R3,
  n,
  pi0,
  gamma = 0.05,
  alpha = 0,
  beta = 0,
  alpha0 = 0,
  V = NULL,
  ...
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>R3</code></td>
<td>
<p>A <code>numeric</code> that provides the number of participants in the survey sample that are tested positive only with the second testing device.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>n</code></td>
<td>
<p>A <code>numeric</code> that provides the sample size.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>pi0</code></td>
<td>
<p>A <code>numeric</code> that provides the prevalence or proportion of people (in the whole population) who are positive, as measured through a non-random,
but systematic sampling (e.g. based on medical selection).</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>gamma</code></td>
<td>
<p>A <code>numeric</code> that is used to compute a (1 - gamma) confidence region for the proportion. Default value is <code>0.05</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>alpha</code></td>
<td>
<p>A <code>numeric</code> that provides the False Negative (FN) rate for the sample R. Default value is <code>0</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>beta</code></td>
<td>
<p>A <code>numeric</code> that provides the False Positive (FP) rate for the sample R. Default value is <code>0</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>alpha0</code></td>
<td>
<p>A <code>numeric</code> that corresponds to the probability that a random participant
has been incorrectly declared positive through the nontransparent procedure. In most applications,
this probability is likely very close to zero. Default value is <code>0</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>V</code></td>
<td>
<p>A <code>numeric</code> that corresponds to the average of squared sampling weights. Default value is <code>NULL</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>...</code></td>
<td>
<p>Additional arguments.</p>
</td>
</tr>
</table>
<h3>Value</h3>

<p>A <code>cpreval</code> object with the structure:
</p>

<ul>
<li>
<p> estimate:    Estimated proportion.
</p>
</li>
<li>
<p> sd:          Estimated standard error of the estimator.
</p>
</li>
<li>
<p> ci_asym:     Asymptotic confidence interval at the 1 - gamma confidence level.
</p>
</li>
<li>
<p> ci_cp:       Confidence interval (1 - gamma confidence level) based on the Clopper-Pearson approach.
</p>
</li>
<li>
<p> gamma:       Confidence level (i.e. 1 - gamma) for confidence intervals.
</p>
</li>
<li>
<p> method:      Estimation method (in this case moment estimator).
</p>
</li>
<li>
<p> measurement: A vector with (alpha0, alpha, beta).
</p>
</li>
<li>
<p> beta0:       Estimated false negative rate of the official procedure.
</p>
</li>
<li>
<p> ci_beta0:    Asymptotic confidence interval (1 - gamma confidence level) for beta0.
</p>
</li>
<li>
<p> boundary:    A boolean variable indicating if the estimates falls at the boundary of the parameter space.
</p>
</li>
<li>
<p> pi0:         Value of pi0 (input value).
</p>
</li>
<li>
<p> sampling:    Type of sampling considered ("random" or "weighted").
</p>
</li>
<li>
<p> V:           Average sum of squared sampling weights if weighted/stratified is used (otherwise NULL).
</p>
</li>
<li>
<p> n:           Sample size.
</p>
</li>
<li>
<p> avar_beta0:  Estimated asymptotic variance of beta0
</p>
</li>
<li>
<p> ...:         Additional parameters.
</p>
</li>
</ul>
<h3>Author(s)</h3>

<p>Stephane Guerrier, Maria-Pia Victoria-Feser, Christoph Kuzmics
</p>


<h3>Examples</h3>

<pre><code class="language-R"># Samples without measurement error
X = sim_Rs(theta = 3/100, pi0 = 1/100, n = 1500, seed = 18)
moment_estimator(R3 = X$R3, n = X$n, pi0 = X$pi0)

# With measurement error
X = sim_Rs(theta = 3/100, pi0 = 1/100, n = 1500, alpha0 = 0.001,
alpha = 0.01, beta = 0.05, seed = 18)
moment_estimator(R3 = X$R3, n = X$n, pi0 = X$pi0)
moment_estimator(R3 = X$R3, n = X$n, pi0 = X$pi0, alpha0 = 0.001,
alpha = 0.01, beta = 0.05)
</code></pre>


</div>