<div class="container">

<table style="width: 100%;"><tr>
<td>calc_convergence_time</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>
Calculate convergence time-step for node activities
</h2>

<h3>Description</h3>

<p>Given a node activity time-series for a set of variables <code>node_act</code>, this function calculates the time-step from which the changes in all the curves are below <code>threshold</code> for <code>window_size</code> consecutive time-steps.
</p>


<h3>Usage</h3>

<pre><code class="language-R">calc_convergence_time(node_act, threshold, window_size = 1)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>node_act</code></td>
<td>
<p>A matrix describing node activities over consecutive time-steps (i.e., time-series), where rows represent time-steps and columns represent nodes. It is the output of <code>calc_node_activities</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>threshold</code></td>
<td>
<p>A value determining the maximum allowable change in node activities to decide if they have converged.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>window_size</code></td>
<td>
<p>The number of consecutive time-steps for which the node activity curves must remain stable (i.e., changes below <code>threshold</code>) to be considered converged. The default is 1.</p>
</td>
</tr>
</table>
<h3>Details</h3>

<p>The function checks if the changes in all node activity curves are less than <code>threshold</code> for <code>window_size</code> consecutive time-steps. If this condition is met, the node activity curves are considered to have converged to their stable values, and the convergence time-step (the starting point of the window) is returned. Since node activities represent marginal probabilities of the nodes being active at each time-step, convergence indicates that the steady-state distribution of the corresponding Boolean network has been reached, meaning that the probability of being in each state of the network no longer changes significantly.
</p>


<h3>Value</h3>

<p>The time-step at which convergence occurs. If no convergence is detected, <code>NA</code> is returned.
</p>


<h3>Examples</h3>

<pre><code class="language-R">
# Load the example network
data(lac_operon_net)

# Define parameters for the SDDS method
props &lt;- rep(0.95, length(lac_operon_net$genes))
params &lt;- list(p00 = props, p01 = props, p10 = props, p11 = props)

# Get node activities after simulation using the SDDS method
node_act &lt;- calc_node_activities(lac_operon_net, method = "SDDS", params = params,
    steps = 100, repeats = 10000)

# Calculate the convergence time
convergence_time &lt;- calc_convergence_time(node_act, threshold = 0.01)


# Print the convergence time
print(convergence_time)
</code></pre>


</div>