<div class="container">

<table style="width: 100%;"><tr>
<td>band.chol.cv</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>
Banding parameter selection for banding the covariance Cholesky factor.
</h2>

<h3>Description</h3>

<p>Selects the banding parameter and computes
the banded covariance estimator by banding the covariance Cholesky factor as described
by Rothman, Levina, and Zhu (2010).
</p>


<h3>Usage</h3>

<pre><code class="language-R">band.chol.cv(x, k.vec = NULL, method = c("fast", "safe"), nsplits = 10, 
             n.tr = NULL, quiet = TRUE)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>x</code></td>
<td>

<p>A data matrix with <code class="reqn">n</code> rows and <code class="reqn">p</code> columns. The rows are assumed to be a realization of <code class="reqn">n</code>
independent copies of a <code class="reqn">p</code>-variate random vector. 
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>k.vec</code></td>
<td>

<p>An optional vector of candidate banding parameters (the possible number of sub-diagonals to keep as non-zero).  
The default is the long vector <code>0:min(n-2, p-1)</code>.
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>method</code></td>
<td>

<p>The method to use. The default is
<code>method="fast"</code>, which uses the Grahm-Schmidt style algorithm and must have <code class="reqn">k \leq \min(n-2, p-1)</code>.
Alternatively, <code>method="safe"</code> uses an inverse or generalized inverse to compute estimates
of the regression coefficients and is more numerically stable (and capable of handling <code class="reqn">k \in \{0,\ldots,p-1\}</code> regardless of <code class="reqn">n</code>).
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>nsplits</code></td>
<td>

<p>Number of random splits to use for banding parameter selection.
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>n.tr</code></td>
<td>

<p>Optional number of cases to use in the training set. The default is the nearest 
integer to <code class="reqn">n(1-1/\log(n))</code>.  The value must be in <code class="reqn">\{3, \ldots, n-2\}</code>.
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>quiet</code></td>
<td>

<p>Logical: <code>quiet=TRUE</code> suppresses the printing of progress updates.
</p>
</td>
</tr>
</table>
<h3>Details</h3>

<p><code>method="fast"</code> is much faster than <code>method="safe"</code>. 
See Rothman, Levina, and Zhu (2010). 
</p>


<h3>Value</h3>

<p>A list with
</p>
<table>
<tr style="vertical-align: top;">
<td><code>sigma</code></td>
<td>
<p>the covariance estimate at the selected banding parameter</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>best.k</code></td>
<td>
<p>the selected banding parameter</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>cv.err</code></td>
<td>
<p>the vector of validation errors, one for each entry in <code>k.vec</code></p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>k.vec</code></td>
<td>
<p>the vector of candidate banding parameters</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>n.tr</code></td>
<td>
<p>The number of cases used for the training set</p>
</td>
</tr>
</table>
<h3>Author(s)</h3>

<p>Adam J. Rothman
</p>


<h3>References</h3>

<p>Rothman, A. J., Levina, E., and Zhu, J. (2010).  A new approach to Cholesky-based covariance 
regularization in high dimensions. Biometrika 97(3): 539-550.
</p>


<h3>See Also</h3>

<p><code>band.chol</code>
</p>


<h3>Examples</h3>

<pre><code class="language-R">set.seed(1)
n=50
p=20
true.cov=diag(p)
true.cov[cbind(1:(p-1), 2:p)]=0.4
true.cov[cbind(2:p, 1:(p-1))]=0.4
eo=eigen(true.cov, symmetric=TRUE)
z=matrix(rnorm(n*p), nrow=n, ncol=p)
x=z%*% tcrossprod(eo$vec*rep(eo$val^(0.5), each=p),eo$vec)
cv.out=band.chol.cv(x=x)
plot(cv.out$k.vec, cv.out$cv.err)
cv.out$best.k
cv.out$sigma
</code></pre>


</div>