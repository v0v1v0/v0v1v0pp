<div class="container">

<table style="width: 100%;"><tr>
<td>mst</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>Minimum Spanning Tree and Network</h2>

<h3>Description</h3>

<p>Computes a minimum spanning tree using Kruskal's algorithm, the
minimum spanning network using Bandelt et al.'s algorithm, or the
randomized minimum spanning tree (Paradis 2018).
</p>


<h3>Usage</h3>

<pre><code class="language-R">mst(d)
msn(d)
rmst(d, B = NULL, stop.criterion = NULL, iter.lim = 1000,
     quiet = FALSE)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>d</code></td>
<td>
<p>a distance matrix, either as an object of class <code>"dist"</code>,
or a (square symmetric) matrix.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>B</code></td>
<td>
<p>number of randomizations.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>stop.criterion</code></td>
<td>
<p>the stopping criterion if <code>B</code> is not given
(see details).</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>iter.lim</code></td>
<td>
<p>the maximum number of iterations.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>quiet</code></td>
<td>
<p>a logical value specifying whether to indicate progress
of calculations.</p>
</td>
</tr>
</table>
<h3>Details</h3>

<p>For the RMST, the calculations stop when no new links are found after a
number of successive iterations specified by <code>stop.criterion</code>. By
default, this number is ceiling(sqrt(n)) where n is the number of
observations. This criterion is ignored if <code>B</code> is given, or if n
&lt; 6 in which case complete enumeration is done. In all cases, no more
than <code>iter.lim</code> iterations are done.
</p>


<h3>Value</h3>

<p>an object of class <code>"haploNet"</code>.
</p>


<h3>Note</h3>

<p><span class="pkg">ape</span> has a function named <code>mst</code> which is older (and used by
other packages) and returns its results in a different form. The
present version is more efficient. If you want to use the older
version after loading <span class="pkg">pegas</span>, use <code>ape::mst</code> since <span class="pkg">ape</span>
will certainly always be loaded before <span class="pkg">pegas</span>.
</p>


<h3>Author(s)</h3>

<p>Emmanuel Paradis</p>


<h3>References</h3>

<p>Bandelt, H. J., Forster, P. and Rohl, A. (1999) Median-joining networks
for inferring intraspecific phylogenies. <em>Molecular Biology and
Evolution</em>, <b>16</b>, 37–48.
</p>
<p>Kruskal, J. B., Jr. (1956) On the shortest spanning subtree of a graph
and the traveling salesman problem. <em>Proceedings of the American
Mathematical Society</em>, <b>7</b>, 48–50.
</p>
<p>Paradis, E. (2018) Analysis of haplotype networks: the randomized
minimum spanning tree method. <em>Methods in Ecology and Evolution</em>,
<b>9</b>, 1308–1317. DOI: 10.1111/2041-210X.12969.
</p>


<h3>See Also</h3>

<p><code>haploNet</code>, <code>mjn</code>
</p>


<h3>Examples</h3>

<pre><code class="language-R">data(woodmouse)
d &lt;- dist.dna(woodmouse, "n")
(r &lt;- mst(d))
plot(r)

## a case where the RMST and the MJN are identical:
x &lt;- c("&gt;A", "TAAGTGCAT", "&gt;B", "TAAATGCAT", "&gt;C", "TAGGTGCAT", "&gt;D", "TAAGTACAT",
       "&gt;E", "TAAGTGTAT", "&gt;F", "TAAGTACAC", "&gt;G", "TAAGTACGT", "&gt;H", "CAAGTACAC",
       "&gt;I", "CAAGCACAC", "&gt;J", "CAAGTACAT", "&gt;K", "CGAGTACAT", "&gt;L", "TAAGTACGC",
       "&gt;M", "CAAGCACAT")
fl &lt;- tempfile()
cat(x, file = fl, sep = "\n")
x &lt;- read.dna(fl, "f")
tr &lt;- rmst(dist.dna(x, "n"))
ts &lt;- mjn(x)
stopifnot(all.equal(tr, ts))
unlink(fl)
</code></pre>


</div>