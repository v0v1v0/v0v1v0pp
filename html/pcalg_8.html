<div class="container">

<table style="width: 100%;"><tr>
<td>amatType</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>Types and Display of Adjacency Matrices in Package 'pcalg'</h2>

<h3>Description</h3>

<p>Two types of adjacency matrices are used in package <span class="pkg">pcalg</span>: Type
<code>amat.cpdag</code> for DAGs and CPDAGs and type <code>amat.pag</code> for
MAGs and PAGs.  The required type of adjacency matrix is documented
in the help files of the respective functions or classes.  If in some
functions more detailed information on the graph type is needed
(i.e. DAG or CPDAG; MAG or PAG) this information will be passed in a
separate argument (see e.g. <code>gac</code> and the examples below).
</p>
<p>Note that you get (‘extract’) such adjacency matrices as (S3)
objects of <code>class</code> <code>"amat"</code> via the usual
<code>as(., "&lt;class&gt;")</code> coercion, </p>
<pre>  as(from, "amat")
</pre>


<h3>Arguments</h3>

<table><tr style="vertical-align: top;">
<td><code>from</code></td>
<td>
<p>an <span style="font-family: Courier New, Courier; color: #666666;"><b>R</b></span> object of
</p>
<p>class <code>pcAlgo</code>, as returned from
<code>skeleton()</code> or <code>pc()</code> or an object of
</p>
<p>class <code>fciAlgo</code>, as from <code>fci()</code>
(or <code>rfci</code>, <code>fciPlus</code>, and
<code>dag2pag</code>), or an object of
</p>
<p>class <code>"LINGAM"</code> as returned from <code>lingam()</code>.</p>
</td>
</tr></table>
<h3>Details</h3>

<p>Adjacency matrices are integer valued square matrices with zeros on the
diagonal.  They can have row- and columnnames; however, most functions
will work on the (integer) column positions in the adjacency matrix.
</p>
<p><b>Coding for type <code>amat.cpdag</code>:</b>
</p>

<dl>
<dt>
<code>0</code>:</dt>
<dd>
<p>No edge or tail</p>
</dd>
<dt>
<code>1</code>:</dt>
<dd>
<p>Arrowhead</p>
</dd>
</dl>
<p>Note that the edgemark-code refers to the <em>row</em> index (as opposed
adjacency matrices of type mag or pag).  E.g.:</p>
<pre>
    amat[a,b] = 0  and  amat[b,a] = 1   implies a --&gt; b.
    amat[a,b] = 1  and  amat[b,a] = 0   implies a &lt;-- b.
    amat[a,b] = 0  and  amat[b,a] = 0   implies a     b.
    amat[a,b] = 1  and  amat[b,a] = 1   implies a --- b.</pre>
<p><b>Coding for type <code>amat.pag</code>:</b>
</p>

<dl>
<dt>
<code>0</code>:</dt>
<dd>
<p>No edge</p>
</dd>
<dt>
<code>1</code>:</dt>
<dd>
<p>Circle</p>
</dd>
<dt>
<code>2</code>:</dt>
<dd>
<p>Arrowhead</p>
</dd>
<dt>
<code>3</code>:</dt>
<dd>
<p>Tail</p>
</dd>
</dl>
<p>Note that the edgemark-code refers to the <em>column</em> index (as
opposed adjacency matrices of type dag or cpdag).  E.g.:</p>
<pre>
  amat[a,b] = 2  and  amat[b,a] = 3   implies   a --&gt; b.
  amat[a,b] = 3  and  amat[b,a] = 2   implies   a &lt;-- b.
  amat[a,b] = 2  and  amat[b,a] = 2   implies   a &lt;-&gt; b.
  amat[a,b] = 1  and  amat[b,a] = 3   implies   a --o b.
  amat[a,b] = 0  and  amat[b,a] = 0   implies   a     b.</pre>


<h3>See Also</h3>

<p>E.g. <code>gac</code> for a function which takes an
adjacency matrix as input; <code>fciAlgo</code> for a class
which has an adjacency matrix in one slot.
</p>
<p><code>getGraph(x)</code> extracts the <code>graph-class</code>
object from <code>x</code>, whereas <code>as(*, "amat")</code> gets the
corresponding adjacency matrix.
</p>


<h3>Examples</h3>

<pre><code class="language-R">##################################################
## Function gac() takes an adjecency matrix of
## any kind as input.  In addition to that, the
## precise type of graph (DAG/CPDAG/MAG/PAG) needs
## to be passed as a different argument
##################################################
## Adjacency matrix of type 'amat.cpdag'
m1 &lt;- matrix(c(0,1,0,1,0,0, 0,0,1,0,1,0, 0,0,0,0,0,1,
               0,0,0,0,0,0, 0,0,0,0,0,0, 0,0,0,0,0,0), 6,6)
## more detailed information on the graph type needed by gac()
gac(m1, x=1,y=3, z=NULL, type = "dag")

## Adjacency matrix of type 'amat.cpdag'
m2 &lt;- matrix(c(0,1,1,0,0,0, 1,0,1,1,1,0, 0,0,0,0,0,1,
               0,1,1,0,1,1, 0,1,0,1,0,1, 0,0,0,0,0,0), 6,6)
## more detailed information on the graph type needed by gac()
gac(m2, x=3, y=6, z=c(2,4), type = "cpdag")

## Adjacency matrix of type 'amat.pag'
m3 &lt;- matrix(c(0,2,0,0, 3,0,3,3, 0,2,0,3, 0,2,2,0), 4,4)
## more detailed information on the graph type needed by gac()
mg3 &lt;- gac(m3, x=2, y=4, z=NULL, type = "mag")
pg3 &lt;- gac(m3, x=2, y=4, z=NULL, type = "pag")


############################################################
## as(*, "amat") returns an adjacency matrix incl. its type
############################################################
## Load predefined data
data(gmG)
n &lt;- nrow    (gmG8$x)
V &lt;- colnames(gmG8$x)

## define sufficient statistics
suffStat &lt;- list(C = cor(gmG8$x), n = n)
## estimate CPDAG
skel.fit &lt;- skeleton(suffStat, indepTest = gaussCItest,
                     alpha = 0.01, labels = V)
## Extract the "amat" [and show nicely via  'print()' method]:
as(skel.fit, "amat")

##################################################
## Function fci() returns an adjacency matrix
## of type amat.pag as one slot.
##################################################
set.seed(42)
p &lt;- 7
## generate and draw random DAG :
myDAG &lt;- randomDAG(p, prob = 0.4)

## find skeleton and PAG using the FCI algorithm
suffStat &lt;- list(C = cov2cor(trueCov(myDAG)), n = 10^9)
res &lt;- fci(suffStat, indepTest=gaussCItest,
           alpha = 0.9999, p=p, doPdsep = FALSE)
str(res)
## get the a(djacency) mat(rix)  and nicely print() it:
as(res, "amat")

##################################################
## pcAlgo object
##################################################
## Load predefined data
data(gmG)
n &lt;- nrow    (gmG8$x)
V &lt;- colnames(gmG8$x)

## define sufficient statistics
suffStat &lt;- list(C = cor(gmG8$x), n = n)
## estimate CPDAG
skel.fit &lt;- skeleton(suffStat, indepTest = gaussCItest,
                     alpha = 0.01, labels = V)
## Extract Adjacency Matrix - and print (via method 'print.amat'):
as(skel.fit, "amat")

pc.fit &lt;- pc(suffStat, indepTest = gaussCItest,
             alpha = 0.01, labels = V)
pc.fit # (using its own print() method 'print.pcAlgo')

as(pc.fit, "amat")
</code></pre>


</div>