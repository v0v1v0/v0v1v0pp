<div class="container">

<table style="width: 100%;"><tr>
<td>calcPvalsMC</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>Internal functions: Calculate p-values from Complete Enumeration or Monte Carlo</h2>

<h3>Description</h3>

<p>These internal functions are not meant to be called directly. This help is to explain the 
functions. The function <code>calcPvals</code> calculates p-values from a set of either 
completely enumerated test statistics (in which case all wgts are equal to one) or 
a set of test statistics from a network algorithm (in which case the wgts come from the network algorithm).
The function <code>calcPvalsMC</code> calculates p-values and the associated confidence intervals 
from a Monte Carlo simulation. The p-values are estimated by (S+1)/(N+1) where S is the number of 
more extreme test statistics, and N is the number of Monte Carlo simulations. This estimator is 
guaranteed to be valid,  and the confidence 
interval is the appropriate one associated with this estimator (see e.g., Fay, Kim, and Hachey, 2007). 
</p>


<h3>Usage</h3>

<pre><code class="language-R">calcPvalsMC(Tj, T0, digits, alternative = NULL, twosidedTstat = FALSE, p.conf.level=0.99)
calcPvals(Tj, T0, digits, denom = NULL, wgts = NULL, twosidedTstat = FALSE)
pCI(S, N, p.conf.level = 0.99)

</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>Tj</code></td>
<td>
<p> numeric vector of values of test statistic </p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>T0</code></td>
<td>
<p> observed value of test statistic</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>digits</code></td>
<td>
<p> number of significant digits for rounding (see details)</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>alternative</code></td>
<td>
<p>character vector: one of "less", "greater", "two.sided"</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>twosidedTstat</code></td>
<td>
<p>logical, TRUE denotes test statistic is twosided</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>denom</code></td>
<td>
<p>total number of test statistics</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>wgts</code></td>
<td>
<p>vector of weights the same length as Tj, NULL gives all ones</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>S</code></td>
<td>
<p>number of Monte Carlo replications equal or more extreme than T0</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>N</code></td>
<td>
<p>number of Monte Carlo replications</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>p.conf.level</code></td>
<td>
<p>confidence level for confidence intervals about Monte Carlo p-values</p>
</td>
</tr>
</table>
<h3>References</h3>

<p>Fay, MP, Kim, H-J, Hachey, M (2007). 
Journal of Computational and Graphical Statistics.
16:946-957. Available at
<a href="https://www.ncbi.nlm.nih.gov/pmc/articles/PMC2467508/">https://www.ncbi.nlm.nih.gov/pmc/articles/PMC2467508/</a>
</p>


<h3>See Also</h3>

<p>Called from <code>permTS</code>,  <code>permKS</code>,  <code>permTREND</code>  </p>


</div>