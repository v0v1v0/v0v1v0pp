<div class="container">

<table style="width: 100%;"><tr>
<td>phe_quantile</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>Assign Quantiles using phe_quantile</h2>

<h3>Description</h3>

<p>Assigns data to quantiles based on numeric data rankings.
</p>


<h3>Usage</h3>

<pre><code class="language-R">phe_quantile(
  data,
  values,
  nquantiles = 10L,
  invert = TRUE,
  inverttype = "logical",
  type = "full"
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>data</code></td>
<td>
<p>a data frame containing the quantitative data to be assigned to
quantiles. If pre-grouped, separate sets of quantiles will be assigned for
each grouping set; unquoted string; no default</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>values</code></td>
<td>
<p>field name from data containing the numeric values to rank data
by and assign quantiles from; unquoted string; no default</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>nquantiles</code></td>
<td>
<p>the number of quantiles to separate each grouping set into;
numeric; default=10L</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>invert</code></td>
<td>
<p>whether the quantiles should be directly (FALSE) or inversely
(TRUE) related to the numerical value order; logical (to apply same value
to all grouping sets) OR unquoted string referencing field name from data
that stores logical values for each grouping set; default = TRUE (ie
highest values assigned to quantile 1)</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>inverttype</code></td>
<td>
<p>whether the invert argument has been specified as a logical
value or a field name from data; quoted string "field" or "logical";
default = "logical"</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>type</code></td>
<td>
<p>defines whether to include metadata columns in output to
reference the arguments passed; can be "standard" or "full"; quoted string;
default = "full"</p>
</td>
</tr>
</table>
<h3>Value</h3>

<p>When type = "full", returns the original data.frame with quantile
(quantile value), nquantiles (number of quantiles requested), groupvars
(grouping sets quantiles assigned within) and invert (indicating direction
of quantile assignment) fields appended.
</p>


<h3>Notes</h3>

<p>See <a href="https://fingertips.phe.org.uk/profile/guidance/supporting-information/PH-methods">OHID Technical Guide - Assigning Deprivation Categories</a>
for methodology. In particular, note that this function strictly applies
the algorithm defined but some manual review, and potentially adjustment,
is advised in some cases where multiple small areas with equal rank fall
across a natural quantile boundary.
</p>


<h3>See Also</h3>

<p>Other PHEindicatormethods package functions: 
<code>assign_funnel_significance()</code>,
<code>calculate_ISRate()</code>,
<code>calculate_ISRatio()</code>,
<code>calculate_funnel_limits()</code>,
<code>calculate_funnel_points()</code>,
<code>phe_dsr()</code>,
<code>phe_life_expectancy()</code>,
<code>phe_mean()</code>,
<code>phe_proportion()</code>,
<code>phe_rate()</code>,
<code>phe_sii()</code>
</p>


<h3>Examples</h3>

<pre><code class="language-R">df &lt;- data.frame(
  region    = as.character(rep(c("Region1","Region2","Region3","Region4"),
                               each=250)),
  smallarea = as.character(paste0("Area",seq_along(1:1000))),
  vals      = as.numeric(sample(200, 1000, replace = TRUE)),
  stringsAsFactors = FALSE)

# assign small areas to deciles across whole data frame
phe_quantile(df, vals)

# assign small areas to deciles within regions by pre-grouping the data frame
library(dplyr)
df_grp &lt;- df %&gt;% group_by(region)
phe_quantile(df_grp, vals)

# assign small areas to quintiles, where highest value = highest quantile
phe_quantile(df, vals, nquantiles = 5L, invert=FALSE)

</code></pre>


</div>