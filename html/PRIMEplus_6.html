<div class="container">

<table style="width: 100%;"><tr>
<td>PRIMEplus.LRT</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>Likelihood Ratio Test</h2>

<h3>Description</h3>

<p>PRIMEplus likelihood ratio test                           
</p>


<h3>Usage</h3>

<pre><code class="language-R"> PRIMEplus.LRT(data, effect_p, beta0, time.var="X", trt.var="trt", 
       status.var="event_status", id.var="id", t1=1, lambda0=NULL, 
       stopTol=1e-4, maxiter=100000, print=0)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>data</code></td>
<td>
<p>Data frame or matrix containing a time-to-event variable (<code>time.var</code>),
a treatment variable (<code>trt.var</code>), 
and a censoring variable (<code>status.var</code>).</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>effect_p</code></td>
<td>
<p>Vector of proportions for groups of responders in the treatment arm at baseline (see details).</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>beta0</code></td>
<td>
<p>Vector or matrix of initial estimates for the log-hazard ratios (see details).</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>time.var</code></td>
<td>
<p>Time-to-event variable name in <code>data</code>. The default is "X".</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>trt.var</code></td>
<td>
<p>Binary treatment variable name in <code>data</code> coded as 
0 for controls and 1 for subjects that received treatment.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>status.var</code></td>
<td>
<p>Name of the binary censoring variable in <code>data</code> coded
as 0 for censored subjects and 1 for subjects that
experienced an event.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>id.var</code></td>
<td>
<p>NULL or subject id variable in <code>data</code>. The default is "id".</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>t1</code></td>
<td>
<p>Delayed duration. The default is 1.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>lambda0</code></td>
<td>
<p>NULL or vector of initial estimates for the baseline hazards
corrsponding to the ordered event times.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>stopTol</code></td>
<td>
<p>Stopping tolerance. The default is 1e-4.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>maxiter</code></td>
<td>
<p>Maximum number of iterations. The default is 100000.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>print</code></td>
<td>
<p>0-2 to print information. Larger values will print more information.
The default is 0.</p>
</td>
</tr>
</table>
<h3>Details</h3>

<p>The EM algorithm is sensitive to the initial values of the log-hazard ratios (<code>beta0</code>), so different
initial estimates should be tried to ensure the maximum log-likelihood is obtained. 
Thus, <code>beta0</code> can be a vector or matrix, where in the case of a matrix, each row corresponds to a different set
of intial estimates. Each set of initial estimates must contain distinct non-zero values.
The length and order of <code>effect_p</code> must be the same as the columns of <code>beta0</code>. Both of these 
should contain information only for the groups of responders. For example, if there are
full responders and partial responders, then <code>effect_p</code> would be a vector of length two,
and <code>beta0</code> would be a vector of length two or a matrix with two columns.
</p>


<h3>Value</h3>

<p> A list containing the objects:
</p>

<table>
<tr>
<td style="text-align: left;">
    Name            </td>
<td style="text-align: left;"> Description </td>
</tr>
<tr>
<td style="text-align: left;">
    converged       </td>
<td style="text-align: left;"> TRUE if EM algorithm converged </td>
</tr>
<tr>
<td style="text-align: left;">
    beta            </td>
<td style="text-align: left;"> final log(hazard ratio) estimates of responders versus controls </td>
</tr>
<tr>
<td style="text-align: left;">
    lambda          </td>
<td style="text-align: left;"> final estimates of baseline hazards </td>
</tr>
<tr>
<td style="text-align: left;">
    probResponder   </td>
<td style="text-align: left;"> estimated probability of a subject being a responder </td>
</tr>
<tr>
<td style="text-align: left;">
    loglike         </td>
<td style="text-align: left;"> log-likelihood value at the final estimates </td>
</tr>
<tr>
<td style="text-align: left;">
    loglike.marg    </td>
<td style="text-align: left;"> marginal log-likelihood value at the final estimates </td>
</tr>
<tr>
<td style="text-align: left;">
    loglike.marg.0  </td>
<td style="text-align: left;"> marginal log-likelihood value under the null hypothesis </td>
</tr>
<tr>
<td style="text-align: left;">
    LRT             </td>
<td style="text-align: left;"> likelihood-ratio test statistic </td>
</tr>
<tr>
<td style="text-align: left;">
    pvalue          </td>
<td style="text-align: left;"> p-value of the likelihood ratio test
  </td>
</tr>
</table>
<h3>Author(s)</h3>

<p>Zhenzhen Xu &lt;Zhenzhen.Xu@fda.hhs.gov&gt;, Yongsoek Park &lt;yongpark@pitt.edu&gt; and Bin Zhu &lt;bin.zhu@nih.gov&gt;
</p>


<h3>See Also</h3>

 <p><code>PRIMEplus.EM</code> </p>


<h3>Examples</h3>

<pre><code class="language-R">  data(data, package="PRIMEplus")
  effp  &lt;- c(0.3, 0.3)
  beta0 &lt;- c(log(0.4), log(0.6))
  ret   &lt;- PRIMEplus.LRT(data, effp, beta0)
  ret$LRT 
  ret$pvalue
</code></pre>


</div>