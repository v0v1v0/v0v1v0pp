<div class="container">

<table style="width: 100%;"><tr>
<td>details_multinom_reg_spark</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>Multinomial regression via spark</h2>

<h3>Description</h3>

<p><code>sparklyr::ml_logistic_regression()</code> fits a model that uses linear
predictors to predict multiclass data using the multinomial distribution.
</p>


<h3>Details</h3>

<p>For this engine, there is a single mode: classification
</p>


<h4>Tuning Parameters</h4>

<p>This model has 2 tuning parameters:
</p>

<ul>
<li> <p><code>penalty</code>: Amount of Regularization (type: double, default: 0.0)
</p>
</li>
<li> <p><code>mixture</code>: Proportion of Lasso Penalty (type: double, default: 0.0)
</p>
</li>
</ul>
<p>For <code>penalty</code>, the amount of regularization includes both the L1 penalty
(i.e., lasso) and the L2 penalty (i.e., ridge or weight decay). As for
<code>mixture</code>:
</p>

<ul>
<li> <p><code>mixture = 1</code> specifies a pure lasso model,
</p>
</li>
<li> <p><code>mixture = 0</code> specifies a ridge regression model, and
</p>
</li>
<li> <p><code style="white-space: pre;">⁠0 &lt; mixture &lt; 1⁠</code> specifies an elastic net model, interpolating lasso
and ridge.
</p>
</li>
</ul>
<h4>Translation from parsnip to the original package</h4>

<div class="sourceCode r"><pre>multinom_reg(penalty = double(1), mixture = double(1)) %&gt;% 
  set_engine("spark") %&gt;% 
  translate()
</pre></div>
<div class="sourceCode"><pre>## Multinomial Regression Model Specification (classification)
## 
## Main Arguments:
##   penalty = double(1)
##   mixture = double(1)
## 
## Computational engine: spark 
## 
## Model fit template:
## sparklyr::ml_logistic_regression(x = missing_arg(), formula = missing_arg(), 
##     weights = missing_arg(), reg_param = double(1), elastic_net_param = double(1), 
##     family = "multinomial")
</pre></div>



<h4>Preprocessing requirements</h4>

<p>Factor/categorical predictors need to be converted to numeric values
(e.g., dummy or indicator variables) for this engine. When using the
formula method via <code>fit()</code>, parsnip will
convert factor columns to indicators.
</p>
<p>Predictors should have the same scale. One way to achieve this is to
center and scale each so that each predictor has mean zero and a
variance of one.
</p>
<p>By default, <code>ml_multinom_regression()</code> uses the argument
<code>standardization = TRUE</code> to center and scale the data.
</p>



<h4>Case weights</h4>

<p>This model can utilize case weights during model fitting. To use them,
see the documentation in case_weights and the examples
on <code>tidymodels.org</code>.
</p>
<p>The <code>fit()</code> and <code>fit_xy()</code> arguments have arguments called
<code>case_weights</code> that expect vectors of case weights.
</p>
<p>Note that, for spark engines, the <code>case_weight</code> argument value should be
a character string to specify the column with the numeric case weights.
</p>



<h4>Other details</h4>

<p>For models created using the <code>"spark"</code> engine, there are several things
to consider.
</p>

<ul>
<li>
<p> Only the formula interface to via <code>fit()</code> is available; using
<code>fit_xy()</code> will generate an error.
</p>
</li>
<li>
<p> The predictions will always be in a Spark table format. The names will
be the same as documented but without the dots.
</p>
</li>
<li>
<p> There is no equivalent to factor columns in Spark tables so class
predictions are returned as character columns.
</p>
</li>
<li>
<p> To retain the model object for a new R session (via <code>save()</code>), the
<code>model$fit</code> element of the parsnip object should be serialized via
<code>ml_save(object$fit)</code> and separately saved to disk. In a new session,
the object can be reloaded and reattached to the parsnip object.
</p>
</li>
</ul>
<h4>References</h4>


<ul>
<li>
<p> Luraschi, J, K Kuo, and E Ruiz. 2019. <em>Mastering Spark with R</em>.
O’Reilly Media
</p>
</li>
<li>
<p> Hastie, T, R Tibshirani, and M Wainwright. 2015. <em>Statistical Learning
with Sparsity</em>. CRC Press.
</p>
</li>
<li>
<p> Kuhn, M, and K Johnson. 2013. <em>Applied Predictive Modeling</em>. Springer.
</p>
</li>
</ul>
</div>