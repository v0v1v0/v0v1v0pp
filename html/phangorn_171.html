<div class="container">

<table style="width: 100%;"><tr>
<td>lli</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>Internal maximum likelihood functions.</h2>

<h3>Description</h3>

<p>These functions are internally used for the likelihood computations in
<code>pml</code> or <code>optim.pml</code>.
</p>


<h3>Usage</h3>

<pre><code class="language-R">lli(data, tree = NULL, ...)

edQt(Q = c(1, 1, 1, 1, 1, 1), bf = c(0.25, 0.25, 0.25, 0.25))

pml.free()

pml.init(data, k = 1L)

pml.fit(tree, data, bf = rep(1/length(levels), length(levels)), shape = 1,
  k = 1, Q = rep(1, length(levels) * (length(levels) - 1)/2),
  levels = attr(data, "levels"), inv = 0, rate = 1, g = NULL,
  w = NULL, eig = NULL, INV = NULL, ll.0 = NULL, llMix = NULL,
  wMix = 0, ..., site = FALSE, ASC = FALSE, site.rate = "gamma")
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>data</code></td>
<td>
<p>An alignment, object of class <code>phyDat</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>tree</code></td>
<td>
<p>A phylogenetic <code>tree</code>, object of class <code>phylo</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>...</code></td>
<td>
<p>Further arguments passed to or from other methods.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>Q</code></td>
<td>
<p>A vector containing the lower triangular part of the rate matrix.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>bf</code></td>
<td>
<p>Base frequencies.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>k</code></td>
<td>
<p>Number of intervals of the discrete gamma distribution.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>shape</code></td>
<td>
<p>Shape parameter of the gamma distribution.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>levels</code></td>
<td>
<p>The alphabet used e.g. c("a", "c", "g", "t") for DNA</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>inv</code></td>
<td>
<p>Proportion of invariable sites.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>rate</code></td>
<td>
<p>Rate.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>g</code></td>
<td>
<p>vector of quantiles (default is NULL)</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>w</code></td>
<td>
<p>vector of probabilities (default is NULL)</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>eig</code></td>
<td>
<p>Eigenvalue decomposition of Q</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>INV</code></td>
<td>
<p>Sparse representation of invariant sites</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>ll.0</code></td>
<td>
<p>default is NULL</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>llMix</code></td>
<td>
<p>default is NULL</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>wMix</code></td>
<td>
<p>default is NULL</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>site</code></td>
<td>
<p>return the log-likelihood or vector of sitewise likelihood
values</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>ASC</code></td>
<td>
<p>ascertainment bias correction (ASC), allows to estimate models
like Lewis' Mkv.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>site.rate</code></td>
<td>
<p>Indicates what type of gamma distribution to use. Options
are "gamma" approach of Yang 1994 (default), "gamma_quadrature" after the
Laguerre quadrature approach of Felsenstein 2001 and "freerate".</p>
</td>
</tr>
</table>
<h3>Details</h3>

<p>These functions are exported to be used in different packages so far only in
the package coalescentMCMC, but are not intended for end user. Most of the
functions call C code and are far less forgiving if the import is not what
they expect than <code>pml</code>.
</p>


<h3>Value</h3>

<p><code>pml.fit</code> returns the log-likelihood.
</p>


<h3>Author(s)</h3>

<p>Klaus Schliep <a href="mailto:klaus.schliep@gmail.com">klaus.schliep@gmail.com</a>
</p>


<h3>References</h3>

<p>Felsenstein, J. (1981) Evolutionary trees from DNA sequences: a
maximum likelihood approach. <em>Journal of Molecular Evolution</em>,
<b>17</b>, 368â€“376.
</p>


<h3>See Also</h3>

<p><code>pml, pml_bb, pmlPart, pmlMix</code>
</p>


<h3>Examples</h3>

<pre><code class="language-R">data(Laurasiatherian)
tree &lt;- NJ(dist.ml(Laurasiatherian))
bf &lt;- rep(0.25, 4)
eig &lt;- edQt()
pml.init(Laurasiatherian)
pml.fit(tree, Laurasiatherian, bf=bf, eig=eig)
pml.free()
pml(tree, Laurasiatherian) |&gt; logLik()
</code></pre>


</div>