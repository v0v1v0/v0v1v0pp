<div class="container">

<table style="width: 100%;"><tr>
<td>circ.psa</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>Generates a Propensity Score Assessment Plot</h2>

<h3>Description</h3>

<p>Displays a graphic that summarizes outcomes in a propensity score analysis,
based on strata that have been defined in the first Phase of a propensity
score analysis (PSA).  The graphic displays contributions of individual
strata to the overall effect, weighing contributions of individual strata
according to the relative sizes of the respective strata. The overall effect
is plotted as a heavy dashed diagonal line that runs parallel to the
identity diagonal.
</p>


<h3>Usage</h3>

<pre><code class="language-R">circ.psa(
  response,
  treatment = NULL,
  strata = NULL,
  summary = FALSE,
  statistic = "mean",
  trim = 0,
  revc = FALSE,
  confint = TRUE,
  sw = 0.4,
  ne = 0.5,
  inc = 0.25,
  pw = 0.4,
  lab = TRUE,
  labcex = 1,
  xlab = NULL,
  ylab = NULL,
  main = NULL,
  mai = c(1, 1.7, 1, 1.7)
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>response</code></td>
<td>
<p>Either a numeric vector containing the response of interest
in a propensity score analysis, or a three column array containing response,
treatment and strata.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>treatment</code></td>
<td>
<p>Binary variable of same length as <code>response</code>;
generally 0 for 'control,' 1 for 'treatment'.  A character vector with two
labels or factor with two levels are also accepted.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>strata</code></td>
<td>
<p>Generally integer variable; a vector of same length as
<code>response</code> indicating the derived strata from estimated propensity
scores. Generally 5 or 6 strata used, but function is effective for more
strata. In the case when strata are defined via unique propensity scores (as
from a tree), user may wish to define strata using <code>factor</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>summary</code></td>
<td>
<p>Logical (default <code>FALSE</code>).  If <code>TRUE</code> then
<code>response</code> must have rows corresponding to number of strata; the first
two columns should contain treatment and control group sizes for each
stratum, and the pair of columns should contain the appropriate summary
statistics for each statum.  For example, the four summary columns might
have been generated by the <code>strata.summary</code> output of <code>loess.psa</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>statistic</code></td>
<td>
<p>A scalar summary of the center of the response
distribution. Seen next item below.  Default = "mean".  Note that to
generate this statistic the full vector of responses must have been input,
not summaries.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>trim</code></td>
<td>
<p>Allows for a trimmed mean as outcome measure, where trim is from
0 to .5 (.5 implying median).</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>revc</code></td>
<td>
<p>Logical; if <code>TRUE</code> then X and Y axes are interchanged in
plot.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>confint</code></td>
<td>
<p>Logical; if <code>TRUE</code> adds an approximate 95% confidence
interval for the mean.  The interval may not be realistic it the <code>trim</code>
argument exceeds zero.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>sw</code></td>
<td>
<p>Numerical argument (default = 0.4); extends axes on lower ends,
effectively moving circles to lower left.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>ne</code></td>
<td>
<p>Numerical argument (default = 0.5); extends axes on upper ends,
effectively moving circles to upper right.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>inc</code></td>
<td>
<p>Numerical argument (default = 0.35); controls circle sizes, but
relative circle sizes are controlled via <code>pw</code>. In general one wants
circle areas to appear subjectively to be sized in accordance with strata
sizes.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>pw</code></td>
<td>
<p>numerical argument (default = 0.4); controls relative circle
sizes. <code>pw</code> denotes power or exponent for radius of circle.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>lab</code></td>
<td>
<p>Logical (default TRUE); labels circles with stratum labels.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>labcex</code></td>
<td>
<p>numerical argument (default = 1); controls the size of the
circle labels.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>xlab</code></td>
<td>
<p>Label for horizontal axis, by default taken from
<code>treatment</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>ylab</code></td>
<td>
<p>Label for vertical axis, by default taken from <code>treatment</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>main</code></td>
<td>
<p>Main label for graph.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>mai</code></td>
<td>
<p>margin parameters.</p>
</td>
</tr>
</table>
<h3>Details</h3>

<p>A circle is plotted for each stratum, centered on the means for the
treatment and control groups (for the <code>X</code> and <code>Y</code> axes)
respectively. The sizes of the circles correspond to the relative sizes of
the strata. A diagonal line (lower left to upper right) shows the identity,
<code>X=Y</code>, so that circles on, say, the lower side of this line show that
the corresponding <code>X</code> mean is larger than the <code>Y</code> mean for that
stratum, and vice-versa. Parallel projections are made from the centers of
the strata-cum-circles to difference scores that are plotted on a line
segment on the lower-left corner of the graphic; the average difference,
which corresponds to the average treatment effect (ATE) for the overall
treatment effect, is plotted as a heavy (dark blue) dashed line parallel to
the identity diagonal. Rug plots are shown on the upper and right margins of
the graphic, for the <code>X</code> and <code>Y</code> marginal distributions. A 95%
confidence interval for the overall effect is plotted to the left of the
distribution of the stratum difference scores, centered on the ATE. Trimmed
means can replace the conventional mean for both the ATE and the marginal
distributions (however, the confidence interval calculations are likely to
become less trustworthy as larger values of the trim argument are used).
</p>


<h3>Value</h3>

<p>Generate a Propensity Assessment Plot, as well as numerical data for
</p>
<table>
<tr style="vertical-align: top;">
<td><code>summary.strata</code></td>
<td>
<p>An array with rows corresponding to strata and four
columns; these show counts for control and treatment groups, as well as
(possibly trimmed) mean response values for control and treatment.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>wtd.Mn.(Name1)</code></td>
<td>
<p>Weighted mean of response for (Name1) group.  Name
taken from <code>treatment</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>wtd.Mn.(Name2)</code></td>
<td>
<p>Weighted mean of
response for (Name2) group.  Name taken from <code>treatment</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>ATE</code></td>
<td>
<p>Average Treatment Effect.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>se.wtd</code></td>
<td>
<p>Weighted standard error
for <code>ATE</code></p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>approx.t</code></td>
<td>
<p>Ratio of the average treatement effect and a
standard error based on weighting of stratum variances.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>df</code></td>
<td>
<p>Estimate
of degree of freedom; response vector length minus twice number of strata.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>CI.95</code></td>
<td>
<p>Approximate 95% confidence interval for overall effect size.</p>
</td>
</tr>
</table>
<h3>Author(s)</h3>

<p>James E. Helmreich <a href="mailto:James.Helmreich@Marist.edu">James.Helmreich@Marist.edu</a>
</p>
<p>Robert M. Pruzek <a href="mailto:RMPruzek@yahoo.com">RMPruzek@yahoo.com</a>
</p>


<h3>See Also</h3>

<p><code>loess.psa</code>
</p>


<h3>Examples</h3>

<pre><code class="language-R">
##Random data with effect size 0
response &lt;- rnorm(1000)
treatment &lt;- sample(c(0,1), 1000, replace = TRUE)
strata &lt;- sample(1:6, 1000, replace = TRUE)
circ.psa(response, treatment, strata)

##Random data with effect size -.2
response &lt;- c(rnorm(500, 0, 12), rnorm(500, 6, 12))
treatment &lt;- c(rep(0, 500), rep(1,500))
strata &lt;- sample(1:5, 1000, replace = TRUE)
aaa &lt;- cbind(response, treatment, strata)
circ.psa(aaa)

##Random data with effect size -2
response &lt;- c(rt(100,3) * 2 + 20, rt(100,12) * 2 + 18)
treatment &lt;- rep(c("A","B"), each = 100)
strata &lt;- sample(c("X","Y","Z","U","V"), 200, replace = TRUE)
circ.psa(response, treatment, strata)

##Tree derived strata
library(rpart)
data(lindner)
attach(lindner)
lindner.rpart &lt;- rpart(abcix ~ stent + height + female + diabetic +
     acutemi + ejecfrac + ves1proc, data = lindner, method = "class")
lindner.tree&lt;-factor(lindner.rpart$where, labels = 1:6)
circ.psa(log(cardbill), abcix, lindner.tree)

##Loess derived strata
lindner.ps &lt;- glm(abcix ~ stent + height + female +
      diabetic + acutemi + ejecfrac + ves1proc,
      data = lindner, family = binomial)
ps&lt;-lindner.ps$fitted
lindner.loess&lt;-loess.psa(log(cardbill), abcix, ps)
circ.psa(lindner.loess$summary.strata[, 1:4], summary = TRUE,
      inc = .1, labcex = .7)
</code></pre>


</div>