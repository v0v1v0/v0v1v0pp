<div class="container">

<table style="width: 100%;"><tr>
<td>sampleN.dp</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>
Sample size estimation of dose-proportionality studies evaluated via the power model
</h2>

<h3>Description</h3>

<p>Performes a sample size estimation for dose-proportionality studies using the 
power model for cossover (Latin square), parallel group designs or incomplete
block designs via a confidence interval equivalence criterion.
</p>


<h3>Usage</h3>

<pre><code class="language-R">sampleN.dp(alpha = 0.05, CV, doses, targetpower = 0.8, beta0, theta1 = 0.8, 
           theta2 = 1/theta1, design = c("crossover", "parallel", "IBD"), 
           dm=NULL, CVb, print = TRUE, details = FALSE, imax = 100)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>alpha</code></td>
<td>

<p>Type 1 error. Usually set to 0.05.
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>CV</code></td>
<td>

<p>Coefficient of variation. Is intra-subject CV for <code>design="crossover"</code> and
CV of total variability in case of <code>design="parallel"</code>
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>doses</code></td>
<td>

<p>Vector of dose values under study. At least two doses have to be given.
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>targetpower</code></td>
<td>

<p>Power to achieve at least. Must be &gt;0 and &lt;1.<br>
Typical values are 0.8 or 0.9.
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>beta0</code></td>
<td>

<p>‘True’ or assumed slope of the power model. If missing defaults to <code>1+log(0.95)/log(rd)</code>
where <code>rd</code> is the ratio is the ratio of the highest to the lowest dose.<br> 
Has to be within slope acceptance range according to
<code>1+log(theta1)/log(rd)</code> and <code>1+log(theta2)/log(rd)</code>. Otherwise, the 
function issues an error.
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>theta1</code></td>
<td>

<p>Lower acceptance limit for the ratio of dose normalized means (Rdmn).<br>
Transformes into slope acceptance range as described under item <code>beta0</code>.
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>theta2</code></td>
<td>

<p>Upper acceptance limit for the ratio of dose normalized means (Rdmn).
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>design</code></td>
<td>

<p>Crossover design (default), parallel group design or incomplete block design (IBD).<br>
Crossover design means Latin square design with number of doses as dimension.
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>dm</code></td>
<td>

<p>'Design matrix' of the incomplete block design (IBD) if <code>design="IBD"</code>.<br>
This matrix contains the sequences in rows and periods in columns. 
The entry (<em>i</em>, <em>j</em>) of the design matrix corresponds to the dose (index) a subject 
with <em>i</em>-th sequence gets in the <em>j</em>-th period.
Can be obtained f.i. via functions of package <code>crossdes</code>. See examples.<br>
Function <code>bib.CL</code> returns some IBDs described by Chow &amp; Liu.
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>CVb</code></td>
<td>

<p>Coefficient of variation of the between-subject variability.<br>
Only necessary if <code>design="IBD"</code>. Will be set to 2*CV if missing.
This is only a crude rule of thumb. Better obtain an estimate of CVb from a previous crossover study.<br><br>
Set <code>CVb=0</code> if all-effects-fixed model shall be used. This model gives
lower sample sizes than the mixed model with random subject effects 
(random intercept).  
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>print</code></td>
<td>

<p>If <code>TRUE</code> (default) the function prints its results.<br> 
If set to <code>FALSE</code> only the data.frame with the results will be returned. 
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>details</code></td>
<td>

<p>If <code>details=TRUE</code> the steps during sample size search will be shown. Defaults to <code>FALSE</code>.
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>imax</code></td>
<td>

<p>Maximum number of steps in sample size search. <br> 
Defaults to 100. Adaption only in rare cases needed, if any.
</p>
</td>
</tr>
</table>
<h3>Details</h3>

<p>The sample size is estimated via iterative evaluation of <code>power.dp()</code>.<br>
Start value for the sample size search is taken from a large sample approximation.<br>
The sample size is bound to number of dose or sequence groups as minimum.<br>
Balanced designs are used although this is not absolutely necessary.<br><br>
The estimated sample size gives always the <em>total</em> number of subjects (not subject/sequence in crossovers or subjects/group in parallel designs – like in some other software packages).
</p>


<h3>Value</h3>

<p>A data.frame with the input and results will be returned.<br>
The <code>Sample size</code> column contains the total sample size.
</p>


<h3>Warning </h3>

<p>This function is ‘experimental’ only, since it is not thorougly tested yet. 
Especially for <code>design="IBD"</code> reliable test cases are missing.
</p>


<h3>Author(s)</h3>

<p>D. Labes
</p>


<h3>References</h3>

<p>Chow SC, Liu JP. <em>Design and Analysis of Bioavailability and Bioequivalence Studies.</em> Boca Raton: CRC Press; 3<sup>rd</sup> edition 2009.
</p>
<p>Patterson S, Jones B. <em>Bioequivalence and Statistics in Clinical Pharmacology.</em> Boca Raton: Chapman &amp; Hall/CRC: 2006. p. 239.<br>
(contains presumably a bug)
</p>
<p>Sethuraman VS, Leonov S, Squassante L, Mitchell TR, Hale MD. <em>Sample size calculation for the Power Model for dose proportionality studies.</em> Pharm Stat. 2007;6(1):35–41. <a href="https://doi.org/10.1002/pst.241">doi:10.1002/pst.241</a>
</p>
<p>Hummel J, McKendrick S, Brindley C, French R. <em>Exploratory assessment of dose proportionality: review of current approaches and proposal for a practical criterion.</em> Pharm. Stat. 2009;8(1):38–49. <a href="https://doi.org/10.1002/pst.326">doi:10.1002/pst.326</a>
</p>


<h3>See Also</h3>

<p><code>power.dp</code>, <code>bib.CL</code>
</p>


<h3>Examples</h3>

<pre><code class="language-R"># using all the defaults, i.e. crossover design, alpha=0.05
# theta1=0.8, theta2=1.25 but true slope slightly off 1
sampleN.dp(CV = 0.2, doses = c(1, 2, 8), beta0 = 1.02)
# should give n=18, power=0.854528


# incomplete block design with 5 doses, 3 periods
# from library(crossdes)
doses  &lt;- c(5, 25, 50, 100, 200)
CVb    &lt;- mse2CV(0.8)
levels &lt;- length(doses)
per    &lt;- 3
block  &lt;- levels*(levels-1)/(per-1)
# IBD based on balanced minimal repeated measurements design
# gives n=30 and 10 sequences
ibd    &lt;- crossdes::balmin.RMD(levels, block, per)
sampleN.dp(CV = 0.2, doses = doses, beta0 = 1, design = "IBD", dm = ibd, 
           CVb = CVb, targetpower=0.9)
</code></pre>


</div>