<div class="container">

<table style="width: 100%;"><tr>
<td>validate_kinship</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>Validate a kinship matrix</h2>

<h3>Description</h3>

<p>Tests that the input is a valid kinship matrix (a numeric, square, and optionally symmetric R matrix).
Intended for matrices to plot and for other uses, including biased estimates, so there is flexibility as to what constitutes a valid kinship matrix.
Throws errors if the input is not as above.
Can instead return <code>TRUE</code>/<code>FALSE</code> if <code>logical = TRUE</code>.
</p>


<h3>Usage</h3>

<pre><code class="language-R">validate_kinship(kinship, sym = TRUE, name = "kinship", logical = FALSE)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>kinship</code></td>
<td>
<p>The kinship matrix to validate.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>sym</code></td>
<td>
<p>If <code>TRUE</code> (default), the matrix is required to be symmetric.  Otherwise this particular test is skipped.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>name</code></td>
<td>
<p>Default "kinship".
Change to desired variable name for more informative error messages (i.e. "A" when used to validate the <code>A</code> matrix inside <code>popkin_A_min_subpops</code>).</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>logical</code></td>
<td>
<p>If <code>FALSE</code> (default), function stops with an error message if the input is not a kinship matrix.
If <code>TRUE</code>, function instead returns <code>TRUE</code> if the input passed all tests (appears to be a valid kinship matrix) or <code>FALSE</code> otherwise.</p>
</td>
</tr>
</table>
<h3>Details</h3>

<p>True kinship matrices have values strictly between 0 and 1, and diagonal values strictly between 0.5 and 1.
However, estimated matrices may contain values slightly out of range.
For greater flexibility, this function does not check for out-of-range values.
</p>


<h3>Value</h3>

<p>If <code>logical = FALSE</code> (default), nothing.
If <code>logical = TRUE</code>, returns <code>TRUE</code> if the input is a valid kinship matrix, <code>FALSE</code> otherwise.
</p>


<h3>Examples</h3>

<pre><code class="language-R"># this is a valid (positive) example
kinship &lt;- matrix(c(0.5, 0, 0, 0.6), nrow=2)
# this will run without errors or warnings
validate_kinship(kinship)

# negative examples

# dies if input is missing
try( validate_kinship() )

# and if input is not a matrix
try( validate_kinship( 1:5 ) )

# and for non-numeric matrices
char_mat &lt;- matrix(c('a', 'b', 'c', 'd'), nrow=2)
try( validate_kinship( char_mat ) )

# and non-square matrices
non_kinship &lt;- matrix(1:2, nrow=2)
try( validate_kinship( non_kinship ) )

# and non-symmetric matrices
non_kinship &lt;- matrix(1:4, nrow=2)
try( validate_kinship( non_kinship ) )
# but example passes if we drop symmetry requirement this way
validate_kinship( non_kinship, sym = FALSE )

# instead of stopping, can get a logical value
# this returns FALSE
validate_kinship( non_kinship, logical = TRUE )

</code></pre>


</div>