<div class="container">

<table style="width: 100%;"><tr>
<td>force.ultrametric</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>Coerces a phylogenetic tree to be ultrametric</h2>

<h3>Description</h3>

<p>Coerces an object of class <code>"phylo"</code> to be ultrametric. 
</p>


<h3>Usage</h3>

<pre><code class="language-R">force.ultrametric(tree, method=c("nnls","extend"), ...)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>tree</code></td>
<td>
<p>an object of class <code>"phylo"</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>method</code></td>
<td>
<p>the method to use to force the tree to be ultrametric. Options are <code>"nnls"</code> (which uses the <span class="pkg">phangorn</span> function <code>nnls.tree</code> internally), or <code>"extend"</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>...</code></td>
<td>
<p>optional arguments: principally, <code>message</code>. This argument (if set to <code>FALSE</code>) can be used to suppress the default warning message that <code>force.ultrametric</code> <em>should not</em> be used as a formal statistical method to ultrametricize a tree.</p>
</td>
</tr>
</table>
<h3>Details</h3>

<p><code>force.ultrametric</code> coerces a non-ultrametric tree to be ultrametric.
</p>
<p>This is achieved either by using <code>nnls.tree</code> from the <span class="pkg">phangorn</span> package to compute the set of edge lengths that result in a minimized sum-of-squares distance between the patristic distance of the output and input trees (<code>method="nnls"</code>); or by simply extending all the external edges of the tree to match the external edge with the greatest total height (<code>method="extend"</code>). 
</p>
<p>Note that neither of these should be treated as formal statistical methods for inferring an ultrametric tree. Rather, this method can be deployed when a genuinely ultrametric tree read from file fails <code>is.ultrametric</code> for reasons of numerical precision. 
</p>


<h3>Value</h3>

<p>An ultrametric tree in an object of class <code>"phylo"</code>.
</p>


<h3>Author(s)</h3>

<p>Liam Revell <a href="mailto:liam.revell@umb.edu">liam.revell@umb.edu</a></p>


<h3>References</h3>

<p>Revell, L. J. (2024) phytools 2.0: an updated R ecosystem for phylogenetic comparative methods (and other things). <em>PeerJ</em>, <b>12</b>, e16505.
</p>


<h3>See Also</h3>

<p><code>is.ultrametric</code>, <code>nnls.tree</code>
</p>


</div>