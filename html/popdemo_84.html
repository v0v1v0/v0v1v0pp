<div class="container">

<table style="width: 100%;"><tr>
<td>tfam_lambda</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>Transfer function analysis</h2>

<h3>Description</h3>

<p>Transfer function analysis of the dominant eigenvalue of a population matrix 
projection model for all matrix elements.
</p>


<h3>Usage</h3>

<pre><code class="language-R">tfam_lambda(
  A,
  elementtype = NULL,
  Flim = c(-1, 10),
  Plim = c(-1, 10),
  plength = 100,
  digits = 1e-10
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>A</code></td>
<td>
<p>a square, irreducible, nonnegative numeric matrix of any dimension</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>elementtype</code></td>
<td>
<p>(optional) a character matrix of the same dimension as 
<code>A</code> describing the structure of <code>A</code>: <code>"P"</code> denotes elements 
bounded between 0 and 1, i.e. survival, growth, regression; <code>"F"</code> 
denotes elements not bounded at 1, i.e. fecundity, fission; <code>NA</code> 
denotes absent elements (see details).</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>Flim, Plim</code></td>
<td>
<p>the perturbation ranges for <code>"F"</code> and <code>"P"</code> 
elements, expressed as a proportion of their magnitude  (see details).</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>plength</code></td>
<td>
<p>the desired length of the perturbation ranges.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>digits</code></td>
<td>
<p>specifies which values of lambda should be excluded from 
analysis to avoid a computationally singular system (see details).</p>
</td>
</tr>
</table>
<h3>Details</h3>

<p><code>tfam_lambda</code> calculates an array of transfer functions of the dominant
eigenvalue of <code>A</code>. A separate transfer function for each nonzero 
element of <code>A</code> is calculated (each element perturbed independently of 
the others). The function is most useful for use with the S3 method 
<code>plot.tfam</code> to visualise how perturbations affect the 
life cycle transitions, and easily compare the (nonlinear) effect of 
perturbation to different transitions on the dominant eigenvalue.
</p>
<p>The sizes of the perturbations are determined by <code>elementtype</code>, 
<code>Flim</code>, <code>Plim</code> and <code>plength</code>. <code>elementtype</code> gives the 
type of each element, specifying whether perturbations should be 
bounded at 1 (<code>elementtype = "P"</code>) or not (<code>elementtype = "F"</code>). 
If <code>elementtype</code> is not directly specified, the function assigns its 
own types, with those in the first row attributed <code>"F"</code>, and elsewhere 
in the matrix attributed <code>"F"</code> if the value of the element &gt;1 and 
<code>"P"</code> if the value of the element is &lt;=1. <code>Flim</code> and <code>Plim</code> 
determine the desired perturbation magnitude, expressed as a proportion of 
the magnitude of the elements of <code>A</code>, whilst plength determines the 
length of the perturbation vector.  For example, if an "F" element is equal 
to 0.5, <code>Flim=c(-1,10)</code> and <code>plength=100</code> then the perturbation 
to that element is <code>seq(-1*0.5,10*0.5,100-1)</code>. The process is the same 
for <code>"P"</code> elements, except that these are truncated to a maximum value 
of 1 (growth/survival elements cannot be greater than 1). Both <code>"F"</code> 
and <code>"P"</code> elements are truncated to a minimum value of 0.
</p>
<p><code>tfam_lambda</code> uses <code>tfa_lambda</code> to calculate transfer 
functions. <code>digits</code> is passed to <code>tfa_lambda</code> to prevent the 
problem of singular matrices (see details in <code>tfa_lambda</code>).
</p>
<p><code>tfam_lambda</code> will not work for reducible matrices.
</p>


<h3>Value</h3>

<p>A list containing numerical arrays:
</p>

<dl>
<dt>p</dt>
<dd>
<p>perturbation magnitudes</p>
</dd>
<dt>lambda</dt>
<dd>
<p>dominant eigenvalues of perturbed matrices</p>
</dd>
</dl>
<p>The first and second dimensions of the arrays are equivalent to
the first and second dimensions of <code>A</code>. The third dimension of the
arrays are the vectors returned by <code>tfa_lambda</code>. e.g. $lambda[3,2,] selects
the lambda values for the transfer function of element [3,2] of the matrix.
</p>


<h3>References</h3>


<ul>
<li>
<p> Townley &amp; Hodgson (2004) J. Appl. Ecol., 41, 1155-1161.
</p>
</li>
<li>
<p> Hodgson et al. (2006) J. Theor. Biol., 70, 214-224.
</p>
</li>
</ul>
<h3>See Also</h3>

<p>S3 plotting method: <code>plot.tfa</code>
</p>
<p>Other TransferFunctionAnalyses: 
<code>tfa_inertia()</code>,
<code>tfa_lambda()</code>,
<code>tfam_inertia()</code>,
<code>tfs_inertia()</code>,
<code>tfs_lambda()</code>
</p>
<p>Other PerturbationAnalyses: 
<code>elas()</code>,
<code>sens()</code>,
<code>tfa_inertia()</code>,
<code>tfa_lambda()</code>,
<code>tfam_inertia()</code>,
<code>tfs_inertia()</code>,
<code>tfs_lambda()</code>
</p>


<h3>Examples</h3>

<pre><code class="language-R">  # Create a 3x3 matrix
  ( A &lt;- matrix(c(0,1,2,0.5,0.1,0,0,0.6,0.6), byrow=TRUE, ncol=3) )

  # Calculate the matrix of transfer functions using default arguments
  ( tfmat&lt;-tfam_lambda(A) )

  # Plot the result using the S3 method
  plot(tfmat)

  # Plot the transfer function of element [3,2] without using the S3 method
  par(mfrow=c(1,1))
  par(mar=c(5,4,4,2)+0.1)
  plot(tfmat$lambda[3,2,]~tfmat$p[3,2,],xlab="p",ylab="lambda",type="l")

  # Create a new matrix with fission of adults
  B &lt;- A; B[2,3] &lt;- 0.9; B

  # Calculate the matrix of transfer functions using chosen arguments
  # that give the exact structure of the new matrix
  # and perturb a minimum of half the value of an element and
  # a maximum of double the value of an element
  ( etype &lt;- matrix(c(NA, "F", "F", "P", "P", "F", NA, "P", "P"), 
                  ncol=3, byrow=TRUE) )
  ( tfmat2 &lt;- tfam_lambda(B, elementtype=etype, Flim=c(-0.5,2),
                      Plim=c(-0.5,2)) )

  # Plot the new matrix of transfer functions using the S3 method
  plot(tfmat2)
    
</code></pre>


</div>