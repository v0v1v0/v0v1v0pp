<div class="container">

<table style="width: 100%;"><tr>
<td>plotNullDistribution</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>Plot permutation <code class="reqn">p</code>-values distribution</h2>

<h3>Description</h3>

<p>Create a plot of permutation-based <code class="reqn">p</code>-values with corresponding specified critical vectors.
</p>


<h3>Usage</h3>

<pre><code class="language-R">plotNullDistribution(P=NULL,family="simes",alpha = 0.05, 
path = getwd(), name = "plot", delta = 0,
copes=NULL,mask=NULL, alternative = "two.sided", rand = FALSE, B = 1000)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>P</code></td>
<td>
<p>Matrix of <code class="reqn">p</code>-values with dimensions <code class="reqn">m \times B</code> where <code class="reqn">m</code> is the number of variables 
and <code class="reqn">B</code> the number of permutations used instead of the data matrix <code>X</code>. Default to <code>NULL</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>family</code></td>
<td>
<p>String character. Name of the family confidence envelope to compute the critical vector 
from <code>"simes"</code>, <code>"aorc"</code>, <code>"beta"</code>, <code>"higher.criticism"</code>, and <code>"power"</code>.
Default to "simes". If more than one critical vector are considered, it must be a vector.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>alpha</code></td>
<td>
<p>Numeric value in '[0,1]'. <code class="reqn">\alpha</code> level to control the family-wise error rate. Default to 0.05.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>path</code></td>
<td>
<p>Character string. Path to save the plot. The path does not must end with <code>/</code>. Default to <code>getwd()</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>name</code></td>
<td>
<p>Character string. The name of file that will be used to save the plot. Default to "plot".</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>delta</code></td>
<td>
<p>Numeric value. <code class="reqn">\delta</code> value. Please see the reference below. Default to 0. 
If more than one critical vector are considered, <code>delta</code> must be a vector having length equals to the length of the vector specified in <code>family</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>copes</code></td>
<td>
<p>List of NIfTI file. The list of copes, i.e., contrasts maps, one for each subject used to compute the statistical tests.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>mask</code></td>
<td>
<p>NIfTI file or character string. 3D array of logical values (i.e. <code>TRUE/FALSE</code> in/out of the brain). 
Alternatively it may be a (character) NIfTI file name. If <code>mask=NULL</code>, it is assumed that none of the voxels have to be excluded.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>alternative</code></td>
<td>
<p>Character string. It refers to the alternative hypothesis, must be one of <code>"two.sided"</code> (default), <code>"greater"</code> or <code>"lower"</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>rand</code></td>
<td>
<p>Boolean value. Default to <code>FALSE</code>. If <code>rand = TRUE</code>, the <code class="reqn">p</code>-values are computed by <code>rowRanks</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>B</code></td>
<td>
<p>Numeric value. Number of permutations, default to 1000.</p>
</td>
</tr>
</table>
<h3>Value</h3>

<p>Save a plot in <code>path</code> with name specified in <code>name</code> describing the <code class="reqn">p</code>-values null distribution with critical value curve and observed <code class="reqn">p</code>-values in red.
</p>


<h3>Author(s)</h3>

<p>Angela Andreella
</p>


<h3>References</h3>

<p>Andreella, A., Hemerik, J., Finos, L., Weeda, W., &amp; Goeman, J. (2023). Permutation-based true discovery proportions for functional magnetic resonance imaging cluster analysis. Statistics in Medicine, 42(14), 2311-2340.
</p>


<h3>Examples</h3>

<pre><code class="language-R">## Not run: 
db &lt;- simulateData(pi0 = 0.8, m = 100, n = 20, rho = 0)
out &lt;- signTest(X = db)
pv &lt;- cbind(out$pv, out$pv_H0)
plotNullDistribution(P = pv)

## End(Not run)

</code></pre>


</div>