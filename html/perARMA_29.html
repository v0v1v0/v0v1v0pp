<div class="container">

<table style="width: 100%;"><tr>
<td>R_w_ma</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>
Covariance matrix for PARMA model (conditional)
</h2>

<h3>Description</h3>

<p>Procedure <code>R_w_ma</code> computes the covariance matrix of the moving average 
part of a PARMA sequence. 
This is used in maximum likelihood estimation in conjunction with 
the Ansley transformation method of computing the likelihood 
of the sample conditioned on the firt <code>m = max(p; q)</code>
samples being ignored (or set to null); see Ansley or Brockwell and Davis for 
background on the procedure. The method avoids the cumbersome calculation of
full covariance matrix.
</p>


<h3>Usage</h3>

<pre><code class="language-R">R_w_ma(theta, nstart, nlen)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>theta</code></td>
<td>

<p>matrix of size <code class="reqn"> T \times (q+1)</code> contains vectorial 
parameters <code class="reqn"> [\theta_0,\theta_1,...,\theta_q]</code>, where
<code class="reqn">\theta(0,t)=\sigma(t)=del(t)</code>, thus
<code>theta = [del,theta_1,...,theta_q]</code>.
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>nstart</code></td>
<td>

<p>starting time, for conditional likelihood in PARMA  set to <code>p+1</code>.
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>nlen</code></td>
<td>

<p>size of the covariance matrix.
</p>
</td>
</tr>
</table>
<h3>Details</h3>

<p>Procedure <code>R_w_ma</code>  implements calculation of covariance matrix of size <code>nlen-p</code> from the parameters <code>theta</code> and <code>phi</code> of PARMA sequence.
The result is returned  as two vectors, first containing non-zero 
elements of covariance matrix and the second containing indexes of this parameters.
Using these vectors covariance matrix can be easily reconstructed.
</p>


<h3>Value</h3>

<p>procedure returns covariance matrix in sparse format as following: 
</p>
<table>
<tr style="vertical-align: top;">
<td><code>R</code></td>
<td>
<p>vector of non-zero elements of covariance matrix.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>rindex</code></td>
<td>
<p>vector of indexes of non-zero elements.</p>
</td>
</tr>
</table>
<h3>Author(s)</h3>

<p>Harry Hurd 
</p>


<h3>References</h3>

<p>Ansley, (1979), An algorithm for the exact likelihood of a mixed autregressive moving average process, Biometrika, v.66, pp.59-65.
<br><br>
Brockwell, P. J., Davis, R. A. (1991), Time Series: Theory and Methods, 2nd Ed., Springer: New York.
</p>


<h3>See Also</h3>

<p><code>loglikec</code>,  <code>loglikef</code>
</p>


<h3>Examples</h3>

<pre><code class="language-R">T=12
nlen=480
p=2
 a=matrix(0,T,p)
q=1
 b=matrix(0,T,q)
a[1,1]=.8                  
a[2,1]=.3                 
                          
phia&lt;-ab2phth(a) 
phi0=phia$phi          
phi0=as.matrix(phi0)        
      
b[1,1]=-.7	          
b[2,1]=-.6                  
thetab&lt;-ab2phth(b)         
theta0=thetab$phi  
theta0=as.matrix(theta0) 
del0=matrix(1,T,1)    


R_w_ma(cbind(del0,theta0),p+1,T)    

</code></pre>


</div>