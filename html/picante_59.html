<div class="container">

<table style="width: 100%;"><tr>
<td>sppregs</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2> Regressions to Separate Phylogenetic Attraction and Repulsion </h2>

<h3>Description</h3>

<p>Fit regressions on species abundance or presence/absence across communities and calculate phylogenetic correlations
</p>


<h3>Usage</h3>

<pre><code class="language-R">sppregs(samp, env, tree=NULL, fam="gaussian")
sppregs.plot(sppreg, rows=c(1,3), cex.mag=1, x.label="phylogenetic correlations", 
    y.label=c("occurrence correlations w/ env", "occurrence correlations wo/ env",
    "change in correlations"))
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>samp</code></td>
<td>
<p> community data matrix, species as columns, communities as rows </p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>env</code></td>
<td>
<p> environmental data matrix </p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>tree</code></td>
<td>
<p>  phylo tree object or a phylogenetic covariance matrix </p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>fam</code></td>
<td>
<p> with <code>fam = "gaussian"</code> fits with <code>glm</code>; with <code>fam = "binomial"</code> fit logistic regressions with Firth's bias-reduction using <code>brglm</code>  </p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>sppreg</code></td>
<td>
<p> object from function <code>sppregs</code> </p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>rows</code></td>
<td>
 <p><code>rows = c(1,3)</code> plots in a row; <code>rows = c(3,1)</code> in a column </p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>cex.mag</code></td>
<td>
<p> value for <code>cex</code> in <code>par</code> </p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>x.label</code></td>
<td>
<p> x axis labels </p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>y.label</code></td>
<td>
<p> y axis labels </p>
</td>
</tr>
</table>
<h3>Details</h3>

<p>For each species in <code>samp</code>, the function fits regressions of species presence/absence or abundances
on the environmental variables supplied in <code>env</code>; and calculates the <code>(n^2-n)/2</code> pairwise species correlations
between the residuals of these fits and pairwise species phylogenetic correlations. The residuals can be
thought of as the presence/absence of species across sites/communities after accounting for how species respond
to environmental variation across sites. Each set of coefficients can be tested for phylogenetic signal with, for example, 
the function <code>phylosignal</code>. 
<br><br>
The function <code>sppregs.plot</code> produces a set of three plots of the correlations of pairwise species phylogenetic correlations versus: 
the observed pairwise correlations of species across communities, the residual correlations, and the pairwise differences between (i.e., the 
change in species co-occurrence once the environmental variables are taken into account). The significance of these correlations can be tested
via permutation with the function <code>phylostruct</code>.
</p>


<h3>Value</h3>

<table>
<tr style="vertical-align: top;">
<td><code>family</code></td>
<td>
<p> the regression error distribution </p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>residuals</code></td>
<td>
<p> the residuals from each species regression </p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>coefficients</code></td>
<td>
<p> the estimated coefficients from each species regression </p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>std.errors</code></td>
<td>
<p> the standard errors of the coefficients </p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>correlations</code></td>
<td>
<p> correlations of pairwise species phylogenetic correlations between: the observed pairwise correlations of species across communities, the residual correlations, and the pairwise differences between the two </p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>cors.pa</code></td>
<td>
<p> the observed pairwise correlations of species across communities </p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>cors.resid</code></td>
<td>
<p> the residual pairwise correlations of species across communities </p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>cors.phylo</code></td>
<td>
<p> the phylogenetic pairwise correlations among species </p>
</td>
</tr>
</table>
<h3>Note</h3>

<p>The function requires the library <code>brglm</code> to perform logistic regressions</p>


<h3>Author(s)</h3>

<p> Matthew Helmus <a href="mailto:mrhelmus@gmail.com">mrhelmus@gmail.com</a> </p>


<h3>References</h3>

<p> Helmus M.R., Savage K., Diebel M.W., Maxted J.T. &amp; Ives A.R. (2007) Separating the determinants of phylogenetic community structure. Ecology Letters, 10, 917-925 </p>


<h3>See Also</h3>

<p><code>phylostruct</code>, <code>phylosignal</code></p>


</div>