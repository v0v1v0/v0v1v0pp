<div class="container">

<table style="width: 100%;"><tr>
<td>randomallele.pca</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>PCA of a pooldata or countdata object using a random allele approach</h2>

<h3>Description</h3>

<p>PCA of a pooldata or countdata object using a random allele approach
</p>


<h3>Usage</h3>

<pre><code class="language-R">randomallele.pca(
  x,
  scale = TRUE,
  return.snploadings = FALSE,
  plot.pcs = c(1, 2),
  ...
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>x</code></td>
<td>
<p>A pooldata object containing Pool-Seq information or a countdata object containing allele count information</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>scale</code></td>
<td>
<p>If FALSE the random allele data matrix is not scaled (default=TRUE)</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>return.snploadings</code></td>
<td>
<p>If TRUE return the SNP loadings (may be large)</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>plot.pcs</code></td>
<td>
<p>A vector with two-elements giving the two PCs to plot. If NULL, no plotting is done.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>...</code></td>
<td>
<p>graphical parameters (see <code>plot</code> function)</p>
</td>
</tr>
</table>
<h3>Details</h3>

<p>PCA is performed by singular-value decomposition (SVD) of a npop (or npools) x nsnp matrix of a single randomly sampled allele (i.e. or read for pooldata object) for each SNP and for each population (inspired by Skoglund and Jakobsson, 2011, https://doi.org/10.1073/pnas.1108181108). Although this approach leads to information loss, it allows to efficiently account for unequal sample size (and read coverages for pool-seq data) and have little impact on the resulting representation when the number of SNPs is large. Note also that the implemented approach is similar to that implemented in the PCA_MDS module of the software ANGSD by Korneliussen et al. (2014) (see http://www.popgen.dk/angsd/index.php/PCA_MDS).
</p>


<h3>Value</h3>

<p>An object of class fstats (see help(fstats) for details)
</p>


<h3>See Also</h3>

<p>To generate pooldata object, see <code>vcf2pooldata</code>, <code>popsync2pooldata</code>,<code>genobaypass2pooldata</code> or <code>genoselestim2pooldata</code>. To generate coundata object, see <code>genobaypass2countdata</code> or <code>genotreemix2countdata</code>.
</p>


<h3>Examples</h3>

<pre><code class="language-R"> make.example.files(writing.dir=tempdir())
 pooldata&lt;-popsync2pooldata(sync.file=paste0(tempdir(),"/ex.sync.gz"),poolsizes=rep(50,15))
 res.pca&lt;-randomallele.pca(pooldata)
</code></pre>


</div>