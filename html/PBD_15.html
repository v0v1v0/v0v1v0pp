<div class="container">

<table style="width: 100%;"><tr>
<td>pbd_sim</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2> Function to simulate the protracted speciation process </h2>

<h3>Description</h3>

<p> Simulating the protracted speciation process using the Doob-Gillespie algorithm.
This function differs from pbd_sim_cpp that 1) it does not require that the speciation-initiation
rate is the same for good and incipient species, and 2) that it simulates the exact protracted
speciation process, and not the approximation made by the coalescent point process. This function
provides also the conversion to the approximation as output.
</p>


<h3>Usage</h3>

<pre><code class="language-R"> pbd_sim(
   pars,
   age,
   soc = 2,
   plotit = FALSE,
   limitsize = Inf
) </code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>pars</code></td>
<td>
<p>Vector of parameters: <br><br><code>pars[1]</code> corresponds to b_1, the speciation-initiation rate of good species <br><code>pars[2]</code> corresponds to la_1, the speciation-completion rate <br><code>pars[3]</code> corresponds to b_2, the speciation-initiation rate of incipient species <br><code>pars[4]</code> corresponds to mu_1, the extinction rate of good species <br><code>pars[5]</code> corresponds to mu_2, the extinction rate of incipient species <br></p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>age</code></td>
<td>
<p> Sets the age for the simulation </p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>soc</code></td>
<td>
<p> Sets whether this age is the stem (1) or crown (2) age </p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>plotit</code></td>
<td>
<p> Sets whether the various trees produced by the function should be plotted or not</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>limitsize</code></td>
<td>
<p> Sets a maximum to the number of incipient + good species that are created during the simulation; if exceeded, the simulation is aborted and removed.</p>
</td>
</tr>
</table>
<h3>Value</h3>

<table><tr style="vertical-align: top;">
<td><code>out</code></td>
<td>
<p> A list with the following elements: <br><br><code>tree</code> is the tree of extant species in phylo format <br><code>stree_random</code> is a tree with one random sample per species in phylo format <br><code>stree_oldest</code> is a tree with the oldest sample per species in phylo format <br><code>stree_youngest</code> is a tree with the youngest sample per species in phylo format <br><code>L</code> is a matrix of all events in the simulation where <br>
- the first column is the incipient-level label of a species <br>
- the second column is the incipient-level label of the parent of the species <br>
- the third column is the time at which a species is born as incipient species<br>
- the fourth column is the time of speciation-completion of the species <br>
If the fourth element equals -1, then the species is still incipient.
- the fifth column is the time of extinction of the species <br>
If the fifth element equals -1, then the species is still extant.
- The sixth column is the species-level label of the species <br><code>sL_random</code> is a matrix like L but for <code>stree_random</code> <br><code>sL_oldest</code> is a matrix like L but for <code>stree_oldest</code> <br><code>sL_youngest</code> is a matrix like L but for <code>stree_youngest</code> <br><code>igtree.extinct</code> is the tree in simmap format with incipient and good flags and including extinct species <br><code>igtree.extant</code> is the tree in simmap format with incipient and good flags without extinct species <br><code>recontree</code> is the reconstructed tree in phylo format, reconstructed using the approximation in Lambert et al. 2014 <br><code>reconL</code> is the matrix corresponding to <code>recontree</code> <br><code>L0</code> is a matrix where the crown age is at 0; for internal use only <br></p>
</td>
</tr></table>
<h3>Author(s)</h3>

<p> Rampal S. Etienne </p>


<h3>See Also</h3>

<p><code>pbd_sim_cpp</code>
</p>


<h3>Examples</h3>

<pre><code class="language-R"> pbd_sim(c(0.2,1,0.2,0.1,0.1),15) </code></pre>


</div>