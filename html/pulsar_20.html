<div class="container">

<table style="width: 100%;"><tr>
<td>pulsar</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>pulsar: serial or parallel mode</h2>

<h3>Description</h3>

<p>Run pulsar using StARS' edge stability (or other criteria) to select an undirected graphical model over a lambda path.
</p>


<h3>Usage</h3>

<pre><code class="language-R">pulsar(
  data,
  fun = huge::huge,
  fargs = list(),
  criterion = c("stars"),
  thresh = 0.1,
  subsample.ratio = NULL,
  rep.num = 20,
  seed = NULL,
  lb.stars = FALSE,
  ub.stars = FALSE,
  ncores = 1,
  refit = TRUE
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>data</code></td>
<td>
<p>A <code class="reqn">n*p</code> matrix of data matrix input to solve for the <code class="reqn">p*p</code> graphical model</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>fun</code></td>
<td>
<p>pass in a function that returns a list representing <code class="reqn">p*p</code> sparse, undirected graphical models along the desired regularization path. The expected inputs to this function are: a data matrix input and a sequence of decreasing lambdas and must return a list or S3 object with a member <em>named</em> <code>path</code>. This should be a list of adjacency matrices for each value of <code>lambda</code>. See <code>pulsar-function</code> for more information.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>fargs</code></td>
<td>
<p>arguments to argument <code>fun</code>. Must be a named list and requires at least one member <code>lambda</code>, a numeric vector with values for the penalty parameter.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>criterion</code></td>
<td>
<p>A character vector of selection statistics. Multiple criteria can be supplied. Only StARS can be used to automatically select an optimal index for the lambda path. See details for additional statistics.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>thresh</code></td>
<td>
<p>threshold (referred to as scalar <code class="reqn">\beta</code> in StARS publication) for selection criterion. Only implemented for StARS. <code>thresh=0.1</code> is recommended.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>subsample.ratio</code></td>
<td>
<p>determine the size of the subsamples (referred to as <code class="reqn">b(n)/n</code>). Default is 10*sqrt(n)/n for n &gt; 144 or 0.8 otherwise. Should be strictly less than 1.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>rep.num</code></td>
<td>
<p>number of random subsamples <code class="reqn">N</code> to take for graph re-estimation. Default is <code class="reqn">N=20</code>, but more is recommended for non-StARS criteria or if using edge frequencies as confidence scores.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>seed</code></td>
<td>
<p>A numeric seed to force predictable subsampling. Default is NULL. Use for testing purposes only.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>lb.stars</code></td>
<td>
<p>Should the lower bound be computed after the first <code class="reqn">N=2</code> subsamples (should result in considerable speedup and only implemented if stars is selected). If this option is selected, other summary metrics will only be applied to the smaller lambda path.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>ub.stars</code></td>
<td>
<p>Should the upper bound be computed after the first <code class="reqn">N=2</code> subsamples (should result in considerable speedup and only implemented if stars is selected). If this option is selected, other summary metrics will only be applied to the smaller lambda path. This option is ignored if the lb.stars flag is FALSE.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>ncores</code></td>
<td>
<p>number of cores to use for subsampling. See <code>batch.pulsar</code> for more parallelization options.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>refit</code></td>
<td>
<p>Boolean flag to refit on the full dataset after pulsar is run. (see also <code>refit</code>)</p>
</td>
</tr>
</table>
<h3>Details</h3>

<p>The options for <code>criterion</code> statistics are:
</p>

<ul>
<li>
<p> stars (Stability approach to regularization selection)
</p>
</li>
<li>
<p> gcd   (Graphet correlation distance, requires the <span class="pkg">orca</span> package) see <code>gcvec</code>
</p>
</li>
<li>
<p> diss  (Node-node dissimilarity) see <code>graph.diss</code>
</p>
</li>
<li>
<p> estrada (estrada class) see <code>estrada.class</code>
</p>
</li>
<li>
<p> nc  (natural connectivity) see <code>natural.connectivity</code>
</p>
</li>
<li>
<p> sufficiency (Tandon &amp; Ravikumar's sufficiency statistic)
</p>
</li>
</ul>
<h3>Value</h3>

<p>an S3 object of class <code>pulsar</code> with a named member for each stability metric run. Within each of these are:
</p>

<ul>
<li>
<p> summary: the summary statistic over <code>rep.num</code> graphs at each value of lambda
</p>
</li>
<li>
<p> criterion: the stability criterion used
</p>
</li>
<li>
<p> merge: the raw statistic over the <code>rep.num</code> graphs, prior to summarization
</p>
</li>
<li>
<p> opt.ind: index (along the path) of optimal lambda selected by the criterion at the desired threshold. Will return <code class="reqn">0</code> if no optimum is found or <code>NULL</code> if selection for the criterion is not implemented.
</p>
</li>
</ul>
<p>If <code>stars</code> is included as a criterion then additional arguments include
</p>

<ul>
<li>
<p> lb.index: the lambda index of the lower bound at <code class="reqn">N=2</code> samples if <code>lb.stars</code> flag is set to TRUE
</p>
</li>
<li>
<p> ub.index: the lambda index of the upper bound at <code class="reqn">N=2</code> samples if <code>ub.stars</code> flag is set to TRUE
</p>
</li>
</ul>
<p>call: the original function call
</p>


<h3>References</h3>

<p>Müller, C. L., Bonneau, R., &amp; Kurtz, Z. (2016). Generalized Stability Approach for Regularized Graphical Models. arXiv. https://arxiv.org/abs/1605.07072
</p>
<p>Liu, H., Roeder, K., &amp; Wasserman, L. (2010). Stability approach to regularization selection (stars) for high dimensional graphical models. Proceedings of the Twenty-Third Annual Conference on Neural Information Processing Systems (NIPS).
</p>
<p>Zhao, T., Liu, H., Roeder, K., Lafferty, J., &amp; Wasserman, L. (2012). The huge Package for High-dimensional Undirected Graph Estimation in R. The Journal of Machine Learning Research, 13, 1059–1062.
</p>


<h3>See Also</h3>

<p><code>batch.pulsar</code> <code>refit</code>
</p>


<h3>Examples</h3>

<pre><code class="language-R">## Not run: 
## Generate the data with huge:
library(huge)
p &lt;- 40 ; n &lt;- 1200
dat   &lt;- huge.generator(n, p, "hub", verbose=FALSE, v=.1, u=.3)
lams  &lt;- getLamPath(getMaxCov(dat$data), .01, len=20)

## Run pulsar with huge
hugeargs &lt;- list(lambda=lams, verbose=FALSE)
out.p &lt;- pulsar(dat$data, fun=huge::huge, fargs=hugeargs,
                rep.num=20, criterion='stars')

## Run pulsar in bounded stars mode and include gcd metric:
out.b &lt;- pulsar(dat$data, fun=huge::huge, fargs=hugeargs,
                rep.num=20, criterion=c('stars', 'gcd'),
                lb.stars=TRUE, ub.stars=TRUE)
plot(out.b)

## End(Not run)
</code></pre>


</div>