<div class="container">

<table style="width: 100%;"><tr>
<td>gsd.dens</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>
A function for computing the probability density for the group
sequentially monitored test statistic.
</h2>

<h3>Description</h3>

<p>A function for computing the probability density for a sequentially monitored test. This
is the joint density, in the rejection region, of (X_K, K), where X_K is the observed
value of the test statistic upon efficacy boundary crossing, and K is the analysis
number at which the efficacy boundary was crossed.
</p>


<h3>Usage</h3>

<pre><code class="language-R">gsd.dens(x, frac = NULL, scale="Standard")
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>x</code></td>
<td>

<p>The main argument, <code>x</code>, is either a object of class “boundaries” or a
numeric vector. If it is of class “boundaries” then no other arguments are
required. If it is a numeric vector then the <code>frac</code> argument must be
specified. See below. In this case, <code>x</code> will be the observed values of the
statistic at the current and all prior analyses, either on the standard normal scale
(the default) or on the “Brownian” scale. For “Brownian” scale, set
argument <code>scale</code> to “Brownian”.
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>frac</code></td>
<td>

<p>Required only when the main argument, <code>x</code>, is a numeric vector, and must be a
vector of the same length. In this case, <code>frac</code> will be the information at the
current and all prior interim analyses.
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>scale</code></td>
<td>

<p>Required only when the main argument, <code>x</code>, is a numeric vector. A switch
indicating whether the elements of the numeric vector, <code>x</code>, are specified on the
standard normal scale, <code>x</code>=“Standard”, or on the Brownian scale,
<code>x</code>=“Brownian”.
</p>
</td>
</tr>
</table>
<h3>Value</h3>

<p>A list with elements <code>x</code>, <code>dF</code>, <code>x1c</code>, and
<code>dF1c</code>:
</p>
<table>
<tr style="vertical-align: top;">
<td><code>x</code></td>
<td>

<p>Node points used in Gaussian quadrature. See examples below.
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>dF</code></td>
<td>

<p>Probability mass at each node point. See examples below.
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>x1c</code></td>
<td>

<p>Node points in the continuation region at the first analysis.
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>dF1c</code></td>
<td>

<p>Probability mass at each node point in the continuation region
at the first analysis.
</p>
</td>
</tr>
</table>
<h3>Note</h3>

<p>Also used in computation of Rao-Blackwell-ized bias adjusted point
estimate for statistic observed to cross the efficacy boundary.
</p>


<h3>Author(s)</h3>

<p>Grant Izmirlian &lt;izmirlig@mail.nih.gov&gt;
</p>


<h3>References</h3>

<p>Emerson, S. S. (1993). Computation of the uniform minimum variance unibiased estimator of
a normal mean following a group sequential trialdiscrete sequential boundaries for
clinical trials. Computers and Biomedical Research 26 68–73.
</p>
<p>Izmirlian, G. (2014). Estimation of the relative risk following group sequential procedure
based upon the weighted log-rank statistic. Statistics and its Interface 00 00–00
</p>


<h3>See Also</h3>

<p><code>EX1gXK</code>
</p>


<h3>Examples</h3>

<pre><code class="language-R">  # Information fraction
  frac &lt;- c(0.15, 0.37, 0.64, 0.76)

  # Efficacy Boundary 
  gsb &lt;- GrpSeqBnds(frac=frac, EfficacyBoundary=LanDemets(spending=ObrienFleming, alpha=0.05))

  # To compute the p-value under the stagewise ordering, for an observed
  #  value of the monitoring statistic 2.1, crossing the efficacy
  #  boundary at the 4th analysis, we do the following

  be &lt;- gsb$table[,"b.e"] 
  be[4] &lt;- 2.1

  sum(gsd.dens(be, frac, scale="Standard")$dF)

</code></pre>


</div>