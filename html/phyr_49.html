<div class="container">

<table style="width: 100%;"><tr>
<td>psv</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>Phylogenetic Species Diversity Metrics</h2>

<h3>Description</h3>

<p>Calculate the bounded phylogenetic biodiversity metrics:
phylogenetic species variability, richness, evenness and clustering for one or multiple communities.
</p>


<h3>Usage</h3>

<pre><code class="language-R">psv(
  comm,
  tree,
  compute.var = TRUE,
  scale.vcv = TRUE,
  prune.tree = FALSE,
  cpp = TRUE
)

psr(
  comm,
  tree,
  compute.var = TRUE,
  scale.vcv = TRUE,
  prune.tree = FALSE,
  cpp = TRUE
)

pse(comm, tree, scale.vcv = TRUE, prune.tree = FALSE, cpp = TRUE)

psc(comm, tree, scale.vcv = TRUE, prune.tree = FALSE)

psv.spp(comm, tree, scale.vcv = TRUE, prune.tree = FALSE, cpp = TRUE)

psd(
  comm,
  tree,
  compute.var = TRUE,
  scale.vcv = TRUE,
  prune.tree = FALSE,
  cpp = TRUE
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>comm</code></td>
<td>
<p>Community data matrix, site as rows and species as columns, site names as row names.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>tree</code></td>
<td>
<p>A phylo tree object with class "phylo" or a phylogenetic covariance matrix.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>compute.var</code></td>
<td>
<p>Logical, default is TRUE, computes the expected variances
for PSV and PSR for each community.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>scale.vcv</code></td>
<td>
<p>Logical, default is TRUE, scale the phylogenetic covariance
matrix to bound the metric between 0 and 1 (i.e. correlations).</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>prune.tree</code></td>
<td>
<p>Logical, default is FALSE, prune the phylogeny before converting
to var-cov matrix? Pruning and then converting VS converting then subsetting may
have different var-cov matrix resulted.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>cpp</code></td>
<td>
<p>Logical, default is TRUE, whether to use cpp for internal calculations.</p>
</td>
</tr>
</table>
<h3>Details</h3>

<p><em>Phylogenetic species variability (PSV)</em> quantifies how
phylogenetic relatedness decreases the variance of a hypothetical
unselected/neutral trait shared by all species in a community.
The expected value of PSV is statistically independent of species richness,
is one when all species in a community are unrelated (i.e., a star phylogeny)
and approaches zero as species become more related. PSV is directly related
to mean phylogenetic distance, except except calculated on a scaled phylogenetic
covariance matrix. The expected variance around PSV for any community of a particular
species richness can be approximated. To address how individual species
contribute to the mean PSV of a data set, the function <code>psv.spp</code> gives
signed proportions of the total deviation from the mean PSV that occurs when
all species are removed from the data set one at a time. The absolute values
of these “species effects” tend to positively correlate with species prevalence.
</p>


<h3>Value</h3>

<p>Returns a dataframe of the respective phylogenetic species diversity metric values
</p>


<h3>Note</h3>

<p>These metrics are bounded either between zero and one (PSV, PSE, PSC)
or zero and species richness (PSR); but the metrics asymptotically approach
zero as relatedness increases. Zero can be assigned to communities with less
than two species, but conclusions drawn from assigning communities zero values
need be carefully explored for any data set. The data sets need not be
species-community data sets but may be any community data set with an associated phylogeny.
</p>


<h3>Author(s)</h3>

<p>Matthew Helmus <a href="mailto:mrhelmus@gmail.com">mrhelmus@gmail.com</a>
</p>


<h3>References</h3>

<p>Helmus M.R., Bland T.J., Williams C.K. &amp; Ives A.R. 2007.
Phylogenetic measures of biodiversity. American Naturalist, 169, E68-E83
</p>


<h3>Examples</h3>

<pre><code class="language-R">psv(comm = comm_a, tree = phylotree) 
</code></pre>


</div>