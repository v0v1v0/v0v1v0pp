<div class="container">

<table style="width: 100%;"><tr>
<td>inbr</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>Extract inbreeding coefficients from a kinship matrix</h2>

<h3>Description</h3>

<p>The kinship matrix contains transformed inbreeding coefficients along the diagonal.
This function extracts the vector of inbreeding values from the input kinship matrix, by transforming the diagonal using the formula <code>2 * x - 1</code>.
</p>


<h3>Usage</h3>

<pre><code class="language-R">inbr(kinship)
</code></pre>


<h3>Arguments</h3>

<table><tr style="vertical-align: top;">
<td><code>kinship</code></td>
<td>
<p>The <code>n</code>-by-<code>n</code> kinship matrix.</p>
</td>
</tr></table>
<h3>Value</h3>

<p>The length-<code>n</code> vector of inbreeding coefficient for each individual.
</p>


<h3>See Also</h3>

<p><code>inbr_diag()</code> to replace kinship diagonal with inbreeding values (better for plots)
</p>


<h3>Examples</h3>

<pre><code class="language-R">#########
# illustrate the main transformation on a 2x2 kinship matrix:
# same inbreeding values for both individuals
inbr &lt;- 0.2
# corresponding self kinship (diagonal values) for both individuals
kinship_self &lt;- (1 + inbr)/2
# actual kinship matrix (zero kinship between individuals)
kinship &lt;- matrix(c(kinship_self, 0, 0, kinship_self), nrow=2)
# expected output of inbr (extracts inbreeding coefficients)
inbr_exp &lt;- c(inbr, inbr)
# actual output from this function
inbr_obs &lt;- inbr(kinship)
# verify that they match (up to machine precision)
stopifnot( all( abs(inbr_obs - inbr_exp) &lt; .Machine$double.eps ) )

#########
# Construct toy data
X &lt;- matrix(c(0,1,2,1,0,1,1,0,2), nrow=3, byrow=TRUE) # genotype matrix
subpops &lt;- c(1,1,2) # subpopulation assignments for individuals

# NOTE: for BED-formatted input, use BEDMatrix!
# "file" is path to BED file (excluding .bed extension)
## library(BEDMatrix)
## X &lt;- BEDMatrix(file) # load genotype matrix object

# estimate the kinship matrix from the genotypes "X"!
kinship &lt;- popkin(X, subpops) # calculate kinship from X and optional subpop labels

# extract inbreeding coefficients from Kinship
inbr &lt;- inbr(kinship)

</code></pre>


</div>