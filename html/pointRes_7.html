<div class="container">

<table style="width: 100%;"><tr>
<td>pointer.zchron</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>Calculate pointer years using z-transformation of a site chronology</h2>

<h3>Description</h3>

<p>The function calculates pointer years on a <code>data.frame</code> of tree-ring series using a z-transformation of the site chronology (by default based on a biweight robust mean). The method provides the number of standard deviations that the chronology deviates in individual years. To identify pointer years, one absolute threshold on the number of standard deviations can be set. Optionally, a t-test can be applied to test whether the z-transformed chronology significantly exceeds the selected threshold. The function is intended to use on flexibly detrended data, e.g., with a cubic-smoothing spline with a 50% frequency cut-off at 15 years (cf. Jetschke et al. 2019).
</p>


<h3>Usage</h3>

<pre><code class="language-R">pointer.zchron(data, period = NULL, bi.weight = TRUE,
               z.thresh = 1, t.Test = FALSE, make.plot = FALSE)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>data</code></td>
<td>
<p>a <code>data.frame</code> with detrended tree-ring series as columns and years as rows (e.g., output of <code>detrend</code> of package dplR).</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>period</code></td>
<td>
<p>a <code>vector</code> specifying the start and end year of the analysis. Defaults to the full period covered by the data.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>bi.weight</code></td>
<td>
<p>a <code>logical</code> flag specifying whether a Tukey's biweight robust mean site chronology should be calculated. Defaults to TRUE.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>z.thresh</code></td>
<td>
<p>a <code>numeric</code> specifying the threshold for identification of pointer years. Defaults to 1.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>t.Test</code></td>
<td>
<p>a <code>logical</code> flag specifying whether a t-test should be performed. Defaults to FALSE.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>make.plot</code></td>
<td>
<p>a <code>logical</code> specifying whether a bar plot indicating pointer years should be created. Defaults to FALSE.</p>
</td>
</tr>
</table>
<h3>Details</h3>

<p>The function develops a site chronology, which is z-transformed over its entire length, thereby providing the number of standard deviations that the chronology deviates in individual years. In developing the site chronology, a normal or biweight robust mean can be used. A threshold <code>z.thresh</code> on the minimum number of standard deviations can be set (cf. Cropper 1979) to define the years to be considered as pointer years. 
Optionally, a t-test may be performed to test whether the z-transformed chronology significantly differs from the selected threshold value in a particular year. Therefore, individual tree-ring series are z-transformed as well and compared to the threshold value <code>z.thresh</code>. In case a biweight robust mean is used in building the site chronology, the t-test is based on the biweight robust estimate of the standard deviation. In all t-tests a significance level of 0.05 is used.
</p>


<h3>Value</h3>

<p>The function returns a <code>list</code> containing the following components:
</p>
<table>
<tr style="vertical-align: top;">
<td><code>TRIsite</code></td>
<td>
<p>a <code>data.frame</code> with the calculated site chronology and corresponding sample depth (output of <code>chron</code> of package dplR)</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>out</code></td>
<td>
<p>a <code>data.frame</code> containing the following columns: <code>year</code> - time stamp, <code>nb.series</code> - number of series considered, <code>nature</code> - number indicating whether the year is a positive (1), negative (-1) or no pointer year (0), and <code>AVGztrans</code> - z-transformed site chronology</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>spec.param</code></td>
<td>
<p>a <code>data.frame</code> specifying the arguments used in the calculation</p>
</td>
</tr>
</table>
<h3>Author(s)</h3>

<p>Marieke van der Maaten-Theunissen, Ernst van der Maaten and Gottfried Jetschke.
</p>


<h3>References</h3>

<p>Cropper, J.P. (1979) Tree-ring skeleton plotting by computer. <em>Tree-Ring Bulletin</em> 39: 47-59.
</p>
<p>Jetschke, G., van der Maaten, E. and van der Maaten-Theunissen, M. (2019) Towards the extremes: A critical analysis of pointer year detection methods. <em>Dendrochronologia</em> 53: 55-62.
</p>


<h3>Examples</h3>

<pre><code class="language-R">## Calculate pointer years on detrended tree-ring series
data(s033)
detr_s033 &lt;- detrend(s033, method = "Spline", nyrs = 15)
pz1 &lt;- pointer.zchron(detr_s033)
head(pz1$out)

## Calculate pointer years with user-defined arguments
data(s033)
detr_s033 &lt;- detrend(s033, method = "Spline", nyrs = 15)
pz2 &lt;- pointer.zchron(detr_s033, period = c(1950,2010), z.thresh = 1.28,
                      make.plot = TRUE)
head(pz2$out)

</code></pre>


</div>