<div class="container">

<table style="width: 100%;"><tr>
<td>write.ancestral</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>Export and convenience functions for  ancestral reconstructions</h2>

<h3>Description</h3>

<p><code>write.ancestral</code> allows to export ancestral reconstructions. It writes
out the tree, a tab delimited text file with the probabilities and the
alignment. <code>ancestral</code> generates an object of class ancestral.
</p>


<h3>Usage</h3>

<pre><code class="language-R">write.ancestral(x, file = "ancestral")

as.ancestral(tree, align, prob)

## S3 method for class 'ancestral'
print(x, ...)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>x</code></td>
<td>
<p>an object of class ancestral.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>file</code></td>
<td>
<p>a file name. File endings are added.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>tree</code></td>
<td>
<p>an object of class phylo.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>align</code></td>
<td>
<p>an object of class phyDat.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>prob</code></td>
<td>
<p>an data.frame containing a matrix of posterior probabilities for
each state and site.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>...</code></td>
<td>
<p>Further arguments passed to or from other methods.</p>
</td>
</tr>
</table>
<h3>Details</h3>

<p>This allows also to read in reconstruction  made by iqtree to use the
plotting capabilities of R.
</p>


<h3>Value</h3>

<p><code>write.ancestral</code>  returns the input x invisibly.
</p>


<h3>See Also</h3>

<p><code>ancestral.pml</code>, <code>plotAnc</code>
</p>


<h3>Examples</h3>

<pre><code class="language-R">data(Laurasiatherian)
fit &lt;- pml_bb(Laurasiatherian[,1:100], "JC", rearrangement = "none")
anc_ml &lt;- anc_pml(fit)
write.ancestral(anc_ml)
# Can be also results from iqtree
align &lt;- read.phyDat("ancestral_align.fasta", format="fasta")
tree &lt;- read.tree("ancestral_tree.nwk")
df &lt;- read.table("ancestral.state", header=TRUE)
anc_ml_disc &lt;- as.ancestral(tree, align, df)
plotAnc(anc_ml_disc, 20)
unlink(c("ancestral_align.fasta", "ancestral_tree.nwk", "ancestral.state"))
</code></pre>


</div>