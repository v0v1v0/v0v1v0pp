<div class="container">

<table style="width: 100%;"><tr>
<td>expsampleN.TOST</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>
Sample size based on expected power
</h2>

<h3>Description</h3>

<p>Estimates the sample size based on the expected power for a variety of study 
designs used in bioequivalence studies. See known.designs for the study 
designs covered.
</p>


<h3>Usage</h3>

<pre><code class="language-R">expsampleN.TOST(alpha = 0.05, targetpower = 0.8, logscale=TRUE, theta0, 
                theta1, theta2, CV, design = "2x2", robust = FALSE, 
                prior.type = c("CV", "theta0", "both"), prior.parm = list(),
                method = c("exact", "approx"), print = TRUE, details)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>alpha</code></td>
<td>

<p>Significance level (one-sided). Commonly set to 0.05.
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>targetpower</code></td>
<td>

<p>Power to achieve at least. Must be &gt;0 and &lt;1.
Typical values are 0.8 or 0.9.
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>logscale</code></td>
<td>

<p>Should the data used on log-transformed or on original scale? <code>TRUE</code> (default) or <code>FALSE</code>.
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>theta0</code></td>
<td>

<p>Assumed ‘true’ (or ‘observed’ in case of <code>prior.type != "CV"</code>) bioequivalence 
ratio or difference.<br>
In case of <code>logscale=TRUE</code> it must be given as ratio T/R.<br>
If <code>logscale=FALSE</code>, the difference in means. In this case, the difference may be expressed in two ways: relative to the same (underlying) reference mean, i.e. as (T-R)/R = T/R - 1; or as difference in means T-R. Note that in the former case the units of <code>CV</code>, <code>theta1</code> and <code>theta2</code> need also be given relative to the reference mean (specified as ratio).<br>
Defaults to 0.95 if <code>logscale=TRUE</code> or to 0.05 if <code>logscale=FALSE</code>
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>theta1</code></td>
<td>

<p>Lower (bio-)equivalence limit.<br>
In case of <code>logscale=TRUE</code> it is given as ratio.<br>
If <code>logscale=FALSE</code>, the limit may be expressed in two ways:
difference of means relative to the same (underlying) reference mean or in units of the difference of means.
Note that in the former case the units of <code>CV</code>, <code>theta0</code> and <code>theta2</code> need also be given relative to the reference mean (specified as ratio).<br>
Defaults to 0.8 if <code>logscale=TRUE</code> or to -0.2 if <code>logscale=FALSE</code>.
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>theta2</code></td>
<td>

<p>Upper (bio-)equivalence limit.<br>
In case of <code>logscale=TRUE</code> it is given as ratio.
If <code>logscale=FALSE</code>, the limit may be expressed in two ways:
difference of means relative to the same (underlying) reference mean or in units of the difference of means.
Note that in the former case the units of <code>CV</code>, <code>theta0</code> and <code>theta1</code> need also be given relative to the reference mean (specified as ratio).<br>
If not given, <code>theta2</code> will be calculated as <code>1/theta1</code> if <code>logscale=TRUE</code> or as <code>-theta1</code> if <code>logscale=FALSE</code>.
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>CV</code></td>
<td>

<p>In case of <code>logscale=TRUE</code> the (geometric) coefficient of variation given as ratio.<br>
If <code>logscale=FALSE</code> the argument refers to (residual) standard deviation of the response. In this case, standard deviation may be expressed two ways: relative to a reference mean (specified as ratio sigma/muR), i.e. again as a coefficient of variation; or untransformed, i.e. as standard deviation of the response. Note that in the former case the units of <code>theta0</code>, <code>theta1</code> and <code>theta2</code> need also be given relative to the reference mean (specified as ratio).<br></p>
<p>If <code>prior.type="CV"</code> may be given as vector: The CVs are then pooled (as a 
weighted mean with their degrees of freedoms as weights).<br></p>
<p>In case of cross-over studies this is the within-subject CV, in case of a parallel-group design the CV of the total variability.
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>design</code></td>
<td>

<p>Character string describing the study design.<br>
See known.designs for designs covered in this package.
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>robust</code></td>
<td>

<p>Defaults to FALSE. With that value the usual degrees of freedom will be used.<br>
Set to <code>TRUE</code> will use the degrees of freedom according to the ‘robust’ evaluation
(aka Senn’s basic estimator). These df are calculated as <code>n-seq</code>.<br>
See <code>known.designs()$df2</code> for designs covered in this package.
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>prior.type</code></td>
<td>

<p>Specifies which parameter uncertainty should be accounted for. In case of 
<code>prior.type = "CV"</code> (the default), only the uncertainty with respect to the
CV will be considered (<em>i.e.</em>, the given treatment effect is assumed to be fix).
In case of <code>prior.type = "theta0" </code> only uncertainty with respect to the
treatment ratio/difference will be accounted for (<em>i.e.</em>, the given CV is assumed
to be fix). In case of  <code>prior.type = "both"</code> the power value will be
unconditional with respect to both the <code>CV</code> and <code>theta0</code>.
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>prior.parm</code></td>
<td>

<p>A list of parameters expressing the prior information about the 
variability and/or treatment effect. Possible components are <code>df</code>, 
<code>SEM</code>, <code>m</code>, <code>design</code>.<br>
For <code>prior.type = "CV"</code> the degrees of freedom from the prior trial are
required. This information can be provided by specifying the single component 
<code>df</code> or the combination consisting of <code>m</code> and <code>design</code>.<br>
For <code>prior.type = "theta0"</code> the standard error of the treatment difference 
from the prior trial is required. This information can be provided by specifying
the single component <code>SEM</code> or the combination consisting of 
<code>m</code> and <code>design</code>.<br>
For <code>prior.type = "both"</code> the degrees of freedom and the standard error of
the treatment difference are required. This information can be provided by 
specifying the combination consisting of <code>df</code> and <code>SEM</code> or via the 
combination <code>m</code> and <code>design</code>.<br>
See 'Details' for a technical description on each component.
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>method</code></td>
<td>

<p>Defaults to <code>method="exact"</code>.
In that case the expected power will be calculated as expected value of the
power with respect to the (prior) distribution of the respective parameter(s).<br>
Set to <code>method="approx"</code> the expected power according to the 
approximate formulas given in the book from Julious or in the Julious/Owen 
paper will be calculated (using non-central <em>t</em>); this only affects 
<code>prior.type = "CV"</code>.
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>print</code></td>
<td>

<p>If <code>TRUE</code> (default) the function prints its results. If <code>FALSE</code> only a data.frame with the results will be returned.
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>details</code></td>
<td>

<p>If <code>TRUE</code> the design characteristics and the steps during
sample size calculations will be shown.<br> 
If not specified, the default value is <code>FALSE</code> for <code>prior.type != "both"</code>
and <code>TRUE</code> otherwise.
</p>
</td>
</tr>
</table>
<h3>Details</h3>

<p>The sample size is calculated based on iterative evaluation of expected power.
The starting value of the sample size search is taken from a large sample 
approximation if <code>prior.type = "CV"</code>. Otherwise, an empirical start value is
obtained. Note that in case of <code>prior.type = "both"</code> the calculation may 
still take several seconds.
</p>
<p>Note also that the expected power is always bounded above by the so-called
probability of technical success (<abbr><span class="acronym">PTS</span></abbr>) which may be a value less than 1. 
Therefore, it may be possible that it is either not possible to calculate the 
required sample size at all or that the sample size gets very large 
if the given targetpower is less but close to the <abbr><span class="acronym">PTS</span></abbr>.<br><br>
The estimated sample size gives always the <em>total</em> number of subjects (not subject/sequence in crossovers or subjects/group in parallel designs – like in some other software packages).
</p>


<h3>Value</h3>

<p>A data.frame with the input values and the result of the sample size estimation.<br>
The <code>Sample size</code> column contains the total sample size in case of all
designs implemented.
</p>


<h3>Author(s)</h3>

<p>B. Lang, D. Labes
</p>


<h3>References</h3>

<p>Grieve AP. <em>Confidence Intervals and Sample Sizes.</em> Biometrics. 1991;47:1597–603. <a href="https://doi.org/10.2307/2532411">doi:10.2307/2532411</a>
</p>
<p>O’Hagan, Stevens, JW, Campell MJ. <em>Assurance in Clinical Trial Design.</em> Pharm Stat. 2005;4:187–201. <a href="https://doi.org/10.1002/pst.175">doi:10.1002/pst.175</a>
</p>
<p>Julious SA, Owen RJ. <em>Sample size calculations for clinical studies allowing for 
uncertainty in variance.</em> Pharm Stat. 2006;5:29–37. <a href="https://doi.org/10.1002/pst.197">doi:10.1002/pst.197</a>
</p>
<p>Julious SA. <em>Sample sizes for Clinical Trials.</em> Boca Raton: CRC Press / Chapman &amp; Hall; 2010.
</p>
<p>Bertsche A, Nehmitz G, Beyersmann J, Grieve AP. <em>The predictive distribution of the residual variability in
the linear-fixed effects model for clinical cross-over trials.</em> Biom J. 2016;58(4):797–809. <a href="https://doi.org/10.1002/bimj.201500245">doi:10.1002/bimj.201500245</a>
</p>
<p>Box GEP, Tiao GC. <em>Bayesian Inference in Statistical Analysis.</em> Boston: Addison-Wesley; 1992.
</p>
<p>Held L, Sabanes Bove D. <em>Applied Statistical Inference. Likelihood and Bayes.</em> Berlin, Heidelberg: Springer; 2014. <a href="https://doi.org/10.1007/978-3-642-37887-4">doi:10.1007/978-3-642-37887-4</a>
</p>
<p>Senn S. <em>Cross-over Trials in Clinical Research.</em> Chichester: John Wiley &amp; Sons; 2<sup>nd</sup> edition 2002.
</p>
<p>Zierhut ML, Bycott P, Gibbs MA, Smith BP, Vicini P. <em>Ignorance is not bliss: Statistical power is not probability of trial success.</em> Clin Pharmacol Ther. 2015;99:356–9. <a href="https://doi.org/10.1002/cpt.257">doi:10.1002/cpt.257</a>
</p>


<h3>See Also</h3>

<p><code>exppower.TOST, known.designs, sampleN.TOST</code>
</p>


<h3>Examples</h3>

<pre><code class="language-R"># Classical 2x2 cross-over, target power = 80%,
# BE limits 80 ... 125%, assumed true BE ratio = 95%,
# intra-subject CV=30% estimated from prior 2x2 trial 
# with m = 30 subjects
expsampleN.TOST(CV=0.3, prior.parm = list(m = 30, design = "2x2"))
# -&gt; gives n = 42 with achieved expected power 0.806262
# Compare this to the usual sample size with CV assumed known ('carved in stone')
sampleN.TOST(CV=0.3)
# -&gt; gives n = 40 subjects
# Compare this to the case where uncertainty is accounted for CV and theta0
# Not run due to timing policy of CRAN - may run several seconds

expsampleN.TOST(CV=0.3, prior.parm = list(m = 30, design = "2x2"), 
                prior.type = "both")
# -&gt; gives n = 72 subjects

# More than one CV with corresponding degrees of freedom 
# other settings as above in first example
CVs &lt;- c(0.25, 0.3)
dfs &lt;- c(22, 10)
expsampleN.TOST(CV=CVs, prior.parm = list(df = dfs))
# -&gt; gives a pooled CV=0.2664927 with df=32
# and a sample size n=34 with achieved expected power 0.812653 exact
# achieved expected power 0.815019 approximate acc. Julious
</code></pre>


</div>