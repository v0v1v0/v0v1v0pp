<div class="container">

<table style="width: 100%;"><tr>
<td>palaeorotate</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>Palaeorotate fossil occurrences</h2>

<h3>Description</h3>

<p>A function to estimate palaeocoordinates for fossil occurrence data
(i.e. reconstruct the geographic distribution of organisms'
remains at time of deposition). Each occurrence is assigned
palaeocoordinates based on its current geographic position and age
estimate.
</p>


<h3>Usage</h3>

<pre><code class="language-R">palaeorotate(
  occdf,
  lng = "lng",
  lat = "lat",
  age = "age",
  model = "MERDITH2021",
  method = "point",
  uncertainty = TRUE,
  round = 3
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>occdf</code></td>
<td>
<p><code>data.frame</code>. Fossil occurrences to be
palaeogeographically reconstructed. <code>occdf</code> should contain columns
with longitudinal and latitudinal coordinates, as well as age estimates.
The age of rotation should be supplied in millions of years before
present.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>lng</code></td>
<td>
<p><code>character</code>. The name of the column you wish to be treated
as longitude (defaults to "lng").</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>lat</code></td>
<td>
<p><code>character</code>. The name of the column you wish to be treated
as latitude (defaults to "lat").</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>age</code></td>
<td>
<p><code>character</code>. The name of the column you wish to be treated
as the age for rotation (defaults to "age").</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>model</code></td>
<td>
<p><code>character</code>. The name(s) of the Global Plate Model(s)
to be used to reconstruct palaeocoordinates. See details for available
models.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>method</code></td>
<td>
<p><code>character</code>. Method used to calculate palaeocoordinates
for fossil occurrences. Either "grid" to use reconstruction files, or
"point" (default) to use the GPlates API service. See details section for
specific details.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>uncertainty</code></td>
<td>
<p><code>logical</code>. Should the uncertainty in
palaeogeographic reconstructions be returned? If set to TRUE (default),
the palaeolatitudinal range and maximum geographic distance (in km)
between output palaeocoordinates are calculated. This argument is only
relevant if more than one Global Plate Model is specified in <code>model</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>round</code></td>
<td>
<p><code>numeric</code>. Numeric value indicating the number of decimal
places <code>lng</code>, <code>lat</code> and <code>age</code> should be rounded to. This functionality is
only relevant for the "point" <code>method</code>. Rounding can speed up
palaeorotation by reducing the number of unique coordinate pairs.
Defaults to a value of 3. If no rounding is desired, set this value to
<code>NULL</code>.</p>
</td>
</tr>
</table>
<h3>Details</h3>

<p>This function can estimate palaeocoordinates using two different
approaches (<code>method</code>):
</p>

<ul>
<li>
<p> Reconstruction files: The "grid" <code>method</code> uses reconstruction files from
Jones &amp; Domeier (2024) to spatiotemporally link present-day geographic
coordinates and age estimates with a discrete global grid rotated at one
million-year time steps throughout the Phanerozoic (540–0 Ma). Here,
resolution 3 (~119 km spacing) of the reconstruction files is used. All
files, and the process used to generate them, are available and documented
in Jones &amp; Domeier (2024). If fine-scale spatial analyses are being
conducted, use of the "point" <code>method</code> (see GPlates API below) may be
preferred (particularly if occurrences are close to plate boundaries). When
using the "grid" <code>method</code>, coordinates within the same grid cell will be
assigned equivalent palaeocoordinates due to spatial aggregation. However,
this approach enables efficient estimation of the past distribution of
fossil occurrences. Note: each reconstruction file is ~45 MB in size.
</p>
</li>
<li>
<p> GPlates API: The "point" <code>method</code> uses the <a href="https://gwsdoc.gplates.org">GPlates Web Service</a> to reconstruct palaeocoordinates for point
data. The use of this <code>method</code> is slower than the "grid" <code>method</code> if many
unique time intervals exist in your dataset. However, it provides
palaeocoordinates with higher precision.
</p>
</li>
</ul>
<p>Available models and timespan for each <code>method</code>:
</p>

<ul>
<li>
<p> "MERDITH2021" (Merdith et al., 2021)
</p>

<ul>
<li>
<p> 0–1000 Ma (point)
</p>
</li>
<li>
<p> 0–540 Ma (grid)
</p>
</li>
</ul>
</li>
<li>
<p> "TorsvikCocks2017" (Torsvik and Cocks, 2016)
</p>

<ul><li>
<p> 0–540 Ma (point/grid)
</p>
</li></ul>
</li>
<li>
<p> "PALEOMAP" (Scotese, 2016)
</p>

<ul>
<li>
<p> 0–1100 Ma (point)
</p>
</li>
<li>
<p> 0–540 Ma (grid)
</p>
</li>
</ul>
</li>
<li>
<p> "MATTHEWS2016_pmag_ref"  (Matthews et al., 2016)
</p>

<ul><li>
<p> 0–410 Ma (grid/point)
</p>
</li></ul>
</li>
<li>
<p> "GOLONKA" (Wright et al., 2013)
</p>

<ul><li>
<p> 0–540 Ma (grid/point)
</p>
</li></ul>
</li>
</ul>
<h3>Value</h3>

<p>A <code>data.frame</code> containing the original input occurrence
<code>data.frame</code> and the reconstructed coordinates (i.e. "p_lng", "p_lat"). The
"grid" <code>method</code> also returns the age of rotation ("rot_age") and the
reference coordinates rotated ("rot_lng" and "rot_lat"). If only one
model is requested, a column containing the rotation model used
("rot_model") is also appended. Otherwise, the name of each model is
appended to the name of each column containing palaeocoordinates (e.g.
"p_lng_GOLONKA"). If <code>uncertainty</code> is set to <code>TRUE</code>, the
palaeolatitudinal range ("range_p_lat") and the maximum geographic
distance ("max_dist") in km between palaeocoordinates will also be
returned (the latter calculated via <code>distGeo</code>).
</p>


<h3>References</h3>


<ul>
<li>
<p> Jones, L.A., Domeier, M. A Phanerozoic gridded dataset for palaeogeographic
reconstructions. Sci Data 11, 710 (2024). <a href="https://doi.org/10.1038/s41597-024-03468-w">doi:10.1038/s41597-024-03468-w</a>.
</p>
</li>
<li>
<p> Matthews, K.J., Maloney, K.T., Zahirovic, S., Williams, S.E., Seton, M.,
and Müller, R.D. (2016). Global plate boundary evolution and kinematics
since the late Paleozoic. Global and Planetary Change, 146, 226-250.
<a href="https://doi.org/10.1016/j.gloplacha.2016.10.002">doi:10.1016/j.gloplacha.2016.10.002</a>.
</p>
</li>
<li>
<p> Merdith, A., Williams, S.E., Collins, A.S., Tetley, M.G., Mulder, J.A.,
Blades, M.L., Young, A., Armistead, S.E., Cannon, J., Zahirovic, S.,
Müller. R.D. (2021). Extending full-plate tectonic models into deep time:
Linking the Neoproterozoic and the Phanerozoic. Earth-Science Reviews,
214(103477). <a href="https://doi.org/10.1016/j.earscirev.2020.103477">doi:10.1016/j.earscirev.2020.103477</a>.
</p>
</li>
<li>
<p> Scotese, C., &amp; Wright, N. M. (2018). PALEOMAP Paleodigital Elevation Models
(PaleoDEMs) for the Phanerozoic. <a href="https://www.earthbyte.org/paleodem-resource-scotese-and-wright-2018/">PALEOMAP Project</a>.
</p>
</li>
<li>
<p> Torsvik, T. H. &amp; Cocks, L. R. M. Earth History and Palaeogeography.
Cambridge University Press, 2016.
</p>
</li>
<li>
<p> Wright, N., Zahirovic, S., Müller, R. D., &amp; Seton, M. (2013). Towards
community-driven paleogeographic reconstructions: integrating open-access
paleogeographic and paleobiology data with plate tectonics. Biogeosciences,
10(3), 1529-1541. <a href="https://doi.org/10.5194/bg-10-1529-2013">doi:10.5194/bg-10-1529-2013</a>.
</p>
</li>
</ul>
<p>See <a href="https://gwsdoc.gplates.org/reconstruction">GPlates documentation</a>
for additional information and details.
</p>


<h3>Developer(s)</h3>

<p>Lewis A. Jones
</p>


<h3>Reviewer(s)</h3>

<p>Kilian Eichenseer, Lucas Buffan &amp; Will Gearty
</p>


<h3>Examples</h3>

<pre><code class="language-R">## Not run: 
#Generic example with a few occurrences
occdf &lt;- data.frame(lng = c(2, -103, -66),
                lat = c(46, 35, -7),
                age = c(88, 125, 200))

#Calculate palaeocoordinates using reconstruction files
ex1 &lt;- palaeorotate(occdf = occdf, method = "grid")

#Calculate palaeocoordinates using the GPlates API
ex2 &lt;- palaeorotate(occdf = occdf, method = "point")

#Calculate uncertainity in palaeocoordinates from models
ex3 &lt;- palaeorotate(occdf = occdf,
                    method = "grid",
                    model = c("MERDITH2021",
                              "GOLONKA",
                              "PALEOMAP"),
                    uncertainty = TRUE)

#Now with some real fossil occurrence data!

#Grab some data from the Paleobiology Database
data(tetrapods)

#Assign midpoint age of fossil occurrence data for reconstruction
tetrapods$age &lt;- (tetrapods$max_ma + tetrapods$min_ma)/2

#Rotate the data
ex3 &lt;- palaeorotate(occdf = tetrapods)

#Calculate uncertainity in palaeocoordinates from models
ex4 &lt;- palaeorotate(occdf = tetrapods,
                    model = c("MERDITH2021",
                              "GOLONKA",
                              "PALEOMAP"),
                    uncertainty = TRUE)

## End(Not run)
</code></pre>


</div>