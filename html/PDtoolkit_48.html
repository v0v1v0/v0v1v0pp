<div class="container">

<table style="width: 100%;"><tr>
<td>ush.test</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>Testing for U-shape relation</h2>

<h3>Description</h3>

<p><code>ush.test</code> performs U-shape testing between the target and analyzed risk factor.
Testing is based on B-splines basis functions and change of the sign of the estimated coefficients.
</p>


<h3>Usage</h3>

<pre><code class="language-R">ush.test(
  x,
  y,
  p.value = 0.05,
  min.pct.obs = 0.05,
  min.pct.def = 0.01,
  g = 20,
  sc = c(NA, Inf, -Inf, NaN)
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>x</code></td>
<td>
<p>Numeric vector to be tested for U-shape.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>y</code></td>
<td>
<p>Numeric target vector (binary).</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>p.value</code></td>
<td>
<p>Threshold for p-value of statistical significance of the estimated coefficients
next to basis functions. Default is 0.05.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>min.pct.obs</code></td>
<td>
<p>Minimum percentage of observations per bin. Default is 0.05.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>min.pct.def</code></td>
<td>
<p>Minimum <code>y</code> average rate. Default is 0.01 or minimum 1 bad case for y 0/1.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>g</code></td>
<td>
<p>Number of knots used for testing the U-shape (integer). It should take values between 2 and 50 with
default value of 20.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>sc</code></td>
<td>
<p>Numeric vector with special case elements. Default values are <code>c(NA, NaN, Inf, -Inf)</code>.
Recommendation is to keep the default values always and add new ones if needed. Otherwise, if these values exist
in <code>x</code> and are not defined in the <code>sc</code> vector, function can report the error.</p>
</td>
</tr>
</table>
<h3>Value</h3>

<p>The command <code>ush.test</code> returns list of three objects. The first object (<code>candidates</code>)
is the data frame with summary of tested candidate knots. Using the reported results of this data frame
user can conclude if U-shape exists at all (column where <code>direction</code> is equal to <code>TRUE</code>) and
check its statistical significance (column <code>significance</code> - <code>TRUE, FALSE</code>).
The second object (<code>optimal</code>) reports optimal knot value (if exists).
It is selected as the knot with minimum deviance among all candidates for
which <code>direction</code> and <code>significance</code> are equal to <code>TRUE</code>.
The last, third, object (<code>basis.functions</code>) exports basis functions for optimal knot. Basis functions
will be exported only in case optimal knot is found. <br>
If optimal knot is not found, then users are encouraged to inspect closer the results of candidate testing.
</p>


<h3>Examples</h3>

<pre><code class="language-R">data(gcd)
res &lt;- ush.test(x = gcd$amount, y = gcd$qual)
res 
#optimal knot is not found so candidate can be defined as follows:
direction.t &lt;- res$candidate[res$candidate$direction, ]
optimal.k &lt;- direction.t$cp[direction.t$deviance%in%min(direction.t$deviance)]
optimal.k
</code></pre>


</div>