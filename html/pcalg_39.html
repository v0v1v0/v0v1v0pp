<div class="container">

<table style="width: 100%;"><tr>
<td>condIndFisherZ</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>Test Conditional Independence of Gaussians via Fisher's Z</h2>

<h3>Description</h3>

<p>Using Fisher's z-transformation of the partial correlation,
test for zero partial correlation of sets of normally / Gaussian
distributed random variables.
</p>
<p>The <code>gaussCItest()</code> function, using <code>zStat()</code> to test for
(conditional) independence between gaussian random variables, with an
interface that can easily be used in <code>skeleton</code>,
<code>pc</code> and <code>fci</code>.
</p>


<h3>Usage</h3>

<pre><code class="language-R">condIndFisherZ(x, y, S, C, n, cutoff, verbose= )
zStat         (x, y, S, C, n)
gaussCItest   (x, y, S, suffStat)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>x,y,S</code></td>
<td>
<p>(integer) position of variable <code class="reqn">X</code>, <code class="reqn">Y</code> and set
of variables <code class="reqn">S</code>, respectively, in the adjacency matrix. It is
tested, whether <code>X</code> and <code>Y</code> are conditionally 
independent given the subset <code>S</code> of the remaining nodes.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>C</code></td>
<td>
<p>Correlation matrix of nodes</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>n</code></td>
<td>
<p>Integer specifying the number of observations
(“samples”) used to estimate the correlation matrix <code>C</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>cutoff</code></td>
<td>
<p>Numeric cutoff for significance level of individual partial
correlation tests.  Must be set to <code>qnorm(1 - alpha/2)</code>
for a test significance level of <code>alpha</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>verbose</code></td>
<td>
<p>Logical indicating whether some intermediate output should be
shown; currently not used.</p>
</td>
</tr>
</table>
<table><tr style="vertical-align: top;">
<td><code>suffStat</code></td>
<td>
<p>A <code>list</code> with two elements, <code>"C"</code>
and <code>"n"</code>, corresponding to the above arguments with the same name.</p>
</td>
</tr></table>
<h3>Details</h3>

<p>For gaussian random variables and after performing Fisher's
z-transformation of the partial correlation, the test statistic
<code>zStat()</code> is (asymptotically for large enough <code>n</code>) standard
normally distributed.
</p>
<p>Partial correlation is tested in a two-sided hypothesis test, i.e.,
basically, <code>condIndFisherZ(*) == abs(zStat(*)) &gt; qnorm(1 - alpha/2)</code>.
In a multivariate normal distribution, zero partial correlation is
equivalent to conditional independence.
</p>


<h3>Value</h3>

<p><code>zStat()</code> gives a number
</p>
<p style="text-align: center;"><code class="reqn">Z = \sqrt{n - \left|S\right| - 3} \cdot \log((1+r)/(1-r))/2</code>
</p>

<p>which is asymptotically normally distributed under the null hypothesis
of correlation 0.
</p>
<p><code>condIndFisherZ()</code> returns a <code>logical</code>
<code class="reqn">L</code> indicating whether the <em>“partial correlation of x
and y given S is zero”</em> could not be rejected on the given
significance level.  More intuitively and for multivariate normal
data, this means:  If <code>TRUE</code> then it seems plausible, that x and
y are conditionally independent given S.  If <code>FALSE</code> then there
was strong evidence found against this conditional independence
statement.
</p>
<p><code>gaussCItest()</code> returns the p-value of the test.
</p>


<h3>Author(s)</h3>

<p>Markus Kalisch (<a href="mailto:kalisch@stat.math.ethz.ch">kalisch@stat.math.ethz.ch</a>) and Martin Maechler
</p>


<h3>References</h3>

<p>M. Kalisch and P. Buehlmann (2007).
Estimating high-dimensional directed acyclic graphs with the PC-algorithm.
<em>JMLR</em> <b>8</b> 613-636.
</p>


<h3>See Also</h3>

<p><code>pcorOrder</code> for computing a partial correlation
given the correlation matrix in a recursive way.
</p>
<p><code>dsepTest</code>, <code>disCItest</code> and
<code>binCItest</code> for similar functions for a d-separation
oracle, a conditional independence test for discrete variables and a
conditional independence test for binary variables, respectively.
</p>


<h3>Examples</h3>

<pre><code class="language-R">set.seed(42)
## Generate four independent normal random variables
n &lt;- 20
data &lt;- matrix(rnorm(n*4),n,4)
## Compute corresponding correlation matrix
corMatrix &lt;- cor(data)
## Test, whether variable 1 (col 1) and variable 2 (col 2) are
## independent given variable 3 (col 3) and variable 4 (col 4) on 0.05
## significance level
x &lt;- 1
y &lt;- 2
S &lt;- c(3,4)
n &lt;- 20
alpha &lt;- 0.05
cutoff &lt;- qnorm(1-alpha/2)
(b1 &lt;- condIndFisherZ(x,y,S,corMatrix,n,cutoff))
   # -&gt; 1 and 2 seem to be conditionally independent given 3,4

## Now an example with conditional dependence
data &lt;- matrix(rnorm(n*3),n,3)
data[,3] &lt;- 2*data[,1]
corMatrix &lt;- cor(data)
(b2 &lt;- condIndFisherZ(1,3,2,corMatrix,n,cutoff))
   # -&gt; 1 and 3 seem to be conditionally dependent given 2

## simulate another dep.case: x -&gt; y -&gt; z
set.seed(29)
x &lt;- rnorm(100)
y &lt;- 3*x + rnorm(100)
z &lt;- 2*y + rnorm(100)
dat &lt;- cbind(x,y,z)

## analyze data
suffStat &lt;- list(C = cor(dat), n = nrow(dat))
gaussCItest(1,3,NULL, suffStat) ## dependent [highly signif.]
gaussCItest(1,3,  2,  suffStat) ## independent | S
</code></pre>


</div>