<div class="container">

<table style="width: 100%;"><tr>
<td>cophylo</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>Creates a co-phylogenetic plot</h2>

<h3>Description</h3>

<p>Visualize co-phylogenetic trees by multiple methods.
</p>


<h3>Usage</h3>

<pre><code class="language-R">cophylo(tr1, tr2, assoc=NULL, rotate=TRUE, ...)
## S3 method for class 'cophylo'
plot(x, ...)
cotangleplot(tr1, tr2, type=c("cladogram","phylogram"),
   use.edge.length=TRUE, tangle=c("both","tree1","tree2"), ...)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>tr1</code></td>
<td>
<p>object of class <code>"phylo"</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>tr2</code></td>
<td>
<p>object of class <code>"phylo"</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>assoc</code></td>
<td>
<p>matrix containing the tip labels in <code>tr1</code> to match to the tip labels in <code>tr2</code>. Note that not all labels in either tree need to be included; and, furthermore, one label in <code>tr1</code> can be matched with more than one label in <code>tr2</code>, or vice versa.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>rotate</code></td>
<td>
<p>logical argument indicating whether nodes on both trees should be rotated to attempt to match in vertical position.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>x</code></td>
<td>
<p>in the case of <code>plot.cophylo</code>, an object of class <code>"cophylo"</code> to be plotted.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>type</code></td>
<td>
<p>for <code>cotangleplot</code>, the tree plotting style.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>use.edge.length</code></td>
<td>
<p>for <code>cotangleplot</code>, a logical value indicating whether or not to plot trees with edge lengths.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>tangle</code></td>
<td>
<p>for <code>cotangleplot</code>, whether to tangle the left tree, the right tree, or both.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>...</code></td>
<td>
<p>optional arguments to be passed to <code>tipRotate</code>, or, in the case of <code>plot.cophylo</code>, to the internally used tree plotting function, <code>phylogram</code>. <code>phylogram</code> takes similar arguments to <code>plotSimmap</code>, such as <code>fsize</code>, <code>ftype</code>, <code>lwd</code>, and <code>pts</code>, though not all options from <code>plotSimmap</code> and <code>plotTree</code> are available. If <code>fsize</code> is supplied as a vector, different size fonts for the left &amp; right facing trees may be used. In addition, the optional argument <code>scale.bar</code>, which should be a vector containing the lengths of the scale bars desired for the right &amp; left trees, will add scale bars to the plot when supplied to <code>plot.cophylo</code>. If either tree contains polytomies, the <code>cophylo</code> argument <code>rotate.multi</code> should be set to <code>TRUE</code>. If curved linking lines are desired, the <code>plot.cophylo</code> argument <code>link.type</code> should be set to <code>"curved"</code>. Other arguments for the <code>plot</code> method include <code>link.col</code>, <code>link.lty</code>, and <code>link.lwd</code>, which can be supplied as a scalar or a vector in which the order of the elements corresponds to the order of the associations in <code>assoc</code>. Finally, <code>edge.col</code>, a list consisting of two vectors (<code>left</code> and <code>right</code>) can be used to specify the edge colors of the two left &amp; right plotted trees. Note that the edge order is the same as in the <em>rotated</em> trees, assuming that a rotation has been performed on <code>x</code>.</p>
</td>
</tr>
</table>
<h3>Details</h3>

<p><code>cophylo</code> an object of class <code>"cophylo"</code> or, in the case of <code>plot.cophylo</code>, plots that object. The function can (optionally) first attempt to rotate the nodes of both trees to optimize vertical matching of tips.
</p>
<p>If no matrix of associations, <code>assoc</code>, is provided, then <code>cophylo</code> will look for exact matches of tip labels between trees.
</p>
<p><code>cotangleplot</code> creates a co-phylogenetic plot in which the edges of the matched trees are crossing and is designed to be used <em>only</em> on phylogenies with matching tip labels.
</p>


<h3>Value</h3>

<p>An object of class <code>"cophylo"</code> which includes the following components or a pair of plotted facing phylogenies with links between tips as specified in <code>assoc</code>.
</p>


<h3>Author(s)</h3>

<p>Liam Revell <a href="mailto:liam.revell@umb.edu">liam.revell@umb.edu</a></p>


<h3>References</h3>

<p>Revell, L. J. (2024) phytools 2.0: an updated R ecosystem for phylogenetic comparative methods (and other things). <em>PeerJ</em>, <b>12</b>, e16505.
</p>


<h3>See Also</h3>

<p><code>cophyloplot</code>, <code>plotSimmap</code>
</p>


<h3>Examples</h3>

<pre><code class="language-R">## load data from Lopez-Vaamonde et al. (2001)
data(wasp.trees)
data(wasp.data)
## create co-phylogenetic object
wasp.cophylo&lt;-cophylo(wasp.trees[[1]],wasp.trees[[2]],
    assoc=wasp.data)
## plot co-phylogenies
plot(wasp.cophylo,link.type="curved",link.lwd=4,
     link.lty="solid",link.col=make.transparent("red",
     0.25))
par(mar=c(5.1,4.1,4.1,2.1))
</code></pre>


</div>