<div class="container">

<table style="width: 100%;"><tr>
<td>splitsNetwork</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>Phylogenetic Network</h2>

<h3>Description</h3>

<p><code>splitsNetwork</code> estimates weights for a splits graph from a distance
matrix.
</p>


<h3>Usage</h3>

<pre><code class="language-R">splitsNetwork(dm, splits = NULL, gamma = 0.1, lambda = 1e-06,
  weight = NULL)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>dm</code></td>
<td>
<p>A distance matrix.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>splits</code></td>
<td>
<p>a splits object, containing all splits to consider, otherwise
all possible splits are used</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>gamma</code></td>
<td>
<p>penalty value for the L1 constraint.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>lambda</code></td>
<td>
<p>penalty value for the L2 constraint.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>weight</code></td>
<td>
<p>a vector of weights.</p>
</td>
</tr>
</table>
<h3>Details</h3>

<p><code>splitsNetwork</code> fits non-negative least-squares phylogenetic networks
using L1 (LASSO), L2(ridge regression) constraints.  The function minimizes
the penalized least squares
</p>
<p style="text-align: center;"><code class="reqn">\beta = min \sum(dm - X\beta)^2 + \lambda \|\beta \|^2_2 </code>
</p>

<p>with respect to </p>
<p style="text-align: center;"><code class="reqn">\|\beta \|_1 &lt;= \gamma, \beta &gt;= 0</code>
</p>

<p>where <code class="reqn">X</code> is a design matrix constructed with <code>designSplits</code>.
External edges are fitted without L1 or L2 constraints.
</p>


<h3>Value</h3>

<p><code>splitsNetwork</code> returns a splits object with a matrix added.
The first column contains the indices of the splits, the second column an
unconstrained fit without penalty terms and the third column the constrained
fit.
</p>


<h3>Author(s)</h3>

<p>Klaus Schliep <a href="mailto:klaus.schliep@gmail.com">klaus.schliep@gmail.com</a>
</p>


<h3>References</h3>

<p>Efron, Hastie, Johnstone and Tibshirani (2004) Least Angle
Regression (with discussion) <em>Annals of Statistics</em> <b>32(2)</b>,
407â€“499
</p>
<p>K. P. Schliep (2009). Some Applications of statistical phylogenetics (PhD
Thesis)
</p>


<h3>See Also</h3>

<p><code>distanceHadamard</code>,
<code>designTree</code> <code>consensusNet</code>,
<code>plot.networx</code>
</p>


<h3>Examples</h3>

<pre><code class="language-R">
data(yeast)
dm &lt;- dist.ml(yeast)
fit &lt;- splitsNetwork(dm)
net &lt;- as.networx(fit)
plot(net)
write.nexus.splits(fit)

</code></pre>


</div>