<div class="container">

<table style="width: 100%;"><tr>
<td>psbcGL</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>
Function to Fit the Penalized Semiparametric Bayesian Cox Model with Group Lasso Prior
</h2>

<h3>Description</h3>

<p>Penalized semiparametric Bayesian Cox (PSBC) model with group lasso prior is implemented to analyze survival data with high-dimensional covariates.
</p>


<h3>Usage</h3>

<pre><code class="language-R">psbcGL(survObj, priorPara, initial, rw=FALSE, mcmcPara, num.reps, 
		thin, chain = 1, save = 1000)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>survObj</code></td>
<td>

<p>The list containing observed data from <code>n</code> subjects; 
<code>t</code>, <code>di</code>, <code>x</code>
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>priorPara</code></td>
<td>

<p>The list containing prior parameter values; 
<code>eta0</code>, <code>kappa0</code>, <code>c0</code>, <code>r</code>, <code>delta</code>,
<code>s</code>, <code>groupInd</code>
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>initial</code></td>
<td>

<p>The list containing the starting values of the parameters;
<code>beta.ini</code>,
<code>lambdaSq</code>, <code>sigmaSq</code>, <code>tauSq</code>, <code>h</code>
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>rw</code></td>
<td>

<p>When setting to "TRUE", the conventional random walk Metropolis Hastings algorithm is used. 
Otherwise, the mean and the variance of the proposal density is updated using the jumping rule described in Lee et al. (2011).
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>mcmcPara</code></td>
<td>

<p>The list containing the values of options for Metropolis-Hastings step for <code class="reqn">\beta</code>;
<code>numBeta</code>, <code>beta.prop.var</code>
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>num.reps</code></td>
<td>

<p>the number of iterations of the chain
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>thin</code></td>
<td>

<p>thinning
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>chain</code></td>
<td>

<p>the numeric name of chain in the case when running multiple chains.
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>save</code></td>
<td>

<p>frequency of storing the results in .Rdata file. 
For example, by setting "save = 1000", the algorithm saves the results every 1000 iterations.
</p>
</td>
</tr>
</table>
<h3>Details</h3>


<table>
<tr>
<td style="text-align: left;">
<code>t</code> </td>
<td style="text-align: left;"> a vector of <code>n</code> times to the event </td>
</tr>
<tr>
<td style="text-align: left;">
<code>di</code> </td>
<td style="text-align: left;"> a vector of <code>n</code> censoring indicators for the event time (1=event occurred, 0=censored) </td>
</tr>
<tr>
<td style="text-align: left;">
<code>x</code> </td>
<td style="text-align: left;"> covariate matrix, <code>n</code> observations by <code>p</code> variables</td>
</tr>
<tr>
<td style="text-align: left;">
<code>eta0</code> </td>
<td style="text-align: left;"> scale parameter of gamma process prior for the cumulative baseline hazard, <code class="reqn">eta0 &gt; 0</code>
</td>
</tr>
<tr>
<td style="text-align: left;">
<code>kappa0</code> </td>
<td style="text-align: left;"> shape parameter of gamma process prior for the cumulative baseline hazard, <code class="reqn">kappa0 &gt; 0</code>
</td>
</tr>
<tr>
<td style="text-align: left;">
<code>c0</code> </td>
<td style="text-align: left;"> the confidence parameter of gamma process prior for the cumulative baseline hazard, <code class="reqn">c0 &gt; 0</code>
</td>
</tr>
<tr>
<td style="text-align: left;">
<code>r</code> </td>
<td style="text-align: left;"> the shape parameter of the gamma prior for <code class="reqn">\lambda^2</code>
</td>
</tr>
<tr>
<td style="text-align: left;">
<code>delta</code> </td>
<td style="text-align: left;"> the rate parameter of the gamma prior for <code class="reqn">\lambda^2</code>
</td>
</tr>
<tr>
<td style="text-align: left;">
<code>s</code> </td>
<td style="text-align: left;"> the set of time partitions for specification of the cumulative baseline hazard function</td>
</tr>
<tr>
<td style="text-align: left;">
<code>groupInd</code> </td>
<td style="text-align: left;"> a vector of <code>p</code> group indicator for each variable</td>
</tr>
<tr>
<td style="text-align: left;">
<code>beta.ini</code> </td>
<td style="text-align: left;"> the starting values for <code class="reqn">\beta</code>
</td>
</tr>
<tr>
<td style="text-align: left;">
<code>lambdaSq</code> </td>
<td style="text-align: left;"> the starting value for <code class="reqn">\lambda^2</code>
</td>
</tr>
<tr>
<td style="text-align: left;">
<code>sigmaSq</code> </td>
<td style="text-align: left;"> the starting value for <code class="reqn">\sigma^2</code>
</td>
</tr>
<tr>
<td style="text-align: left;">
<code>tauSq</code> </td>
<td style="text-align: left;"> the starting values for <code class="reqn">\tau^2</code>
</td>
</tr>
<tr>
<td style="text-align: left;">
<code>h</code> </td>
<td style="text-align: left;"> the starting values for <code class="reqn">h</code>
</td>
</tr>
<tr>
<td style="text-align: left;">
<code>numBeta</code> </td>
<td style="text-align: left;"> the number of components in <code class="reqn">\beta</code> to be updated at one iteration</td>
</tr>
<tr>
<td style="text-align: left;">
<code>beta.prop.var</code> </td>
<td style="text-align: left;"> the variance of the proposal density for <code class="reqn">\beta</code> when <code>rw</code> is set to "TRUE"</td>
</tr>
<tr>
<td style="text-align: left;">
</td>
</tr>
</table>
<h3>Value</h3>

<p><code>psbcGL</code> returns an object of class <code>psbcGL</code> <br></p>
<table>
<tr style="vertical-align: top;">
<td><code>beta.p</code></td>
<td>
<p>posterior samples for <code class="reqn">\beta</code></p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>h.p</code></td>
<td>
<p>posterior samples for <code class="reqn">h</code></p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>tauSq.p</code></td>
<td>
<p>posterior samples for <code class="reqn">\tau^2</code></p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>mcmcOutcome</code></td>
<td>
<p>The list containing posterior samples for the remaining model parameters</p>
</td>
</tr>
</table>
<h3>Note</h3>

<p>To fit the PSBC model with the ordinary Bayesian lasso prior (Lee et al., 2011), <code>groupInd</code> needs to be set to <code>1:p</code>. 
If the prespecified value of <code>save</code> is less than that of <code>num.reps</code>, the results are saved
as <code>.Rdata</code> file under the directory <code>working directory/mcmcOutcome</code>. 
</p>


<h3>Author(s)</h3>

<p>Kyu Ha Lee, Sounak Chakraborty, (Tony) Jianguo Sun
</p>


<h3>References</h3>

<p>Lee, K. H., Chakraborty, S., and Sun, J. (2011). 
Bayesian Variable Selection in Semiparametric Proportional Hazards Model for High Dimensional Survival Data. 
<em>The International Journal of Biostatistics</em>, Volume 7, Issue 1, Pages 1-32. <br></p>
<p>Lee, K. H., Chakraborty, S., and Sun, J. (2015). 
Survival Prediction and Variable Selection with Simultaneous Shrinkage and Grouping Priors. <em>Statistical Analysis and Data Mining</em>, Volume 8, Issue 2, pages 114-127.
</p>


<h3>Examples</h3>

<pre><code class="language-R">
## Not run: 

# generate some survival data
	
	set.seed(204542)
	
	p = 20
	n = 100
	beta.true &lt;- c(rep(4, 10), rep(0, (p-10)))	

	CovX&lt;-matrix(0,p,p)

	for(i in 1:10){
		for(j in 1:10){
			CovX[i,j] &lt;- 0.5^abs(i-j)
			}
		}
		
	diag(CovX) &lt;- 1
	
	survObj 	&lt;- list()
	survObj$x	&lt;- apply(rmvnorm(n, sigma=CovX, method="chol"), 2, scale)
	
	pred &lt;- as.vector(exp(rowSums(scale(survObj$x, center = FALSE, scale = 1/beta.true))))
	
	t 		&lt;- rexp(n, rate = pred)
	cen		&lt;- runif(n, 0, 8)      
	survObj$t 		&lt;- pmin(t, cen)
	survObj$di 		&lt;- as.numeric(t &lt;= cen)

	priorPara 			&lt;- list()
	priorPara$eta0 		&lt;- 1
	priorPara$kappa0 	&lt;- 1
	priorPara$c0 		&lt;- 2
	priorPara$r			&lt;- 0.5
	priorPara$delta		&lt;- 0.0001
	priorPara$s			&lt;- sort(survObj$t[survObj$di == 1])
	priorPara$s			&lt;- c(priorPara$s, 2*max(survObj$t)
	-max(survObj$t[-which(survObj$t==max(survObj$t))]))
	priorPara$J			&lt;- length(priorPara$s)
	priorPara$groupInd	&lt;- c(rep(1,10),2:11)

	mcmcPara				&lt;- list()
	mcmcPara$numBeta		&lt;- p
	mcmcPara$beta.prop.var	&lt;- 1

	initial				&lt;- list()
	initial$beta.ini	&lt;- rep(0.5, p)
	initial$lambdaSq	&lt;- 1
	initial$sigmaSq		&lt;- runif(1, 0.1, 10)
	initial$tauSq		&lt;- rexp(length(unique(priorPara$groupInd)),
	rate = initial$lambdaSq/2)
	initial$h			&lt;- rgamma(priorPara$J, 1, 1)

	rw = FALSE
	num.reps = 20000
	chain = 1
	thin = 5
	save = 5

	fitGL &lt;- psbcGL(survObj, priorPara, initial, rw=FALSE, mcmcPara, 
				num.reps, thin, chain, save)
	vs &lt;- VS(fitGL, X=survObj$x)
				
	
## End(Not run)		

</code></pre>


</div>