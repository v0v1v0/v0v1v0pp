<div class="container">

<table style="width: 100%;"><tr>
<td>pdPgram</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>Multitaper HPD periodogram matrix</h2>

<h3>Description</h3>

<p>Given a multivariate time series, <code>pdPgram</code> computes a multitapered HPD periodogram matrix based on
averaging raw Hermitian PSD periodogram matrices of tapered multivariate time series segments.
</p>


<h3>Usage</h3>

<pre><code class="language-R">pdPgram(X, B, method = c("multitaper", "bartlett"), bias.corr = F,
  nw = 3)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>X</code></td>
<td>
<p>an (<code class="reqn">n,d</code>)-dimensional matrix corresponding to a multivariate time series,
with the <code>d</code> columns corresponding to the components of the time series.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>B</code></td>
<td>
<p>depending on the argument <code>method</code>, either the number of orthogonal DPSS tapers, or the number of
non-overlapping segments to compute Bartlett's averaged periodogram. By default,
<code>B = d</code>, such that the averaged periodogram is guaranteed to be positive definite.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>method</code></td>
<td>
<p>the tapering method, either <code>"multitaper"</code> or <code>"bartlett"</code> explained in the Details
section below. Defaults to <code>"multitaper"</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>bias.corr</code></td>
<td>
<p>should an asymptotic bias-correction under the affine-invariant Riemannian metric be applied to
the HPD periodogram matrix? Defaults to <code>FALSE</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>nw</code></td>
<td>
<p>a positive numeric value corresponding to the time-bandwidth parameter of the DPSS tapering functions,
see also <code>dpss</code>, defaults to <code>nw = 3</code>.</p>
</td>
</tr>
</table>
<h3>Details</h3>

<p>If <code>method = "multitaper"</code>, <code>pdPgram</code> calculates a <code class="reqn">(d,d)</code>-dimensional multitaper
periodogram matrix based on <code class="reqn">B</code> DPSS (Discrete Prolate Spheroidal Sequence or Slepian) orthogonal tapering functions
as in <code>dpss</code> applied to the <code class="reqn">d</code>-dimensional time series <code>X</code>. If <code>method = "bartlett"</code>,
<code>pdPgram</code> computes a Bartlett spectral estimator by averaging the periodogram matrices of <code>B</code> non-overlapping
segments of the <code class="reqn">d</code>-dimensional time series <code>X</code>. Note that Bartlett's spectral estimator is a
specific (trivial) case of a multitaper spectral estimator with uniform orthogonal tapering windows.<br>
In the case of subsequent periodogram matrix denoising in the space of HPD matrices equipped with the
affine-invariant Riemannian metric, one should set <code>bias.corr = T</code>, thereby correcting for the asymptotic
bias of the periodogram matrix in the manifold of HPD matrices equipped with the affine-invariant metric as explained in
(Chau and von
Sachs 2019) and Chapter 3 of (Chau 2018). The pre-smoothed HPD periodogram matrix
(i.e., an initial noisy HPD spectral estimator) can be given as input to the function <code>pdSpecEst1D</code> to perform
intrinsic wavelet-based spectral matrix estimation. In this case, set <code>bias.corr = F</code> (the default) as the appropriate
bias-corrections are applied internally by the function <code>pdSpecEst1D</code>.
</p>


<h3>Value</h3>

<p>A list containing two components:
</p>
<table>
<tr style="vertical-align: top;">
<td>
<code>freq</code> </td>
<td>
<p> vector of <code class="reqn">n/2</code> frequencies in the range <code class="reqn">[0,0.5)</code> at which the periodogram is evaluated.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td>
<code>P</code> </td>
<td>
<p> a <code class="reqn">(d, d, n/2)</code>-dimensional array containing the
(<code class="reqn">d,d</code>)-dimensional multitaper periodogram matrices at frequencies corresponding
to <code>freq</code>.</p>
</td>
</tr>
</table>
<h3>References</h3>

<p>Chau J (2018).
<em>Advances in Spectral Analysis for Multivariate, Nonstationary and Replicated Time Series</em>.
phdthesis, Universite catholique de Louvain.<br><br> Chau J, von
Sachs R (2019).
“Intrinsic wavelet regression for curves of Hermitian positive definite matrices.”
<em>Journal of the American Statistical Association</em>.
doi: <a href="https://doi.org/10.1080/01621459.2019.1700129">10.1080/01621459.2019.1700129</a>.
</p>


<h3>See Also</h3>

<p><code>pdPgram2D</code>, <code>dpss</code>
</p>


<h3>Examples</h3>

<pre><code class="language-R">## ARMA(1,1) process: Example 11.4.1 in (Brockwell and Davis, 1991)
Phi &lt;- array(c(0.7, 0, 0, 0.6, rep(0, 4)), dim = c(2, 2, 2))
Theta &lt;- array(c(0.5, -0.7, 0.6, 0.8, rep(0, 4)), dim = c(2, 2, 2))
Sigma &lt;- matrix(c(1, 0.71, 0.71, 2), nrow = 2)
ts.sim &lt;- rARMA(200, 2, Phi, Theta, Sigma)
ts.plot(ts.sim$X) # plot generated time series traces
pgram &lt;- pdPgram(ts.sim$X)

</code></pre>


</div>