<div class="container">

<table style="width: 100%;"><tr>
<td>dag2cpdag</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>Convert a DAG to a CPDAG</h2>

<h3>Description</h3>

<p>Convert a DAG (Directed Acyclic Graph) to a Completed Partially
Directed Acyclic Graph (CPDAG).
</p>


<h3>Usage</h3>

<pre><code class="language-R">dag2cpdag(g)
</code></pre>


<h3>Arguments</h3>

<table><tr style="vertical-align: top;">
<td><code>g</code></td>
<td>
<p>an <span style="font-family: Courier New, Courier; color: #666666;"><b>R</b></span> object of class <code>"graph"</code> (package <span class="pkg">graph</span>),
representing a DAG.</p>
</td>
</tr></table>
<h3>Details</h3>

<p>This function converts a DAG into its corresponding
(unique) CPDAG as follows.  Because every DAG in the
Markov equivalence class described by a CPDAG shares the same skeleton
and the same v-structures, this function takes the skeleton and the
v-structures of the given DAG <code>g</code>.  Afterwards it simply uses the
3 orientation rules of the PC algorithm (see references) to orient as
many of the remaining undirected edges as possible.
</p>
<p>The function is a simple wrapper function for <code>dag2essgraph</code>
which is more powerfull since it also allows the calculation of the 
Markov equivalence class in the presence of interventional data.
</p>
<p>The output of this function is exactly the same as the one using
</p>
<pre>pc(suffStat, indepTest, alpha, labels)</pre>
<p>using the true correlation matrix in the function <code>gaussCItest</code>
with a large virtual sample size and a large alpha, but it is much
faster.
</p>


<h3>Value</h3>

<p>A graph object containing the CPDAG.
</p>


<h3>Author(s)</h3>

<p>Markus Kalisch (<a href="mailto:kalisch@stat.math.ethz.ch">kalisch@stat.math.ethz.ch</a>) and 
Alain Hauser(<a href="mailto:alain.hauser@bfh.ch">alain.hauser@bfh.ch</a>)</p>


<h3>References</h3>

<p>C. Meek (1995). Causal inference and causal explanation with
background knowledge. In <em>Proceedings of the Eleventh Conference on
Uncertainty in Artificial Intelligence (UAI-95)</em>, pp. 403-411. Morgan
Kaufmann Publishers, Inc.
</p>
<p>P. Spirtes, C. Glymour and R. Scheines (2000)
<em>Causation, Prediction, and Search</em>, 2nd edition, The MIT Press.
</p>


<h3>See Also</h3>

<p><code>dag2essgraph</code>, <code>randomDAG</code>, <code>pc</code></p>


<h3>Examples</h3>

<pre><code class="language-R">## A -&gt; B &lt;- C
am1 &lt;- matrix(c(0,1,0, 0,0,0, 0,1,0), 3,3)
colnames(am1) &lt;- rownames(am1) &lt;- LETTERS[1:3]
g1 &lt;- as(t(am1), "graphNEL") ## convert to graph
cpdag1 &lt;- dag2cpdag(g1)

if(requireNamespace("Rgraphviz")) {
    par(mfrow = c(1,2))
    plot(g1)
    plot(cpdag1)
}

## A -&gt; B -&gt; C
am2 &lt;- matrix(c(0,1,0, 0,0,1, 0,0,0), 3,3)
colnames(am2) &lt;- rownames(am2) &lt;- LETTERS[1:3]
g2 &lt;- as(t(am2), "graphNEL") ## convert to graph
cpdag2 &lt;- dag2cpdag(g2)

if(requireNamespace("Rgraphviz")) {
    par(mfrow = c(1,2))
    plot(g2)
    plot(cpdag2)
}
</code></pre>


</div>