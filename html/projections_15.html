<div class="container">

<table style="width: 100%;"><tr>
<td>project</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>Project future incidence</h2>

<h3>Description</h3>

<p>This function simulates future incidence based on past incidence data, a
selection of plausible reproduction numbers (R), and the distribution of the
serial interval (time from primary onset to secondary onset).
</p>


<h3>Usage</h3>

<pre><code class="language-R">project(
  x,
  R,
  si,
  n_sim = 100,
  n_days = 7,
  R_fix_within = FALSE,
  model = c("poisson", "negbin"),
  size = 0.03,
  time_change = NULL,
  instantaneous_R = FALSE
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>x</code></td>
<td>
<p>An <code>incidence</code> object containing daily incidence; other time
intervals will trigger an error.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>R</code></td>
<td>
<p>A vector of numbers representing plausible reproduction numbers; for
instance, these can be samples from a posterior distribution using the
<code>earlyR</code> or <code>EpiEstim</code> packages. If <code>time_change</code> is provided, then it must
be a <code>vector</code> (for fixed values of R per time window) or a <code>list</code> of
vectors (for separate distributions of R per time window), with one element
more than the number of dates in <code>time_change</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>si</code></td>
<td>
<p>A function computing the serial interval, or a <code>numeric</code> vector
providing its mass function, starting a day 1, so that <code>si[i]</code> is the PMF
for serial interval of <code>i</code>. The model implicitly assumes that <code>si[0] = 0</code>.
For functions, we strongly recommend using the RECON package
<code>distcrete</code> to obtain such distribution (see example).</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>n_sim</code></td>
<td>
<p>The number of epicurves to simulate. Defaults to 100.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>n_days</code></td>
<td>
<p>The number of days to run simulations for. Defaults to 14.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>R_fix_within</code></td>
<td>
<p>A logical indicating if R should be fixed within
simulations (but still varying across simulations). If <code>FALSE</code>, R is
drawn for every simulation and every time step. Fixing values within
simulations favours more extreme predictions (see details)</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>model</code></td>
<td>
<p>Distribution to be used for projections. Must be one of
"poisson" or "negbin" (negative binomial process). Defaults to poisson</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>size</code></td>
<td>
<p>size parameter of negative binomial distribition. Ignored if
model is poisson</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>time_change</code></td>
<td>
<p>an optional vector of times at which the simulations
should use a different sample of reproduction numbers, provided in days
into the simulation (so that day '1' is the first day after the input
<code>incidence</code> object); if provided, <code>n</code> dates in <code>time_change</code> will produce
<code>n+1</code> time windows, in which case <code>R</code> should be a list of vectors of <code>n+1</code>
<code>R</code> values, one per each time window.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>instantaneous_R</code></td>
<td>
<p>a boolean specifying whether to assume <code>R</code> is the case
reproduction number (<code>instantaneous_R = FALSE</code>, the default), or the
instantaneous reproduction number (<code>instantaneous_R = TRUE</code>).
If <code>instantaneous_R = FALSE</code> then values of <code>R</code> at time <code>t</code> will govern the
mean number of secondary cases of all cases infected at time <code>t</code>,
even if those secondary cases appear after <code>t</code>. In other words, <code>R</code>
will characterise onwards transmission from infectors depending on their
date of infection.
If <code>instantaneous_R = TRUE</code> then values of <code>R</code> at time <code>t</code> will govern the
mean number of secondary cases made at time <code>t</code> by all cases infected
before <code>t</code>. In other words, <code>R</code> will characterise onwards transmission at
a given time.</p>
</td>
</tr>
</table>
<h3>Details</h3>

<p>The decision to fix R values within simulations
(<code>R_fix_within</code>) reflects two alternative views of the uncertainty
associated with R. When drawing R values at random from the provided
sample, (<code>R_fix_within</code> set to <code>FALSE</code>), it is assumed that R
varies naturally, and can be treated as a random variable with a given
distribution. When fixing values within simulations (<code>R_fix_within</code>
set to <code>TRUE</code>), R is treated as a fixed parameter, and the uncertainty
is merely a consequence of the estimation of R. In other words, the first
view is rather Bayesian, while the second is more frequentist.
</p>


<h3>Author(s)</h3>

<p>Pierre Nouvellet (original model), Thibaut Jombart (bulk of the
code), Sangeeta Bhatia (Negative Binomial model), Stephane Ghozzi (bug fixes
time varying R)
</p>


<h3>Examples</h3>

<pre><code class="language-R">
## example using simulated Ebola outbreak
if (require(outbreaks) &amp;&amp;
    require(distcrete) &amp;&amp;
    require(incidence) &amp;&amp;
    require(magrittr)) {

si &lt;- distcrete("gamma", interval = 1L,
                 shape = 2.4,
                 scale = 4.7,
                 w = 0.5)

i &lt;- incidence(ebola_sim$linelist$date_of_onset)
plot(i)


## projections after the first 100 days, over 60 days, fixed R to 2.1

set.seed(1)
proj_1 &lt;- project(x = i[1:100], R = 2.1, si = si, n_days = 60)
plot(proj_1)

## add projections to incidence plot
plot(i[1:160]) %&gt;% add_projections(proj_1)


## projections after the first 100 days, over 60 days,
## using a sample of R

set.seed(1)
R &lt;- rnorm(100, 1.8, 0.2)
hist(R, col = "grey", border = "white", main = "Distribution of R")
proj_2 &lt;- project(x = i[1:100], R = R, si = si, n_days = 60)

## add projections to incidence plot
plot(i[1:160]) %&gt;% add_projections(proj_2)


## same with R constant per simulation (more variability)

set.seed(1)
proj_3 &lt;- project(x = i[1:100], R = R, si = si, n_days = 60,
                  R_fix_within = TRUE)

## add projections to incidence plot
plot(i[1:160]) %&gt;% add_projections(proj_3)


## time-varying R, 2 periods, R is 2.1 then 0.5
set.seed(1)
proj_4 &lt;- project(i,
                  R = c(2.1, 0.5),
                  si = si,
                  n_days = 60,
                  time_change = 40,
                  n_sim = 100)
plot(proj_4)


## time-varying R, 2 periods, separate distributions of R for each period
set.seed(1)
R_period_1 &lt;- runif(100, min = 1.1, max = 3)
R_period_2 &lt;- runif(100, min = 0.6, max = .9)

proj_5 &lt;- project(i,
                  R = list(R_period_1, R_period_2),
                  si = si,
                  n_days = 60,
                  time_change = 20,
                  n_sim = 100)
plot(proj_5)

}

</code></pre>


</div>