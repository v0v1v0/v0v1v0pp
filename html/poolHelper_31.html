<div class="container">

<table style="width: 100%;"><tr>
<td>removeSites</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>Apply a minor allele reads threshold</h2>

<h3>Description</h3>

<p>Removes sites where the total number of minor-allele reads is below a certain
threshold.
</p>


<h3>Usage</h3>

<pre><code class="language-R">removeSites(freqs, alternative, coverage, minor, min.minor)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>freqs</code></td>
<td>
<p>a vector of allele frequencies where each entry corresponds to a
different site.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>alternative</code></td>
<td>
<p>a matrix with the number of reads with the alternative
allele. Each row should be a different population and each column a
different site.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>coverage</code></td>
<td>
<p>a matrix with the total coverage. Each row should be a
different population and each column a different site.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>minor</code></td>
<td>
<p>a matrix with the number of minor-allele reads. Each row should
be a different population and each column a different site.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>min.minor</code></td>
<td>
<p>is an integer representing the minimum allowed number of
minor-allele reads. Sites that, across all populations, have less
minor-allele reads than this threshold will be removed from the data.</p>
</td>
</tr>
</table>
<h3>Details</h3>

<p>If a site has less minor-allele reads than <code>min.minor</code> across all
populations, that site is removed from the data.
</p>


<h3>Value</h3>

<p>a list with three named entries:
</p>
<table>
<tr style="vertical-align: top;">
<td><code>freqs</code></td>
<td>
<p>is a vector with the allele frequencies minus the frequency of
the removed sites.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>alternative</code></td>
<td>
<p>is a matrix with the number of alternative-allele reads
per site, minus any removed sites.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>coverage</code></td>
<td>
<p>is a matrix with the depth of coverage minus the coverage
of the removed sites.</p>
</td>
</tr>
</table>
<h3>Examples</h3>

<pre><code class="language-R"># create a vector of allele frequencies
freqs &lt;- runif(20)

set.seed(10)
# create a matrix with the number of reads with the alternative allele
alternative &lt;- matrix(sample(x = c(0,5,10), size = 20, replace = TRUE), nrow = 1)
# create a matrix with the depth of coverage
coverage &lt;- matrix(sample(100:150, size = 20), nrow = 1)
# the number of reads with the reference allele is obtained by subtracting
# the number of alternative allele reads from the depth of coverage
reference &lt;- coverage - alternative

# find the minor allele at each site
minor &lt;- findMinor(reference = reference, alternative = alternative, coverage = coverage)
# keep only the matrix with the minor allele reads
minor &lt;- minor[["minor"]]

# remove sites where the number of minor-allele reads is below the threshold
removeSites(freqs = freqs, alternative = alternative, coverage = coverage,
minor = minor, min.minor = 2)

</code></pre>


</div>