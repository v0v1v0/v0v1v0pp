<div class="container">

<table style="width: 100%;"><tr>
<td>make_haplotypes</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>Split samples from a genind object into pseudo-haplotypes</h2>

<h3>Description</h3>

<p>Split samples from a genind object into pseudo-haplotypes
</p>


<h3>Usage</h3>

<pre><code class="language-R">make_haplotypes(gid)
</code></pre>


<h3>Arguments</h3>

<table><tr style="vertical-align: top;">
<td><code>gid</code></td>
<td>
<p>a genind or genlight object.</p>
</td>
</tr></table>
<h3>Details</h3>

<p>Certain analyses, such as amova work best if within-sample
variance (error) can be estimated. Practically, this is performed by
splitting the genotypes across all loci to create multiple haplotypes. This
way, the within-sample distance can be calculated and incorporated into the
model. Please note that the haplotypes generated are based on the order of
the unphased alleles in the genind object and do not represent true
haplotypes.
</p>
<p>Haploid data will be returned un-touched.
</p>


<h3>Value</h3>

<p>a haploid genind object with an extra strata
column called "Individual".
</p>


<h3>Note</h3>

<p>The other slot will not be copied over to the new
genind object.
</p>


<h3>See Also</h3>

<p><code>poppr.amova()</code> <code>pegas::amova()</code> <code>as.genambig()</code>
</p>


<h3>Examples</h3>

<pre><code class="language-R"># Diploid data is doubled -------------------------------------------------

data(nancycats)
nan9 &lt;- nancycats[pop = 9]
nan9hap &lt;- make_haplotypes(nan9) 
nan9              # 9 individuals from population 9
nan9hap           # 18 haplotypes
strata(nan9hap)   # strata gains a new column: Individual
indNames(nan9hap) # individuals are renamed sequentially


# Mix ploidy data can be split, but should be treated with caution --------
# 
# For example, the Pinf data set contains 86 tetraploid individuals, 
# but there appear to only be diploids and triploid genotypes. When 
# we convert to haplotypes, those with all missing data are dropped.
data(Pinf)
Pinf
pmiss &lt;- info_table(Pinf, type = "ploidy", plot = TRUE)

# No samples appear to be triploid across all loci. This will cause
# several haplotypes to have a lot of missing data.
p_haps &lt;- make_haplotypes(Pinf)
p_haps
head(genind2df(p_haps), n = 20)
</code></pre>


</div>