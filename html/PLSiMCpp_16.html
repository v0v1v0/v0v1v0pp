<div class="container">

<table style="width: 100%;"><tr>
<td>plsim.lam</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>Select lambda for Penalized Profile Least Squares Estimator</h2>

<h3>Description</h3>

<p>Use AIC or BIC to 
choose the regularization parameters for Penalized Profile least squares (PPLS) estimation.
</p>


<h3>Usage</h3>

<pre><code class="language-R">plsim.lam(...)

## S3 method for class 'formula'
plsim.lam(formula, data, ...)

## Default S3 method:
plsim.lam(xdat=NULL, ydat, zdat, h, zetaini=NULL, penalty="SCAD", 
lambdaList=NULL, l1_ratio_List=NULL, lambda_selector="BIC", verbose=TRUE, seed=0, ...)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>...</code></td>
<td>
<p>additional arguments.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>formula</code></td>
<td>
<p>a symbolic description of the model to be fitted.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>data</code></td>
<td>
<p>an optional data frame, list or environment containing the variables in the model.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>xdat</code></td>
<td>
<p>input matrix (linear covariates). The model reduces to a single index model when <code>x</code> is NULL.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>zdat</code></td>
<td>
<p>input matrix (nonlinear covariates). <code>z</code> should not be NULL.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>ydat</code></td>
<td>
<p>input vector (response variable).</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>h</code></td>
<td>
<p>bandwidth.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>zetaini</code></td>
<td>
<p>initial coefficients, optional (default: NULL). It could be obtained by the function <code>plsim.ini</code>.
<code>zetaini[1:ncol(z)]</code> is the initial coefficient vector <code class="reqn">\alpha_0</code>,
and <code>zetaini[(ncol(z)+1):(ncol(z)+ncol(x))]</code> is the initial coefficient vector <code class="reqn">\beta_0</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>penalty</code></td>
<td>
<p>string, optional (default="SCAD"). It could be "SCAD", "LASSO" or "ElasticNet".</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>lambdaList</code></td>
<td>
<p>candidates for lambda selection. <code>lambda</code> is a constant that multiplies the penalty term. 
If <code>lambdaList</code> is NULL, function plsim.lam will automatically set it.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>l1_ratio_List</code></td>
<td>
<p>candidates for l1_ratio selection. <code>l1_ratio</code> is a constant that balances the importances 
of L1 norm and L2 norm for "ElasticNet". If <code>l1_ratio_List</code> is NULL, function plsim.lam ranges from 0 to 1 with 
an increment 0.1.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>lambda_selector</code></td>
<td>
<p>the criterion to select lambda (and l1_ratio), default: "BIC".</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>verbose</code></td>
<td>
<p>bool, default: TRUE. Enable verbose output.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>seed</code></td>
<td>
<p>int, default: 0.</p>
</td>
</tr>
</table>
<h3>Value</h3>

<table>
<tr style="vertical-align: top;">
<td><code>goodness_best</code></td>
<td>
<p>the AIC (or BIC) statistics with <code>lambda_best</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>lambda_best</code></td>
<td>
<p>lambda selected by AIC or BIC.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>l1_ratio_best</code></td>
<td>
<p>l1_ratio selected by AIC or BIC.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>lambdaList</code></td>
<td>
<p><code>lambdaList</code> automatically selected when inputting NULL.</p>
</td>
</tr>
</table>
<h3>References</h3>

<p>H. Liang, X. Liu, R. Li, C. L. Tsai. <em>Estimation and testing for partially linear single-index models</em>.
Annals of statistics, 2010, 38(6): 3811.
</p>


<h3>Examples</h3>

<pre><code class="language-R">
# EXAMPLE 1 (INTERFACE=FORMULA)
# To select the regularization parameters based on AIC.

n = 50
sigma = 0.1

alpha = matrix(1,2,1)
alpha = alpha/norm(alpha,"2")
beta = matrix(4,1,1)

x = matrix(1,n,1)
z = matrix(runif(n*2),n,2)
y = 4*((z%*%alpha-1/sqrt(2))^2) + x%*%beta + sigma*matrix(rnorm(n),n,1)


fit_plsimest = plsim.est(y~x|z)

# Select the regularization parameters by AIC
res = plsim.lam(y~x|z,h=fit_plsimest$data$h,zetaini = fit_plsimest$zeta,
             lambda_selector='AIC')


# EXAMPLE 2 (INTERFACE=DATA FRAME)
# To select the regularization parameters based on AIC.

n = 50
sigma = 0.1

alpha = matrix(1,2,1)
alpha = alpha/norm(alpha,"2")
beta = matrix(4,1,1)

x = rep(1,n)
z1 = runif(n)
z2 = runif(n) 
X = data.frame(x)
Z = data.frame(z1,z2)

x = data.matrix(X)
z = data.matrix(Z)
y = 4*((z%*%alpha-1/sqrt(2))^2) + x%*%beta + sigma*matrix(rnorm(n),n,1)

fit_plsimest = plsim.est(xdat=X,zdat=Z,ydat=y)

# Select the regularization parameters by AIC
res2 = plsim.lam(xdat=X,ydat=y,zdat=Z,h=fit_plsimest$data$h,
              zetaini = fit_plsimest$zeta, lambda_selector='AIC')

</code></pre>


</div>