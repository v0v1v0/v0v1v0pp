<div class="container">

<table style="width: 100%;"><tr>
<td>VDJ_clonal_donut</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>Circular VDJ expansion plots</h2>

<h3>Description</h3>

<p>Generate circular plots of clonal expansion per repertoire directly from the VDJ matrix of the VDJ_GEX_matrix function
</p>


<h3>Usage</h3>

<pre><code class="language-R">VDJ_clonal_donut(
  VDJ,
  counts.to.use,
  label.size,
  not.expanded.label.vjust,
  not.expanded.label.hjust,
  total.label.vjust,
  total.label.hjust,
  expanded.colors,
  non.expanded.color
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>VDJ</code></td>
<td>
<p>VDJ dataframe generated using the VDJ_GEX_matrix function (VDJ_GEX_matrix.output[[1]]). Plots will be made by sample and using the clonal frequencies specified by counts.to.use</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>counts.to.use</code></td>
<td>
<p>How to count clonotypes and cells. A column name of the VDJ matrix containing clonotype IDs. This defaults to "clonotype_id_10x", which reflects clonotypes by Cellranger in an unaltered VGM. To use counts from the VDJ_clonotype_v3 function set this parameter to the relevant column e.g. "clonotype_id_cdr.aa" or   "global_clonotype_id_cdr.aa" are two examples.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>label.size</code></td>
<td>
<p>Size of text labels. All parameters below are purely for graphical purposes and optional. If necessary changes should be made in small (0.1) increments. ! It is recommended to optimize these ONLY once a format for saving the plot is set.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>not.expanded.label.vjust</code></td>
<td>
<p>Numeric. Regulates the vertical position of the label for non expanded cells</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>not.expanded.label.hjust</code></td>
<td>
<p>Numeric. Regulates the horizontal position of the label for non expanded cells</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>total.label.vjust</code></td>
<td>
<p>Numeric. Regulates the vertical position of the center label</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>total.label.hjust</code></td>
<td>
<p>Numeric. Regulates the horizontal position of the center label</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>expanded.colors</code></td>
<td>
<p>Character vector. Colors to use for expanded clones. Should be more than 3 for better visibility. Defaults to a "darkorchid3"-based palette.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>non.expanded.color</code></td>
<td>
<p>Character. Color to use for non expanded clones. Defaults to "black"</p>
</td>
</tr>
</table>
<h3>Value</h3>

<p>Returns a list of circular plots showing proportions of expanded clones and non-expanded clones. One plot is generated for each sample in the sample_id column
</p>


<h3>Examples</h3>

<pre><code class="language-R">VDJ_clonal_donut(VDJ = Platypus::small_vgm[[1]])

</code></pre>


</div>