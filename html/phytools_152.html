<div class="container">

<table style="width: 100%;"><tr>
<td>rateshift</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>Find the temporal position of one or more rate shifts</h2>

<h3>Description</h3>

<p>Fits a model with one or more temporal rate shifts for a continuous trait on the tree.
</p>


<h3>Usage</h3>

<pre><code class="language-R">rateshift(tree, x, nrates=1, niter=10, method="ML", ...)
## S3 method for class 'rateshift'
plot(x, ...)
likSurface.rateshift(tree, x, nrates=2, shift.range=NULL,
   density=20, plot=TRUE, ...)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>tree</code></td>
<td>
<p>object of class <code>"phylo"</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>x</code></td>
<td>
<p>vector of phenotypic trait values for species. <code>names(x)</code> should contain the species names and match <code>tree$tip.label</code>. For <code>plot</code> method, <code>x</code> is an object of class <code>"rateshift"</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>nrates</code></td>
<td>
<p>number of rates.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>niter</code></td>
<td>
<p>number of iterations of optimization routine to ensure convergence.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>method</code></td>
<td>
<p>optimization method. Can be <code>"ML"</code> (maximum likelihood) or <code>"REML"</code> (restricted maximum likelihood).</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>...</code></td>
<td>
<p>optional arguments. In the case of the <code>plot</code> method, these will be passed to <code>plotSimmap</code>. For <code>rateshift</code>, optional arguments include: <code>tol</code>, tolerance; <code>plot</code> &amp; <code>print</code>, logical values indicating whether to plot or print the progress of the optimization (default to <code>FALSE</code>); <code>quiet</code>, logical argument indicating whether to suppress all notifications (defaults to <code>FALSE</code>); <code>minL</code>, numeric value; and <code>fixed.shift</code>, either a vector of fixed shift points, or a logical value.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>shift.range</code></td>
<td>
<p>for <code>likSurface.rateshift</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>density</code></td>
<td>
<p>for <code>likSurface.rateshift</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>plot</code></td>
<td>
<p>logical argument for <code>likSurface.rateshift</code>. If <code>plot=FALSE</code> then the surface is returned.</p>
</td>
</tr>
</table>
<h3>Details</h3>

<p><code>rateshift</code> attempts to find the location of one or more rate shifts. This model is quite easy to compute the likelihood for, but quite difficult to optimize as the likelihood surface is often rugged.
</p>
<p><code>likSurface.rateshift</code> plots the likelihood surface.
</p>


<h3>Value</h3>

<p>A fitted object of class <code>"rateshift"</code>, or, in the case of <code>likSurface.rateshift</code>, a likelihood surface for the shift points.
</p>


<h3>Author(s)</h3>

<p>Liam Revell <a href="mailto:liam.revell@umb.edu">liam.revell@umb.edu</a></p>


<h3>References</h3>

<p>Revell, L. J. (2024) phytools 2.0: an updated R ecosystem for phylogenetic comparative methods (and other things). <em>PeerJ</em>, <b>12</b>, e16505.
</p>
<p>Revell, L. J. and L. J. Harmon (2022) <em>Phylogenetic Comparative Methods in R</em>. Princeton University Press.
</p>


<h3>See Also</h3>

<p><code>brownie.lite</code>
</p>


</div>