<div class="container">

<table style="width: 100%;"><tr>
<td>compute_expectations.BM</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>Compute the expected states of a BM</h2>

<h3>Description</h3>

<p><code>compute_expectations.BM</code> use the matrix formulation to compute the 
expected values at all the nodes.
</p>


<h3>Usage</h3>

<pre><code class="language-R">compute_expectations.BM(phylo, root.state, shifts, U_tree = NULL)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>phylo</code></td>
<td>
<p>Input tree.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>root.state</code></td>
<td>
<p>(list): state of the root, with:
random : random state (TRUE) or deterministic state (FALSE)
value.root : if deterministic, value of the character at the root
exp.root : if random, expectation of the character at the root
var.root : if random, variance of the character at the root (pxp matrix)</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>shifts</code></td>
<td>
<p>(list) position and values of the shifts :
edges : vector of the K id of edges where the shifts are
values : matrix p x K of values of the shifts on the edges (one column = one shift)
relativeTimes : vector of dimension K of relative time of the shift from the
parent node of edges</p>
</td>
</tr>
</table>
<h3>Value</h3>

<p>paramSimu: array p x Nnode x 2 (BM). For each trait t, 1 &lt;= t &lt;= p,
paramSimu[t, , ] has two columns, both containing the expected values for
all the nodes.
</p>


</div>