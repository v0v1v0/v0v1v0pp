<div class="container">

<table style="width: 100%;"><tr>
<td>fit.gpcm</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>Fits LMA model where category scale values equal a_im * x_j</h2>

<h3>Description</h3>

<p>Function estimates the parameters of LMA models with fixed category scores
multiplied by an item weight parameter. This function can be used to estimate
the LMA model corresponding to is a generalized partial credit model for
multi-category items and the 2 parameter logistic model for dichotomous
items. The function sets up log objects and model formula.  In the case of
unidimensional models, the function iterates over item regressions; whereas,
for multidimensional models, the function iterates between the item and phi
regressions.  This function is called from 'ple.lma', but can be run outside
of 'ple.lma'.
</p>


<h3>Usage</h3>

<pre><code class="language-R">fit.gpcm(
  Master,
  Phi.mat,
  PersonByItem,
  TraitByTrait,
  item.by.trait,
  tol,
  npersons,
  nitems,
  ncat,
  nless,
  ntraits,
  Maxnphi,
  pq.mat,
  starting.sv,
  ItemNames,
  LambdaName,
  LambdaNames,
  PhiNames
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>Master</code></td>
<td>
<p>Master data set in long format</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>Phi.mat</code></td>
<td>
<p>Matrix of starting values of association parameters</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>PersonByItem</code></td>
<td>
<p>Person by item matrix of responses (same as inData)</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>TraitByTrait</code></td>
<td>
<p>Trait by trait adjacency matrix (same as inTraitAdj)</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>item.by.trait</code></td>
<td>
<p>Item by trait vector indicating trait item load on (same as inItemTraitAdj)</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>tol</code></td>
<td>
<p>Criterion used to determine convergence</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>npersons</code></td>
<td>
<p>Number of persons</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>nitems</code></td>
<td>
<p>Number of items</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>ncat</code></td>
<td>
<p>Number of categories per item</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>nless</code></td>
<td>
<p>Number of categories minus 1 (i.e., unique lambdas)</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>ntraits</code></td>
<td>
<p>Number of latent traits</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>Maxnphi</code></td>
<td>
<p>Number of phi parameters to be estimated</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>pq.mat</code></td>
<td>
<p>Used to compute rest-scores and totals</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>starting.sv</code></td>
<td>
<p>Fixed category scores</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>ItemNames</code></td>
<td>
<p>Names of items needed label output</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>LambdaName</code></td>
<td>
<p>Names of lambdas needed for formula of the item regressions</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>LambdaNames</code></td>
<td>
<p>Names of lambdas needed for formula of the stacked regression</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>PhiNames</code></td>
<td>
<p>Name of phi parameters (Null for uni-dimensional models)</p>
</td>
</tr>
</table>
<h3>Value</h3>

<p>item.log		  History over iterations of the algorithm for items' log likelihood,
lambda, and a parameter
</p>
<p>phi.log			  History over iterations of the algorithm for log likelihood, lambdas
nd phi parameters
</p>
<p>criterion		  Current value of the convergence statistic which is the maximum of items'
absolute differences between the current and previous value of the log
likelihood
</p>
<p>estimates   	An item by parameter matrix of estimated item parameter where the
first column are items' log likelihood
</p>
<p>Phi.mat	   	  Estimated matrix of association parameters
</p>
<p>fitem		      Formula for item data
</p>
<p>fstack	      Formula for stacked data
</p>
<p>item.mlogit 	Summary from final run of mlogit for item regressions for each item
</p>
<p>phi.mlogit	  Summary from final run mlogit for stacked regression
</p>
<p>mlpl.item     Value of maximum of log ple function from fitting items (i.e., sum of logLike)
</p>
<p>mlpl.phi	    Value of maximum of log ple function from stacked regression to get phi estimates
</p>
<p>AIC           Akaike information criterion for pseudo-likelihood (smaller is better)
</p>
<p>BIC           Bayesian information criterion for pseudo-likelihood (smaller is better)
</p>


<h3>Examples</h3>

<pre><code class="language-R"> data(dass)
 inData &lt;- dass[1:250,c("d1", "d2", "a1","a2","s1","s2")]
 #--- unidimensional
 inTraitAdj  &lt;- matrix(1, nrow=1, ncol=1)
 inItemTraitAdj &lt;- matrix(1, nrow=6, ncol=1)

# Need to set up data
s &lt;- set.up(inData, model.type='gpcm', inTraitAdj, inItemTraitAdj, tol=1e-03)

g &lt;- fit.gpcm(s$Master, s$Phi.mat, s$PersonByItem, s$TraitByTrait,
              s$item.by.trait, s$tol, s$npersons, s$nitems, s$ncat,
              s$nless, s$ntraits, s$Maxnphi, s$pq.mat, s$starting.sv,
              s$ItemNames, s$LambdaName, s$LambdaNames, s$PhiNames)

</code></pre>


</div>