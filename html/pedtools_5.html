<div class="container">

<table style="width: 100%;"><tr>
<td>plotmethods</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>Internal plot methods</h2>

<h3>Description</h3>

<p>The main purpose of this page is to document the many options for pedigree
plotting. Most of the arguments shown here may be supplied directly in
<code>plot(x, ...)</code>, where <code>x</code> is a pedigree. See <code>plot.ped()</code> for many examples.
</p>


<h3>Usage</h3>

<pre><code class="language-R">.pedAlignment(
  x = NULL,
  plist = NULL,
  arrows = FALSE,
  twins = NULL,
  packed = TRUE,
  width = 10,
  align = c(1.5, 2),
  spouseOrder = NULL,
  hints = NULL,
  ...
)

.pedAnnotation(
  x,
  title = NULL,
  marker = NULL,
  sep = "/",
  missing = "-",
  showEmpty = FALSE,
  labs = labels(x),
  foldLabs = 12,
  trimLabs = TRUE,
  col = 1,
  fill = NA,
  lty = 1,
  lwd = 1,
  hatched = NULL,
  hatchDensity = 25,
  aff = NULL,
  carrier = NULL,
  deceased = NULL,
  starred = NULL,
  textAnnot = NULL,
  textInside = NULL,
  textAbove = NULL,
  fouInb = "autosomal",
  ...
)

.pedScaling(
  alignment,
  annotation,
  cex = 1,
  symbolsize = 1,
  margins = 1,
  addSpace = 0,
  xlim = NULL,
  ylim = NULL,
  vsep2 = FALSE,
  autoScale = FALSE,
  minsize = 0.15,
  ...
)

.drawPed(alignment, annotation, scaling)

.annotatePed(
  alignment,
  annotation,
  scaling,
  font = NULL,
  fam = NULL,
  col = NULL,
  colUnder = 1,
  colInside = 1,
  colAbove = 1,
  cex.main = NULL,
  font.main = NULL,
  col.main = NULL,
  line.main = NA,
  ...
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>x</code></td>
<td>
<p>A <code>ped()</code> object.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>plist</code></td>
<td>
<p>Alignment list with format similar to
<code>kinship2::align.pedigree()</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>arrows</code></td>
<td>
<p>A logical (default = FALSE). If TRUE, the pedigree is plotted
as a DAG, i.e., with arrows connecting parent-child pairs.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>twins</code></td>
<td>
<p>A data frame with columns <code>id1</code>, <code>id2</code> and <code>code</code>, passed on to
the <code>relation</code> parameter of <code>kinship2::plot.pedigree()</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>packed, width, align</code></td>
<td>
<p>Parameters passed on to
<code>kinship2::align.pedigree()</code>. Can usually be left untouched.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>spouseOrder</code></td>
<td>
<p>An optional vector (or list of vectors) indicating plot
ordering for spouses. (This is converted into a matrix and forward as
<code>hints</code>; see below.)</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>hints</code></td>
<td>
<p>An optional list of hints passed on to
<code>kinship2::align.pedigree()</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>...</code></td>
<td>
<p>Further parameters passed between methods.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>title</code></td>
<td>
<p>The plot title. If NULL (default) or ‚Äù, no title is added to
the plot.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>marker</code></td>
<td>
<p>Either a vector of names or indices referring to markers
attached to <code>x</code>, a <code>marker</code> object, or a list of such. The genotypes for
the chosen markers are written below each individual in the pedigree, in
the format determined by <code>sep</code> and <code>missing</code>. See also <code>showEmpty</code>. If NULL
(the default), no genotypes are plotted.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>sep</code></td>
<td>
<p>A character of length 1 separating alleles for diploid markers.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>missing</code></td>
<td>
<p>The symbol (integer or character) for missing alleles.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>showEmpty</code></td>
<td>
<p>A logical, indicating if empty genotypes should be included.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>labs</code></td>
<td>
<p>A vector or function controlling the individual labels in the
plot. By default, <code>labels(x)</code> are used. See Details for valid formats.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>foldLabs</code></td>
<td>
<p>A number or function controlling the folding of long labels.
If a number, line breaks are inserted at roughly this width, trying to
break at break-friendly characters. If a function, this is applied to each
label.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>trimLabs</code></td>
<td>
<p>A logical, by default TRUE. Removes line breaks and tabs from
both ends of the labels (after adding genotypes, if <code>marker</code> is not NULL).</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>col</code></td>
<td>
<p>A vector or list specifying outline colours for the pedigree
members. See Details for valid formats.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>fill</code></td>
<td>
<p>A vector or list specifying fill/hatch colours for the pedigree
members. See Details for valid formats. Note that if <code>fill</code> is unnamed, and
either <code>aff</code> or <code>hatched</code> are given, then the fill colour is applied only
to those.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>lty, lwd</code></td>
<td>
<p>Vectors or lists specifying linetype and width of pedigree
symbol outlines. See Details for valid formats.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>hatched</code></td>
<td>
<p>A vector of labels identifying members whose plot symbols
should be hatched.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>hatchDensity</code></td>
<td>
<p>A number specifying the hatch density in lines per inch.
Default: 25.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>aff</code></td>
<td>
<p>A vector of labels identifying members whose plot symbols should
be filled. (This is typically used in medical pedigrees to indicate
affected members.)</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>carrier</code></td>
<td>
<p>A vector of labels identifying members whose plot symbols
should be marked with a dot. (This is typically used in medical pedigrees
to indicate unaffected carriers of the disease allele.)</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>deceased</code></td>
<td>
<p>A vector of labels indicating deceased pedigree members.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>starred</code></td>
<td>
<p>A vector of labels indicating pedigree members that should be
marked with a star in the pedigree plot.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>textAnnot</code></td>
<td>
<p>A list specifying further text annotation around or inside
the pedigree symbols. See Details for more information.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>textInside, textAbove</code></td>
<td>
<p>Character vectors of text to be printed inside or
above pedigree symbols. [Soft deprecated; replaced by <code>textAnnot</code>.]</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>fouInb</code></td>
<td>
<p>Either "autosomal" (default), "x" or NULL. If "autosomal" or
"x", inbreeding coefficients are added to the plot above the inbred
founders. If NULL, or if no founders are inbred, nothing is added.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>alignment</code></td>
<td>
<p>List of alignment details, as returned by <code>.pedAlignment()</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>annotation</code></td>
<td>
<p>List of annotation details as returned by
<code>.pedAnnotation()</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>cex</code></td>
<td>
<p>Expansion factor controlling font size. This also affects symbol
sizes, which by default have the width of 2.5 characters. Default: 1.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>symbolsize</code></td>
<td>
<p>Expansion factor for pedigree symbols. Default: 1.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>margins</code></td>
<td>
<p>A numeric indicating the plot margins. If a single number is
given, it is recycled to length 4.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>addSpace</code></td>
<td>
<p>A numeric of length 4, indicating extra padding (in inches)
around the pedigree inside the plot region. Default: 0.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>xlim, ylim</code></td>
<td>
<p>Numeric vectors of length 2, used to set <code>par("usr")</code>
explicitly. Rarely needed by end users.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>vsep2</code></td>
<td>
<p>A logical; for internal use.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>autoScale</code></td>
<td>
<p>A logical. It TRUE, an attempt is made to adjust <code>cex</code> so
that the symbol dimensions are at least <code>minsize</code> inches. Default: FALSE.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>minsize</code></td>
<td>
<p>A positive number, by default 0.15. (See <code>autoScale</code>.)</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>scaling</code></td>
<td>
<p>List of scaling parameters as returned by <code>.pedScaling()</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>font, fam</code></td>
<td>
<p>Arguments passed on to <code>text()</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>colUnder, colInside, colAbove</code></td>
<td>
<p>Colour vectors.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>cex.main, line.main, col.main, font.main</code></td>
<td>
<p>Parameters passed on to <code>title()</code>.</p>
</td>
</tr>
</table>
<h3>Details</h3>

<p>The workflow of <code>plot.ped(x, ...)</code> is approximately as follows:
</p>
<div class="sourceCode"><pre># Calculate plot parameters
align = .pedAlignment(x, ...)
annot = .pedAnnotation(x, ...)
scale = .pedScaling(align, annot, ...)

# Produce plot
.drawPed(align, annot, scale)
.annotatePed(align, annot, scale)  # if `annot` contains text annotation etc
</pre></div>
<p>The <code>labs</code> argument control the individual ID labels printed below the
pedigree symbols. By default the output of <code>labels(x)</code> is used, but there are
several alternative forms:
</p>

<ul>
<li>
<p> If <code>labs</code> is a vector with nonempty intersection with <code>labels(x)</code>, only
these individuals will be labelled. If the vector is named, then the names
are used instead of the ID label. (See Examples.)
</p>
</li>
<li>
<p> If <code>labs</code> is the word "num", then all individuals are numerically
labelled following the internal ordering.
</p>
</li>
<li>
<p> Use <code>labs = NULL</code> to remove all labels.
</p>
</li>
<li>
<p> If <code>labs</code> is a function, it is replaced with <code>labs(x)</code> and handled as
above. (See Examples.)
</p>
</li>
</ul>
<p>The argument <code>textAnnot</code> allows customised annotation around and inside each
symbol. This takes a list of lists, whose names may include "topleft",
"topright", "left", "right", "bottomleft", "bottom", "bottomright" and
"inside". Each inner list should contain a character vector as its first
element (with the text to printed), followed by further arguments passed to
<code>text()</code>. For example, <code>textAnnot = list(left = list(c(A = "1"), cex = 2))</code>
prints a large number "1" to the left of individual A (if such an individual
exists in the pedigree. See Examples.
</p>
<p>The arguments <code>col</code>, <code>fill</code>, <code>lty</code> and <code>lwd</code> can all be indicated in a number
of ways:
</p>

<ul>
<li>
<p> An unnamed vector. This will be recycled and applied to all members. For
example, <code>lty = 2</code> gives everyone a dashed outline.
</p>
</li>
<li>
<p> A named vector. Only pedigree members appearing in the names are affected.
Example: <code>fill = c("1" = "red", foo = "blue")</code> fills individual <code>1</code> red and
<code>foo</code> blue.
</p>
</li>
<li>
<p> A list of ID vectors, where the list names indicate the parameter values.
Example: <code>col = list(red = 1:2, blue = 3:5)</code>.
</p>
</li>
<li>
<p> List entries may also be functions, taking the pedigree <code>x</code> as input and
producing a vector of ID labels. The many built-in functions in
ped_subgroups are particularly handy here, e.g.: <code>fill = list(red = founders, blue = leaves)</code>.
</p>
</li>
</ul>
<h3>Examples</h3>

<pre><code class="language-R">x = nuclearPed()

align = .pedAlignment(x)
annot = .pedAnnotation(x)
scale = .pedScaling(align, annot)

drawPed(align, annot, scale)

</code></pre>


</div>