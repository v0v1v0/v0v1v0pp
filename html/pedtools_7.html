<div class="container">

<table style="width: 100%;"><tr>
<td>addAllele</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>Add allele</h2>

<h3>Description</h3>

<p>Extends the allele set of a marker attached to a pedigree, by adding a single
allele.
</p>


<h3>Usage</h3>

<pre><code class="language-R">addAllele(x, marker, allele, freq = 0.001, adjust = c("previous", "all"))
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>x</code></td>
<td>
<p>A <code>ped</code> object or a list of such, or a frequency database (list of
numeric vectors).</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>marker</code></td>
<td>
<p>The name or index of a marker attached to <code>x</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>allele</code></td>
<td>
<p>The name of the new allele.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>freq</code></td>
<td>
<p>The frequency of the new allele, by default 0.001.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>adjust</code></td>
<td>
<p>Either "previous" or "all", indicating how the frequencies
should be adjusted so that they sum to 1. If "previous" (default), the
frequencies of the original alleles are multiplied with <code>1 - freq</code>. If
"all", scaling is performed after adding the new allele, i.e., dividing all
frequencies by <code>1 + freq</code>.</p>
</td>
</tr>
</table>
<h3>Value</h3>

<p>A copy of <code>x</code> with modified marker attributes.
</p>


<h3>Examples</h3>

<pre><code class="language-R">
## Ped input
x = nuclearPed() |&gt;
  addMarker(geno = c(NA, NA, "b/c"), afreq = c(b = 0.5, c = 0.5))

y = addAllele(x, marker = 1, allele = "a")
afreq(y, 1)

z = addAllele(y, marker = 1, allele = "d", freq = 0.1, adjust = "all")
afreq(z, 1)


## Database input
db = list(M1 = c(a = .2, b = .3, c = .5),
          M2 = c("7" = .9, "8.3" = .1))
addAllele(db, marker = "M2", allele = "8")

</code></pre>


</div>