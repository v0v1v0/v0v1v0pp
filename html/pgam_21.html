<div class="container">

<table style="width: 100%;"><tr>
<td>pgam.filter</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>Estimation of the conditional distributions parameters of the level</h2>

<h3>Description</h3>

<p>The priori and posteriori conditional distributions of the level is gamma and their parameters are estimated through this recursive filter. See <b>Details</b> for a thorough description.
</p>


<h3>Usage</h3>

<pre><code class="language-R">pgam.filter(w, y, eta)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>w</code></td>
<td>
<p>running estimate of discount factor <code class="reqn">\omega</code> of a Poisson-Gamma model</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>y</code></td>
<td>
<p><code class="reqn">n</code> length vector of the time series observations</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>eta</code></td>
<td>
<p>full linear or semiparametric predictor. Linear predictor is a trivial case of semiparameric model</p>
</td>
</tr>
</table>
<h3>Details</h3>

<p>Consider <code class="reqn">Y_{t-1}</code> a vector of observed values of a Poisson process untill the instant <code class="reqn">t-1</code>. Conditional on that, <code class="reqn">\mu_{t}</code> has gamma distribution with parameters given by
</p>
<p style="text-align: center;"><code class="reqn">a_{t|t-1}=\omega a_{t-1}</code>
</p>

<p style="text-align: center;"><code class="reqn">b_{t|t-1}=\omega b_{t-1}\exp\left(-\eta_{t}\right)</code>
</p>

<p>Once <code class="reqn">y_{t}</code> is known, the posteriori distribution of <code class="reqn">\mu_{t}|Y_{t}</code> is also gamma with parameters given by
</p>
<p style="text-align: center;"><code class="reqn">a_{t}=\omega a_{t-1}+y_{t}</code>
</p>

<p style="text-align: center;"><code class="reqn">b_{t}=\omega b_{t-1}+\exp\left(\eta_{t}\right)</code>
</p>

<p>with <code class="reqn">t=\tau,\ldots,n</code>, where <code class="reqn">\tau</code> is the index of the first non-zero observation of <code class="reqn">y</code>.
</p>
<p>Diffuse initialization of the filter is applied by setting <code class="reqn">a_{0}=0</code> and <code class="reqn">b_{0}=0</code>. A proper distribution of <code class="reqn">\mu_{t}</code> is obtained at <code class="reqn">t=\tau</code>, where <code class="reqn">\tau</code> is the fisrt non-zero observation of the time series.
</p>


<h3>Value</h3>

<p>A list containing the time varying parmeters of the priori and posteriori conditional distribution is returned.
</p>


<h3>Note</h3>

<p>This function is not intended to be called directly.
</p>


<h3>Author(s)</h3>

<p>Washington Leite Junger <a href="mailto:wjunger@ims.uerj.br">wjunger@ims.uerj.br</a> and Antonio Ponce de Leon <a href="mailto:ponce@ims.uerj.br">ponce@ims.uerj.br</a>
</p>


<h3>References</h3>

<p>Harvey, A. C., Fernandes, C. (1989) Time series models for count data or qualitative observations. Journal of Business and Economic Statistics, 7(4):407â€“417
</p>
<p>Harvey, A. C. (1990) Forecasting, structural time series models and the Kalman Filter. Cambridge, New York
</p>
<p>Junger, W. L. (2004) Semiparametric Poisson-Gamma models: a roughness penalty approach. MSc Dissertation. Rio de Janeiro, PUC-Rio, Department of Electrical Engineering. 
</p>


<h3>See Also</h3>

<p><code>pgam</code>, <code>pgam.likelihood</code>, <code>pgam.fit</code>, <code>predict.pgam</code></p>


</div>