<div class="container">

<table style="width: 100%;"><tr>
<td>pcode_lkh</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>pcode_lkh (likelihood and multiple dimension version)</h2>

<h3>Description</h3>

<p>Obtain estimates of both structural and nuisance parameters of an ODE model by parameter cascade method.
</p>


<h3>Usage</h3>

<pre><code class="language-R">pcode_lkh(data, likelihood.fun, time, ode.model, par.names,
                 state.names, par.initial, basis.list, lambda, controls)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>data</code></td>
<td>
<p>A data frame or a matrix contain observations from each dimension of the ODE model.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>likelihood.fun</code></td>
<td>
<p>A function computes the likelihood or the loglikelihood of the errors.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>time</code></td>
<td>
<p>A vector contains observation ties or a matrix if time points are different between dimesion.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>ode.model</code></td>
<td>
<p>An R function that computes the time derivative of the ODE model given observations of states variable and structural parameters.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>par.names</code></td>
<td>
<p>The names of structural parameters defined in the 'ode.model'.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>state.names</code></td>
<td>
<p>The names of state variables defined in the 'ode.model'.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>par.initial</code></td>
<td>
<p>Initial value of structural parameters to be optimized.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>basis.list</code></td>
<td>
<p>A list of basis objects for smoothing each dimension's observations. Can be the same or different across dimensions.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>lambda</code></td>
<td>
<p>Penalty parameter.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>controls</code></td>
<td>
<p>A list of control parameters. See ‘Details’.</p>
</td>
</tr>
</table>
<h3>Details</h3>

<p>The <code>controls</code> argument is a list providing addition inputs for the nonlinear least square optimizer:
</p>

<ul>
<li> <p><code>nquadpts</code> Determine the number of quadrature points for approximating an integral. Default is 101.
</p>
</li>
<li> <p><code>smooth.lambda</code> Determine the smoothness penalty for obtaining initial value of nuisance parameters.
</p>
</li>
<li> <p><code>tau</code> Initial value of Marquardt parameter. Small values indicate good initial values for structural parameters.
</p>
</li>
<li> <p><code>tolx</code> Tolerance for parameters of objective functions. Default is set at 1e-6.
</p>
</li>
<li> <p><code>tolg</code> Tolerance for the gradient of parameters of objective functions. Default is set at 1e-6.
</p>
</li>
<li> <p><code>maxeval</code> The maximum number of evaluation of the optimizer. Default is set at 20.
</p>
</li>
</ul>
<h3>Value</h3>

<table>
<tr style="vertical-align: top;">
<td><code>structural.par</code></td>
<td>
<p>The structural parameters of the ODE model.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>nuisance.par</code></td>
<td>
<p>The nuisance parameters or the basis coefficients for interpolating observations.</p>
</td>
</tr>
</table>
</div>