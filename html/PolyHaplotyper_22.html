<div class="container">

<table style="width: 100%;"><tr>
<td>mergeReplicates</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>merge replicate samples in dosage matrix</h2>

<h3>Description</h3>

<p>merge replicate samples in dosage matrix
</p>


<h3>Usage</h3>

<pre><code class="language-R">mergeReplicates(mrkDosage, replist, solveConflicts=TRUE)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>mrkDosage</code></td>
<td>
<p>a dosage matrix with markers in rows and individuals in columns.
row names are marker names, column names are individual names.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>replist</code></td>
<td>
<p>a list of character vectors, each of which has the sample names
of a set of replicates</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>solveConflicts</code></td>
<td>
<p>if TRUE (default) and there are conflicting dosage
assignments between replicates for the same marker, the one with highest
frequency is used, provided the total freq of other dosages = 1 OR
&lt;= 10% of the frequency of the most frequent dosage. If
solveConflicts is FALSE and there are conflicting dosages, the consensus for
that marker will be NA</p>
</td>
</tr>
</table>
<h3>Details</h3>

<p>This function merges all sets of replicates, each to one column.
The column name of the one retained column is the first one for that set
in replist.<br>
For each set of replicates it calls getConsensusmrkDosage
</p>


<h3>Value</h3>

<p>a version of mrkDosage in which only one column of each set of replicates
is retained; this column (the first in its set as specified in replist)
now has the consensus scores over all replicates. Also, if mrkDosage was a
data.frame, it is converted into a matrix.
</p>


<h3>Examples</h3>

<pre><code class="language-R"># construct a dosage matrix with some missing data:
dosmat &lt;-
 matrix(c(rep(c(3,0,1),3), rep(c(1,1,2),4)), nrow=3,
        dimnames=list(c("mrk1","mrk2","mrk3"),
                      c("a1","a2","a3", "b1","b2","b3","b4")))
ix &lt;- matrix(c(1,1, 3,1, 2,2, 1,3, 2,4, 1,5, 2,6), ncol=2, byrow=TRUE)
dosmat[ix] &lt;- NA
dosmat
# define 2 sets of replicates:
reps &lt;- list(c("a1","a2","a3"), c("b1","b2","b3","b4"))
# merge:
mergeReplicates(mrkDosage=dosmat, replist=reps)
# introduce a conflicting dosage:
dosmat[3,2] &lt;- 2
# merge:
mergeReplicates(mrkDosage=dosmat, replist=reps)
</code></pre>


</div>