<div class="container">

<table style="width: 100%;"><tr>
<td>diagnostic.cor.eigs</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>Determine the dimension of low dimensional embedding</h2>

<h3>Description</h3>

<p>This function estimate the dimension of low dimensional embedding for a given cell by gene expression matrix. For more details, see Franklin et al. (1995) and Crawford et al. (2010).
</p>


<h3>Usage</h3>

<pre><code class="language-R">diagnostic.cor.eigs(object, ...)

## Default S3 method:
diagnostic.cor.eigs(
  object,
  q_max = 50,
  plot = TRUE,
  n.sims = 10,
  parallel = TRUE,
  ncores = 10,
  seed = 1,
  ...
)

## S3 method for class 'Seurat'
diagnostic.cor.eigs(
  object,
  assay = NULL,
  slot = "data",
  nfeatures = 2000,
  q_max = 50,
  seed = 1,
  ...
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>object</code></td>
<td>
<p>A Seurat or matrix object</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>...</code></td>
<td>
<p>Other arguments passed to <code>diagnostic.cor.eigs.default</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>q_max</code></td>
<td>
<p>the upper bound of low dimensional embedding. Default is 50.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>plot</code></td>
<td>
<p>a indicator of whether plot eigen values.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>n.sims</code></td>
<td>
<p>number of simulaton times. Default is 10.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>parallel</code></td>
<td>
<p>a indicator of whether use parallel analysis.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>ncores</code></td>
<td>
<p>the number of cores used in parallel analysis. Default is 10.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>seed</code></td>
<td>
<p>a postive integer, specify the random seed for reproducibility</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>assay</code></td>
<td>
<p>an optional string, specify the name of assay in the Seurat object to be used.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>slot</code></td>
<td>
<p>an optional string, specify the name of slot.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>nfeatures</code></td>
<td>
<p>an optional integer, specify the number of features to select as top variable features. Default is 2000.</p>
</td>
</tr>
</table>
<h3>Value</h3>

<p>A data.frame with attribute 'q_est' and 'plot', which is the estimated dimension of low dimensional embedding. In addition, this data.frame containing the following components:
</p>

<ul>
<li>
<p> q - The index of eigen values.
</p>
</li>
<li>
<p> eig_value - The eigen values on observed data.
</p>
</li>
<li>
<p> eig_sim - The mean value of eigen values of n.sims simulated data.
</p>
</li>
<li>
<p> q_est - The selected dimension in attr(obj, 'q_est').
</p>
</li>
<li>
<p> plot - The plot saved in attr(obj, 'plot').
</p>
</li>
</ul>
<h3>References</h3>

<p>1. Franklin, S. B., Gibson, D. J., Robertson, P. A., Pohlmann, J. T., &amp; Fralish, J. S. (1995). Parallel analysis: a method for determining significant principal components. Journal of Vegetation Science, 6(1), 99-106.
</p>
<p>2. Crawford, A. V., Green, S. B., Levy, R., Lo, W. J., Scott, L., Svetina, D., &amp; Thompson, M. S. (2010). Evaluation of parallel analysis methods for determining the number of factors.Educational and Psychological Measurement, 70(6), 885-901.
</p>


<h3>Examples</h3>

<pre><code class="language-R">n &lt;- 100
p &lt;- 50
d &lt;- 15
object &lt;- matrix(rnorm(n*d), n, d) %*% matrix(rnorm(d*p), d, p)
diagnostic.cor.eigs(object, n.sims=2)
</code></pre>


</div>