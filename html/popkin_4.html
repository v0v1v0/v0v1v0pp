<div class="container">

<table style="width: 100%;"><tr>
<td>avg_kinship_subpops</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>Calculate a kinship matrix between subpopulations by averaging individual data</h2>

<h3>Description</h3>

<p>This function calculates a kinship matrix between subpopulations, whose values are the average kinship values between all individual pairs where one individual is in the first subpopulation and the other individual is in the second subpopulation.
To estimate coancestry instead of kinship, which is recommended to get more interpretable diagonal values, the input kinship matrix should be transformed using <code>inbr_diag()</code>.
</p>


<h3>Usage</h3>

<pre><code class="language-R">avg_kinship_subpops(kinship, subpops, subpop_order = unique(subpops))
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>kinship</code></td>
<td>
<p>A symmetric <code>n</code>-by-<code>n</code> kinship matrix.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>subpops</code></td>
<td>
<p>The length-<code>n</code> vector of subpopulation assignments for each individual.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>subpop_order</code></td>
<td>
<p>The optional order of subpopulations in the output matrix.
<code>subpop_order</code> must contain every unique subpopulation in <code>subpops</code>.
Any additional subpopulations in <code>subpop_order</code> (missing in <code>subpops</code>) are ignored.
By default, subpopulations are in the order of first appearance in <code>subpops</code>.</p>
</td>
</tr>
</table>
<h3>Value</h3>

<p>The symmetric <code>K</code>-by-<code>K</code> kinship matrix between subpopulations, where <code>K</code> is the number of unique subpopulations in <code>subpops</code>, ordered as in <code>subpop_order</code>.
</p>


<h3>Examples</h3>

<pre><code class="language-R"># a toy kinship matrix with 5 individuals belonging to 2 subpopulations
kinship &lt;- matrix(
    c(
        0.7, 0.4, 0.4, 0.1, 0.0,
        0.4, 0.7, 0.4, 0.2, 0.1,
        0.4, 0.4, 0.7, 0.2, 0.0,
        0.1, 0.2, 0.2, 0.6, 0.1,
        0.0, 0.1, 0.0, 0.1, 0.6
    ),
    nrow = 5,
    ncol = 5
)
subpops &lt;- c(1, 1, 1, 2, 2)

# calculate mean kinship between (and within) subpopulations
# a 2x2 matrix
avg_kinship_subpops( kinship, subpops )

# calculate coancestry estimate instead (difference is diagonal)
avg_kinship_subpops( inbr_diag( kinship ), subpops )

</code></pre>


</div>