<div class="container">

<table style="width: 100%;"><tr>
<td>vwReg</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>Visually Weighted Regression.</h2>

<h3>Description</h3>

<p>Create watercolor plot to visualize weighted regression.
</p>


<h3>Usage</h3>

<pre><code class="language-R">vwReg(
  formula,
  data,
  title = "",
  B = 1000,
  shade = TRUE,
  shade.alpha = 0.1,
  spag = FALSE,
  spag.color = "darkblue",
  mweight = TRUE,
  show.lm = FALSE,
  show.median = TRUE,
  median.col = "white",
  shape = 21,
  show.CI = FALSE,
  method = loess,
  bw = FALSE,
  slices = 200,
  palette = colorRampPalette(c("#FFEDA0", "#DD0000"), bias = 2)(20),
  ylim = NULL,
  quantize = "continuous",
  add = FALSE,
  ...
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>formula</code></td>
<td>
<p>regression model.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>data</code></td>
<td>
<p>dataset.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>title</code></td>
<td>
<p>plot title.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>B</code></td>
<td>
<p>number of bootstrapped smoothers.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>shade</code></td>
<td>
<p>whether to plot the shaded confidence region.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>shade.alpha</code></td>
<td>
<p>whether to fade out the confidence interval shading at
the edges (by reducing alpha; 0 = no alpha decrease, 0.1 = medium alpha
decrease, 0.5 = strong alpha decrease).</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>spag</code></td>
<td>
<p>whether to plot spaghetti lines.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>spag.color</code></td>
<td>
<p>the fitting function for the spaghettis; default:
<code>loess</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>mweight</code></td>
<td>
<p>logical indicating whether to make the median smoother
visually weighted.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>show.lm</code></td>
<td>
<p>logical indicating whether to plot the linear regression line.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>show.median</code></td>
<td>
<p>logical indicating whether to plot the median smoother.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>median.col</code></td>
<td>
<p>color of the median smoother.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>shape</code></td>
<td>
<p>shape of points.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>show.CI</code></td>
<td>
<p>logical indicating whether to plot the 95% confidence
interval limits.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>method</code></td>
<td>
<p>color of spaghetti lines.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>bw</code></td>
<td>
<p>logical indicating whether to use a b&amp;w palette; default:
<code>TRUE</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>slices</code></td>
<td>
<p>number of slices in x and y direction for the shaded region.
Higher numbers make a smoother plot, but takes longer to draw. I would not
set <code>slices</code> to more than 500.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>palette</code></td>
<td>
<p>provide a custom color palette for the watercolors.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>ylim</code></td>
<td>
<p>restrict range of the watercoloring.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>quantize</code></td>
<td>
<p>either <code>continuous</code>, or <code>SD</code>. In the latter case, we get
three color regions for 1, 2, and 3 SD (an idea of John Mashey).</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>add</code></td>
<td>
<p>if <code>add == FALSE</code>, a new ggplot is returned. If
<code>add == TRUE</code>, only the elements are returned, which can be added to an
existing ggplot (with the <code>+</code> operator).</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>...</code></td>
<td>
<p>further parameters passed to the fitting function, in the case of
loess, for example, <code>span = .9</code>, or <code>family = "symmetric"</code>.</p>
</td>
</tr>
</table>
<h3>Details</h3>

<p>Creates a watercolor plot to visualize weighted regression.
</p>


<h3>Value</h3>

<p>plot
</p>


<h3>See Also</h3>

<p><a href="https://www.nicebread.de/visually-weighted-regression-in-r-a-la-solomon-hsiang/">https://www.nicebread.de/visually-weighted-regression-in-r-a-la-solomon-hsiang/</a>
</p>
<p><a href="https://www.nicebread.de/visually-weighted-watercolor-plots-new-variants-please-vote/">https://www.nicebread.de/visually-weighted-watercolor-plots-new-variants-please-vote/</a>
</p>
<p><a href="http://www.fight-entropy.com/2012/07/visually-weighted-regression.html">http://www.fight-entropy.com/2012/07/visually-weighted-regression.html</a>
</p>
<p><a href="http://www.fight-entropy.com/2012/08/visually-weighted-confidence-intervals.html">http://www.fight-entropy.com/2012/08/visually-weighted-confidence-intervals.html</a>
</p>
<p><a href="http://www.fight-entropy.com/2012/08/watercolor-regression.html">http://www.fight-entropy.com/2012/08/watercolor-regression.html</a>
</p>
<p><a href="https://papers.ssrn.com/sol3/papers.cfm?abstract_id=2265501">https://papers.ssrn.com/sol3/papers.cfm?abstract_id=2265501</a>
</p>
<p>Other plot: 
<code>addText()</code>,
<code>plot2WayInteraction()</code>,
<code>ppPlot()</code>
</p>
<p>Other correlations: 
<code>addText()</code>,
<code>cor.table()</code>,
<code>crossTimeCorrelation()</code>,
<code>crossTimeCorrelationDF()</code>,
<code>partialcor.table()</code>
</p>


<h3>Examples</h3>

<pre><code class="language-R">
# Prepare Data
data("mtcars")
df &lt;- data.frame(x = mtcars$hp, y = mtcars$mpg)

## Visually Weighted Regression

# Default
vwReg(y ~ x, df)

# Shade
vwReg(y ~ x, df, shade = TRUE, show.lm = TRUE, show.CI = TRUE,
quantize = "continuous")
vwReg(y ~ x, df, shade = TRUE, show.lm = TRUE, show.CI = TRUE,
quantize = "SD")

# Spaghetti
vwReg(y ~ x, df, shade = FALSE, spag = TRUE, show.lm = TRUE, show.CI = TRUE)
vwReg(y ~ x, df, shade = FALSE, spag = TRUE)

# Black/white
vwReg(y ~ x, df, shade = TRUE, spag = FALSE, show.lm = TRUE, show.CI = TRUE,
bw = TRUE, quantize = "continuous")
vwReg(y ~ x, df, shade = TRUE, spag = FALSE, show.lm = TRUE, show.CI = TRUE,
bw = TRUE, quantize = "SD")
vwReg(y ~ x, df, shade = FALSE, spag = TRUE, show.lm = TRUE, show.CI = TRUE,
bw = TRUE, quantize = "SD")

# Change the bootstrap smoothing
vwReg(y ~ x, df, family = "symmetric") # use an M-estimator for
# bootstrap smoothers. Usually yields wider confidence intervals
vwReg(y ~ x, df, span = 1.7) # increase the span of the smoothers
vwReg(y ~ x, df, span = 0.5) # decrease the span of the smoothers

# Change the color scheme
vwReg(y ~ x, df, palette = viridisLite::viridis(4)) # viridis
vwReg(y ~ x, df, palette = viridisLite::magma(4)) # magma
vwReg(y ~ x, df, palette = RColorBrewer::brewer.pal(9, "YlGnBu")) # change the
# color scheme, using a predefined ColorBrewer palette. You can see all
# available palettes by using this command:
# `library(RColorBrewer); display.brewer.all()`
vwReg(y ~ x, df, palette = grDevices::colorRampPalette(c("white","yellow",
"green","red"))(20)) # use a custom-made palette
vwReg(y ~ x, df, palette = grDevices::colorRampPalette(c("white","yellow",
"green","red"), bias = 3)(20)) # use a custom-made palette, with the
# parameter bias you can shift the color ramp to the “higher” colors
vwReg(y ~ x, df, bw = TRUE) # black and white version
vwReg(y ~ x, df, shade.alpha = 0, palette = grDevices::colorRampPalette(
c("black","grey30","white"), bias = 4)(20)) # Milky-Way Plot
vwReg(y ~ x, df, shade.alpha = 0, slices = 400, palette =
grDevices::colorRampPalette(c("black","green","yellow","red"),
bias = 5)(20), family = "symmetric") # Northern Light Plot/ fMRI plot
vwReg(y ~ x, df, quantize = "SD") # 1-2-3-SD plot


</code></pre>


</div>