<div class="container">

<table style="width: 100%;"><tr>
<td>r2_mlm</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>Multivariate R2</h2>

<h3>Description</h3>

<p>Calculates two multivariate R2 values for multivariate linear regression.
</p>


<h3>Usage</h3>

<pre><code class="language-R">r2_mlm(model, ...)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>model</code></td>
<td>
<p>Multivariate linear regression model.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>...</code></td>
<td>
<p>Currently not used.</p>
</td>
</tr>
</table>
<h3>Details</h3>

<p>The two indexes returned summarize model fit for the set of predictors
given the system of responses. As compared to the default
r2 index for multivariate linear models, the indexes
returned by this function provide a single fit value collapsed across
all responses.
</p>
<p>The two returned indexes were proposed by <em>Van den Burg and Lewis (1988)</em>
as an extension of the metrics proposed by <em>Cramer and Nicewander (1979)</em>.
Of the numerous indexes proposed across these two papers, only two metrics,
the <code class="reqn">R_{xy}</code> and <code class="reqn">P_{xy}</code>, are recommended for use
by <em>Azen and Budescu (2006)</em>.
</p>
<p>For a multivariate linear regression with <code class="reqn">p</code> predictors and
<code class="reqn">q</code> responses where <code class="reqn">p &gt; q</code>, the <code class="reqn">R_{xy}</code> index is
computed as:
</p>
<p style="text-align: center;"><code class="reqn">R_{xy} = 1 - \prod_{i=1}^p (1 - \rho_i^2)</code>
</p>

<p>Where <code class="reqn">\rho</code> is a canonical variate from a
canonical correlation between the predictors and responses.
This metric is symmetric and its value does not change when the roles of
the variables as predictors or responses are swapped.
</p>
<p>The <code class="reqn">P_{xy}</code> is computed as:
</p>
<p style="text-align: center;"><code class="reqn">P_{xy} = \frac{q - trace(\bf{S}_{\bf{YY}}^{-1}\bf{S}_{\bf{YY|X}})}{q}</code>
</p>

<p>Where <code class="reqn">\bf{S}_{\bf{YY}}</code> is the matrix of response covariances and
<code class="reqn">\bf{S}_{\bf{YY|X}}</code> is the matrix of residual covariances given
the predictors. This metric is asymmetric and can change
depending on which variables are considered predictors versus responses.
</p>


<h3>Value</h3>

<p>A named vector with the R2 values.
</p>


<h3>Author(s)</h3>

<p>Joseph Luchman
</p>


<h3>References</h3>


<ul>
<li>
<p> Azen, R., &amp; Budescu, D. V. (2006). Comparing predictors in
multivariate regression models: An extension of dominance analysis.
Journal of Educational and Behavioral Statistics, 31(2), 157-180.
</p>
</li>
<li>
<p> Cramer, E. M., &amp; Nicewander, W. A. (1979). Some symmetric,
invariant measures of multivariate association. Psychometrika, 44, 43-54.
</p>
</li>
<li>
<p> Van den Burg, W., &amp; Lewis, C. (1988). Some properties of two
measures of multivariate association. Psychometrika, 53, 109-122.
</p>
</li>
</ul>
<h3>Examples</h3>

<pre><code class="language-R">model &lt;- lm(cbind(qsec, drat) ~ wt + mpg + cyl, data = mtcars)
r2_mlm(model)

model_swap &lt;- lm(cbind(wt, mpg, cyl) ~ qsec + drat, data = mtcars)
r2_mlm(model_swap)

</code></pre>


</div>