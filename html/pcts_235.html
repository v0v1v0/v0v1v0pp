<div class="container">

<table style="width: 100%;"><tr>
<td>pclsdf</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>Fit PAR models using least squares</h2>

<h3>Description</h3>

<p>Fit PAR models using least squares. The model may contain
intercepts and linear trends, seasonal or non-seasonal.</p>


<h3>Usage</h3>

<pre><code class="language-R">pclsdf(x, d, lags = integer(0), sintercept = TRUE, sslope = FALSE,
       intercept = FALSE, slope = FALSE, xreg, contrasts = NULL,
       seasonof1st = NULL, coefonly = FALSE)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>x</code></td>
<td>
<p>time series, a numeric vector.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>d</code></td>
<td>
<p>period, an integer.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>lags</code></td>
<td>
<p>an integer vector, typically <code>1:p</code>, where <code>p</code> is
the order of the autoregression. The same lags are used for all
seasons.
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>sintercept</code></td>
<td>
<p>if TRUE include seasonal intercepts.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>sslope</code></td>
<td>
<p>if TRUE include seasonal linear trend.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>intercept</code></td>
<td>
<p>if TRUE include non-seasonal intercept.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>slope</code></td>
<td>
<p>if TRUE include non-seasonal linear trend.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>xreg</code></td>
<td>
<p>additional regressors, not used currently.</p>
</td>
</tr>
</table>
<table>
<tr style="vertical-align: top;">
<td><code>contrasts</code></td>
<td>
<p>contrasts to use for the seasons factor variable.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>seasonof1st</code></td>
<td>
<p>season of the first observation in the time series,
see Details.
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>coefonly</code></td>
<td>
<p>if TRUE, return only the parameters of the fitted
model, otherwise include also the object returned by <code>lm</code>.
</p>
</td>
</tr>
</table>
<h3>Details</h3>

<p>This function fits PAR models by the method of least squares.
Seasonal intercepts are included by default. Non-seasonal intercepts
are available, as well as seasonal and non-seasonal linear trend.
Separate arguments are provided, so that any combination of seasonal
and non-seasonal intercepts and slopes can be specified.
</p>
<p>If <code>coefonly</code> is TRUE, <code>pclsdf</code> returns only the estimated
parameters, otherwise it includes additional statistical information,
see section Note for the current details.
</p>


<h3>Value</h3>

<p>A list with the components listed below. Some components are present
only if included in the model specification.
</p>
<table>
<tr style="vertical-align: top;">
<td><code>par</code></td>
<td>
<p>the PAR coefficients, a matrix with a row for each season.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>sintercept</code></td>
<td>
<p>(if specified) seasonal intercepts, a numeric vector.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>sigma2hat</code></td>
<td>
<p>innovation variances.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>formula.char</code></td>
<td>
<p>the formula used in the call of <code>lm</code>, a
character string.
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>fit</code></td>
<td>
<p>(if <code>coefonly = FALSE</code>) the fitted object obtained
from <code>lm</code>.
</p>
</td>
</tr>
</table>
<h3>Note</h3>

<p>Currently, <code>pclsdf</code> prepares a model formula according to the
specification and calls <code>lm</code> to do the fitting. Component "fit"
in the result (available when <code>coefonly = FALSE</code>) contains the
raw fitted object returned by <code>lm</code>. Statistical inference based
on this object would, in general, not be justified for correlated
data.
</p>
<p><strong>todo:</strong> currently some of the parameters are returned only via the
fitted object from <code>lm</code>.
</p>


<h3>Author(s)</h3>

<p>Georgi N. Boshnakov
</p>


<h3>See Also</h3>

<p><code>pclspiar</code>,
</p>


<h3>Examples</h3>

<pre><code class="language-R">## data(dataFranses1996)
cu &lt;- pcts(dataFranses1996[ , "CanadaUnemployment"])
cu &lt;- window(cu, start = availStart(cu), end = availEnd(cu))

pclsdf(cu, 4, 1:2, sintercept = TRUE)

pclsdf(austres, 4, lags = 1:3)
pclsdf(austres, 4, lags = 1:3, sintercept = TRUE)
pclsdf(austres, 4, lags = 1:3, sintercept = TRUE, sslope = TRUE)

x &lt;- rep(1:4,10)
pclsdf(x, 4, lags = 1:3, sintercept = TRUE, sslope = TRUE)

## this is for the version when contrasts arg. was passed on directly to lm.
## tmp1 &lt;- pclsdf(austres, 4, lags = 1, sintercept = FALSE, sslope = TRUE,
##                contrasts = list(Season = "contr.sum" ))
</code></pre>


</div>