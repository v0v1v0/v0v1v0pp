<div class="container">

<table style="width: 100%;"><tr>
<td>logLik</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>
Log-Likelihood of a variable length Markov chain model
</h2>

<h3>Description</h3>

<p>Retrieve the log-likelihood of a fitted VLMC. This is the <code>logLik</code> method for objects of class <code>PSTf</code> returned by the <code>pstree</code> and <code>prune</code> functions.  
</p>


<h3>Usage</h3>

<pre><code class="language-R">## S4 method for signature 'PSTf'
logLik(object)
</code></pre>


<h3>Arguments</h3>

<table><tr style="vertical-align: top;">
<td><code>object</code></td>
<td>

<p>a probabilistic suffix tree, i.e., an object of class <code>"PSTf"</code> as returned by the <code>pstree</code>, <code>prune</code> or <code>tune</code> function.
</p>
</td>
</tr></table>
<h3>Details</h3>

<p>The likelihood of a learning sample containing <code class="reqn">n</code> sequences, given a model <code class="reqn">S</code> fitted to it, is
</p>
<p style="text-align: center;"><code class="reqn">
L(S)=\prod_{i=1}^{n} P^{S}(x^{i})
</code>
</p>

<p>where <code class="reqn">P^{S}(x^{i})</code> is the probability of the <code class="reqn">i</code>th observed sequence predicted by <code class="reqn">S</code>.
Note that the log-likelihood of a VLMC model is not used in the estimation of the model's parameters (see <code>pstree</code>). It is obtained once the model is estimated by calling the <code>predict</code> function. The value is stored in the <code>logLik</code> slot of the probabilistic suffix tree representing the model (a <code>PSTf</code> object returned by the <code>pstree</code> or <code>prune</code> function). 
The <code>AIC</code> and <code>BIC</code> values can also be obtained with the corresponding generic functions, which call <code>logLik</code> and use its result. For more details, see <cite>Gabadinho 2016</cite>.
</p>


<h3>Value</h3>

<p>An object of class <code>logLik</code>, a negative numeric value with the <code>df</code> (degrees of freedom) attribute containing the number of free parameters of the model.
</p>


<h3>Author(s)</h3>

<p>Alexis Gabadinho
</p>


<h3>References</h3>

<p>Gabadinho, A. &amp; Ritschard, G. (2016). Analyzing State Sequences with Probabilistic Suffix Trees: The PST R Package. <em>Journal of Statistical Software</em>, <b>72</b>(3), pp. 1-39.
</p>


<h3>See Also</h3>

<p><code>AIC</code>, <code>BIC</code>
</p>


<h3>Examples</h3>

<pre><code class="language-R">## activity calendar for year 2000
## from the Swiss Household Panel
## see ?actcal
data(actcal)

## selecting individuals aged 20 to 59
actcal &lt;- actcal[actcal$age00&gt;=20 &amp; actcal$age00 &lt;60,]

## defining a sequence object
actcal.lab &lt;- c("&gt; 37 hours", "19-36 hours", "1-18 hours", "no work")
actcal.seq &lt;- seqdef(actcal,13:24,labels=actcal.lab)

## building a PST
actcal.pst &lt;- pstree(actcal.seq, nmin=2, ymin=0.001)
logLik(actcal.pst)

## Cut-offs for 5% and 1% (see ?prune)
C99 &lt;- qchisq(0.99,4-1)/2

## pruning
actcal.pst.C99 &lt;- prune(actcal.pst, gain="G2", C=C99)

## Comparing AIC
AIC(actcal.pst, actcal.pst.C99)
</code></pre>


</div>