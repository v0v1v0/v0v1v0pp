<div class="container">

<table style="width: 100%;"><tr>
<td>mrlplot</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>Threshold Selection: The Empirical Mean Residual Life Plot</h2>

<h3>Description</h3>

<p>The empirical mean residual life plot. 
</p>


<h3>Usage</h3>

<pre><code class="language-R">mrlplot(data, u.range, main, xlab, ylab, nt = max(100, length(data)),
lty = rep(1,3), col = c('grey', 'black', 'grey'), conf = 0.95, lwd = c(1,
1.5, 1), ...) 
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>data</code></td>
<td>
<p>A numeric vector.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>u.range</code></td>
<td>
<p>A numeric vector of length two, giving the limits for
the thresholds at which the mean residual life plot is
evaluated. If <code>u.range</code> is not given, sensible defaults
are used.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>main</code></td>
<td>
<p>Plot title.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>xlab, ylab</code></td>
<td>
<p>x and y axis labels.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>nt</code></td>
<td>
<p>The number of thresholds at which the mean residual life
plot is evaluated.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>lty, col, lwd</code></td>
<td>
<p>Arguments passed to <code>matplot</code>. The first
and last elements of <code>lty</code> correspond to the lower and
upper confidence limits respectively. Use zero to supress.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>conf</code></td>
<td>
<p>The (pointwise) confidence coefficient for the
plotted confidence intervals.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>...</code></td>
<td>
<p>Other arguments to be passed to <code>matplot</code>.</p>
</td>
</tr>
</table>
<h3>Details</h3>

<p>The empirical mean residual life plot is the locus of points
</p>
<p style="text-align: center;"><code class="reqn">\left(u,\frac{1}{n_u} \sum\nolimits_{i=1}^{n_u}
    (x_{(i)} - u) \right)</code>
</p>

<p>where <code class="reqn">x_{(1)}, \dots, x_{(n_u)}</code> are
the <code class="reqn">n_u</code> observations that exceed the threshold <code class="reqn">u</code>.  If the
exceedances of a threshold <code class="reqn">u_0</code> are generalized Pareto, the
empirical mean residual life plot should be approximately linear for
<code class="reqn">u &gt; u_0</code>.
</p>
<p>The confidence intervals within the plot are symmetric intervals
based on the approximate normality of sample means.
</p>


<h3>Value</h3>

<p>A list with components <code>x</code> and <code>y</code> is invisibly returned.
The components contain those objects that were passed to the formal
arguments <code>x</code> and <code>y</code> of <code>matplot</code> in order to create
the mean residual life plot.
</p>


<h3>Author(s)</h3>

<p>Stuart Coles and Alec Stephenson</p>


<h3>References</h3>

<p>Coles, S. (2001) <em>An Introduction to Statistical
Modelling of Extreme Values</em>. Springer Series in Statistics. London.
</p>
<p>Embrechts, P., Kl\"uppelberg, C., and Mikosch, T. (1997)
<em>Modelling Extremal Events for Insurance and Finance.</em>
</p>


<h3>See Also</h3>

<p><code>fitgpd</code>, <code>matplot</code>,
<code>tcplot</code></p>


<h3>Examples</h3>

<pre><code class="language-R">data(ardieres)
ardieres &lt;- clust(ardieres, 4, 10 / 365, clust.max = TRUE)
flows &lt;- ardieres[, "obs"]
mrlplot(flows)
</code></pre>


</div>