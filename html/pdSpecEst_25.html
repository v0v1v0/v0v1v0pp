<div class="container">

<table style="width: 100%;"><tr>
<td>pdSplineReg</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>Cubic smoothing spline regression for HPD matrices</h2>

<h3>Description</h3>

<p><code>pdSplineReg()</code> performs cubic smoothing spline regression in the space of HPD matrices equipped with the
affine-invariant Riemannian metric through minimization of a penalized regression objective function using a
geometric conjugate gradient descent method as outlined in (Boumal and Absil 2011a) and (Boumal and Absil 2011b).
This is a specific implementation of the more general algorithm in (Boumal and Absil 2011a) and (Boumal and Absil 2011b),
setting the part in the objective function based on the first-order finite geometric differences to zero, such that the solutions
of the regression problem are approximating cubic splines.
</p>


<h3>Usage</h3>

<pre><code class="language-R">pdSplineReg(P, f0, lam = 1, Nd, ini_step = 1, max_iter = 100,
  eps = 0.001, ...)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>P</code></td>
<td>
<p>a <code class="reqn">(d,d,n)</code>-dimensional array corresponding to a length <code class="reqn">n</code> sequence of (<code class="reqn">d, d</code>)-dimensional
noisy HPD matrices.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>f0</code></td>
<td>
<p>a <code class="reqn">(d,d,n)</code>-dimensional array corresponding to an initial estimate of the smooth
target curve of (<code class="reqn">d, d</code>)-dimensional HPD matrices.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>lam</code></td>
<td>
<p>a smoothness penalty, defaults to <code>lam = 1</code>. If <code>lam = 0</code>, the penalized curve estimate
coincides with geodesic interpolation of the data points with respect to the Riemannian metric.
If <code>lam</code> increases to <code class="reqn">\infty</code>, the penalized regression estimator is approximately a fitted geodesic curve.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>Nd</code></td>
<td>
<p>a numeric value (<code>Nd &lt;= n</code>) determining a lower resolution of the cubic spline regression estimator to speed up
computation time, defaults to <code class="reqn">n</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>ini_step</code></td>
<td>
<p>initial candidate step size in a backtracking line search based on the Armijo-Goldstein
condition, defaults to <code>ini_step = 1</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>max_iter</code></td>
<td>
<p>maximum number of gradient descent iterations, defaults to <code>max_iter = 100</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>eps</code></td>
<td>
<p>optional tolerance parameter in gradient descent algorithm. The gradient descent procedure exits if the
absolute difference between consecutive evaluations of the objective function is smaller than <code>eps</code>,
defaults to <code>eps = 1E-3</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>...</code></td>
<td>
<p>additional arguments for internal use.</p>
</td>
</tr>
</table>
<h3>Value</h3>

<p>A list with three components:
</p>
<table>
<tr style="vertical-align: top;">
<td><code>f </code></td>
<td>
<p>a <code class="reqn">(d, d, N_d)</code>-dimensional array corresponding to a length <code>Nd</code> estimated cubic smoothing spline
curve of (<code class="reqn">d, d</code>)-dimensional HPD matrices.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>cost </code></td>
<td>
<p>a numeric vector containing the costs of the objective function at each gradient descent iteration.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>total_iter </code></td>
<td>
<p>total number of gradient descent iterations.</p>
</td>
</tr>
</table>
<h3>Note</h3>

<p>This function does not check for positive definiteness of the matrices given as input, and may fail
if matrices are close to being singular.
</p>


<h3>References</h3>

<p>Boumal N, Absil P (2011a).
“Discrete regression methods on the cone of positive-definite matrices.”
In <em>IEEE ICASSP, 2011</em>, 4232–4235.<br><br> Boumal N, Absil P (2011b).
“A discrete regression method on manifolds and its application to data on SO(n).”
<em>IFAC Proceedings Volumes</em>, <b>44</b>(1), 2284–2289.
</p>


<h3>Examples</h3>

<pre><code class="language-R">## Not run: 
set.seed(2)
P &lt;- rExamples1D(50, example = 'gaussian', noise.level = 0.1)
P.spline &lt;- pdSplineReg(P$P, P$P, lam = 0.5, Nd = 25)

## Examine matrix-component (1,1)
plot((1:50)/50, Re(P$P[1, 1, ]), type = "l", lty = 2) ## noisy observations
lines((1:25)/25, Re(P.spline$f[1, 1, ])) ## estimate
lines((1:50)/50, Re(P$f[1, 1, ]), col = 2, lty = 2) ## smooth target

## End(Not run)
</code></pre>


</div>