<div class="container">

<table style="width: 100%;"><tr>
<td>preseqR.rSAC.bootstrap</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>
Best practice for <code class="reqn">r</code>-SAC
</h2>

<h3>Description</h3>

<p><code class="reqn">preseqR.rSAC.bootstrap</code> predicts the expected number of species 
represented at least <code class="reqn">r</code> times in a random sample based on the initial sample.
</p>


<h3>Usage</h3>

<pre><code class="language-R">preseqR.rSAC.bootstrap(n, r=1, mt=20, size=SIZE.INIT, mu=MU.INIT, times=30,
                       conf=0.95)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>n</code></td>
<td>

<p>A two-column matrix.  
The first column is the frequency <code class="reqn">j = 1,2,\dots</code>; and the second column
is <code class="reqn">N_j</code>, the number of species with each species represented exactly <code class="reqn">j</code>
times in the initial sample. The first column must be sorted in an
ascending order.
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>r</code></td>
<td>

<p>A positive integer. Default is 1.
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>mt</code></td>
<td>

<p>An positive integer constraining possible rational function
approximations. Default is 20.
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>times</code></td>
<td>

<p>The number of bootstrap samples.
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>size</code></td>
<td>

<p>A positive double, the initial value of the parameter <code>size</code> in
the negative binomial distribution for the EM algorithm. Default value is 1.
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>mu</code></td>
<td>

<p>A positive double, the initial value of the parameter <code>mu</code> in the
negative binomial distribution for the EM algorithm. Default value is 0.5.
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>conf</code></td>
<td>

<p>The confidence level. Default is 0.95
</p>
</td>
</tr>
</table>
<h3>Details</h3>

<p>This is the bootstrap version of <code>preseqR.rSAC</code>. The bootstrap
sample is generated by randomly sampling the initial sample with replacement.
For each bootstrap sample, we construct an estimator. The median of
estimates is used as the prediction for the number of species
represented at least <code class="reqn">r</code> times in a random sample. 
</p>
<p>The confidence interval is constructed based on a lognormal distribution.
</p>


<h3>Value</h3>

<table>
<tr style="vertical-align: top;">
<td><code>f</code></td>
<td>

<p>The estimator for the <code class="reqn">r</code>-SAC. The input of the estimator is a vector of
sampling efforts <code class="reqn">t</code>, i.e., the relative sample sizes comparing with the initial
sample. For example, <code class="reqn">t = 2</code> means a random sample that is twice the size of
the initial sample.
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>se</code></td>
<td>

<p>The standard error for the estimator. The input is a vector of sampling 
efforts t.
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>lb</code></td>
<td>

<p>The lower bound of the confidence interval.The input is a vector of sampling 
efforts t.
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>ub</code></td>
<td>

<p>The upper bound of the confidence interval.The input is a vector of sampling 
efforts t.
</p>
</td>
</tr>
</table>
<h3>Author(s)</h3>

<p>Chao Deng
</p>


<h3>References</h3>

<p>Efron, B., &amp; Tibshirani, R. J. (1994). An introduction to the bootstrap. CRC press.
</p>
<p>Deng, C., Daley, T., Calabrese, P., Ren, J., &amp; Smith, A.D. (2016). Estimating
the number of species to attain sufficient representation in a random sample.
arXiv preprint arXiv:1607.02804v3.
</p>


<h3>Examples</h3>

<pre><code class="language-R">## load library
# library(preseqR)

## import data
# data(FisherButterfly)

## construct estimator for SAC
# estimator1 &lt;- preseqR.rSAC.bootstrap(FisherButterfly, r=1)
## The number of species represented at least once in a sample, 
## when the sample size is 10 or 20 times of the initial sample
# estimator1$f(c(10, 20))
## The standard error of the estiamtes
# estimator1$se(c(10, 20))
## The confidence interval of the estimates
# lb &lt;- estimator1$lb(c(10, 20))
# ub &lt;- estimator1$ub(c(10, 20))
# matrix(c(lb, ub), byrow=FALSE, ncol=2)

## construct estimator for r-SAC
# estimator2 &lt;- preseqR.rSAC.bootstrap(FisherButterfly, r=2)
## The number of species represented at least twice in a sample, 
## when the sample size is 50 or 100 times of the initial sample
# estimator2$f(c(50, 100))
## The standard error of the estiamtes
# estimator2$se(c(50, 100))
## The confidence interval of the estimates
# lb &lt;- estimator2$lb(c(50, 100))
# ub &lt;- estimator2$ub(c(50, 100))
# matrix(c(lb, ub), byrow=FALSE, ncol=2)
</code></pre>


</div>