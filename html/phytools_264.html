<div class="container">

<table style="width: 100%;"><tr>
<td>plotTree.wBars</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>Plot a tree with bars at the tips</h2>

<h3>Description</h3>

<p>Plots a phylogenetic tree with adjacent boxplot or barplot.
</p>


<h3>Usage</h3>

<pre><code class="language-R">plotTree.wBars(tree, x, scale=NULL, width=NULL, type="phylogram", 
    method="plotTree", tip.labels=FALSE, col="grey", border=NULL, 
    ...)
plotTree.barplot(tree, x, args.plotTree=list(), args.barplot=list(), 
    ...)
plotTree.boxplot(tree, x, args.plotTree=list(), args.boxplot=list(),
    ...)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>tree</code></td>
<td>
<p>an object of class <code>"phylo"</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>x</code></td>
<td>
<p>a named vector or matrix of trait values. For <code>plotTree.boxplot</code>, the names should repeat for multiple observations per species. For <code>plotTree.boxplot</code> <code>x</code> can also be supplied as a formula, though in that case the factor levels need to be provided in a valid cladewise order of the tips in <code>tree</code>. This order doesn't need to correspond with the current order of the tip labels. For <code>plotTree.barplot</code> <code>x</code> can be a matrix (or a data frame) in which columns are the values of multiple traits to be simultaneously plotted on the tree.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>scale</code></td>
<td>
<p>scaling factor for the tip bars (relative to the total tree height). If left as <code>NULL</code> a reasonable scaling factor is computed automatically.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>width</code></td>
<td>
<p>width of the tip bars.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>type</code></td>
<td>
<p>plot type. Can be <code>"phylogram"</code> or <code>"fan"</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>method</code></td>
<td>
<p>plotting method to use. Can be <code>"plotTree"</code> (for <code>plotTree</code>) or <code>"plotSimmap"</code> (for <code>plotSimmap</code>).</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>tip.labels</code></td>
<td>
<p>argument indicating whether or not tip labels should be plotted. Defaults to <code>tip.labels=FALSE</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>col</code></td>
<td>
<p>colors of the plotted bars. Can be a single value or a vector with length equal to the number of tips in the tree.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>border</code></td>
<td>
<p>single value specifying the color of the border for the plotted bars. Defaults to <code>border=NULL</code>, which means that black borders will be plotted.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>args.plotTree</code></td>
<td>
<p>in <code>plotTree.barplot</code>, arguments to be passed to <code>plotTree</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>args.barplot</code></td>
<td>
<p>in <code>plotTree.barplot</code>, arguments to be passed to <code>barplot</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>args.boxplot</code></td>
<td>
<p>in <code>plotTree.boxplot</code>, arguments to be passed to <code>boxplot</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>...</code></td>
<td>
<p>optional arguments to be passed to <code>plotTree</code> or <code>plotSimmap</code> in the case of <code>plotTree.wBars</code>. For <code>plotTree.barplot</code>, the only optional arguments are <code>add</code> and <code>ylim</code>. Generally <code>add</code> should not be used; however it can be employed to tell the function to draw the tree &amp; barplot, respectively, in the next two open plotting devices - rather than creating a table of figures in the current plotting device. <code>ylim</code> (which is also an optional argument for <code>plotTree.boxplot</code> should be supplied here rather than using <code>args.plotTree</code>, <code>args.boxplot</code>, or <code>args.barplot</code> because <em>y</em> axis limits must match exactly between the two plots.</p>
</td>
</tr>
</table>
<h3>Details</h3>

<p><code>plotTree.wbars</code> plots a phylogeny in phylogram or fan style with bars at the tips representing the values for a phenotypic trait.
</p>
<p><code>plotTree.barplot</code> creates a split plot in which a right-facing phylogram is on the left, and a bar plot is shown on the right.
</p>
<p><code>plotTree.boxplot</code> creates a split plot in which a right-facing phylogram is on the left, and a box plot is shown on the right.
</p>


<h3>Value</h3>

<p>Plots a tree with an associated bar plot for a continuously valued character at the tips.
</p>


<h3>Author(s)</h3>

<p>Liam Revell <a href="mailto:liam.revell@umb.edu">liam.revell@umb.edu</a></p>


<h3>References</h3>

<p>Revell, L. J. (2024) phytools 2.0: an updated R ecosystem for phylogenetic comparative methods (and other things). <em>PeerJ</em>, <b>12</b>, e16505.
</p>


<h3>See Also</h3>

<p><code>barplot</code>, <code>dotTree</code>, <code>plotSimmap</code>, <code>plotTree</code>
</p>


<h3>Examples</h3>

<pre><code class="language-R">## load data from Mahler et al. (2010)
data(anoletree)
data(anole.data)
## extract overall body size (SVL)
svl&lt;-setNames(anole.data$SVL,rownames(anole.data))
## plotTree.wBars
plotTree.wBars(anoletree,svl,type="fan",scal=0.5)
par(mar=c(5.1,4.1,4.1,2.1))
## plotTree.barplot
plotTree.barplot(anoletree,exp(svl),
    args.plotTree=list(fsize=0.5),
    args.barplot=list(xlab="SVL (mm)"))
	
## load vertebrate tree and data
data(vertebrate.tree)
data(vertebrate.data)
## plotTree.barplot
options(scipen=4) ## change sci-notation
par(cex.axis=0.8)
plotTree.barplot(vertebrate.tree,
    setNames(vertebrate.data$Mass,
    rownames(vertebrate.data)),
    args.barplot=list(
    log="x",
    xlab="mass (kg)",
    xlim=c(0.01,500000),
    col=palette()[4]))
options(scipen=0)

## reset par to defaults
par(mfrow=c(1,1),mar=c(5.1,4.1,4.1,2.1),cex.axis=1)
</code></pre>


</div>