<div class="container">

<table style="width: 100%;"><tr>
<td>impute_dosages</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>Re-estimate marker dosages given IBD input estimated using a high error prior.</h2>

<h3>Description</h3>

<p>Function to correct marker dosage scores given a list of previously estimated IBD probabilities. This may
prove useful to correct genotyping errors. Running the <code>estimate_IBD</code> function with a high error prior will 
result in suppressed predictions of double recombination events, associated with genotyping errors. By forcing the HMM to penalise 
double recombinations heavily, a smoothed haplotype landscape is achieved in which individual genotype observations are down-weighted. 
This smoothed output is then used to re-estimate marker dosages, dependent on (correct) parental scores. 
An alternative strategy is to use the function <code>maxL_IBD</code> over a range of error priors first, and use the resulting <code>$maxL_IBD</code> output 
as input here (as the <code>IBD_list</code>). In this case, set the argument <code>min_error_prior</code> to a low value (0.005 say) to avoid issues.
</p>


<h3>Usage</h3>

<pre><code class="language-R">impute_dosages(
  IBD_list,
  dosage_matrix,
  parent1 = "P1",
  parent2 = "P2",
  rounding_error = 0.05,
  min_error_prior = 0.1,
  verbose = TRUE
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>IBD_list</code></td>
<td>
<p>List of IBD probabilities</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>dosage_matrix</code></td>
<td>
<p>An integer matrix with markers in rows and individuals in columns. Note that probabilistic genotypes are not currently catered for here.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>parent1</code></td>
<td>
<p>The identifier of parent 1, by default "P1"</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>parent2</code></td>
<td>
<p>The identifier of parent 2, by default "P2"</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>rounding_error</code></td>
<td>
<p>The maximum deviation from an integer value that an inputed value can have, by default 0.05. For example, an imputed
score of 2.97 or 3.01 would both be rounded to a dosage of 3, while 2.87 would be deemed too far from an integer score, and would be made missing.
If you find the output contains too many missing values, a possibility would be to increase the <code>rounding_error</code>. However this may
also introduce more errors in the output!</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>min_error_prior</code></td>
<td>
<p>Suggestion for a suitably high error prior to be used in IBD calculations to ensure IBD smoothing is achieved. If IBD probabilities were estimated 
with a smaller error prior, the function aborts.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>verbose</code></td>
<td>
<p>Should messages be written to standard output?</p>
</td>
</tr>
</table>
<h3>Examples</h3>

<pre><code class="language-R">## Not run: 
# Toy example only, as this will result in an Error: the original error prior was too low
data("IBD_4x","SNP_dosages.4x")
impute_dosages(IBD_list=IBD_4x,dosage_matrix=SNP_dosages.4x)

## End(Not run)
</code></pre>


</div>