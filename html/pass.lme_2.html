<div class="container">

<table style="width: 100%;"><tr>
<td>pass.lme.CLb.test</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>Calculate Power or Sample Size required <br>
for Contrasts of linear combinations <br>
of fixed effect parameters <br>
in Linear Mixed Effect (LME) Model</h2>

<h3>Description</h3>

<p>Interested parameters/linear combinations LB from more than one
independent populations can be aggregrate togeter by
appending mu vertically and Sigma/n diagonally <br><br>
Consider Lb~N(MU,SIGMA) as the aggregrated estimates<br>
Any comparison of interested parameters can be formulated by
multiplying a contrast matrix C on LB and set <br><br>
H0: C*LB=d for any vector of value d to be tested <br><br>
We then have <br><br>
C*Lb~N(C*MU,C*SIGMA*C') <br><br>
and <br><br>
(C*Lb-d)'*inv(C*SIGMA*C')*(C*Lb-d)~chisq(q,lambda) <br><br>
where degree of freedom q=rank(C*SIGMA*C'), <br>
non-centrality parameter lambda=(C*LB-d)'*inv(C*SIGMA*C')*(C*LB-d) <br><br><br>
Power of the test H0 is given by 1-beta=P(chisq(q,lambda)&gt;qchisq(1-alpha,lambda)) <br>
Required sample size for desired power can be obtained by bisection method.
</p>


<h3>Usage</h3>

<pre><code class="language-R">pass.lme.CLb.test(thetas, C = NULL, d = NULL, alpha = 0.05,
  power = NULL, n = NULL)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>thetas</code></td>
<td>
<p>list of theta (LB and VLb), can be different for each group <br><br></p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>C</code></td>
<td>
<p>Contrast of Matrix <br><br></p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>d</code></td>
<td>
<p>Value vector to be tested for all contrast <br><br></p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>alpha</code></td>
<td>
<p>significant level <br><br></p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>power</code></td>
<td>
<p>desired power for sample size calculation <br><br></p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>n</code></td>
<td>
<p>sample size for power calculation / <br>
or sample size ratio with power for sample size calculation
(NULL for balanced design) <br><br></p>
</td>
</tr>
</table>
<h3>Details</h3>

<p><a href="https://drive.google.com/open?id=1MQvzp9na-Zm9mFT5jC1I_3U0JHEFky_k">Technical note</a>
</p>


<h3>Value</h3>

<p>solved.power  given sample size n, this gives the power for testing H0 <br>
solved.n      given the desired power, this gives the sample size for H0 <br></p>


<h3>Note</h3>

<p>License: GPL-3
</p>


<h3>Author(s)</h3>

<p>Marco Chak Yan YU <br>
Maintainer: Marco Chak Yan YU &lt;marcocyyu@gmail.com&gt;
</p>


<h3>See Also</h3>

<p><code>lme.Lb.dist.theta</code>
</p>


<h3>Examples</h3>

<pre><code class="language-R">#Example 1 (test fixed effect coefficient 2=0) with power of 80%
# for 1-level LME model, with covariates X, Z: (1,t), t=1,2,3
# for both fixed and random effects, with fixed effect coefficients B: (100,-0.5),
# random effect variance D: (2 1;1 2), residual variance R: 0.2
B &lt;- matrix(c(100,-0.5),2,1)
D &lt;- matrix(c(2,1,1,2),2,2)
R &lt;- 0.2
X &lt;- cbind(rep(1,3),1:3)
Z &lt;- X
theta &lt;- lme.Lb.dist.theta(B,D,R,X,Z)
pass.lme.CLb.test(list(theta),alpha=0.05,power=0.8)
pass.lme.CLb.test(list(theta),alpha=0.05,n=66)

#Example 2 (compare two fixed effect coefficient 2) with power of 80%
# Consider above model as a control group model,
# with an independent treatment group with model same as the control
# except a different fixed effect coefficient 2 for treatment
# = fixed effect coefficient 2 for control x 0.7
theta2 &lt;- theta
theta2$mu &lt;- theta$mu *0.7
C &lt;- matrix(c(1,-1),1,2)
pass.lme.CLb.test(list(theta,theta2),C,alpha=0.05,power=0.8)
pass.lme.CLb.test(list(theta,theta2),C,alpha=0.05,n=1468)

#Example 3 (compare two fixed effect coefficient 2) with power of 80%
# with sample size ratio, control:treatment = 1:2
pass.lme.CLb.test(list(theta,theta2),C,alpha=0.05,power=0.8,n=c(1,2))
pass.lme.CLb.test(list(theta,theta2),C,alpha=0.05,n=c(1101,2202))

#Example 4 (repeated-measures ANOVA for comparing 3 group means) with power of 80%
# for 1-level LME model with mean for group 1, 2 and 3 are 100, 99, 102, respectively,
# each subject to be measured 2 times, with within-subject variance = 15, residual variance = 10
B &lt;- 100
D &lt;- 15
R &lt;- 10
X &lt;- matrix(1,2,1)
Z &lt;- X
theta &lt;- lme.Lb.dist.theta(B,D,R,X,Z)
theta2 &lt;- theta
theta3 &lt;- theta
theta2$mu &lt;- 99
theta3$mu &lt;- 102
C &lt;- rbind(c(1,-1,0),c(1,0,-1))
pass.lme.CLb.test(list(theta,theta2,theta3),C,alpha=0.05,power=0.8)
pass.lme.CLb.test(list(theta,theta2,theta3),C,alpha=0.05,n=41)
</code></pre>


</div>