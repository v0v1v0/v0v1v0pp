<div class="container">

<table style="width: 100%;"><tr>
<td>vcovHC.plm</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>Robust Covariance Matrix Estimators</h2>

<h3>Description</h3>

<p>Robust covariance matrix estimators <em>a la White</em> for panel
models.
</p>


<h3>Usage</h3>

<pre><code class="language-R">## S3 method for class 'plm'
vcovHC(
  x,
  method = c("arellano", "white1", "white2"),
  type = c("HC0", "sss", "HC1", "HC2", "HC3", "HC4"),
  cluster = c("group", "time"),
  ...
)

## S3 method for class 'pcce'
vcovHC(
  x,
  method = c("arellano", "white1", "white2"),
  type = c("HC0", "sss", "HC1", "HC2", "HC3", "HC4"),
  cluster = c("group", "time"),
  ...
)

## S3 method for class 'pgmm'
vcovHC(x, ...)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>x</code></td>
<td>
<p>an object of class <code>"plm"</code> which should be the result of a
random effects or a within model or a model of class <code>"pgmm"</code>
or an object of class <code>"pcce"</code>,</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>method</code></td>
<td>
<p>one of <code>"arellano"</code>, <code>"white1"</code>, <code>"white2"</code>,</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>type</code></td>
<td>
<p>the weighting scheme used, one of <code>"HC0"</code>, <code>"sss"</code>,
<code>"HC1"</code>, <code>"HC2"</code>, <code>"HC3"</code>, <code>"HC4"</code>, see Details,</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>cluster</code></td>
<td>
<p>one of <code>"group"</code>, <code>"time"</code>,</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>...</code></td>
<td>
<p>further arguments.</p>
</td>
</tr>
</table>
<h3>Details</h3>

<p><code>vcovHC</code> is a function for estimating a robust covariance matrix of
parameters for a fixed effects or random effects panel model
according to the White method
(White 1980, 1984; Arellano 1987). Observations may be
clustered by <code>"group"</code> (<code>"time"</code>) to account for serial
(cross-sectional) correlation.
</p>
<p>All types assume no intragroup (serial) correlation between errors
and allow for heteroskedasticity across groups (time periods). As
for the error covariance matrix of every single group of
observations, <code>"white1"</code> allows for general heteroskedasticity but
no serial (cross–sectional) correlation; <code>"white2"</code> is <code>"white1"</code>
restricted to a common variance inside every group (time period)
(see Greene 2003, Sec. 13.7.1-2, Greene 2012, Sec. 11.6.1-2

and Wooldridge 2002, Sec. 10.7.2); <code>"arellano"</code> (see

ibid. and the original ref. Arellano 1987) allows a fully general
structure w.r.t. heteroskedasticity and serial (cross–sectional)
correlation.
</p>
<p>Weighting schemes specified by <code>type</code> are analogous to those in
<code>sandwich::vcovHC()</code> in package <a href="https://CRAN.R-project.org/package=sandwich"><span class="pkg">sandwich</span></a> and are
justified theoretically (although in the context of the standard
linear model) by MacKinnon and White (1985) and
Cribari–Neto (2004)
(Zeileis 2004). <code>type = "sss"</code> employs the small sample
correction as used by Stata.
</p>
<p>The main use of <code>vcovHC</code> (and the other variance-covariance estimators
provided in the package <code>vcovBK</code>, <code>vcovNW</code>, <code>vcovDC</code>, <code>vcovSCC</code>) is to pass
it to plm's own functions like <code>summary</code>, <code>pwaldtest</code>, and <code>phtest</code> or
together with testing functions from the <code>lmtest</code> and <code>car</code> packages. All of
these typically allow passing the <code>vcov</code> or <code>vcov.</code> parameter either as a
matrix or as a function, e.g., for Wald–type testing: argument <code>vcov.</code> to
<code>coeftest()</code>, argument <code>vcov</code> to <code>waldtest()</code> and other methods in the
<a href="https://CRAN.R-project.org/package=lmtest"><span class="pkg">lmtest</span></a> package; and argument <code>vcov.</code> to
<code>linearHypothesis()</code> in the <a href="https://CRAN.R-project.org/package=car"><span class="pkg">car</span></a> package (see the
examples), see (see also Zeileis 2004), 4.1-2, and examples below.
</p>
<p>A special procedure for <code>pgmm</code> objects, proposed by
Windmeijer (2005), is also provided.
</p>


<h3>Value</h3>

<p>An object of class <code>"matrix"</code> containing the estimate of
the asymptotic covariance matrix of coefficients.
</p>


<h3>Note</h3>

<p>The function <code>pvcovHC</code> is deprecated. Use <code>vcovHC</code> for the
same functionality.
</p>


<h3>Author(s)</h3>

<p>Giovanni Millo &amp; Yves Croissant
</p>


<h3>References</h3>

<p>Arellano M (1987).
“Computing Robust Standard Errors for Within-groups Estimators.”
<em>Oxford bulletin of Economics and Statistics</em>, <b>49</b>(4), 431–434.
</p>
<p>Cribari–Neto F (2004).
“Asymptotic Inference Under Heteroskedasticity of Unknown Form.”
<em>Computational Statistics &amp; Data Analysis</em>, <b>45</b>, 215–233.
</p>
<p>Greene WH (2003).
<em>Econometric Analysis</em>, 5th edition.
Prentice Hall.
</p>
<p>Greene WH (2012).
<em>Econometric Analysis</em>, 7th edition.
Prentice Hall.
</p>
<p>MacKinnon JG, White H (1985).
“Some Heteroskedasticity–Consistent Covariance Matrix Estimators With Improved Finite Sample Properties.”
<em>Journal of Econometrics</em>, <b>29</b>, 305–325.
</p>
<p>Windmeijer F (2005).
“A Finite Sample Correction for the Variance of Linear Efficient Two–Steps GMM Estimators.”
<em>Journal of Econometrics</em>, <b>126</b>, 25–51.
</p>
<p>White H (1984).
<em>Asymptotic Theory for Econometricians</em>.
New York: Academic press.
chap. 6
</p>
<p>White H (1980).
“A heteroskedasticity-consistent covariance matrix estimator and a direct test for heteroskedasticity.”
<em>Econometrica</em>, <b>48</b>(4), 817–838.
</p>
<p>Wooldridge JM (2002).
<em>Econometric Analysis of Cross–Section and Panel Data</em>.
MIT Press.
</p>
<p>Zeileis A (2004).
“Econometric Computing With HC and HAC Covariance Matrix Estimators.”
<em>Journal of Statistical Software</em>, <b>11</b>(10), 1–17.
<a href="https://www.jstatsoft.org/article/view/v011i10">https://www.jstatsoft.org/article/view/v011i10</a>.
</p>


<h3>See Also</h3>

<p><code>sandwich::vcovHC()</code> from the <a href="https://CRAN.R-project.org/package=sandwich"><span class="pkg">sandwich</span></a>
package for weighting schemes (<code>type</code> argument).
</p>


<h3>Examples</h3>

<pre><code class="language-R">
data("Produc", package = "plm")
zz &lt;- plm(log(gsp) ~ log(pcap) + log(pc) + log(emp) + unemp,
          data = Produc, model = "random")
## as function input to plm's summary method (with and without additional arguments):
summary(zz, vcov = vcovHC)
summary(zz, vcov = function(x) vcovHC(x, method="arellano", type="HC1"))

## standard coefficient significance test
library(lmtest)
coeftest(zz)
## robust significance test, cluster by group
## (robust vs. serial correlation)
coeftest(zz, vcov.=vcovHC)
## idem with parameters, pass vcov as a function argument
coeftest(zz, vcov.=function(x) vcovHC(x, method="arellano", type="HC1"))
## idem, cluster by time period
## (robust vs. cross-sectional correlation)
coeftest(zz, vcov.=function(x) vcovHC(x, method="arellano",
 type="HC1", cluster="group"))
## idem with parameters, pass vcov as a matrix argument
coeftest(zz, vcov.=vcovHC(zz, method="arellano", type="HC1"))
## joint restriction test
waldtest(zz, update(zz, .~.-log(emp)-unemp), vcov=vcovHC)
## Not run: 
## test of hyp.: 2*log(pc)=log(emp)
library(car)
linearHypothesis(zz, "2*log(pc)=log(emp)", vcov.=vcovHC)

## End(Not run)
## Robust inference for CCE models
data("Produc", package = "plm")
ccepmod &lt;- pcce(log(gsp) ~ log(pcap) + log(pc) + log(emp) + unemp, data = Produc, model="p")
summary(ccepmod, vcov = vcovHC)

## Robust inference for GMM models
data("EmplUK", package="plm")
ar &lt;- pgmm(log(emp) ~ lag(log(emp), 1:2) + lag(log(wage), 0:1)
           + log(capital) + lag(log(capital), 2) + log(output)
           + lag(log(output),2) | lag(log(emp), 2:99),
            data = EmplUK, effect = "twoways", model = "twosteps")
rv &lt;- vcovHC(ar)
mtest(ar, order = 2, vcov = rv)
</code></pre>


</div>