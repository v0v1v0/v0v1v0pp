<div class="container">

<table style="width: 100%;"><tr>
<td>powerOneWayTests</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>Power Simulation for One-Factorial Single Hypothesis Tests</h2>

<h3>Description</h3>

<p>Performs power simulation for one-factorial
single hypothesis tests.
</p>


<h3>Usage</h3>

<pre><code class="language-R">powerOneWayTests(
  mu,
  n = 10,
  errfn = c("Normal", "Lognormal", "Exponential", "Chisquare", "TDist", "Cauchy",
    "Weibull"),
  parms = list(mean = 0, sd = 1),
  test = c("kruskalTest", "leTest", "vanWaerdenTest", "normalScoresTest", "spearmanTest",
    "cuzickTest", "jonckheereTest", "johnsonTest", "oneway.test", "adKSampleTest",
    "bwsKSampleTest", "bwsTrendTest", "mackWolfeTest", "chackoTest", "flignerWolfeTest"),
  alternative = c("two.sided", "greater", "less"),
  var.equal = TRUE,
  dist = NULL,
  alpha = 0.05,
  FWER = TRUE,
  replicates = 1000,
  p = NULL
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>mu</code></td>
<td>
<p>numeric vector of group means.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>n</code></td>
<td>
<p>number of replicates per group. If <code>n</code> is a scalar, then
a balanced design is assumed. Otherwise, <code>n</code> must be a vector of same
length as <code>mu</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>errfn</code></td>
<td>
<p>the error function. Defaults to <code>"Normal"</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>parms</code></td>
<td>
<p>a list that denotes the arguments for the error function.
Defaults to <code>list(mean=0, sd=1)</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>test</code></td>
<td>
<p>the test for which the power analysis is
to be performed. Defaults to <code>"kwManyOneConoverTest"</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>alternative</code></td>
<td>
<p>the alternative hypothesis. Defaults to <code>"two.sided"</code>,
ignored if the selected error function does not use this argument.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>var.equal</code></td>
<td>
<p>a logical variable indicating whether to treat the variances
in the samples as equal.  <code>"TRUE"</code>, then a simple F test for
the equality of means in a one-way analysis of variance is
performed.  If <code>"FALSE"</code>, an approximate method of Welch (1951)
is used, which generalizes the commonly known 2-sample Welch
test to the case of arbitrarily many samples. Defaults to <code>"TRUE"</code>; only relevant,
if <code>test = "oneway.test"</code>, otherwise ignored.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>dist</code></td>
<td>
<p>the test distribution. Only relevant for
<code>kruskalTest</code>. Defaults's to <code>NULL</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>alpha</code></td>
<td>
<p>the nominal level of Type I Error.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>FWER</code></td>
<td>
<p>logical, indicates whether the family-wise error should be computed.
Defaults to <code>TRUE</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>replicates</code></td>
<td>
<p>the number of Monte Carlo replicates or runs. Defaults to <code>1000</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>p</code></td>
<td>
<p>the a-priori known peak as an ordinal number of the treatment
group including the zero dose level, i.e. <code class="reqn">p = \{1, \ldots, k\}</code>.
Defaults to <code>NULL</code>. Only relevant, if <code>"mackWolfeTest"</code> is selected.</p>
</td>
</tr>
</table>
<h3>Details</h3>

<p>The linear model of a one-way ANOVA can be written as:
</p>
<p style="text-align: center;"><code class="reqn">
X_{ij} = \mu_i + \epsilon_{ij}
</code>
</p>

<p>For each Monte Carlo run, the function simulates <code class="reqn">\epsilon_{ij}</code> based on the given error function and
the corresponding parameters. Then the specified test is performed.
Finally, Type I and Type II error rates are calculated.
</p>


<h3>Value</h3>

<p>An object with class <code>powerOneWayPMCMR</code>.
</p>


<h3>See Also</h3>

<p><code>powerMCTests</code>,
<code>pwr.anova.test</code>,
<code>power.anova.test</code>
</p>


<h3>Examples</h3>

<pre><code class="language-R">## Not run: 
set.seed(12)
mu &lt;- c(0, 0, 1, 2)
n &lt;- c(5, 4, 5, 5)
parms &lt;- list(mean=0, sd=1)
powerOneWayTests(mu, n, parms, test = "cuzickTest",
alternative = "two.sided", replicates = 1E4)

## Compare power estimation for
## one-way ANOVA with balanced design
## as given by functions
## power.anova.test, pwr.anova.test
## and powerOneWayTest

groupmeans &lt;- c(120, 130, 140, 150)
SEsq &lt;- 500  # within-variance
n &lt;- 10
k &lt;- length(groupmeans)
df &lt;- n * k - k
SSQ.E &lt;- SEsq * df
SSQ.A &lt;- n * var(groupmeans) * (k - 1)
sd.errfn &lt;- sqrt(SSQ.E / (n * k - 1))
R2 &lt;- c("R-squared" = SSQ.A / (SSQ.A + SSQ.E))
cohensf &lt;- sqrt(R2 / (1 - R2))
names(cohensf) &lt;- "Cohens f"

## R stats power function
power.anova.test(groups = k,
                 between.var = var(groupmeans),
                 within.var = SEsq,
                 n = n)

## pwr power function
pwr.anova.test(k = k, n = n, f = cohensf, sig.level=0.05)

## this Monte-Carlo based estimation
set.seed(200)
powerOneWayTests(mu = groupmeans,
                 n = n,
                 parms = list(mean=0, sd=sd.errfn),
                 test = "oneway.test",
                 var.equal = TRUE,
                 replicates = 5E3)

## Compare with effect sizes
R2
cohensf


## End(Not run)

</code></pre>


</div>