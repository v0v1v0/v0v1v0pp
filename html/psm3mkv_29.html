<div class="container">

<table style="width: 100%;"><tr>
<td>vlookup</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>VLOOKUP function</h2>

<h3>Description</h3>

<p>Function to lookup values according to an index. Aims to behave similarly to VLOOKUP in Microsoft Excel, however several lookups can be made at once (<code>indexval</code> can be a vector) and interpolation is available where lookups are inexact (choice of 4 methods).
</p>


<h3>Usage</h3>

<pre><code class="language-R">vlookup(indexval, indexvec, valvec, method = "geom")
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>indexval</code></td>
<td>
<p>The index value to be looked-up (may be a vector of multiple values)</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>indexvec</code></td>
<td>
<p>The vector of indices to look-up within</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>valvec</code></td>
<td>
<p>The vector of values corresponding to the vector of indices</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>method</code></td>
<td>
<p>Method may be <code>floor</code>, <code>ceiling</code>, <code>arith</code> or <code>geom</code> (default).</p>
</td>
</tr>
</table>
<h3>Value</h3>

<p>Numeric value or vector, depending on the lookup/interpolation method chosen:
</p>

<ul>
<li> <p><code>floor</code>: Floor (minimum) value, where interpolation is required between measured values
</p>
</li>
<li> <p><code>ceiling</code>: Ceiling (maximum) value, where interpolation is required between measured values
</p>
</li>
<li> <p><code>arith</code>: Arithmetic mean, where interpolation is required between measured values
</p>
</li>
<li> <p><code>geom</code>: Geometric mean, where interpolation is required between measured values
</p>
</li>
</ul>
<h3>See Also</h3>

<p>HMDHFDplus::readHMDweb can be used to obtain lifetables from the Human Mortality Database
</p>


<h3>Examples</h3>

<pre><code class="language-R"># Suppose we have survival probabilities at times 0 to 20
times &lt;- 0:20
survival &lt;- 1-times*0.04
# We would like to look-up the survival probability at time 7
vlookup(7, times, survival)
# In this case, the floor, ceiling, arith and geom values are identical
# because survival time 7 is known, and no interpolation is necessary
vlookup(c(7, 7.5), times, survival)
# The second row of the returned tibble reveal different estimates of the survival at time 7.5.
# The values vary according to the interpolation method between
# observed survival values at times 7 and 8.
</code></pre>


</div>