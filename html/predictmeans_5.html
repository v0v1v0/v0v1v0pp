<div class="container">

<table style="width: 100%;"><tr>
<td>contrastmeans</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>Linear Contrast Tests for a Linear Model</h2>

<h3>Description</h3>

<p>Performs t-tests (or permuted t-tests) of specified contrasts for linear models 
obtained from functions <code>aov</code>, <code>lm</code>, <code>glm</code>, <code>gls</code>, <code>lme</code>, 
or <code>lmer</code>. 
</p>


<h3>Usage</h3>

<pre><code class="language-R">  contrastmeans(model, modelterm, ctrmatrix, ctrnames=NULL, adj="none", Df, permlist)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>model</code></td>
<td>

<p>Model object returned by <code>aov</code>, <code>lm</code>, <code>glm</code>, <code>gls</code>, <code>lme</code>, and <code>lmer</code>. 
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>modelterm</code></td>
<td>

<p>Name (in "quotes") for indicating which factor term's contrast to be calculated. 
The <code>modelterm</code> must be given exactly as it appears in the printed model, e.g. "A" or "A:B". 
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>ctrmatrix</code></td>
<td>

<p>A specified contrast matrix. If <code>ctrmatrix</code> is missing, the programe will ask user to enter it. 
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>ctrnames</code></td>
<td>
<p> Names of the specified contrasts, e.g. c("A vs D", "C vs B", ...) 
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>adj</code></td>
<td>
<p>   Name (in "quote") for indicating a method for adjusting p-values of pairwise comparisons. 
The choices are "none", "tukey", "holm", "hochberg", "hommel", "bonferroni", "BH", "BY" and "fdr". 
The default method is "none".
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>Df</code></td>
<td>
<p> A denominator degree of freedom for <code>modelterm</code>. (For <code>glmer</code> models 
the <code>Df</code> needs to be specified, while for the other models, <code>Df</code> is obtained from the fitted model automatically). 
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>permlist</code></td>
<td>
<p> A model parameter list containing <code>nsim</code> parameters produced by the function <code>permmodels</code>. When <code>permlist != NULL</code>, the option <code>Df</code> will be non-functional. This is a key 
option for the permutation test. 
</p>
</td>
</tr>
</table>
<h3>Value</h3>

<p>There are two components in the output which are
</p>
<table>
<tr style="vertical-align: top;">
<td><code>Table</code></td>
<td>
<p>A table showing t-test results for the specified linear contrasts.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>K</code></td>
<td>
<p>A contrast matrix.</p>
</td>
</tr>
</table>
<h3>Author(s)</h3>

<p>Dongwen Luo, Siva Ganesh and John Koolaard
</p>


<h3>References</h3>

<p>Torsten Hothorn, Frank Bretz and Peter Westfall (2008),
<em>Simultaneous Inference in General Parametric Models. Biometrical</em>, Journal 50(3), 346â€“363.
</p>


<h3>Examples</h3>

<pre><code class="language-R">library(predictmeans)
# ftable(xtabs(yield ~ Block+Variety+nitro, data=Oats))
Oats$nitro &lt;- factor(Oats$nitro)
fm &lt;- lme(yield ~ nitro*Variety, random=~1|Block/Variety, data=Oats)
# library(lme4)
# fm &lt;- lmer(yield ~ nitro*Variety+(1|Block/Variety), data=Oats)

## Not run: 
## The contrast has a contrast matrix as follows:
#     0:Golden Rain 0:Marvellous 0:Victory 
#[1,]            -1            0         1 
#[2,]             0            0         1 
#     0.2:Golden Rain 0.2:Marvellous 0.2:Victory 
#[1,]               0              0           0 
#[2,]               0              0           0 
#     0.4:Golden Rain  0.4:Marvellous 0.4:Victory
#[1,]               0               0           0
#[2,]               0              -1           0
#      0.6:Golden Rain 0.6:Marvellous 0.6:Victory
#[1,]                0              0           0
#[2,]                0              0           0

# 1. Enter above contrast matrix into a pop up window, then close the window
# contrastmeans(fm, "nitro:Variety")
 
# 2. Construct the contrast matrix directly
cm &lt;- rbind(c(-1, 0, 1, 0, 0, 0, 0, 0, 0, 0, 0, 0), 
            c(0, 0, 1, 0, 0, 0, 0, -1, 0, 0, 0, 0))
contrastmeans(fm, "nitro:Variety", ctrmatrix=cm)
</code></pre>


</div>