<div class="container">

<table style="width: 100%;"><tr>
<td>nearestNeighborDist</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>Nearest Neighbor Distances for Morphological Disparity Studies</h2>

<h3>Description</h3>

<p>This is a simple function for obtaining nearest neighbor distance
from a symmetric pair-wises distance matrix, assumed here to be 
dissimilarities between pairs of taxa. Per-species NND is returned
rather than a mean or other summary value.
</p>


<h3>Usage</h3>

<pre><code class="language-R">nearestNeighborDist(distMat)
</code></pre>


<h3>Arguments</h3>

<table><tr style="vertical-align: top;">
<td><code>distMat</code></td>
<td>
<p>A symmetric, square pair-wise distance matrix, assumed to be a dissimilarity
matrix with a diagonal that is either zero values, <code>NA</code> values, or a mixture of both.
Can be a 'dist' object rather than a numerical matrix.
Taxon labels can be applied to the rows and columns
(or as labels if a 'dist' object)
and will be used to name the resulting output.</p>
</td>
</tr></table>
<h3>Details</h3>

<p>This function is mainly included here for pedagogical (teaching) purposes.
NND is so simple to calculate, users are urged to write their own functions
for primary research purposes.
</p>
<p>Typically, the <em>mean</em> NND for a group is reported and used to compare different
groupings of taxa (such as different time intervals, or different clades). Bootstrapping
should be used to generate confidence intervals.
</p>


<h3>Value</h3>

<p>Returns a vector of the nearest neighbor distance for each unit (taxon) in the 
pair-wise distance matrix, named with the labels from the input distance matrix.
</p>


<h3>Author(s)</h3>

<p>David W. Bapst
</p>


<h3>References</h3>

<p>Bapst, D. W., P. C. Bullock, M. J. Melchin, H. D. Sheets, 
and C. E. Mitchell. 2012. Graptoloid diversity and disparity 
became decoupled during the Ordovician mass extinction. <em>Proceedings 
of the National Academy of Sciences</em> 109(9):3428-3433.
</p>
<p>Ciampaglio, C. N., M. Kemp, and D. W. McShea. 2001. Detecting 
changes in morphospace occupation patterns in the fossil record: 
characterization and analysis of measures of disparity. <em>Paleobiology</em>
27(4):695-715.
</p>
<p>Foote, M. 1990. Nearest-neighbor analysis of trilobite morphospace.
<em>Systematic Zoology</em> 39:371-382.
</p>


<h3>See Also</h3>

<p>For the example dataset used in examples, see <code>graptDisparity</code>
</p>


<h3>Examples</h3>

<pre><code class="language-R">#example using graptolite disparity data from Bapst et al. 2012

#load data
data(graptDisparity)

#calculate mean NND
NND &lt;- nearestNeighborDist(graptDistMat)
mean(NND)

#calculate NND for different groups

#group (clade/paraclade) coding
groupID &lt;- graptCharMatrix[,54]+1

groupNND &lt;- numeric(7)
names(groupNND) &lt;- c("Normalo.","Monogr.","Climaco.",
   "Dicrano.","Lasiogr.","Diplogr.","Retiol.")
for(i in unique(groupID)){
   groupNND[i] &lt;- mean(nearestNeighborDist(
      graptDistMat[groupID == i,groupID == i]))
   }
groupNND

#the paraphyletic Normalograptids that survived the HME are most clustered
   #but this looks at all the species at once
   #and doesn't look for the nearest *co-extant* neighbor!
   #need to bring in temporal info to test that

</code></pre>


</div>