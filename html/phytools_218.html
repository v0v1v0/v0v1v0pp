<div class="container">

<table style="width: 100%;"><tr>
<td>phyl.vcv</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>Compute evolutionary VCV matrix for a tree &amp; dataset</h2>

<h3>Description</h3>

<p>Internal function for <code>phyl.pca</code>.
</p>


<h3>Usage</h3>

<pre><code class="language-R">phyl.vcv(X, C, lambda)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>lambda</code></td>
<td>
<p>value for <code class="reqn">\lambda</code> transformation.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>X</code></td>
<td>
<p>data matrix.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>C</code></td>
<td>
<p>matrix containing the height above the root of each pair of species in the tree. Typically this will have been produced by calling <code>vcv.phylo</code>.</p>
</td>
</tr>
</table>
<h3>Details</h3>

<p>Primarily designed as an internal function for <code>phyl.pca</code>; <code>phyl.vcv</code> can be used to compute the phylogenetic trait variance-covariance matrix given a phylogenetic VCV, <code class="reqn">\lambda</code>, and a data matrix. 
</p>
<p>This function should not be confused with <code>vcv.phylo</code> in the <span class="pkg">ape</span> package (although one of the objects returned is the output of <code>vcv.phylo</code>).
</p>
<p>Note that prior to <span class="pkg">phytools</span> 2.1-0 the matrix <code>X</code> was not sorted to match the rows of <code>C</code> since that was assumed to have been done in the function calling <code>phyl.vcv</code> internally; however, I recently discovered that this had caused the function to be used incorrectly resulting in a paper correction. This is now fixed such that <code>X</code> is checked for row names and (if present) <code>C</code> is sorted to match the rows of <code>X</code>. Hopefully this does not cause any problems for other functions using <code>phyl.vcv</code>!
</p>


<h3>Value</h3>

<p>A list containing three elements, as follows: <code>C</code>, the matrix <code>vcv.phylo</code> transformed by <code>lambda</code>; <code>R</code>, the among trait variance-covariance matrix for the data in <code>X</code>; and <code>alpha</code>, a vector of ancestral states at the root node of the tree.
</p>


<h3>Author(s)</h3>

<p>Liam Revell <a href="mailto:liam.revell@umb.edu">liam.revell@umb.edu</a></p>


<h3>References</h3>

<p>Revell, L. J. (2024) phytools 2.0: an updated R ecosystem for phylogenetic comparative methods (and other things). <em>PeerJ</em>, <b>12</b>, e16505.
</p>


</div>