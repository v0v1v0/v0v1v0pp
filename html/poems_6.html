<div class="container">

<table style="width: 100%;"><tr>
<td>Generator</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>R6 class representing a dynamic attribute generator</h2>

<h3>Description</h3>

<p><code>R6</code> class representing a model that dynamically generates
attribute values (<em>outputs</em>) via reading data from files, running assigned
functions, generating sample distributions, or built-in functions (assigned as
<em>default</em> in inherited classes), using simulation sample parameters
(<em>inputs</em>).
</p>


<h3>Super classes</h3>

<p><code>poems::GenericClass</code> -&gt; <code>poems::GenericModel</code> -&gt; <code>poems::SpatialModel</code> -&gt; <code>Generator</code>
</p>


<h3>Public fields</h3>

<div class="r6-fields">

<dl>
<dt><code>attached</code></dt>
<dd>
<p>A list of dynamically attached attributes (name-value pairs).</p>
</dd>
</dl>
</div>


<h3>Active bindings</h3>

<div class="r6-active-bindings">

<dl>
<dt><code>model_attributes</code></dt>
<dd>
<p>A vector of model attribute names.</p>
</dd>
<dt><code>region</code></dt>
<dd>
<p>A <code>Region</code> (or inherited class) object specifying the study region.</p>
</dd>
<dt><code>coordinates</code></dt>
<dd>
<p>Data frame (or matrix) of X-Y population (WGS84) coordinates in longitude (degrees West) and latitude (degrees North) (get and set), or distance-based coordinates dynamically returned by region raster (get only).</p>
</dd>
<dt><code>description</code></dt>
<dd>
<p>A brief description of what the generator generates.</p>
</dd>
<dt><code>inputs</code></dt>
<dd>
<p>An array of input attribute names for the generator.</p>
</dd>
<dt><code>outputs</code></dt>
<dd>
<p>An array of output attribute names for the generator.</p>
</dd>
<dt><code>file_templates</code></dt>
<dd>
<p>A nested list of file template attributes.</p>
</dd>
<dt><code>function_templates</code></dt>
<dd>
<p>A nested list of function template attributes.</p>
</dd>
<dt><code>distribution_templates</code></dt>
<dd>
<p>A list of distribution template attributes.</p>
</dd>
<dt><code>uses_correlations</code></dt>
<dd>
<p>A boolean to indicate that a <code>SpatialCorrelation</code> (or inherited class) object is used for generating correlated random deviates.</p>
</dd>
<dt><code>spatial_correlation</code></dt>
<dd>
<p>A <code>SpatialCorrelation</code> (or inherited class) object for generating correlated random deviates.</p>
</dd>
<dt><code>temporal_correlation</code></dt>
<dd>
<p>Absolute correlation coefficient between simulation time steps for all grid cells (0-1; default = 1).</p>
</dd>
<dt><code>time_steps</code></dt>
<dd>
<p>Number of simulation time steps.</p>
</dd>
<dt><code>generate_rasters</code></dt>
<dd>
<p>Boolean to indicate if rasters should be generated (defaults to TRUE when region uses rasters).</p>
</dd>
<dt><code>decimals</code></dt>
<dd>
<p>Number of decimal places applied to generated data outputs (default: NULL = no rounding).</p>
</dd>
<dt><code>occupancy_mask</code></dt>
<dd>
<p>Optional binary mask array (matrix), data frame, or raster (stack) for generated (time-series) data outputs.</p>
</dd>
<dt><code>template_attached</code></dt>
<dd>
<p>A list of template-nested dynamically attached model attributes that are maintained via shallow or <em>new</em> cloning.</p>
</dd>
<dt><code>attribute_aliases</code></dt>
<dd>
<p>A list of alternative alias names for model attributes (form: <code>alias = "attribute"</code>) to be used with the set and get attributes methods.</p>
</dd>
<dt><code>generative_template</code></dt>
<dd>
<p>A nested <code>GenerativeTemplate</code> (or inherited class) object for model attributes that are maintained via shallow or <em>new</em> cloning.</p>
</dd>
<dt><code>generative_requirements</code></dt>
<dd>
<p>A list of attribute names and the template setting (<em>"file"</em>, <em>"function"</em>, or <em>"default"</em>) that is required to generate their values.</p>
</dd>
<dt><code>error_messages</code></dt>
<dd>
<p>A vector of error messages encountered when setting model attributes.</p>
</dd>
<dt><code>warning_messages</code></dt>
<dd>
<p>A vector of warning messages encountered when setting model attributes.</p>
</dd>
</dl>
</div>


<h3>Methods</h3>



<h4>Public methods</h4>


<ul>
<li> <p><a href="#method-Generator-new"><code>Generator$new()</code></a>
</p>
</li>
<li> <p><a href="#method-Generator-new_clone"><code>Generator$new_clone()</code></a>
</p>
</li>
<li> <p><a href="#method-Generator-get_attributes"><code>Generator$get_attributes()</code></a>
</p>
</li>
<li> <p><a href="#method-Generator-generate"><code>Generator$generate()</code></a>
</p>
</li>
<li> <p><a href="#method-Generator-add_file_template"><code>Generator$add_file_template()</code></a>
</p>
</li>
<li> <p><a href="#method-Generator-add_function_template"><code>Generator$add_function_template()</code></a>
</p>
</li>
<li> <p><a href="#method-Generator-add_distribution_template"><code>Generator$add_distribution_template()</code></a>
</p>
</li>
<li> <p><a href="#method-Generator-read_file"><code>Generator$read_file()</code></a>
</p>
</li>
<li> <p><a href="#method-Generator-run_function"><code>Generator$run_function()</code></a>
</p>
</li>
<li> <p><a href="#method-Generator-sample_distribution"><code>Generator$sample_distribution()</code></a>
</p>
</li>
<li> <p><a href="#method-Generator-add_generative_requirements"><code>Generator$add_generative_requirements()</code></a>
</p>
</li>
<li> <p><a href="#method-Generator-generative_requirements_satisfied"><code>Generator$generative_requirements_satisfied()</code></a>
</p>
</li>
<li> <p><a href="#method-Generator-clone"><code>Generator$clone()</code></a>
</p>
</li>
</ul>
<details open><summary>Inherited methods</summary><ul>
<li><span class="pkg-link" data-pkg="poems" data-topic="GenericModel" data-id="get_attribute"><a href="../../poems/html/GenericModel.html#method-GenericModel-get_attribute"><code>poems::GenericModel$get_attribute()</code></a></span></li>
<li><span class="pkg-link" data-pkg="poems" data-topic="GenericModel" data-id="get_attribute_aliases"><a href="../../poems/html/GenericModel.html#method-GenericModel-get_attribute_aliases"><code>poems::GenericModel$get_attribute_aliases()</code></a></span></li>
<li><span class="pkg-link" data-pkg="poems" data-topic="GenericModel" data-id="get_attribute_names"><a href="../../poems/html/GenericModel.html#method-GenericModel-get_attribute_names"><code>poems::GenericModel$get_attribute_names()</code></a></span></li>
<li><span class="pkg-link" data-pkg="poems" data-topic="GenericModel" data-id="set_attributes"><a href="../../poems/html/GenericModel.html#method-GenericModel-set_attributes"><code>poems::GenericModel$set_attributes()</code></a></span></li>
</ul></details><hr>
<a id="method-Generator-new"></a>



<h4>Method <code>new()</code>
</h4>

<p>Initialization method sets the generative template and requirements as well as any attributes passed via a <em>params</em> list or individually.
</p>


<h5>Usage</h5>

<div class="r"><pre>Generator$new(generative_template = NULL, generative_requirements = NULL, ...)</pre></div>



<h5>Arguments</h5>

<div class="arguments">

<dl>
<dt><code>generative_template</code></dt>
<dd>
<p>A <code>GenerativeTemplate</code> (or inherited class) object containing the file, function and/or distribution templates utilized (facilitates shallow cloning).</p>
</dd>
<dt><code>generative_requirements</code></dt>
<dd>
<p>A list of attribute names and the template setting ("file", "function", or "distribution") that is required to generate their values.</p>
</dd>
<dt><code>...</code></dt>
<dd>
<p>Parameters passed via a <em>params</em> list or individually.</p>
</dd>
</dl>
</div>


<hr>
<a id="method-Generator-new_clone"></a>



<h4>Method <code>new_clone()</code>
</h4>

<p>Creates a new (re-initialized) object of the current (inherited) object class with optionally passed parameters.
</p>


<h5>Usage</h5>

<div class="r"><pre>Generator$new_clone(...)</pre></div>



<h5>Arguments</h5>

<div class="arguments">

<dl>
<dt><code>...</code></dt>
<dd>
<p>Parameters passed via the inherited class constructor (defined in initialize and run via new).</p>
</dd>
</dl>
</div>



<h5>Returns</h5>

<p>New object of the current (inherited) class.
</p>


<hr>
<a id="method-Generator-get_attributes"></a>



<h4>Method <code>get_attributes()</code>
</h4>

<p>Returns a list of existing and template-generated values for selected attributes or attribute aliases (when array of parameter names provided), or all existing attributes (when no params).
</p>


<h5>Usage</h5>

<div class="r"><pre>Generator$get_attributes(params = NULL)</pre></div>



<h5>Arguments</h5>

<div class="arguments">

<dl>
<dt><code>params</code></dt>
<dd>
<p>Array of attribute names to return, including those to be template-generated (all when NULL).</p>
</dd>
</dl>
</div>



<h5>Returns</h5>

<p>List of selected or all attributes values.
</p>


<hr>
<a id="method-Generator-generate"></a>



<h4>Method <code>generate()</code>
</h4>

<p>Returns a list of generated output values (attributes) corresponding to the sample input values (attributes).
</p>


<h5>Usage</h5>

<div class="r"><pre>Generator$generate(input_values = list())</pre></div>



<h5>Arguments</h5>

<div class="arguments">

<dl>
<dt><code>input_values</code></dt>
<dd>
<p>List of sample input values for generator attributes.</p>
</dd>
</dl>
</div>



<h5>Returns</h5>

<p>List containing generated model output attributes and/or any error/warning messages.
</p>


<hr>
<a id="method-Generator-add_file_template"></a>



<h4>Method <code>add_file_template()</code>
</h4>

<p>Adds a file template for reading raster/RData(RDS)/CSV files for a given
model attribute.
</p>


<h5>Usage</h5>

<div class="r"><pre>Generator$add_file_template(
  param,
  path_template,
  path_params = c(),
  file_type = "GRD"
)</pre></div>



<h5>Arguments</h5>

<div class="arguments">

<dl>
<dt><code>param</code></dt>
<dd>
<p>Name of model attribute to be read from a file.</p>
</dd>
<dt><code>path_template</code></dt>
<dd>
<p>Template string for the file path with placeholders
(see <code>sprintf</code>) for simulation sample parameters.</p>
</dd>
<dt><code>path_params</code></dt>
<dd>
<p>Array of the names of the simulation sample
parameters to be substituted (in order) into the path template.</p>
</dd>
<dt><code>file_type</code></dt>
<dd>
<p>File type raster <em>"GRD"</em> (default), <em>"TIF"</em>,
<em>"RData/RDS"</em>, <em>"QS"</em>, or <em>"CSV"</em> to be read.</p>
</dd>
</dl>
</div>


<hr>
<a id="method-Generator-add_function_template"></a>



<h4>Method <code>add_function_template()</code>
</h4>

<p>Adds a function template for running a user-defined function to calculate a given model attribute.
</p>


<h5>Usage</h5>

<div class="r"><pre>Generator$add_function_template(param, function_def, call_params = c())</pre></div>



<h5>Arguments</h5>

<div class="arguments">

<dl>
<dt><code>param</code></dt>
<dd>
<p>Name of model attribute to be generated using a function.</p>
</dd>
<dt><code>function_def</code></dt>
<dd>
<p>Function definition (or path to the file containing the function) in form: <code>function(params)</code>, where <em>params</em> is a list passed to the function.</p>
</dd>
<dt><code>call_params</code></dt>
<dd>
<p>Array of the names of the model parameters/attributes to be passed into the function via a list: <em>params</em>.</p>
</dd>
</dl>
</div>


<hr>
<a id="method-Generator-add_distribution_template"></a>



<h4>Method <code>add_distribution_template()</code>
</h4>

<p>Adds a distribution template for generating a given model attribute via sampling a distribution.
</p>


<h5>Usage</h5>

<div class="r"><pre>Generator$add_distribution_template(
  param,
  distr_type = c("uniform", "normal", "lognormal", "beta", "triangular"),
  distr_params = list(),
  sample = NULL,
  random_seed = NULL,
  normalize_threshold = NULL
)</pre></div>



<h5>Arguments</h5>

<div class="arguments">

<dl>
<dt><code>param</code></dt>
<dd>
<p>Name of model attribute to be generated via sampling a distribution.</p>
</dd>
<dt><code>distr_type</code></dt>
<dd>
<p>Distribution type to sample from (uniform, normal, lognormal, beta or triangular).</p>
</dd>
<dt><code>distr_params</code></dt>
<dd>
<p>List of distribution parameters and their values or associated model attributes (uniform: lower, upper; normal: mean, sd; lognormal: meanlog, sdlog (or mean, sd); beta: alpha, beta (or mean, sd); triangular: lower, mode, upper).</p>
</dd>
<dt><code>sample</code></dt>
<dd>
<p>Model attribute(s) name(s) or values associated with single sample probabilities (0-1), or bounds as a vector (e.g. <code>sample = c("p_lower", "p_upper")</code>), or as a list (e.g. <code>sample = list(mid = "p", window = 0.2)</code> for bounds p +/- 0.1).</p>
</dd>
<dt><code>random_seed</code></dt>
<dd>
<p>Random seed utilized when sample probability is generated internally, via bounds, and/or correlated deviates.</p>
</dd>
<dt><code>normalize_threshold</code></dt>
<dd>
<p>Optional normalization threshold is utilized when generated values are to be normalized with a fixed upper limit/threshold.</p>
</dd>
</dl>
</div>


<hr>
<a id="method-Generator-read_file"></a>



<h4>Method <code>read_file()</code>
</h4>

<p>Reads and returns the value of a model attribute from a file using the corresponding file template and simulation sample parameters.
</p>


<h5>Usage</h5>

<div class="r"><pre>Generator$read_file(param)</pre></div>



<h5>Arguments</h5>

<div class="arguments">

<dl>
<dt><code>param</code></dt>
<dd>
<p>Name of model attribute to be read from the file.</p>
</dd>
</dl>
</div>



<h5>Returns</h5>

<p>Model attribute value read from a file.
</p>


<hr>
<a id="method-Generator-run_function"></a>



<h4>Method <code>run_function()</code>
</h4>

<p>Returns the calculated value of a model attribute using the corresponding function template and model simulation sample parameters.
</p>


<h5>Usage</h5>

<div class="r"><pre>Generator$run_function(param)</pre></div>



<h5>Arguments</h5>

<div class="arguments">

<dl>
<dt><code>param</code></dt>
<dd>
<p>Name of model attribute to be calculated using a function.</p>
</dd>
</dl>
</div>



<h5>Returns</h5>

<p>Model attribute value calculated using a function.
</p>


<hr>
<a id="method-Generator-sample_distribution"></a>



<h4>Method <code>sample_distribution()</code>
</h4>

<p>Returns the calculated value of a model attribute using the corresponding distribution template and simulation sample parameters.
</p>


<h5>Usage</h5>

<div class="r"><pre>Generator$sample_distribution(param)</pre></div>



<h5>Arguments</h5>

<div class="arguments">

<dl>
<dt><code>param</code></dt>
<dd>
<p>Name of model attribute to be calculated using a sampling distribution.</p>
</dd>
</dl>
</div>



<h5>Returns</h5>

<p>Model attribute value calculated via distribution sampling.
</p>


<hr>
<a id="method-Generator-add_generative_requirements"></a>



<h4>Method <code>add_generative_requirements()</code>
</h4>

<p>Adds attribute names and the template setting (<em>"file"</em>, <em>"function"</em> or <em>"distribution"</em>) that is required to generate their values (via a <em>params</em> list or individually).
</p>


<h5>Usage</h5>

<div class="r"><pre>Generator$add_generative_requirements(params = list(), ...)</pre></div>



<h5>Arguments</h5>

<div class="arguments">

<dl>
<dt><code>params</code></dt>
<dd>
<p>Parameters passed via a list (e.g. <code>params = list(attr1 = "file", attr2 = "function", attr3 = "distribution")</code>).</p>
</dd>
<dt><code>...</code></dt>
<dd>
<p>Parameters passed individually (e.g. <code>attr3 = "file"</code>).</p>
</dd>
</dl>
</div>


<hr>
<a id="method-Generator-generative_requirements_satisfied"></a>



<h4>Method <code>generative_requirements_satisfied()</code>
</h4>

<p>Returns a boolean to indicate that all the file, function and/or distribution template settings that are required for attribute generation are present.
</p>


<h5>Usage</h5>

<div class="r"><pre>Generator$generative_requirements_satisfied()</pre></div>



<h5>Returns</h5>

<p>Boolean to indicate that the required settings for attribute generation are present.
</p>


<hr>
<a id="method-Generator-clone"></a>



<h4>Method <code>clone()</code>
</h4>

<p>The objects of this class are cloneable with this method.
</p>


<h5>Usage</h5>

<div class="r"><pre>Generator$clone(deep = FALSE)</pre></div>



<h5>Arguments</h5>

<div class="arguments">

<dl>
<dt><code>deep</code></dt>
<dd>
<p>Whether to make a deep clone.</p>
</dd>
</dl>
</div>




<h3>Examples</h3>

<pre><code class="language-R"># U Island example region
coordinates &lt;- data.frame(
  x = rep(seq(177.01, 177.05, 0.01), 5),
  y = rep(seq(-18.01, -18.05, -0.01), each = 5)
)
coordinates &lt;- coordinates[c(7, 9, 12, 14, 17:19), ]
region &lt;- Region$new(coordinates = coordinates, use_raster = FALSE)
# Spatial correlation
spatial_correlation &lt;- SpatialCorrelation$new(
  region = region, correlation_amplitude = 0.6,
  correlation_breadth = 300
)
spatial_correlation$calculate_compact_decomposition(decimals = 4)
# Example habitat suitability in file
saveRDS(
  array(c(0.5, 0.3, 0.7, 0.9, 0.6, 0.7, 0.8), c(7, 5)),
  file.path(tempdir(), "hs_mean_1.RData")
)
# Generator
capacity_gen &lt;- Generator$new(
  description = "capacity",
  region = region,
  time_steps = 5,
  spatial_correlation = spatial_correlation,
  temporal_correlation = 0.9,
  hs_sd = 0.1, # template attached
  inputs = c("hs_file", "density_max", "initial_n"),
  outputs = c("initial_abundance", "carrying_capacity")
)
capacity_gen$add_generative_requirements(list(
  hs_mean = "file",
  hs_sample = "distribution",
  carrying_capacity = "function",
  initial_abundance = "function"
))
# File template for mean habitat suitability
capacity_gen$add_file_template("hs_mean",
  path_template = file.path(tempdir(), "hs_mean_%s.RData"),
  path_params = c("hs_file"), file_type = "RDS"
)
# Distribution template for sampling habitat suitability
capacity_gen$add_distribution_template("hs_sample",
  distr_type = "beta",
  distr_params = list(
    mean = "hs_mean",
    sd = "hs_sd"
  )
)
# Function templates for initial abundance and carrying capacity
capacity_gen$add_function_template("initial_abundance",
  function_def = function(params) {
    stats::rmultinom(1,
      size = params$initial_n,
      prob = params$hs_sample[, 1]
    )
  },
  call_params = c("initial_n", "hs_sample")
)
capacity_gen$add_function_template("carrying_capacity",
  function_def = function(params) {
    round(params$density_max * params$hs_sample)
  },
  call_params = c("density_max", "hs_sample")
)
# Generation
capacity_gen$generate(input_values = list(
  hs_file = 1,
  initial_n = 400,
  density_max = 100
))

</code></pre>


</div>