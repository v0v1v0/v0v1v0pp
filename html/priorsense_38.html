<div class="container">

<table style="width: 100%;"><tr>
<td>powerscale-sensitivity</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>Power-scaling sensitivity analysis</h2>

<h3>Description</h3>

<p>Calculates the prior/likelihood sensitivity based on power-scaling
perturbations. This is done using importance sampling (and
optionally moment matching).
</p>


<h3>Usage</h3>

<pre><code class="language-R">powerscale_sensitivity(x, ...)

## Default S3 method:
powerscale_sensitivity(
  x,
  variable = NULL,
  lower_alpha = 0.99,
  upper_alpha = 1.01,
  div_measure = "cjs_dist",
  measure_args = list(),
  component = c("prior", "likelihood"),
  sensitivity_threshold = 0.05,
  moment_match = FALSE,
  k_threshold = 0.5,
  resample = FALSE,
  transform = NULL,
  prediction = NULL,
  prior_selection = NULL,
  likelihood_selection = NULL,
  num_args = NULL,
  ...
)

## S3 method for class 'priorsense_data'
powerscale_sensitivity(
  x,
  variable = NULL,
  lower_alpha = 0.99,
  upper_alpha = 1.01,
  div_measure = "cjs_dist",
  measure_args = list(),
  component = c("prior", "likelihood"),
  sensitivity_threshold = 0.05,
  moment_match = FALSE,
  k_threshold = 0.5,
  resample = FALSE,
  transform = NULL,
  prediction = NULL,
  prior_selection = NULL,
  likelihood_selection = NULL,
  num_args = NULL,
  ...
)

## S3 method for class 'CmdStanFit'
powerscale_sensitivity(x, ...)

## S3 method for class 'stanfit'
powerscale_sensitivity(x, ...)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>x</code></td>
<td>
<p>Model fit object or priorsense_data object.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>...</code></td>
<td>
<p>Further arguments passed to functions.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>variable</code></td>
<td>
<p>Character vector of variables to check.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>lower_alpha</code></td>
<td>
<p>Lower alpha value for gradient calculation.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>upper_alpha</code></td>
<td>
<p>Upper alpha value for gradient calculation.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>div_measure</code></td>
<td>
<p>The divergence measure to use. The
following methods are implemented:
</p>

<ul>
<li> <p><code>"cjs_dist"</code>: Cumulative Jensen-Shannon distance. Default
method. See function <code>cjs_dist</code> for more details.
</p>
</li>
<li> <p><code>"js_dist"</code>: Jensen-Shannon distance.
</p>
</li>
<li> <p><code>"js_div"</code>: Jensen-Shannon divergence.
</p>
</li>
<li> <p><code>"hellinger_dist"</code>: Hellinger distance.
</p>
</li>
<li> <p><code>"kl_dist"</code>: Kullback-Leibler distance.
</p>
</li>
<li> <p><code>"kl_div"</code>: Kullback-Leibler divergence.
</p>
</li>
<li> <p><code>"ks_dist"</code>: Kolmogorov-Smirnov distance.
</p>
</li>
<li> <p><code>"hellinger_dist"</code>: Hellinger distance.
</p>
</li>
<li> <p><code>"ws_dist"</code>: Wassterstein distance (pass <code>measure_args = list(p = N)</code>)
for a different order, where N is the order.
</p>
</li>
</ul>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>measure_args</code></td>
<td>
<p>Named list of further arguments passed to divergence measure functions.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>component</code></td>
<td>
<p>Character vector specifying component(s) to scale
(default is both "prior" and "likelihood").</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>sensitivity_threshold</code></td>
<td>
<p>Threshold for flagging variable as
sensitive to power-scaling.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>moment_match</code></td>
<td>
<p>Logical; Indicate whether or not moment
matching should be performed. Can only be TRUE if <code>is_method</code> is
"psis".</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>k_threshold</code></td>
<td>
<p>Threshold value for Pareto k values above which
the moment matching algorithm is used. Default is 0.5.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>resample</code></td>
<td>
<p>Logical; Indicate whether or not draws should be
resampled based on calculated importance weights.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>transform</code></td>
<td>
<p>Indicate a transformation of posterior draws to
perform before sensitivity analysis. Either "scale" or "whiten".</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>prediction</code></td>
<td>
<p>Function taking the model fit and returning a
draws_df of predictions to be appended to the posterior draws</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>prior_selection</code></td>
<td>
<p>Numeric vector of prior partitions to include in power-scaling. Default is NULL, which takes all partitions.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>likelihood_selection</code></td>
<td>
<p>Numeric vector of likelihood partitions to include in power-scaling. Default is NULL, which takes all partitions.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>num_args</code></td>
<td>
<p>(named list) Optional arguments passed to
num() for pretty printing of summaries. Can be
controlled globally via the <code>posterior.num_args</code>
option.</p>
</td>
</tr>
</table>
<h3>Value</h3>

<p>Table of sensitivity values for each specified variable.
</p>


<h3>References</h3>

<p>Kallioinen, N., Paananen, T., Bürkner, P-C., Vehtari, A. (2023).
Detecting and diagnosing prior and likelihood sensitivity with
power-scaling perturbations.  <em>Statistics and
Computing</em>. 34(57).  <code>doi:10.1007/s11222-023-10366-5</code>
</p>
<p>Vehtari, A., Simpson, D., Gelman, A., Yao, Y., and Gabry,
J. (2024).  Pareto smoothed importance sampling. <em>Journal of
Machine Learning Research</em>. 25(72).
<code>https://jmlr.org/papers/v25/19-556.html</code>
</p>
<p>Paananen, T., Piironen, J., Bürkner, P-C., Vehtari, A. (2021).
Implicitly adaptive importance sampling.  <em>Statistics and
Computing</em>. 31(16).  <code>doi:10.1007/s11222-020-09982-2</code>
</p>


<h3>Examples</h3>

<pre><code class="language-R">ex &lt;- example_powerscale_model()
powerscale_sensitivity(ex$draws)
</code></pre>


</div>