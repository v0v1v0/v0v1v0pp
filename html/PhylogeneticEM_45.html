<div class="container">

<table style="width: 100%;"><tr>
<td>equivalent_shifts</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>Find all equivalent shifts allocations and values.</h2>

<h3>Description</h3>

<p><code>equivalent_shifts</code> computes the equivalent shifts positions and their
corresponding values, assuming an ultrametric tree.
</p>


<h3>Usage</h3>

<pre><code class="language-R">equivalent_shifts(
  phylo,
  params,
  T_tree = incidence.matrix(phylo),
  part.list = enumerate_tips_under_edges(phylo),
  times_shared = NULL
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>phylo</code></td>
<td>
<p>a phylogenetic tree, of class <code>phylo</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>params</code></td>
<td>
<p>an object of class <code>params_process</code>, result inference by
function <code>PhyloEM</code>, or constructed through function
<code>params_process</code></p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>T_tree</code></td>
<td>
<p>(optional) matrix of incidence of the tree, result of function 
<code>incidence.matrix</code></p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>part.list</code></td>
<td>
<p>(optional) list of partition of the tree, result of function
<code>enumerate_tips_under_edges</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>times_shared</code></td>
<td>
<p>(optional) a matrix, result of function
<code>compute_times_ca</code>.</p>
</td>
</tr>
</table>
<h3>Details</h3>

<p>This function is only valid for ultrametric trees, and for models: BM, OU with
fixed root or stationary root. It assumes that there are no homoplasies.
</p>


<h3>Value</h3>

<p>object of class <code>equivalent_shifts</code>, with entries:
</p>

<dl>
<dt>eq_shifts_edges</dt>
<dd>
<p>matrix of equivalent shifts</p>
</dd>
<dt>shifts_and_betas</dt>
<dd>
<p>matrix of corresponding shifts values</p>
</dd>
<dt>phylo</dt>
<dd>
<p>the entry phylogenetic tree</p>
</dd>
<dt>p</dt>
<dd>
<p>the dimension</p>
</dd>
</dl>
<h3>See Also</h3>

<p><code>plot.equivalent_shifts</code>,
<code>extract.equivalent_shifts</code>, <code>params_BM</code>, 
<code>params_OU</code>, <code>enumerate_parsimony</code>
</p>


<h3>Examples</h3>

<pre><code class="language-R">if (requireNamespace("TreeSim", quietly = TRUE)) {
  ## Simualte a tree
  set.seed(17920902)
  ntaxa = 20
  phylo &lt;- TreeSim::sim.bd.taxa.age(n = ntaxa, numbsim = 1, lambda = 0.1,
                                   mu = 0, age = 1, mrca = TRUE)[[1]]
  
  ## Define parameters (BM, fixed root)
  params &lt;- params_BM(p = 4, edges = c(6, 17, 31),
                     values = cbind(1:4, -(1:4), rep(1, 4)))
  ## Find equivalent solutions and plot them
  eq_shifts &lt;- equivalent_shifts(phylo, params)
  eq_shifts
  plot(eq_shifts)
  ## Extract the values
  # Shifts values for trait 2, for the three shifts (rows), and three solutions (columns)
  extract(eq_shifts, trait = 2, what = "shifts_values")
  # Root values for trait 4, for the tree solutions (columns)
  extract(eq_shifts, trait = 4, what = "root_values")
  ## Define parameters (OU, stationary root
  params &lt;- params_OU(p = 4, edges = c(6, 17, 31),
                     selection.strength = 0.1,
                     values = cbind(1:4, -(1:4), rep(1, 4)),
                     random = TRUE)
  ## Find equivalent solutions and plot them
  eq_shifts &lt;- equivalent_shifts(phylo, params)
  eq_shifts
  plot(eq_shifts)
  ## Extract the values
  # Shifts values for trait 2, for the three shifts (rows), and three solutions (columns)
  extract(eq_shifts, trait = 2, what = "shifts_values")
  # Root values for trait 4, for the three solutions (columns)
  extract(eq_shifts, trait = 4, what = "root_values")
}

</code></pre>


</div>