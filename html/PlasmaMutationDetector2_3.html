<div class="container">

<table style="width: 100%;"><tr>
<td>BuildCtrlErrorRate</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>function BuildCtrlErrorRate</h2>

<h3>Description</h3>

<p>Compute the SNV Position-Error Rates and INDEL Position-Error Rates from control samples (available in the control directory <code>ctrl.dir</code>).
This function requires MAF files, that will be automatically generated if not present in the specified control folder.
SNV PER is computed as the sum in control samples of SNV background counts / sum in control samples of depths where SNV background counts = depth - major allele count.
INDEL PER is computed as sum in control samples of INDEL background counts / sum in control samples of depths where INDEL background counts = sum of insertion and deletion counts.
</p>


<h3>Usage</h3>

<pre><code class="language-R">BuildCtrlErrorRate(
  ctrl.dir = "Plasma ctrl/",
  bai.ext = ".bai",
  pos_ranges.file = NULL,
  hotspot.file = NULL,
  cov.min = 5000,
  force = FALSE,
  output.dir = ctrl.dir,
  n.trim = 0
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>ctrl.dir, </code></td>
<td>
<p>char, foldername containing the control files (default 'Plasma ctrl/'). The typical folder hierarchy will consist of 'Plasma ctrl/rBAM'</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>bai.ext, </code></td>
<td>
<p>char, filename extension of the bai files (default '.bai')</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>pos_ranges.file, </code></td>
<td>
<p>char, name of the Rdata file containing the three variables <code>pos_ind</code>, <code>pos_snp</code> and <code>pos_ranges</code> as build by the function <code>PrepareLibrary</code>. Default NULL, use the position_ranges.rda provided, used for our analysis.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>hotspot.file, </code></td>
<td>
<p>char, name of the text file containing a list of the genomic positions of the hotspots (default NULL, read the provide hotspot.txt, see <code>hotspot</code>)</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>cov.min, </code></td>
<td>
<p>integer, minimal coverture to take into account a position (default 5000)</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>force, </code></td>
<td>
<p>boolean, (default FALSE) if TRUE force all computations to all files including already processed ones</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>output.dir, </code></td>
<td>
<p>char, name of the folder to save results (default <code>ctrl.dir</code>).</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>n.trim, </code></td>
<td>
<p>integer, number of base positions trimmed at the ends of each amplicon (default 8)</p>
</td>
</tr>
</table>
<h3>Value</h3>

<p>the number of processed files
</p>


<h3>Author(s)</h3>

<p>N. Pécuchet, P. Laurent-Puig, O. Nordgård and Y. Rozenholc
</p>


<h3>References</h3>

<p><em>Analysis of base-position error rate of next-generation sequencing to detect tumor mutations in circulating DNA</em> N. Pécuchet, Y. Rozenholc, E. Zonta, D. Pietraz, A. Didelot, P. Combe, L. Gibault, J-B. Bachet, V. Taly, E. Fabre, H. Blons and P. Laurent-Puig in <em>Clinical Chemistry</em>
</p>
<p><em>Novel hybridization- and tag-based error-corrected method for sensitive ctDNA mutation detection using ion semiconductor sequencing</em> Kjersti Tjensvoll, Morten Lapin, Bjørnar Gilje, Herish Garresori, Satu Oltedal, Rakel Brendsdal Forthun, Anders Molven, Yves Rozenholc and Oddmund Nordgård  in <em>Scientific Reports</em>
</p>


<h3>Examples</h3>

<pre><code class="language-R">## Not run: 
   ctrl.dir = system.file("extdata", "4test_only/ctrl/", package = "PlasmaMutationDetector2")
   if (substr(ctrl.dir,nchar(ctrl.dir),nchar(ctrl.dir))!='/')
     ctrl.dir = paste0(ctrl.dir,'/') # TO RUN UNDER WINDOWS
   BuildCtrlErrorRate(ctrl.dir,output.dir=paste0(tempdir(),'/'))
   
## End(Not run)

</code></pre>


</div>