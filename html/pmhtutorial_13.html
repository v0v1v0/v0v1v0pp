<div class="container">

<table style="width: 100%;"><tr>
<td>particleMetropolisHastingsSVmodelReparameterised</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>Particle Metropolis-Hastings algorithm for a stochastic volatility model
model</h2>

<h3>Description</h3>

<p>Estimates the parameter posterior for <code class="reqn">\theta=\{\mu,\phi,\sigma_v\}</code> in 
a stochastic volatility model of the form <code class="reqn">x_t = \mu + \phi ( x_{t-1} - 
\mu ) + \sigma_v v_t</code> and <code class="reqn">y_t = \exp(x_t/2) e_t</code>, where <code class="reqn">v_t</code> and 
<code class="reqn">e_t</code> denote independent standard Gaussian random variables, i.e. 
<code class="reqn">N(0,1)</code>. In this version of the PMH, we reparameterise the model and 
run the Markov chain on the  parameters <code class="reqn">\vartheta=\{\mu,\psi,
\varsigma\}</code>, where <code class="reqn">\phi=\tanh(\psi)</code> and <code class="reqn">sigma_v=\exp(\varsigma)</code>.
</p>


<h3>Usage</h3>

<pre><code class="language-R">particleMetropolisHastingsSVmodelReparameterised(y, initialTheta,
  noParticles, noIterations, stepSize)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>y</code></td>
<td>
<p>Observations from the model for <code class="reqn">t=1,...,T</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>initialTheta</code></td>
<td>
<p>An inital value for the parameters 
<code class="reqn">\theta=\{\mu,\phi,\sigma_v\}</code>. The mean of the log-volatility 
process is denoted <code class="reqn">\mu</code>. The persistence of the log-volatility 
process is denoted <code class="reqn">\phi</code>. The standard deviation of the 
log-volatility process is denoted <code class="reqn">\sigma_v</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>noParticles</code></td>
<td>
<p>The number of particles to use in the filter.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>noIterations</code></td>
<td>
<p>The number of iterations in the PMH algorithm.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>stepSize</code></td>
<td>
<p>The standard deviation of the Gaussian random walk proposal 
for <code class="reqn">\theta</code>.</p>
</td>
</tr>
</table>
<h3>Value</h3>

<p>The trace of the Markov chain exploring the posterior of <code class="reqn">\theta</code>.
</p>


<h3>Note</h3>

<p>See Section 5 in the reference for more details.
</p>


<h3>Author(s)</h3>

<p>Johan Dahlin <a href="mailto:uni@johandahlin.com">uni@johandahlin.com</a>
</p>


<h3>References</h3>

<p>Dahlin, J. &amp; Schon, T. B. "Getting Started with Particle 
Metropolis-Hastings for Inference in Nonlinear Dynamical Models." 
Journal of Statistical Software, Code Snippets,
88(2): 1â€“41, 2019.
</p>


<h3>Examples</h3>

<pre><code class="language-R">
## Not run: 
  # Get the data from Quandl
  library("Quandl")
  d &lt;- Quandl("NASDAQOMX/OMXS30", start_date="2012-01-02",
              end_date="2014-01-02", type="zoo")
  y &lt;- as.numeric(100 * diff(log(d$"Index Value")))

  # Estimate the marginal posterior for phi
  pmhOutput &lt;- particleMetropolisHastingsSVmodelReparameterised(
    y, initialTheta = c(0, 0.9, 0.2), noParticles=500,
    noIterations=1000, stepSize=diag(c(0.05, 0.0002, 0.002)))

  # Plot the estimate
  nbins &lt;- floor(sqrt(1000))
  par(mfrow=c(3, 1))
  hist(pmhOutput$theta[,1], breaks=nbins, main="", xlab=expression(mu),
    ylab="marginal posterior", freq=FALSE, col="#7570B3")
  hist(pmhOutput$theta[,2], breaks=nbins, main="", xlab=expression(phi),
    ylab="marginal posterior", freq=FALSE, col="#E7298A")
  hist(pmhOutput$theta[,3], breaks=nbins, main="",
    xlab=expression(sigma[v]), ylab="marginal posterior",
    freq=FALSE, col="#66A61E")

## End(Not run)
</code></pre>


</div>