<div class="container">

<table style="width: 100%;"><tr>
<td>NNLS_MF</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>Performs the non-negative matrix factorisation for given phytoplankton
pigments and pigment ratios, to attain an estimate of phytoplankton
class abundances.</h2>

<h3>Description</h3>

<p>Performs the non-negative matrix factorisation for given phytoplankton
pigments and pigment ratios, to attain an estimate of phytoplankton
class abundances.
</p>


<h3>Usage</h3>

<pre><code class="language-R">NNLS_MF(Fn, S, cm = NULL)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>Fn</code></td>
<td>
<p>Pigment to Chl a matrix</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>S</code></td>
<td>
<p>Sample data matrix â€“ a matrix of pigment samples</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>cm</code></td>
<td>
<p>Weights for each column</p>
</td>
</tr>
</table>
<h3>Value</h3>

<p>A list containing
</p>

<ol>
<li>
<p> The F matrix (pigment: Chl <em>a</em>) ratios
</p>
</li>
<li>
<p> The root mean square error (RMSE)
</p>
</li>
<li>
<p> The C matrix (class abundances for each group)
</p>
</li>
</ol>
<h3>Examples</h3>

<pre><code class="language-R">MC &lt;- Matrix_checks(Sm,Fm)
Snew &lt;- MC$Snew
Fnew &lt;- MC$Fnew
cm &lt;- Bounded_weights(Snew, weight.upper.bound = 30)
NNLS_MF(Fnew, Snew, cm)

</code></pre>


</div>