<div class="container">

<table style="width: 100%;"><tr>
<td>cv.bal.psa</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>Multiple Covariate Balance Assessment Plot</h2>

<h3>Description</h3>

<p>Provides a graphic that depicts covarite effect size differences between
treatment groups both before and after stratification.  Function will create
stata internally if desired, and returns numerical output used to create
graphic.
</p>


<h3>Usage</h3>

<pre><code class="language-R">cv.bal.psa(
  covariates,
  treatment,
  propensity,
  strata = NULL,
  int = NULL,
  tree = FALSE,
  minsize = 2,
  universal.psd = TRUE,
  trM = 0,
  absolute.es = TRUE,
  trt.value = NULL,
  use.trt.var = FALSE,
  verbose = FALSE,
  xlim = NULL,
  plot.strata = TRUE,
  ...
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>covariates</code></td>
<td>
<p>Dataframe of covariates.  Factors should be recoded using
<code>cv.trans.psa</code></p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>treatment</code></td>
<td>
<p>Binary vector or factor defining the two treatments</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>propensity</code></td>
<td>
<p>Vector of same length as <code>treatment</code> containing
estimated propensity scores.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>strata</code></td>
<td>
<p>Either a vector of same length as <code>treatment</code> of
predefined stratum number, or one integer <code>n</code> used to assign rows to
<code>n</code> strata <code>propensity</code> scores, each of approximately the same
number of cases. If relatively few unique propensity scores have been
defined (as from a classification tree) then the logical <code>tree</code> should
be set equal to <code>TRUE</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>int</code></td>
<td>
<p>Either a number <code>m</code> used to divide <code>[0,1]</code> into
<code>m</code> equal length subintervals, or a vector containing cut points
between 0 and 1 that define subintervals (perhaps as suggested by
loess.psa). In either case the subintervals define strata, for which sizes
can differ.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>tree</code></td>
<td>
<p>Logical, default <code>FALSE</code>.  If there are few unique
propensity scores, say from a recursively partitioned tree, then TRUE forces
strata to be defined by the unique propensity scores.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>minsize</code></td>
<td>
<p>Smallest allowable stratum-treatment size.  If violated, rows
in the stratum are removed.  User may wish to redefine strata.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>universal.psd</code></td>
<td>
<p>Logical, default = TRUE.  Forces standard deviations
used to be unadjusted for stratification.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>trM</code></td>
<td>
<p>Numeric, default = 0; passed to <code>mean</code> for trimming
purposes.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>absolute.es</code></td>
<td>
<p>Logical, default TRUE. If TRUE, graphic depicts absolute
values of all effect sizes.  Note that the adjusted effect size plotted is
the absolute value of weighted averages of the signed by-stratum effect size
values when <code>absolute.es</code> is TRUE.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>trt.value</code></td>
<td>
<p>Character string; if desired allows the name of an active
treatment to be given.  Should be a level (value) of the <code>treatment</code>
factor (vector).</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>use.trt.var</code></td>
<td>
<p>Logical, default FALSE.  If TRUE, uses just active
treatment standard deviations for effect size, as per a suggestion of Rubin
and Stuart (see reference below).</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>verbose</code></td>
<td>
<p>Logical, default FALSE.  Numerical output is returned
invisibly.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>xlim</code></td>
<td>
<p>Binary vector passed to plot for overriding default choices.
Default NULL.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>plot.strata</code></td>
<td>
<p>Logical, default TRUE.  Adds effect size values for
individual strata to graphic.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>...</code></td>
<td>
<p>Other graphical parameters passed to <code>plot</code>.</p>
</td>
</tr>
</table>
<h3>Details</h3>

<p>Effect sizes between treatments for each covariate are presented in one
graphic, both before and after stratification.
</p>


<h3>Value</h3>

<p>Graphic plots covariate balance before and after stratication on
propensity scores.  The default version (absolute.es = TRUE) plots the
absolute values of effect sizes for each stratum, though the overall
estimate is the weighted mean before taking the absolute values.  Numerical
output consists of seven addressable objects.  If <code>verbose</code> is FALSE
(default), output is not printed. </p>
<table>
<tr style="vertical-align: top;">
<td><code>original.strata</code></td>
<td>
<p>Matrix of
strata-treatment counts as originally input.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>strata.used</code></td>
<td>
<p>Matrix of
strata-treatment counts used in effectsize calculations after any
<code>minsize</code> reductions.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>mean.diff.strata.wtd</code></td>
<td>
<p>Matrix of strata by
covariate weighted (by strata size) average differences.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>mean.diff.unadj</code></td>
<td>
<p>Matrix of covariate effects sizes before
stratification.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>effect.sizes</code></td>
<td>
<p>Matrix of effect sizes by covariate and
statum.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>treatment.levels</code></td>
<td>
<p>Names of treatments.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>effects.strata.treatment</code></td>
<td>
<p>Matrix of standard deviations and
stratum-treatment covariate means used to calculate the
<code>effect.sizes</code>.</p>
</td>
</tr>
</table>
<h3>Author(s)</h3>

<p>Robert M. Pruzek <a href="mailto:RMPruzek@yahoo.com">RMPruzek@yahoo.com</a>
</p>
<p>James E. Helmreich <a href="mailto:James.Helmreich@Marist.edu">James.Helmreich@Marist.edu</a>
</p>
<p>KuangNan Xiong <a href="mailto:harryxkn@yahoo.com">harryxkn@yahoo.com</a>
</p>


<h3>References</h3>

<p>â€œMatching Methods for Causal Inference: A review and a look
forward." Forthcoming in Statistical Science.
</p>


<h3>See Also</h3>

<p><code>cv.bal.psa</code>, <code>loess.psa</code>,
<code>cstrata.psa</code>, <code>cv.trans.psa</code>
</p>


<h3>Examples</h3>

<pre><code class="language-R">
data(lindner)
attach(lindner)
lindner.ps &lt;- glm(abcix ~ stent + height + female +
      diabetic + acutemi + ejecfrac + ves1proc,
      data = lindner, family = binomial)
ps&lt;-lindner.ps$fitted
lindner.cv &lt;- lindner[,4:10]
cv.bal.psa(lindner.cv, abcix, ps, strata = 5)
cv.bal.psa(lindner.cv, abcix, ps, strata = 10)
cv.bal.psa(lindner.cv, abcix, ps, int = c(.2, .5, .6, .75, .8))

</code></pre>


</div>