<div class="container">

<table style="width: 100%;"><tr>
<td>lambdaOpt</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>Lambda calibration</h2>

<h3>Description</h3>

<p>Computes the optimal lambda calibration parameter used in the critical vector <code>criticalVector</code>.
</p>


<h3>Usage</h3>

<pre><code class="language-R">lambdaOpt(pvalues, family, alpha = 0.05, delta = 0, step.down = FALSE,
 max.step = 10, m = NULL)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>pvalues</code></td>
<td>
<p>Matrix of <code class="reqn">p</code>-values with dimensions <code class="reqn">m \times B</code> where <code class="reqn">m</code> is the number of variables 
and <code class="reqn">B</code> the number of permutations used instead of the data matrix <code>X</code>. Default to <code>NULL</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>family</code></td>
<td>
<p>String character. Name of the family confidence envelope to compute the critical vector 
from <code>"simes"</code>, <code>"aorc"</code>, <code>"beta"</code>, <code>"higher.criticism"</code>, and <code>"power"</code>.
Default to "simes".</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>alpha</code></td>
<td>
<p>Numeric value in '[0,1]'. <code class="reqn">\alpha</code> level to control the family-wise error rate. Default to 0.05.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>delta</code></td>
<td>
<p>Numeric value. <code class="reqn">\delta</code> value. Please see the reference below. Default to 0.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>step.down</code></td>
<td>
<p>Boolean value. Default to <code>FALSE</code> If you want to compute the lambda calibration parameter using the step-down approach put <code>TRUE</code>. Please see the reference below.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>max.step</code></td>
<td>
<p>Numeric value. Default to 10. Maximum number of steps for the step down approach, so useful when <code>step.down = TRUE</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>m</code></td>
<td>
<p>Numeric value. Number of hypotheses. Default to <code>NULL</code>.</p>
</td>
</tr>
</table>
<h3>Value</h3>

<p>Numeric value. <code class="reqn">\lambda</code> parameter estimate.
</p>


<h3>Author(s)</h3>

<p>Angela Andreella
</p>


<h3>References</h3>

<p>Andreella, A., Hemerik, J., Finos, L., Weeda, W., &amp; Goeman, J. (2023). Permutation-based true discovery proportions for functional magnetic resonance imaging cluster analysis. Statistics in Medicine, 42(14), 2311-2340.
</p>


<h3>See Also</h3>

<p><code>criticalVector</code>
</p>


<h3>Examples</h3>

<pre><code class="language-R">db &lt;- simulateData(pi0 = 0.8, m = 100, n = 20, rho = 0)
out &lt;- signTest(X = db)
pv &lt;- cbind(out$pv, out$pv_H0)
cv &lt;- lambdaOpt(pvalues = pv, family = "simes", alpha = 0.05)
</code></pre>


</div>