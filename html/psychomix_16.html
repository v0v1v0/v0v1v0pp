<div class="container">

<table style="width: 100%;"><tr>
<td>mptmix</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>Finite Mixtures of Multinomial Processing Tree Models</h2>

<h3>Description</h3>

<p>Fit finite mixtures of multinomial processing tree (MPT) models via maximum
likelihood with the EM algorithm.
</p>


<h3>Usage</h3>

<pre><code class="language-R">mptmix(formula, data, k, subset, weights,
          nrep = 3, cluster = NULL, control = NULL,
          verbose = TRUE, drop = TRUE, unique = FALSE, which = NULL,
          spec, treeid = NULL,
          optimargs = list(control = list(reltol =
            .Machine$double.eps^(1/1.2), maxit = 1000)), ...)

FLXMCmpt(formula = . ~ ., spec = NULL, treeid = NULL, optimargs = NULL, ...)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>formula</code></td>
<td>
<p>Symbolic description of the model (of type <code>y ~ 1</code>
or <code>y ~ x</code>).</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>data, subset</code></td>
<td>
<p>Arguments controlling formula processing.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>k</code></td>
<td>
<p>A vector of integers indicating the number of components of
the finite mixture; passed in turn to the <code>k</code> argument
of <code>stepFlexmix</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>weights</code></td>
<td>
<p>An optional vector of weights to be used in the fitting
process; passed in turn to the <code>weights</code> argument of
<code>flexmix</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>nrep</code></td>
<td>
<p>Number of runs of the EM algorithm.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>cluster</code></td>
<td>
<p>Either a matrix with <code>k</code> columns of initial
cluster membership probabilities for each observation; or a factor
or integer vector with the initial cluster assignments of
observations at the start of the EM algorithm. Default is random
assignment into <code>k</code> clusters.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>control</code></td>
<td>
<p>An object of class <code>"FLXcontrol"</code> or a named list;
controls the EM algorithm and passed in turn to the <code>control</code>
argument of <code>flexmix</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>verbose</code></td>
<td>
<p>A logical; if <code>TRUE</code> progress information is shown
for different starts of the EM algorithm.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>drop</code></td>
<td>
<p>A logical; if <code>TRUE</code> and <code>k</code> is of length 1,
then a single <code>mptmix</code> object is returned instead of a
<code>stepMPTmix</code> object.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>unique</code></td>
<td>
<p>A logical; if <code>TRUE</code>, then <code>unique()</code> is
called on the result; for details see
<code>stepFlexmix</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>which</code></td>
<td>
<p>number of model to get if <code>k</code> is a vector of
integers longer than one. If character, interpreted as
number of components or name of an information criterion.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>spec, treeid, optimargs</code></td>
<td>
<p>arguments for the MPT model passed on to
<code>mptmodel</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>...</code></td>
<td>
<p>Currently not used.</p>
</td>
</tr>
</table>
<h3>Details</h3>

<p>Internally <code>stepFlexmix</code>
is called with suitable arguments to fit the finite mixture model with
the EM algorithm.
</p>
<p><code>FLXMCmpt</code> is the <code>flexmix</code> driver for
MPT mixture models.
</p>
<p>The interface is designed along the same lines as <code>raschmix</code>
which is introduced in detail in Frick et al. (2012). However, the
<code>mptmix</code> function has not yet been fully tested and may change in
future versions.  
</p>
<p>The latent-class MPT model (Klauer, 2006) is equivalent to an MPT mixture
model without concomitant variables.
</p>
<p>MPT models are specified using the <code>mptspec</code> function. See the
documentation in the <span class="pkg">mpt</span> package for details.
</p>


<h3>Value</h3>

<p>Either an object of class <code>"mptmix"</code> containing the best model
with respect to the log-likelihood (if <code>k</code> is a scalar) or the
one selected according to <code>which</code> (if specified and <code>k</code> is a
vector of integers longer than 1) or an object of class
<code>"stepMPTmix"</code> (if <code>which</code> is not specified and <code>k</code> is a
vector of integers longer than 1).
</p>


<h3>References</h3>

<p>Frick, H., Strobl, C., Leisch, F., and Zeileis, A. (2012).
Flexible Rasch Mixture Models with Package psychomix.
<em>Journal of Statistical Software</em>, <b>48</b>(7), 1–25.
<a href="https://doi.org/10.18637/jss.v048.i07">doi:10.18637/jss.v048.i07</a>
</p>
<p>Klauer, K.C. (2006).
Hierarchical Multinomial Processing Tree Models: A Latent-Class Approach.
<em>Psychometrika</em>, <b>71</b>, 7–31.
<a href="https://doi.org/10.1007/s11336-004-1188-3">doi:10.1007/s11336-004-1188-3</a>
</p>


<h3>See Also</h3>

<p><code>flexmix</code>, <code>stepFlexmix</code>
</p>


<h3>Examples</h3>

<pre><code class="language-R">

## Data
data("PairClustering", package = "psychotools")
pc &lt;- reshape(PairClustering, timevar = "trial", idvar = "ID",
              direction = "wide")

## Latent-class MPT model (Klauer, 2006)
suppressWarnings(RNGversion("3.5.0"))
set.seed(1)
m &lt;- mptmix(as.matrix(pc[-1]) ~ 1, data = pc, k = 1:3,
            spec = mptspec("SR", .replicates = 2))
m1 &lt;- getModel(m, which = "BIC")

## Inspect results
summary(m1)
parameters(m1)
plot(m1)

library(lattice)
xyplot(m1)


</code></pre>


</div>