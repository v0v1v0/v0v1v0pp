<div class="container">

<table style="width: 100%;"><tr>
<td>pubbias_meta</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>Estimate publication bias-corrected meta-analysis</h2>

<h3>Description</h3>

<p>For a chosen ratio of publication probabilities, <code>selection_ratio</code>, estimates
a publication bias-corrected pooled point estimate and confidence interval
per Mathur and VanderWeele (2020). Model options include
fixed-effects (a.k.a. "common-effect"), robust independent, and robust
clustered specifications.
</p>


<h3>Usage</h3>

<pre><code class="language-R">pubbias_meta(
  yi,
  vi,
  sei,
  cluster = 1:length(yi),
  selection_ratio,
  selection_tails = 1,
  model_type = "robust",
  favor_positive = TRUE,
  alpha_select = 0.05,
  ci_level = 0.95,
  small = TRUE,
  return_worst_meta = FALSE
)

corrected_meta(
  yi,
  vi,
  eta,
  clustervar = 1:length(yi),
  model,
  selection.tails = 1,
  favor.positive,
  alpha.select = 0.05,
  CI.level = 0.95,
  small = TRUE
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>yi</code></td>
<td>
<p>A vector of point estimates to be meta-analyzed.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>vi</code></td>
<td>
<p>A vector of estimated variances (i.e., squared standard errors) for
the point estimates.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>sei</code></td>
<td>
<p>A vector of estimated standard errors for the point estimates.
(Only one of <code>vi</code> or <code>sei</code> needs to be specified).</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>cluster</code></td>
<td>
<p>Vector of the same length as the number of rows in the data,
indicating which cluster each study should be considered part of (defaults
to treating studies as independent; i.e., each study is in its own cluster).</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>selection_ratio</code></td>
<td>
<p>Ratio by which publication bias favors affirmative
studies (i.e., studies with p-values less than <code>alpha_select</code> and
estimates in the direction indicated by <code>favor_positive</code>).</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>selection_tails</code></td>
<td>
<p>1 (for one-tailed selection, recommended for its
conservatism) or 2 (for two-tailed selection).</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>model_type</code></td>
<td>
<p>"fixed" for fixed-effects (a.k.a. "common-effect") or
"robust" for robust random-effects.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>favor_positive</code></td>
<td>
<p><code>TRUE</code> if publication bias are
assumed to favor significant positive estimates; <code>FALSE</code> if assumed to
favor significant negative estimates.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>alpha_select</code></td>
<td>
<p>Alpha level at which an estimate's probability of being
favored by publication bias is assumed to change (i.e.,
the threshold at which study investigators, journal editors, etc., consider
an estimate to be significant).</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>ci_level</code></td>
<td>
<p>Confidence interval level (as proportion) for the corrected
point estimate. (The alpha level for inference on the corrected point
estimate will be calculated from <code>ci_level</code>.)</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>small</code></td>
<td>
<p>Should inference allow for a small meta-analysis? We recommend
always using <code>TRUE</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>return_worst_meta</code></td>
<td>
<p>Should the worst-case meta-analysis of only the
nonaffirmative studies be returned?</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>eta</code></td>
<td>
<p>(deprecated) see selection_ratio</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>clustervar</code></td>
<td>
<p>(deprecated) see cluster</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>model</code></td>
<td>
<p>(deprecated) see model_type</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>selection.tails</code></td>
<td>
<p>(deprecated) see selection_tails</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>favor.positive</code></td>
<td>
<p>(deprecated) see favor_positive</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>alpha.select</code></td>
<td>
<p>(deprecated) see alpha_select</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>CI.level</code></td>
<td>
<p>(deprecated) see ci_level</p>
</td>
</tr>
</table>
<h3>Details</h3>

<p>The <code>selection_ratio</code> represents the number of times more likely
affirmative studies (i.e., those with a "statistically significant" and
positive estimate) are to be published than nonaffirmative studies (i.e.,
those with a "nonsignificant" or negative estimate).
</p>
<p>If <code>favor_positive</code> is <code>FALSE</code>, such that publication bias is assumed to
favor negative rather than positive estimates, the signs of <code>yi</code> will be
reversed prior to performing analyses. The corrected estimate will be
reported based on the recoded signs rather than the original sign
convention.
</p>


<h3>Value</h3>

<p>An object of class <code>metabias::metabias()</code>, a list containing:
</p>

<dl>
<dt>data</dt>
<dd>
<p>A tibble with one row per study and the columns
<code>yi</code>, <code>yif</code>, <code>vi</code>, <code>affirm</code>, <code>cluster</code>.</p>
</dd>
<dt>values</dt>
<dd>
<p>A list with the elements <code>selection_ratio</code>, <code>selection_tails</code>, <code>model_type</code>, <code>favor_positive</code>, <code>alpha_select</code>, <code>ci_level</code>, <code>small</code>, <code>k</code>, <code>k_affirmative</code>, <code>k_nonaffirmative</code>.</p>
</dd>
<dt>stats</dt>
<dd>
<p>A tibble with the columns <code>model</code>, <code>estimate</code>, <code>se</code>, <code>ci_lower</code>, <code>ci_upper</code>, <code>p_value</code>.</p>
</dd>
<dt>fit</dt>
<dd>
<p>A list of fitted models, if any.</p>
</dd>
</dl>
<h3>References</h3>

<p>Mathur MB, VanderWeele TJ (2020).
“Sensitivity analysis for publication bias in meta-analyses.”
<em>Journal of the Royal Statistical Society: Series C (Applied Statistics)</em>, <b>69</b>(5), 1091–1119.
</p>


<h3>Examples</h3>

<pre><code class="language-R"># calculate effect sizes from example dataset in metafor
require(metafor)
dat &lt;- metafor::escalc(measure = "RR", ai = tpos, bi = tneg, ci = cpos,
                       di = cneg, data = dat.bcg)

# first fit fixed-effects model without any bias correction
# since the point estimate is negative here, we'll assume publication bias
# favors negative log-RRs rather than positive ones
metafor::rma(yi, vi, data = dat, method = "FE")

# warmup
# note that passing selection_ratio = 1 (no publication bias) yields the naive
# point estimate from rma above, which makes sense
meta &lt;- pubbias_meta(yi = dat$yi,
                     vi = dat$vi,
                     selection_ratio = 1,
                     model_type = "fixed",
                     favor_positive = FALSE)
summary(meta)

# assume a known selection ratio of 5
# i.e., affirmative results are 5x more likely to be published than
# nonaffirmative ones
meta &lt;- pubbias_meta(yi = dat$yi,
                     vi = dat$vi,
                     selection_ratio = 5,
                     model_type = "fixed",
                     favor_positive = FALSE)
summary(meta)

# same selection ratio, but now account for heterogeneity and clustering via
# robust specification
meta &lt;- pubbias_meta(yi = dat$yi,
                     vi = dat$vi,
                     cluster = dat$author,
                     selection_ratio = 5,
                     model_type = "robust",
                     favor_positive = FALSE)
summary(meta)

##### Make sensitivity plot as in Mathur &amp; VanderWeele (2020) #####
# range of parameters to try (more dense at the very small ones)
selection_ratios &lt;- c(200, 150, 100, 50, 40, 30, 20, seq(15, 1))

# compute estimate for each value of selection_ratio
estimates &lt;- lapply(selection_ratios, function(e) {
  pubbias_meta(yi = dat$yi, vi = dat$vi, cluster = dat$author,
               selection_ratio = e, model_type = "robust",
               favor_positive = FALSE)$stats
})
estimates &lt;- dplyr::bind_rows(estimates)
estimates$selection_ratio &lt;- selection_ratios

require(ggplot2)
ggplot(estimates, aes(x = selection_ratio, y = estimate)) +
  geom_ribbon(aes(ymin = ci_lower, ymax = ci_upper), fill = "gray") +
  geom_line(lwd = 1.2) +
  labs(x = bquote(eta), y = bquote(hat(mu)[eta])) +
  theme_classic()
</code></pre>


</div>