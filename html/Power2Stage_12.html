<div class="container">

<table style="width: 100%;"><tr>
<td>power.tsd.ssr</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>
Power of 2-stage BE studies in 2x2 crossover designs with interim
sample size re-estimation
</h2>

<h3>Description</h3>

<p>This function calculates the ‘empiric’ power (via simulations) of
2-stage BE studies with interim sample size re-estimation (<em>i.e.</em>,
but no BE decision after stage 1).
The sample size re-estimation can be done blinded or unblinded.
</p>


<h3>Usage</h3>

<pre><code class="language-R">power.tsd.ssr(alpha = 0.05, n1, GMR, CV, targetpower = 0.8,
              pmethod = c("nct", "exact", "shifted", "ls"), blind = FALSE,
              usePE = FALSE, min.n = 0, max.n = Inf, theta0, theta1, theta2,
              npct = c(0.05, 0.5, 0.95), nsims, setseed = TRUE, details = FALSE)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>alpha</code></td>
<td>

<p>Nominal type I error. Has to be adjusted in case of inflation of
the Type I Error.
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>n1</code></td>
<td>

<p>Sample size of stage 1.
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>GMR</code></td>
<td>

<p>Ratio T/R to be used in the sample size re-estimation.<br>
Defaults to 0.95 if missing.
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>CV</code></td>
<td>

<p>Coefficient of variation of the intra-subject variability
(use <em>e.g.</em>, 0.3 for 30%).<br>
Anticipated population value.
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>targetpower</code></td>
<td>

<p>Power to achieve in the sample size estimation step.
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>pmethod</code></td>
<td>

<p>Power calculation method to be used in the sample size re-estimation for
stage 2.<br>
Implemented are <code style="white-space: pre;">⁠"nct"⁠</code> (approximate calculations via non-central
<em>t</em>-distribution, <code style="white-space: pre;">⁠"exact"⁠</code> (exact calculations via Owen’s
Q), and <code style="white-space: pre;">⁠"shifted"⁠</code> (approximate calculation via shifted central
<em>t</em>-distribution.<br>
Also implemented is the large sample approximation as used in the references.<br>
Defaults to <code style="white-space: pre;">⁠"nct"⁠</code> as a reasonable compromise between speed and
accuracy in the sample size estimation step.
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>blind</code></td>
<td>

<p>If <code style="white-space: pre;">⁠TRUE⁠</code> the blinded estimate of the intra-subject variance, <em>i.e.</em>,
the estimate from the period differences, is used in sample size estimation.<br>
If <code style="white-space: pre;">⁠FALSE⁠</code> the usual <abbr><span class="acronym">MSE</span></abbr> from stage 1
is used.<br>
Defaults to <code style="white-space: pre;">⁠FALSE⁠</code> since most <abbr><span class="acronym">BE</span></abbr> studies are open.
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>usePE</code></td>
<td>

<p>If <code style="white-space: pre;">⁠TRUE⁠</code> the point estimate from the interim analysis is used in the
sample size re-estimation. Defaults to <code style="white-space: pre;">⁠FALSE⁠</code>.<br><code style="white-space: pre;">⁠usePE = TRUE⁠</code> doesn’t make sense if <code style="white-space: pre;">⁠blind = TRUE⁠</code>. In that
case the function issues a warning and <code style="white-space: pre;">⁠usePE⁠</code> is reset to <code style="white-space: pre;">⁠usePE = FALSE⁠</code>.
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>min.n</code></td>
<td>

<p>If <code style="white-space: pre;">⁠min.n&gt;n1⁠</code>, the re-estimated sample size (<code style="white-space: pre;">⁠N⁠</code>) is set to
<code style="white-space: pre;">⁠max(min.n,N)⁠</code>.<br>
If <code style="white-space: pre;">⁠min.n=0⁠</code> (the default), no minimal sample size is applied.
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>max.n</code></td>
<td>

<p>If <code style="white-space: pre;">⁠max.n⁠</code> is set to a finite value the re-estimated sample size (<code style="white-space: pre;">⁠N⁠</code>)
is set to <code style="white-space: pre;">⁠min(max.n,N)⁠</code>.<br>
Defaults to <code style="white-space: pre;">⁠Inf⁠</code> which is equivalent to not constrain the re-estimated
sample size.<br>
Attention! <code style="white-space: pre;">⁠max.n⁠</code> is here <b>not</b> a futility criterion like <code style="white-space: pre;">⁠Nmax⁠</code>
in other functions of this package.
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>theta0</code></td>
<td>

<p>Assumed ratio of geometric means (T/R) for simulations. If missing, defaults
to <code style="white-space: pre;">⁠GMR⁠</code>.
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>theta1</code></td>
<td>

<p>Lower bioequivalence limit. Defaults to 0.8.
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>theta2</code></td>
<td>

<p>Upper bioequivalence limit. Defaults to 1.25.
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>npct</code></td>
<td>

<p>Percentiles to be used for the presentation of the distribution of
<code style="white-space: pre;">⁠n(total)=n1+n2⁠</code>.<br>
Defaults to <code style="white-space: pre;">⁠c(0.05, 0.5, 0.95)⁠</code> to obtain the 5% and 95% percentiles
and the median.
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>nsims</code></td>
<td>

<p>Number of studies to simulate.<br>
If missing, <code style="white-space: pre;">⁠nsims⁠</code> is set to 1E+05 = 100,000 or to 1E+06 = 1 Mio if
estimating the empiric Type I Error (<code style="white-space: pre;">⁠'alpha'⁠</code>), <em>i.e.</em>, with <code style="white-space: pre;">⁠theta0⁠</code>
at the border or outside the acceptance range <code style="white-space: pre;">⁠theta1⁠</code> ... <code style="white-space: pre;">⁠theta2⁠</code>.
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>setseed</code></td>
<td>

<p>Simulations are dependent on the starting point of the (pseudo) random number
generator. To avoid differences in power for different runs a
<code>set.seed(1234567)</code> is issued if <code style="white-space: pre;">⁠setseed=TRUE⁠</code>, the default.<br>
Set this argument to <code style="white-space: pre;">⁠FALSE⁠</code> to view the variation in power between
different runs.
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>details</code></td>
<td>

<p>If set to <code style="white-space: pre;">⁠TRUE⁠</code> the function prints the results of time measurements
of the simulation steps. Defaults to <code style="white-space: pre;">⁠FALSE⁠</code>.
</p>
</td>
</tr>
</table>
<h3>Details</h3>

<p>The calculations follow in principle the simulations as described in Potvin
<em>et al</em>.<br>
The underlying subject data are assumed to be evaluated after log-transformation.
But instead of simulating subject data, the statistics pe1, mse1 and pe2, SS2 are
simulated via their associated distributions (normal and
χ<sup>2</sup> distributions).
</p>


<h3>Value</h3>

<p>Returns an object of class class <code style="white-space: pre;">⁠"pwrtsd"⁠</code> with all the input arguments and results
as components.<br>
The class class <code style="white-space: pre;">⁠"pwrtsd"⁠</code> has a S3 print method.<br>
The results are in the components:
</p>
<table>
<tr style="vertical-align: top;">
<td><code>pBE</code></td>
<td>
<p>Fraction of studies found BE.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>pct_s2</code></td>
<td>
<p>Percentage of studies continuing to stage 2.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>nmean</code></td>
<td>
<p>Mean of n(total).</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>nrange</code></td>
<td>
<p>Range (min, max) of n(total).</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>nperc</code></td>
<td>
<p>Percentiles of the distribution of n(total).</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>ntable</code></td>
<td>
<p>Object of class <code style="white-space: pre;">⁠"table"⁠</code> summarizing the discrete distribution of
n(total) via its unique values and counts of occurences of these values.<br>
ntable is only given back if <code style="white-space: pre;">⁠usePE = FALSE⁠</code></p>
</td>
</tr>
</table>
<h3>Note</h3>

<p>The computation time is in the magnitude of a few seconds for 100,000 sim’s
on my machine (Intel core i7 2.5 GHz, 12GB RAM) if the non-central <em>t</em>
approximation is used. Thus be a bit patient if you simulate for the Tpye I Error
'alpha' with 1 Mio sim’s.<br>
Using the crude <code style="white-space: pre;">⁠pmethod="ls"⁠</code> on the other hand results in a nearly immediate
sample size re-estimation.
</p>


<h3>Author(s)</h3>

<p>D. Labes
</p>


<h3>References</h3>

<p>Golkowski D, Friede T, Kieser M. <em>Blinded sample size re-estimation in crossover bioequivalence trials.</em><br>
Pharm Stat. 2014; 13(3):157–62. doi: <a href="https://doi.org/10.1002/pst.1617">10.1002/pst.1617</a>
</p>
<p>Jones B, Kenward MG. <em>Design and Analysis of Cross-Over Trials.</em><br>
Boca Raton: CRC Press; 3<sup>rd</sup> edition 2014. Chapter 12.
</p>
<p>Potvin D, DiLiberti CE, Hauck WW, Parr AF, Schuirmann DJ, Smith RA. <em>Sequential design approaches for bioequivalence studies with crossover designs.</em><br>
Pharm Stat. 2008; 7(4):245–62. doi: <a href="https://doi.org/10.1002/pst.294">10.1002/pst.294</a>
</p>


<h3>See Also</h3>

<p><code>power.tsd</code> for 2-stage studies with interim BE decision.
</p>


<h3>Examples</h3>

<pre><code class="language-R"># Not run to comply with CRAN policy about examples' run-time;
# minimum number of sim's should be 1E5 for 'power', 1E6 sim's for 'alpha'
## Not run: 
power.tsd.ssr(alpha=0.05, n1=10, GMR=1, CV=0.239, targetpower=0.9,
              pmethod="ls", blind=TRUE, theta0=1.25)
# should give an alpha-inflation 0.072359 (run time &lt;5 seconds)
# repeated with noncentral t-approximation
power.tsd.ssr(alpha=0.05, n1=10, GMR=1, CV=0.239, targetpower=0.9,
              pmethod="nct", blind=TRUE, theta0=1.25)
# should give an alpha-inflation 0.069789 (run time ~20 seconds)
#
# adjusted alpha to control the Type I Error, noncentral t-approx.
power.tsd.ssr(alpha=0.03505, n1=10, GMR=1, CV=0.239, targetpower=0.9,
              pmethod="nct", blind=TRUE, theta0=1.25)
# should control the TIE with 0.049877
## End(Not run)
</code></pre>


</div>