<div class="container">

<table style="width: 100%;"><tr>
<td>phylobuilder</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>Create a subtree with largest overlap from a species list.</h2>

<h3>Description</h3>

<p>phylobuilder creates a subtree with largest overlap from a species list.
If species in the species list are not already in the tip label, species will
be added at the most recent common ancestor at the genus or family level when
possible.
</p>


<h3>Usage</h3>

<pre><code class="language-R">phylobuilder(species, tree, extract = TRUE)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>species</code></td>
<td>
<p>A vector or matrix containing a species list</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>tree</code></td>
<td>
<p>a phylogenetic tree (object of class phylo)</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>extract</code></td>
<td>
<p>extract the species in the list after trying to  add missing
labels to the tree. If FALSE phylobuilder adds only the taxa in the list.</p>
</td>
</tr>
</table>
<h3>Value</h3>

<p><code>phylobuilder</code> returns a phylogenetic tree, i.e. an object of
class <code>phylo</code>.
</p>


<h3>See Also</h3>

<p><code>add.tips</code>, <code>label2table</code>,
<code>stripLabel</code>
</p>


<h3>Examples</h3>

<pre><code class="language-R">library(ape)
txt &lt;- "(((((Panthera_leo,Panthera_pardus), Panthera_onca),(Panthera_uncia,
  (Panthera_tigris_altaica, Panthera_tigris_amoyensis)))Panthera)Felidae,
  (((((((Canis_lupus,Canis_lupus_familiaris),Canis_latrans),Canis_anthus),
  Canis_aureus),Lycaon_pictus),(Canis_adustus,Canis_mesomelas))Canis)
  Canidae)Carnivora;"
txt &lt;- gsub("[[:space:]]", "", txt)
cats_and_dogs &lt;- read.tree(text=txt)
plot(cats_and_dogs, node.depth=2, direction="downwards")
nodelabels(cats_and_dogs$node.label, frame="none", adj = c(0.5, 0))

tree &lt;- drop.tip(cats_and_dogs, c("Panthera_uncia", "Lycaon_pictus"),
  collapse.singles=FALSE)

dogs &lt;- c("Canis_lupus", "Canis_lupus_familiaris", "Canis_latrans",
  "Canis_anthus", "Canis_aureus", "Lycaon_pictus", "Canis_adustus",
  "Canis_mesomelas")

# try to extract tree with all 'dogs'
t1 &lt;- phylobuilder(dogs, tree)
plot(t1, direction="downwards")
attr(t1, "species_list")

# providing extra information ("Family", "Order", ...) can help
sp &lt;- data.frame(Order = c("Carnivora", "Carnivora", "Carnivora"),
  Family = c("Felidae", "Canidae", "Canidae"),
  Genus = c("Panthera", "Lycaon", "Vulpes"),
  Species = c("uncia", "pictus", "vulpes"),
  Common_name = c("Snow leopard", "Africa wild dog", "Red fox"))
sp
# Now we just add some species
t2 &lt;- phylobuilder(sp, tree, extract=FALSE)
plot(t2, direction="downwards")
attr(t2, "species_list")

</code></pre>


</div>