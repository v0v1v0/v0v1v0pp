<div class="container">

<table style="width: 100%;"><tr>
<td>postPP</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>Posterior density of effect size and power parameter</h2>

<h3>Description</h3>

<p>This function computes the posterior density of effect size
<code class="reqn">\theta</code> and power parameter <code class="reqn">\alpha</code> assuming a
normal likelihood for original and replication effect estimate. A power
prior for <code class="reqn">\theta</code> is constructed by updating an initial
normal prior <code class="reqn">\theta \sim \mathrm{N}(\code{m}, \code{v})</code> with the likelihood of the original data raised to the power of
<code class="reqn">\alpha</code>. A marginal beta prior <code class="reqn">\alpha \sim
    \mbox{Beta}(\code{x},\code{y})</code> is assumed.
</p>


<h3>Usage</h3>

<pre><code class="language-R">postPP(theta, alpha, tr, sr, to, so, x = 1, y = 1, m = 0, v = Inf, ...)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>theta</code></td>
<td>
<p>Effect size. Has to be of length one or the same length as
<code>alpha</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>alpha</code></td>
<td>
<p>Power parameter. Has to be of length one or the same length as
<code>theta</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>tr</code></td>
<td>
<p>Effect estimate of the replication study.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>sr</code></td>
<td>
<p>Standard error of the replication effect estimate.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>to</code></td>
<td>
<p>Effect estimate of the original study.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>so</code></td>
<td>
<p>Standard error of the replication effect estimate.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>x</code></td>
<td>
<p>Number of successes parameter of beta prior for <code class="reqn">\alpha</code>.
Defaults to <code>1</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>y</code></td>
<td>
<p>Number of failures parameter of beta prior for <code class="reqn">\alpha</code>.
Defaults to <code>1</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>m</code></td>
<td>
<p>Mean parameter of initial normal prior for <code class="reqn">\theta</code>.
Defaults to <code>0</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>v</code></td>
<td>
<p>Variance parameter of initial normal prior for <code class="reqn">\theta</code>.
Defaults to <code>Inf</code> (uniform prior).</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>...</code></td>
<td>
<p>Additional arguments passed to <code>stats::integrate</code>.</p>
</td>
</tr>
</table>
<h3>Value</h3>

<p>Posterior density
</p>


<h3>Author(s)</h3>

<p>Samuel Pawel
</p>


<h3>See Also</h3>

<p><code>postPPalpha</code>, <code>postPPtheta</code>, <code>plotPP</code>
</p>


<h3>Examples</h3>

<pre><code class="language-R">alpha &lt;- seq(0, 1, length.out = 200)
theta &lt;- seq(0, 0.3, length.out = 200)
parGrid &lt;- expand.grid(alpha = alpha, theta = theta)
postdens &lt;- postPP(theta = parGrid$theta, alpha = parGrid$alpha, tr = 0.1,
                   sr = 0.05, to = 0.2, so = 0.05)
postdensMat &lt;- matrix(data = postdens, ncol = 200, byrow = TRUE)
filled.contour(x = theta, y = alpha, z = postdensMat,
               xlab = bquote("Effect size" ~ theta),
               ylab = bquote("Power parameter" ~ alpha), nlevels = 15,
               color.palette = function(n) hcl.colors(n = n, palette = "viridis"))
</code></pre>


</div>