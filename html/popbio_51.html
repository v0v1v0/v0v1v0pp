<div class="container">

<table style="width: 100%;"><tr>
<td>stoch.projection</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>Project stochastic growth from a sequence of matrices</h2>

<h3>Description</h3>

<p>Projects stochastic growth using whole matrix selection techniques in an
independently and identically distributed (iid) environment from a set of two
or more projection matrices
</p>


<h3>Usage</h3>

<pre><code class="language-R">stoch.projection(
  matrices,
  n0,
  tmax = 50,
  nreps = 5000,
  prob = NULL,
  nmax = NULL,
  sumweight = rep(1, length(n0)),
  verbose = FALSE
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>matrices</code></td>
<td>
<p>a <code>list</code> with two or more projection matrices</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>n0</code></td>
<td>
<p>initial population vector</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>tmax</code></td>
<td>
<p>number of time steps or projection intervals to predict future population size</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>nreps</code></td>
<td>
<p>number of iterations</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>prob</code></td>
<td>
<p>a vector of probability weights used by <code>sample</code> for
selecting the projection matrices, defaults  to equal probabilities</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>nmax</code></td>
<td>
<p>a maximum number of individuals beyond which population projections
cannot exceed. Default is no density dependence</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>sumweight</code></td>
<td>
<p>A vector of ones and zeros used to omit stage classes when
checking density threshold. Default is to sum across all stage classes</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>verbose</code></td>
<td>
<p>Print comments at start of  iteration 1, 100, 200, 300, etc.</p>
</td>
</tr>
</table>
<h3>Details</h3>

<p>converted Matlab code from  Box 7.3 in Morris and Doak (2002) with nmax option
added to introduce simple density dependence
</p>


<h3>Value</h3>

<p>A matrix listing final population sizes by stage class with one iteration per row.
</p>


<h3>Author(s)</h3>

<p>Chris Stubben
</p>


<h3>References</h3>

<p>Morris, W. F., and D. F. Doak. 2002. Quantitative conservation
biology: Theory and practice of population viability analysis. Sinauer,
Sunderland, Massachusetts, USA.
</p>


<h3>Examples</h3>

<pre><code class="language-R">n &lt;- c(4264, 3,30,16,25,5)
names(n) &lt;- c("seed",  "seedlings", "tiny", "small", "medium" , "large")
## use equal and unequal probabilities for matrix selection
x.eq   &lt;- stoch.projection(hudsonia, n, nreps=1000)
x.uneq &lt;- stoch.projection(hudsonia, n, nreps=1000, prob=c(.2,.2,.2,.4))
hist(apply(x.eq, 1, sum), xlim=c(0,5000), ylim=c(0,200), col="green",
breaks=seq(0,5000, 100), xlab="Final population size at t=50", main='')
par(new=TRUE)
## use transparency for overlapping distributions - may not work on all systems
hist(apply(x.uneq, 1, sum), xlim=c(0,5000), ylim=c(0,200), col=rgb(0, 0, 1, 0.2),
 xaxt='n', yaxt='n', ylab='', xlab='', breaks=seq(0,10000, 100), main='')
legend(2500,200,  c("equal", "unequal"),fill=c("green", rgb(0, 0, 1, 0.2)))
title(paste("Projection of stochastic growth for Hudsonia
using equal and unequal probabilities"), cex.main=1)
## initial pop size
sum(n)
abline(v=sum(n), lty=3)

</code></pre>


</div>