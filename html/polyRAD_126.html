<div class="container">

<table style="width: 100%;"><tr>
<td>TestOverdispersion</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>
Test the Fit of Read Depth to Beta-Binomial Distribution
</h2>

<h3>Description</h3>

<p>This function is intended to help the user select a value to pass to the
<code>overdispersion</code> argument of <code>AddGenotypeLikelihood</code>,
generally via pipeline functions such as <code>IterateHWE</code> or
<code>PipelineMapping2Parents</code>.
</p>


<h3>Usage</h3>

<pre><code class="language-R">TestOverdispersion(object, ...)

## S3 method for class 'RADdata'
TestOverdispersion(object, to_test = seq(6, 20, by = 2), ...)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>object</code></td>
<td>

<p>A <code>RADdata</code> object.  Genotype calling does not need to have
been performed, although for mapping populations it might be helpful to
have done a preliminary run of <code>PipelineMapping2Parents</code> without
linkage.
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>to_test</code></td>
<td>

<p>A vector containing values to test.  These are values that will potentially
be used for the <code>overdispersion</code> argument of a pipeline function.  They
should all be positive numbers.
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>...</code></td>
<td>

<p>Additional arguments (none implemented).
</p>
</td>
</tr>
</table>
<h3>Details</h3>

<p>If no genotype calling has been performed, a single iteration under HWE using
default parameters will be done.  <code>object$ploidyChiSq</code> is then examined
to determine the most common/most likely inheritance mode for the whole
dataset.  The alleles that are examined are only those where this
inheritance mode has the lowest chi-squared value.
</p>
<p>Within this inheritance mode and allele set, genotypes are selected where the
posterior probability of having a single copy of the allele is at least 0.95.
Read depth for these genotypes is then analyzed.  For each genotype, a 
two-tailed probability is calculated for the read depth ratio to deviate from 
the expected ratio by at least that much under the beta-binomial distribution.
This test is performed for each overdispersion value provided in
<code>to_test</code>.
</p>


<h3>Value</h3>

<p>A list of the same length as <code>to_test</code> plus one.  The names of the list are
<code>to_test</code> converted to a character vector.  Each item in the list is a
vector of p-values, one per examined genotype, of the read depth ratio for
that genotype to deviate that much from the expected ratio.  The last item,
named "optimal", is a single number indicating the optimal value for the
overdispersion parameter based on the p-value distributions.  If the optimal
value was the minimum or maximum tested, <code>NA</code> is returned in the
<code>"optimal"</code> slot to encourage the user to test other values.
</p>


<h3>Author(s)</h3>

<p>Lindsay V. Clark
</p>


<h3>Examples</h3>

<pre><code class="language-R"># dataset with overdispersion
data(Msi01genes)

# test several values for the overdispersion parameter
myP &lt;- TestOverdispersion(Msi01genes, to_test = 8:10)

# view results as quantiles
sapply(myP[names(myP) != "optimal"],
       quantile, probs = c(0.01, 0.25, 0.5, 0.75, 0.99))
</code></pre>


</div>