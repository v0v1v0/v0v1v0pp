<div class="container">

<table style="width: 100%;"><tr>
<td>mpin_ml</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>MPIN model estimation via standard ML methods</h2>

<h3>Description</h3>

<p>Estimates the multilayer probability of informed trading
(<code>MPIN</code>) using the standard Maximum Likelihood method.
</p>


<h3>Usage</h3>

<pre><code class="language-R">mpin_ml(data, layers = NULL, xtraclusters = 4, initialsets = NULL,
detectlayers = "EG", ..., verbose = TRUE)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>data</code></td>
<td>
<p>A dataframe with 2 variables: the first
corresponds to buyer-initiated trades (buys), and the second corresponds
to seller-initiated trades (sells).</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>layers</code></td>
<td>
<p>An integer referring to the assumed number of
information layers in the data. If the argument <code>layers</code> is given,
then the maximum likelihood estimation will use the number of layers
provided. If <code>layers</code> is omitted,
the function <code>mpin_ml()</code> will find the optimal number of layers using
the algorithm developed in Ersan and Ghachem (2022a)
(as default).</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>xtraclusters</code></td>
<td>
<p>An integer used to divide trading days into
<code>(1 + layers + xtraclusters)</code> clusters, thereby resulting in
<code>#comb(layers + xtraclusters, layers)</code> initial parameter sets in line
with Ersan and Alici (2016), and
Ersan (2016). The default value is <code>4</code> as
chosen in Ersan (2016).</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>initialsets</code></td>
<td>
<p>A dataframe containing initial parameter
sets for the estimation of the <code>MPIN</code> model. The default value is <code>NULL</code>.
If <code>initialsets</code> is <code>NULL</code>, the initial parameter sets are determined by the
function <code>initials_mpin()</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>detectlayers</code></td>
<td>
<p>A character string referring to the layer
detection algorithm used to determine the number of  layer in the data. It
takes one of three values: <code>"E"</code>, <code>"EG"</code>, and <code>"ECM"</code>. <code>"E"</code> refers to the
algorithm in Ersan (2016), <code>"EG"</code> refers to
the algorithm in Ersan and Ghachem (2022a);
while <code>"ECM"</code> refers to the algorithm in
Ghachem and Ersan (2022a).
The default value is <code>"EG"</code>. Comparative results between the layer detection
algorithms can be found in Ersan and Ghachem (2022a).</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>...</code></td>
<td>
<p>Additional arguments passed on to the function <code>mpin_ml</code>. The
recognized argument is <code>is_parallel</code>. <code>is_parallel</code> is a logical variable
that specifies whether the computation is performed using parallel
processing. The default value is <code>FALSE</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>verbose</code></td>
<td>
<p>A binary variable that determines whether detailed
information about the steps of the estimation of the MPIN model is displayed.
No output is produced when <code>verbose</code> is set to <code>FALSE</code>. The default
value is <code>TRUE</code>.</p>
</td>
</tr>
</table>
<h3>Details</h3>

<p>The argument 'data' should be a numeric dataframe, and contain
at least two variables. Only the first two variables will be considered:
The first variable is assumed to correspond to the total number of
buyer-initiated trades, while the second variable is assumed to
correspond to the total number of seller-initiated trades. Each row or
observation correspond to a trading day. <code>NA</code> values will be ignored. <br></p>


<h3>Value</h3>

<p>Returns an object of class <code>estimate.mpin</code>
</p>


<h3>References</h3>

<p>Ersan O (2016).
“Multilayer Probability of Informed Trading.”
<em>Available at SSRN 2874420</em>.<br><br> Ersan O, Alici A (2016).
“An unbiased computation methodology for estimating the probability of informed trading (PIN).”
<em>Journal of International Financial Markets, Institutions and Money</em>, <b>43</b>, 74–94.
ISSN 10424431.<br><br> Ersan O, Ghachem M (2022a).
“Identifying information types in probability of informed trading (PIN) models: An improved algorithm.”
<em>Available at SSRN 4117956</em>.<br><br> Ghachem M, Ersan O (2022a).
“Estimation of the probability of informed trading models via an expectation-conditional maximization algorithm.”
<em>Available at SSRN 4117952</em>.
</p>


<h3>Examples</h3>

<pre><code class="language-R"># There is a preloaded quarterly dataset called 'dailytrades' with 60
# observations. Each observation corresponds to a day and contains the
# total number of buyer-initiated trades ('B') and seller-initiated
# trades ('S') on that day. To know more, type ?dailytrades

xdata &lt;- dailytrades

# ------------------------------------------------------------------------ #
# Estimate MPIN model using the standard ML method                         #
# ------------------------------------------------------------------------ #

# Estimate the MPIN model using mpin_ml() assuming that there is a single
# information layer in the data. The model is then equivalent to the PIN
# model. The argument 'layers' takes the value '1'.
# We use two extra clusters to generate the initial parameter sets.

estimate &lt;- mpin_ml(xdata, layers = 1, xtraclusters = 2, verbose = FALSE)

# Show the estimation output

show(estimate)

# Estimate the MPIN model using the function mpin_ml(), without specifying
# the number of layers. The number of layers is then detected using Ersan and
# Ghachem (2022a).
# -------------------------------------------------------------

estimate &lt;- mpin_ml(xdata, xtraclusters = 2, verbose = FALSE)

# Show the estimation output

show(estimate)

# Display the likelihood-maximizing parameters

show(estimate@parameters)

# Display the global multilayer probability of informed trading

show(estimate@mpin)

# Display the multilayer probabilities of informed trading per layer

show(estimate@mpinJ)

# Display the first five initial parameters sets used in the maximum
# likelihood estimation

show(round(head(estimate@initialsets, 5), 4))

</code></pre>


</div>