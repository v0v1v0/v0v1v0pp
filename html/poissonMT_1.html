<div class="container">

<table style="width: 100%;"><tr>
<td>glmrobMT</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>
Robust Fitting of Poisson Generalized Linear Models
using MT robust method
</h2>

<h3>Description</h3>

<p><code>glmrobMT</code> is used to fit generalized linear models by robust MT
method. The model is specified by the <code>x</code> and <code>y</code>
components and a description of the error distribution. Currently,
only implemented for <code>family=poisson</code>.
</p>


<h3>Usage</h3>

<pre><code class="language-R">glmrobMT(x, y, weights=NULL, start=NULL, offset=NULL,
  family=poisson(), weights.on.x="none",
  control=glmrobMT.control(), intercept=TRUE, trace.lev=1,
  include.cubinf=TRUE, m.approx=NULL, mprime.approx=NULL, ...)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>x</code></td>
<td>

<p>design matrix of dimension <code class="reqn">n \times p</code>.
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>y</code></td>
<td>

<p>vector of observations of length <code>n</code>.
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>weights</code></td>
<td>

<p>an optional vector of weights to be used in the fitting
process (in addition to the robustness weights computed in
the fitting process).  
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>start</code></td>
<td>

<p>starting values for the parameters in the linear predictor.
Note that specifying <code>start</code> skips the computation of
the initial estimates, but needs to be <em>robust</em> itself.  
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>offset</code></td>
<td>

<p>this can be used to specify an <em>a priori</em> known component
to be included in the linear predictor during fitting.
At the moment it is not used.
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>family</code></td>
<td>

<p>a description of the error distribution and link function to
be used in the model. This can be a character string naming a
family function, a family <code>function</code> or the result of a
call to a family function. See <code>family</code> for details of
family functions. At the moment only <code>poisson</code> is available.
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>weights.on.x</code></td>
<td>

<p>a character string (can be abbreviated), a <code>function</code> or
<code>list</code> (see below), or a numeric vector of length
<code>n</code>, specifying how points (potential outliers) in x-space are
downweighted. If <code>"hat"</code>, weights on the design of the form
<code class="reqn">\sqrt{1-h_{ii}}</code> are used, where <code class="reqn">h_{ii}</code> are the diagonal
elements of the hat matrix. If <code>"robCov"</code>, weights based on
the robust Mahalanobis distance of the design matrix (intercept
excluded) are used where the covariance matrix and the centre is
estimated by <code>cov.rob</code>
from the package <span class="pkg">MASS</span>.<br>
Similarly,  if <code>"covMcd"</code>, robust weights are computed using
<code>covMcd</code>.  The default is <code>"none"</code>.
</p>
<p>If <code>weights.on.x</code> is a <code>function</code>, it is called
with arguments <code>(X, intercept)</code> and must return an n-vector of
non-negative weights.
</p>
<p>If it is a <code>list</code>, it must be of length one, and as
element contain a function much like <code>covMcd()</code> or
<code>cov.rob()</code> (package <span class="pkg">MASS</span>), which computes
multivariate location and “scatter” of a data matrix <code>X</code>.
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>control</code></td>
<td>

<p>a list of parameters for controlling the fitting process.
See the documentation for <code>glmrobMT.control</code> for
details.
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>intercept</code></td>
<td>

<p>logical indicating if an intercept at the first column of <code>x</code>
is present. This information is only used when <code>weights.on.x</code>
is not set to <code>none</code>.
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>trace.lev</code></td>
<td>

<p>logical (or integer) indicating if intermediate results
should be printed; defaults to <code>0</code> (the same as <code>FALSE</code>).
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>include.cubinf</code></td>
<td>

<p>logical, if <code>TRUE</code> the <code>cubinf</code>
is also used as possibile starting value.
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>m.approx</code></td>
<td>

<p>a function that return the value, for each linear predictor, that
makes the estimating equation Fisher consistent. If <code>NULL</code>
the default internal function is used.  
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>mprime.approx</code></td>
<td>

<p>a function that return the value, for each linear predictor,
corresponding to the first derivative of <code>m.approx</code>.
If <code>NULL</code> the default internal function is used. 
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>...</code></td>
<td>

<p>At the moment it is not used.  
</p>
</td>
</tr>
</table>
<h3>Value</h3>

<p>A list with the following components:
</p>
<table>
<tr style="vertical-align: top;">
<td><code>coefficients</code></td>
<td>
<p>a named vector of coefficients.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>initial</code></td>
<td>
<p>Initial vector of coefficients.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>family</code></td>
<td>
<p>the <code>family</code> object used.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>residuals</code></td>
<td>
<p>weighted Pearson residuals.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>fitted.values</code></td>
<td>
<p>the fitted mean values, obtained by transforming
the linear predictors by the inverse of the link function.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>linear.predictors</code></td>
<td>
<p>the linear fit on link scale.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>cov</code></td>
<td>
<p>the estimated asymptotic covariance matrix of the estimated
coefficients.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>converged</code></td>
<td>
<p>logical. Was the IWLS algorithm judged to have converged?</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>iter</code></td>
<td>
<p>the number of iterations used by the influence algorithm.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>cw</code></td>
<td>
<p>the tuning constant c in Tukey's bisquare psi-function.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>weights.on.x</code></td>
<td>
<p>how the weights on the design matrix <code>x</code> were evaluated.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>w.x</code></td>
<td>
<p>weights used to down-weight observations based on the
position of the observation in the design space.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>w.r</code></td>
<td>
<p>robustness weights for each observations.</p>
</td>
</tr>
</table>
<h3>Author(s)</h3>

<p>Claudio Agostinelli, Marina Valdora and Victor J. Yohai  
</p>


<h3>References</h3>

<p>C. Agostinelli, M. Valdora and V.J Yohai (2018)
Initial Robust Estimation in Generalized Linear Models
with a Large Number of Covariates. Submitted.
</p>
<p>M. Valdora and V.J. Yohai (2014)
Robust estimators for generalized linear models.
Journal of Statistical Planning and Inference, 146, 31-48.
</p>


<h3>See Also</h3>

<p><code>poissonMT</code>, <code>glmrob</code> and <code>cubinf</code>
</p>


<h3>Examples</h3>

<pre><code class="language-R">  data(epilepsy)  
  Efit1 &lt;- glm(Ysum ~ Age10 + Base4*Trt, family=poisson, data=epilepsy)

  x &lt;- model.matrix( ~ Age10 + Base4*Trt, data=epilepsy)
  poissonMTsetwd(tempdir())   
  Efit2 &lt;- glmrobMT(x=x, y=epilepsy$Ysum) 
</code></pre>


</div>