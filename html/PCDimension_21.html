<div class="container">

<table style="width: 100%;"><tr>
<td>AuerGervini-class</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>Estimating Number of Principal Components Using the Auer-Gervini Method</h2>

<h3>Description</h3>

<p>Auer and Gervini [1] described a graphical Bayesian method for
estimating the number of statistically significant principal
components.  We have implemented their method in the <code>AuerGervini</code>
class, and enhanced it by automating the final selection.
</p>


<h3>Usage</h3>

<pre><code class="language-R">AuerGervini(Lambda, dd=NULL, epsilon = 2e-16)
agDimension(object, agfun=agDimTwiceMean)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>Lambda</code></td>
<td>
<p>Either a <code>SamplePCA</code> object or a numerical vector
of variances from a principal components analysis.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>dd</code></td>
<td>
<p>A vector of length 2 containing the dimensions of the data
used to created the Auer-Gervini object. If <code>Lambda</code> is a
<code>SamplePCA</code> object, then the dimensions are taken from it,
ignoring the <code>dd</code> argument.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>epsilon</code></td>
<td>
<p>A numeric value.  Used to remove any variances that are
less than <code>epsilon</code>; defaults to 2e-16.  Should only be needed in
rare cases where negative variances show up because of round-off error.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>object</code></td>
<td>
<p>An object of the <code>AuerGervini</code> class.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>agfun</code></td>
<td>
<p>A function that takes one argument (a vector of step
lengths) and returns a logical vector of the same length (where true
indicates "long"  as opposed to "short" steps).</p>
</td>
</tr>
</table>
<h3>Details</h3>

<p>The Auer-Gervini method for determining the number of principal
components is based on a Bayesian model that assaerts that the
vector of explained variances (eigenvalues) should have the form
</p>
<p style="text-align: center;"><code class="reqn">a_1 \le a_2 \le \dots \le a_d &lt; a_{d+1} = a_{d+2} = \dots a_n</code>
</p>

<p>with the goal being to find the true dimension <code class="reqn">d</code>. They consider
a set of prior distributions on <code class="reqn">d \in \{1, \dots, n\}</code> that decay
exponentially, with the rate of decay controlled by a parameter
<code class="reqn">\theta</code>.  For each value of <code class="reqn">\theta</code>, one selects the value
of <code class="reqn">d</code> that has the maximum a posteriori (MAP) probability. Auer
and Gervini show that the dimensions selected by this procedure write
<code class="reqn">d</code> as a non-increasing step function of <code class="reqn">\theta</code>. The values
of <code class="reqn">\theta</code> where the steps change are stored in    the
<code>changePoints</code> slot, and the corresponding <code class="reqn">d</code>-values are 
stored in the <code>dLevels</code> slot.
</p>
<p>Auer and Gervini go on to advise using their method as a graphical
approach, manually (or visually?) selecting the highest step that is
"long". Our implementation provides several different algorithms for
automatically deciding what is "long" enough.  The simplest (but
fairly naive) approach   is to take anything that is longer than twice
the mean; other algorithms are described in
<code>agDimFunction</code>.
</p>


<h3>Value</h3>

<p>The <code>AuerGervini</code> function constructs and returns an object of
the <code>AuerGervini</code> class.
</p>
<p>The <code>agDimension</code> function computes the number of significant
principal components.  The general idea is that one starts by
computing the length of each step in the Auer-Gerivni plot, and must
then separate these into "long" and "short" classes.  We provide a
variety of different algorithms to carry out this process; the
default algorithm in the function <code>agDimTwiceMean</code> defines
a step as "long" if it more than twice the mean step length.
</p>


<h3>Objects from the Class</h3>

<p>Objects should be created using the <code>AuerGervini</code> constructor.
</p>


<h3>Slots</h3>


<dl>
<dt>
<code>Lambda</code>:</dt>
<dd>
<p>A <code>numeric</code> vector containing
the explained variances in decreasing order. </p>
</dd>
<dt><code>dimensions</code></dt>
<dd>
<p>Numeric vector of length 2 containing the
dimnesions of the underlying data matrix.</p>
</dd>
<dt>
<code>dLevels</code>:</dt>
<dd>
<p>Object of class <code>numeric</code>; see details </p>
</dd>
<dt>
<code>changePoints</code>:</dt>
<dd>
<p>Object of class <code>numeric</code>; see details </p>
</dd>
</dl>
<h3>Methods</h3>


<dl>
<dt>plot</dt>
<dd>
<p><code>signature(x = "AuerGervini", y = "missing")</code>: ... </p>
</dd>
<dt>summary</dt>
<dd>
<p><code>signature(object = "AuerGervini")</code>: ... </p>
</dd>
</dl>
<h3>Author(s)</h3>

<p>Kevin R. Coombes &lt;krc@silicovore.com&gt;</p>


<h3>References</h3>

<p>[1] P Auer, D Gervini.
Choosing principal components: a new graphical method based on Bayesian model selection.
Communications in Statistics-Simulation and Computation 37 (5),
962-977.
</p>
<p>[2] Wang M, Kornbla SM, Coombes KR.
Decomposing the Apoptosis Pathway Into Biologically Interpretable
Principal Components.
Preprint: bioRxiv, 2017. &lt;doi://10.1101/237883&gt;.
</p>


<h3>See Also</h3>

<p><code>agDimFunction</code> to get a complete list of the functions
implementing different algorithms to separate the step lengths into
two classes.
</p>


<h3>Examples</h3>

<pre><code class="language-R">showClass("AuerGervini")
# simulate variances
lambda &lt;- rev(sort(diff(sort(c(0, 1, runif(9))))))
# apply the Auer-Gervini method
ag &lt;- AuerGervini(lambda, dd=c(3,10))
# Review the results
summary(ag)
agDimension(ag)
agDimension(ag, agDimKmeans)
# Look at the results graphically
plot(ag, agfun=list(agDimTwiceMean, agDimKmeans))
</code></pre>


</div>