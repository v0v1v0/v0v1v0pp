<div class="container">

<table style="width: 100%;"><tr>
<td>popkin_A_min_subpops</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>Estimate the minimum expected value of a matrix <code>A</code> using subpopulations</h2>

<h3>Description</h3>

<p>This function averages the values of a square matrix <code>A</code> between every subpopulation pair and returns the minimum of these averages.
If no subpopulation partition is provided, the function returns the minimum value of <code>A</code> excluding the diagonal, to agree when the code treats each individual as a subpopulation.
The return value can be used to adjust an <code>A</code> matrix to yield the kinship matrix.
</p>


<h3>Usage</h3>

<pre><code class="language-R">popkin_A_min_subpops(A, subpops = NULL)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>A</code></td>
<td>
<p>A symmetric <code>n</code>-by-<code>n</code> matrix with values between every individual pair, including self comparisons.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>subpops</code></td>
<td>
<p>A length-<code>n</code> vector of subpopulation assignments for each individual.
If missing, every individual is treated as a different subpopulation.</p>
</td>
</tr>
</table>
<h3>Value</h3>

<p>The minimum of the average between-subpopulation <code>A</code> values, which estimates the minimum expected value of <code>A</code>
</p>


<h3>See Also</h3>

<p><code>popkin_A()</code> to generate the <code>A</code> matrix usually inputted into this function (<code>popkin_A_min_subpops</code>).
<code>popkin()</code> is the wrapper function around both of these.
</p>
<p><code>avg_kinship_subpops()</code> for the full matrix of mean kinship values between subpopulations.
</p>


<h3>Examples</h3>

<pre><code class="language-R"># Construct toy data
X &lt;- matrix(c(0,1,2,1,0,1,1,0,2), nrow=3, byrow=TRUE) # genotype matrix
subpops &lt;- c(1,1,2) # subpopulation assignments for individuals

# NOTE: for BED-formatted input, use BEDMatrix!
# "file" is path to BED file (excluding .bed extension)
## library(BEDMatrix)
## X &lt;- BEDMatrix(file) # load genotype matrix object

# calculate A from genotypes
A &lt;- popkin_A(X)$A

# the recommended form using appropriate subpopulation labels
A_min_est &lt;- popkin_A_min_subpops( A, subpops )

# this recovers the popkin estimate
kinship &lt;- 1 - A / A_min_est
stopifnot( kinship == popkin( X, subpops ) )

# a simple default for exploratory analysis, equals min( A ) for correctly-calculated A
A_min_est &lt;- popkin_A_min_subpops( A )
stopifnot( A_min_est == min( A ) )

</code></pre>


</div>