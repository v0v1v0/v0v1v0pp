<div class="container">

<table style="width: 100%;"><tr>
<td>pdMedian</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>Weighted intrinsic median of HPD matrices</h2>

<h3>Description</h3>

<p><code>pdMedian</code> calculates a weighted intrinsic median of a sample of <code class="reqn">(d,d)</code>-dimensional
HPD matrices based on a Weiszfeld algorithm intrinsic to the chosen metric.In the case of the
affine-invariant Riemannian metric as detailed in e.g., (Bhatia 2009)[Chapter 6] or
(Pennec et al. 2006), the intrinsic Weiszfeld algorithm in (Fletcher et al. 2009) is used.
By default, the unweighted intrinsic median is computed.
</p>


<h3>Usage</h3>

<pre><code class="language-R">pdMedian(M, w, metric = "Riemannian", maxit = 1000, reltol)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>M</code></td>
<td>
<p>a <code class="reqn">(d,d,S)</code>-dimensional array corresponding to a sample of <code class="reqn">(d,d)</code>-dimensional HPD matrices of
size <code class="reqn">S</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>w</code></td>
<td>
<p>an <code class="reqn">S</code>-dimensional nonnegative weight vector, such that <code>sum(w) = 1</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>metric</code></td>
<td>
<p>the distance measure, one of <code>'Riemannian'</code>, <code>'logEuclidean'</code>,
<code>'Cholesky'</code>, <code>'Euclidean'</code> or <code>'rootEuclidean'</code>. Defaults to <code>'Riemannian'</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>maxit</code></td>
<td>
<p>maximum number of iterations in gradient descent algorithm. Defaults to <code>1000</code></p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>reltol</code></td>
<td>
<p>optional tolerance parameter in gradient descent algorithm. Defaults to <code>1E-10</code>.</p>
</td>
</tr>
</table>
<h3>Note</h3>

<p>The function does not check for positive definiteness of the input matrices, and (depending on the
specified metric) may fail if matrices are close to being singular.
</p>


<h3>References</h3>

<p>Bhatia R (2009).
<em>Positive Definite Matrices</em>.
Princeton University Press, New Jersey.<br><br> Fletcher P, Venkatasubramanian S, Joshi S (2009).
“The geometric median on Riemannian manifolds with application to robust atlas estimation.”
<em>NeuroImage</em>, <b>45</b>(1), S143–S152.<br><br> Pennec X, Fillard P, Ayache N (2006).
“A Riemannian framework for tensor computing.”
<em>International Journal of Computer Vision</em>, <b>66</b>(1), 41–66.
</p>


<h3>See Also</h3>

<p><code>pdMean</code>
</p>


<h3>Examples</h3>

<pre><code class="language-R">## Generate random sample of HPD matrices
m &lt;- function(){
 X &lt;- matrix(complex(real=rnorm(9), imaginary=rnorm(9)), nrow=3)
 t(Conj(X)) %*% X
}
M &lt;- replicate(100, m())
## Generate random weight vector
z &lt;- rnorm(100)
w &lt;- abs(z)/sum(abs(z))
## Compute weighted intrinsic (Riemannian) median
pdMedian(M, w)

</code></pre>


</div>