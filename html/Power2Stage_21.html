<div class="container">

<table style="width: 100%;"><tr>
<td>sampleN2.TOST</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>
Sample size re-estimation of adaptive 2-stage BE studies in 2x2 crossover and 
parallel designs based on power of TOST
</h2>

<h3>Description</h3>

<p>This function estimates the necessary sample size of
stage 2 to have at least a given power.
</p>


<h3>Usage</h3>

<pre><code class="language-R">sampleN2.TOST(alpha = 0.0294, CV, n1, theta0 = 0.95,
              theta1 = 0.8, theta2 = 1.25, targetpower = 0.8,
              design = "2x2", method = "exact", imax = 100)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>alpha</code></td>
<td>

<p>Alpha value for the final analysis of pooled data. Defaults to Pocock’s
alpha setting <code style="white-space: pre;">⁠alpha=0.0294⁠</code>.
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>CV</code></td>
<td>

<p>Coefficient of variation of the intra-subject variability as ratio.
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>n1</code></td>
<td>

<p>Sample size of stage 1.
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>theta0</code></td>
<td>

<p>True ratio of T/R for simulating. Defaults to 0.95 argument if missing.
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>theta1</code></td>
<td>

<p>Lower bioequivalence limit. Defaults to 0.8.
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>theta2</code></td>
<td>

<p>Upper bioequivalence limit. Defaults to 1.25.
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>targetpower</code></td>
<td>

<p>Power to achieve at least. Must be &gt;0 and &lt;1.
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>design</code></td>
<td>

<p>Character string describing the study design. Implemented are <code style="white-space: pre;">⁠"2x2"⁠</code>
and <code style="white-space: pre;">⁠"parallel"⁠</code>.
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>method</code></td>
<td>

<p>Method for calculation of the power. Implemented are <code style="white-space: pre;">⁠"exact"⁠</code>
(exact calculation via Owen’s Q), <code style="white-space: pre;">⁠"nct"⁠</code> (approximate
calculation via non-central <em>t</em>-distribution, and <code style="white-space: pre;">⁠"shifted"⁠</code>
(approximate calculation via shifted central <em>t</em>-distribution
like in the paper of Potvin <em>et al.</em><br>
Defaults to <code style="white-space: pre;">⁠"exact"⁠</code>.
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>imax</code></td>
<td>

<p>Maximum number of steps in sample size search.<br>
Defaults to 100. Adaption only in rare cases needed.
</p>
</td>
</tr>
</table>
<h3>Details</h3>

<p>The sample size is calculated via iterative evaluation of power of the
TOST procedure.<br>
Start value for the sample size search is taken from a large sample
approximation according to Zhang, modified.
</p>


<h3>Value</h3>

<p>A data.frame with the input and results will be returned.<br>
The "Sample size" column contains the sample size for the second stage.
</p>


<h3>Note</h3>

<p>Since in the final analysis one degree of freedom less than in a fixed sample
design (or in stage 1) is used, power will
be slightly lower than the one obtained with function <code style="white-space: pre;">⁠sampleN.TOST⁠</code> of
package <code style="white-space: pre;">⁠PowerTOST⁠</code>. However, different <em>sample sizes</em> are extremely
unlikely.
</p>


<h3>Author(s)</h3>

<p>H. Schütz, D. Labes
</p>


<h3>References</h3>

<p>Potvin D, DiLiberti CE, Hauck WW, Parr AF, Schuirmann DJ, Smith RA. <br><em>Sequential design approaches for bioequivalence studies with crossover designs.</em><br>
Pharm Stat. 2008; 7(4):245–62. doi: <a href="https://doi.org/10.1002/pst.294">10.1002/pst.294</a>
</p>
<p>Zhang P. <em>A Simple Formula for Sample Size Calculation in Equivalence Studies.</em><br>
J Biopharm Stat. 2003; 13(3):529–38. doi: <a href="https://doi.org/10.1081/BIP-120022772">10.1081/BIP-120022772</a>
</p>


<h3>Examples</h3>

<pre><code class="language-R"># using all the defaults, CV of 25% and 12 subjects in stage 1
print(sampleN2.TOST(CV=0.25, n1=12), row.names=FALSE)
# should give a stage 2 sample size of 22 and achieved power ~0.812
# CV 10% and 12 subjects in stage 1
print(sampleN2.TOST(CV=0.1, n1=12), row.names=FALSE)
# should give a sample size of 0 (second stage not reasonable
# since power ~0.973 was already achieved in stage 1)
</code></pre>


</div>