<div class="container">

<table style="width: 100%;"><tr>
<td>query</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>
Retrieve counts or next symbol probability distribution
</h2>

<h3>Description</h3>

<p>Retrieve counts or next symbol probability distribution from a node of a probabilistic suffix tree
</p>


<h3>Usage</h3>

<pre><code class="language-R">## S4 method for signature 'PSTf'
query(object, context, state, output = "prob", exact = FALSE)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>object</code></td>
<td>

<p>A probabilistic suffix tree, i.e an object of class <code>"PSTf"</code>) as returned by the <code>pstree</code>, <code>prune</code> or <code>tune</code> function.
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>context</code></td>
<td>

<p>Character. The string labelling the node to retrieve. States must be separated by '-' as for example in 'a-a-b'. If the node labelled with this string does not exist in the tree, the node labelled with the longest suffix is searched for, and so on until an existing node is  found.
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>state</code></td>
<td>

<p>character. If specified the probability of the specified state is returned instead of the whole distribution.
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>output</code></td>
<td>

<p>character. If output="prob" the probability distribution (or a single symbol distribution if state is specified) is returned. If output="counts" the counts on which the probability distribution is calculated are returned. If output="all" the node itself is returned, that is an object of class PSTr.
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>exact</code></td>
<td>

<p>logical. If TRUE, the information is returned only if the node labelled with context is present in the tree. That is, the longest suffix of context is not searched for if context is not in the tree.
</p>
</td>
</tr>
</table>
<h3>Details</h3>

<p>The PST is searched for the node labelled with <code>context</code>. If <code>exact=FALSE</code>, when the node does not exist the PST is searched for the longest suffix of <code>context</code>, and so on until a node corresponding to a suffix of <code>context</code> is found or the root node is reached. For more details, see <cite>Gabadinho 2016</cite>.
</p>


<h3>Value</h3>

<p>An object of class <code>cprobd</code>, with available <code>round</code> method.
</p>


<h3>Author(s)</h3>

<p>Alexis Gabadinho
</p>


<h3>References</h3>

<p>Gabadinho, A. &amp; Ritschard, G. (2016). Analyzing State Sequences with Probabilistic Suffix Trees: The PST R Package. <em>Journal of Statistical Software</em>, <b>72</b>(3), pp. 1-39.
</p>


<h3>See Also</h3>

<p><code>cplot</code>, <code>ppplot</code>
</p>


<h3>Examples</h3>

<pre><code class="language-R">data(s1)
s1 &lt;- seqdef(s1)
S1 &lt;- pstree(s1, L=3)
## Retrieving from the node labelled 'a-a-a'
query(S1, "a-a-a")

## The node 'a-b-b-a' is not presetnin the tree, and the next symbol
## probability is retrieved from the node labelled 'b-b-a' (the longest
## suffix
query(S1, "a-b-b-a")
</code></pre>


</div>