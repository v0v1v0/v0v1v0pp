<div class="container">

<table style="width: 100%;"><tr>
<td>specialFrame</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>Special frame</h2>

<h3>Description</h3>

<p>Extract data and design matrix including specials from call
</p>


<h3>Usage</h3>

<pre><code class="language-R">specialFrame(
  formula,
  data,
  unspecials.design = TRUE,
  specials,
  specials.factor = TRUE,
  specials.design = FALSE,
  strip.specials = TRUE,
  strip.arguments = NULL,
  strip.alias = NULL,
  strip.unspecials = NULL,
  drop.intercept = TRUE,
  response = TRUE,
  na.action = options()$na.action
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>formula</code></td>
<td>
<p>Formula whose left hand side specifies the event
history, i.e., either via Surv() or Hist().</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>data</code></td>
<td>
<p>Data frame in which the formula is interpreted</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>unspecials.design</code></td>
<td>
<p>Passed as is to
<code>model.design</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>specials</code></td>
<td>
<p>Character vector of special function names.
Usually the body of the special functions is function(x)x but
e.g., <code>strata</code> from the survival package does treat
the values</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>specials.factor</code></td>
<td>
<p>Passed as is to <code>model.design</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>specials.design</code></td>
<td>
<p>Passed as is to <code>model.design</code></p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>strip.specials</code></td>
<td>
<p>Passed as <code>specials</code> to
<code>strip.terms</code></p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>strip.arguments</code></td>
<td>
<p>Passed as <code>arguments</code> to
<code>strip.terms</code></p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>strip.alias</code></td>
<td>
<p>Passed as <code>alias.names</code> to
<code>strip.terms</code></p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>strip.unspecials</code></td>
<td>
<p>Passed as <code>unspecials</code> to
<code>strip.terms</code></p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>drop.intercept</code></td>
<td>
<p>Passed as is to <code>model.design</code></p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>response</code></td>
<td>
<p>If FALSE do not get response data.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>na.action</code></td>
<td>
<p>Decide what to do with missing values.</p>
</td>
</tr>
</table>
<h3>Details</h3>

<p>Obtain a list with the data used for event history regression analysis. This
function cannot be used directly on the user level but inside a function
to prepare data for survival analysis.
</p>


<h3>Value</h3>

<p>A list which contains
- the response
- the design matrix (see <code>model.design</code>)
- one entry for each special (see <code>model.design</code>)
</p>


<h3>Author(s)</h3>

<p>Thomas A. Gerds &lt;tag@biostat.ku.dk&gt;
</p>


<h3>See Also</h3>

<p>model.frame model.design Hist
</p>


<h3>Examples</h3>

<pre><code class="language-R">
## Here are some data with an event time and no competing risks
## and two covariates X1 and X2.
## Suppose we want to declare that variable X1 is treated differently
## than variable X2. For example, X1 could be a cluster variable, or
## X1 should have a proportional effect on the outcome.
d &lt;- data.frame(y=1:7,
                X2=c(2.24,3.22,9.59,4.4,3.54,6.81,5.05),
                X3=c(1,1,1,1,0,0,1),
                X4=c(44.69,37.41,68.54,38.85,35.9,27.02,41.84),
                X1=factor(c("a","b","a","c","c","a","b"),
                    levels=c("c","a","b")))
## define special functions prop and cluster
prop &lt;- function(x)x
cluster &lt;- function(x)x
## We pass a formula and the data
e &lt;- specialFrame(y~prop(X1)+X2+cluster(X3)+X4,
                  data=d,
                  specials=c("prop","cluster"))
## The first element is the response
e$response
## The other elements are the design, i.e., model.matrix for the non-special covariates
e$design
## and a data.frame for the special covariates
e$prop
## The special covariates can be returned as a model.matrix 
e2 &lt;- specialFrame(y~prop(X1)+X2+cluster(X3)+X4,
                   data=d,
                   specials=c("prop","cluster"),
                   specials.design=TRUE)
e2$prop
## and the non-special covariates can be returned as a data.frame
e3 &lt;- specialFrame(y~prop(X1)+X2+cluster(X3)+X4,
                   data=d,
                   specials=c("prop","cluster"),
                   specials.design=TRUE,
                   unspecials.design=FALSE)
e3$design
</code></pre>


</div>