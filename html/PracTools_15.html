<div class="container">

<table style="width: 100%;"><tr>
<td>deffH</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>
Henry design effect for <em>pps</em> sampling and GREG estimation of totals
</h2>

<h3>Description</h3>

<p>Compute the Henry design effect for single-stage samples when a general regression estimator is used for a total.
</p>


<h3>Usage</h3>

<pre><code class="language-R">deffH(w, y, x)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>w</code></td>
<td>
<p>vector of inverses of selection probabilities for a sample</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>y</code></td>
<td>
<p>vector of the sample values of an analysis variable</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>x</code></td>
<td>
<p>matrix of covariates used to construct a GREG estimator of the total of <code class="reqn">y</code>.  This matrix does not include the intercept.</p>
</td>
</tr>
</table>
<h3>Details</h3>

<p>The Henry design effect is the ratio of the variance of the general regression (GREG) estimator of a total of <code class="reqn">y</code> to the variance of the estimated total in <em>srswr</em>. Calculations for the Henry <em>deff</em> are done as if the sample is selected in a single-stage and with replacement.  Varying selection probabilities can be used. The model for the GREG is assumed to be <code class="reqn">y = \alpha + \beta x + \epsilon</code>, i.e., the model has an intercept.  </p>


<h3>Value</h3>

<p>numeric design effect
</p>


<h3>Author(s)</h3>

<p>Richard Valliant, Jill A. Dever, Frauke Kreuter
</p>


<h3>References</h3>

<p>Henry, K.A., and Valliant, R. (2015). A Design Effect Measure for Calibration Weighting in Single-stage Samples. <em>Survey Methodology</em>, 41, 315-331.
</p>
<p>Valliant, R., Dever, J., Kreuter, F. (2018, chap. 14). <em>Practical Tools for Designing and Weighting Survey Samples, 2nd edition</em>. New York: Springer.
</p>


<h3>See Also</h3>

<p><code>deff</code>, <code>deffCR</code>, <code>deffK</code>, <code>deffS</code>
</p>


<h3>Examples</h3>

<pre><code class="language-R">set.seed(-500398777)
    # generate population using HMT function
pop.dat &lt;- as.data.frame(HMT())
mos &lt;- pop.dat$x
pop.dat$prbs.1d &lt;- mos / sum(mos)
    # select pps sample
require(sampling)
n &lt;- 80
pk &lt;- n * pop.dat$prbs.1d
sam &lt;- UPrandomsystematic(pk)
sam &lt;- sam==1
sam.dat &lt;- pop.dat[sam, ]
dsgn.wts &lt;- 1/pk[sam]
deffH(w=dsgn.wts, y=sam.dat$y, x=sam.dat$x)
</code></pre>


</div>