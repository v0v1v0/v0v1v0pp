<div class="container">

<table style="width: 100%;"><tr>
<td>checkintrfr</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>Check the Integral of <code class="reqn">r f_r(r)</code>
</h2>

<h3>Description</h3>

<p>This function is auxiliary to <code>polyCub.iso</code>.
The (analytical) integral of <code class="reqn">r f_r(r)</code> from 0 to <code class="reqn">R</code> is checked
against a numeric approximation using <code>integrate</code> for various
values of the upper bound <code class="reqn">R</code>. A warning is issued if inconsistencies
are found.
</p>


<h3>Usage</h3>

<pre><code class="language-R">checkintrfr(intrfr, f, ..., center, control = list(), rs = numeric(0L),
  tolerance = control$rel.tol)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>intrfr</code></td>
<td>
<p>a <code>function(R, ...)</code>, which implements the (analytical)
antiderivative of <code class="reqn">r f_r(r)</code> from 0 to <code>R</code>. The first argument
must be vectorized but not necessarily named <code>R</code>.<br>
If <code>intrfr</code> is missing, it will be approximated numerically via
<code>integrate(function(r, ...)
r * f(cbind(x0 + r, y0), ...), 0, R, ..., control=control)</code>,
where <code>c(x0, y0)</code> is the <code>center</code> of isotropy.
Note that <code>f</code> will <em>not</em> be checked for isotropy.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>f</code></td>
<td>
<p>a two-dimensional real-valued function.
As its first argument it must take a coordinate matrix, i.e., a
numeric matrix with two columns, and it must return a numeric vector of
length the number of coordinates.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>...</code></td>
<td>
<p>further arguments for <code>f</code> or <code>intrfr</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>center</code></td>
<td>
<p>numeric vector of length 2, the center of isotropy.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>control</code></td>
<td>
<p>list of arguments passed to <code>integrate</code>, the
quadrature rule used for the line integral along the polygon boundary.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>rs</code></td>
<td>
<p>numeric vector of upper bounds for which to check the validity of
<code>intrfr</code>. If it has length 0 (default), no checks are performed.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>tolerance</code></td>
<td>
<p>of <code>all.equal.numeric</code> when comparing
<code>intrfr</code> results with numerical integration. Defaults to the
relative tolerance used for <code>integrate</code>.</p>
</td>
</tr>
</table>
<h3>Value</h3>

<p>The <code>intrfr</code> function. If it was not supplied, its quadrature
version using <code>integrate</code> is returned.
</p>


</div>