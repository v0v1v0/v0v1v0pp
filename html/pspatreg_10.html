<div class="container">

<table style="width: 100%;"><tr>
<td>impactspar</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>Compute direct, indirect and total impacts
for continous parametric covariates.</h2>

<h3>Description</h3>

<p>Compute direct, indirect and total 
impacts for parametric covariates included in a semiparametric spatial
or spatio-temporal model. The models can be of type <em>ps-sar</em>, 
<em>ps-sarar</em>, <em>ps-sdm</em>, <em>ps-sdem</em> or
<em>ps-slx</em>.
</p>


<h3>Usage</h3>

<pre><code class="language-R">impactspar(obj, ..., tr = NULL, R = 1000, listw = NULL, tol = 1e-06, Q = NULL)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>obj</code></td>
<td>
<p>A 'pspatreg' object created by <code>pspatfit</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>...</code></td>
<td>
<p>Arguments passed through to methods in the <span class="pkg">coda</span> package</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>tr</code></td>
<td>
<p>A vector of traces of powers of the spatial weights matrix created using <code>trW</code>, for approximate impact measures; if not given, <code>listw</code> must be given for exact measures (for small to moderate spatial weights matrices); the traces must be for the same spatial weights as were used in fitting the spatial regression, and must be row-standardised</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>R</code></td>
<td>
<p>If given, simulations are used to compute distributions for the impact measures, returned as <code>mcmc</code> objects; the objects are used for convenience but are not output by an MCMC process</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>listw</code></td>
<td>
<p>If <code>tr</code> is not given, a spatial weights object as created by <code>nb2listw</code>; they must be the same spatial weights as were used in fitting the spatial regression, but do not have to be row-standardised</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>tol</code></td>
<td>
<p>Argument passed to <code>mvrnorm</code>: tolerance (relative to largest variance) for numerical lack of positive-definiteness in the coefficient covariance matrix</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>Q</code></td>
<td>
<p>default NULL, else an integer number of cumulative power series impacts to calculate if <code>tr</code> is given</p>
</td>
</tr>
</table>
<h3>Details</h3>

<p>This function is similar to the 
<code>impacts</code> method used in <span class="pkg">spatialreg</span>.
package. The function
<code>impactspar</code> obtains the three type of impacts (total, direct
and indirect) together with a measure of statistical 
significance, according to the randomization approach described in 
LeSage and Pace (2009). Briefly, they suggest to obtain a 
sequence of <em>nsim</em> random matrices using a multivariate normal 
distribution N(0; <em>Sigma</em>), being <em>Sigma</em> the estimated 
covariance matrix of the fitted <em>beta</em> for parametric covariates
and spatial parameters of the model. 
These random matrices, combined with the values of the fitted 
<em>beta</em> for parametric covariates and the estimated 
values of the spatial parameters, are used to obtain simulated values. 
The function <code>impactspar</code> obtains the standard 
deviations using the <em>nsim</em> simulated impacts in the randomization 
procedure, which are used to test the significance of the estimated 
impacts for the original data.
Finally, if the spatial model is type = "slx" or "sdem", then there is no
need to simulate to make inference of the impacts. The standard errors of the 
impacts are computed directly using the <em>Sigma</em> matrix of the estimated
covariances of <em>beta</em> and spatial parameters.
</p>


<h3>Value</h3>

<p>An object of class <em>impactspar.pspatreg</em>. Can be printed
with <code>summary</code>.
</p>
<p>If <code>type = "sar", "sdm", "sarar"</code>, the object returned is a list 
with 4 objects including the type of model and three matrices including the simulated
total, direct and indirect impacts:         
</p>

<table>
<tr>
<td style="text-align: left;">
   <em>type</em> </td>
<td style="text-align: left;"> Type of spatial econometric model. </td>
</tr>
<tr>
<td style="text-align: left;">
   <em>mimpactstot</em> </td>
<td style="text-align: left;"> Matrix including simulated total impacts 
                           for each variable in rows. </td>
</tr>
<tr>
<td style="text-align: left;">
   <em>mimpactsdir</em> </td>
<td style="text-align: left;"> Matrix including simulated direct impacts 
                           for each variable in rows. </td>
</tr>
<tr>
<td style="text-align: left;">
   <em>mimpactsind</em> </td>
<td style="text-align: left;"> Matrix including simulated indirect impacts 
                           for each variable in rows. </td>
</tr>
<tr>
<td style="text-align: left;">
   </td>
</tr>
</table>
<p>If <code>type = "slx", "sdem"</code> the object returned is a list 
with 5 objects including the type of model and four matrices including 
the computed total, direct and indirect impacts, the standard errors,
the z-values and p-values of each type of impact:
</p>

<table>
<tr>
<td style="text-align: left;">
   <em>type</em> </td>
<td style="text-align: left;"> Type of spatial econometric model. </td>
</tr>
<tr>
<td style="text-align: left;">
   <em>mimpact</em> </td>
<td style="text-align: left;"> Matrix including computed total, direct and indirect
                       impacts for each variable in rows. </td>
</tr>
<tr>
<td style="text-align: left;">
   <em>semimpact</em> </td>
<td style="text-align: left;"> Matrix including standard errors of total, direct 
                         and indirect impacts for each variable 
                         in rows. </td>
</tr>
<tr>
<td style="text-align: left;">
   <em>zvalmimpact</em> </td>
<td style="text-align: left;"> Matrix including z-values of total, direct 
                         and indirect impacts for each variable 
                         in rows. </td>
</tr>
<tr>
<td style="text-align: left;">
   <em>pvalmimpact</em> </td>
<td style="text-align: left;"> Matrix including p-values of total, direct 
                         and indirect impacts for each variable 
                         in rows. </td>
</tr>
<tr>
<td style="text-align: left;">
   </td>
</tr>
</table>
<h3>References</h3>

 
<ul><li>
<p> LeSage, J. and Pace, K. (2009). <em>Introduction to 
Spatial Econometrics</em>. CRC Press, Boca Raton.
</p>
</li></ul>
<h3>See Also</h3>


<ul>
<li> <p><code>pspatfit</code> estimate spatial or spatio-temporal 
semiparametric ps-sar, ps-sem, ps-sarar, ps-slx or 
ps-durbin regression models.
</p>
</li>
<li> <p><code>impactsnopar</code> compute total, direct and indirect impact
functions for non-parametric continuous covariates.
</p>
</li>
<li> <p><code>fit_terms</code> compute smooth term functions for 
non-parametric continuous covariates.
</p>
</li>
<li> <p><code>impacts</code> similar function in <span class="pkg">spdep</span> 
package to compute impacts in spatial parametric econometric 
models.
</p>
</li>
</ul>
<h3>Examples</h3>

<pre><code class="language-R">################################################
#### Examples using a panel data of rate of
##### unemployment for 103 Italian provinces in period 1996-2014.
library(pspatreg)
data(unemp_it, package = "pspatreg")
## Wsp_it is a matrix. Create a neighboord list 
lwsp_it &lt;- spdep::mat2listw(Wsp_it)
## short sample for spatial pure case (2d)
########  No Spatial Trend: PSAR including a spatial 
########  lag of the dependent variable
form1 &lt;- unrate ~ partrate + agri + cons + empgrowth +
                 pspl(serv, nknots = 15) 
### example with type = "sar"                   
gamsar &lt;- pspatfit(form1, 
                   data = unemp_it, 
                   type = "sar", 
                   listw = lwsp_it)
summary(gamsar)
###### Parametric Total, Direct and Indirect Effects
imp_parvar &lt;- impactspar(gamsar, listw = lwsp_it)
summary(imp_parvar)

### example with type = "slx"                   

gamslx &lt;- pspatfit(form1, 
                   data = unemp_it, 
                   type = "slx", 
                   listw = lwsp_it)
                   
summary(gamslx)
###### Parametric Total, Direct and Indirect Effects
imp_parvarslx &lt;- impactspar(gamslx, listw = lwsp_it)
summary(imp_parvarslx)

</code></pre>


</div>