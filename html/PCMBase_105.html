<div class="container">

<table style="width: 100%;"><tr>
<td>PCMPresentCoordinates</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>Determine which traits are present (active) on each node of the tree</h2>

<h3>Description</h3>

<p>For every node (root, internal or tip) in tree, build a logical
vector of length k with TRUE values for every present coordinate. Non-present
coordinates arize from NA-values in the trait data. These can occur in two cases:
</p>

<dl>
<dt>Missing measurements for some traits at some tips:</dt>
<dd>
<p>the present coordinates
are FALSE for the corresponding tip and trait, but are full for all traits
at all internal and root nodes.</p>
</dd>
<dt>non-existent traits for some species:</dt>
<dd>
<p>the FALSE present coordinates
propagate towards the parent
nodes - an internal or root node will have a present coordinate set to FALSE
for a given trait, if all of its descendants have this coordinate set to FALSE.</p>
</dd>
</dl>
<p>These two cases have different effect on the likelihood calculation: missing
measurements (NA) are integrated out at the parent nodes; while non-existent
traits (NaN) are treated as reduced dimensionality of the vector at the
parent node.
</p>


<h3>Usage</h3>

<pre><code class="language-R">PCMPresentCoordinates(X, tree, metaI)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>X</code></td>
<td>
<p>numeric k x N matrix of observed values, with possible NA entries. The
columns in X are in the order of tree$tip.label</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>tree</code></td>
<td>
<p>a phylo object</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>metaI</code></td>
<td>
<p>The result of calling PCMInfo.</p>
</td>
</tr>
</table>
<h3>Value</h3>

<p>a k x M logical matrix. The function fails in case when all traits are NAs for some of the tips.
In that case an error message is issued
"PCMPresentCoordinates:: Some tips have 0 present coordinates. Consider
removing these tips.".
</p>


<h3>See Also</h3>

<p><code>PCMLik</code>
</p>


</div>