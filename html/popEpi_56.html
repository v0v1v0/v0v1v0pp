<div class="container">

<table style="width: 100%;"><tr>
<td>relpois</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>Excess hazard Poisson model</h2>

<h3>Description</h3>

<p>Estimate a Poisson piecewise constant excess
hazards model
</p>


<h3>Usage</h3>

<pre><code class="language-R">relpois(data, formula, fot.breaks = NULL, subset = NULL, check = TRUE, ...)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>data</code></td>
<td>
<p>a dataset split with e.g. <code>lexpand</code>;
must have expected hazard merged within</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>formula</code></td>
<td>
<p>a formula which is passed on to <code>glm</code>; see Details</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>fot.breaks</code></td>
<td>
<p>optional; a numeric vector of [a,b) breaks to specify
survival intervals over the follow-up time; if <code>NULL</code>, the 
existing breaks along the mandatory <code>fot</code> time scale in <code>data</code>
are used (e.g. the breaks for <code>fot</code> supplied to <code>lexpand</code>)</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>subset</code></td>
<td>
<p>a logical vector or condition; e.g. <code>subset = sex == 1</code>;
limits the data before estimation</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>check</code></td>
<td>
<p>logical; if <code>TRUE</code>, tabulates excess cases by all
factor variables in the formula to check for negative / <code>NA</code> 
excess cases before fitting the GLM</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>...</code></td>
<td>
<p>any argument passed on to <code>glm</code></p>
</td>
</tr>
</table>
<h3>Details</h3>

<p><strong>Basics</strong>
</p>
<p><code>relpois</code> employs a custom link function of the Poisson variety
to estimate piecewise constant parametric excess hazards. The pieces
are determined by <code>fot.breaks</code>. A <code>log(person-years)</code> offset
is passed automatically to the <code>glm</code> call.
</p>
<p><strong>Formula usage</strong>
</p>
<p>The formula can be used like any ordinary <code>glm</code> formula. The user must
define the outcome in some manner, which is usually <code>lex.Xst</code> after splitting
with e.g. <code>lexpand</code>. The exception is the possibility of including 
the baseline excess hazard terms by including the 
reserved term <code>FOT</code> in the formula.
</p>
<p>For example, <code>lex.Xst != 0 ~ FOT + agegr</code> estimates a model with constant
excess hazards at the follow-up intervals as specified by 
the pertinent breaks used in splitting <code>data</code>,
as well as for the different age groups.
<code>FOT</code> is created ad hoc if it is used in the formula.
If you leave out <code>FOT</code>, the hazard is effectively
assumed to be constant across the whole follow-up time. 
</p>
<p>You can also simply use your own follow-up time interval variable that
you have created before calling <code>relpois</code>. However, when using 
<code>FOT</code>, <code>relpois</code> automatically checks for e.g. 
negative excess cases in follow-up intervals,
allowing for quickly finding splitting breaks
where model estimation is possible. It also drops any data outside the
follow-up time window.
</p>
<p><strong>Splitting and merging population hazard</strong>
</p>
<p>The easiest way to both split and to include population hazard information is 
by using <code>lexpand</code>. You may also fairly easily do it by hand
by splitting first and then merging in your population hazard information.
</p>
<p><strong>Data requirements</strong>
</p>
<p>The population hazard information must be available for each record and named
<code>pop.haz</code>. The follow-up time variable must be named <code>"fot"</code> e.g.
as a result of using <code>lexpand</code>. The <code>lex.dur</code> variable must also
be present, containing person-year information.
</p>


<h3>Value</h3>

<p>A <code>glm</code> object created using a custom Poisson family construct. Some
<code>glm</code> methods are applicable.
</p>


<h3>Author(s)</h3>

<p>Joonas Miettinen, Karri Seppa
</p>


<h3>References</h3>

<p>Paul W Dickman, Andy Sloggett, Michael Hills, and Timo Hakulinen.
Regression models for relative survival. 
Stat Med. 2004 Jan 15;23(1):51-64.
<a href="https://doi.org/10.1002/sim.1597">doi:10.1002/sim.1597</a>
</p>


<h3>See Also</h3>

<p><code>lexpand</code>, <code>poisson</code>, <code>glm</code>
</p>
<p>Other main functions: 
<code>Surv()</code>,
<code>rate()</code>,
<code>relpois_ag()</code>,
<code>sir()</code>,
<code>sirspline()</code>,
<code>survmean()</code>,
<code>survtab()</code>,
<code>survtab_ag()</code>
</p>
<p>Other relpois functions: 
<code>RPL</code>,
<code>relpois_ag()</code>,
<code>rpcurve()</code>
</p>


<h3>Examples</h3>

<pre><code class="language-R">## use the simulated rectal cancer cohort
data("sire", package = "popEpi")
sire$agegr &lt;- cut(sire$dg_age, c(0,45,60,Inf), right=FALSE)

## usable straight away after splitting
fb &lt;- c(0,3/12,6/12,1,2,3,4,5)
x &lt;- lexpand(sire, birth = bi_date, entry = dg_date,
             exit = ex_date, status=status,
             breaks = list(fot=fb), pophaz=popmort)
rpm &lt;- relpois(x, formula = lex.Xst %in% 1:2 ~ FOT + agegr)
 
## some methods for glm work. e.g. test for interaction

rpm2 &lt;- relpois(x, formula = lex.Xst %in% 1:2 ~ FOT*agegr)
anova(rpm, rpm2, test="LRT")
AIC(rpm, rpm2)
## update() won't work currently

</code></pre>


</div>