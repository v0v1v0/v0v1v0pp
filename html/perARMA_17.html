<div class="container">

<table style="width: 100%;"><tr>
<td>peracf</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2> Periodic ACF function
</h2>

<h3>Description</h3>

<p>Function <code>peracf</code>, given an input time series and a specified period <code>T</code>, computes the periodic correlation coefficients for which
<code class="reqn"> \rho(t+\tau,t)=\rho(t,\tau)</code>, where <code class="reqn">t = 1,\ldots, T</code>
are seasons and <code class="reqn">\tau</code> is lag. For each
possible pair of <code class="reqn"> t</code> and <code class="reqn">\tau </code> confidence limits for
<code class="reqn">\rho(t,\tau)</code> are also computed using Fisher
transformation. Procedure <code>peracf</code>
provides also two important tests: <code class="reqn"> \rho(t+\tau,t) \equiv \rho(\tau)</code> and <code class="reqn">\rho(t+\tau,t) \equiv 0</code>.
</p>


<h3>Usage</h3>

<pre><code class="language-R">peracf(x, T_t, tau, missval, datastr,...)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>x</code></td>
<td>

<p>input time series, at the begining missing values
in <code>x</code> will be treat as zeros and periodic mean will be computed,
then missing values will be replaced by periodic mean.
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>T_t</code></td>
<td>

<p>period of PC-T structure.
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>tau</code></td>
<td>

<p>vector of lag values for which estimation is made.
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>missval</code></td>
<td>

<p>notation for missing values (denoted as NaN).
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>datastr</code></td>
<td>

<p>string name of data for printing.
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>...</code></td>
<td>
<p>other arguments, that are connected with the plots:<br><code>prttaus, plottaus, cialpha, typeci, typerho, pchci, pchrho, colci, colrho</code>, where<br><code>prttaus</code> is a set of lags for which correlation coefficients are printed; it is a subset of <code>tau</code>, <br><code>plottaus</code> is a set of lags for plotting the correlation coefficients
(one plot per lag); it is a subset of <code>tau</code>,<br><code>cialpha</code> threshold for confidence interval, <br><code>typeci</code>/ <code>typerho</code>, <code>pchci</code>/ <code>pchrho</code>, <code>colci</code>/<code>colrho</code>
define the type, plot character and colors of confidence intervals/periodic correlation values.<br>
By default these parameters are fixed to <code>prttaus = seq(1,T/2)</code>, <code>plottaus = seq(1,T/2)</code>, <code>cialpha = 0.05</code>, <code>typeci = "b"</code>, <code>typerho = "b"</code>, <code>pchci = 10</code>, <code>pchrho = 15</code>, <code>colci = "blue"</code>, <code>colrho = "red"</code>.
</p>
</td>
</tr>
</table>
<h3>Details</h3>

<p>Function <code>peracf</code> uses three separate procedures:<br><code>rhoci()</code> returns the upper and lower bands defining a <code class="reqn">1 - \alpha</code> confidence interval for the true values of
<code class="reqn"> \rho(t, \tau)</code>,<br><code>rho.zero.test()</code>  tests whether the estimated correlation coefficients are equal to zeros, <code class="reqn"> \rho(t+\tau,t) \equiv 0</code>.<br><code>rho.equal.test()</code>  tests whether the estimated correlation coefficients are equal to each other for all seasons in the period,
<code class="reqn"> \rho(t+\tau,t) \equiv \rho(\tau)</code>.<br></p>
<p>In the test <code class="reqn"> \rho(t+\tau,t) \equiv \rho(\tau)</code>, rejection for some <code class="reqn">\tau
&gt; 0</code> indicates
that series is properly PC and is not just an amplitude modulated stationary
sequence. In other words, there exists a nonzero
lag <code class="reqn">\tau</code> for which <code class="reqn"> \rho(t+\tau,t)</code> is
properly periodic in <code class="reqn">t</code>.<br>
In the test <code class="reqn">\rho(t+\tau,t) \equiv 0</code>, the
rejection for some <code class="reqn"> \tau \neq 0</code> indicates the sequence is not PC white noise.
</p>


<h3>Value</h3>

<p>tables of values for each specified lag <code class="reqn">\tau</code>:
</p>
<table>
<tr style="vertical-align: top;">
<td><code>rho(t, tau)</code></td>
<td>
<p>estimated correlation coefficients.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>lower</code></td>
<td>
<p>lower bands of confidence intervals.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>upper</code></td>
<td>
<p>upper bands of confidence intervals.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>nsamp</code></td>
<td>
<p>number of samples used in each estimation.</p>
</td>
</tr>
</table>
<p>Above values are also returned as matrices.
</p>


<h3>Author(s)</h3>

<p>Harry Hurd
</p>


<h3>References</h3>

<p>Hurd, H. L., Miamee, A. G., (2007), Periodically Correlated Random Sequences: Spectral Theory and Practice, Wiley InterScience.
</p>


<h3>See Also</h3>

<p><code>Bcoeff</code>, <code>perpacf</code>
</p>


<h3>Examples</h3>

<pre><code class="language-R">data(volumes)
dev.set(which=1)
peracf(t(volumes),24,seq(1,12),NaN,'volumes')
</code></pre>


</div>