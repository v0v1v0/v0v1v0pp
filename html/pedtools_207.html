<div class="container">

<table style="width: 100%;"><tr>
<td>getAlleles</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>Allele matrix manipulation</h2>

<h3>Description</h3>

<p>Functions for getting and setting the genotypes of multiple
individuals/markers simultaneously
</p>


<h3>Usage</h3>

<pre><code class="language-R">getAlleles(x, ids = NULL, markers = NULL)

setAlleles(x, ids = NULL, markers = NULL, alleles)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>x</code></td>
<td>
<p>A <code>ped</code> object or a list of such</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>ids</code></td>
<td>
<p>A vector of ID labels. If NULL (default) all individuals are
included.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>markers</code></td>
<td>
<p>A vector of indices or names of markers attaches to <code>x</code>. If
NULL (default) all markers are included.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>alleles</code></td>
<td>
<p>A character of the same format and dimensions as the output of
<code>getAlleles(x, ids, markers)</code>, or an object which can be converted by
<code>as.matrix()</code> into such a matrix. See Details.</p>
</td>
</tr>
</table>
<h3>Details</h3>

<p>If the <code>alleles</code> argument of <code>setAlleles()</code> is not a matrix, it is recycled
(if necessary), and converted into a matrix of the correct dimensions. For
example, setting <code>alleles = 0</code> gives a simple way of removing the genotypes
of some or all individuals (while keeping the markers attached).
</p>


<h3>Value</h3>

<p><code>getAlleles()</code> returns a character matrix with <code>length(ids)</code> rows and
<code>2 * length(markers)</code> columns. The ID labels of <code>x</code> are used as rownames,
while the columns are named <code style="white-space: pre;">⁠&lt;m1&gt;.1⁠</code>, <code style="white-space: pre;">⁠&lt;m1&gt;.2⁠</code>, ... where <code style="white-space: pre;">⁠&lt;m1&gt;⁠</code> is the
name of the first marker, a.s.o.
</p>
<p><code>setAlleles()</code> returns a <code>ped</code> object identical to <code>x</code>, except for the
modified alleles. In particular, all locus attributes are unchanged.
</p>


<h3>See Also</h3>

<p><code>transferMarkers()</code>
</p>


<h3>Examples</h3>

<pre><code class="language-R"># Setup: Pedigree with two markers
x = nuclearPed(1)
x = addMarker(x, `2` = "1/2", alleles = 1:2, name = "m1")
x = addMarker(x, `3` = "2/2", alleles = 1:2, name = "m2")

# Extract allele matrix
mat1 = getAlleles(x)
mat2 = getAlleles(x, ids = 2:3, markers = "m2")
stopifnot(identical(mat1[2:3, 3:4], mat2))

# Remove all genotypes
y = setAlleles(x, alleles = 0)
y

# Setting a single genotype
z = setAlleles(y, ids = "1", marker = "m2", alleles = 1:2)

# Alternative: In-place modification with `genotype()`
genotype(y, id = "1", marker = "m2") = "1/2"
stopifnot(identical(y,z))


### Manipulation of pedlist objects
s = transferMarkers(x, singleton("s"))
peds = list(x, s)

getAlleles(peds)

setAlleles(peds, ids = "s", marker = "m1", alleles = 1:2)

</code></pre>


</div>