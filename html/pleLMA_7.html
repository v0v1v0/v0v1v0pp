<div class="container">

<table style="width: 100%;"><tr>
<td>fit.nominal</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>Fits the nominal model</h2>

<h3>Description</h3>

<p>Function estimates the parameters of LMA models where the category scale
are estimated. The function can be used to estimate the parameters of the
LMA model corresponding the nominal model (for multi-category items) and
the 2 parameter logistic model for dichotomous items. The function sets
up log object(s) and model formula.  In the case of unidimensional models,
the function iterates over item regressions; whereas, for multidimensional
models, the function iterates between the item and phi regressions. This
function is called from 'ple.lma', but can be run outside of 'ple.lma'.
</p>


<h3>Usage</h3>

<pre><code class="language-R">fit.nominal(
  Master,
  Phi.mat,
  starting.sv,
  pq.mat,
  tol,
  PersonByItem,
  TraitByTrait,
  ItemByTrait,
  item.by.trait,
  ItemNames,
  LambdaNames,
  NuNames,
  LambdaName,
  NuName,
  PhiNames,
  npersons,
  nitems,
  ncat,
  nless,
  ntraits,
  Maxnphi
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>Master</code></td>
<td>
<p>Master data set in long format</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>Phi.mat</code></td>
<td>
<p>Matrix of starting values of the association parameters</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>starting.sv</code></td>
<td>
<p>Matrix starting values category scale values</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>pq.mat</code></td>
<td>
<p>Array used compute rest scores and total scores</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>tol</code></td>
<td>
<p>Value used to determine convergence of algorithm</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>PersonByItem</code></td>
<td>
<p>Same as inData (rows are response patterns)</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>TraitByTrait</code></td>
<td>
<p>Same as inTraitAdj (trait x trait adjacency)</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>ItemByTrait</code></td>
<td>
<p>Same as inItemTraitAdj (item x trait adjacency)</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>item.by.trait</code></td>
<td>
<p>One dimensional array indicating trait item loads on</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>ItemNames</code></td>
<td>
<p>Names of items in inData (i.e. columns names of
categorical variables)</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>LambdaNames</code></td>
<td>
<p>Lambda names used in the Master and stacked data frames</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>NuNames</code></td>
<td>
<p>Nu names in Master data frame</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>LambdaName</code></td>
<td>
<p>Lambda names in formula for items</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>NuName</code></td>
<td>
<p>Nu names in formula for item regressions</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>PhiNames</code></td>
<td>
<p>Association parameter names for stacked regression</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>npersons</code></td>
<td>
<p>Number of persons</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>nitems</code></td>
<td>
<p>Number of items</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>ncat</code></td>
<td>
<p>Number of categories per item</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>nless</code></td>
<td>
<p>ncat-1 = number unique lambda and unique nus</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>ntraits</code></td>
<td>
<p>Number of traits</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>Maxnphi</code></td>
<td>
<p>Number of association parametets</p>
</td>
</tr>
</table>
<h3>Value</h3>

<p>item.log 	 Iteration history of LogLike, lambda, and item parameters
</p>
<p>phi.log		 Iteration history of LogLike, lambdas and phi parameters
</p>
<p>criterion	 Current value of the convergence statistic
</p>
<p>estimates 	 Item x parameter matrix: LogLike, lambda and scale values
</p>
<p>Phi.mat	     Estimated conditional correlation matrix
</p>
<p>fitem		 Formula for item data
</p>
<p>fstack	     Formula for stacked data
</p>
<p>item.mlogit   Summaries from final run of mlogit for item regressions
</p>
<p>phi.mlogit	 Summary from final run of mlogit for stacked regression
</p>
<p>mlpl.item	 Max log pseudo-likelihood function from item regressions
</p>
<p>mlpl.phi      Maximum of log pseudo-likelihood function from stacked regression
</p>
<p>AIC           Akaike information criterion for pseudo-likelihood (smaller is better)
</p>
<p>BIC           Bayesian information criterion for pseudo-likelihood (smaller is better)
</p>


<h3>Examples</h3>

<pre><code class="language-R"> data(dass)
 inData &lt;- dass[1:250,c("d1", "d2", "d3", "a1","a2","a3","s1","s2","s3")]
 #--- unidimensional
 inTraitAdj  &lt;- matrix(1, nrow=1, ncol=1)
 inItemTraitAdj &lt;- matrix(1, nrow=9, ncol=1)
 s &lt;- set.up(inData, model.type='nominal', inTraitAdj, inItemTraitAdj,
           tol=1e-02)

 n1 &lt;- fit.nominal(s$Master, s$Phi.mat, s$starting.sv, s$pq.mat, s$tol,
       s$PersonByItem, s$TraitByTrait, s$ItemByTrait, s$item.by.trait,
       s$ItemNames, s$LambdaNames,  s$NuNames, s$LambdaName, s$NuName,
       s$PhiNames, s$npersons, s$nitems, s$ncat,s$ nless, s$ntraits,
       s$Maxnphi)

</code></pre>


</div>