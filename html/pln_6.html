<div class="container">

<table style="width: 100%;"><tr>
<td>nrmlepln</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>Full information maximum likelihood and bivariate composite likelihood estimation for
polytomous logit-normit (graded logistic) model</h2>

<h3>Description</h3>

<p>Full information maximum likelihood and bivariate composite likelihood estimation for
polytomous logit-normit and Rasch models, via Newton Raphson iterations.
</p>


<h3>Usage</h3>

<pre><code class="language-R">nrmlepln(x, ncat, nitem=NULL, alphas=NULL, betas=NULL, abound=c(-10,10),
         bbound=c(-1,10), nq=48, mxiter=200, m2=TRUE, iprint=FALSE)
nrmlerasch(x, ncat, nitem=NULL, alphas=NULL, abound=c(-10,10),
         bbound=c(-1,10), nq=48, mxiter=200, m2=TRUE, iprint=FALSE)
nrbcpln(x, ncat, nitem=NULL, alphas=NULL, betas=NULL, abound=c(-10,10),
         bbound=c(-1,10), nq=48, mxiter=200, se=TRUE, iprint=FALSE)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>x</code></td>
<td>
<p>A data matrix. Data can be in one of two formats: 1) raw data
where the number of rows corresponds to an individual's response and
each column represents an item, and 2) a matrix of dimensions
<code>nrec</code><code class="reqn">\times</code>(<code>nitem</code>+1) where each row corresponds to a
response pattern and the last column is the frequency of that response
pattern. A data matrix of the second type requires input for <code>nitem</code>
and <code>nrec</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>ncat</code></td>
<td>
<p>Number of ordinal categories for each item, coded as
0,...,(<code>ncat</code>-1). Currently supported are items that have the same number of categories.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>nitem</code></td>
<td>
<p>Number of items. If omitted, it is assumed that <code>x</code> contains
a data matrix of the first type (raw data) and the number of
columns in <code>x</code> will be selected as the number of items.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>alphas</code></td>
<td>
<p>A vector of length <code>nitem</code><code class="reqn">\times</code>(<code>ncat</code>-1)
corresponding to starting values for the (decreasing) cutpoints
for the items. If omitted, these will be computed from the function <code>startalphas</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>betas</code></td>
<td>
<p>A vector of length <code>nitem</code> corresponding to starting values for the
beta vectors of slopes. If omitted, these will be computed from the function
<code>startbetas</code>. For the polytomous logit-normit, there is one slope
for each item; for the Rasch model, there is a common slope beta for
all of the items.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>abound</code></td>
<td>
<p>Vector of length 2 that sets upper and lower bounds on parameter estimation for
alphas. Currently experimental; changing defaults it not recommended. Estimation problems
are more likely solved by changing starting values.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>bbound</code></td>
<td>
<p>Vector of length 2 that sets upper and lower bounds on parameter estimation for
betas. Currently experimental; changing defaults it not recommended. Estimation problems
are more likely solved by changing starting values.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>nq</code></td>
<td>
<p>Number of quadrature points to use during estimation. This argument is currently experimental. It is recommended to use the default of 48.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>mxiter</code></td>
<td>
<p>Maximum number of iterations for estimation.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>m2</code></td>
<td>
<p>Logical. If <code>TRUE</code>, computes goodness-of-fit statistics
from Maydeu-Olivares and Joe (2005, 2006; i.e., <code class="reqn">M_2</code>).</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>iprint</code></td>
<td>
<p>Logical. Enables debugging / diagnostic information from C code that conducts
estimation.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>se</code></td>
<td>
<p>Logical. If <code>TRUE</code>, calculates standard errors for the bivariate composite
likelihood method.</p>
</td>
</tr>
</table>
<h3>Details</h3>

<p>Estimation of graded logistic models is performed under the following parameterization:
</p>
<p style="text-align: center;"><code class="reqn">Pr(y_i = k_i| \eta) = \left\{
 \begin{array}{ll}
 1-\Psi (\alpha_{i,k} + \beta_i \eta) &amp; \mbox{if  } k_i = 0\\
 \Psi (\alpha_{i,k} + \beta_i \eta) - \Psi (\alpha_{i,k+1} + \beta_i \eta) &amp; \mbox{if  } 0 &lt; k_i &lt; m-1\\
 \Psi (\alpha_{i,k+1} + \beta_i \eta) &amp; \mbox{if  } k_i = m-1
 \end{array} \right. </code>
</p>

<p>Where the items are <code class="reqn">y_i, i = 1, \dots, n</code>, and response categories are <code class="reqn">k=0, \dots, m-1</code>. <code class="reqn">\eta</code> is the latent trait, <code class="reqn">\Psi</code> is the logistic distribution function, <code class="reqn">\alpha</code> is an intercept (cutpoint) parameter, and <code class="reqn">\beta</code> is a slope parameter. When the number of categories for the items is 2, this reduces to the 2PL parameterization:
</p>
<p style="text-align: center;"><code class="reqn">Pr(y_i = 1| \eta) = \Psi (\alpha_1 + \beta_i \eta)</code>
</p>

<p>Both <code>nrmlepln</code> and <code>nrbcpln</code> perform estimation under these parameterizations, via Newton Raphson iterations, using full information maximum likelihood (<code>nrmlepln</code>) and bivariate composite likelihood (<code>nrbcpln</code>). See Maydeu-Olivares and Joe (2005, 2006) for more information on bivariate composite likelihood estimation (see also Varin, Reid, and Firth, 2011). Under <code>nrmlerasch</code> a common <code class="reqn">\beta</code> parameter is estimated for all items.
</p>


<h3>Value</h3>

<p>A list containing the following slots.
</p>


<h3>Slots</h3>


<dl>
<dt><code>alphas</code></dt>
<dd>
<p>A vector of parameter estimates for alphas. Length is
<code>nitem</code><code class="reqn">\times</code>(<code>ncat</code>-1). Estimates are in order by item, e.g., all alphas
for item 1, followed by all alphas for item 2, and so on.</p>
</dd>
<dt><code>betas</code></dt>
<dd>
<p>A vector of parameter estimates for betas. Length is <code>nitem</code>.</p>
</dd>
<dt><code>nllk</code></dt>
<dd>
<p>Negative (composite) log-likelihood for polytomous 
logit-normit (or Rasch) model.</p>
</dd>
<dt><code>conv</code></dt>
<dd>
<p>Integer indicating whether estimation converged. Currently only returned for
composite likelihood estimation.</p>
</dd>
<dt><code>sealphas</code></dt>
<dd>
<p>A vector of standard errors for the alpha estimates.</p>
</dd>
<dt><code>sebetas</code></dt>
<dd>
<p>A vector of standard errors for the beta estimates.</p>
</dd>
<dt><code>invhes</code></dt>
<dd>
<p>Inverse Hessian matrix for the MLE estimates.</p>
</dd>
<dt><code>vcov</code></dt>
<dd>
<p>Asymptotic covariance matrix for the composite likelihood estimates.</p>
</dd>
<dt><code>teststat</code></dt>
<dd>
<p>Value of <code class="reqn">M_2</code>.</p>
</dd>
<dt><code>df</code></dt>
<dd>
<p>Degrees of freedom for <code class="reqn">M_2</code>.</p>
</dd>
<dt><code>pval</code></dt>
<dd>
<p>P-value for <code class="reqn">M_2</code>.</p>
</dd>
</dl>
<h3>Author(s)</h3>

<p>Carl F. Falk <a href="mailto:cffalk@gmail.com">cffalk@gmail.com</a>, Harry Joe
</p>


<h3>References</h3>

<p>Bartholomew, D., Knott, M., and Moustaki, I. (2011). <em>Latent Variable 
Models and Factor Analysis: A Unified Approach</em>, 3rd Edition. Wiley. 
</p>
<p>Maydeu-Olivares, A., and Joe, H. (2005). Limited and full information estimation
and goodness-of-fit testing in <code class="reqn">2^n</code> contingency tables: A unified framework.
<em>Journal of the American Statistical Association, 100</em>, 1009-1020.
</p>
<p>Maydeu-Olivares, A., and Joe, H. (2006). Limited information and goodness-of-fit
testing in multidimensional contingency tables. <em>Psychometrika, 71</em>,
713-732.
</p>
<p>Varin, C., Reid, N. and Firth, D. (2011). An overview of composite likelihood
methods. <em>Statistica Sinica, 21</em>, 5-42.
</p>


<h3>See Also</h3>

<p><code>startalphas</code>
<code>startbetas</code>
</p>


<h3>Examples</h3>

<pre><code class="language-R"> ### Matrix of response patterns and frequencies
 data(item5fr)
 
 ## ML estimation
 nrmleplnout&lt;-nrmlepln(item5fr, ncat=3, nitem=5)
 print(nrmleplnout)
 
 ## BCL estimation
 nrbcplnout&lt;-nrbcpln(item5fr, ncat=3, nitem=5)
 print(nrbcplnout)
 
 ## ML Rasch estimation
 nrmleraschout&lt;-nrmlerasch(item5fr, ncat=3, nitem=5)
 print(nrmleraschout)
 
 
 ### Raw data
 data(item9cat5)
 
 ## ML estimation
 nrmleplnout&lt;-nrmlepln(item9cat5, ncat=5)
 print(nrmleplnout)
 
 ## BCL estimation
 nrbcplnout&lt;-nrbcpln(item9cat5, ncat=5, se=FALSE)
 print(nrbcplnout)
 
 ## ML Rasch estimation
 nrmleraschout&lt;-nrmlerasch(item9cat5, ncat=5)
 print(nrmleraschout)
 

</code></pre>


</div>