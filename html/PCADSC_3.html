<div class="container">

<table style="width: 100%;"><tr>
<td>chromaPlot</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>Chroma plot</h2>

<h3>Description</h3>

<p>Produce a chroma plot from a full or partial <code>PCADSC</code> object, as obtained
from a call to <code>PCADSC</code>. In either case, this <code>PCADSC</code> object must have a
non-<code>NULL</code> <code>chromaInfo</code> slot (see examples). The chroma plot compares the loading
patterns from PCA conducted on two datasets consisting of different observations of the
same variables.
</p>


<h3>Usage</h3>

<pre><code class="language-R">chromaPlot(x, varLabels = NULL, cvCO = 1, splitLabels = NULL,
  varAnnotation = "cum", useComps = NULL)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>x</code></td>
<td>
<p>Either a <code>PCADSC</code> object or a <code>chromaInfo</code> object, as produced
by <code>PCADSC</code> and <code>doChroma</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>varLabels</code></td>
<td>
<p>A vector of character string labels for the variables used in
<code>pcadscObj</code>. If non-<code>NULL</code>, these labels appear in the plot instead of the
variable names.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>cvCO</code></td>
<td>
<p>A numeric in the interval <code class="reqn">[0,1]</code> where the default, <code>1</code>, corresponds
to no cut-off value. If a value smaller than 1, only the first <code class="reqn">n</code> components are plotted,
where <code class="reqn">n</code> is the the lowest possible number, such that the cumulative variance contribution
of the first <code class="reqn">n</code> components exceeds <code>cvCO</code> for both datasets. Note that setting
<code>covCO</code> will overrule the argument <code>useComps</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>splitLabels</code></td>
<td>
<p>Labels for the two categories of the splitting variable used
to create the <code>PCADSC</code> object, <code>x</code>, given as a named list (see examples).
These labels will appear in the headers of the two PCADSC plots.
If <code>NULL</code> (the default), the original levels of the splitting variable
are used.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>varAnnotation</code></td>
<td>
<p>If <code>"cum"</code> (the default), cummulated explained variance
percentages are annotated to the right of the bars for each component. If <code>"raw"</code>,
the non-cummulated percentages of explained variance are added instead. If <code>NULL</code>,
no annotation is added. Note that <code>"cum"</code> is only allowed if <code>useComps</code> is
non-<code>NULL</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>useComps</code></td>
<td>
<p>A vector of integers with the indexes of the principal component
that should be included in the plot.</p>
</td>
</tr>
</table>
<h3>Details</h3>

<p>The plot consists of one display for each of the two datasets. The two displays both
consist of a number of vertical bars. Each vertical bar represents a principal component and the
width of each colored section (chroma) within the bar corresponds to the normalized PCA loading
vector of that component. The bars can be annotated with the (cumulative) variance contributions
of the components (see <code>varAnnotation</code>).
</p>


<h3>See Also</h3>

<p><code>PCADSC</code>, <code>doChroma</code>
</p>


<h3>Examples</h3>

<pre><code class="language-R">#load iris data
data(iris)

#Define grouping variable, grouping the observations by whether their species is
#Setosa or not
iris$group &lt;- "setosa"
iris$group[iris$Species != "setosa"] &lt;- "non-setosa"
iris$Species &lt;- NULL

## Not run: 
#make a PCADSC object, splitting the data by "group"
irisPCADSC &lt;- PCADSC(iris, "group")

#make a partial PCADSC object from iris and fill out chromaInfo in the next call
irisPCADSC2 &lt;- PCADSC(iris, "group", doChroma = FALSE)
irisPCADSC2 &lt;- doChroma(irisPCADSC2)

#make a chroma plot
chromaPlot(irisPCADSC)
chromaPlot(irisPCADSC)

#Change the labels of the splitting variable
chromaPlot(irisPCADSC, splitLabels = list("non-setosa" = "Not Setosa",
    "setosa" = "Setosa"))

#Only plot components 1 and 4 and remove annotated variances
chromaPlot(irisPCADSC, useComps = c(1,4), varAnnotation = "no")

#Only plot the first components responsible for explaining 80 percent variance
chromaPlot(irisPCADSC, cvCO = 0.8)

#Change variable labels
chromaPlot(irisPCADSC, varLabels = c("Sepal length", "Sepal width", "Petal length",
   "Petal width"))

## End(Not run)

#Only do chroma information in order to get a faster runtime:
irisPCADSC_fast &lt;- PCADSC(iris, "group", doCE = FALSE,
  doAngle = FALSE)
chromaPlot(irisPCADSC_fast)

</code></pre>


</div>