<div class="container">

<table style="width: 100%;"><tr>
<td>pbvnorm</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>
Probabilities for Bivariate Normal Distribution
</h2>

<h3>Description</h3>

<p>The function <code>pbvnorm</code> computes probabilities <code class="reqn">\Phi_2(x,y,\rho)</code> for
the standardized bivariate normal distribution (Drezner &amp; Wesolowsky, 1990;
West, 2004).
</p>
<p>The function <code>dbvnorm</code> computes the corresponding density <code class="reqn">\phi_2(x,y,\rho)</code>.
</p>


<h3>Usage</h3>

<pre><code class="language-R">pbvnorm(x, y, rho)

dbvnorm(x, y, rho, log=FALSE)

## exported Rcpp functions
pbv_rcpp_pbvnorm0( h1, hk, r)
pbv_rcpp_pbvnorm( x, y, rho)
pbv_rcpp_dbvnorm0( x, y, rho, use_log)
pbv_rcpp_dbvnorm( x, y, rho, use_log)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>x</code></td>
<td>

<p>Vector of first ordinate
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>y</code></td>
<td>

<p>Vector of second ordinate
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>rho</code></td>
<td>

<p>Vector of correlations
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>log</code></td>
<td>
<p>Logical indicating whether logarithm of the density
should be calculated</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>h1</code></td>
<td>
<p>Numeric</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>hk</code></td>
<td>
<p>Numeric</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>r</code></td>
<td>
<p>Numeric</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>use_log</code></td>
<td>
<p>Logical</p>
</td>
</tr>
</table>
<h3>Value</h3>

<p>A vector
</p>


<h3>Note</h3>

<p>The <span class="pkg">pbv</span> package can also be used to include <a href="https://CRAN.R-project.org/package=Rcpp"><span class="pkg">Rcpp</span></a> functions for
computing bivariate probabilities at the C++ level. Numeric and vector versions are
<br><br><code>double pbv::pbv_rcpp_pbvnorm0( double h1, double hk, double r)</code> <br><br><code>Rcpp::NumericVector pbv::pbv_rcpp_pbvnorm( Rcpp::NumericVector x, </code><br><code>     Rcpp::NumericVector y, Rcpp::NumericVector rho)</code>
</p>


<h3>References</h3>

<p>Drezner, Z., &amp; Wesolowsky, G. O. (1990). On the computation of the bivariate normal
integral. <em>Journal of Statistical Computation and Simulation, 35</em>(1-2), 101-107.
<a href="https://doi.org/10.1080/00949659008811236">doi:10.1080/00949659008811236</a>
</p>
<p>Genz, A. (1992). Numerical computation of multivariate normal probabilities.
<em>Journal of Computational and Graphical Statistics, 1</em>(2), 141-149.
</p>
<p>West, G. (2005). Better approximations to cumulative normal functions.
<em>Wilmott Magazine, 9</em>, 70-76.
</p>


<h3>See Also</h3>

<p>See <code>pbivnorm::pbivnorm</code> in the <span class="pkg">pbivnorm</span> package
and <code>mnormt::biv.nt.prob</code> in the <span class="pkg">mnormt</span> package
for alternative implementations (Genz, 1992).
</p>


<h3>Examples</h3>

<pre><code class="language-R">#############################################################################
# EXAMPLE 1: Comparison with alternative implementations
#############################################################################

#*** simulate different values of ordinates and correlations
set.seed(9898)
N &lt;- 3000
x &lt;- stats::runif(N,-3,3)
y &lt;- stats::runif(N,-3,3)
rho &lt;- stats::runif(N,-.95,.95)

#*** compute probabilities
res1 &lt;- pbv::pbvnorm(x=x,y=y,rho=rho)

## Not run: 
#-- compare results with pbivnorm package
library(pbivnorm)
res2 &lt;- pbivnorm::pbivnorm(x=x, y=y, rho=rho)

summary(abs(res1-res2))

#*** compute density values
log &lt;- TRUE    # logical indicating whether log density should be evaluated
res1 &lt;- pbv::dbvnorm(x=x, y=y, rho=rho, log=log )

#-- compare results with mvtnorm package
library(mvtnorm)
res2 &lt;- rep(NA, N)
sigma &lt;- diag(2)
for (ii in 1:N){
    sigma[1,2] &lt;- sigma[2,1] &lt;- rho[ii]
    res2[ii] &lt;- mvtnorm::dmvnorm(x=c(x[ii],y[ii]), sigma=sigma, log=log)
}
summary(abs(res1-res2))

## End(Not run)
</code></pre>


</div>