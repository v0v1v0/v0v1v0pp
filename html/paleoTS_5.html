<div class="container">

<table style="width: 100%;"><tr>
<td>bootSimpleComplex</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>Bootstrap test to see if a complex model is significantly better than a simple
model.</h2>

<h3>Description</h3>

<p>Bootstrap test to see if a complex model is significantly better than a simple
model.
</p>


<h3>Usage</h3>

<pre><code class="language-R">bootSimpleComplex(
  y,
  simpleFit,
  complexFit,
  nboot = 99,
  minb = 7,
  ret.full.distribution = FALSE,
  parallel = FALSE,
  ...
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>y</code></td>
<td>
<p>a <code>paleoTS</code> object</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>simpleFit</code></td>
<td>
<p>a <code>paleoTSfit</code> object, representing the model fit of a
simple model</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>complexFit</code></td>
<td>
<p>a <code>paleoTSfit</code> object, representing the model fit of a
complex model</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>nboot</code></td>
<td>
<p>number of replications for parametric bootstrapping</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>minb</code></td>
<td>
<p>minimum number of populations within each segment</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>ret.full.distribution</code></td>
<td>
<p>logical, indicating if the null distribution for
the likelihood ratio from the parametric bootstrap should be returned</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>parallel</code></td>
<td>
<p>logical, if TRUE, the bootstrapping is done using parallel
computing</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>...</code></td>
<td>
<p>further arguments, passed to optimization functions</p>
</td>
</tr>
</table>
<h3>Details</h3>

<p>Simulations suggest that AICc can be overly liberal with complex
models with mode shifts or punctuations (Hunt et al., 2015). This function
implements an alternative of parametric boostrapping to compare the fit of a
simple model with a complex model. It proceeds in five steps: </p>

<ol>
<li>
<p> Compute the observed gain in support from the simple to complex model
as the likelihood ratio, <code class="reqn">LR_{obs} = -2(logL_{simple} - logL_{complex}) </code> </p>
</li>
<li>
<p>Simulate trait evolution under the specified simple model <code>nboot</code> times
</p>
</li>
<li>
<p> Fit to each simulated sequence the specified simple and complex models
</p>
</li>
<li>
<p> Measure the gain in support from simple to complex as the bootstrap
likelihood ratio for each simulated sequence </p>
</li>
<li>
<p> Compute the P-value as the
percentile of the bootstrap distribution corresponding to the observed LR. </p>
</li>
</ol>
<p>Argument <code>simpleFit</code> should be a <code>paleoTS</code> object returned by the
function <code>fitSimple</code> or similar functions (e.g., <code>opt.joint.GRW,
opt.GRW</code>, etc.). Argument <code>complexFit</code> must be a <code>paleoTS</code> object
returned by <code>fitGpunc</code> or <code>fitModeShift</code>.
</p>
<p>Calculations can be speeded up by setting <code>parallel = TRUE</code>, which uses
package <code>doParallel</code> to run the bootstrap replicates in parallel, using
one fewer than the number of detected cores.
</p>


<h3>Value</h3>

<p>A list of the observed likelihood ratio statistic, <code>LRobs</code>, the
P-value of the test, and the number of bootstrap replicates. If
<code>ret.full.distribution = TRUE</code>, the null distribution of likelihood
ratios generated by parametric bootstrapping is also returned.
</p>


<h3>References</h3>

<p>Hunt, G., M. J. Hopkins and S. Lidgard. 2015. Simple versus
complex models of trait evolution and stasis as a response to environmental
change. PNAS 112(16): 4885-4890.
</p>


<h3>See Also</h3>

<p><code>sim.Stasis.RW</code>, <code>fitModeShift</code>
</p>


<h3>Examples</h3>

<pre><code class="language-R">## Not run: 
x &lt;- sim.Stasis.RW(ns = c(15, 15), omega = 0.5, ms = 1, order = "Stasis-RW")
ws &lt;- fitSimple(x)
wc &lt;- fitModeShift(x, order = "Stasis-RW", rw.model = "GRW")
bootSimpleComplex(x, ws, wc, nboot = 50, minb = 7)  # nboot too low for real analysis!

## End(Not run)
</code></pre>


</div>