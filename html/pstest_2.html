<div class="container">

<table style="width: 100%;"><tr>
<td>pstest</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>pstest: Tests for the Propensity Score</h2>

<h3>Description</h3>

<p><em>pstest</em> computes Kolmogorov-Smirnov and Cramer-von Mises type tests
for the null hypothesis that a parametric model for the propensity score is
is correctly specified. For details of the testing procedure, see
Sant'Anna and Song (2016),'Specification Tests for the Propensity Score'.
</p>


<h3>Usage</h3>

<pre><code class="language-R">pstest(d, pscore, xpscore, pscore.model = NULL, model = "logit",
  w = "ind", dist = "Mammen", nboot = 1000, cores = 1,
  chunk = 1000)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>d</code></td>
<td>
<p>a vector containing the binary treatment indicator.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>pscore</code></td>
<td>
<p>a vector containing the estimated propensity scores.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>xpscore</code></td>
<td>
<p>a matrix (or data frame) containing the covariates (and their
transformations) included in the propensity score
estimation. It should also include the constant term.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>pscore.model</code></td>
<td>
<p>in case you you set model="het.probit", pscore.model is the entire hetglm object.
Default for pscore.model is NULL.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>model</code></td>
<td>
<p>a description of the functional form (link function) used
to estimated propensity score. The alternatives are:
'logit' (default), 'probit', and het.probit</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>w</code></td>
<td>
<p>a description of which weight function the projection is based on.
The alternatives are 'ind' (default), which set <code class="reqn">w(q,u)=1(q&lt;=u)</code>,
'exp', which set <code class="reqn">w(q,u)=exp(qu)</code>, 'logistic', which set
<code class="reqn">w(q,u)=1/[1+exp(1-qu)]</code>, 'sin', which set <code class="reqn">w(q,u)=sin(qu)</code>, and
'sincos', which set <code class="reqn">w(q,u)=sin(qu)+cos(qu)</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>dist</code></td>
<td>
<p>a description of which distribution to use during the bootstrap.
The alternatives are 'Mammen' (default), and 'Rademacher'.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>nboot</code></td>
<td>
<p>number of bootstrap replicates to perform. Default is 1,000.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>cores</code></td>
<td>
<p>number of cores to use during the bootstrap. Default is 1.
If cores is greater than 1, the bootstrap is conducted using
parLapply, instead of lapply type call.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>chunk</code></td>
<td>
<p>a value that determine the size of each 'tile'. Such argument is used
to split the original data into chunks, saving memory.
Default value is 1,000. If the <em>pstest</em> function throw a
memory error, you should choose a smaller value for <em>chunk</em>.</p>
</td>
</tr>
</table>
<h3>Value</h3>

<p>a list containing the Kolmogorov-Smirnov and Cramer-von Mises test
statistics for the null hypothesis of correctly specified propensity
score model (kstest and cvmtest, respectively), and their associate
bootstrapped p-values, pvks and pvcvm, respectively. All inputs are also
returned.
</p>


<h3>References</h3>

<p>Sant'Anna, Pedro H. C, and Song, Xiaojun (2019), <em>Specification Tests for the Propensity Score</em>,
Journal of Econometrics, vol. 210 (2), p. 379-404.
</p>


<h3>Examples</h3>

<pre><code class="language-R"># Example based on simulation data
# Simulate vector of covariates
set.seed(1234)
x1 &lt;- runif(100)
x2 &lt;- rt(100, 5)
x3 &lt;- rpois(100, 3)
# generate treatment status score based on Probit Specification
treat &lt;- (x1 + x2 + x3 &gt;= rnorm(100, 4, 5))
# estimate correctly specified propensity score based on Probit
pscore &lt;- stats::glm(treat ~ x1 + x2 + x3, family = binomial(link = "probit"),
              x = TRUE)
# Test the correct specification of estimated propensity score, using
# the weight function 'ind', and bootstrap based on 'Mammen'.
pstest(d = pscore$y, pscore = pscore$fit, xpscore = pscore$x,
       model = "probit", w = "ind", dist = "Mammen")
# Alternatively, one can use the 'sin' weight function
pstest(d = pscore$y, pscore = pscore$fit, xpscore = pscore$x,
       model = "probit", w = "sin", dist = "Mammen")

</code></pre>


</div>