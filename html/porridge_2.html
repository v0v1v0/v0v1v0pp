<div class="container">

<table style="width: 100%;"><tr>
<td>genRidgePenaltyMat</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>
Penalty parameter matrix for generalized ridge regression.
</h2>

<h3>Description</h3>

<p>The function produces an unscaled penalty parameter matrix to be used in the generalized ridge regression estimator.
</p>


<h3>Usage</h3>

<pre><code class="language-R">genRidgePenaltyMat(pr, pc=pr, type="2dimA")
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>pr</code></td>
<td>
<p> A positive <code>integer</code>. The number of covariates if <code>type="common"</code> or 
<code>type="fused1dim"</code>. Or, the row dimension of a 2-dimensional covariate layout if <code>type="fused2dimA"</code> or <code>type="fused2dimD"</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>pc</code></td>
<td>
<p> A positive <code>integer</code>. The column dimension of a 2-dimensional covariate layout if <code>type="fused2dimA"</code> or <code>type="fused2dimD"</code>. Ignored if <code>type="common"</code> or <code>type="fused1dim"</code>. </p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>type</code></td>
<td>
<p> A <code>character</code>. Either <code>"common"</code>, <code>"fused1dim"</code>, <code>"fused2dimA"</code> or <code>"fused2dimD"</code>, see details. </p>
</td>
</tr>
</table>
<h3>Details</h3>

<p>Various ridge penalty matrices are implemented. 
</p>
<p>The <code>type="common"</code>-option supports the ‘homogeneity’ ridge penalization proposed by Anatolyev (2020). The ridge penalty matrix <code class="reqn">\mathbf{\Delta}</code> for a <code class="reqn">p</code>-dimensional regression parameter <code class="reqn">\boldsymbol{\beta}</code> is such that:
</p>
<p style="text-align: center;"><code class="reqn">
\boldsymbol{\beta}^{\top} \mathbf{\Delta} \boldsymbol{\beta} \, \, = \, \, \boldsymbol{\beta}^{\top} ( \mathbf{I}_{pp} - p^{-1} \mathbf{1}_{pp}) \boldsymbol{\beta}  \, \, =  \, \, \sum\nolimits_{j=1}^p \big( \beta_j -
p^{-1} \sum\nolimits_{j'=1}^p \beta_{j'}\big)^2.
</code>
</p>

<p>This penalty matrix encourages shrinkage of the elements of <code class="reqn">\boldsymbol{\beta}</code> to a common effect value.
</p>
<p>The <code>type="fused1dim"</code>-option facilitates the 1-dimensional fused ridge estimation of Goeman (2008). The ridge penalty matrix <code class="reqn">\mathbf{\Delta}</code> for a <code class="reqn">p</code>-dimensional regression parameter <code class="reqn">\boldsymbol{\beta}</code> is such that:
</p>
<p style="text-align: center;"><code class="reqn">
\boldsymbol{\beta}^{\top} \mathbf{\Delta} \boldsymbol{\beta} \, \, = \, \, \sum\nolimits_{j=2}^p ( \beta_{j} - \beta_{j-1} )_2^2.
</code>
</p>

<p>This penalty matrix aims to shrink contiguous (as defined by their index) elements of <code class="reqn">\boldsymbol{\beta}</code> towards each other.
</p>
<p>The <code>type="fused2dimA"</code>- and  <code>type="fused2dimD"</code>-options facilitate 2-dimensional ridge estimation as proposed by Lettink et al. (2022). It assumes the regression parameter is endowed with a 2-dimensional layout. The columns of this layout have been stacked to form <code class="reqn">\boldsymbol{\beta}</code>. The 2-dimensional fused ridge estimation shrinks elements of <code class="reqn">\boldsymbol{\beta}</code> that are neighbors in the 2-dimensional layout towards each other. The two options use different notions of neighbors. If <code>type="fused2dimA"</code>, the ridge penalty matrix <code class="reqn">\mathbf{\Delta}</code> for a <code class="reqn">p</code>-dimensional regression parameter <code class="reqn">\boldsymbol{\beta}</code> is such that:
</p>
<p style="text-align: center;"><code class="reqn">
\boldsymbol{\beta}^{\top} \mathbf{\Delta} \boldsymbol{\beta} \, \,  = \, \,  \sum\nolimits_{j_r=1}^{p_r-1} \sum\nolimits_{j_c=1}^{p_c-1} [(\beta_{j_r,j_c+1} - \beta_{j_r,j_c})^2 + (\beta_{j_r+1, j_c} - \beta_{j_r, j_c})^2]
</code>
</p>

<p style="text-align: center;"><code class="reqn">
\mbox{ } \qquad \qquad \, \, \, \, + \sum\nolimits_{j_c=1}^{p_c-1} (\beta_{p_r,j_c+1} - \beta_{p_r,j_c})^2 +  \sum\nolimits_{j_r=1}^{p_r-1}  (\beta_{j_r+1, p_c} - \beta_{j_r, p_c})^2,
</code>
</p>

<p>where <code class="reqn">p_r</code> and <code class="reqn">p_c</code> are the row and column dimension, respectively, of the 2-dimensional layout. This penalty matrix intends to shrink the elements of <code class="reqn">\boldsymbol{\beta}</code> along the axes of the 2-dimensional layout. If <code>type="fused2dimD"</code>, the ridge penalty matrix <code class="reqn">\mathbf{\Delta}</code> for a <code class="reqn">p</code>-dimensional regression parameter <code class="reqn">\boldsymbol{\beta}</code> is such that:
</p>
<p style="text-align: center;"><code class="reqn">
\boldsymbol{\beta}^{\top} \mathbf{\Delta} \boldsymbol{\beta} \, \,  = \, \, 
\sum\nolimits_{j_r=1}^{p_r-1} \sum\nolimits_{j_c=1}^{p_c-2}  [(\beta_{j_r+1,j_c} - \beta_{j_r,j_c+1})^2 + (\beta_{j_r+1, j_c+2} - \beta_{j_r, j_c+1})^2]
</code>
</p>

<p style="text-align: center;"><code class="reqn">
\mbox{ } \qquad \, + \sum\nolimits_{j_r=1}^{p_r-1} [(\beta_{j_r+1,2} - \beta_{j_r,1})^2 + (\beta_{j_r+1, p_c-1} - \beta_{j_r, p_c})^2].
</code>
</p>

<p>This penalty matrix shrinks the elements of <code class="reqn">\boldsymbol{\beta}</code> along the diagonally to the axes of the 2-dimensional layout. The penalty matrices 
generated by <code>type="fused2dimA"</code>- and  <code>type="fused2dimD"</code>-options may be combined. 
</p>


<h3>Value</h3>

<p>The function returns a non-negative definite <code>matrix</code>.
</p>


<h3>Author(s)</h3>

<p>W.N. van Wieringen.
</p>


<h3>References</h3>

<p>Anatolyev, S. (2020), "A ridge to homogeneity for linear models", <em>Journal of Statistical Computation and Simulation</em>, 90(13), 2455-2472.
</p>
<p>Goeman, J.J. (2008), "Autocorrelated logistic ridge regression for prediction based on proteomics spectra", <em>Statistical Applications in Genetics and Molecular Biology</em>, 7(2).
</p>
<p>Lettink, A, Chinapaw, M.J.M., van Wieringen, W.N. (2022), "Two-dimensional fused targeted ridge regression for health indicator prediction from accelerometer data", <em>submitted</em>.
</p>


<h3>See Also</h3>

<p><code>ridgeGLM</code>
</p>


<h3>Examples</h3>

<pre><code class="language-R"># generate unscaled general penalty parameter matrix
Dfused &lt;- genRidgePenaltyMat(10, type="fused1dim")
</code></pre>


</div>