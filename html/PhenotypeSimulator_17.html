<div class="container">

<table style="width: 100%;"><tr>
<td>runSimulation</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>Run phenotype simulation.</h2>

<h3>Description</h3>

<p>runSimulation wraps around setModel, the phenotype component functions 
(genFixedEffects, genBgEffects, noiseBgEffects, noiseFixedEffects and 
correlatedBgEffects), rescales each component and combines them into the 
final phenotype. For details to all parameters, see the respective functions.
</p>


<h3>Usage</h3>

<pre><code class="language-R">runSimulation(
  N,
  P,
  genVar = NULL,
  h2s = NULL,
  theta = 0.8,
  h2bg = NULL,
  eta = 0.8,
  noiseVar = NULL,
  rho = NULL,
  delta = NULL,
  gamma = 0.8,
  phi = NULL,
  alpha = 0.8,
  tNrSNP = 5000,
  cNrSNP = 20,
  SNPfrequencies = c(0.1, 0.2, 0.4),
  genotypefile = NULL,
  format = "delim",
  genoFilePrefix = NULL,
  genoFileSuffix = NULL,
  genoDelimiter = ",",
  skipFields = NULL,
  header = FALSE,
  probabilities = FALSE,
  chr = NULL,
  NrSNPsOnChromosome = NULL,
  NrChrCausal = NULL,
  kinshipfile = NULL,
  kinshipHeader = FALSE,
  kinshipDelimiter = ",",
  standardise = TRUE,
  distBetaGenetic = "norm",
  mBetaGenetic = 0,
  sdBetaGenetic = 1,
  pTraitsAffectedGenetics = 1,
  pIndependentGenetic = 0.4,
  pTraitIndependentGenetic = 0.2,
  keepSameIndependentSNPs = FALSE,
  NrFixedEffects = 1,
  NrConfounders = 10,
  distConfounders = "norm",
  mConfounders = 0,
  sdConfounders = 1,
  catConfounders = NULL,
  probConfounders = NULL,
  distBetaConfounders = "norm",
  mBetaConfounders = 0,
  sdBetaConfounders = 1,
  pTraitsAffectedConfounders = 1,
  pIndependentConfounders = 0.4,
  pTraitIndependentConfounders = 0.2,
  keepSameIndependentConfounders = FALSE,
  pcorr = 0.8,
  corrmatfile = NULL,
  meanNoiseBg = 0,
  sdNoiseBg = 1,
  nonlinear = NULL,
  logbase = 10,
  expbase = NULL,
  power = NULL,
  customTransform = NULL,
  transformNeg = "abs",
  proportionNonlinear = 0,
  sampleID = "ID_",
  phenoID = "Trait_",
  snpID = "SNP_",
  seed = 219453,
  verbose = FALSE
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>N</code></td>
<td>
<p>Number [integer] of samples to simulate.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>P</code></td>
<td>
<p>Number [integer] of phenotypes to simulate.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>genVar</code></td>
<td>
<p>Proportion [double] of total genetic variance.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>h2s</code></td>
<td>
<p>Proportion [double] of genetic variance of genetic variant effects.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>theta</code></td>
<td>
<p>Proportion [double] of variance of shared genetic variant 
effects.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>h2bg</code></td>
<td>
<p>Proportion [double] of genetic variance of infinitesimal genetic 
effects; either h2s or h2bg have to be specified and h2s + h2bg = 1.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>eta</code></td>
<td>
<p>Proportion [double] of variance of shared infinitesimal genetic 
effects.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>noiseVar</code></td>
<td>
<p>Proportion [double] of total noise variance.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>rho</code></td>
<td>
<p>Proportion [double] of noise variance of correlated effects; sum 
of rho, delta and phi has to be equal 1.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>delta</code></td>
<td>
<p>Proportion [double] of noise variance of non-genetic covariate 
effects; sum of rho, delta and phi  has to be equal 1.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>gamma</code></td>
<td>
<p>Proportion [double] of variance of shared non-genetic covariate 
effects.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>phi</code></td>
<td>
<p>Proportion [double] of noise variance of observational noise 
effects; sum of rho, delta and phi has to be equal 1.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>alpha</code></td>
<td>
<p>Variance [double] of shared observational noise effect.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>tNrSNP</code></td>
<td>
<p>Total number [integer] of SNPs to simulate; these SNPs are used
for kinship estimation.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>cNrSNP</code></td>
<td>
<p>Number [integer] of causal SNPs; used as genetic variant 
effects.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>SNPfrequencies</code></td>
<td>
<p>Vector of allele frequencies [double] from which to 
sample.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>genotypefile</code></td>
<td>
<p>Needed when reading external genotypes (into memory), 
path/to/genotype file [string] in format specified by format.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>format</code></td>
<td>
<p>Needed when reading external genotypes, specifies 
the format of the genotype data; has to be one of plink, oxgen, genome, 
bimbam and delim when reading files into memory, or one of oxgen, bimbam or
delim if sampling genetic variants from file; for details see
readStandardGenotypes and getCausalSNPs.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>genoFilePrefix</code></td>
<td>
<p>Needed when sampling cuasal SNPs from file, full 
path/to/chromosome-wise-genotype-file-ending-before-"chrChromosomeNumber" 
(no '~' expansion!) [string]</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>genoFileSuffix</code></td>
<td>
<p>Needed when sampling causal SNPs from file, 
following chromosome number including fileformat (e.g. ".csv") [string]</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>genoDelimiter</code></td>
<td>
<p>Field separator [string] of genotypefile or genoFile if
format == delim.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>skipFields</code></td>
<td>
<p>Number [integer] of fields (columns) in to skip in 
genoFilePrefix-genoFileSuffix-file. See details in getCausalSNPs if
format == delim.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>header</code></td>
<td>
<p>[logical] Can be set to indicate if
genoFilePrefix-genoFileSuffix file has a header for format == 'delim'. 
See details in getCausalSNPs.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>probabilities</code></td>
<td>
<p>[bool]. If set to TRUE, the genotypes in the files 
described by genoFilePrefix and genoFileSuffix are provided as triplets of 
probablities (p(AA), p(Aa), p(aa)) and are converted into their expected 
genotype frequencies by 0*p(AA) + p(Aa) + 2p(aa) via probGen2expGen.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>chr</code></td>
<td>
<p>Numeric vector of chromosomes [integer] to chose NrCausalSNPs 
from; only used when external genotype data is sampled i.e. 
!is.null(genoFilePrefix)</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>NrSNPsOnChromosome</code></td>
<td>
<p>Specifies the number of SNPs [integer] per entry in 
chr (see above); has to be the same length as chr. If not provided, lines in 
genoFilePrefix-genoFileSuffix file will be counted (which can be slow for 
large files).</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>NrChrCausal</code></td>
<td>
<p>Number [integer] of causal chromosomes to chose 
NrCausalSNPs from (as opposed to the actual chromosomes to chose from via chr
);  only used when external genotype data is sampled i.e. 
!is.null(genoFilePrefix).</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>kinshipfile</code></td>
<td>
<p>path/to/kinshipfile [string]; if provided, 
kinship for simulation of genetic backgound effect will be read from file.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>kinshipHeader</code></td>
<td>
<p>[boolean] If TRUE kinship file has header information.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>kinshipDelimiter</code></td>
<td>
<p>Field separator [string] of kinship file.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>standardise</code></td>
<td>
<p>[boolean] If TRUE genotypes will be standardised for 
kinship estimation (recommended).</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>distBetaGenetic</code></td>
<td>
<p>Name [string] of distribution to use to simulate 
effect sizes of genetic variants; one of "unif" or "norm".</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>mBetaGenetic</code></td>
<td>
<p>Mean/midpoint [double] of normal/uniform distribution 
for effect sizes of genetic variants.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>sdBetaGenetic</code></td>
<td>
<p>Standard deviation/extension from midpoint [double] 
of normal/uniform distribution for effect sizes of genetic variants.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>pTraitsAffectedGenetics</code></td>
<td>
<p>Proportion [double] of traits affected by the 
genetic variant effect. For non-integer results of pTraitsAffected*P, the 
ceiling of the result is used. Allows to simulate for instance different 
levels of pleiotropy.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>pIndependentGenetic</code></td>
<td>
<p>Proportion [double] of genetic variant effects to 
have a trait-independent fixed effect.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>pTraitIndependentGenetic</code></td>
<td>
<p>Proportion [double] of traits influenced by 
independent genetic variant effects.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>keepSameIndependentSNPs</code></td>
<td>
<p>[boolean] If set to TRUE, the 
independent SNPs effects always influence the same subset of traits.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>NrFixedEffects</code></td>
<td>
<p>Number [integer] of different non-genetic covariate 
effects to simulate; allows to simulate non-genetic covariate effects from 
different distributions or with different parameters.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>NrConfounders</code></td>
<td>
<p>Number [integer] of non-genetic covariates; used as 
non-genetic covariate effects.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>distConfounders</code></td>
<td>
<p>Vector of name(s) [string] of distributions to use to 
simulate confounders; one of "unif", "norm", "bin", "cat_norm", "cat_unif".</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>mConfounders</code></td>
<td>
<p>Vector of mean(s)/midpoint(s) [double] of 
normal/uniform distribution for confounders.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>sdConfounders</code></td>
<td>
<p>Vector of standard deviation(s)/extension from 
midpoint(s) [double] of normal/uniform distribution for confounders.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>catConfounders</code></td>
<td>
<p>Vector of confounder categories [factor]; required if 
distConfounders "cat_norm" or "cat_unif".</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>probConfounders</code></td>
<td>
<p>Vector of probability(ies) [double] of binomial 
confounders (0/1); required if distConfounders "bin".</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>distBetaConfounders</code></td>
<td>
<p>Vector of name(s) [string] of distribution to use 
to simulate effect sizes of confounders; one of "unif" or "norm".</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>mBetaConfounders</code></td>
<td>
<p>Vector of mean(s)/midpoint(s) [double] of 
normal/uniform distribution for effect sizes of confounders.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>sdBetaConfounders</code></td>
<td>
<p>Vector of standard deviation(s)/extension from 
midpoint(s) [double] of normal/uniform distribution for effect sizes of 
confounders.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>pTraitsAffectedConfounders</code></td>
<td>
<p>Proportion(s) [double] of traits 
affected by the non-genetic covariates. For non-integer results of 
pTraitsAffected*P, the ceiling of the result is used.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>pIndependentConfounders</code></td>
<td>
<p>Vector of proportion(s) [double] of 
non-genetic covariate effects to have a trait-independent effect.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>pTraitIndependentConfounders</code></td>
<td>
<p>Vector of proportion(s) [double] of 
traits influenced by independent non-genetic covariate effects.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>keepSameIndependentConfounders</code></td>
<td>
<p>[boolean] If set to TRUE, the 
independent confounder effects always influence the same subset of traits.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>pcorr</code></td>
<td>
<p>Correlation [double] between phenotypes.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>corrmatfile</code></td>
<td>
<p>path/to/corrmatfile.csv [string] with comma-separated 
[P x P] numeric [double] correlation matrix; if provided,  correlation matrix 
for simulation of correlated backgound effect will be read from file; 
file should NOT contain an index or header column.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>meanNoiseBg</code></td>
<td>
<p>Mean [double] of the normal distributions for the 
simulation observational noise effects.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>sdNoiseBg</code></td>
<td>
<p>Standard deviation [double] of the normal distributions for 
the simulations of the observational noise effects.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>nonlinear</code></td>
<td>
<p>nonlinear transformation method [string]; one exp 
(exponential), log (logarithm), poly (polynomial), sqrt (squareroot) or 
custom (user-supplied function); if log or exp, base can be specified; if 
poly, power can be specified; if custom, a custom function (see for details). 
Non-linear transformation is optional, default is NULL ie no transformation
(see details).</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>logbase</code></td>
<td>
<p>[int] base of logarithm for non-linear phenotype 
transformation (see details).</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>expbase</code></td>
<td>
<p>[int] base of exponential function for non-linear phenotype 
transformation (see details).</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>power</code></td>
<td>
<p>[double] power of polynomial function for non-linear phenotype 
transformation.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>customTransform</code></td>
<td>
<p>[function] custom transformation function accepting 
a single argument.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>transformNeg</code></td>
<td>
<p>[string] transformation method for negative values in non
linear phenotype transformation. One of abs (absolute value) or set0 (set all 
negative values to zero). If nonlinear==log and transformNeg==set0, negative
values set to 1e-5</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>proportionNonlinear</code></td>
<td>
<p>[double] proportion of the phenotype to be non-
linear (see details)</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>sampleID</code></td>
<td>
<p>Prefix [string] for naming samples (will be followed by 
sample number from 1 to N when constructing sample IDs); only used if 
genotypes/kinship are simulated/do not have sample IDs.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>phenoID</code></td>
<td>
<p>Prefix [string] for naming traits (will be followed by 
phenotypes number from 1 to P when constructing phenotype IDs).</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>snpID</code></td>
<td>
<p>Prefix [string] for naming SNPs (will be followed by 
SNP number from 1 to NrSNP when constructing SNP IDs).</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>seed</code></td>
<td>
<p>Seed [integer] to initiate random number generation.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>verbose</code></td>
<td>
<p>[boolean]; If TRUE, progress info is printed to standard out</p>
</td>
</tr>
</table>
<h3>Details</h3>

<p>Phenotypes are modeled under a linear additive model where
Y = WA + BX + G + C + Phi, with WA the non-genetic covariates, BX the genetic
variant effects, G the infinitesimal genetic effects, C the correlated 
background effects and the Phi the observational noise. For more information
on these components look at the respective function descriptions (see also)
Optionally the phenotypes can be non-linearly transformed via:
Y_trans = (1-alpha) x Y + alpha x f(Y). Alpha is the proportion of non-
linearity of the phenotype and f is a non-linear transformation, and one of
exp, log or sqrt.
</p>


<h3>Value</h3>

<p>Named list of i) dataframe of proportion of variance 
explained for each component (varComponents), 
ii) a named list with the final simulated phenotype components 
(phenoComponentsFinal), iii) a named list with the intermediate simulated 
phenotype components (phenoComponentsIntermediate), iv) a named list of 
parameters describing the model setup (setup) and v) a named list of raw 
components (rawComponents) used for genetic effect simulation (genotypes 
and/or kinship, eigenvalues and eigenvectors of kinship)
</p>


<h3>See Also</h3>

<p>setModel, geneticFixedEffects,
geneticBgEffects, noiseBgEffects, noiseFixedEffects,
correlatedBgEffects and rescaleVariance.
</p>


<h3>Examples</h3>

<pre><code class="language-R"># simulate phenotype of 100 samples, 10 traits from genetic and noise 
# background effects, with variance explained of 0.2 and 0.8 respectively
genVar = 0.2
simulatedPhenotype &lt;- runSimulation(N=100, P=5, cNrSNP=10,
genVar=genVar, h2s=1, phi=1)
</code></pre>


</div>