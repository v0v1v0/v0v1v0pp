<div class="container">

<table style="width: 100%;"><tr>
<td>k1fun</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>Constant K1</h2>

<h3>Description</h3>

<p>Calculates an estimate for the constant <code class="reqn">K_1</code> given by
</p>
<p style="text-align: center;"><code class="reqn">K_1 = \int_0^1\int_0^1\frac{1}{l_0(u)l_n(v)}\lim_{\theta\to a}\frac{\partial C_{\theta}(u,v)}{\partial\theta}\,dudv, </code>
</p>

<p>where <code class="reqn">l_m(x):= F_m'\big(F_m^{(-1)}(x)\big)</code>, <code class="reqn">a</code> is such that <code class="reqn">C_a(u,v)=uv</code> (the product copula), and
<code class="reqn">\{F_n\}_{n \geq 0}</code> is a sequence of absolutely continuous distribution
functions.
</p>


<h3>Usage</h3>

<pre><code class="language-R">k1fun(dCdtheta, fun, data, empirical, mean = 0, sd = 1)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>dCdtheta</code></td>
<td>
<p>a function providing the limit as <code class="reqn">\theta \to a</code> of the
copula derivative with respect to <code class="reqn">\theta</code>. For the readily available copulas, namely, <code>frank</code>, <code>amh</code>,
<code>fgm</code> and  <code>gauss</code>, <code class="reqn">a=0</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>fun</code></td>
<td>
<p>optionally, a function providing an estimator for the probability density function.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>data</code></td>
<td>
<p>the observed time series. Only used to obtain the quantile function
when <code>empirical = TRUE</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>empirical</code></td>
<td>
<p>logical. If <code>TRUE</code>, the sample estimators for the density
and quantile functions are considered. Otherwise, the gaussian density and
quantile functions are used instead.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>mean</code></td>
<td>
<p>the mean of the gaussian distribution.
Only used if <code>empirical = FALSE</code></p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>sd</code></td>
<td>
<p>the standard deviation of the gaussian distribution.
Only used if <code>empirical = FALSE</code></p>
</td>
</tr>
</table>
<h3>Details</h3>

<p>Here <code class="reqn">F'</code> and <code class="reqn">F^{(-1)}</code> are replaced by sample estimators for these
functions or the gaussian density and quantile functions are used, depending
on the context.
</p>
<p>The function <code>kdens</code> is used as sample estimator of <code class="reqn">F'</code> and
<code>quantile</code> is the sample estimator of <code class="reqn">F^{(-1)}</code>.
</p>


<h3>Value</h3>

<p>The value of <code class="reqn">K_1</code>.
</p>


<h3>Examples</h3>

<pre><code class="language-R">trunc = 50000
cks &lt;- arfima.coefs(d = 0.25, trunc = trunc)
eps &lt;- rnorm(trunc+1000)
x &lt;- sapply(1:1000, function(t) sum(cks*rev(eps[t:(t+trunc)])))

# kernel density function
dfun &lt;- kdens(x)

# calculating K1 using four copulas and empirical estimates for F' and F^{(-1)}
K1_frank_e &lt;- k1fun(dCdtheta = dCtheta_frank, fun = dfun,
                 data = x, empirical = TRUE)
K1_amh_e &lt;- k1fun(dCdtheta = dCtheta_amh, fun = dfun,
                 data = x, empirical = TRUE)
K1_fgm_e &lt;- k1fun(dCdtheta = dCtheta_fgm, fun = dfun,
                 data = x, empirical = TRUE)
K1_gauss_e &lt;- k1fun(dCdtheta = dCtheta_gauss, fun = dfun,
                 data = x, empirical = TRUE)

# calculating K1 using four copulas and gaussian marginals
K1_frank_g &lt;- k1fun(dCdtheta = dCtheta_frank, fun = NULL, data = NULL,
                  empirical = FALSE, mean = mean(x), sd = sd(x))
K1_amh_g &lt;- k1fun(dCdtheta = dCtheta_amh, fun = NULL, data = NULL,
                  empirical = FALSE, mean = mean(x), sd = sd(x))
K1_fgm_g &lt;- k1fun(dCdtheta = dCtheta_fgm, fun = NULL, data = NULL,
                  empirical = FALSE, mean = mean(x), sd = sd(x))
K1_gauss_g &lt;- k1fun(dCdtheta = dCtheta_gauss, fun = NULL, data = NULL,
                  empirical = FALSE, mean = mean(x), sd = sd(x))

# comparing results
 data.frame(MARGINAL = c("Empirical", "Gaussian"),
            FRANK = c(K1_frank_e, K1_frank_g),
            AMH = c(K1_amh_e,  K1_amh_g),
            FGM = c(K1_fgm_e, K1_fgm_g),
            GAUSS = c(K1_gauss_e, K1_gauss_g))

</code></pre>


</div>