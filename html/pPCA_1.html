<div class="container">

<table style="width: 100%;"><tr>
<td>pPCA</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>Performs a principal component analysis on a large sparse matrices or a list of large sparse
matrices and returns the results as an object compatible to class prcomp</h2>

<h3>Description</h3>

<p>Performs a partial principal component analysis on a large sparse matrices or a list of large sparse
matrices and returns the results as an object compatible to class prcomp. Uses RSpectra library
to compute the largest eigenvalues.
</p>


<h3>Usage</h3>

<pre><code class="language-R">pPCA(x, rank, retX = TRUE, scale. = TRUE, sd.tol = 1e-05)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>x</code></td>
<td>
<p>A matrix, sparse matrix (Matrix::dgCMatrix), or a list of these. When a list
is supplied, the entries are concatenated horizontally (implicitly). See description.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>rank</code></td>
<td>
<p>An integer specifying the number of principal components to compute.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>retX</code></td>
<td>
<p>A logical value indicating whether the rotated variables (PC scores) should be returned.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>scale.</code></td>
<td>
<p>A logical value indicating whether the variables should be scaled to have
unit variance before the analysis takes place.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>sd.tol</code></td>
<td>
<p>A positive number, warnings are printed if the standard deviation of any
column is less than this threshold.</p>
</td>
</tr>
</table>
<h3>Details</h3>

<p>When the input argument is a matrix (of class "matrix" or "dgCMatrix"), principal component analysis
is performed to extract a few largest components. When a list of matrices is passed, the partial PCA
is performed on the horizontally concatenated matrix, i.e., if <code>x = list(X1,X2,X3)</code> then the
partial PCA is done on the matrix [X1 X2 X3], without concatenating the matrices explicitly. This can be
useful when the matrix is so high-dimensional that the total number of non-zero entries
exceed 2^31-1 (roughly 9.33e10), the capacity of a 32 bit integer. For example, in PCA with very
high-dimensional SNP data, the sparse matrices can be stored for each chromosome within the capacity
of 32 bit integers.
</p>


<h3>Value</h3>

<p>pPCA returns a list with class "pPCA" (compatible with "prcomp") containing the following
components:
</p>
<table>
<tr style="vertical-align: top;">
<td><code>sdev</code></td>
<td>
<p>A vector of the singular values (standard deviations of the principal components).</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>rotation</code></td>
<td>
<p>A matrix whose columns contain the eigenvectors (loadings).</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>x</code></td>
<td>
<p>A matrix of the principal component scores, returned if retX is true. This is
the centred (and scaled if requested) data multiplied by the rotation matrix.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>center</code></td>
<td>
<p>column means.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>scale</code></td>
<td>
<p>column standard deviations, if scale. is true. Otherwise, FALSE.</p>
</td>
</tr>
</table>
<h3>Note</h3>

<p>The partial SVD is computed through the RSpectra package. All elements in the first row of the rotation
matrix are positive.
</p>


<h3>Author(s)</h3>

<p>Srika Raja and Somak Dutta
</p>


<h3>References</h3>

<p>Raja, S. and Dutta, S. (2024). Matrix-free partial PCA of partitioned genetic data.
REU project 2024, Iowa State University.
</p>
<p>Dai, F., Dutta, S., and, Maitra, R. (2020). A Matrix-Free Likelihood Method for
Exploratory Factor Analysis of High-Dimensional Gaussian Data. Journal of Computational and
Graphical Statistics, 29(3), 675â€“680.
</p>


<h3>See Also</h3>

<p><code>biplot,prcomp</code>
</p>


<h3>Examples</h3>

<pre><code class="language-R">
library(Matrix)
set.seed(20190329)
m &lt;- rsparsematrix(50,100,density = 0.35)
results &lt;- pPCA(m, rank = 2)
biplot(results)
data &lt;- list(rsparsematrix(nrow = 50,ncol = 10,density = 0.35),
             rsparsematrix(nrow = 50,ncol = 40,density = 0.35)) # Using a list of matrices
result &lt;- pPCA(data, rank = 3)
print(result)
biplot(result)


</code></pre>


</div>