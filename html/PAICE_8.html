<div class="container">

<table style="width: 100%;"><tr>
<td>maxCol</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>Asymptotic estimation of the number of colonization events</h2>

<h3>Description</h3>

<p>A calculation of asymptotic estimators of colonization events from both
curves generated using the rarecol function.
</p>


<h3>Usage</h3>

<pre><code class="language-R">maxCol(data, level = 0.95, del = 0.05, method = 1)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>data</code></td>
<td>

<p>an object of <code>class</code> <code>"rarecol"</code> that contains
output from <code>rarecol</code>.
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>level</code></td>
<td>

<p>numeric. Determines the confidence interval used to estimate error in
Michaelis-Menten equation parameters. By default 0.95.
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>del</code></td>
<td>

<p>numeric. Determines the interval of values to be deleted to avoid the
influence of extreme values. By default 0.05 (i.e. deleted values below
2.5 quantile and above 97.5 quantile).
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>method</code></td>
<td>

<p>numeric. Indicates if the algorithm should try to fit the curve by
assigning a value to the intercept in genetic rarefaction curves
(<code>method = 1</code>) or discard these cases when it is not possible to
fit the curve with all values (<code>method = 0</code>). By default,
<code>method = 1</code>.
</p>
</td>
</tr>
</table>
<h3>Details</h3>

<p>This function calculates the number of colonization events estimated by both
resampling methods used in the function <code>rarecol</code>. The first
estimation (genetic estimation) corresponds to resampling first at genetic
level (number of variable positions) and then, per each variable position, a
complete resampling of the number of populations is done. The second
estimation (field estimation) corresponds to the opposite resampling, it is
done first at field level (number of populations) and then, per each
population, a complete resampling of the number of variable positions is
done.
</p>
<p>For each curve, the function first estimates the asymptote (estimated number
of colonization events) for each level of the second resampling (populations
in the first estimation and variable positions in the second estimation)
using the mean value of all replicates at each point. Then, these
estimations are used to build the final curve estimating the number of
colonization events for each resampling methodology. This final curve uses
estimations calculated previously, and the asymptote of the curve is
calculated by using mean points for each value of the first resampling
method (variable positions in the first estimation and populations in the
second estimation). The asymptote is calculated by fitting the curve to a
Michaelis-Menten equation following Coello et al. (2022).
</p>
<p>The confidence interval for the estimated number of colonization events is
calculated with the <code>confint</code> function. Curve fitting is done using the <code>nls</code> function.
</p>


<h3>Value</h3>

<p>This function returns an object of <code>class</code> <code>"maxCol"</code>
consisting in a list of the following elements:
</p>
<table>
<tr style="vertical-align: top;">
<td><code>DataGen</code></td>
<td>

<p>a data frame containing the mean estimated number of colonization events
per number of variable positions in the genetic estimation.
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>FormulaGen</code></td>
<td>

<p>formula used to fit final curve in the genetic estimation.
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>DataField</code></td>
<td>

<p>a data frame containing the mean estimated number of colonization events
per population in the field estimation.
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>FormulaField</code></td>
<td>

<p>formula used to fit the final curve in the field estimation.
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>Summary</code></td>
<td>

<p>a matrix containing the estimated number of colonization events of each
estimation (genetic and field). Minimum and maximum are calculated using
the confidence interval indicated.
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>ParametersGen</code></td>
<td>

<p>a matrix containing the value of each parameter to fit a
Michaelis-Menten equation for genetic estimation. The minimum and
maximum of each parameter according to the confidence interval
indicated. This equation is described as: colonization events = M *
positions / (K + positions) + c.
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>ParametersField</code></td>
<td>

<p>a matrix containing the value of each parameter to fit a
Michaelis-Menten equation for field estimation. The minimum and maximum
of each parameter according to the confidence interval indicated. This
equation is described as: colonization events = M * (populations - 1) /
(K + populations - 1).
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>ConfintLevel</code></td>
<td>

<p>a vector containing the confidence interval used to calculate minimum
and maximum for each parameter.
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>DeletedData</code></td>
<td>

<p>a vector containing the interval of extreme values deleted to do the fit
of the second accumulation curve.
</p>
</td>
</tr>
</table>
<p>The function <code>print</code> returns the number of colonization events inferred
for each estimation (genetic and field) and the interval of confidence of
these estimations.The function <code>summary</code> shows a detailed description
of parameters used to fit both curves, the formula used to fit these curves
and the confidence of interval of each parameter.
</p>


<h3>Note</h3>

<p>To show a detailed description of inferred colonization events in the most
complete case use the function <code>colonization</code>.
</p>


<h3>References</h3>

<p>Coello, A.J., Fernandez-Mazuecos, M., Heleno, R.H., Vargas, P. (2022).
PAICE: A new R package to estimate the number of inter-island colonizations
considering haplotype data and sample size. <em>Journal of Biogeography</em>,
49(4), 577-589.DOI:
<a href="https://onlinelibrary.wiley.com/doi/10.1111/jbi.14341">10.1111/jbi.14341</a>
</p>


<h3>See Also</h3>

<p><code>rarecol</code> to build rarefaction curves of colonization events. To
describe the number of colonization events inferred in the most complete
case use the function <code>colonization</code>. <code>plot.maxCol</code>
to plot the result of this function.
</p>


<h3>Examples</h3>

<pre><code class="language-R">
# Use 'CmonsRare' data, a dataset generated using 25 replicates
# in both genetic and field sampling
data(CmonsRare)
maxcol &lt;- maxCol(data = CmonsRare)
maxcol # Number of colonization estimated in each curve
summary(maxcol) # Description of curves
plot(maxcol) # Plotting estimations
# Plot all the information
old.par &lt;- par(no.readonly = TRUE) # To restore previous options
par(mfrow = c(2, 2))
plot(CmonsRare) # First two plots with rarefaction curves
par(fig = c(0, 1, 0, 0.5), new = TRUE)
plot(maxcol) # Third plot with estimations
par(old.par)
</code></pre>


</div>