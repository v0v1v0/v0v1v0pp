<div class="container">

<table style="width: 100%;"><tr>
<td>write.GeneMapper</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>
Write Genotypes to a Table Similarly to ABI GeneMapper
</h2>

<h3>Description</h3>

<p>Given a <code>genambig</code> object,
<code>write.GeneMapper</code> writes a text file of a table containing columns
for sample name, locus, and alleles.
</p>


<h3>Usage</h3>

<pre><code class="language-R">write.GeneMapper(object, file = "", samples = Samples(object),
                 loci = Loci(object))
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>object</code></td>
<td>

<p>A <code>genambig</code> object containing genotype data to write to the file.
The <code>Ploidies</code> slot is used for determining how many allele
columns to make.
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>file</code></td>
<td>

<p>Character string.  The path to which to write the file.
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>samples</code></td>
<td>

<p>Character vector.  Samples to write to the file.  This should be a
subset of <code>Samples(object)</code>.
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>loci</code></td>
<td>

<p>Character vector.  Loci to write to the file.  This should be a subset
of <code>Loci(object)</code>.
</p>
</td>
</tr>
</table>
<h3>Details</h3>

<p>Although I do not know of any population genetic software other than
<span class="pkg">polysat</span> that will
read this data format directly, the ABI GeneMapper Genotypes Table
format is a convenient way for the user to store microsatellite
genotype data and view it in a text editor or spreadsheet software.
Each row contains the sample name, locus name, and alleles separated
by tabs.
</p>
<p>The number of allele columns needed is detected by the maximum value
of <code>Ploidies(object,samples,loci)</code>.  The function will add additional
columns if it encounters genotypes with more than this number of
alleles.
</p>
<p><code>write.GeneMapper</code> handles missing data in a very simple way, in
that it writes the missing data symbol directly to the table as though
it were an allele.  If you want missing data to be represented
differently in the table, you can open it in spreadsheet software and
use find/replace or conditional formatting to locate missing data.
</p>
<p>The file that is produced can be read back into R directly by
<code>read.GeneMapper</code>, and therefore may be a convenient way to backup
genotype data for future analysis and manipulation in <span class="pkg">polysat</span>.
(<code>save</code> can also be used to backup an R object more directly,
including population and other information.)  This can also enable the
user to edit genotype data in spreadsheet software, if the
<code>editGenotypes</code> function is not sufficient.
</p>


<h3>Value</h3>

<p>A file is written but no value is returned.
</p>


<h3>Author(s)</h3>

<p>Lindsay V. Clark
</p>


<h3>References</h3>




<p>GeneMapper website: <a href="https://www.thermofisher.com/order/catalog/product/4475073">https://www.thermofisher.com/order/catalog/product/4475073</a>
</p>


<h3>See Also</h3>

<p><code>read.GeneMapper</code>, <code>write.Structure</code>,
<code>write.GenoDive</code>, <code>write.Tetrasat</code>,
<code>write.ATetra</code>, <code>write.POPDIST</code>,
<code>write.SPAGeDi</code>, <code>editGenotypes</code>
</p>


<h3>Examples</h3>

<pre><code class="language-R"># create a genotype object (usually done by reading a file)
mysamples &lt;- c("ind1", "ind2", "ind3", "ind4")
myloci &lt;- c("loc1", "loc2")
mygendata &lt;- new("genambig", samples=mysamples, loci=myloci)
mygendata &lt;- reformatPloidies(mygendata, output="one")
Genotypes(mygendata, loci="loc1") &lt;- list(c(202,204), c(204),
                                          c(200,206,208,212),
                                          c(198,204,208))
Genotypes(mygendata, loci="loc2") &lt;- list(c(78,81,84),
                                          c(75,90,93,96,99),
                                          c(87), c(-9))
Ploidies(mygendata) &lt;- 6

## Not run: 
# write a GeneMapper file
write.GeneMapper(mygendata, "exampleGMoutput.txt")

# view the file with read.table
read.table("exampleGMoutput.txt", sep="\t", header=TRUE)

## End(Not run)

</code></pre>


</div>