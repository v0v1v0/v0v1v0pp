<div class="container">

<table style="width: 100%;"><tr>
<td>peaks</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>Peaks or local maxima</h2>

<h3>Description</h3>

<p>Function that returns a subset of an R object with observations corresponding
to local maxima.
</p>


<h3>Usage</h3>

<pre><code class="language-R">peaks(x, span, ignore_threshold, strict, na.rm, ...)

## Default S3 method:
peaks(x, span = NA, ignore_threshold = NA, strict = NA, na.rm = FALSE, ...)

## S3 method for class 'numeric'
peaks(x, span = 5, ignore_threshold = NA, strict = TRUE, na.rm = FALSE, ...)

## S3 method for class 'data.frame'
peaks(
  x,
  span = 5,
  ignore_threshold = 0,
  strict = TRUE,
  na.rm = FALSE,
  x.var.name = NULL,
  y.var.name = NULL,
  var.name = y.var.name,
  refine.wl = FALSE,
  method = "spline",
  ...
)

## S3 method for class 'generic_spct'
peaks(
  x,
  span = 5,
  ignore_threshold = 0,
  strict = TRUE,
  na.rm = FALSE,
  var.name = NULL,
  refine.wl = FALSE,
  method = "spline",
  ...
)

## S3 method for class 'source_spct'
peaks(
  x,
  span = 5,
  ignore_threshold = 0,
  strict = TRUE,
  na.rm = FALSE,
  unit.out = getOption("photobiology.radiation.unit", default = "energy"),
  refine.wl = FALSE,
  method = "spline",
  ...
)

## S3 method for class 'response_spct'
peaks(
  x,
  span = 5,
  ignore_threshold = 0,
  strict = TRUE,
  na.rm = FALSE,
  unit.out = getOption("photobiology.radiation.unit", default = "energy"),
  refine.wl = FALSE,
  method = "spline",
  ...
)

## S3 method for class 'filter_spct'
peaks(
  x,
  span = 5,
  ignore_threshold = 0,
  strict = TRUE,
  na.rm = FALSE,
  filter.qty = getOption("photobiology.filter.qty", default = "transmittance"),
  refine.wl = FALSE,
  method = "spline",
  ...
)

## S3 method for class 'reflector_spct'
peaks(
  x,
  span = 5,
  ignore_threshold = 0,
  strict = TRUE,
  na.rm = FALSE,
  refine.wl = FALSE,
  method = "spline",
  ...
)

## S3 method for class 'solute_spct'
peaks(
  x,
  span = 5,
  ignore_threshold = 0,
  strict = TRUE,
  na.rm = FALSE,
  refine.wl = FALSE,
  method = "spline",
  ...
)

## S3 method for class 'cps_spct'
peaks(
  x,
  span = 5,
  ignore_threshold = 0,
  strict = TRUE,
  na.rm = FALSE,
  var.name = "cps",
  refine.wl = FALSE,
  method = "spline",
  ...
)

## S3 method for class 'raw_spct'
peaks(
  x,
  span = 5,
  ignore_threshold = 0,
  strict = TRUE,
  na.rm = FALSE,
  var.name = "counts",
  refine.wl = FALSE,
  method = "spline",
  ...
)

## S3 method for class 'generic_mspct'
peaks(
  x,
  span = 5,
  ignore_threshold = 0,
  strict = TRUE,
  na.rm = FALSE,
  var.name = NULL,
  refine.wl = FALSE,
  method = "spline",
  ...,
  .parallel = FALSE,
  .paropts = NULL
)

## S3 method for class 'source_mspct'
peaks(
  x,
  span = 5,
  ignore_threshold = 0,
  strict = TRUE,
  na.rm = FALSE,
  unit.out = getOption("photobiology.radiation.unit", default = "energy"),
  refine.wl = FALSE,
  method = "spline",
  ...,
  .parallel = FALSE,
  .paropts = NULL
)

## S3 method for class 'response_mspct'
peaks(
  x,
  span = 5,
  ignore_threshold = 0,
  strict = TRUE,
  na.rm = FALSE,
  unit.out = getOption("photobiology.radiation.unit", default = "energy"),
  refine.wl = FALSE,
  method = "spline",
  ...,
  .parallel = FALSE,
  .paropts = NULL
)

## S3 method for class 'filter_mspct'
peaks(
  x,
  span = 5,
  ignore_threshold = 0,
  strict = TRUE,
  na.rm = FALSE,
  filter.qty = getOption("photobiology.filter.qty", default = "transmittance"),
  refine.wl = FALSE,
  method = "spline",
  ...,
  .parallel = FALSE,
  .paropts = NULL
)

## S3 method for class 'reflector_mspct'
peaks(
  x,
  span = 5,
  ignore_threshold = 0,
  strict = TRUE,
  na.rm = FALSE,
  refine.wl = FALSE,
  method = "spline",
  ...,
  .parallel = FALSE,
  .paropts = NULL
)

## S3 method for class 'solute_mspct'
peaks(
  x,
  span = 5,
  ignore_threshold = 0,
  strict = TRUE,
  na.rm = FALSE,
  refine.wl = FALSE,
  method = "spline",
  ...,
  .parallel = FALSE,
  .paropts = NULL
)

## S3 method for class 'cps_mspct'
peaks(
  x,
  span = 5,
  ignore_threshold = 0,
  strict = TRUE,
  na.rm = FALSE,
  var.name = "cps",
  refine.wl = FALSE,
  method = "spline",
  ...,
  .parallel = FALSE,
  .paropts = NULL
)

## S3 method for class 'raw_mspct'
peaks(
  x,
  span = 5,
  ignore_threshold = 0,
  strict = TRUE,
  na.rm = FALSE,
  var.name = "counts",
  refine.wl = FALSE,
  method = "spline",
  ...,
  .parallel = FALSE,
  .paropts = NULL
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>x</code></td>
<td>
<p>an R object</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>span</code></td>
<td>
<p>integer A peak is defined as an element in a sequence which is
greater than all other elements within a window of width <code>span</code>
centered at that element. Use <code>NULL</code> for the global peak.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>ignore_threshold</code></td>
<td>
<p>numeric Value between 0.0 and 1.0 indicating the
relative size compared to tallest peak threshold below which peaks will be
ignored. Negative values set a threshold so that the tallest peaks are
ignored, instead of the shortest.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>strict</code></td>
<td>
<p>logical If <code>TRUE</code>, an element must be strictly greater
than all other values in its window to be considered a peak.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>na.rm</code></td>
<td>
<p>logical indicating whether <code>NA</code> values should be stripped
before searching for peaks.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>...</code></td>
<td>
<p>ignored</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>var.name, x.var.name, y.var.name</code></td>
<td>
<p>character Name of column where to look
for peaks.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>refine.wl</code></td>
<td>
<p>logical Flag indicating if peak location should be refined by
fitting a function.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>method</code></td>
<td>
<p>character String with the name of a method. Currently only
spline interpolation is implemented.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>unit.out</code></td>
<td>
<p>character One of "energy" or "photon"</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>filter.qty</code></td>
<td>
<p>character One of "transmittance" or "absorbance"</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>.parallel</code></td>
<td>
<p>if TRUE, apply function in parallel, using parallel backend
provided by foreach</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>.paropts</code></td>
<td>
<p>a list of additional options passed into the foreach function
when parallel computation is enabled. This is important if (for example)
your code relies on external data or packages: use the .export and
.packages arguments to supply them so that all cluster nodes have the
correct environment set up for computing.</p>
</td>
</tr>
</table>
<h3>Value</h3>

<p>A subset of <code>x</code> with rows corresponding to local maxima.
</p>


<h3>Methods (by class)</h3>


<ul>
<li> <p><code>peaks(default)</code>: Default returning always NA.
</p>
</li>
<li> <p><code>peaks(numeric)</code>: Default function usable on numeric vectors.
</p>
</li>
<li> <p><code>peaks(data.frame)</code>: Method for "data.frame" objects.
</p>
</li>
<li> <p><code>peaks(generic_spct)</code>: Method for "generic_spct" objects.
</p>
</li>
<li> <p><code>peaks(source_spct)</code>: Method for "source_spct" objects.
</p>
</li>
<li> <p><code>peaks(response_spct)</code>: Method for "response_spct" objects.
</p>
</li>
<li> <p><code>peaks(filter_spct)</code>: Method for "filter_spct" objects.
</p>
</li>
<li> <p><code>peaks(reflector_spct)</code>: Method for "reflector_spct" objects.
</p>
</li>
<li> <p><code>peaks(solute_spct)</code>: Method for "solute_spct" objects.
</p>
</li>
<li> <p><code>peaks(cps_spct)</code>: Method for "cps_spct" objects.
</p>
</li>
<li> <p><code>peaks(raw_spct)</code>: Method for "raw_spct" objects.
</p>
</li>
<li> <p><code>peaks(generic_mspct)</code>: Method for "generic_mspct" objects.
</p>
</li>
<li> <p><code>peaks(source_mspct)</code>: Method for "source_mspct" objects.
</p>
</li>
<li> <p><code>peaks(response_mspct)</code>: Method for "cps_mspct" objects.
</p>
</li>
<li> <p><code>peaks(filter_mspct)</code>: Method for "filter_mspct" objects.
</p>
</li>
<li> <p><code>peaks(reflector_mspct)</code>: Method for "reflector_mspct" objects.
</p>
</li>
<li> <p><code>peaks(solute_mspct)</code>: Method for "solute_mspct" objects.
</p>
</li>
<li> <p><code>peaks(cps_mspct)</code>: Method for "cps_mspct" objects.
</p>
</li>
<li> <p><code>peaks(raw_mspct)</code>: Method for "raw_mspct" objects.
</p>
</li>
</ul>
<h3>Note</h3>

<p>Thresholds for ignoring peaks are applied after peaks are searched for,
and negative threshold values can in some cases result in no peaks being
returned.
</p>


<h3>See Also</h3>

<p>Other peaks and valleys functions: 
<code>find_peaks()</code>,
<code>find_spikes()</code>,
<code>get_peaks()</code>,
<code>replace_bad_pixs()</code>,
<code>spikes()</code>,
<code>valleys()</code>,
<code>wls_at_target()</code>
</p>


<h3>Examples</h3>

<pre><code class="language-R">peaks(sun.spct, span = 51)
peaks(sun.spct, span = NULL)
peaks(sun.spct, span = 51, refine.wl = TRUE)

peaks(sun.spct)

</code></pre>


</div>