<div class="container">

<table style="width: 100%;"><tr>
<td>smooth_wSG</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>Weighted Savitzky-Golay</h2>

<h3>Description</h3>

<p>Weighted Savitzky-Golay
</p>


<h3>Usage</h3>

<pre><code class="language-R">smooth_wSG(
  y,
  w,
  nptperyear,
  ylu,
  wFUN = wTSM,
  iters = 2,
  frame = floor(nptperyear/5) * 2 + 1,
  d = 2,
  ...
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>y</code></td>
<td>
<p>Numeric vector, vegetation index time-series</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>w</code></td>
<td>
<p>(optional) Numeric vector, weights of <code>y</code>. If not specified,
weights of all <code>NA</code> values will be <code>wmin</code>, the others will be 1.0.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>nptperyear</code></td>
<td>
<p>Integer, number of images per year.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>ylu</code></td>
<td>
<p>(optional) <code style="white-space: pre;">⁠[low, high]⁠</code> value of time-series y (curve fitting values
are constrained in the range of ylu.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>wFUN</code></td>
<td>
<p>weights updating function, can be one of 'wTSM', 'wChen' and
'wBisquare'.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>iters</code></td>
<td>
<p>How many times curve fitting is implemented.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>frame</code></td>
<td>
<p>Savitzky-Golay windows size</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>d</code></td>
<td>
<p>polynomial of degree. When d = 1, it becomes moving average.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>...</code></td>
<td>
<p>Additional parameters are passed to <code>wFUN</code>.</p>
</td>
</tr>
</table>
<h3>Value</h3>


<ul>
<li> <p><code>ws</code>: weights of every iteration
</p>
</li>
<li> <p><code>zs</code>: curve fittings of every iteration
</p>
</li>
</ul>
<h3>References</h3>


<ol>
<li>
<p> Chen, J., J\"onsson, P., Tamura, M., Gu, Z., Matsushita, B., Eklundh, L.,
2004. A simple method for reconstructing a high-quality NDVI time-series
data set based on the Savitzky-Golay filter. Remote Sens. Environ. 91,
332-344. https://doi.org/10.1016/j.rse.2004.03.014. <br></p>
</li>
<li>
<p> https://en.wikipedia.org/wiki/Savitzky%E2%80%93Golay_filter
</p>
</li>
</ol>
<h3>Examples</h3>

<pre><code class="language-R">library(phenofit)
data("MOD13A1")
dt &lt;- tidy_MOD13(MOD13A1$dt)
d &lt;- dt[site == "AT-Neu", ]

l &lt;- check_input(d$t, d$y, d$w, nptperyear=23)
r_wSG &lt;- smooth_wSG(l$y, l$w, l$ylu, nptperyear = 23, iters = 2)
</code></pre>


</div>