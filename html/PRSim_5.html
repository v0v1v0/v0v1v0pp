<div class="container">

<table style="width: 100%;"><tr>
<td>pRsim.wave</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>Simulate for multiple stations</h2>

<h3>Description</h3>

<p>Applies the wavelet-based simulation algorithm to multiple sites (single site possible as well)
</p>


<h3>Usage</h3>

<pre><code class="language-R">prsim.wave(data, station_id="Qobs", number_sim=1, win_h_length=15, 
                  marginal=c("kappa","empirical"), n_par=4, n_wave=100, marginalpar=TRUE, 
                  GoFtest=NULL, verbose=TRUE, suppWarn=FALSE, ...)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>data</code></td>
<td>
<p>list of data frames. One list entry, i.e. data frame, corresponds to one station. Each data frame contains the time indications and runoff of one station. See ‘Details’.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>station_id</code></td>
<td>
<p>identifies the station in case several time series are present in <code>data</code>. See ‘Details’.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>number_sim</code></td>
<td>
<p>number of simulations to be carried out.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>win_h_length</code></td>
<td>
<p>(half-)length of moving window size.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>marginal</code></td>
<td>
<p>marginal distribution to be used for the backtransformation. Can be either <code>"kappa"</code>, <code>"empirical"</code>, or any type of CDF (see ‘Details’). <code>"kappa"</code> uses the four-parameter kappa distribution for backtransformation, <code>"empirical"</code> uses the empirical distribution. CDF allows for specifying any distribution ‘Examples’.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>n_par</code></td>
<td>
<p>number of parameters of the marginal distribution used</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>GoFtest</code></td>
<td>
<p>If (non-null) a GoF test for daily data should be performed: <code>"KS"</code> performs a Kolmogorof-Smirnov test, and <code>"AD"</code> performs an Anderson-Darling test.  see ‘Details’)</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>verbose</code></td>
<td>
<p>logical. Should progress be reported?</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>marginalpar</code></td>
<td>
<p>logical. Should the estimated parameters of the distribution used be returned?</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>n_wave</code></td>
<td>
<p>number of scales to be considered in the continuous wavelet transform.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>suppWarn</code></td>
<td>
<p>logical. See ‘Details’.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>...</code></td>
<td>
<p>any other argument passed to the sub-function specifying the cdf for fitting.  See ‘Details’ and  ‘Examples’. </p>
</td>
</tr>
</table>
<h3>Details</h3>

<p>Time can be given with three columns named <code>"YYYY"</code>, <code>"MM"</code>, <code>"DD"</code>, or as in POSIXct format <code>YYYY-MM-DD</code>.
All leap days (Feb 29th) will be omitted from the analysis, but no missing observations are allowed.
</p>
<p>Stations are identified by list index.
</p>
<p>The function <code>homtest::par.kappa</code> might issue quite a few warnings of type <code>In fn(par, ...) : value out of range in 'gammafn'</code>. The argument <code>suppWarn</code> allows to silence warnings for the specific function call via <code>suppressWarnings()</code>. Of course, a subsequent check via <code>warnings()</code> is recommended.
</p>
<p>Alternative distributions can be specified by providing three functions: (1) a function fitting the parameters of a distributions and providing a vector of these parameters as output (CDF_fit), (2) a function simulating random numbers from this distribution (rCDF), and (3) a function specifying the distribution (pCDF). See ‘Examples’ for the generalized beta for the second kind and for the Generalized Extreme Values (GEV) distribution.
</p>
<p>When using the kappa distribution, the AD test can for certain values of the parameter h not be performed. 
</p>


<h3>Value</h3>

<p>A list with elements 
</p>
<table>
<tr style="vertical-align: top;">
<td><code>simulation</code></td>
<td>
<p>A data frame with time information, observations, and 
<code>number_sim</code> columns containing the simulated runoff.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>pars</code></td>
<td>
<p>A matrix containing the estimated parameters of the marginal distribution (if <code>marginalpar</code>).</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>p_val</code></td>
<td>
<p>A vector containing the p-values of <code>ks.test</code> or <code>ad.test</code> applied to the daily detrended data (if <code>GoFtest</code> is not NULL)</p>
</td>
</tr>
</table>
<h3>Author(s)</h3>

<p>Manuela Brunner
</p>


<h3>References</h3>

<p>Brunner, M. I., and E. Gilleland (2020). Stochastic simulation of streamflow and spatial extremes: a continuous, wavelet-based approach, Hydrology and Earth System Sciences, https://doi.org/10.5194/hess-24-3967-2020.</p>


<h3>See Also</h3>

<p><code>ks.test</code>
</p>


<h3>Examples</h3>

<pre><code class="language-R">data(runoff_multi_sites)

## Specifying particular CDFs:
## (1) example with the Generalized Extreme Value (GEV) distribution

require("evd")
require("ismev")
rGEV &lt;- function(n, theta)   rgev(n, theta[1], theta[2], theta[3])
pGEV &lt;- function(x, theta)   pgev(x, theta[1], theta[2], theta[3])
GEV_fit &lt;- function( xdat, ...)   gev.fit( xdat, ...)$mle


## (2) example with generalized Beta distribution of the second kind

require( "GB2")
rGB2 &lt;- function(n, theta)  rgb2(n, theta[1], theta[2], theta[3], theta[4])
pGB2 &lt;- function(x, theta)  pgb2(x, theta[1], theta[2], theta[3], theta[4])
GB2_fit &lt;- function( xdat, ...)   ml.gb2( xdat, ...)$opt1$par


</code></pre>


</div>