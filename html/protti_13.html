<div class="container">

<table style="width: 100%;"><tr>
<td>calculate_treatment_enrichment</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>Check treatment enrichment</h2>

<h3>Description</h3>

<p>Check for an enrichment of proteins interacting with the treatment in significantly changing
proteins as compared to all proteins.
</p>


<h3>Usage</h3>

<pre><code class="language-R">calculate_treatment_enrichment(
  data,
  protein_id,
  is_significant,
  binds_treatment,
  group = NULL,
  treatment_name,
  plot = TRUE,
  fill_colours = protti::protti_colours,
  fill_by_group = FALSE,
  facet_n_col = 2
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>data</code></td>
<td>
<p>a data frame contains at least the input variables.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>protein_id</code></td>
<td>
<p>a character column in the <code>data</code> data frame that contains the protein
accession numbers.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>is_significant</code></td>
<td>
<p>a logical column in the <code>data</code> data frame that indicates if the
corresponding protein has a significantly changing peptide. The input data frame may contain
peptide level information with significance information. The function is able to extract protein
level information from this.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>binds_treatment</code></td>
<td>
<p>a logical column in the <code>data</code> data frame that indicates if the
corresponding protein binds to the treatment. This information can be obtained from different
databases, e.g. UniProt.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>group</code></td>
<td>
<p>optional, character column in the <code>data</code> data frame that contains information by
which the analysis should be grouped. The analysis will be performed separately for each of the
groups. This is most likely a column that labels separate comparisons of different conditions.
In protti the <code>assign_missingness()</code> function creates such a column automatically.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>treatment_name</code></td>
<td>
<p>a character value that indicates the treatment name. It will be included
in the plot title.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>plot</code></td>
<td>
<p>a logical value indicating whether the result should be plotted or returned as a
table.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>fill_colours</code></td>
<td>
<p>a character vector that specifies the fill colours of the plot.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>fill_by_group</code></td>
<td>
<p>a logical value that specifies if the bars in the plot should be filled by group
if the group argument is provided. Default is <code>FALSE</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>facet_n_col</code></td>
<td>
<p>a numeric value that specifies the number of columns the facet plot should have if
a <code>group</code> column was provided.</p>
</td>
</tr>
</table>
<h3>Value</h3>

<p>A bar plot displaying the percentage of all detected proteins and all significant proteins
that bind to the treatment. A Fisher's exact test is performed to calculate the significance of
the enrichment in significant proteins compared to all proteins. The result is reported as a
p-value. If <code>plot = FALSE</code> a contingency table in long format is returned.
</p>


<h3>Examples</h3>

<pre><code class="language-R"># Create example data
data &lt;- data.frame(
  protein_id = c(paste0("protein", 1:50)),
  significant = c(
    rep(TRUE, 20),
    rep(FALSE, 30)
  ),
  binds_treatment = c(
    rep(TRUE, 10),
    rep(FALSE, 10),
    rep(TRUE, 5),
    rep(FALSE, 25)
  ),
  group = c(
    rep("A", 5),
    rep("B", 15),
    rep("A", 15),
    rep("B", 15)
  )
)

# Plot treatment enrichment
calculate_treatment_enrichment(
  data,
  protein_id = protein_id,
  is_significant = significant,
  binds_treatment = binds_treatment,
  treatment_name = "Rapamycin",
  plot = TRUE
)

# Plot treatment enrichment by group
calculate_treatment_enrichment(
  data,
  protein_id = protein_id,
  group = group,
  is_significant = significant,
  binds_treatment = binds_treatment,
  treatment_name = "Rapamycin",
  plot = TRUE,
  fill_by_group = TRUE
)

# Calculate treatment enrichment
enrichment &lt;- calculate_treatment_enrichment(
  data,
  protein_id = protein_id,
  is_significant = significant,
  binds_treatment = binds_treatment,
  plot = FALSE
)

enrichment
</code></pre>


</div>