<div class="container">

<table style="width: 100%;"><tr>
<td>PopulationModel</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>R6 class representing a population model</h2>

<h3>Description</h3>

<p><code>R6</code> class representing a spatially-explicit
demographic-based population model. It extends the <code>SimulationModel</code>
class with parameters for the <code>population_simulator</code> function. It
inherits functionality for creating a nested model, whereby a nested template model
with fixed parameters is maintained when a model is cloned for various sampled
parameters. Also provided are extensions to the methods for checking the consistency
and completeness of model parameters.
</p>


<h3>Super classes</h3>

<p><code>poems::GenericClass</code> -&gt; <code>poems::GenericModel</code> -&gt; <code>poems::SpatialModel</code> -&gt; <code>poems::SimulationModel</code> -&gt; <code>PopulationModel</code>
</p>


<h3>Public fields</h3>

<div class="r6-fields">

<dl>
<dt><code>attached</code></dt>
<dd>
<p>A list of dynamically attached attributes (name-value pairs).</p>
</dd>
</dl>
</div>


<h3>Active bindings</h3>

<div class="r6-active-bindings">

<dl>
<dt><code>simulation_function</code></dt>
<dd>
<p>Name (character string) or source path of the default simulation function, which takes a model as an input and returns the simulation results.</p>
</dd>
<dt><code>model_attributes</code></dt>
<dd>
<p>A vector of model attribute names.</p>
</dd>
<dt><code>region</code></dt>
<dd>
<p>A <code>Region</code> (or inherited class) object specifying the study region.</p>
</dd>
<dt><code>coordinates</code></dt>
<dd>
<p>Data frame (or matrix) of X-Y population (WGS84) coordinates in longitude (degrees West) and latitude (degrees North) (get and set), or distance-based coordinates dynamically returned by region raster (get only).</p>
</dd>
<dt><code>random_seed</code></dt>
<dd>
<p>Number to seed the random number generation for stochasticity.</p>
</dd>
<dt><code>replicates</code></dt>
<dd>
<p>Number of replicate simulation runs.</p>
</dd>
<dt><code>time_steps</code></dt>
<dd>
<p>Number of simulation time steps.</p>
</dd>
<dt><code>years_per_step</code></dt>
<dd>
<p>Number of years per time step.</p>
</dd>
<dt><code>populations</code></dt>
<dd>
<p>Number of population cells.</p>
</dd>
<dt><code>stages</code></dt>
<dd>
<p>Number of life cycle stages.</p>
</dd>
<dt><code>initial_abundance</code></dt>
<dd>
<p>Array (matrix) or raster (stack) of initial abundance values at each population cell (for each age/stage).</p>
</dd>
<dt><code>stage_matrix</code></dt>
<dd>
<p>Matrix of transition (fecundity &amp; survival) rates between stages at each time step (Leslie/Lefkovitch matrix).</p>
</dd>
<dt><code>fecundity_mask</code></dt>
<dd>
<p>Matrix of 0-1 to indicate which (proportions) of transition rates refer to fecundity.</p>
</dd>
<dt><code>fecundity_max</code></dt>
<dd>
<p>Maximum transition fecundity rate (in Leslie/Lefkovitch matrix).</p>
</dd>
<dt><code>demographic_stochasticity</code></dt>
<dd>
<p>Boolean for choosing demographic stochasticity for transition, dispersal, harvest and/or other processes.</p>
</dd>
<dt><code>standard_deviation</code></dt>
<dd>
<p>Standard deviation matrix (or single value) for applying environmental stochasticity to transition rates.</p>
</dd>
<dt><code>correlation</code></dt>
<dd>
<p>Simulator-dependent attribute or list of attributes for describing/parameterizing the correlation strategy utilized when applying environmental stochasticity and/or other processes (see <code>population_simulator</code>).</p>
</dd>
<dt><code>carrying_capacity</code></dt>
<dd>
<p>Array (matrix), or raster (stack) of carrying capacity values at each population cell (across time).</p>
</dd>
<dt><code>density_dependence</code></dt>
<dd>
<p>Simulator-dependent function, attribute or list of attributes for describing/parameterizing the density dependence strategy utilized (see <code>population_simulator</code>).</p>
</dd>
<dt><code>growth_rate_max</code></dt>
<dd>
<p>Maximum growth rate (utilized by density dependence processes).</p>
</dd>
<dt><code>density_affects</code></dt>
<dd>
<p>Transition vital rates that are affected by density, including <em>"fecundity"</em>, <em>"survival"</em>, or a matrix of booleans or numeric (0-1) indicating vital rates affected (default is all).</p>
</dd>
<dt><code>density_stages</code></dt>
<dd>
<p>Array of booleans or numeric (0-1) for each stage to indicate (the degree to) which stages are affected by density (default is 1 for all stages).</p>
</dd>
<dt><code>translocation</code></dt>
<dd>
<p>Simulator-dependent function, attribute or list of attributes for describing/parameterizing translocation (management) strategies utilized (see <code>population_simulator</code>).</p>
</dd>
<dt><code>harvest</code></dt>
<dd>
<p>Simulator-dependent function, attribute or list of attributes for describing/parameterizing a harvest (organism removal/hunting) strategy (see <code>population_simulator</code>).</p>
</dd>
<dt><code>mortality</code></dt>
<dd>
<p>Simulator-dependent function, attribute or list of attributes to describe/parameterize a spatio-temporal mortality strategy (see <code>population_simulator</code>).</p>
</dd>
<dt><code>dispersal</code></dt>
<dd>
<p>Simulator-dependent function, attribute or list of attributes for describing/parameterizing the dispersal (migration) strategy utilized (see <code>population_simulator</code>).</p>
</dd>
<dt><code>dispersal_stages</code></dt>
<dd>
<p>Array of relative dispersal (0-1) for each stage to indicate the degree to which each stage participates in dispersal (default is 1 for all stages).</p>
</dd>
<dt><code>dispersal_source_n_k</code></dt>
<dd>
<p>Simulator-dependent attribute for describing/parameterizing dispersal dependent on source population abundance divided by carrying capacity (see <code>population_simulator</code>).</p>
</dd>
<dt><code>dispersal_target_k</code></dt>
<dd>
<p>Simulator-dependent attribute for describing/parameterizing dispersal dependent on target population carrying capacity (see <code>population_simulator</code>).</p>
</dd>
<dt><code>dispersal_target_n</code></dt>
<dd>
<p>Simulator-dependent attribute (default is list with <em>threshold</em> and <em>cutoff</em>) of attributes for describing/parameterizing dispersal dependent on target population abundance (see <code>population_simulator</code>).</p>
</dd>
<dt><code>dispersal_target_n_k</code></dt>
<dd>
<p>Simulator-dependent attribute (default is list with <em>threshold</em> and <em>cutoff</em>) of attributes for describing/parameterizing dispersal dependent on target population abundance/capacity (see <code>population_simulator</code>).</p>
</dd>
<dt><code>abundance_threshold</code></dt>
<dd>
<p>Abundance threshold (that needs to be exceeded) for each population to persist.</p>
</dd>
<dt><code>simulation_order</code></dt>
<dd>
<p>A vector of simulation process names in configured order of execution (default is "transition", "translocation", "harvest", "mortality", "dispersal", "results").</p>
</dd>
<dt><code>results_selection</code></dt>
<dd>
<p>List of attributes to be included in the returned results of each simulation run, selected from: "abundance", "ema", "extirpation", "extinction_location", "harvested", "occupancy"; "summarize" or "replicate".</p>
</dd>
<dt><code>result_stages</code></dt>
<dd>
<p>Array of booleans or numeric (0, 1, 2, ...) for each stage to indicate which stages are included/combined (each unique digit &gt; 0; optionally named) in the results (default is 1 for all stages).</p>
</dd>
<dt><code>attribute_aliases</code></dt>
<dd>
<p>A list of alternative alias names for model attributes (form: <code>alias = "attribute"</code>) to be used with the set and get attributes methods.</p>
</dd>
<dt><code>template_model</code></dt>
<dd>
<p>Nested template model for fixed (non-sampled) attributes for shallow cloning.</p>
</dd>
<dt><code>sample_attributes</code></dt>
<dd>
<p>Vector of sample attribute names (only).</p>
</dd>
<dt><code>required_attributes</code></dt>
<dd>
<p>Vector of required attribute names (only), i.e. those needed to run a simulation.</p>
</dd>
<dt><code>error_messages</code></dt>
<dd>
<p>A vector of error messages encountered when setting model attributes.</p>
</dd>
<dt><code>warning_messages</code></dt>
<dd>
<p>A vector of warning messages encountered when setting model attributes.</p>
</dd>
</dl>
</div>


<h3>Methods</h3>



<h4>Public methods</h4>


<ul>
<li> <p><a href="#method-PopulationModel-new"><code>PopulationModel$new()</code></a>
</p>
</li>
<li> <p><a href="#method-PopulationModel-list_consistency"><code>PopulationModel$list_consistency()</code></a>
</p>
</li>
<li> <p><a href="#method-PopulationModel-clone"><code>PopulationModel$clone()</code></a>
</p>
</li>
</ul>
<details><summary>Inherited methods</summary><ul>
<li><span class="pkg-link" data-pkg="poems" data-topic="GenericModel" data-id="get_attribute"><a href="../../poems/html/GenericModel.html#method-GenericModel-get_attribute"><code>poems::GenericModel$get_attribute()</code></a></span></li>
<li><span class="pkg-link" data-pkg="poems" data-topic="GenericModel" data-id="get_attribute_aliases"><a href="../../poems/html/GenericModel.html#method-GenericModel-get_attribute_aliases"><code>poems::GenericModel$get_attribute_aliases()</code></a></span></li>
<li><span class="pkg-link" data-pkg="poems" data-topic="SimulationModel" data-id="get_attribute_names"><a href="../../poems/html/SimulationModel.html#method-SimulationModel-get_attribute_names"><code>poems::SimulationModel$get_attribute_names()</code></a></span></li>
<li><span class="pkg-link" data-pkg="poems" data-topic="SimulationModel" data-id="get_attributes"><a href="../../poems/html/SimulationModel.html#method-SimulationModel-get_attributes"><code>poems::SimulationModel$get_attributes()</code></a></span></li>
<li><span class="pkg-link" data-pkg="poems" data-topic="SimulationModel" data-id="incomplete_attributes"><a href="../../poems/html/SimulationModel.html#method-SimulationModel-incomplete_attributes"><code>poems::SimulationModel$incomplete_attributes()</code></a></span></li>
<li><span class="pkg-link" data-pkg="poems" data-topic="SimulationModel" data-id="inconsistent_attributes"><a href="../../poems/html/SimulationModel.html#method-SimulationModel-inconsistent_attributes"><code>poems::SimulationModel$inconsistent_attributes()</code></a></span></li>
<li><span class="pkg-link" data-pkg="poems" data-topic="SimulationModel" data-id="is_complete"><a href="../../poems/html/SimulationModel.html#method-SimulationModel-is_complete"><code>poems::SimulationModel$is_complete()</code></a></span></li>
<li><span class="pkg-link" data-pkg="poems" data-topic="SimulationModel" data-id="is_consistent"><a href="../../poems/html/SimulationModel.html#method-SimulationModel-is_consistent"><code>poems::SimulationModel$is_consistent()</code></a></span></li>
<li><span class="pkg-link" data-pkg="poems" data-topic="SimulationModel" data-id="list_completeness"><a href="../../poems/html/SimulationModel.html#method-SimulationModel-list_completeness"><code>poems::SimulationModel$list_completeness()</code></a></span></li>
<li><span class="pkg-link" data-pkg="poems" data-topic="SimulationModel" data-id="new_clone"><a href="../../poems/html/SimulationModel.html#method-SimulationModel-new_clone"><code>poems::SimulationModel$new_clone()</code></a></span></li>
<li><span class="pkg-link" data-pkg="poems" data-topic="SimulationModel" data-id="set_attributes"><a href="../../poems/html/SimulationModel.html#method-SimulationModel-set_attributes"><code>poems::SimulationModel$set_attributes()</code></a></span></li>
<li><span class="pkg-link" data-pkg="poems" data-topic="SimulationModel" data-id="set_sample_attributes"><a href="../../poems/html/SimulationModel.html#method-SimulationModel-set_sample_attributes"><code>poems::SimulationModel$set_sample_attributes()</code></a></span></li>
</ul></details><hr>
<a id="method-PopulationModel-new"></a>



<h4>Method <code>new()</code>
</h4>

<p>Initialization method sets default aliases and given attributes individually and/or from a list.
</p>


<h5>Usage</h5>

<div class="r"><pre>PopulationModel$new(attribute_aliases = NULL, ...)</pre></div>



<h5>Arguments</h5>

<div class="arguments">

<dl>
<dt><code>attribute_aliases</code></dt>
<dd>
<p>A list of alternative alias names for model attributes (form: <code>alias = "attribute"</code>) to be used with the set and get attributes methods.</p>
</dd>
<dt><code>...</code></dt>
<dd>
<p>Parameters passed via a <em>params</em> list or individually.</p>
</dd>
</dl>
</div>


<hr>
<a id="method-PopulationModel-list_consistency"></a>



<h4>Method <code>list_consistency()</code>
</h4>

<p>Returns a boolean to indicate if (optionally selected or all) model attributes (such as dimensions) are consistent.
</p>


<h5>Usage</h5>

<div class="r"><pre>PopulationModel$list_consistency(params = NULL)</pre></div>



<h5>Arguments</h5>

<div class="arguments">

<dl>
<dt><code>params</code></dt>
<dd>
<p>Optional array of parameter/attribute names.</p>
</dd>
</dl>
</div>



<h5>Returns</h5>

<p>List of booleans (or NAs) to indicate consistency of selected/all attributes.
</p>


<hr>
<a id="method-PopulationModel-clone"></a>



<h4>Method <code>clone()</code>
</h4>

<p>The objects of this class are cloneable with this method.
</p>


<h5>Usage</h5>

<div class="r"><pre>PopulationModel$clone(deep = FALSE)</pre></div>



<h5>Arguments</h5>

<div class="arguments">

<dl>
<dt><code>deep</code></dt>
<dd>
<p>Whether to make a deep clone.</p>
</dd>
</dl>
</div>




<h3>Examples</h3>

<pre><code class="language-R"># U Island example region
coordinates &lt;- data.frame(
  x = rep(seq(177.01, 177.05, 0.01), 5),
  y = rep(seq(-18.01, -18.05, -0.01), each = 5)
)
template_raster &lt;- Region$new(coordinates = coordinates)$region_raster # full extent
template_raster[][-c(7, 9, 12, 14, 17:19)] &lt;- NA # make U Island
region &lt;- Region$new(template_raster = template_raster)
# Harvest function
harvest &lt;- list(
  rate = NA, # set later
  function(params) round(params$stage_abundance * (1 - params$rate))
)
harvest_rate_alias &lt;- list(harvest_rate = "harvest$rate")
# Template model
stage_matrix &lt;- matrix(c(
  0, 2.5, # Leslie/Lefkovitch matrix
  0.8, 0.5
), nrow = 2, ncol = 2, byrow = TRUE)
template_model &lt;- PopulationModel$new(
  region = region,
  time_steps = 10, # years
  populations = region$region_cells, # 7
  stage_matrix = stage_matrix,
  harvest = harvest,
  results_selection = c("abundance", "harvested"),
  attribute_aliases = harvest_rate_alias
)
template_model$model_attributes
template_model$required_attributes
# Nested model
nested_model &lt;- PopulationModel$new(template_model = template_model)
nested_model$incomplete_attributes()
nested_model$set_sample_attributes(
  initial_abundance = rep(10, 7),
  carrying_capacity = array(70:1, c(10, 7)),
  harvest_rate = 0.3
)
nested_model$inconsistent_attributes()
nested_model$carrying_capacity &lt;- array(70:1, c(7, 10))
nested_model$is_consistent()
nested_model$is_complete()
nested_model$harvest$rate

</code></pre>


</div>