<div class="container">

<table style="width: 100%;"><tr>
<td>par_init</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>Calculate initial set of parameters.</h2>

<h3>Description</h3>

<p>This function is used to generate an initial set of parameters for fitting
that is expected to be not to far from the final.<br>
The parameters can be:<br></p>

<ul>
<li> <p><code>Min</code>, <code>MinE</code>, <code>MinB</code>, <code>PMin</code>, <code>PMinB</code>, <code>PMinE</code>;
</p>
</li>
<li> <p><code>Max</code>;
</p>
</li>
<li> <p><code>Begin</code>, <code>Peak</code>, <code>Flat</code>, <code>End</code>;
</p>
</li>
<li> <p><code>Length</code>, <code>LengthB</code>, <code>LengthE</code>;
</p>
</li>
<li> <p><code>Theta</code>;
</p>
</li>
<li> <p><code>Alpha</code>, <code>Beta</code>, <code>Tau</code>, <code>Phi</code>, <code>Delta</code>;
</p>
</li>
<li> <p><code>Alpha1</code>, <code>Beta1</code>, <code>Tau1</code>, <code>Phi1</code>, <code>Delta1</code>;
</p>
</li>
<li> <p><code>Alpha2</code>, <code>Beta2</code>, <code>Tau2</code>, <code>Phi2</code>, <code>Delta2</code>;
</p>
</li>
<li> <p><code>Alpha3</code>, <code>Beta3</code>, <code>Tau3</code>, <code>Phi3</code>, <code>Delta3</code>;
</p>
</li>
</ul>
<p>And the name of level if a cofactor is used.<br>
The parameters <code>Max</code>, <code>Min</code>, <code>MinE</code>, <code>MinB</code>, <code>Length</code>,
<code>LengthB</code>, <code>LengthE</code>, and <code>Peak</code> can be followed with _ and part of the
name of the rookery.<br>
The model for scale effect of sinusoid is: Alpha + Beta * n(t) ^ Tau where
n(t) is the expected number for the day t without the sinusoid effect.
</p>


<h3>Usage</h3>

<pre><code class="language-R">par_init(
  data = stop("A dataset must be provided"),
  fixed.parameters = NULL,
  add.cofactors = NULL
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>data</code></td>
<td>
<p>Dataset generated with add_phenology()</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>fixed.parameters</code></td>
<td>
<p>Set of fixed parameters</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>add.cofactors</code></td>
<td>
<p>Names of cofactors that will be used (see fit_phenology)</p>
</td>
</tr>
</table>
<h3>Details</h3>

<p>par_init calculates initial set of parameters.
</p>


<h3>Value</h3>

<p>The initial set of parameters
</p>


<h3>Author(s)</h3>

<p>Marc Girondot
</p>


<h3>See Also</h3>

<p>Other Phenology model: 
<code>AutoFitPhenology()</code>,
<code>BE_to_LBLE()</code>,
<code>Gratiot</code>,
<code>LBLE_to_BE()</code>,
<code>LBLE_to_L()</code>,
<code>L_to_LBLE()</code>,
<code>MarineTurtles_2002</code>,
<code>MinBMinE_to_Min()</code>,
<code>adapt_parameters()</code>,
<code>add_SE()</code>,
<code>add_phenology()</code>,
<code>extract_result()</code>,
<code>fit_phenology()</code>,
<code>likelihood_phenology()</code>,
<code>logLik.phenology()</code>,
<code>map_Gratiot</code>,
<code>map_phenology()</code>,
<code>phenology()</code>,
<code>phenology2fitRMU()</code>,
<code>phenology_MHmcmc()</code>,
<code>phenology_MHmcmc_p()</code>,
<code>plot.phenology()</code>,
<code>plot.phenologymap()</code>,
<code>plot_delta()</code>,
<code>plot_phi()</code>,
<code>print.phenology()</code>,
<code>print.phenologymap()</code>,
<code>print.phenologyout()</code>,
<code>remove_site()</code>,
<code>result_Gratiot</code>,
<code>result_Gratiot1</code>,
<code>result_Gratiot2</code>,
<code>result_Gratiot_Flat</code>,
<code>result_Gratiot_mcmc</code>,
<code>summary.phenology()</code>,
<code>summary.phenologymap()</code>,
<code>summary.phenologyout()</code>
</p>


<h3>Examples</h3>

<pre><code class="language-R">## Not run: 
library(phenology)
# Read a file with data
data(Gratiot)
# Generate a formatted list nammed data_Gratiot 
data_Gratiot &lt;- add_phenology(Gratiot, name="Complete", 
		reference=as.Date("2001-01-01"), format="%d/%m/%Y")
# Generate initial points for the optimisation
parg &lt;- par_init(data_Gratiot, fixed.parameters=NULL)
# Run the optimisation
result_Gratiot &lt;- fit_phenology(data=data_Gratiot, 
		fitted.parameters=parg, fixed.parameters=NULL)
data(result_Gratiot)
# Plot the phenology and get some stats
output&lt;-plot(result_Gratiot)

## When a series has only 0, it should be used in two steps
## Let see an example

# Let create a times series with only 0
data0 &lt;- data.frame(Date=c("11/3/2015", "12/3/2015", "13/3/2015-18/3/2015", "25/3/2015"), 
                    Number=c(0, 0, 0, 0), 
                    Beach=rep("Site0", 4), stringsAsFactors=FALSE)
data1 &lt;- data.frame(Date=c("15/3/2015", "16/3/2015", "20/3/2015-22/3/2015", "25/3/2015"), 
                    Number=c(1, 0, 3, 0), 
                    Beach=rep("Site1", 4), stringsAsFactors=FALSE)
data &lt;- rbind(data0, data1)

# Here I include timeseries with no observation
try1 &lt;- add_phenology(data, format="%d/%m/%Y", month_ref=1, include0=TRUE)
pfixed &lt;- c(Min=0, Flat=0)
parg &lt;- par_init(try1, fixed.parameters=pfixed)
# The Max value for the series without observations should not be fitted. The ML is for Max being 0
pfixed &lt;- c(pfixed, parg[(substr(names(parg), 1, 4)=="Max_") &amp; (parg == 0)])
parg &lt;- parg[!(names(parg) %in% names(pfixed))]


## End(Not run)
</code></pre>


</div>