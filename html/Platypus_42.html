<div class="container">

<table style="width: 100%;"><tr>
<td>VDJ_GEX_clonotype_clusters_circos</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>Makes a Circos plot from the VDJ_GEX_integrate output. Connects the clonotypes with the corresponding clusters.</h2>

<h3>Description</h3>

<p>Makes a Circos plot from the VDJ_GEX_integrate output. Connects the clonotypes with the corresponding clusters.
</p>


<h3>Usage</h3>

<pre><code class="language-R">VDJ_GEX_clonotype_clusters_circos(
  VGM,
  topX,
  label.threshold,
  axis,
  c.threshold,
  c.count.label,
  c.count.label.size,
  n_cluster,
  platypus.version,
  gene.label,
  gene.label.size,
  arr.col,
  arr.direction,
  platy.theme,
  clonotype.column
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>VGM</code></td>
<td>
<p>The output of the VDJ_GEX_matrix function (VDJ_GEX_matrix.output[[1]]) has to be supplied. For Platypus v2: The output of the VDJ_GEX_integrate function (Platypus platypus.version v2). A list of data frames for each sample containing the clonotype information and cluster membership information.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>topX</code></td>
<td>
<p>Filters for the top X clonotypes and only plots the respective gene combinations or cluster memberships.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>label.threshold</code></td>
<td>
<p>Genes are only labeled if the count is larger then the label.threshold. By default all label.threshold = 0 (all genes are labeled).</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>axis</code></td>
<td>
<p>Character. Axis scaling. Defaults to "max". Passed to VDJ_circos</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>c.threshold</code></td>
<td>
<p>Only clonotypes are considered with a frequency higher then c.threshold. Allows to filter for only highly expanded clonotypes.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>c.count.label</code></td>
<td>
<p>Boolean, lets the user decide if the gene and count labels should be plotted or not. Default = T.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>c.count.label.size</code></td>
<td>
<p>Determines the font size of the gene labels. By default the font size for count labels is 0.6.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>n_cluster</code></td>
<td>
<p>Integer. No default.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>platypus.version</code></td>
<td>
<p>Input version to use. Defaults to "v3" for VDJ_GEX_matrix input</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>gene.label</code></td>
<td>
<p>Boolean, lets the user decide if the gene labels should be plotted or not.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>gene.label.size</code></td>
<td>
<p>Determines the font size of the gene labels. By default the labelsize is automatically adjusted to 0.7 for labels with two or less digits, 0.6 for labels between 2 and 6 digits, and 0.4 for all longer labels. A manually defined font size will be the same for all labels!</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>arr.col</code></td>
<td>
<p>Data.frame with three columns where the first two indicate the names of genes, clonotypes or clusters to be connected, and the third corresponds to the color of the arrow. Default set to data.frame(c("dummy.clonotype"), c("dummy.cluster"), c("dummy.color")), so no arrow is drawn.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>arr.direction</code></td>
<td>
<p>Either 1 or -1 and determines the direction of the arrow. Default=1.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>platy.theme</code></td>
<td>
<p>Allows plotting in the new "pretty" theme or the older "spiky" theme without group labels and radial arrangement of gene.labels. Default = "pretty".</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>clonotype.column</code></td>
<td>
<p>Which column in VGM contains the clonotyping information? Default="clonotype_id_10X".</p>
</td>
</tr>
</table>
<h3>Value</h3>

<p>Returns a circos plot and a list object with the following elememts for N samples: [[1 to N]] The first N listelements corresponds to the recorded circos plots for N beeing the number or samples in the VGM. Since Circlize uses the R base plotting funciton, this is not a ggplot object but can still be replotted by calling the first list element. [[N+1]] Adjacency matrix forwarded to VDJ_circos(). This Matrix contains the counts and can be used for manual replotting using VDJ_circos directly. [[N+2]] Contains a named list with colors for each connection drawn and can be used for manual replotting using VDJ_circos directly. [[N+3]] Contains a named list with grouping information and can be used for manual replotting using VDJ_circos directly.
</p>


<h3>Examples</h3>

<pre><code class="language-R">
try({
 clonotype.clusters &lt;- VDJ_GEX_clonotype_clusters_circos(Platypus::small_vgm[[1]],
 n_cluster=8, topX = 20)
 clonotype.clusters[[1]]
 })


</code></pre>


</div>