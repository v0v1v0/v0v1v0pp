<div class="container">

<table style="width: 100%;"><tr>
<td>phenogram</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>Plot traitgram (phenogram)</h2>

<h3>Description</h3>

<p>Plots a phylogenetic traitgram (Evans et al., 2009).
</p>


<h3>Usage</h3>

<pre><code class="language-R">phenogram(tree, x, fsize=1.0, ftype="reg", colors=NULL, axes=list(),
   add=FALSE, ...)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>tree</code></td>
<td>
<p>an object of class <code>"phylo"</code>, with or without a mapped discrete character.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>x</code></td>
<td>
<p>a vector containing the states at the tips <em>or</em> the states at all the tips and the internal nodes of the tree.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>fsize</code></td>
<td>
<p>relative font size for tip labels.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>ftype</code></td>
<td>
<p>font type - options are <code>"reg"</code>, <code>"i"</code> (italics), <code>"b"</code> (bold), or <code>"bi"</code> (bold-italics).</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>colors</code></td>
<td>
<p>colors for plotting the mapped character (if available) in <code>tree</code>. If no character is mapped on the tree, then a single color for all the branches of the tree can be provided.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>axes</code></td>
<td>
<p>list of axis dimensions. Items are <code>time</code> and <code>trait</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>add</code></td>
<td>
<p>optional logical value indicating whether to add to an open plot. If <code>TRUE</code>, then new axes will not be plotted.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>...</code></td>
<td>
<p>optional arguments including <code>xlim</code>, <code>ylim</code>, <code>log</code>, <code>main</code>, <code>sub</code>, <code>xlab</code>, <code>ylab</code>, <code>asp</code>, <code>type</code>, <code>lty</code>, <code>lwd</code>, <code>offset</code>, and <code>digits</code> are as in <code>plot.default</code> or <code>par</code>. Note that <code>axes</code> overrides <code>xlim</code> and <code>ylim</code>. <code>spread.labels</code> is a logical value indicating whether or not to minimize tip label overlap (default is <code>TRUE</code>); <code>spread.cost</code> is a numeric vector indicating the relative penalty to be used for label overlap and deviance, respectively (if <code>spread.labels=TRUE</code>); <code>spread.range</code> is the range over which to (potentially) spread the labels - note that if labels do not overlap, not all of that range will be used; finally, <code>link</code> is a numeric value by which to offset the tip labels, linking them to the tips with a dashed line (default is <code>0</code>, if <code>spread.labels=FALSE</code>, or 10% of the total tree length otherwise). The optional argument <code>offsetFudge</code> "fudges" the computation of label offset in scaling <code>xlim</code>. It is 1.37, which is the correct fudge in the Windows R GUI, but this may need to be changed in other systems. <code>hold</code> indicates whether (or not) the output to the graphical device should be held using <code>dev.hold</code> before plotting (defaults to <code>hold=TRUE</code>). <code>quiet</code> suppresses some system messages if set to <code>quiet=TRUE</code>.</p>
</td>
</tr>
</table>
<h3>Details</h3>

<p>Function plots a traitgram (Evans et al. 2009), that is, a projection of the phylogenetic tree in a space defined by phenotype (on the <em>y</em> axis) and time (on the <em>x</em>). If a discrete character is mapped on the tree this will also be plotted.
</p>
<p>For <code>spread.labels=TRUE</code> numerical optimization is performed to optimize the distribution of the labels vertically, where the solution depends on the vector <code>spread.cost</code> containing the cost of overlap (first) and the cost of deviation from the vertical position of the tip. Note that because this is done via numerical optimization, plotting may hang briefly while the best solution is found (especially for large trees).
</p>


<h3>Value</h3>

<p>Plots a traitgram, optionally with a mapped discrete character, and (invisibly) returns a matrix containing the coordinates of the plotted tip labels.
</p>


<h3>Author(s)</h3>

<p>Liam Revell <a href="mailto:liam.revell@umb.edu">liam.revell@umb.edu</a></p>


<h3>References</h3>

<p>Evans, M. E. K., Smith, S. A., Flynn, R. S., Donoghue, M. J. (2009) Climate, niche evolution, and diversification of the "bird-cage" evening primroses (Oenothera, sections Anogra and Kleinia). <em>American Naturalist</em>, <b>173</b>, 225-240.
</p>
<p>Revell, L. J. (2013) Two new graphical methods for mapping trait evolution on phylogenies. <em>Methods in Ecology and Evolution</em>, <b>4</b>, 754-759.
</p>
<p>Revell, L. J. (2014) Graphical methods for visualizing comparative data on phylogenies. Chapter 4 in <em>Modern phylogenetic comparative methods and their application in evolutionary biology: Concepts and practice</em> (L. Z. Garamszegi ed.), pp. 77-103.
</p>
<p>Revell, L. J. (2024) phytools 2.0: an updated R ecosystem for phylogenetic comparative methods (and other things). <em>PeerJ</em>, <b>12</b>, e16505.
</p>
<p>Revell, L. J., K. Schliep, E. Valderrama, and J. E. Richardson (2018) Graphs in phylogenetic comparative analysis: Anscombe's quartet revisited. <em>Methods in Ecology and Evolution</em>, <b>9</b>, 2145-2154.
</p>


<h3>Examples</h3>

<pre><code class="language-R">## load data from Garland et al. (1992)
data(mammal.tree)
data(mammal.data)
## extract character of interest
ln.bodyMass&lt;-log(setNames(mammal.data$bodyMass,
  rownames(mammal.data)))
## plot traitgram
phenogram(mammal.tree,ln.bodyMass,ftype="i",
  spread.cost=c(1,0),fsize=0.7,color=palette()[4],
  xlab="time (ma)",ylab="log(body mass)",las=1)
</code></pre>


</div>