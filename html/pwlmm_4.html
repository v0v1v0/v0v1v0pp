<div class="container">

<table style="width: 100%;"><tr>
<td>wmlmm</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>Fit Weighted Multivariate Linear Multilevel Model to Longitudinal Data.</h2>

<h3>Description</h3>

<p>Fit a two-level probability-weighted multivariate linear model with a linear error covariance matrix structure, via IGLS algorithm.
</p>


<h3>Usage</h3>

<pre><code class="language-R">wmlmm(formula, data = NULL, ID3, ID2, ID1, wj, wij, type, rot = NULL)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>formula</code></td>
<td>
<p>a linear formula object with the response on the left of a ~ operator and the terms, separated by + operators, on the right.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>data</code></td>
<td>
<p>an optional data frame containing the variables in <code>formula</code>. If not found in data, the variables are taken from the environment of <code>formula</code> (if specified as a formula) or from the parent frame (if specified as a character vector).</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>ID3</code></td>
<td>
<p>vector of indexes for level two units</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>ID2</code></td>
<td>
<p>vector of indexes for level one units.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>ID1</code></td>
<td>
<p>vector of successive measurements within the same level one unit, for all units.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>wj</code></td>
<td>
<p>a vector of sampling weights for level two units. Level two units are selected with inclusion probabilities. Then, sampling weights for the level two units are defined as the inverse of these probabilities.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>wij</code></td>
<td>
<p>a vector of sampling weights for level one units. After selecting a level two unit, level one units belonging to them are selected with inclusion probabilities. Then, sampling weights for the level one units are defined as the inverse of these probabilities.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>type</code></td>
<td>
<p>type of structure imposed in the error covariance matrix; "toep" refers to the toeplitz, "uns" refers to the unestructured and "genlin" refers to the general linear.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>rot</code></td>
<td>
<p>vector of 0's and 1's related to the measurements in time when <code>"genlin"</code> is passed to the <code>type</code> argument. Use 1 if the data were collected in that specific time unit, and 0 otherwise.</p>
</td>
</tr>
</table>
<h3>Details</h3>

<p>Follows estimation process described in Veiga et al. (2014). Uses probability-weighted IGLS with scaled weights.
</p>


<h3>Value</h3>

<p>Estimated list of estimators
</p>


<h3>References</h3>

<p>A. Veiga, P. W. F. Smith and J. J. Brown (2014),
The use of sample weights in multivariate multilevel models with an application to income data collected by using a rotating panel survey
Journal of the Royal Statistical Society. Series C (Applied Statistics)
Vol. 63, No. 1 (JANUARY 2014), pp. 65-84 (20 pages)
</p>


<h3>Examples</h3>

<pre><code class="language-R">data(datamultv)
 wmlmm ( Y ~ X1 + X2, data = datamultv, PSU, idd, wave, wj, wi_j, "toep")

</code></pre>


</div>