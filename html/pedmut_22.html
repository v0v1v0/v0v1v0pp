<div class="container">

<table style="width: 100%;"><tr>
<td>mutationMatrix</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>Mutation matrix</h2>

<h3>Description</h3>

<p>Construct mutation matrices for pedigree likelihood computations.
</p>


<h3>Usage</h3>

<pre><code class="language-R">mutationMatrix(
  model = c("custom", "equal", "proportional", "random", "onestep", "stepwise",
    "trivial"),
  matrix = NULL,
  alleles = NULL,
  afreq = NULL,
  rate = NULL,
  seed = NULL,
  rate2 = NULL,
  range = NULL
)

validateMutationMatrix(mutmat, alleles = NULL)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>model</code></td>
<td>
<p>A string: either "custom", "equal", "proportional", "random",
"stepwise" or "onestep".</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>matrix</code></td>
<td>
<p>When <code>model</code> is "custom", this must be a square matrix with
nonnegative real entries and row sums equal to 1.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>alleles</code></td>
<td>
<p>A character vector (or coercible to character) with allele
labels. Required in all models, except "custom" if <code>matrix</code> has dimnames.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>afreq</code></td>
<td>
<p>A numeric vector of allele frequencies. Required in model
"proportional".</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>rate</code></td>
<td>
<p>A number between 0 and 1. Required in models "equal",
"proportional", "stepwise" and "onestep".</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>seed</code></td>
<td>
<p>A single number. Optional parameter in the "random" model, passed
on to <code>set.seed()</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>rate2</code></td>
<td>
<p>A number between 0 and 1. The mutation rate between integer
alleles and microvariants. Required in the "stepwise" model.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>range</code></td>
<td>
<p>A positive number. The relative probability of mutating n+1
steps versus mutating n steps. Required  in the "stepwise" model.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>mutmat</code></td>
<td>
<p>An object of class <code>mutationMatrix</code>.</p>
</td>
</tr>
</table>
<h3>Details</h3>

<p>Descriptions of the models:
</p>

<ul>
<li> <p><code>custom</code> : Allows any mutation matrix to be provided by the user, in the
<code>matrix</code> parameter.
</p>
</li>
<li> <p><code>equal</code> :  All mutations equally likely; probability <code class="reqn">1-rate</code> of no
mutation.
</p>
</li>
<li> <p><code>proportional</code> : Mutation probabilities are proportional to the target
allele frequencies.
</p>
</li>
<li> <p><code>random</code> : This produces a matrix of random numbers, where each row is
normalised so that it sums to 1.
</p>
</li>
<li> <p><code>onestep</code>: A mutation model for microsatellite markers, allowing mutations
only to the nearest neighbours in the allelic ladder. For example, '10' may
mutate to either '9' or '11', unless '10' is the lowest allele, in which case
'11' is the only option. This model is not applicable to loci with
non-integral microvariants.
</p>
</li>
<li> <p><code>stepwise</code>: A common model in forensic genetics, allowing different
mutation rates between integer alleles (like '16') and non-integer
"microvariants" like '9.3'). Mutations also depend on the size of the
mutation if the parameter 'range' differs from 1.
</p>
</li>
<li> <p><code>trivial</code> : The identity matrix; i.e. no mutations are possible.
</p>
</li>
</ul>
<h3>Value</h3>

<p>A square matrix with entries in <code style="white-space: pre;">⁠[0, 1]⁠</code>, with the allele labels as
both colnames and rownames.
</p>


<h3>Examples</h3>

<pre><code class="language-R">mutationMatrix(alleles = 1:3, model = "equal", rate = 0.05)

</code></pre>


</div>