<div class="container">

<table style="width: 100%;"><tr>
<td>hd2part</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>Main fitting function for group lasso and cooperative lasso penalized two part models</h2>

<h3>Description</h3>

<p>This function fits penalized two part models with a logistic regression model
for the zero part and a gamma regression model for the positive part. Each covariate's effect
has either a group lasso or cooperative lasso penalty for its effects for the two consituent
models
</p>


<h3>Usage</h3>

<pre><code class="language-R">hd2part(
  x,
  z,
  x_s,
  s,
  weights = rep(1, NROW(x)),
  weights_s = rep(1, NROW(x_s)),
  offset = NULL,
  offset_s = NULL,
  penalty = c("grp.lasso", "coop.lasso"),
  penalty_factor = NULL,
  nlambda = 100L,
  lambda_min_ratio = ifelse(n_s &lt; p, 0.05, 0.005),
  lambda = NULL,
  tau = 0,
  opposite_signs = FALSE,
  flip_beta_zero = FALSE,
  intercept_z = FALSE,
  intercept_s = FALSE,
  strongrule = TRUE,
  maxit_irls = 50,
  tol_irls = 1e-05,
  maxit_mm = 500,
  tol_mm = 1e-05,
  balance_likelihoods = TRUE
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>x</code></td>
<td>
<p>an n x p matrix of covariates for the zero part data, where each row is an observation
and each column is a predictor</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>z</code></td>
<td>
<p>a length n vector of responses taking values 1 and 0, where 1 indicates the response is positive
and zero indicates the response has value 0.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>x_s</code></td>
<td>
<p>an n_s x p matrix of covariates (which is a submatrix of x) for the positive part data, where
each row is an observation and each column is a predictor</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>s</code></td>
<td>
<p>a length n_s vector of responses taking strictly positive values</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>weights</code></td>
<td>
<p>a length n vector of observation weights for the zero part data</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>weights_s</code></td>
<td>
<p>a length n_s vector of observation weights for the positive part data</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>offset</code></td>
<td>
<p>a length n vector of offset terms for the zero part data</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>offset_s</code></td>
<td>
<p>a length n_s vector of offset terms for the positive part data</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>penalty</code></td>
<td>
<p>either <code>"grp.lasso"</code> for the group lasso penalty or <code>"coop.lasso"</code> for the
cooperative lasso penalty</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>penalty_factor</code></td>
<td>
<p>a length p vector of penalty adjustment factors corresponding to each covariate.
A value of 0 in the jth location indicates no penalization on the jth variable, and any positive value will
indicate a multiplicative factor on top of the common penalization amount. The default value is 1 for
all variables</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>nlambda</code></td>
<td>
<p>the number of lambda values. The default is 100.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>lambda_min_ratio</code></td>
<td>
<p>Smallest value for <code>lambda</code>, as a fraction of lambda.max, the data-derived largest lambda value
The default depends on the sample size relative to the number of variables.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>lambda</code></td>
<td>
<p>a user supplied sequence of penalization tuning parameters. By default, the program automatically
chooses a sequence of lambda values based on <code>nlambda</code> and <code>lambda_min_ratio</code></p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>tau</code></td>
<td>
<p>value between 0 and 1 for sparse group mixing penalty. 0 implies either group lasso or coop lasso and 1 implies
lasso</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>opposite_signs</code></td>
<td>
<p>a boolean variable indicating whether the signs of coefficients across models should be encouraged to have
opposite signs instead of the same signs. Default is <code>FALSE</code>. This variable has no effect for group lasso.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>flip_beta_zero</code></td>
<td>
<p>should we flip the signs of the parameters for the zero part model? Defaults to <code>FALSE</code>. Should only
be used for good reason</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>intercept_z</code></td>
<td>
<p>whether or not to include an intercept in the zero part model. Default is <code>TRUE</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>intercept_s</code></td>
<td>
<p>whether or not to include an intercept in the positive part model. Default is <code>TRUE</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>strongrule</code></td>
<td>
<p>should a strong rule be used? Defaults to <code>TRUE</code></p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>maxit_irls</code></td>
<td>
<p>maximum number of IRLS iterations</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>tol_irls</code></td>
<td>
<p>convergence tolerance for IRLS iterations</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>maxit_mm</code></td>
<td>
<p>maximum number of MM iterations. Note that for <code>algorithm = "irls"</code>, MM is used within
each IRLS iteration, so <code>maxit_mm</code> applies to the convergence of the inner iterations in this case.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>tol_mm</code></td>
<td>
<p>convergence tolerance for MM iterations. Note that for <code>algorithm = "irls"</code>, MM is used within
each IRLS iteration, so <code>tol_mm</code> applies to the convergence of the inner iterations in this case.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>balance_likelihoods</code></td>
<td>
<p>should the likelihoods be balanced so variables would enter both models at the same value of lambda
if the penalty were a lasso penalty? Recommended to keep at the default, <code>TRUE</code></p>
</td>
</tr>
</table>
<h3>Examples</h3>

<pre><code class="language-R">
library(personalized2part)

</code></pre>


</div>