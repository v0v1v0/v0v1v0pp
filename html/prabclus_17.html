<div class="container">

<table style="width: 100%;"><tr>
<td>communitydist</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>Distances between communities</h2>

<h3>Description</h3>

<p>Constructs distances between communities: chord- (Cavalli-Sforza and
Edwards, 1967), phiPT/phiST (Peakall and Smouse, 2012, Meirmans,
2006),
three versions of the shared allele distance between communities,
and geographical distance between communities.
</p>


<h3>Usage</h3>

<pre><code class="language-R">communitydist(alleleobj,comvector="auto",distance="chord",
                          compute.geodist=TRUE,out.dist=FALSE,
                          grouping=NULL,geodist=NA,diploid=TRUE,
                          phiptna=NA,...)


</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>alleleobj</code></td>
<td>
<p>if <code>diploid=TRUE</code>, an object of class
<code>alleleobject</code> as produced by
function  <code>alleleinit</code>. This has the required
information on the individuals that are grouped into communities. In
case <code>diploid=FALSE</code>, a list that needs to have components
<code>n.variables</code> (number of loci), <code>alevels</code> (vector of
allele names, see <code>alleleinit</code>) and
<code>charmatrix</code> (matrix of characters with one row for every
individual and one column for every locus giving the alleles; see
examples below for how this can be constructed for a
<code>prabobject</code> with presence-absence data).</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>comvector</code></td>
<td>
<p>either a vector of integers indicating to which
community an individual belongs (these need to be numbered from 1 to
a maximum number without interruption), or <code>"auto"</code>, which
indicates that communities are automatically generated by the
<code>communities</code>-function.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>distance</code></td>
<td>
<p>one of <code>"chord"</code>, <code>"phipt"</code>,
<code>"shared.average"</code>, <code>"shared.chakraborty"</code>,
<code>"shared.problist"</code>. See Details.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>compute.geodist</code></td>
<td>
<p>logical, indicating whether geographical
distances between communities should be generated.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>out.dist</code></td>
<td>
<p>logical, indicating whether <code>dist</code>-objects are
given out or rather distance matrices.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>grouping</code></td>
<td>
<p>something that can be coerced into a factor, for
passing on to <code>communities</code> in case that
<code>comvector=="auto"</code>. This implies that individuals in different
groups indicated by <code>grouping</code> cannot be together in the same
community. Furthermore (also if <code>comvector</code> is something
else), a vector of groups of communities will be computed, see
output component <code>comgroup</code>. In any case individuals in
different groups are not allowed to be in the same community.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>geodist</code></td>
<td>
<p>matrix or <code>dist</code>-object providing geographical
distances between individuals. Required if
<code>compute.geodist==TRUE</code> or <code>comvector=="auto"</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>diploid</code></td>
<td>
<p>logical, indicating whether loci are diploid, see
<code>alleleobj</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>phiptna</code></td>
<td>
<p>if <code>distance="phipt"</code>, value to be given out as
phiPT-distance in case that
the original definition amounts to 0/0 (particularly if communities
have just one member).</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>...</code></td>
<td>
<p>optional arguments to be passed on to <code>communities</code>.</p>
</td>
</tr>
</table>
<h3>Details</h3>

<p>All genetic distances between communities are based on the information
given in <code>alleleobj</code>; either on the alleles directly or on a genetic
distance (<code>distmat</code>-component, see <code>alleleinit</code>). 
The possible genetic distance measures between communities are as follows:
</p>

<ul>
<li> <p><code>"chord"</code>: chord-distance (Cavalli-Sforza and Edwards,
1967)
</p>
</li>
<li> <p><code>"phipt"</code>: phiPT-distance implemented according to
Peakall and Smouse, 2012. This also appears in the literature under
the name phiST (Meirmans, 2006, although the definition there is
incomplete and we are not sure whether this is identical).
</p>
</li>
<li> <p><code>"shared.average"</code>: average of between-community genetic
distances.
</p>
</li>
<li> <p><code>"shared.chakraborty"</code>: between-community shared allele
distance according to Chakraborty and Jin (1993).
</p>
</li>
<li> <p><code>"shared.problist"</code>: this implements the shared allele
distance (Bowcock et al., 1994) for individuals directly for
communities (one minus proportion of alleles shared by two
communities averaged over loci).
</p>
</li>
</ul>
<h3>Value</h3>

<p>list with components
</p>
<table>
<tr style="vertical-align: top;">
<td><code>comvector</code></td>
<td>
<p>integer vector of length of the number of
individuals, indicating their community membership.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>dist</code></td>
<td>
<p>genetic distances between communities. Parameter <code>out.dist</code>
determines whether this is a <code>dist</code>-object or a matrix.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>cgeodist</code></td>
<td>
<p>if <code>compute.geodist</code>, geographical distance
between communities defined as average distance of all pairs of
individuals belonging to different ones of the two communities between
which the distance is computed. Parameter <code>out.dist</code>
determines whether this is a <code>dist</code>-object or a matrix.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>comgroup</code></td>
<td>
<p>vector of length of the number of communities. If
<code>grouping</code> was provided, this is a vector giving the group
memberships of all communities, otherwise it is a vector of 1s.</p>
</td>
</tr>
</table>
<h3>Author(s)</h3>

<p>Christian Hennig
<a href="mailto:christian.hennig@unibo.it">christian.hennig@unibo.it</a>
<a href="https://www.unibo.it/sitoweb/christian.hennig/en">https://www.unibo.it/sitoweb/christian.hennig/en</a></p>


<h3>References</h3>

<p>Bowcock, A. M., Ruiz-Linares, A., Tomfohrde, J., Minch, E., Kidd, J. R.,
Cavalli-Sforza, L. L. (1994) High resolution of human evolutionary
trees with polymorphic microsatellites. <em>Nature</em> 368, 455-457.
</p>
<p>Cavalli-Sforza, L. L. and Edwards, A. W. F. (1967) Phylogenetic
Analysis - Models and Estimation Procedures. <em>The American Journal of
Human Genetics</em> 19, 233-257.
</p>
<p>Chakraborty, R. and Jin, L. (1993) Determination of relatedness between
individuals using DNA fingerprinting. <em>Human Biology</em> 65, 875-895.
</p>
<p>Meirmans, P. G. (2006) Using the AMOVA framework to estimate a
standardized genetic differentiation measure. <em>Evolution</em> 60, 2399-2402.
</p>
<p>Peakall, R. and Smouse P.E. (2012) GenAlEx Tutorial 2.
<a href="https://biology-assets.anu.edu.au/GenAlEx/Tutorials.html">https://biology-assets.anu.edu.au/GenAlEx/Tutorials.html</a>
</p>


<h3>See Also</h3>

<p><code>communities</code>; refer to <code>phipt</code> for
computation of distances between specific pairs of communities.
<code>diploidcomlist</code> produces relative frequencies for all
alles of all loci in all communities (on which the chord- and the
<code>"shared.problist"</code>-distances are based). 
</p>


<h3>Examples</h3>

<pre><code class="language-R">  options(digits=4)
  data(tetragonula)
  tnb &lt;-
  coord2dist(coordmatrix=tetragonula.coord[83:120,],cut=50,
    file.format="decimal2",neighbors=TRUE)
  ta &lt;- alleleconvert(strmatrix=tetragonula[83:120,])
  tai &lt;- alleleinit(allelematrix=ta,neighborhood=tnb$nblist)
  tetraspec &lt;- c(rep(1,11),rep(2,13),rep(3,14))
  tetracoms &lt;-
  c(rep(1:3,each=3),4,5,rep(6:11,each=2),12,rep(13:19,each=2))
  c1 &lt;- communitydist(tai,comvector=tetracoms,distance="chord",
    geodist=tnb$distmatrix,grouping=tetraspec)
  c2 &lt;- communitydist(tai,comvector=tetracoms,distance="phipt",
    geodist=tnb$distmatrix,grouping=tetraspec,compute.geodist=FALSE)
  c3 &lt;- communitydist(tai,comvector=tetracoms,distance="shared.average",
    geodist=tnb$distmatrix,grouping=tetraspec,compute.geodist=FALSE)
  c4 &lt;- communitydist(tai,comvector=tetracoms,distance="shared.chakraborty",
    geodist=tnb$distmatrix,grouping=tetraspec,compute.geodist=FALSE)
  c5 &lt;- communitydist(tai,comvector=tetracoms,distance="shared.problist",
    geodist=tnb$distmatrix,grouping=tetraspec,compute.geodist=FALSE)
  round(c1$cgeodist,digits=1)
  c1$comvector
  c2$comvector
  c3$comvector
  c4$comvector
  c5$comvector
  round(c1$dist,digits=2)
  round(c2$dist,digits=2)
  round(c3$dist,digits=2)
  round(c4$dist,digits=2)
  round(c5$dist,digits=2)  
</code></pre>


</div>