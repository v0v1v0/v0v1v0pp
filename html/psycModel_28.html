<div class="container">

<table style="width: 100%;"><tr>
<td>lme_model</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>Linear Mixed Effect Model</h2>

<h3>Description</h3>

<p><a href="https://lifecycle.r-lib.org/articles/stages.html#stable"><img src="../help/figures/lifecycle-stable.svg" alt="[Stable]"></a> <br>
Fit a linear mixed effect model (i.e., hierarchical linear model, multilevel linear model) using the <code>nlme::lme()</code>  or the <code>lmerTest::lmer()</code> function.
Linear mixed effect model is used to explore the effect of continuous / categorical variables in predicting a normally distributed continuous variable.
</p>


<h3>Usage</h3>

<pre><code class="language-R">lme_model(
  data,
  model = NULL,
  response_variable,
  random_effect_factors = NULL,
  non_random_effect_factors = NULL,
  two_way_interaction_factor = NULL,
  three_way_interaction_factor = NULL,
  id,
  estimation_method = "REML",
  opt_control = "bobyqa",
  na.action = stats::na.omit,
  use_package = "lmerTest",
  quite = FALSE
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>data</code></td>
<td>
<p><code>data.frame</code></p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>model</code></td>
<td>
<p><code>lme4</code> model syntax. Support more complicated model. Note that model_summary will only return fixed effect estimates.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>response_variable</code></td>
<td>
<p>DV (i.e., outcome variable / response variable). Length of 1. Support <code>dplyr::select()</code> syntax.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>random_effect_factors</code></td>
<td>
<p>random effect factors (level-1 variable for HLM people) Factors that need to estimate fixed effect and random effect (i.e., random slope / varying slope based on the id). Support <code>dplyr::select()</code> syntax.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>non_random_effect_factors</code></td>
<td>
<p>non-random effect factors (level-2 variable for HLM people). Factors only need to estimate fixed effect. Support <code>dplyr::select()</code> syntax.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>two_way_interaction_factor</code></td>
<td>
<p>two-way interaction factors. You need to pass 2+ factor. Support <code>dplyr::select()</code> syntax.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>three_way_interaction_factor</code></td>
<td>
<p>three-way interaction factor. You need to pass exactly 3 factors. Specifying three-way interaction factors automatically included all two-way interactions, so please do not specify the two_way_interaction_factor argument. Support <code>dplyr::select()</code> syntax.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>id</code></td>
<td>
<p>the nesting variable (e.g. group, time). Length of 1. Support <code>dplyr::select()</code> syntax.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>estimation_method</code></td>
<td>
<p>character. <code>ML</code> or <code>REML</code> default to <code>REML</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>opt_control</code></td>
<td>
<p>default is <code>optim</code> for <code>lme</code> and <code>bobyqa</code> for <code>lmerTest</code></p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>na.action</code></td>
<td>
<p>default is <code>stats::na.omit</code>. Another common option is <code>na.exclude</code></p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>use_package</code></td>
<td>
<p>Default is <code>lmerTest</code>. Only available for linear mixed effect model. Options are <code>nlme</code>, <code>lmerTest</code>, or <code>lme4</code>(<code style="white-space: pre;">⁠'lme4⁠</code> return similar result as <code>lmerTest</code> except the return model)</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>quite</code></td>
<td>
<p>suppress printing output</p>
</td>
</tr>
</table>
<h3>Details</h3>

<p>Here is a little tip. If you are using generic selecting syntax (e.g., contains() or start_with()), you don't need to remove the response variable and the id from the factors. It will be automatically remove. For example, if you have x1:x9 as your factors. You want to regress x2:x8 on x1. Your probably pass something like response_variable = x1, random_effect_factors = c(contains('x'),-x1) to the function. However, you don't need to do that, you can just pass random_effect_factors = c(contains('x')) to the function since it will automatically remove the response variable from selection.
</p>


<h3>Value</h3>

<p>an object representing the linear mixed-effects model fit (it maybe an object from <code>lme</code> or <code>lmer</code> depending of the package you use)
</p>


<h3>Examples</h3>

<pre><code class="language-R"># two-level model with level-1 and level-2 variable with random intercept and random slope
fit1 &lt;- lme_model(
  data = popular,
  response_variable = popular,
  random_effect_factors = c(extrav, sex),
  non_random_effect_factors = texp,
  id = class
)


# added two-way interaction factor
fit2 &lt;- lme_model(
  data = popular,
  response_variable = popular,
  random_effect_factors = c(extrav, sex),
  non_random_effect_factors = texp,
  two_way_interaction_factor = c(extrav, texp),
  id = class
)

# pass a explicit lme model (I don't why you want to do that, but you can)
lme_fit &lt;- lme_model(
  model = "popular ~ extrav*texp + (1 + extrav | class)",
  data = popular
)
</code></pre>


</div>