<div class="container">

<table style="width: 100%;"><tr>
<td>evaluate_power</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>Power of a design to estimate a parameter.</h2>

<h3>Description</h3>

<p>Evaluate the power of a design to estimate a parameter value different than
some assumed value (often the assumed value is zero). The power is calculated 
using the linear Wald test and the the design is defined in a poped database.
</p>


<h3>Usage</h3>

<pre><code class="language-R">evaluate_power(
  poped.db,
  bpop_idx,
  h0 = 0,
  alpha = 0.05,
  power = 0.8,
  twoSided = TRUE,
  find_min_n = TRUE,
  fim = NULL,
  out = NULL,
  ...
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>poped.db</code></td>
<td>
<p>A poped database</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>bpop_idx</code></td>
<td>
<p>Index for an unfixed population parameter (bpop) for 
which the power should be
evaluated for being different than the null hypothesis (h0).</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>h0</code></td>
<td>
<p>The null hypothesized value for the parameter.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>alpha</code></td>
<td>
<p>Type 1 error.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>power</code></td>
<td>
<p>Targeted power.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>twoSided</code></td>
<td>
<p>Is this a two-sided test.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>find_min_n</code></td>
<td>
<p>Should the function compute the minimum n needed (given the
current design) to achieve the desired power?</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>fim</code></td>
<td>
<p>Provide the FIM from a previous calculation</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>out</code></td>
<td>
<p>provide output from a previous calculation (e.g.,
calc_ofv_and_fim, ...)</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>...</code></td>
<td>
<p>Extra parameters passed to <code>calc_ofv_and_fim</code> and
<code>get_rse</code></p>
</td>
</tr>
</table>
<h3>Value</h3>

<p>A list of elements evaluating the current design including the power.
</p>


<h3>References</h3>

 <ol>
<li>
<p> Retout, S., Comets, E., Samson, A., and Mentre,
F. (2007). Design in nonlinear mixed effects models: Optimization using the
Fedorov-Wynn algorithm and power of the Wald test for binary covariates.
Statistics in Medicine, 26(28), 5162-5179.
<a href="https://doi.org/10.1002/sim.2910">doi:10.1002/sim.2910</a>. </p>
</li>
<li>
<p> Ueckert, S., Hennig, S.,
Nyberg, J., Karlsson, M. O., and Hooker, A. C. (2013). Optimizing disease
progression study designs for drug effect discrimination. Journal of
Pharmacokinetics and Pharmacodynamics, 40(5), 587-596.
<a href="https://doi.org/10.1007/s10928-013-9331-3">doi:10.1007/s10928-013-9331-3</a>. </p>
</li>
</ol>
<h3>See Also</h3>

<p>Other evaluate_design: 
<code>evaluate.fim()</code>,
<code>evaluate_design()</code>,
<code>get_rse()</code>,
<code>model_prediction()</code>,
<code>plot_efficiency_of_windows()</code>,
<code>plot_model_prediction()</code>
</p>


<h3>Examples</h3>

<pre><code class="language-R"># Folowing the examples presented in Retout, 2007

ff &lt;- function(model_switch,xt,parameters,poped.db){
  with(as.list(parameters),{
    
    lambda1 &lt;- lam1a
    if(TREAT==2) lambda1 &lt;- lam1b
    
    y=log10(P1*exp(-lambda1*xt)+P2*exp(-lam2*xt))
    
    return(list(y=y,poped.db=poped.db))
  })
}

sfg &lt;- function(x,a,bpop,b,bocc){
  parameters=c(P1=exp(bpop[1]+b[1]),
               P2=exp(bpop[2]+b[2]),
               lam1a=exp(bpop[3]+b[3]),
               lam1b=exp(bpop[3]+bpop[4]+b[3]),
               lam2=exp(bpop[5]+b[4]),
               TREAT=a[1])
  return(parameters) 
}
  

poped.db &lt;- create.poped.database(ff_fun = ff,
                                  fg_fun = sfg,
                                  fError_fun = feps.add,
                                  bpop=c(P1=12, P2=8,
                                         lam1=-0.7,beta=0,lam2=-3.0),
                                  d=c(P1=0.3, P2=0.3,
                                      lam1=0.3,lam2=0.3), 
                                  sigma=c(0.065^2),
                                  groupsize=100,
                                  m=2,
                                  xt=c(1, 3, 7, 14, 28, 56),
                                  minxt=0,
                                  maxxt=100,
                                  a=list(c(TREAT=1),c(TREAT=2)))

plot_model_prediction(poped.db)
evaluate_design(poped.db)

poped.db_2 &lt;- create.poped.database(poped.db,bpop=c(P1=12, P2=8,
                                      lam1=-0.7,beta=0.262,lam2=-3.0))

plot_model_prediction(poped.db_2)
evaluate_design(poped.db_2)

evaluate_power(poped.db_2,bpop_idx = 4)
</code></pre>


</div>