<div class="container">

<table style="width: 100%;"><tr>
<td>BB</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>
The Beta-Binomial Distribution
</h2>

<h3>Description</h3>

<p>Density and random generation for the beta-binomial distribution.
</p>


<h3>Usage</h3>

<pre><code class="language-R">dBB(m,p,phi)
rBB(k,m,p,phi)</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>k</code></td>
<td>
<p> number of simulations.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>m</code></td>
<td>
<p> maximum socre number in each beta-binomial observation..</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>p</code></td>
<td>
<p> probability parameter of the beta-binomial distribution.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>phi</code></td>
<td>
<p> dispersion parameter of the beta-binomial distribution.</p>
</td>
</tr>
</table>
<h3>Details</h3>

<p>The beta-binomial distribution consists of a finite sum of Bernoulli dependent variables whose probability parameter is random and follows a beta distribution. Assume that we have <code class="reqn">y_j</code> a set of variables, <code class="reqn">j=1,...,m</code>, with m integer, that conditioned on a random variable <code class="reqn">u</code>, are independent and follow a Bernoulli distribution with probability parameter <code class="reqn">u</code>. On the other hand, the random variable <code class="reqn">u</code> follows a beta distribution with parameter <code class="reqn">p/phi</code> and <code class="reqn">(1-p)/phi</code>. Namely,
</p>
<p style="text-align: center;"><code class="reqn">y_j \sim Ber(u), u \sim Beta(p/phi,(1-p)/phi),</code>
</p>

<p>where <code class="reqn">0&lt;p&lt;1</code> and <code class="reqn">phi&gt;0</code>. The first and second order marginal moments of this distribution are defined as
</p>
<p style="text-align: center;"><code class="reqn">E[y_j]=p, Var[y_j]=p(1-p),</code>
</p>

<p>and correlation between observations is defined as
</p>
<p style="text-align: center;"><code class="reqn">Corr[y_j,y_k]=phi/(1+phi),</code>
</p>

<p>where <code class="reqn">j,k=1,...,m</code> are different. Consequently, <code class="reqn">phi</code> can be considered as a dispersion parameter.
</p>
<p>If we sum up all the variables we will define a new variable which follows a new distribution that is called beta-binomial distribution, and it is defined as follows. The variable <code class="reqn">y</code> follows a beta-binomial distribution with parameters <code class="reqn">m</code>, <code class="reqn">p</code> and <code class="reqn">phi</code> if
</p>
<p style="text-align: center;"><code class="reqn">y|u \sim Bin(m,u), u\sim Beta(p/phi,(1-p)/phi).</code>
</p>



<h3>Value</h3>

<p><code>dBB</code> gives the density of a beta-binomial distribution with the defined <code>m</code>, <code>p</code> and <code>phi</code> parameters.
</p>
<p><code>rBB</code> generates <code>k</code> random observations based on a beta-binomial distribution with the defined <code>m</code>, <code>p</code> and <code>phi</code> parameters.
</p>


<h3>Author(s)</h3>

<p>J. Najera-Zuloaga
</p>
<p>D.-J. Lee
</p>
<p>I. Arostegui
</p>


<h3>References</h3>

<p>Arostegui I., Nunez-Anton V. &amp; Quintana J. M. (2006): Analysis of short-form-36 (SF-36): The
beta-binomial distribution approach, <em>Statistics in Medicine</em>, <b>26</b>, 1318-1342
</p>


<h3>See Also</h3>

<p>The <code>rbeta</code> and <code>rbinom</code> functions of package <code>stats</code>.
</p>


<h3>Examples</h3>

<pre><code class="language-R">set.seed(12)
# We define
m &lt;- 10     
p &lt;- 0.4    
phi &lt;- 1.8  

# We perform k beta-binomial simulations for those parameters.
k &lt;- 100
bb &lt;- rBB(k,m,p,phi)
bb
dd &lt;- dBB(m,p,phi)

# We are going to plot the histogram of the created variable,
# and using dBB() function we are going to fit the distribution:
hist(bb,col="grey",breaks=seq(-0.5,m+0.5,1),probability=TRUE,
  main="Histogram",xlab="Beta-binomial random variable")
lines(seq(0,m),dd,col="red",lwd=4)

</code></pre>


</div>