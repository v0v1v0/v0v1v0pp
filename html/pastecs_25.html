<div class="container">

<table style="width: 100%;"><tr>
<td>turnpoints</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2> Analyze turning points (peaks or pits) </h2>

<h3>Description</h3>

<p>Determine the number and the position of extrema (turning points, either peaks or pits) in a regular time series. Calculate the quantity of information associated to the observations in this series, according to Kendall's information theory
</p>


<h3>Usage</h3>

<pre><code class="language-R">turnpoints(x, calc.proba = TRUE)
## S3 method for class 'turnpoints'
print(x, ...)
## S3 method for class 'turnpoints'
summary(object, ...)
## S3 method for class 'summary.turnpoints'
print(x, ...)
## S3 method for class 'turnpoints'
plot(x, level = 0.05, lhorz = TRUE, lcol = 2, llty = 2,
    type = "l", xlab = "data number", ylab = paste("I (bits), level = ",
    level * 100, "%", sep = ""), main = paste("Information (turning points) for:",
    x$data), ...)
## S3 method for class 'turnpoints'
lines(x, max = TRUE, min = TRUE, median = TRUE,
    col = c(4, 4, 2), lty = c(2, 2, 1), ...)
## S3 method for class 'turnpoints'
extract(e, n, no.tp = 0, peak = 1, pit = -1, ...)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>x</code></td>
<td>
<p> a vector or a time series for <code>turnpoints()</code>, a 'turnpoints' object for the methods </p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>calc.proba</code></td>
<td>
<p> are the probabilities associated with each turning point also calculated? The default, <code>TRUE</code>, should be correct unless you really do not need these. In this case, the <code>plot()</code> method is not usable </p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>object</code></td>
<td>
<p> a 'turnpoints' object, as returned by the function <code>turnpoints()</code> </p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>e</code></td>
<td>
<p> a 'turnpoints' object, as returned by the function <code>turnpoints()</code> </p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>level</code></td>
<td>
<p> the significant level to draw on the graph if <code>lhorz=TRUE</code>. By default, <code>level=0.05</code>, which corresponds to a 5% p-value for the test </p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>lhorz</code></td>
<td>
<p> if <code>lhorz=TRUE</code> (by default), an horizontal line indicating significant level is drawn on the graph </p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>lcol</code></td>
<td>
<p> the color to use to draw the significant level line, by default, color 2 is used </p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>llty</code></td>
<td>
<p> the style to use for the significant level line. By default, style 2 is used (dashed line) </p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>type</code></td>
<td>
<p> the type of plot, as usual meaning for this graph parameter </p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>xlab</code></td>
<td>
<p> the label of the x-axis </p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>ylab</code></td>
<td>
<p> the label of the y-axis </p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>main</code></td>
<td>
<p> the main title of the graph</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>max</code></td>
<td>
<p> do we plot the maximum envelope line (by default, yes) </p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>min</code></td>
<td>
<p> do we plot the minimum envelope line (by default, yes) </p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>median</code></td>
<td>
<p> do we plot the median line inside the envelope (by default, yes) </p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>col</code></td>
<td>
<p> a vector of three values for the color of the max, min, median lines, respectively. By default <code>col=c(4,4,2)</code> </p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>lty</code></td>
<td>
<p> a vector of three values for the style of the max, min, median lines, respectively. By default <code>lty=c(2,2,1)</code>, that is: dashed, dashed and plain lines </p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>n</code></td>
<td>
<p> the number of points to extract. By default <code>n=length(turnp)</code>, all points are extracted </p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>no.tp</code></td>
<td>
<p> extract gives a vector representing the position of extrema in the original series. <code>no.tp</code> represents the code to use for points that are not an extremum, by default '0' </p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>peak</code></td>
<td>
<p> the code to use to flag a peak, by default '1' </p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>pit</code></td>
<td>
<p> the code to use to flag a pit, by default '-1' </p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>...</code></td>
<td>
<p> Additional parameters </p>
</td>
</tr>
</table>
<h3>Details</h3>

<p>This function tests if the time series is purely random or not. Kendall (1976) proposed a series of tests for this. Moreover, graphical methods using the position of the turning points to draw automatically envelopes around the data are implemented, and also the drawing of median points between these envelopes.
</p>
<p>With a purely random time series, one expect to find, on average, a turning point (peak or pit that is, an observation that is preceeded and followed by, respectively, lower or higher observations) every 1.5 observation. Given it is impossible to determine if first and last observation are turning point, it gives:
</p>
<p style="text-align: center;"><code class="reqn">E(p) = 2/3*(n-2)</code>
</p>

<p>with p, the number of observed turning points and n the number of observations. The variance of p is:
</p>
<p style="text-align: center;"><code class="reqn">var(p) = (16*n - 29)/90</code>
</p>

<p>Ibanez (1982) demonstrated that P(t), the probability to observe a turning point at time t is:
</p>
<p style="text-align: center;"><code class="reqn">P(t) = 2*(1/n(t-1)! * (n-1)!)</code>
</p>

<p>where P is the probability to observe a turning point at time t under the null hypothesis that the time series is purely random, and thus, the distribution of turning points follows a normal distribution.
</p>
<p>The quantity of information I associated with this probability is:
</p>
<p style="text-align: center;"><code class="reqn">I = -log2 P(t)</code>
</p>

<p>It can be interpreted as follows. If I is larger, there are less turning points than expected in a purely random series. There are, thus, longer sequence of increasing or decreasing values along the time scale. This is considered to be more informative.
</p>
<p>As you can easily imagine, from this point on, it is straightforward to construct a test to determine if the series is random (regarding the distribution of the turning points), more or less monotonic (more or less turning points than expected).
</p>


<h3>Value</h3>

<p>An object of type 'turnpoints' is returned. It has methods <code>print()</code>, <code>summary()</code>, <code>plot()</code>, <code>lines()</code> and <code>extract()</code>.
Regarding your specific question, 'info' is the quantity of information I associated with the turning points:
</p>
<table>
<tr style="vertical-align: top;">
<td><code>data</code></td>
<td>
<p> The dataset to which the calculation is done </p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>n</code></td>
<td>
<p> The number of observations </p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>points</code></td>
<td>
<p> The value of the points in the series, after elimination of ex-aequos </p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>pos</code></td>
<td>
<p> The position of the points on the time scale in the series (including ex-aequos) </p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>exaequos</code></td>
<td>
<p> Location of exaequos (1), or not (0) </p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>nturns</code></td>
<td>
<p> Total number of tunring points in the whole time series </p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>firstispeak</code></td>
<td>
<p> Is the first turning point a peak (<code>TRUE</code>), or not (<code>FALSE</code>) </p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>peaks</code></td>
<td>
<p> Logical vector. Location of the peaks in the time series without ex-aequos </p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>pits</code></td>
<td>
<p> Logical vector. Location of the pits in the time series without ex-aequos</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>tppos</code></td>
<td>
<p> Position of the turning points in the initial series (with ex-aequos) </p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>proba</code></td>
<td>
<p> Probability to find a turning point at this location (see details) </p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>info</code></td>
<td>
<p> Quantity of information associated with this point (see details) </p>
</td>
</tr>
</table>
<h3>WARNING </h3>

<p> the <code>lines()</code> method should be used to draw lines on the graph of the <em>original</em> dataset (<code>plot(data, type="l")</code> for instance), <em>not</em> on the graph of turning points (<code>plot(turnp)</code>)! </p>


<h3>Author(s)</h3>

<p> Frederic Ibanez (<a href="mailto:ibanez@obs-vlfr.fr">ibanez@obs-vlfr.fr</a>), Philippe Grosjean (<a href="mailto:phgrosjean@sciviews.org">phgrosjean@sciviews.org</a>) </p>


<h3>References</h3>

<p>Ibanez, F., 1982. <em>Sur une nouvelle application de la theorie de l'information a la description des series chronologiques planctoniques.</em> J. Exp. Mar. Biol. Ecol., 4:619-632
</p>
<p>Kendall, M.G., 1976. <em>Time-series, 2nd ed.</em> Charles Griffin &amp; Co, London.
</p>


<h3>See Also</h3>

 <p><code>turnogram</code>, <code>stat.slide</code> </p>


<h3>Examples</h3>

<pre><code class="language-R">data(marbio)
plot(marbio[, "Nauplii"], type = "l")
# Calculate turning points for this series
Nauplii.tp &lt;- turnpoints(marbio[, "Nauplii"])
summary(Nauplii.tp)
plot(Nauplii.tp)
# Add envelope and median line to original data
plot(marbio[, "Nauplii"], type = "l")
lines(Nauplii.tp)
# Note that lines() applies to the graph of original dataset
title("Raw data, envelope maxi., mini. and median lines")
</code></pre>


</div>