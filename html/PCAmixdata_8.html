<div class="container">

<table style="width: 100%;"><tr>
<td>plot.MFAmix</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>Graphical outputs of MFAmix</h2>

<h3>Description</h3>

<p>Displays the graphical outputs of MFAmix. 
Individuals (observations), quantitative variables and 
levels of the qualitative variables are plotted as points 
using their factor coordinates (scores) in MFAmix. 
All the variables (quantitative and qualitative) are plotted 
on the same graph as points using their squared loadings. 
The groups of variables are plotted using their contributions 
to the component coordinates. Partial axes  and partial 
individuals of separated analyses can also be plotted.
</p>


<h3>Usage</h3>

<pre><code class="language-R">## S3 method for class 'MFAmix'
plot(x, axes = c(1, 2), choice = "ind", label = TRUE,
  coloring.var = "not", coloring.ind = NULL, nb.partial.axes = 3,
  col.ind = NULL, col.groups = NULL, partial = NULL, lim.cos2.plot = 0,
  lim.contrib.plot = 0, xlim = NULL, ylim = NULL, cex = 1,
  main = NULL, leg = TRUE, posleg = "topleft", cex.leg = 0.8,
  col.groups.sup = NULL, posleg.sup = "topright", nb.paxes.sup = 3, ...)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>x</code></td>
<td>
<p>an object of class MFAmix obtained with the function <code>MFAmix</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>axes</code></td>
<td>
<p>a length 2 vector specifying the components to plot.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>choice</code></td>
<td>
<p>the graph to plot: 
</p>

<ul>
<li>
<p> "ind" for the individuals, 
</p>
</li>
<li>
<p> "cor" for the correlation circle of the quantitative variables, 
</p>
</li>
<li>
<p> "levels" for the levels of of the qualitative variables,
</p>
</li>
<li>
<p> "sqload" for the plot of the squared loadings of all the variables, 
</p>
</li>
<li>
<p> "groups" for the plot of the contributions of the groups, 
</p>
</li>
<li>
<p> "axes" for the correlation circle of the partial axes.  
</p>
</li>
</ul>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>label</code></td>
<td>
<p>boolean, if FALSE the labels of the points are not plotted.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>coloring.var</code></td>
<td>
<p>a value to choose among: 
</p>

<ul>
<li>
<p> "type": the variables in the plot of the squared loadings are colored 
according to their type (quantitative or qualitative), 
</p>
</li>
<li>
<p> "groups": the variables are colored according to their group.
</p>
</li>
<li>
<p> NULL: variables are not colored.
</p>
</li>
</ul>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>coloring.ind</code></td>
<td>
<p>a qualitative variable such as a character vector 
or a factor of size n (the number of individuals). The individuals 
are colored according to the levels of this variable. If NULL, the 
individuals are not colored.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>nb.partial.axes</code></td>
<td>
<p>f choice="axes", the maximum number of partial axes 
related to each group to plot on the correlation circle. By default equal to 3.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>col.ind</code></td>
<td>
<p>a vector of colors, of size the number of levels of 
<code>coloring.ind</code>. If NULL, colors are chosen automatically.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>col.groups</code></td>
<td>
<p>a vector of colors, of size the number of groups. 
If NULL, colors are chosen automatically.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>partial</code></td>
<td>
<p>a vector of class character with the row names of the individuals,
for which the partial individuals should be drawn. 
By default partial = NULL and no partial points are drawn. 
Partial points are colored according to <code>col.groups</code></p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>lim.cos2.plot</code></td>
<td>
<p>a value between 0 and 1. Points with squared 
cosinus below this value are not plotted.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>lim.contrib.plot</code></td>
<td>
<p>a value between 0 and 100. Points with relative contributions
(in percentage) below this value  are not plotted.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>xlim</code></td>
<td>
<p>a numeric vectors of length 2, giving the x coordinates range. If NULL (by default) 
the range is defined automatically (recommended).</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>ylim</code></td>
<td>
<p>a numeric vectors of length 2, giving the y coordinates range. 
If NULL (by default) the range is defined automatically (recommended).</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>cex</code></td>
<td>
<p>cf. function <code>par</code> in the <b>graphics</b> package</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>main</code></td>
<td>
<p>a string corresponding to the title of the graph to draw.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>leg</code></td>
<td>
<p>boolean, if TRUE, a legend is displayed..</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>posleg</code></td>
<td>
<p>position of the legend.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>cex.leg</code></td>
<td>
<p>a numerical value giving the amount by which the legend should 
be magnified. Default is 0.8.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>col.groups.sup</code></td>
<td>
<p>a vector of colors, of size the number of supplementary groups. 
If NULL, colors are chosen automatically.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>posleg.sup</code></td>
<td>
<p>position of the legend for the supplementary groups.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>nb.paxes.sup</code></td>
<td>
<p>if choice="axes", the maximum number of partial axes 
of supplementary groups ploted on the correlation circle. By default equal to 3.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>...</code></td>
<td>
<p>arguments to be passed to methods, such as graphical parameters.</p>
</td>
</tr>
</table>
<h3>Details</h3>

<p>The observations can be colored according to the levels of a qualitative
variable. The observations, the quantitative variables and the levels can be 
selected according to their squared cosine (lim.cos2.plot) or their relative 
contribution (lim.contrib.plot) to the component map. Only points with squared 
cosine or relative contribution greater than a given threshold are plotted. 
Note that the relative contribution of a point to the component map (a plan) 
is the sum of the absolute contributions to each dimension, divided by the 
sum of the corresponding eigenvalues.
</p>


<h3>Author(s)</h3>

<p>, <a href="mailto:marie.chavent@u-bordeaux.fr">marie.chavent@u-bordeaux.fr</a>, Amaury Labenne
</p>


<h3>References</h3>

<p>Chavent M., Kuentz-Simonet V., Labenne A., Saracco J., Multivariate analysis of mixed data: The PCAmixdata R package, arXiv:1411.4911 [stat.CO].
</p>


<h3>See Also</h3>

<p><code>summary.PCAmix</code>,<code>PCAmix</code>,<code>PCArot</code>
</p>


<h3>Examples</h3>

<pre><code class="language-R">data(gironde)
class.var&lt;-c(rep(1,9),rep(2,5),rep(3,9),rep(4,4))
names &lt;- c("employment","housing","services","environment")
dat &lt;- cbind(gironde$employment[1:20,],gironde$housing[1:20,],
           gironde$services[1:20,],gironde$environment[1:20,])
res &lt;- MFAmix(data=dat,groups=class.var,
            name.groups=names, rename.level=TRUE, ndim=3,graph=FALSE)

#---- quantitative variables
plot(res,choice="cor",cex=0.6)
plot(res,choice="cor",cex=0.6,coloring.var="groups")
plot(res,choice="cor",cex=0.6,coloring.var="groups",
     col.groups=c("red","yellow","pink","brown"),leg=TRUE)

#----partial axes
plot(res,choice="axes",cex=0.6)
plot(res,choice="axes",cex=0.6,coloring.var="groups")
plot(res,choice="axes",cex=0.6,coloring.var="groups",
     col.groups=c("red","yellow","pink","brown"),leg=TRUE)

#----groups
plot(res,choice="groups",cex=0.6)   #no colors for groups
plot(res,choice="groups",cex=0.6,coloring.var="groups") 
plot(res,choice="groups",cex=0.6,coloring.var="groups",
     col.groups=c("red","yellow","pink","blue")) 
#----squared loadings
plot(res,choice="sqload",cex=0.8)    #no colors for groups
plot(res,choice="sqload",cex=0.8,coloring.var="groups",
     posleg="topright") 
plot(res,choice="sqload",cex=0.6,coloring.var="groups",
     col.groups=c("red","yellow","pink","blue"),ylim=c(0,1)) 
plot(res,choice="sqload",cex=0.8,coloring.var="type",
     cex.leg=0.9,posleg="topright")  

#----individuals 
plot(res,choice="ind",cex=0.6) 

#----individuals with squared cosine greater than 0.5
plot(res,choice="ind",cex=0.6,lim.cos2.plot=0.5)  

#----individuals colored with a qualitative variable
nbchem &lt;- gironde$services$chemist[1:20]
plot(res,choice="ind",cex=0.6,coloring.ind=nbchem,
     posleg="topright")   
plot(res,choice="ind",coloring.ind=nbchem,
     col.ind=c("pink","brown","darkblue"),label=FALSE,posleg="topright")     

#----partial individuals colored by groups
plot(res,choice="ind",partial=c("AUBIAC","ARCACHON"),
    cex=0.6,posleg="bottomright")

#----levels of qualitative variables
plot(res,choice="levels",cex=0.8)
plot(res,choice="levels",cex=0.8,coloring.var="groups")

#levels with squared cosine greater than 0.6
plot(res,choice="levels",cex=0.8, lim.cos2.plot=0.6)

#supplementary groups
data(wine)
X.quanti &lt;- splitmix(wine)$X.quanti[,1:5]
X.quali &lt;- splitmix(wine)$X.quali[,1,drop=FALSE]
X.quanti.sup &lt;- splitmix(wine)$X.quanti[,28:29]
X.quali.sup &lt;- splitmix(wine)$X.quali[,2,drop=FALSE]
data &lt;- cbind(X.quanti,X.quali)
data.sup &lt;- cbind(X.quanti.sup,X.quali.sup)

groups &lt;-c(1,2,2,3,3,1)
name.groups &lt;- c("G1","G2","G3")
groups.sup &lt;- c(1,1,2)
name.groups.sup &lt;- c("Gsup1","Gsup2")
mfa &lt;- MFAmix(data,groups,name.groups,ndim=4,rename.level=TRUE,graph=FALSE)
mfa.sup &lt;- supvar(mfa,data.sup,groups.sup,name.groups.sup,rename.level=TRUE)
plot(mfa.sup,choice="sqload",coloring.var="groups")
plot(mfa.sup,choice="axes",coloring.var="groups")
plot(mfa.sup,choice="groups",coloring.var="groups")
plot(mfa.sup,choice="levels",coloring.var="groups")
plot(mfa.sup,choice="levels")
plot(mfa.sup,choice="cor",coloring.var = "groups")

</code></pre>


</div>