<div class="container">

<table style="width: 100%;"><tr>
<td>multirateBM</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>Function to fit a multi-rate Brownian evolution model</h2>

<h3>Description</h3>

<p>Fits a flexible multi-rate Brownian motion evolution model using penalized likelihood.
</p>


<h3>Usage</h3>

<pre><code class="language-R">multirateBM(tree, x, method=c("ML","REML"), 
    optim=c("L-BFGS-B","Nelder-Mead","BFGS","CG"),
    maxit=NULL, n.iter=1, lambda=1, ...)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>tree</code></td>
<td>
<p>an object of class <code>"phylo"</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>x</code></td>
<td>
<p>a named numerical vector. Names should correspond to the species names of <code>tree</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>method</code></td>
<td>
<p>method of optimization. Currently only <code>method="ML"</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>optim</code></td>
<td>
<p>optimization routine to be used by <code>optim</code>. If more than one is specified and <code>n.iter&gt;1</code> then they will be alternated. (This is recommended to improve optimization.)</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>maxit</code></td>
<td>
<p>to be passed to <code>optim</code>. If set to <code>maxit=NULL</code>, the default value of <code>maxit</code> will be used, depending on the optimization method.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>n.iter</code></td>
<td>
<p>number of times to reiterate failed optimization.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>lambda</code></td>
<td>
<p>lambda penalty term. High values of <code>lambda</code> correspond to high penalty for rate heterogeneity among edges. Low values of <code>lambda</code> correspond to low penalty.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>...</code></td>
<td>
<p>optional arguments.</p>
</td>
</tr>
</table>
<h3>Details</h3>

<p>This function fits a flexible Brownian multi-rate model using penalized likelihood.
</p>
<p>The model that is being fit is one in which the rate of Brownian motion evolution itself evolves from edge to edge in the tree under a process of geometric Brownian evolution (i.e., Brownian motion evolution on a log scale).
</p>
<p>The penalty term, <code>lambda</code>, determines the cost of variation in the rate of evolution from branch to branch. If lambda is <em>high</em>, then the rate of evolution will vary relatively little between edges (and in the limiting case converge to the single-rate MLE estimate of the rate). By contrast, if the value of <code>lambda</code> is set to be low, then the rate of evolution can vary from edge to edge with relatively little penalty. 
</p>
<p>Decreasing the penalty term, however, is not without cost. As <code>lambda</code> is decreased towards zero, estimated rates will tend to become less and less accurate.
</p>


<h3>Value</h3>

<p>An object of class <code>"multirateBM"</code>.
</p>


<h3>Author(s)</h3>

<p>Liam Revell <a href="mailto:liam.revell@umb.edu">liam.revell@umb.edu</a></p>


<h3>References</h3>

<p>Revell, L. J. (2021) A variable-rate quantitative trait evolution model using penalized-likelihood. <em>PeerJ</em>, <b>9</b>, e11997.
</p>
<p>Revell, L. J. (2024) phytools 2.0: an updated R ecosystem for phylogenetic comparative methods (and other things). <em>PeerJ</em>, <b>12</b>, e16505.
</p>


<h3>See Also</h3>

<p><code>brownie.lite</code>, <code>evol.rate.mcmc</code>
</p>


<h3>Examples</h3>

<pre><code class="language-R">## Not run: 
## load data
data(sunfish.tree)
data(sunfish.data)
## convert from "simmap" to "phylo"
sunfish.tree&lt;-as.phylo(sunfish.tree)
## extract character of interest
gw&lt;-setNames(sunfish.data$gape.width,
    rownames(sunfish.data))
## run penalized-likelihood optimization
## lambda=0.1 is arbitrary
fitBM&lt;-multirateBM(sunfish.tree,gw,
    lambda=0.01)
## print and plot the results
print(fitBM)
plot(fitBM,ftype="i",fsize=0.8,lwd=6,
    outline=TRUE)
## reset par
par(mar=c(5.1,4.1,4.1,2.1))
## End(Not run)
</code></pre>


</div>