<div class="container">

<table style="width: 100%;"><tr>
<td>estcount.bilevel.subgroups</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>Estimate the Average Treatment Effect of the log risk ratio in multiple
bi-level subgroups defined by the proportions</h2>

<h3>Description</h3>

<p>If only care about the higher subgroup (above cutoff), only need trt.est.high so set <code>onlyhigh</code> to be TRUE
Scores are adjusted to the opposite sign if <code>higher.y</code> == FALSE; scores stay the same if <code>higher.y</code> == TRUE;
this is because estcount.bilevel.subgroups() always takes the subgroup of the top highest adjusted scores,
and higher adjusted scores should always represent high responders of trt=1
</p>


<h3>Usage</h3>

<pre><code class="language-R">estcount.bilevel.subgroups(
  y,
  x.cate,
  x.ps,
  time,
  trt,
  score,
  higher.y,
  prop,
  onlyhigh,
  ps.method = "glm",
  minPS = 0.01,
  maxPS = 0.99
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>y</code></td>
<td>
<p>Observed outcome; vector of size <code>n</code> (observations)</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>x.cate</code></td>
<td>
<p>Matrix of <code>p.cate</code> baseline covariates; dimension <code>n</code> by <code>p.cate</code> (covariates in the outcome model)</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>x.ps</code></td>
<td>
<p>Matrix of <code>p.ps</code> baseline covariates (plus a leading column of 1 for the intercept);
dimension <code>n</code> by <code>p.ps + 1</code> (covariates in the propensity score model plus intercept)</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>time</code></td>
<td>
<p>Log-transformed person-years of follow-up; vector of size <code>n</code></p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>trt</code></td>
<td>
<p>Treatment received; vector of size <code>n</code> units with treatment coded as 0/1</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>score</code></td>
<td>
<p>Estimated log CATE scores for all <code>n</code> observations from one of the four methods
(boosting, naive Poisson, two regressions, contrast regression); vector of size <code>n</code></p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>higher.y</code></td>
<td>
<p>A logical value indicating whether higher (<code>TRUE</code>) or lower (<code>FALSE</code>)
values of the outcome are more desirable. Default is <code>TRUE</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>prop</code></td>
<td>
<p>Proportions corresponding to percentiles in the estimated log CATE scores that define subgroups to calculate ATE for;
vector of floats in '(0, 1]' (if onlyhigh=T) or in '(0, 1)' (if onlyhigh=F):
Each element of <code>prop</code> represents the high/low cutoff in each bi-level subgroup and the length of <code>prop</code>
is number of bi-level subgroups</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>onlyhigh</code></td>
<td>
<p>Indicator of returning only the ATEs in the higher-than-cutoff category of the bi-level subgroups; boolean</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>ps.method</code></td>
<td>
<p>A character value for the method to estimate the propensity score. Allowed values include one of:
<code>'glm'</code> for logistic regression with main effects only (default), or
<code>'lasso'</code> for a logistic regression with main effects and LASSO penalization on
two-way interactions (added to the model if interactions are not specified in <code>ps.model</code>).
Relevant only when <code>ps.model</code> has more than one variable.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>minPS</code></td>
<td>
<p>A numerical value (in '[0, 1]') below which estimated propensity scores should be
truncated. Default is <code>0.01</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>maxPS</code></td>
<td>
<p>A numerical value (in '(0, 1]') above which estimated propensity scores should be
truncated. Must be strictly greater than <code>minPS</code>. Default is <code>0.99</code>.</p>
</td>
</tr>
</table>
<h3>Value</h3>

<p>ate.est.high: estimated ATEs in the multiple bi-level subgroups that are in the higher-than-cutoff category;
vector of size equal to the length of prop; always returned
ate.est.low: estimated ATEs in the multiple bi-level subgroups that are in the lower-than-cutoff category;
vector of size equal to the length of prop; returned only when <code>onlyhigh</code> == TRUE
</p>


</div>