<div class="container">

<table style="width: 100%;"><tr>
<td>puni_star</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>p-uniform*</h2>

<h3>Description</h3>

<p>Function to apply the p-uniform* method for one-sample mean, two-independent means,
and one raw correlation coefficient as described in van Aert and van Assen (2023).
</p>


<h3>Usage</h3>

<pre><code class="language-R">puni_star(
  mi,
  ri,
  ni,
  sdi,
  m1i,
  m2i,
  n1i,
  n2i,
  sd1i,
  sd2i,
  tobs,
  yi,
  vi,
  alpha = 0.05,
  side,
  method = "ML",
  boot = FALSE,
  control
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>mi</code></td>
<td>
<p>A vector of group means for one-sample means</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>ri</code></td>
<td>
<p>A vector of raw correlations</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>ni</code></td>
<td>
<p>A vector of sample sizes for one-sample means and correlations</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>sdi</code></td>
<td>
<p>A vector of standard deviations for one-sample means</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>m1i</code></td>
<td>
<p>A vector of means in group 1 for two-independent means</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>m2i</code></td>
<td>
<p>A vector of means in group 2 for two-independent means</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>n1i</code></td>
<td>
<p>A vector of sample sizes in group 1 for two-independent means</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>n2i</code></td>
<td>
<p>A vector of sample sizes in group 2 for two-independent means</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>sd1i</code></td>
<td>
<p>A vector of standard deviations in group 1 for two-independent means</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>sd2i</code></td>
<td>
<p>A vector of standard deviations in group 2 for two-independent means</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>tobs</code></td>
<td>
<p>A vector of t-values</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>yi</code></td>
<td>
<p>A vector of standardized effect sizes (see Details)</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>vi</code></td>
<td>
<p>A vector of sampling variances belonging to the standardized effect
sizes (see Details)</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>alpha</code></td>
<td>
<p>A numerical value specifying the alpha level as used in primary studies
(default is 0.05 but see Details).</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>side</code></td>
<td>
<p>A character indicating whether the effect sizes in the primary studies
are in the right-tail of the distribution (i.e., positive)  or in the left-tail
of the distribution (i.e., negative) (either <code>"right"</code> or <code>"left"</code>)</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>method</code></td>
<td>
<p>A character indicating the method to be used <code>"ML"</code> (default),
<code>"P"</code>, or <code>"LNP"</code></p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>boot</code></td>
<td>
<p>A logical indicating whether the p-value of testing whether the 
between-study variance is zero for methods <code>P</code> and <code>LNP</code> should be 
obtained by means of a parametric bootstrap. The default value is FALSE.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>control</code></td>
<td>
<p>An optional list of elements that give the user more control 
over the optimization and root-finding algorithms (see Note)</p>
</td>
</tr>
</table>
<h3>Details</h3>

<p>Three different effect size measures can be used as input for the <code>puni_star</code>
function: one-sample means, two-independent means, and raw correlation coefficients.
Analyzing one-sample means and two-independent means can be done by either providing
the function group means (<code>mi</code> or <code>m1i</code> and <code>m2i</code>), standard deviations
(<code>sdi</code> or <code>sd1i</code> and <code>sd2i</code>), and sample sizes (<code>ni</code> or
<code>n1i</code> and <code>n2i</code>) or t-values (<code>tobs</code>) and sample sizes (<code>ni</code>
or <code>n1i</code> and <code>n2i</code>). Both options should be accompanied with input
for the arguments <code>side</code>, <code>method</code>, and <code>alpha</code>. See the Example section for
examples. Raw correlation coefficients can be analyzed by supplying the raw
correlation coefficients <code>ri</code> and sample sizes and <code>ni</code> to the 
<code>puni_star</code> function next to input for the arguments <code>side</code>, 
<code>method</code>, and <code>alpha</code>. Note that the method internally transforms the 
raw correlation coefficients to Fisher's z correlation coefficients. The output
of the function also shows the results for the Fisher's z correlation coefficient. 
Hence, the results need to be transformed to raw correlation coefficients if 
this is preferred by the user.
</p>
<p>It is also possible to specify the standardized effect sizes and its sampling
variances directly via the <code>yi</code> and <code>vi</code> arguments. However, extensive
knowledge about computing standardized effect sizes and its sampling variances
is required and specifying standardized effect sizes and sampling variances is
not recommended to be used if the p-values in the primary studies are not computed
with a z-test. In case the p-values in the primary studies were computed with,
for instance, a t-test, the p-values of a z-test and t-test do not exactly
coincide and studies may be incorrectly included as a statistically significant or 
nonsignificant effect size. Furthermore, critical values in the primary studies 
are not transformed to critical z-values if <code>yi</code> and <code>vi</code> are used 
as input. This yields less accurate results.
</p>
<p>The <code>puni_star</code> function assumes that two-tailed hypothesis tests were conducted
in the primary studies. In case one-tailed hypothesis tests were conducted in 
the primary studies, the submitted <code>alpha</code> argument to the <code>puni_star</code> 
function has to be multiplied by two. For example, if one-tailed hypothesis tests were 
conducted with an alpha level of .05, an alpha of 0.1 has to be submitted to 
the <code>puni_star</code> function.
</p>
<p>Note that only one effect size measure can be specified at a time. A combination
of effect size measures usually causes true heterogeneity among effect sizes and
including different effect size measures is therefore not recommended.
</p>
<p><b>Selecting a method</b>
</p>
<p>Three different methods are currently implemented in the <code>puni_star</code> function. 
The <code>ML</code> method refers to maximum likelihood estimation of the effect size 
and the between-study variance. Profile likelihood confidence intervals around 
the estimates are computed by means of inverting the likelihood-ratio test. 
Likelihood-ratio tests are used for testing the null hypotheses of no effect 
and no between-study variance. The <code>ML</code> method is the recommended method 
for applying p-uniform*. 
</p>
<p>The two other methods (<code>P</code> and <code>LNP</code>) are moment based estimators. 
The method <code>P</code> is based on the distribution of the sum of independent 
uniformly distributed random variables (Irwin-Hall distribution) and the 
<code>LNP</code> method refers to Fisher's method (1950, Chapter 4). For these methods, 
a p-value for testing the null hypothesis of no between-study variance can also be 
obtained by means of a parametric bootstrap. This is necessary since the data 
is otherwise first used for estimating the effect size in the procedure for testing 
the null hypothesis of no between-study variance and then also used for computing 
a p-value. The test of no effect is not available for the methods <code>P</code> and <code>LNP</code> 
and the publication bias test for these methods is not yet implemented.
</p>


<h3>Value</h3>

<table>
<tr style="vertical-align: top;">
<td><code>est</code></td>
<td>
<p>p-uniform*'s effect size estimate</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>ci.lb</code></td>
<td>
<p>lower bound of p-uniform*'s 95% confidence interval of the effect size</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>ci.ub</code></td>
<td>
<p>upper bound of p-uniform*'s 95% confidence interval of the effect size</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>L.0</code></td>
<td>
<p>test statistic of p-uniform*'s test of the null hypothesis of no effect</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>pval.0</code></td>
<td>
<p>one-tailed p-value of p-uniform*'s test of null hypothesis of no effect</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>tau2</code></td>
<td>
<p>p-uniform*'s estimate of the between-study variance</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>tau2.lb</code></td>
<td>
<p>lower bound of p-uniform*'s 95% confidence interval of the 
between-study variance</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>tau2.ub</code></td>
<td>
<p>upper bound of p-uniform*'s 95% confidence interval of the 
between-study variance</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>L.het</code></td>
<td>
<p>test statistic of p-uniform*'s test of the null hypothesis of no 
between-study variance</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>pval.het</code></td>
<td>
<p>one-tailed p-value of p-uniform*'s test of null hypothesis of 
no between-study variance</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>pval.boot</code></td>
<td>
<p>one-tailed p-value of p-uniform*'s test of null hypothesis 
of no between-study variance obtained with a parametric bootstrap</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>...</code></td>
<td>
<p>a number of additional elements</p>
</td>
</tr>
</table>
<h3>Note</h3>

<p>The <code>control</code> argument in the <code>puni_star</code> function is an optional 
argument that gives the user more control over the optimization and root-finding 
algorithms. This can be especially useful if estimation of the method does not 
converge and NAs are returned by the function. The <code>control</code> argument should 
be specified as a list containing one or more elements. For example, 
<code>control = list(verbose = TRUE)</code> Default values are used if an element is 
not specified. The following elements can be specified by the user:
</p>

<ul>
<li>
<p><code>proc.ml:</code> A character indicating with optimization procedure should 
be used for the method <code>ML</code>. The initial implementation of p-uniform* iteratively
optimized the profile log-likelihood functions. As of version 0.2.6 of this 
package, the default optimization routine estimates both parameters at the 
same time. The old optimization procedure can be used by specifying <code>proc.ml = "prof"</code>.
</p>
</li>
<li>
<p><code>stval.d:</code> An integer that is the starting value of the effect 
size for estimation. This starting value is used for the method <code>ML</code> and 
is only needed when both parameters are estimated at the same time. See argument 
<code>proc.ml</code> for more information. The default value is the mean of the effect
sizes in the meta-analysis.
</p>
</li>
<li>
<p><code>stval.tau:</code> An integer that is the starting value of tau for estimation.
This starting value is used for the methods <code>ML</code>, <code>P</code>, and <code>LNP</code>. 
The default value is the standard deviation of the effect sizes in the meta-analysis.
</p>
</li>
<li>
<p><code>int:</code> A vector of length two that indicates the lower and upper 
bound of the interval that is used for estimating the effect size. The effect 
size estimate should be included in this interval. This interval is used for the 
methods <code>ML</code>, <code>P</code>, and <code>LNP</code> and its default values are (-2, 2).
</p>
</li>
<li>
<p><code>bounds.int</code> A vector of length two that is used for determining the 
bounds for estimating the effect size with <code>P</code> and <code>LNP</code>. The default 
values are a function of the <code>yi</code>. The lower bound is the minimum <code>yi</code> 
minus 1 and the upper bound is the maximum <code>yi</code> plus 1. The effect size 
has to be between the lower and upper bound.
</p>
</li>
<li>
<p><code>tau.int:</code> A vector of length two that indicates the lower and upper 
bound of the interval that is used for estimating the between-study variance. 
The estimate of the between-study variance should be included in this interval. 
This interval is used for the methods <code>ML</code>, <code>P</code>, and <code>LNP</code> 
and its default values are (0, 2).
</p>
</li>
<li>
<p><code>est.ci:</code> A vector of length two indicating the values that are 
subtracted from and added to the estimate of the effect size for computing the 
95% confidence intervals. This vector is used for the methods <code>ML</code>, 
<code>P</code>, and <code>LNP</code> and its default values are (3, 3). To give an example, 
estimates for the lower and upper bound around the effect size estimate are 
searched on the interval (est-3, est) and (est, est+3), respectively.
</p>
</li>
<li>
<p><code>tau.ci:</code> A vector of length two indicating the values that are 
added to the estimate of the between-study variance for computing the 95% confidence 
intervals. This vector is used for the methods <code>ML</code>, <code>P</code>, and <code>LNP</code> 
and its default values are (3, 1).
</p>
</li>
<li>
<p><code>tol:</code> A number indicating the desired accuracy of the estimates. 
This number is used for the methods <code>ML</code>, <code>P</code>, and <code>LNP</code> and its 
default value is 0.001. 
</p>
</li>
<li>
<p><code>maxit:</code> An integer indicating the maximum number of iterations 
that is used for estimating the effect size and between-study variance. This 
number is used for the methods <code>ML</code>, <code>P</code>, and <code>LNP</code> and its default 
value is 300.
</p>
</li>
<li>
<p><code>fnscale:</code> An integer that can be used for scaling the log-likelihood
value in the optimization. <code>fnscale</code> is one of the control arguments of 
the <code>optim()</code> function that is internally used for optimization when the 
<code>ML</code> method is used and both parameters are estimated at the same time. 
See the argument <code>proc.ml</code> above #' and the documentation of the <code>optim()</code> 
function for more information. 
</p>
</li>
<li>
<p><code>verbose:</code> A logical indicating whether information should be printed 
about the algorithm for estimating the effect size and between-study variance. 
This logical is used for the methods <code>ML</code>, <code>P</code>, and <code>LNP</code> and 
its default value is FALSE.
</p>
</li>
<li>
<p><code>reps:</code> An integer indicating the number of bootstrap replications
for computing the bootstrapped p-value for the test of no between-study variance.
This integer is used for the methods <code>P</code> and <code>LNP</code> and its default value 
is 1000.
</p>
</li>
</ul>
<h3>Author(s)</h3>

<p>Robbie C.M. van Aert <a href="mailto:R.C.M.vanAert@tilburguniversity.edu">R.C.M.vanAert@tilburguniversity.edu</a>
</p>


<h3>References</h3>

<p>Fisher, R.A. (1950). Statistical methods for research workers (11th ed.).
London: Oliver &amp; Boyd.
</p>
<p>van Aert, R.C.M., &amp; van Assen, M.A.L.M. (2023). Correcting for 
publication bias in a meta-analysis with the p-uniform* method. Manuscript submitted  
for publication. Preprint: https://osf.io/preprints/bitss/zqjr9/
</p>


<h3>Examples</h3>

<pre><code class="language-R">### Generate data for one-sample mean with mu = 0.2 and tau^2 = 0.01
set.seed(123)
ni &lt;- rep(50, 25)
sdi &lt;- rep(1, 25)
ui &lt;- rnorm(25, mean = 0.2, sd = 0.1)
mi &lt;- rnorm(25, mean = ui, sd = sdi/sqrt(ni))
tobs &lt;- mi/(sdi/sqrt(ni))

### Apply p-uniform* method using sample means
puni_star(mi = mi, ni = ni, sdi = sdi, alpha = 0.05, side = "right", method = "ML")

### Apply p-uniform* method using t-values
puni_star(tobs = tobs, ni = ni, alpha = 0.05, side = "right", method = "ML")

</code></pre>


</div>