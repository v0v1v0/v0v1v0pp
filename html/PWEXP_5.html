<div class="container">

<table style="width: 100%;"><tr>
<td>cv.pwexp.fit</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>Cross Validate a Piecewise Exponential Model</h2>

<h3>Description</h3>

<p>Cross Validate a existing piecewise exponential model.
</p>


<h3>Usage</h3>

<pre><code class="language-R">## Default S3 method:
cv.pwexp.fit(time, event, nfold=5, nsim=100, breakpoint=NULL,
             nbreak=0, exclude_int=NULL, min_pt_tail=5, max_set=1000, seed=1818,
             optimizer='mle', tol=1e-4, parallel=FALSE, mc.core=4, ...)
## S3 method for class 'pwexp.fit'
cv.pwexp.fit(time, nfold=5, nsim=100, max_set=1000, seed=1818,
             optimizer='mle', tol=1e-4, parallel=FALSE, mc.core=4, ...)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>time</code></td>
<td>
<p>observed time from randomization or a <code>pwexp.fit</code> object.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>event</code></td>
<td>
<p>the status indicator.  See <code>pwexp.fit</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>nfold</code></td>
<td>
<p>the number of folds used in CV.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>nsim</code></td>
<td>
<p>the number of simulations.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>breakpoint</code></td>
<td>
<p>pre-specified breakpoints. See <code>pwexp.fit</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>nbreak</code></td>
<td>
<p>total number of breakpoints.  See <code>pwexp.fit</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>exclude_int</code></td>
<td>
<p>an interval that excludes any estimated breakpoints.  See <code>pwexp.fit</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>min_pt_tail</code></td>
<td>
<p>the minimum number of events used for estimating the tail (the hazard rate of the last piece).  See <code>pwexp.fit</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>max_set</code></td>
<td>
<p>maximum estimated combination of breakpoints.  See <code>pwexp.fit</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>seed</code></td>
<td>
<p>a random seed.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>optimizer</code></td>
<td>
<p>one of the optimizers: <code>mle</code>, <code>ols</code>, or <code>hybrid</code>. See <code>pwexp.fit</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>tol</code></td>
<td>
<p>the minimum allowed gap between two breakpoints. The gap is calculated as <code>(max(time)-min(time))*tol</code>. Keep it as default in most cases. </p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>parallel</code></td>
<td>
<p>logical. If <code>TRUE</code>, use <span class="pkg">doSNOW</span> package to run in parallel.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>mc.core</code></td>
<td>
<p>number of processes allowed to be run in parallel.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>...</code></td>
<td>
<p>internal function reserved. </p>
</td>
</tr>
</table>
<h3>Details</h3>

<p>Use cross validation obtain the prediction log likelihood.
</p>


<h3>Value</h3>

<p>A vector of length <code>nsim</code> containing the CV log likelihood in each round of simulation.
</p>


<h3>Author(s)</h3>

<p>Tianchen Xu <a href="mailto:zjph602xutianchen@gmail.com">zjph602xutianchen@gmail.com</a>
</p>


<h3>See Also</h3>

<p><code>pwexp.fit</code></p>


<h3>Examples</h3>

<pre><code class="language-R">event_dist &lt;- function(n)rpwexp(n, rate = c(0.1, 0.01, 0.2), breakpoint =  c(5,14))
dat &lt;- simdata(rand_rate = 20, drop_rate = 0.03,  total_sample = 1000,
               advanced_dist = list(event_dist=event_dist),
               add_column = c('censor_reason','event','followT','followT_abs'))

# here nsim=10 is for demo purpose, pls increase it in practice!!

cv0 &lt;- cv.pwexp.fit(dat$followT, dat$event, nsim = 10, nbreak = 0)
cv1 &lt;- cv.pwexp.fit(dat$followT, dat$event, nsim = 10, nbreak = 1)
cv2 &lt;- cv.pwexp.fit(dat$followT, dat$event, nsim = 10, nbreak = 2)
sapply(list(cv0,cv1,cv2), median)

</code></pre>


</div>