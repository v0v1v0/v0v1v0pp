<div class="container">

<table style="width: 100%;"><tr>
<td>calc.multicoef</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>Calculation of warping coefficients when applying more than one
warping function successively</h2>

<h3>Description</h3>

<p>Applying two (or more) warping function after each other
can be described with one warping function of a higher warping
degree. This function provides the coefficients of this higher degree
warping function.</p>


<h3>Usage</h3>

<pre><code class="language-R">calc.multicoef(coef1, coef2)</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>coef1</code></td>
<td>
<p>vector containing the warping coefficients of the first
applied warping function</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>coef2</code></td>
<td>
<p>vector containing the warping coefficients of the second
applied warping function</p>
</td>
</tr>
</table>
<h3>Details</h3>

<p>This function uses Pascal's simplex to calculate the new
warping coefficients. 
</p>
<p>When applying three warping functions successively (first a, then b and
finally c - here a, b and c are vectors of warping coefficients), first
calculate the new coefficients for b and c, and afterwards the
coefficients for a with these new coefficients. So the coefficients for
the total warping function can be calculated via <code>calc.multicoef(a,
  calc.multicoef(b, c))</code>. 
</p>


<h3>Value</h3>

<p>a vector containing the corrected warping coefficients</p>


<h3>Author(s)</h3>

<p>Jan Gerretzen</p>


<h3>References</h3>

<p>Bloemberg, T.G., et al. (2010) "Improved parametric time warping for Proteomics", Chemometrics and Intelligent Laboratory Systems, <b>104</b> (1), 65 â€“ 74.
</p>


<h3>See Also</h3>

<p><code>calc.zerocoef</code>
</p>


<h3>Examples</h3>

<pre><code class="language-R">data(gaschrom)
ref &lt;- gaschrom[1,]
samp &lt;- gaschrom[16,]
coef1 &lt;- c(100,1.1, 1e-5)
coef2 &lt;- c(25, 0.95, 3.2e-5)
gaschrom.ptw &lt;- ptw(ref, samp, init.coef = coef1, try = TRUE)
ref.w &lt;- gaschrom.ptw$reference
samp.w &lt;- gaschrom.ptw$warped.sample
samp.w[is.na(samp.w)] &lt;- 0
gaschrom.ptw2 &lt;- ptw(ref.w, samp.w, init.coef = coef2, try = TRUE)
plot(c(gaschrom.ptw2$warped.sample), type = "l")

corr.coef &lt;- calc.multicoef(coef1, coef2)
gaschrom.ptw3 &lt;- ptw(ref, samp, init.coef = corr.coef, try = TRUE)
lines(c(gaschrom.ptw3$warped.sample), col = 2, lty = 2)
</code></pre>


</div>