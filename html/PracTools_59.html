<div class="container">

<table style="width: 100%;"><tr>
<td>wtd.moments</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>
Compute moments of a variable from either a population or sample
</h2>

<h3>Description</h3>

<p>Compute the 2nd, 3rd, 4th moments, skewness, and kurtosis of a variable from either population or sample input
</p>


<h3>Usage</h3>

<pre><code class="language-R">wtd.moments(y, w=NULL, pop.sw=TRUE)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>y</code></td>
<td>
<p>variable to be analyzed</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>w</code></td>
<td>
<p>vector of weights if the input is a sample</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>pop.sw</code></td>
<td>
<p>is the input for a population (<code>pop.sw=TRUE</code>) or for a sample (<code>pop.sw=FALSE</code>)?</p>
</td>
</tr>
</table>
<h3>Details</h3>

<p>The <code class="reqn">r^{th}</code> population moment is defined as <code class="reqn">m_r = (1/N) \sum_{k \in U} (y_k - \bar{y}_U)^r</code> where <em>U</em> is the set of population units, <em>N</em> is the population size, and <code class="reqn">\bar{y}_U</code> is the population mean. When the input is for the whole population, <code>wtd.moments</code> evaluates this directly for <code class="reqn">r=2, 3, 4</code>. When the input is for a sample, the <code class="reqn">r^{th}</code> moment is estimated as <code class="reqn">\hat{m}_r = (K/\hat{N}) \sum_{k \in s} ( w_k (y_k - \hat{\bar{y}}_U)^r ), r=2, 3, 4</code> where <code class="reqn">s</code> is the set of sample units, <code class="reqn">w_k</code> is the weight for sample unit <code class="reqn">k</code>, <code class="reqn">\hat{N} = \sum_s w_k</code>, and <code class="reqn">\hat{\bar{y}}_U = \sum_{k \in s} w_k y_k / \hat{N}</code>. When <code class="reqn">r=2</code>, <code class="reqn">K=n/(n-1)</code> so that the estimator equals the unbiased variance estimator if the sample is a simple random sample; if <code class="reqn">r=3,4</code>, then <code class="reqn">K=1</code>. The function also computes or estimates the population skewness, defined as <code class="reqn">m_3/m_2^{3/2}</code> and the population kurtosis, <code class="reqn">m_4/m_2^2</code>.
</p>
<p>The weights should be scaled for estimating population totals. The sample can be obtained from any complex design.
</p>


<h3>Value</h3>

<p>Vector with values:
</p>
<table>
<tr style="vertical-align: top;">
<td><code>m2</code></td>
<td>
<p>2nd moment</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>m3</code></td>
<td>
<p>3rd moment</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>m4</code></td>
<td>
<p>4th moment</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>skewness</code></td>
<td>
<p>skewness</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>kurtosis</code></td>
<td>
<p>kurtosis</p>
</td>
</tr>
</table>
<h3>Author(s)</h3>

<p>Richard Valliant, Jill A. Dever, Frauke Kreuter
</p>


<h3>References</h3>

<p>Valliant, R., Dever, J., Kreuter, F. (2018, sect. 3.4).  <em>Practical Tools for Designing and Weighting Survey Samples, 2nd edition</em>. New York: Springer.
</p>


<h3>See Also</h3>

<p><code>wtdvar</code>
</p>


<h3>Examples</h3>

<pre><code class="language-R">require(PracTools)
wtd.moments(y = hospital$y, w = NULL)
require(sampling)
sam &lt;- strata(data = labor, stratanames = "h", size = c(30, 20, 10), method = c("srswor"),
              description=TRUE)
samdat &lt;- labor[sam$ID_unit,]
wtd.moments(y = samdat$WklyWage, w = 1/sam$Prob, pop.sw=FALSE)
</code></pre>


</div>