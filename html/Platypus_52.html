<div class="container">

<table style="width: 100%;"><tr>
<td>VDJ_plot_SHM</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>Plotting of somatic hypermutation counts</h2>

<h3>Description</h3>

<p>Plots for SHM based on MIXCR output generated using the VDJ_call_MIXCR function and appended to the VDJ.GEX.matrix.output
</p>


<h3>Usage</h3>

<pre><code class="language-R">VDJ_plot_SHM(
  VDJ.mixcr.matrix,
  group.by,
  quantile.label,
  point.size,
  mean.line.color,
  stats.to.console,
  platypus.version
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>VDJ.mixcr.matrix</code></td>
<td>
<p>Output dataframe from the VDJ_call_MIXCR function or a dataframe generated using the VDJ_GEX_matrix function and supplemented with MIXCR information</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>group.by</code></td>
<td>
<p>Character. Defaults to "sample_id". Column name of VDJ.matrix to split VDJ.matrix by. For each unique entry in that column a set of plots will be generated. This can be useful to plot SHM by expansion or by transcriptomics-derived clusters</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>quantile.label</code></td>
<td>
<p>Numeric. Defaults to 0.9. Which points to label in the SHM scatterplot. If set to 0.9, the top 10% of cells by SHM number will be labelled. If ggrepel throws a warning, concerning overlap it is recommended to attempt to lable less points to avoid cluttering</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>point.size</code></td>
<td>
<p>Size of points in plots. Passed to geom_jitter()</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>mean.line.color</code></td>
<td>
<p>Color of mean bar in dotplots. Passed to geom_errorbar()</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>stats.to.console</code></td>
<td>
<p>Boolean. Defaults to FALSE. Prints basic statistics (AOV \+ post hoc test) to console</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>platypus.version</code></td>
<td>
<p>Character. Only "v3" available.</p>
</td>
</tr>
</table>
<h3>Value</h3>

<p>Returns a list of ggplot objects. out\[\[1\]\] is a boxplot comparing SHM by group.by. out\[\[2\]\] to out\[\[n\]\] are plots for each group that visualize VDJ and VJ SHM distribution for each group. Data for any plot can be accessed via out \[\[any\]\]$data
</p>


<h3>Examples</h3>

<pre><code class="language-R">small_vgm &lt;- Platypus::small_vgm
small_vgm[[1]]$VDJ_SHM &lt;- as.integer(rnorm(nrow(small_vgm[[1]]), mean = 5, sd = 3))
small_vgm[[1]]$VJ_SHM &lt;- as.integer(rnorm(nrow(small_vgm[[1]]), mean = 5, sd = 3))

SHM_plots &lt;- VDJ_plot_SHM(VDJ = small_vgm[[1]]
, group.by = "sample_id", quantile.label = 0.9)

SHM_plots &lt;- VDJ_plot_SHM(VDJ = small_vgm[[1]]
, group.by = "seurat_clusters", quantile.label = 0.99)

</code></pre>


</div>