<div class="container">

<table style="width: 100%;"><tr>
<td>plot.matrix</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>plot.matrix</h2>

<h3>Description</h3>

<p>Visualizes a matrix with a colored heatmap and optionally a color key. It distinguishes between numeric and non-numeric matrices.
You may need to modify <code>mar</code> with the <code>graphics::par()</code> command from its default <code>c(5.1,4.1,4.1,2.1)</code>.
For further see the vignette <code>vignette('plot.matrix')</code>
</p>


<h3>Usage</h3>

<pre><code class="language-R">## S3 method for class 'matrix'
plot(
  x,
  y = NULL,
  breaks = NULL,
  col = heat.colors,
  na.col = "white",
  na.cell = TRUE,
  na.print = TRUE,
  digits = NA,
  fmt.cell = NULL,
  fmt.key = NULL,
  spacing.key = c(1, 0.5, 0),
  polygon.cell = NULL,
  polygon.key = NULL,
  text.cell = NULL,
  key = list(side = 4, las = 1),
  axis.col = list(side = 1),
  axis.row = list(side = 2),
  axis.key = NULL,
  max.col = 70,
  ...
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>x</code></td>
<td>
<p>matrix</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>y</code></td>
<td>
<p>unused</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>breaks</code></td>
<td>
<p>breaks for numeric values or values for <code>col</code></p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>col</code></td>
<td>
<p>a vector of colors or a function, e.g. grDevices::heat.colors()] with one parameter <code>n</code></p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>na.col</code></td>
<td>
<p>color for missing value (default: white)</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>na.cell</code></td>
<td>
<p>to draw cells with missing values (default: <code>TRUE</code>)</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>na.print</code></td>
<td>
<p>print NA (or any given characters) when values are missing. If <code>FALSE</code>, nothing is printed. If <code>na.cell</code> is <code>FALSE</code>, this will have no effect.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>digits</code></td>
<td>
<p>number of digits for numeric data or length of string for non-numeric data</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>fmt.cell</code></td>
<td>
<p>format string for writing matrix entries, overwrites <code>digits</code>, defaults to <code>NULL</code></p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>fmt.key</code></td>
<td>
<p>format string for writing key entries, overwrites <code>digits</code>, defaults to <code>fmt</code></p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>spacing.key</code></td>
<td>
<p>spacing between plot and legend, key width, spacing between key and axis  (default: <code>c(1,0.5,0)</code>)</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>polygon.cell</code></td>
<td>
<p>list of parameters used for <code>graphics::polygon()</code> for heatmap</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>polygon.key</code></td>
<td>
<p>list of parameters used for <code>graphics::polygon()</code> for key</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>text.cell</code></td>
<td>
<p>list of parameters used for <code>graphics::text()</code> for matrix entries</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>key</code></td>
<td>
<p>list of parameters used for [graphics::axis(). If set to <code>NULL</code> then no information will be plotted. Instead of <code>key=list(side=4)</code> you may use <code>key=4</code> or <code>key="right"</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>axis.col</code></td>
<td>
<p>list of parameters used for <code>graphics::axis()</code> for axis of matrix columns. Instead of <code>axis.col=list(side=1)</code> you may use <code>axis.col=1</code> or <code>axis.col="bottom"</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>axis.row</code></td>
<td>
<p>list of parameters used for <code>graphics::axis()</code> for axis of matrix rows. Instead of <code>axis.row=list(side=2)</code> you may use <code>axis.row=2</code> or <code>axis.col="left"</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>axis.key</code></td>
<td>
<p>as <code>key</code></p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>max.col</code></td>
<td>
<p>numeric: if the distance between the text color and the cell color is smaller then <code>max.col</code> then either <code>white</code> or <code>black</code> will be used as text color, defaults to <code>70</code></p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>...</code></td>
<td>
<p>further parameter given to the <code>graphics::plot()</code> command</p>
</td>
</tr>
</table>
<h3>Details</h3>

<p>A color key is drawn if either <code>key</code> (defaults to <code>list(cex=1)</code>) or <code>fmt.key</code>
(defaults to <code>NULL</code>) is not <code>NULL</code>.
</p>
<p>If you want to plot the matrix entries you must set either <code>digits</code> or <code>fmt</code>.
For a non-numeric matrix <code>digits</code> gives the length of the string printed, a negative value
results in right-justified string. For a numeric matrix <code>digits</code> determines the number of
decimal places,  a negative value uses a "exponential" decimal notation. You may set format
strings <code>fmt</code> and <code>fmt.key</code> directly. Settings <code>digits</code> leads to the following
format strings (<code>n</code> the absolute value of <code>digits</code>):
</p>

<table>
<tr>
<td style="text-align: left;">
<code>x</code> numeric and <code>digits&gt;0</code>:</td>
<td style="text-align: left;"> <code>"%+.nf"</code>
</td>
</tr>
<tr>
<td style="text-align: left;">
<code>x</code> numeric and <code>digits&lt;0</code>:</td>
<td style="text-align: left;"> <code>"%+.ne"</code>
</td>
</tr>
<tr>
<td style="text-align: left;">
<code>x</code> non-numeric and <code>digits&gt;0</code>:</td>
<td style="text-align: left;"> <code>"%+ns"</code>
</td>
</tr>
<tr>
<td style="text-align: left;">
<code>x</code> non-numeric and <code>digits&lt;0</code>:</td>
<td style="text-align: left;"> <code>"%-ns"</code>
</td>
</tr>
<tr>
<td style="text-align: left;">
</td>
</tr>
</table>
<p>If no colors are given then the <code>grDevices::heat.colors()</code> will be used. Alternatively you may specify your own color function
that delivers a vector with <code>n</code> colors if called by <code>col(n)</code>. The final colors and breaks used
depend if <code>plot.matrix</code> gets a numeric or non-numeric matrix.
</p>
<p><strong>Numeric matrix:</strong> In general it must hold <code>length(col)+1==length(breaks)</code>.
</p>

<dl>
<dt>1. <code>breaks==NULL</code> and <code>col==NULL</code>
</dt>
<dd>
<p>The colors are taken from <code>heat.colors(10)</code> and the eleven breaks are calculated as an equidistant grid
between <code>min(x)</code> and <code>max(x)</code>.</p>
</dd>
<dt>2. <code>breaks==NULL</code> and <code>col</code> is a color function</dt>
<dd>
<p>Ten colors are taken from the color function and eleven breaks are calculated as an equidistant grid
between <code>min(x)</code> and <code>max(x)</code>.</p>
</dd>
<dt>3. <code>breaks==NULL</code> and <code>col</code> is a vector of colors</dt>
<dd>
<p>The <code>length(col)+1</code> breaks are calculated as an equidistant grid
between <code>min(x)</code> and <code>max(x)</code>.</p>
</dd>
<dt>4. <code>breaks</code> are given and <code>col==NULL</code>
</dt>
<dd>
<p>The colors are taken from <code>heat.colors(length(breaks)-1)</code>.</p>
</dd>
<dt>5. <code>breaks</code> are given and <code>col</code> is a color function</dt>
<dd>
<p>The <code>length(breaks)-1</code> colors are taken from the color function.</p>
</dd>
<dt>6. <code>breaks</code> are given and <code>col</code> is a vector of colors</dt>
<dd>
<p>If not <code>length(col)+1==length(breaks)</code> holds then
the <code>length(col)+1</code> breaks are calculated as an equidistant grid between <code>min(breaks)</code> and <code>max(breaks)</code>.</p>
</dd>
</dl>
<p><strong>Non-numeric matrix:</strong> In general it must hold <code>length(col)==length(breaks)</code>. At first the number of unique elements in <code>x</code> is determined: <code>nu</code>.
</p>

<dl>
<dt>1. <code>breaks==NULL</code> and <code>col==NULL</code>
</dt>
<dd>
<p>The colors are taken from <code>heat.colors(nu)</code> and the breaks are set to the unique elements of <code>x</code>.</p>
</dd>
<dt>2. <code>breaks==NULL</code> and <code>col</code> is a color function</dt>
<dd>
<p>The <code>nu</code> colors are taken from color function and the breaks are set to the unique elements of <code>x</code>.</p>
</dd>
<dt>3. <code>breaks==NULL</code> and <code>col</code> is a vector of colors</dt>
<dd>
<p>The <code>length(col)</code> breaks are calculated as an equidistant grid
between <code>min(x)</code> and <code>max(x)</code>.</p>
</dd>
<dt>4. <code>breaks</code> are given and <code>color==NULL</code>
</dt>
<dd>
<p>The colors are taken from <code>heat.colors(length(breaks))</code>.</p>
</dd>
<dt>5. <code>breaks</code> are given and <code>color</code> is a color function</dt>
<dd>
<p>The <code>length(breaks)</code> colors are taken from color function.</p>
</dd>
<dt>6. <code>breaks</code> are given and <code>color</code> is a vector of colors</dt>
<dd>
<p>If not <code>length(colors)==length(breaks)</code> holds then
either <code>breaks</code> or <code>color</code> is shorten to the shorter of both.</p>
</dd>
</dl>
<p>If the difference between polygon color and the text color is smaller <code>max.col</code> then as text color is
either <code>white</code> or <code>black</code> (depending which one is further away from the polygon color).
The distance is computed as <code class="reqn">\Delta C/3</code> as in <a href="https://en.wikipedia.org/wiki/Color_difference#Euclidean">https://en.wikipedia.org/wiki/Color_difference#Euclidean</a> given.
</p>


<h3>Value</h3>

<p>invisibly a list with elements
</p>

<dl>
<dt><code>cell.polygon[[i,j]]</code></dt>
<dd>
<p>the <code>polygon</code> parameters used to draw the elements of the matrix</p>
</dd>
<dt><code>cell.text[[i,j]]</code></dt>
<dd>
<p>the <code>text</code> parameters used to draw the elements of the matrix</p>
</dd>
<dt><code>plot</code></dt>
<dd>
<p>the <code>plot</code> parameters used to draw the basic plot</p>
</dd>
<dt><code>axis.col</code></dt>
<dd>
<p>the <code>axis</code> parameters used to draw column axis</p>
</dd>
<dt><code>axis.row</code></dt>
<dd>
<p>the <code>axis</code> parameters used to draw row axis</p>
</dd>
<dt><code>key.polygon[[i]]</code></dt>
<dd>
<p>the <code>polygon</code> parameters used to draw the elements of the key</p>
</dd>
<dt><code>key.axis</code></dt>
<dd>
<p>the <code>axis</code> parameters used to draw key axis</p>
</dd>
</dl>
<p>A <code>NULL</code> means the elements has not been drawn.
</p>


<h3>Note</h3>

<p>The use of <code>fmt</code> or <code>fmt.key</code> have the same restrictions as the use of <code>fmt</code> in <code>base::sprintf()</code>:
</p>
<p><em>The format string is passed down the OS's sprintf function, and incorrect formats can cause the latter to crash the R process.
R does perform sanity checks on the format, but not all possible user errors on all platforms have been tested, and some might
be terminal.</em>
</p>


<h3>Examples</h3>

<pre><code class="language-R">par(mar=c(5.1, 4.1, 4.1, 4.1))
# numeric matrix
x &lt;- matrix(runif(50), nrow=10)
plot(x)
plot(x, key=NULL)
plot(x, key=list(cex.axis=0.5, tick=FALSE))
plot(x, digits=3)
plot(x, breaks=range(x), digits=3, cex=0.6)
# logical matrix
m &lt;- matrix(runif(50)&lt;0.5, nrow=10)
plot(m)
plot(m, col=c("red", "blue"))
plot(m, key=NULL, digits=1)
# character matrix
s &lt;- matrix(sample(letters[1:10], 50, replace=TRUE), nrow=10)
plot(s)
plot(s, col=topo.colors)
plot(s, digits=10)
plot(s, digits=1, col=heat.colors(5), breaks=letters[1:5])
plot(s, digits=1, col=heat.colors(5), breaks=c('a', 'c', 'e', 'g', 'i'))
# contingency table
tab &lt;- table(round(rnorm(100)), round(rnorm(100)))
plot(unclass(tab))
# chisquare test residuals
cst &lt;- chisq.test(apply(HairEyeColor, 1:2, sum))
col &lt;- colorRampPalette(c("blue", "white", "red"))
plot(cst$residuals, col=col, breaks=c(-7.5,7.5))
# triangular matrix
x[upper.tri(x)] &lt;- NA
plot(x, digit=2)
plot(x, na.print=FALSE)
plot(x, na.cell=FALSE)
# use the standard plot instead of plot.matrix
x &lt;- matrix(runif(50), nrow=2)
plot(as.data.frame(x))
plot.default(x)
## Not run: 
# unload the package permanently with devtools
library("devtools")
unload('plot.matrix')

## End(Not run)
</code></pre>


</div>