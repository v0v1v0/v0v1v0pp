<div class="container">

<table style="width: 100%;"><tr>
<td>pez.dissimilarity</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>Calculate (phylogenetic) dissimilarity: compare assemblages to
one-another</h2>

<h3>Description</h3>

<p>As described in Pearse et al. (2014), a dissimilarity metric
compares diversity between communities. WARNING: Phylosor is
presented as a distance matrix here, i.e. it is *not* the fraction
of shared branch length among communities, but rather '1 - shared
branch length'. This means <code>dissimilarity</code> always returns a
*distance* object, not a similarity object; this is a different
convention from other packages.
</p>


<h3>Usage</h3>

<pre><code class="language-R">pez.dissimilarity(
  data,
  metric = c("all", "unifrac", "pcd", "phylosor", "comdist"),
  abundance.weighted = FALSE,
  permute = 1000,
  sqrt.phy = FALSE,
  traitgram = NULL,
  traitgram.p = 2,
  ext.dist = NULL,
  ...
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>data</code></td>
<td>
<p><code>comparative.comm</code> object</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>metric</code></td>
<td>
<p>default (<code>all</code>) calculates everything;
individually call-able metrics are: <code>unifrac</code>, <code>pcd</code>,
<code>phylosor</code>, <code>comdist</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>abundance.weighted</code></td>
<td>
<p>If TRUE (default is FALSE) metrics are
calculated incorporating species abundances; only <code>comdist</code>
can incorporate abundances</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>permute</code></td>
<td>
<p>Number of permutations for metric (currently only
for <code>pcd</code>)</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>sqrt.phy</code></td>
<td>
<p>If TRUE (default is FALSE) your phylogenetic
distance matrix will be square-rooted; specifying TRUE will force
the square-root transformation on phylogenetic distance matrices
(in the spirit of Leitten and Cornwell, 2014). See ‘details’ for
details about different metric calculations when a distance matrix
is used.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>traitgram</code></td>
<td>
<p>If not NULL (default), a number to be passed to
<code>funct.phylo.dist</code> (<code>phyloWeight</code>; the ‘a’ parameter),
causing analysis on a distance matrix reflecting both traits and
phylogeny (0 –&gt; only phylogeny, 1 –&gt; only traits; see
<code>funct.phylo.dist</code>). Unlike other metric wrapper functions,
<code>dissimilarity</code> does not accept a vector of traitgram values;
call the function many times to get these. This is simply because
it can take so long: you're probably better off
looping/<code>apply</code>-ing over this function yourself.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>traitgram.p</code></td>
<td>
<p>A value for ‘p’ to be used in conjunction with
<code>traitgram</code> when calling <code>funct.phylo.dist</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>ext.dist</code></td>
<td>
<p>Supply an external species-level distance matrix
for use in calculations. See ‘details’ for comments on the use of
distance matrices in different metric calculations.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>...</code></td>
<td>
<p>additional parameters to be passed to 'metric
function(s) you are calling</p>
</td>
</tr>
</table>
<h3>Details</h3>

<p>Using square-rooted distance matrices, or distance matrices that
incorporate trait information, can be an excellent thing to do, but
(for the above reasons), <code>pez</code> won't give you an answer for
metrics for which WDP thinks it makes no sense. All results from
this other than <code>comdist</code> *will always be wrong* if you do not
have an ultrametric tree and square-root (branch lengths
proportional to time) and you will be warned about this. WDP
strongly feels you should only be using ultrametric phylogenies in
any case, but code to fix this bug is welcome.
</p>


<h3>Value</h3>

<p>list object of metric values.
</p>


<h3>Author(s)</h3>

<p>M.R. Helmus, Will Pearse
</p>


<h3>References</h3>

<p>Pearse W.D., Purvis A., Cavender-Bares J. &amp; Helmus
M.R. (2014). Metrics and Models of Community Phylogenetics. In:
Modern Phylogenetic Comparative Methods and Their Application in
Evolutionary Biology. Springer Berlin Heidelberg, pp. 451-464.
</p>
<p><code>unifrac</code> Lozupone C.A. &amp; Knight
R. (2005). UniFrac: a new phylogenetic method for comparing
microbial communities. Applied and Environmental Microbiology, 71,
8228-8235.
</p>
<p><code>pcd</code> Ives A.R. &amp; Helmus M.R. (2010). Phylogenetic
metrics of community similarity. The American Naturalist, 176,
E128-E142.
</p>
<p><code>phylosor</code> Bryant J.A., Lamanna C., Morlon H.,
Kerkhoff A.J., Enquist B.J. &amp; Green J.L. (2008). Microbes on
mountainsides: Contrasting elevational patterns of bacterial and
plant diversity. Proceedings of the National Academy of Sciences of
the United States of America, 105, 11505-11511.
</p>
<p><code>comdist</code> C.O. Webb, D.D. Ackerly, and
S.W. Kembel. 2008. Phylocom: software for the analysis of
phylogenetic community structure and trait
evolution. Bioinformatics 18:2098-2100.
</p>


<h3>See Also</h3>

<p><code>pez.shape</code> <code>pez.evenness</code> <code>pez.dispersion</code>
</p>


<h3>Examples</h3>

<pre><code class="language-R">data(laja)
data &lt;- comparative.comm(invert.tree, river.sites, invert.traits)
## Not run: 
dissim &lt;- pez.dissimilarity(data)

## End(Not run)
</code></pre>


</div>