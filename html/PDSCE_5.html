<div class="container">

<table style="width: 100%;"><tr>
<td>pdsoft</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>
A permutation invariant positive definite and sparse covariance matrix estimate
</h2>

<h3>Description</h3>

<p>Computes the sparse and positive definite covariance matrix estimator proposed by Rothman (2012).
</p>


<h3>Usage</h3>

<pre><code class="language-R">pdsoft(s, lam, tau = 1e-04, init = c("soft", "diag", "dense", "user"), 
       s0 = NULL, i0 = NULL, standard = TRUE, tolin = 1e-08, 
       tolout = 1e-08, maxitin = 10000, maxitout = 1000, quiet = TRUE)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>s</code></td>
<td>

<p>A realization of the <code class="reqn">p</code> by <code class="reqn">p</code> sample covariance matrix.  More generally, any symmetric <code class="reqn">p</code> by <code class="reqn">p</code>
matrix with positive diagonal entries.
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>lam</code></td>
<td>

<p>The tuning parameter <code class="reqn">\lambda</code> on the penalty <code class="reqn">\lambda \sum_{i\neq j} |\sigma_{ij}|</code>.  
Could be either a scalar or
a <code class="reqn">p</code> by <code class="reqn">p</code> symmetric matrix with an irrelevant diagonal.  When a matrix is used,
the penalty has the form <code class="reqn">\sum_{i\neq j} \lambda_{ij} |\sigma_{ij}|</code>.
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>tau</code></td>
<td>

<p>The logarithmic barrier parameter.  The default is <code>tau=1e-4</code>, which works well when <code>standard=TRUE</code>.
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>init</code></td>
<td>

<p>The type of initialization.  The default option <code>init="soft"</code> uses a positive definite version of the soft thresholded 
covariance or correlation estimate, depending on <code>standard</code>.  The second option 
<code>init="diag"</code> uses diagonal starting values.  The third option <code>init="dense"</code>  
uses the closed-form solution when <code>lam=0</code>.
The fourth option <code>init="user"</code> allows the user to specify the starting point (one must then
specify <code>s0</code> and <code>i0</code>, ensuring that <code>i0</code> is positive definite).  
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>s0</code></td>
<td>

<p>Optional user supplied starting point for <code class="reqn">\Sigma^{(0)}</code>; see Rothman (2012)
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>i0</code></td>
<td>

<p>Optional user supplied starting point for <code class="reqn">\Omega^{(0)}</code>; see Rothman (2012)
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>standard</code></td>
<td>

<p>Logical: <code>standard=TRUE</code> first computes the observed sample correlation matrix from <code>s</code>, then 
computes the sparse correlation matrix estimate, and finally rescales to return the sparse covariance
matrix estimate.  The strongly recommended default is <code>standard=TRUE</code>.
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>tolin</code></td>
<td>

<p>Convergence tolerance for the inner loop of the algorithm that solves the lasso regression.
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>tolout</code></td>
<td>

<p>Convergence tolerance for the outer loop of the algorithm.
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>maxitin</code></td>
<td>

<p>Maximum number of inner-loop iterations allowed
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>maxitout</code></td>
<td>

<p>Maximum number of outer-loop iterations allowed
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>quiet</code></td>
<td>

<p>Logical: <code>quiet=TRUE</code> suppresses the printing of progress updates.
</p>
</td>
</tr>
</table>
<h3>Details</h3>

<p>See Rothman (2012) for the objective function and more information.
</p>


<h3>Value</h3>

<p>A list with
</p>
<table>
<tr style="vertical-align: top;">
<td><code>sigma</code></td>
<td>
<p>covariance estimate</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>omega</code></td>
<td>
<p>inverse covariance estimate</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>theta</code></td>
<td>
<p>correlation matrix estimate, will be <code>NULL</code> if <code>standard=FALSE</code></p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>theta.inv</code></td>
<td>
<p>inverse correlation matrix estimate, will be <code>NULL</code> if <code>standard=FALSE</code></p>
</td>
</tr>
</table>
<h3>Note</h3>

<p>So long as <code>s</code> is symmetric with positive diagonal entries and
<code>init</code> is not set to <code>"user"</code>
(or <code>init</code> is set to <code>"user"</code> and <code>i0</code> as a positive definite matrix), 
then <code>omega</code> is positive definite.  If <code>tolin</code> and <code>tolout</code> are too large, 
or <code>maxitin</code> and <code>maxitout</code> are too small, then <code>sigma</code> may be indefinite.
</p>


<h3>Author(s)</h3>

<p>Adam J. Rothman
</p>


<h3>References</h3>

<p>Rothman, A. J. (2012).  Positive definite estimators of large covariance matrices. Biometrika 99(3): 733-740
</p>


<h3>See Also</h3>

<p><code>pdsoft.cv</code>
</p>


<h3>Examples</h3>

<pre><code class="language-R">set.seed(1)
n=50
p=20
true.cov=diag(p)
true.cov[cbind(1:(p-1), 2:p)]=0.4
true.cov[cbind(2:p, 1:(p-1))]=0.4
eo=eigen(true.cov, symmetric=TRUE)
z=matrix(rnorm(n*p), nrow=n, ncol=p)
x=z%*% tcrossprod(eo$vec*rep(eo$val^(0.5), each=p),eo$vec)
s=cov(x)*(n-1)/n
output=pdsoft(s=s, lam=0.3)
output$sigma
</code></pre>


</div>