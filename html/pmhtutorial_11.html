<div class="container">

<table style="width: 100%;"><tr>
<td>particleMetropolisHastings</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>Particle Metropolis-Hastings algorithm for a linear Gaussian state space 
model</h2>

<h3>Description</h3>

<p>Estimates the parameter posterior for <code class="reqn">phi</code> a linear Gaussian state 
space model of the form <code class="reqn"> x_{t} = \phi x_{t-1} + \sigma_v v_t </code> and 
<code class="reqn"> y_t = x_t + \sigma_e e_t </code>, where <code class="reqn">v_t</code> and <code class="reqn">e_t</code> denote 
independent standard Gaussian random variables, i.e.<code class="reqn">N(0,1)</code>.
</p>


<h3>Usage</h3>

<pre><code class="language-R">particleMetropolisHastings(y, initialPhi, sigmav, sigmae, noParticles,
  initialState, noIterations, stepSize)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>y</code></td>
<td>
<p>Observations from the model for <code class="reqn">t=1,...,T</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>initialPhi</code></td>
<td>
<p>The mean of the log-volatility process <code class="reqn">\mu</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>sigmav</code></td>
<td>
<p>The standard deviation of the state process <code class="reqn">\sigma_v</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>sigmae</code></td>
<td>
<p>The standard deviation of the observation process 
<code class="reqn">\sigma_e</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>noParticles</code></td>
<td>
<p>The number of particles to use in the filter.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>initialState</code></td>
<td>
<p>The inital state.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>noIterations</code></td>
<td>
<p>The number of iterations in the PMH algorithm.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>stepSize</code></td>
<td>
<p>The standard deviation of the Gaussian random walk proposal 
for <code class="reqn">\phi</code>.</p>
</td>
</tr>
</table>
<h3>Value</h3>

<p>The trace of the Markov chain exploring the marginal posterior for 
<code class="reqn">\phi</code>.
</p>


<h3>Note</h3>

<p>See Section 4 in the reference for more details.
</p>


<h3>Author(s)</h3>

<p>Johan Dahlin <a href="mailto:uni@johandahlin.com">uni@johandahlin.com</a>
</p>


<h3>References</h3>

<p>Dahlin, J. &amp; Schon, T. B. "Getting Started with Particle 
Metropolis-Hastings for Inference in Nonlinear Dynamical Models." 
Journal of Statistical Software, Code Snippets,
88(2): 1â€“41, 2019.
</p>


<h3>Examples</h3>

<pre><code class="language-R">

  # Generates 100 observations from a linear state space model with
  # (phi, sigma_e, sigma_v) = (0.5, 1.0, 0.1) and zero initial state.
  theta &lt;- c(0.5, 1.0, 0.1)
  d &lt;- generateData(theta, noObservations=100, initialState=0.0) 

  # Estimate the marginal posterior for phi
  pmhOutput &lt;- particleMetropolisHastings(d$y,
    initialPhi=0.1, sigmav=1.0, sigmae=0.1, noParticles=50, 
    initialState=0.0, noIterations=1000, stepSize=0.10)

  # Plot the estimate
  nbins &lt;- floor(sqrt(1000))
  par(mfrow=c(1, 1))
  hist(pmhOutput, breaks=nbins, main="", xlab=expression(phi), 
    ylab="marginal posterior", freq=FALSE, col="#7570B3")

</code></pre>


</div>