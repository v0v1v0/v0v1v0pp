<div class="container">

<table style="width: 100%;"><tr>
<td>bw.L2PCO</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>Compute the full PCO bandwith</h2>

<h3>Description</h3>

<p><code>bw.L2PCO</code> tries to minimise the PCO criterion (described and studied in Varet, S., Lacour, C., Massart, P., 
Rivoirard, V., (2019)) with a gold section search. For multivariate data, 
it searches for a full matrix.
</p>


<h3>Usage</h3>

<pre><code class="language-R">bw.L2PCO(
  x_i,
  nh = 40,
  K_name = "gaussian",
  binning = FALSE,
  nb = 32,
  tol = 1e-06,
  adapt_nb_bin = FALSE,
  nb_bin_vect = NULL
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>x_i</code></td>
<td>
<p>the observations. Must be a matrix with d column and n lines (d the dimension and n the sample size)</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>nh</code></td>
<td>
<p>the maximum number of PCO criterion evaluations during the golden section search. 
The default value is 40. The golden section search stop once this value is reached or 
if the tolerance is achieved, and return the middle of the interval.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>K_name</code></td>
<td>
<p>name of the kernel. Can be 'gaussian', 'epanechnikov', 
or 'biweight'. The default value is 'gaussian'.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>binning</code></td>
<td>
<p>default value is FALSE, that is the function computes the exact PCO criterion.
If set to TRUE allows to use binning.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>nb</code></td>
<td>
<p>is the number of bins to use when binning is TRUE. 
For multivariate x_i, nb corresponds to the number of bins per dimension. The default value is 32.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>tol</code></td>
<td>
<p>is the maximum authorized length of the interval which contains the optimal h 
for univariate data. For multivariate data, it corresponds to the length of each hypercube axe.
The golden section search stop once this value is achieved or when nh is reached 
and return the middle of the interval. Its default value is 10^(-6).</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>adapt_nb_bin</code></td>
<td>
<p>is a boolean used for univariate x_i. If set to TRUE, authorises the function to increase 
the number of bins if, with nb bins, the middle of the initial interval is not an admissible solution, that is 
if the criterion at the middle is greater than the mean of the criterion at the bounds of the initial interval of search.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>nb_bin_vect</code></td>
<td>
<p>can be set to have a different number of bins on each dimension</p>
</td>
</tr>
</table>
<h3>Value</h3>

<p>a scalar for univariate data or a matrix for multivariate data corresponding to the optimal bandwidth according to the PCO criterion
</p>


<h3>References</h3>

<p>Varet, S., Lacour, C., Massart, P., Rivoirard, V., (2019). <em>Numerical performance of Penalized
Comparison to Overfitting for multivariate kernel density estimation</em>. hal-02002275. <a href="https://hal.archives-ouvertes.fr/hal-02002275">https://hal.archives-ouvertes.fr/hal-02002275</a>
</p>


<h3>See Also</h3>

<p>[stats::nrd0()], [stats::nrd()], [stats::ucv()], [stats::bcv()] and [stats::SJ()] 
for other univariate bandwidth selection and [stats::density()] to compute the associated density estimation.
</p>
<p>[ks::Hlscv()], [ks::Hbcv()], [ks::ns()] for other multivariate bandwidth selection.
</p>


<h3>Examples</h3>

<pre><code class="language-R">
# an example with simulated univariate data

# load univariate data
data("gauss_1D_sample")

# computes the optimal bandwith for the sample x_i with all parameters set to their default value 
bw.L2PCO(gauss_1D_sample)


# an example with simulated multivariate data

# load multivariate data
data("gauss_mD_sample")

# computes the optimal bandwith for the sample x_i with all parameters set to their default value 
# generates a warning since the tolerance value is not reached
bw.L2PCO(gauss_mD_sample)

# To avoid this warning, it is possible to increase the parameter nh
bw.L2PCO(gauss_mD_sample, nh = 80)



</code></pre>


</div>