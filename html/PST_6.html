<div class="container">

<table style="width: 100%;"><tr>
<td>cprob</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>
Empirical conditional probability distributions of order <code>L</code>
</h2>

<h3>Description</h3>

<p>Compute the empirical conditional probability distributions of order L from a set of sequences
</p>


<h3>Usage</h3>

<pre><code class="language-R">## S4 method for signature 'stslist'
cprob(object, L, cdata=NULL, context, stationary=TRUE, nmin=1, prob=TRUE, 
weighted=TRUE, with.missing=FALSE, to.list=FALSE)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>object</code></td>
<td>

<p>a sequence object, that is an object of class stslist as created by TraMineR <code>seqdef</code> function.
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>L</code></td>
<td>
 
<p>integer. Context length.
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>cdata</code></td>
<td>
 
<p>under development 
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>context</code></td>
<td>

<p>character. An optional subsequence (a character string where symbols are separated by '-') for which the conditional probability distribution is to be computed.
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>stationary</code></td>
<td>

<p>logical. If <code>FALSE</code> probability distributions are computed for each sequence position L+1 ... l where l is the maximum sequence length. If <code>TRUE</code> the probability distributions are  stationary that is time homogenous. 
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>nmin</code></td>
<td>

<p>integer. Minimal frequency of a context. See details.
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>prob</code></td>
<td>

<p>logical. If <code>TRUE</code> the probability distributions are returned. If <code>FALSE</code> the function returns the empirical counts on which the probability distributions are computed.
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>weighted</code></td>
<td>

<p>logical. If <code>TRUE</code> case weights attached to the sequence object are used in the computation of the probabilities. 
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>with.missing</code></td>
<td>

<p>logical. If <code>FALSE</code> only contexts contining no missing status are considered. 
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>to.list</code></td>
<td>

<p>logical. If <code>TRUE</code> and <code>stationary=TRUE</code>, a list instead of a matrix is returned. See <code>value</code>.
</p>
</td>
</tr>
</table>
<h3>Details</h3>

<p>The empirical conditional probability <code class="reqn">\hat{P}(\sigma | c)</code> of observing a symbol <code class="reqn">\sigma \in A</code> after the subsequence <code class="reqn">c=c_{1}, \ldots, c_{k}</code> of length <code class="reqn">k=L</code> is computed as 
</p>
<p style="text-align: center;"><code class="reqn">
\hat{P}(\sigma | c) = \frac{N(c\sigma)}{\sum_{\alpha \in A} N(c\alpha)}
</code>
</p>

<p>where
</p>
<p style="text-align: center;"><code class="reqn">
N(c)=\sum_{i=1}^{\ell} 1 \left[x_{i}, \ldots, x_{i+|c|-1}=c \right], \; x=x_{1}, \ldots, x_{\ell}, \; c=c_{1}, \ldots, c_{k}
</code>
</p>

<p>is the number of occurrences of the subsequence <code class="reqn">c</code> in the sequence <code class="reqn">x</code> and <code class="reqn">c\sigma</code> is the concatenation of the subsequence <code class="reqn">c</code> and the symbol <code class="reqn">\sigma</code>.  
</p>
<p>Considering a - possibly weighted - sample of <code class="reqn">m</code> sequences having weights <code class="reqn">w^{j}, \; j=1 \ldots m</code>, the function <code class="reqn">N(c)</code> is replaced by
</p>
<p style="text-align: center;"><code class="reqn">
N(c)=\sum_{j=1}^{m} w^{j} \sum_{i=1}^{\ell} 1 \left[x_{i}^{j}, \ldots, x_{i+|c|-1}^{j}=c \right], \; c=c_{1}, \ldots, c_{k}
</code>
</p>

<p>where <code class="reqn">x^{j}=x_{1}^{j}, \ldots, x_{\ell}^{j}</code> is the <code class="reqn">j</code>th sequence in the sample. For more details, see <cite>Gabadinho 2016</cite>.
</p>


<h3>Value</h3>

<p>If <code>stationary=TRUE</code> a matrix  with one row for each subsequence of length <code class="reqn">L</code> and minimal frequency <code class="reqn">nmin</code> appearing in <code>object</code>.  If <code>stationary=FALSE</code> a list where each element corresponds to one subsequence and contains a matrix whith the probability distribution at each position <code class="reqn">p</code> where a state is preceded by the subsequence.  
</p>


<h3>Author(s)</h3>

<p>Alexis Gabadinho
</p>


<h3>References</h3>

<p>Gabadinho, A. &amp; Ritschard, G. (2016). Analyzing State Sequences with Probabilistic Suffix Trees: The PST R Package. <em>Journal of Statistical Software</em>, <b>72</b>(3), pp. 1-39.
</p>


<h3>Examples</h3>

<pre><code class="language-R">## Example with the single sequence s1
data(s1)
s1 &lt;- seqdef(s1)
cprob(s1, L=0, prob=FALSE)
cprob(s1, L=1, prob=TRUE)

## Preparing a sequence object with the SRH data set
data(SRH)
state.list &lt;- levels(SRH$p99c01)
## sequential color palette
mycol5 &lt;- rev(brewer.pal(5, "RdYlGn"))
SRH.seq &lt;- seqdef(SRH, 5:15, alphabet=state.list, states=c("G1", "G2", "M", "B2", "B1"), 
	labels=state.list, weights=SRH$wp09lp1s, right=NA, cpal=mycol5)
names(SRH.seq) &lt;- 1999:2009

## Example 1: 0th order: weighted and unweigthed counts
cprob(SRH.seq, L=0, prob=FALSE, weighted=FALSE)
cprob(SRH.seq, L=0, prob=FALSE, weighted=TRUE)

## Example 2: 2th order: weighted and unweigthed probability distrib.
cprob(SRH.seq, L=2, prob=TRUE, weighted=FALSE)
cprob(SRH.seq, L=2, prob=TRUE, weighted=TRUE)
</code></pre>


</div>