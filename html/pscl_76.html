<div class="container">

<table style="width: 100%;"><tr>
<td>simpi</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>Monte Carlo estimate of pi (3.14159265...)</h2>

<h3>Description</h3>

<p>Monte Carlo estimation of pi
</p>


<h3>Usage</h3>

<pre><code class="language-R">simpi(n)
</code></pre>


<h3>Arguments</h3>

<table><tr style="vertical-align: top;">
<td><code>n</code></td>
<td>
<p>integer, number of Monte Carlo samples, defaults to 1000</p>
</td>
</tr></table>
<h3>Details</h3>

<p>A crude Monte Carlo estimate of <code class="reqn">\pi</code> can be formed as
follows.  Sample from the unit square many times (i.e., each sample is
formed with two independent draws from a uniform density on the unit
interval).  Compute the proportion <code class="reqn">p</code> of sampled points that
lie inside a unit circle centered on the origin; such points
<code class="reqn">(x,y)</code> have distance from the origin <code class="reqn">d = \sqrt{x^2 +
  y^2}</code> less than 1.  Four times <code class="reqn">p</code> is a
Monte Carlo estimate of <code class="reqn">\pi</code>.  This function is a wrapper to
a simple C function, bringing noticeable speed gains and memory
efficiencies over implementations in native R.
</p>
<p>Contrast this Monte Carlo method with Buffon's needle and refinements thereof (see
the discussion in Ripley (1987, 193ff). 
</p>


<h3>Value</h3>

<p>the Monte Carlo estimate of <code class="reqn">\pi</code></p>


<h3>Author(s)</h3>

<p>Simon Jackman <a href="mailto:simon.jackman@sydney.edu.au">simon.jackman@sydney.edu.au</a></p>


<h3>References</h3>

<p>Ripley, Brain D. 1987 [2006].  <em>Stochastic Simulation</em>.
Wiley: Hoboken, New Jersey.</p>


<h3>Examples</h3>

<pre><code class="language-R">seed &lt;- round(pi*10000)  ## hah hah hah
m &lt;- 6
z &lt;- rep(NA,m)
lim &lt;- rep(NA,m)
for(i in 1:m){
  cat(paste("simulation for ",i,"\n"))
  set.seed(seed)
  timings &lt;- system.time(z[i] &lt;- simpi(10^i))
  print(timings)
  cat("\n")
  lim[i] &lt;- qbinom(prob=pi/4,size=10^i,.975)/10^i * 4
}

## convert to squared error
z &lt;-(z - pi)^2
lim &lt;- (lim - pi)^2

plot(x=1:m,
     y=z,
     type="b",
     pch=16,
     log="y",
     axes=FALSE,
     ylim=range(z,lim),
     xlab="Monte Carlo Samples",
     ylab="Log Squared Error")
lines(1:m,lim,col="blue",type="b",pch=1)
legend(x="topright",
       legend=c("95% bound",
         "Realized"),
       pch=c(1,16),
       lty=c(1,1),
       col=c("blue","black"),
       bty="n")
axis(1,at=1:m,
     labels=c(expression(10^{1}),
       expression(10^{2}),
       expression(10^{3}),
       expression(10^{4}),
       expression(10^{5}),
       expression(10^{6})))
axis(2)

</code></pre>


</div>