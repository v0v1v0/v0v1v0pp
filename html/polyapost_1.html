<div class="container">

<table style="width: 100%;"><tr>
<td>constrppmn</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>Estimating a Population Mean Using the Constrained Polya Posterior.</h2>

<h3>Description</h3>

<p>Let <code class="reqn">p=(p_1,\ldots,p_n)</code>
be a probability distribution defined on
<code class="reqn">y_{\rm samp}</code>, the set of observed values, in a sample of
size <code class="reqn">n</code>
from some population. <code class="reqn">p</code> is assumed to belong to
a polytope which is a lower dimensional subset of the <code class="reqn">n</code>-dimensional
simplex.  The polytope is defined by a collection of linear
equality and inequality constraints.  A dependent sequence of values
for <code class="reqn">p</code> are generated by a Markov chain using the Metropolis-Hastings
algorithm whose stationary distribution is the uniform distribution
over the polytope.  For each generated value of <code class="reqn">p</code> the corresponding
mean, <code class="reqn">\sum_i p_i y_i</code>  is found.</p>


<h3>Usage</h3>

<pre><code class="language-R">constrppmn(A1,A2,A3,b1,b2,b3,initsol,reps,ysamp,burnin)</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>A1</code></td>
<td>
<p>The matrix for the equality constraints.This must always
contain the constraint <code>sum(p) == 1</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>A2</code></td>
<td>
<p>The matrix for the <code>&lt;=</code> inequality constraints.  This must always
contain the constraints <code>-p &lt;= 0</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>A3</code></td>
<td>
<p>The matrix for the <code>&gt;=</code> inequality constraints.  If there are no
such constraints <code>A3</code> must be set equal to NULL.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>b1</code></td>
<td>
<p>The rhs vector for <code>A1</code>, each component must be nonnegative.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>b2</code></td>
<td>
<p>The rhs vector for <code>A2</code>, each component must be nonnegative.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>b3</code></td>
<td>
<p>The rhs vector for <code>A3</code>, each component must be nonnegative.
If <code>A3</code> is <code>NULL</code> then <code>b3</code> must be NULL.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>initsol</code></td>
<td>
<p>A vector which lies in the interior of the polytope.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>reps</code></td>
<td>
<p>The total length of the chain that is generated.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>ysamp</code></td>
<td>
<p>The observed sample from the population of interest.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>burnin</code></td>
<td>
<p>The point in the chain at which the set of computed means
begins.</p>
</td>
</tr>
</table>
<h3>Value</h3>

<p>The returned value is a list whose first component is the chain
of the means of length <code>reps - burnin -1</code>, whose second component
is the mean  of the first component (i.e. the Polya estimate of the
population mean) and whose third component is the 2.5th and 97.5th
quantiles of the first component (i.e. an approximate 95 percent
confidence interval of the population mean).</p>


<h3>Examples</h3>

<pre><code class="language-R">A1&lt;-rbind(rep(1,6),1:6)
A2&lt;-rbind(c(2,5,7,1,10,8),diag(-1,6))
b1&lt;-c(1,3.5)
b2&lt;-c(6,rep(0,6))
initsol&lt;-rep(1/6,6)
rep&lt;-1006
burnin&lt;-1000
ysamp&lt;-c(1,2.5,3.5,7,4.5,6)
out&lt;-constrppmn(A1,A2,NULL,b1,b2,NULL,initsol,rep,ysamp,burnin)
out[[1]] # the Markov chain of the means.
out[[2]] # the average of out[[1]]
out[[3]] # the 2.5th and 97.5th quantiles of out[[1]]
</code></pre>


</div>