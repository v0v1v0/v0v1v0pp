<div class="container">

<table style="width: 100%;"><tr>
<td>phenoPhase</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>Phenological Phase Extraction</h2>

<h3>Description</h3>

<p>Extracts phenological metrics based on modelled NDVI values.</p>


<h3>Usage</h3>

<pre><code class="language-R">phenoPhase(x, phase, method, threshold, n)</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>x</code></td>
<td>
<p>An object of class ‘NDVI’ containing modelled NDVI values.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>phase</code></td>
<td>
<p>Determines which phase will be extracted:
</p>
<p>“<b>max</b>”: Day of the year with highest NDVI value is returned.
</p>
<p>“<b>maxval</b>”: The highest modelled NDVI value and its standard deviation is returned.
</p>
<p>“<b>min</b>”: Day of the year (before day with maximum NDVI value) 
with lowest NDVI value is returned. 
</p>
<p>“<b>minval</b>”: The lowest modelled NDVI value and its standard deviation is returned.
</p>
<p>“<b>greenup</b>”: Day of the year at which greenup takes place and its standard deviation is returned. 
This day refers to the point where the function of modelled NDVI values 
exceeds a certain threshold.
</p>
<p>“<b>senescence</b>”: Day of the year at which senescence takes place and its standard deviation is returned. 
This day refers to the point where the function of modelled NDVI values exceeds 
a certain threshold.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>method</code></td>
<td>
<p>Determines whether a global or local threshold is used for
greenup and senescence extraction.
</p>
<p>“<b>global</b>” threshold: The day of the year is returned, 
where NDVI values are first equal or higher as the value of ‘threshold’.
If the threshold is higher than the values of the timeseries, ‘-1’ will be returned.
</p>
<p>“<b>local</b>” threshold: The day of the year is returned, for which NDVI values first reach the value of
‘threshold’ (interpreted as percentage) between lowest and highest NDVI value of timeserie. 
The lowest NDVI value is chosen depending on phase selected. For “greenup”, 
the lowest value before day of maximum NDVI value is used. For “senescence”, 
the lowest value after day of maximum NDVI value is used.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>threshold</code></td>
<td>
<p>Threshold for local or global greenup/senescence-extraction method. 
Should have numerical value between ‘0’ and ‘1’. Global thresholds 
refer to a fix NDVI value independent of actual NDVI magnitudes. 
Local thresholds are based on (max - min) * e.g. 0.55. Hence, the respective 
NDVI value will vary dependent on e.g. land-cover.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>n</code></td>
<td>
<p>The number ‘n’ of normal distributed values around the threshold for estimation of ‘sd’. The normal distribution uses the threshold as mean and a standaed deviation consisting of 			satellite error and standard deviation of fit residuals. The satellite error is considered as 0.02+0.02*value.</p>
</td>
</tr>
</table>
<h3>Value</h3>

<p>A list containing the julian day of the year at which the phenologial phase occurs as list entry ‘mean’ and its standard deviation as list entry ‘sd’. The list contains vectors in ‘mean’ and ‘sd’ if multiple seasons are available in ‘NDVI’ object.</p>


<h3>Author(s)</h3>

<p>Daniel Doktor, Maximilian Lange</p>


<h3>See Also</h3>

<p><code>NDVI</code>, <code>detectSeasons</code>, <code>seasons</code></p>


<h3>Examples</h3>

<pre><code class="language-R">	# load data
	data(avhrr)

	# create NDVI object, correct and model NDVI values
	ndvi &lt;- modelNDVI(ndvi.values=avhrr.ndvi/10000, year.int=1995, 
				correction="bise", method="LinIP", MARGIN=2, 
				doParallel=FALSE, slidingperiod=40)[[1]]

	# extract greenup DOY
	greenup &lt;- phenoPhase(ndvi, phase="greenup", method="local", threshold=0.55, n=1000)
</code></pre>


</div>