<div class="container">

<table style="width: 100%;"><tr>
<td>one_stage_multiarm</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>Calculate the sample sizes and other design parameters for an one-stage K-experimental arm trial
using the root-K rule for the allocation ratio, controlling for FWER or PWER</h2>

<h3>Description</h3>

<p>This function can be used to design a K-experimental arm trial (with K experimental arm plus a common
control arm) given a pre-planned family-wise error rate (or pair-wise error rate) and with a
user-specified marginal power. It calculates required sample sizes for each of the
experimental arm (n1), the control arm (n0_1), the total sample size (N1), and the critical
value (z_alpha1) for each experimental arm-control comparison in the trial.
</p>


<h3>Usage</h3>

<pre><code class="language-R">one_stage_multiarm(
  K,
  fwer = NULL,
  pwer = NULL,
  marginal.power,
  delta,
  seed = 123
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>K</code></td>
<td>
<p>the number of experimental arms</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>fwer</code></td>
<td>
<p>the family-wise type I error rate, default to be null, users need to choose
between controlling for fwer or pwer and input a value for this argument if choosing fwer</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>pwer</code></td>
<td>
<p>the pair-wise type I error rate, default to be null, users need to input a value
for this argument if controlling for pwer</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>marginal.power</code></td>
<td>
<p>the marginal power for each experimental-control comparison</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>delta</code></td>
<td>
<p>the standardized effect size expected to be detected
in the trial</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>seed</code></td>
<td>
<p>an integer used in random number generation for numerically evaluating integration,
default = 123</p>
</td>
</tr>
</table>
<h3>Details</h3>

<p>Given the number of experimental arms (K), the family-wise type I error rate (or the pair-wise
type-I error-rate), the marginal power for each experimental-control comparison and the
standardized effect size, to calculate the sample sizes and other design parameters for the
K-experimental arm trial (with K-experimental arm in addition to one control arm).
</p>


<h3>Value</h3>

<p><em>K</em> the number of experimental arms in the K-experimental arm trial (with K experimental arm
plus a common control arm), e.g., for a 3-arm trial with 3 experimental arm and 1 control arm,
K=3.
</p>
<p><em>n1</em> the sample size for each of the K experimental arms
</p>
<p><em>n0_1</em> the sample size of the common control arm
</p>
<p><em>N1</em> the total sample size of a K-experimental arm trial
</p>
<p><em>z_alpha1</em> the critical value for the comparison between any of the
K-experimental arm and its corresponding control
</p>
<p><em>FWER1</em> the family-wise type-I error rate
</p>
<p><em>z_beta1</em> the quantile of the marginal power, i.e., qnorm(marginal power)
</p>
<p><em>Power1</em> the disjunctive power of the K-experimental arm trial defined as the
probability of rejecting at least one of the K experimental arms under the
alternative hypothesis
</p>
<p><em>corMat1</em> the correlation matrix of the Z-test statistics
</p>
<p><em>delta</em> the standardized effect size expected to be detected in the K-experimental arm trial
</p>


<h3>Author(s)</h3>

<p><code style="white-space: pre;">⁠    ⁠</code>Xiaomeng Yuan, Haitao Pan
</p>


<h3>References</h3>

<p><code style="white-space: pre;">⁠    ⁠</code>Pan, H., Yuan, X. and Ye, J. (2022). An optimal two-period multiarm
platform design with new experimental arms added during the trial. Manuscript submitted for
publication.
</p>
<p><code style="white-space: pre;">⁠    ⁠</code>Dunnett, C. W. (1955). A multiple comparison procedure for comparing
several treatments with a control. Journal of the American Statistical
Association, 50(272), 1096-1121.
</p>


<h3>Examples</h3>

<pre><code class="language-R"># controlling for FWER
one_stage_multiarm(K = 2, fwer = 0.025, marginal.power = 0.8, delta = 0.4)
#$K
#[1] 2
#
#$n1
#[1] 101
#
#$n0_1
#[1] 143
#
#$N1
#[1] 345
#
#$z_alpha1
#[1] 2.220604
#
#$FWER1
#[1] 0.025
#
#$z_beta1
#[1] 0.8416212
#
#$Power1
#[1] 0.9222971
#
#$corMat1
#[,1]      [,2]
#[1,] 1.0000000 0.4142136
#[2,] 0.4142136 1.0000000
#
#$delta
#[1] 0.4
#
# controlling for pwer
one_stage_multiarm(K = 2, pwer = 0.025, marginal.power = 0.8, delta = 0.4)
#$K
#[1] 2
#
#$n1
#[1] 84
#
#$n0_1
#[1] 119
#
#$N1
#[1] 287
#
#$z_alpha1
#[1] 1.959964
#
#$FWER1
#[1] 0.04647892
#
#$z_beta1
#[1] 0.8416212
#
#$Power1
#[1] 0.9222971
#
#$corMat1
#[,1]      [,2]
#[1,] 1.0000000 0.4142136
#[2,] 0.4142136 1.0000000
#
#$delta
#[1] 0.4
</code></pre>


</div>