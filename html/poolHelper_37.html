<div class="container">

<table style="width: 100%;"><tr>
<td>simulateCoverage</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>Simulate total number of reads per site</h2>

<h3>Description</h3>

<p>This function simulates the total number of reads, for each polymorphic site
using a negative binomial distribution.
</p>


<h3>Usage</h3>

<pre><code class="language-R">simulateCoverage(mean, variance, nSNPs = NA, nLoci = NA, genotypes = NA)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>mean</code></td>
<td>
<p>an integer that defines the mean depth of coverage to simulate.
Please note that this represents the mean coverage across all sites. If a
vector is supplied instead, the function assumes that each entry of the
vector is the mean for a different population.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>variance</code></td>
<td>
<p>an integer that defines the variance of the depth of coverage
across all sites. If a vector is supplied instead, the function assumes
that each entry of the vector is the variance for a different population.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>nSNPs</code></td>
<td>
<p>an integer representing the number of polymorphic sites per
locus to simulate. This is an optional input but either this or the
<code>genotypes</code> list must be supplied.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>nLoci</code></td>
<td>
<p>an optional integer that represents how many independent loci
should be simulated.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>genotypes</code></td>
<td>
<p>a list of simulated genotypes, where each entry is a matrix
corresponding to a different locus. At each matrix, each column is a
different SNP and each row is a different individual. This is an optional
input but either this or the <code>nSNPs</code> must be supplied.</p>
</td>
</tr>
</table>
<h3>Details</h3>

<p>The total number of reads is simulated with a negative binomial and according
to a user-defined mean depth of coverage and variance. This function is
intended to work with a list of genotypes, simulating the depth of coverage
for each site present in the genotypes. However, it can also be used to
simulate coverage distributions independent of genotypes, by choosing how
many loci to simulate (with the <code>nLoci</code> option) and choosing how many sites
per locus should be simulated (with the <code>nSNPs</code> option).
</p>


<h3>Value</h3>

<p>a list with the total coverage per population and per site. Each list
entry is a matrix corresponding to a different locus. For each matrix,
different rows represent different populations and each column is a
different site.
</p>


<h3>Examples</h3>

<pre><code class="language-R"># simulate 10 loci, each with 10 SNPs for a single population
simulateCoverage(mean = 100, variance = 250, nSNPs = 10, nLoci = 10)

# simulate 10 loci, each with 10 SNPs for two populations:
# the first with 100x and the second with 50x
simulateCoverage(mean = c(100, 50), variance = c(250, 150), nSNPs = 10, nLoci = 10)

# simulate coverage given a set of genotypes
# run scrm and obtain genotypes
genotypes &lt;- run_scrm(nDip = 100, nloci = 10)
# simulate coverage
simulateCoverage(mean = 50, variance = 200, genotypes = genotypes)

</code></pre>


</div>