<div class="container">

<table style="width: 100%;"><tr>
<td>methods_pspatreg</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>Methods for class pspatreg</h2>

<h3>Description</h3>

<p>The <code>anova</code> function provides tables of fitted 
'pspatreg' models including information criteria (AIC and BIC), 
log-likelihood and degrees of freedom of each fitted model. The 
argument 'lrtest' allows to perform LR tests between nested models.
The <code>print</code> function is used to print short tables including the 
values of beta and spatial coefficients as well as p-values of significance test for each 
coefficient. This can be used as an alternative to 
<code>summary.pspatreg</code> when a brief output is needed. 
The rest of methods works in the usual way.
</p>


<h3>Usage</h3>

<pre><code class="language-R">## S3 method for class 'pspatreg'
anova(object, ..., lrtest = TRUE)

## S3 method for class 'pspatreg'
coef(object, ...)

## S3 method for class 'pspatreg'
fitted(object, ...)

## S3 method for class 'pspatreg'
logLik(object, ..., REML = FALSE)

## S3 method for class 'pspatreg'
residuals(object, ...)

## S3 method for class 'pspatreg'
vcov(object, ..., bayesian = TRUE)

## S3 method for class 'pspatreg'
print(x, digits = max(3L, getOption("digits") - 3L), ...)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>object</code></td>
<td>
<p>a 'pspatreg' object created by 
<code>pspatfit</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>...</code></td>
<td>
<p>further arguments passed to or from other methods.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>lrtest</code></td>
<td>
<p>logical value to compute likelihood ratio
test for nested models in 'anova' method. Default = 'TRUE'</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>REML</code></td>
<td>
<p>logical value to get restricted log-likelihood 
instead of the usual log-likelihood. Default = 'FALSE'</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>bayesian</code></td>
<td>
<p>logical value to get bayesian or frequentist
covariance matrix for parametric terms. Default = 'FALSE'</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>x</code></td>
<td>
<p>similar to <code>object</code> argument for <code>print()</code> 
and <code>plot</code> functions.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>digits</code></td>
<td>
<p>number of digits to show in printed tables.
Default: max(3L, getOption("digits") - 3L).</p>
</td>
</tr>
</table>
<h3>Value</h3>

<p><code>anova:</code> An object of class <em>anova</em>. Can be printed
with <code>summary</code>. 
If argument <code>lrtest = TRUE</code> (default), the object 
returned includes an LR test for nested models. 
In this case, a warning message is printed to emphasize 
that the LR test remains valid only for nested models.
</p>
<p><code>coef:</code> A numeric vector including spatial parameters and
parameters corresponding to parametric covariates. 
Also includes fixed parameters for non-parametric 
covariates. Can be printed with <code>print</code>.
</p>
<p><code>fitted:</code> A numeric vector including fitted values for the 
dependent variable.
</p>
<p><code>logLik:</code> An object of class <em>logLik</em>. Can be printed
with <code>print</code>.
If argument <code>REML = FALSE</code> (default), the object returns 
the value of log-likelihood function in the optimum. 
If argument <code>REML = TRUE</code>, the object returns 
the value of restricted log-likelihood function in 
the optimum.
</p>
<p><code>residuals:</code> A numeric vector including residuals of the model.
</p>
<p><code>vcov:</code> A matrix including the covariance matrix for the
estimated parameters.
If argument <code>bayesian = TRUE</code> (default), the 
covariance matrix is computed using bayesian
method. 
If argument <code>bayesian = FALSE</code> , the 
covariance matrix is computed using sandwich method. 
See Fahrmeir et al. (2021) for details.
</p>
<p><code>print:</code> No return value
</p>


<h3>Author(s)</h3>


<table>
<tr>
<td style="text-align: left;">
    Roman Minguez </td>
<td style="text-align: left;"> <a href="mailto:roman.minguez@uclm.es">roman.minguez@uclm.es</a> </td>
</tr>
<tr>
<td style="text-align: left;">
    Roberto Basile </td>
<td style="text-align: left;"> <a href="mailto:roberto.basile@univaq.it">roberto.basile@univaq.it</a> </td>
</tr>
<tr>
<td style="text-align: left;">
    Maria Durban </td>
<td style="text-align: left;"> <a href="mailto:mdurban@est-econ.uc3m.es">mdurban@est-econ.uc3m.es</a> </td>
</tr>
<tr>
<td style="text-align: left;">
    Gonzalo Espana-Heredia </td>
<td style="text-align: left;"> <a href="mailto:gehllanza@gmail.com">gehllanza@gmail.com</a> </td>
</tr>
<tr>
<td style="text-align: left;">
  </td>
</tr>
</table>
<h3>References</h3>

 
<ul><li>
<p> Fahrmeir, L.; Kneib, T.;  Lang, S.; and Marx, B. (2021). 
<em>Regression. Models, Methods and Applications (2nd Ed.)</em>.
Springer.
</p>
</li></ul>
<h3>Examples</h3>

<pre><code class="language-R">library(pspatreg)
###############################################
# Examples using spatial data of Ames Houses.
###############################################
# Getting and preparing the data
library(spdep)
library(sf)
ames &lt;- AmesHousing::make_ames() # Raw Ames Housing Data
ames_sf &lt;- st_as_sf(ames, coords = c("Longitude", "Latitude"))
ames_sf$Longitude &lt;- ames$Longitude
ames_sf$Latitude &lt;- ames$Latitude
ames_sf$lnSale_Price &lt;- log(ames_sf$Sale_Price)
ames_sf$lnLot_Area &lt;- log(ames_sf$Lot_Area)
ames_sf$lnTotal_Bsmt_SF &lt;- log(ames_sf$Total_Bsmt_SF+1)
ames_sf$lnGr_Liv_Area &lt;- log(ames_sf$Gr_Liv_Area)
ames_sf1 &lt;- ames_sf[(duplicated(ames_sf$Longitude) == FALSE), ]
####  GAM pure with pspatreg
form1 &lt;- lnSale_Price ~ Fireplaces + Garage_Cars +
          pspl(lnLot_Area, nknots = 20) + 
          pspl(lnTotal_Bsmt_SF, nknots = 20) +
          pspl(lnGr_Liv_Area, nknots = 20)    
gampure &lt;- pspatfit(form1, data = ames_sf1)
summary(gampure)

#' ########### Constructing the spatial weights matrix
coord_sf1 &lt;- cbind(ames_sf1$Longitude, ames_sf1$Latitude)
k5nb &lt;- knn2nb(knearneigh(coord_sf1, k = 5, 
                          longlat = TRUE, use_kd_tree = FALSE), sym = TRUE)
lw_ames &lt;- nb2listw(k5nb, style = "W", 
                  zero.policy = FALSE)

#####################  GAM + SAR Model
gamsar &lt;- pspatfit(form1, data = ames_sf1, 
                   type = "sar", listw = lw_ames,
                   method = "Chebyshev")
summary(gamsar)

### Compare Models
anova(gampure, gamsar, lrtest = FALSE)
## logLikelihood 
logLik(gamsar)
## Restricted logLikelihood
logLik(gamsar, REML = TRUE)
## Parametric and spatial coefficients
print(gamsar)
coef(gamsar)
## Frequentist (sandwich) covariance matrix 
## (parametric terms)
vcov(gamsar, bayesian = FALSE)      
## Bayesian covariance matrix (parametric terms)
vcov(gamsar)
#####################################
#### Fitted Values and Residuals
plot(gamsar$fitted.values, 
     ames_sf1$lnSale_Price, 
     xlab = 'fitted values', 
     ylab = "unrate",
     type = "p", cex.lab = 1.3, 
     cex.main = 1.3,
     main = "Fitted Values gamsar model")      
plot(gamsar$fitted.values, gamsar$residuals, 
     xlab = 'fitted values', ylab = "residuals",
     type = "p", cex.lab = 1.3, cex.main=1.3,
     main = "Residuals geospsar model")

     
</code></pre>


</div>