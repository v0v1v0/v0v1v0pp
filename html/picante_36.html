<div class="container">

<table style="width: 100%;"><tr>
<td>phylostruct</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2> Permutations to Test for Phylogenetic Signal in Community Composition </h2>

<h3>Description</h3>

<p> Randomize sample/community data matrices to create null distributions of given metrics
</p>


<h3>Usage</h3>

<pre><code class="language-R">phylostruct(samp, tree, env=NULL, metric=c("psv","psr","pse","psc","sppregs"),
    null.model=c("frequency", "richness","independentswap","trialswap"),
    runs=100, it=1000, alpha=0.05, fam="binomial")
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>samp</code></td>
<td>
<p> community data matrix, species as columns, communities as rows </p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>tree</code></td>
<td>
<p> phylo tree object or a phylogenetic covariance matrix </p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>env</code></td>
<td>
<p> environmental data matrix </p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>metric</code></td>
<td>
<p> if <code>metric="psv"</code>, <code>"psr"</code>, <code>"pse"</code>, or <code>"psc"</code> compares the observed mean of the respective metric to a null distribution at a given alpha; if <code>metric="sppregs"</code> compares the three correlations produced by <code>sppregs</code> to null distributions </p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>null.model</code></td>
<td>
<p> permutation procedure used to create the null distribution, see <code>randomizeMatrix</code></p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>runs</code></td>
<td>
<p> the number of permutations to create the distribution, a rule of thumb is (number of communities)/alpha  </p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>it</code></td>
<td>
<p> the number of swaps for the independent and trial-swap null models, see <code>randomizeMatrix</code> </p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>alpha</code></td>
<td>
<p> probability value to compare the observed mean/correlations to a null distribution </p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>fam</code></td>
<td>
<p> as in <code>sppregs</code> </p>
</td>
</tr>
</table>
<h3>Details</h3>

<p>The function creates null distributions for the <code>psd</code> set of metrics and for the correlations of <code>sppregs</code> from observed community data sets.</p>


<h3>Value</h3>

<table>
<tr style="vertical-align: top;">
<td><code>metric</code></td>
<td>
<p> metric used </p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>null.model</code></td>
<td>
<p> permutation used </p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>runs</code></td>
<td>
<p> number of permutations </p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>it</code></td>
<td>
<p> number of swaps if applicable </p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>obs</code></td>
<td>
<p> observed mean value of a particular metric or the three observed correlations from <code>sppregs</code> </p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>mean.null</code></td>
<td>
<p> mean(s) of the null distribution(s) </p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>quantiles.null</code></td>
<td>
<p>  quantiles of the null distribution(s) to compare to <code>obs</code>; determined by <code>alpha</code></p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>phylo.structure</code></td>
<td>
<p> if <code>obs</code> less than (alpha/2), <code>phylo.structure="underdispersed"</code>; if <code>obs</code> greater than (1-alpha/2), <code>phylo.structure="overdispersed"</code>; otherwise <code>phylo.structure="random"</code> and NULL if <code>metric="sppregs"</code></p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>nulls</code></td>
<td>
<p> null values of the distribution(s)</p>
</td>
</tr>
</table>
<h3>Author(s)</h3>

<p> Matthew Helmus <a href="mailto:mrhelmus@gmail.com">mrhelmus@gmail.com</a> </p>


<h3>References</h3>

<p> Helmus M.R., Bland T.J., Williams C.K. &amp; Ives A.R. (2007a) Phylogenetic measures of biodiversity. American Naturalist, 169, E68-E83
<br><br>
Helmus M.R., Savage K., Diebel M.W., Maxted J.T. &amp; Ives A.R. (2007b) Separating the determinants of phylogenetic community structure. Ecology Letters, 10, 917-925
<br><br>
Gotelli N.J. (2000) Null model analysis of species co-occurrence patterns. Ecology, 81, 2606-2621</p>


<h3>See Also</h3>

 <p><code>psd</code> ,<code>sppregs</code>, <code>randomizeMatrix</code> </p>


</div>