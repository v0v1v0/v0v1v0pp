<div class="container">

<table style="width: 100%;"><tr>
<td>pwrss.t.reg</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>Linear Regression: Single Coefficient (t or z Test)</h2>

<h3>Description</h3>

<p>Calculates statistical power or minimum required sample size (only one can be NULL at a time) to test a single coefficient in multiple linear regression. The predictor is assumed to be continuous by default. However, one can find statistical power or minimum required sample size for a binary predictor (such as treatment and control groups in an experimental design) by specifying <code>sdx = sqrt(p*(1-p))</code> where <code>p</code> is the proportion of subjects in one of the groups. The sample size in each group would be <code>n*p</code> and <code>n*(1-p)</code>. <code>pwrss.t.regression()</code> and <code>pwrss.t.reg()</code> are the same functions.
</p>
<p>When HIGHER values of an outcome is a good thing, <code>beta1</code> is expected to be greater than <code>beta0 + margin</code> for non-inferiority and superiority tests. In this case, <code>margin</code> is NEGATIVE for the non-inferiority test but it is POSITIVE for the superiority test.
</p>
<p>When LOWER values of an outcome is a good thing, <code>beta1</code> is expected to be less than <code>beta0 + margin</code> for non-inferiority and superiority tests. In this case, <code>margin</code> is POSITIVE for the non-inferiority test but it is NEGATIVE for the superiority test.
</p>
<p>For equivalence tests the value of <code>beta0</code> shifts both to the left and right as <code>beta0 - margin</code> and <code>beta0 + margin</code>. For equivalence tests <code>margin</code> is stated as the absolute value and <code>beta1</code> is expected to fall between <code>beta0 - margin</code> and <code>beta0 + margin</code>.
</p>
<p>Formulas are validated using Monte Carlo simulation, G*Power, tables in PASS documentation, and tables in Bulus (2021).
</p>


<h3>Usage</h3>

<pre><code class="language-R">pwrss.t.reg(beta1 = 0.25, beta0 = 0, margin = 0,
            sdx = 1, sdy = 1,
            k = 1, r2 = (beta1 * sdx / sdy)^2,
            alpha = 0.05, n = NULL, power = NULL,
            alternative = c("not equal", "less", "greater",
                            "non-inferior", "superior", "equivalent"),
            verbose = TRUE)

pwrss.z.reg(beta1 = 0.25, beta0 = 0, margin = 0,
            sdx = 1, sdy = 1,
            k = 1, r2 = (beta1 * sdx / sdy)^2,
            alpha = 0.05, n = NULL, power = NULL,
            alternative = c("not equal", "less", "greater",
                            "non-inferior", "superior", "equivalent"),
            verbose = TRUE)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>beta1</code></td>
<td>
<p>expected regression coefficient. One can use standardized regression coefficient, but should keep <code>sdx = 1</code> and <code>sdy = 1</code> or leave them out as they are default specifications</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>beta0</code></td>
<td>
<p>regression coefficient under null hypothesis (usually zero). Not to be confused with the intercept. One can use standardized regression coefficient, but should keep <code>sdx = 1</code> and <code>sdy = 1</code> or leave them out as they are default specifications</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>margin</code></td>
<td>
<p>non-inferiority, superiority, or equivalence margin (margin: boundry of <code>beta1 - beta0</code> that is practically insignificant)</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>sdx</code></td>
<td>
<p>expected standard deviation of the predictor. For a binary predictor, <code>sdx = sqrt(p*(1-p))</code> where<code>p</code> is the proportion of subjects in one of the groups</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>sdy</code></td>
<td>
<p>expected standard deviation of the outcome</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>k</code></td>
<td>
<p>(total) number of predictors</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>r2</code></td>
<td>
<p>expected model R-squared. The default is <code>r2 = (beta * sdx / sdy)^2</code> assuming a linear regression with one predictor. Thus, an <code>r2</code> below this value will throw a warning. To consider other covariates in the model provide a value greater than the default <code>r2</code> along with the argument <code>k&gt;1</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>n</code></td>
<td>
<p>total sample size</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>power</code></td>
<td>
<p>statistical power <code class="reqn">(1-\beta)</code></p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>alpha</code></td>
<td>
<p>probability of type I error</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>alternative</code></td>
<td>
<p>direction or type of the hypothesis test: "not equal", "greater", "less", "non-inferior", "superior", or "equivalent"</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>verbose</code></td>
<td>
<p>if <code>FALSE</code> no output is printed on the console</p>
</td>
</tr>
</table>
<h3>Value</h3>

<table>
<tr style="vertical-align: top;">
<td><code>parms</code></td>
<td>
<p>list of parameters used in calculation</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>test</code></td>
<td>
<p>type of the statistical test (z or t test)</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>df</code></td>
<td>
<p>numerator degrees of freedom</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>ncp</code></td>
<td>
<p>non-centrality parameter</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>power</code></td>
<td>
<p>statistical power <code class="reqn">(1-\beta)</code></p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>n</code></td>
<td>
<p>total sample size</p>
</td>
</tr>
</table>
<h3>References</h3>

<p>Bulus, M. (2021). Sample size determination and optimal design of randomized/non-equivalent pretest-posttest control-group designs. Adiyaman Univesity Journal of Educational Sciences, 11(1), 48-69.
</p>
<p>Phillips, K. F. (1990). Power of the two one-Sided tests procedure in bioequivalence. Journal of Pharmacokinetics and Biopharmaceutics, 18(2), 137-144.
</p>
<p>Dupont, W. D., and Plummer, W. D. (1998). Power and sample size calculations for studies involving linear regression. Controlled Clinical Trials, 19(6), 589-601.
</p>


<h3>Examples</h3>

<pre><code class="language-R"># continuous predictor x (and 4 covariates)
pwrss.t.reg(beta1 = 0.20, alpha = 0.05,
            alternative = "not equal",
            k = 5, r2 = 0.30,
            power = 0.80)

pwrss.t.reg(beta1 = 0.20, alpha = 0.05,
            alternative = "not equal",
            k = 5, r2 = 0.30,
            n = 138)

# binary predictor x (and 4 covariates)
p &lt;- 0.50 # proportion of subjects in one group
pwrss.t.reg(beta1 = 0.20, alpha = 0.05,
            alternative = "not equal",
            sdx = sqrt(p*(1-p)),
            k = 5, r2 = 0.30,
            power = 0.80)

pwrss.t.reg(beta1 = 0.20, alpha = 0.05,
            alternative = "not equal",
            sdx = sqrt(p*(1-p)) ,
            k = 5, r2 = 0.30,
            n = 550)

# non-inferiority test with binary predictor x (and 4 covariates)
p &lt;- 0.50 # proportion of subjects in one group
pwrss.t.reg(beta1 = 0.20, beta0 = 0.10, margin = -0.05,
            alpha = 0.05, alternative = "non-inferior",
            sdx = sqrt(p*(1-p)),
            k = 5, r2 = 0.30,
            power = 0.80)

pwrss.t.reg(beta1 = 0.20, beta0 = 0.10, margin = -0.05,
            alpha = 0.05, alternative = "non-inferior",
            sdx = sqrt(p*(1-p)),
            k = 5, r2 = 0.30,
            n = 770)

# superiority test with binary predictor x (and 4 covariates)
p &lt;- 0.50 # proportion of subjects in one group
pwrss.t.reg(beta1 = 0.20, beta0 = 0.10, margin = 0.01,
            alpha = 0.05, alternative = "superior",
            sdx = sqrt(p*(1-p)),
            k = 5, r2 = 0.30,
            power = 0.80)

pwrss.t.reg(beta1 = 0.20, beta0 = 0.10, margin = 0.01,
            alpha = 0.05, alternative = "superior",
            sdx = sqrt(p*(1-p)),
            k = 5, r2 = 0.30,
            n = 2138)

# equivalence test with binary predictor x (and 4 covariates)
p &lt;- 0.50 # proportion of subjects in one group
pwrss.t.reg(beta1 = 0.20, beta0 = 0.20, margin = 0.05,
            alpha = 0.05, alternative = "equivalent",
            sdx = sqrt(p*(1-p)),
            k = 5, r2 = 0.30,
            power = 0.80)

pwrss.t.reg(beta1 = 0.20, beta0 = 0.20, margin = 0.05,
            alpha = 0.05, alternative = "equivalent",
            sdx = sqrt(p*(1-p)),
            k = 5, r2 = 0.30,
            n = 9592)
</code></pre>


</div>