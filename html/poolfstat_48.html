<div class="container">

<table style="width: 100%;"><tr>
<td>find.tree.popset</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>Find sets of populations that may used as scaffold tree</h2>

<h3>Description</h3>

<p>Find sets of populations that may used as scaffold tree
</p>


<h3>Usage</h3>

<pre><code class="language-R">find.tree.popset(
  fstats,
  f3.zcore.threshold = -1.65,
  f4.zscore.absolute.threshold = 1.96,
  excluded.pops = NULL,
  nthreads = 1,
  verbose = TRUE
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>fstats</code></td>
<td>
<p>Object of class fstats containing estimates of fstats (see the function compute.fstats)</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>f3.zcore.threshold</code></td>
<td>
<p>The significance threshold for Z-score of formal test of admixture based on the F3-statistics (default=-2)</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>f4.zscore.absolute.threshold</code></td>
<td>
<p>The significance threshold for |Z-score| of formal test of treeness based on the F4-statistics  (default=2)</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>excluded.pops</code></td>
<td>
<p>Vector of pop names to be exclude from the exploration</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>nthreads</code></td>
<td>
<p>Number of available threads for parallelization of some part of the parsing (default=1, i.e., no parallelization)</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>verbose</code></td>
<td>
<p>If TRUE extra information is printed on the terminal</p>
</td>
</tr>
</table>
<h3>Details</h3>

<p>The procedure first discards all the populations P that shows a significant signal of admixture with a Z-score for F3 statistics of the form F3(P;Q,R) &lt; f3.zscore.thresholds. It then identifies all the sets of populations that pass the F4-based treeness with themselves. More precisely, for a given set E containing n populations, the procedure ensure that all the n(n-1)(n-2)(n-3)/8 possible F4 quadruplets have a |Z-score|&lt;f4.zscore.absolute.threshold. The function aims at maximizing the size of the sets.
</p>


<h3>Value</h3>

<p>A list with the following elements:
</p>

<ol>
<li>
<p> "n.sets": The number of sets of (scaffold) unadmixed populations identified
</p>
</li>
<li>
<p> "set.size": The number of populations included in each set
</p>
</li>
<li>
<p> "pop.sets": A character matrix of n.sets rows and set.size columns giving for each set identified the names of the included populations.
</p>
</li>
<li>
<p> "Z_f4.range": A matrix of n.sets rows and 2 columns reported for each set the range of variation (min and max value) of the absolute F4 Z-scores for the quadruplets passing the treeness test. More precisely, for a given set consisting of n=set.size populations, a total of n(n-1)(n-2)(n-3)/8 quadruplets can be formed. Yet, any set of four populations A, B, C and D is represented by three quadruplets A,B;C,D (or one of its seven other equivalent combinations formed by permuting each pairs); A,C;B,D (or one of its seven other equivalent combinations) and A,D;B,C (or one of its seven other combinations). Among these three, only a single quadruplet is expected to pass the treeness test (i.e., if the correct unrooted tree topology is (A,C;B,D), then the absoulte value of the Z-scores associated to F4(A,B;C,D) and F4(A,D;B,C) or their equivalent will be high. 
</p>
</li>
<li>
<p> "passing.quadruplets": A matrix of n.sets rows and set.size columns reporting for each sets the n(n-1)(n-2)(n-3)/24 quadruplets that pass the treeness test (see Z_f4.range detail). 
</p>
</li>
</ol>
<h3>See Also</h3>

<p>see <code>compute.fstats</code>.
</p>


<h3>Examples</h3>

<pre><code class="language-R">make.example.files(writing.dir=tempdir())
pooldata=popsync2pooldata(sync.file=paste0(tempdir(),"/ex.sync.gz"),poolsizes=rep(50,15))
res.fstats=compute.fstats(pooldata,nsnp.per.bjack.block = 50) 
#NOTE: toy example (in practice nsnp.per.bjack.block should be higher)
popsets=find.tree.popset(res.fstats,f3.zcore.threshold=-3)  
</code></pre>


</div>