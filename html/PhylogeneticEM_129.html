<div class="container">

<table style="width: 100%;"><tr>
<td>simulate_internal</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>Simulate a Stochastic Process on a tree</h2>

<h3>Description</h3>

<p><code>simulate_internal</code> simulate a stochastic process on a tree.
</p>


<h3>Usage</h3>

<pre><code class="language-R">simulate_internal(
  phylo,
  process = c("BM", "OU", "scOU", "OUBM", "StudentOU"),
  p = 1,
  root.state = list(random = FALSE, stationary.root = FALSE, value.root = NA, exp.root =
    NA, var.root = NA),
  shifts = list(edges = NULL, values = NULL, relativeTimes = NULL),
  eps = 10^(-6),
  selection.strength = NULL,
  variance = NULL,
  optimal.value = NULL,
  checks = TRUE,
  simulate_random = TRUE,
  U_tree = NULL,
  times_shared = NULL,
  df = 1
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>phylo</code></td>
<td>
<p>a phylogenetic tree, class <code>phylo</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>process</code></td>
<td>
<p>The model used for the simulation. One of "BM" (for a full BM
model, univariate or multivariate); "OU" (for a full OU model, univariate or
multivariate); or "scOU" (for a "scalar OU" model).</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>p</code></td>
<td>
<p>Dimension of the simulated trait</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>root.state</code></td>
<td>
<p>List describing the state of the root, with:
</p>

<dl>
<dt>random</dt>
<dd>
<p>random state (TRUE) or deterministic state (FALSE)</p>
</dd>
<dt>value.root</dt>
<dd>
<p>if deterministic, value of the character at the root</p>
</dd>
<dt>exp.root</dt>
<dd>
<p>if random, expectation of the character at the root</p>
</dd>
<dt>var.root</dt>
<dd>
<p>if random, variance of the character at the root (pxp matrix)</p>
</dd>
</dl>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>shifts</code></td>
<td>
<p>List with position and values of the shifts :
</p>

<dl>
<dt>edges</dt>
<dd>
<p>vector of the K id of edges where the shifts are</p>
</dd>
<dt>values</dt>
<dd>
<p>matrix p x K of values of the shifts on the edges
(one column = one shift)</p>
</dd>
<dt>relativeTimes</dt>
<dd>
<p>vector of dimension K of relative time of the shift from the parent node of edges</p>
</dd>
</dl>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>eps</code></td>
<td>
<p>Tolerance for the value of the norm 1 of the selection strength matrix for OU</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>selection.strength</code></td>
<td>
<p>Matrix of selection strength size p x p (OU)</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>variance</code></td>
<td>
<p>Variance-covariance matrix size p x p</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>optimal.value</code></td>
<td>
<p>Vector of p optimal values at the root (OU)</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>checks</code></td>
<td>
<p>whether to check the entry parameters for consistency. Default 
to TRUE.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>simulate_random</code></td>
<td>
<p>set to FALSE if only the expected values are needed
(and not the random sample). Default to TRUE.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>U_tree</code></td>
<td>
<p>optional, full incidence matrix of the tree, result of function
<code>incidence.matrix.full</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>times_shared</code></td>
<td>
<p>optional, times of shared ancestry of all nodes and tips,
result of function <code>compute_times_ca</code>. Can be specified to avoid extra
computations.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>df</code></td>
<td>
<p>if the process is "StudentOU", the number of degree of freedom of
the chosen student law. default to 1.</p>
</td>
</tr>
</table>
<h3>Value</h3>

<p>paramSimu An array with dimensions p x Nnode x 2 (BM)
or p x Nnode x 3 (OU). For each trait t, 1 &lt;= t &lt;= p, paramSimu[t, , ] has
tree columns, containing respectively the simulated state,
expected value and optimal value for all the nodes.
</p>


</div>