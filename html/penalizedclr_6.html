<div class="container">

<table style="width: 100%;"><tr>
<td>stable.clr.g</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>Stability selection based on penalized conditional logistic regression</h2>

<h3>Description</h3>

<p>Performs stability selection for conditional logistic regression models with L1 and L2 penalty
allowing for different penalties for different blocks
(groups) of covariates (different data sources).
</p>


<h3>Usage</h3>

<pre><code class="language-R">stable.clr.g(
  response,
  stratum,
  penalized,
  unpenalized = NULL,
  p = NULL,
  lambda.list,
  alpha = 1,
  B = 100,
  parallel = TRUE,
  standardize = TRUE,
  event
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>response</code></td>
<td>
<p>The response variable, either a 0/1 vector or a factor with two levels.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>stratum</code></td>
<td>
<p>A numeric vector with stratum membership of each observation.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>penalized</code></td>
<td>
<p>A matrix of penalized covariates.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>unpenalized</code></td>
<td>
<p>A matrix of additional unpenalized covariates.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>p</code></td>
<td>
<p>The sizes of blocks of covariates,
a numerical vector of the length equal to the number of blocks,
and with the sum equal to the number of penalized covariates.
If missing, all covariates are treated the same and a single penalty is applied.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>lambda.list</code></td>
<td>
<p>A list of vectors of penalties to be applied to different blocks of
covariates. Each vector should have the length equal to the number of blocks.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>alpha</code></td>
<td>
<p>The elastic net mixing parameter, a number between 0 and 1.
alpha=0 would give pure ridge; alpha=1 gives lasso. Pure ridge penalty is never obtained in this implementation since alpha must be positive.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>B</code></td>
<td>
<p>A single positive number for the number of subsamples.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>parallel</code></td>
<td>
<p>Logical. Should the computation be parallelized?</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>standardize</code></td>
<td>
<p>Should the covariates be standardized, a logical value.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>event</code></td>
<td>
<p>If response is a factor, the level that
should be considered a success in the logistic regression.</p>
</td>
</tr>
</table>
<h3>Details</h3>

<p>This function implements stability selection (Meinshausen and Bühlmann, 2010) in
a conditional logistic regression. The implementation is based on the modification of Shah and
Samworth (2013) featuring complementary subsamples. Note that this means that the number
of subsamples will be <code style="white-space: pre;">⁠2B⁠</code> instead of <code>B</code>. Subsampling procedure is repeated
<code style="white-space: pre;">⁠2B⁠</code> times for each vector of per-block penalties resulting each time in a vector of
selection frequencies (frequency of non-zero coefficient estimate of each covariate).
The final selection probability <code>Pistab</code> is obtained by taking the maximum over
all considered vectors of penalties.
</p>


<h3>Value</h3>

<p>A list containing a numeric vector <code>Pistab</code>,
giving selection probabilities for all penalized covariates,
<code>lambda.list</code> and <code>p</code> provided as input arguments.
</p>


<h3>References</h3>


<ol>
<li>
<p> Meinshausen, N., &amp; Bühlmann, P. (2010). Stability selection.
Journal of the Royal Statistical Society: Series B (Statistical Methodology), 72(4), 417-473.
</p>
</li>
<li>
<p> Shah, R. D., &amp; Samworth, R. J. (2013). Variable selection with error control:
another look at stability selection. Journal of the Royal Statistical Society: Series B (Statistical Methodology), 75(1), 55-80.
</p>
</li>
</ol>
<h3>Examples</h3>

<pre><code class="language-R">set.seed(123)

# simulate covariates (pure noise in two blocks of 20 and 80 variables)
X &lt;- cbind(matrix(rnorm(4000, 0, 1), ncol = 20), matrix(rnorm(16000, 2, 0.6), ncol = 80))
p &lt;- c(20,80)

# stratum membership
stratum &lt;- sort(rep(1:100, 2))

# the response
Y &lt;- rep(c(1, 0), 100)

# list of L1 penalties

lambda.list = list(c(0.5,1), c(2,0.9))

# perform stability selection

stable.g1 &lt;- stable.clr.g(response = Y, penalized = X, stratum = stratum,
                         p = p, lambda.list = lambda.list)


</code></pre>


</div>