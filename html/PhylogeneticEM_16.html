<div class="container">

<table style="width: 100%;"><tr>
<td>compute_E.simple</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>E step</h2>

<h3>Description</h3>

<p><code>compute_E.simple</code> computes the E step in the simple case where the invert matrix Sigma_YY_inv is given
</p>


<h3>Usage</h3>

<pre><code class="language-R">compute_E.simple(
  phylo,
  times_shared,
  distances_phylo,
  process,
  params_old,
  masque_data = c(rep(TRUE, attr(params_old, "p_dim") * length(phylo$tip.label)),
    rep(FALSE, attr(params_old, "p_dim") * phylo$Nnode)),
  F_moments,
  Y_data_vec_known,
  miss = rep(FALSE, attr(params_old, "p_dim") * length(phylo$tip.label)),
  Y_data,
  U_tree,
  ...
)
</code></pre>


<h3>Arguments</h3>

<table><tr style="vertical-align: top;">
<td><code>phylo</code></td>
<td>
<p>Input tree.</p>
</td>
</tr></table>
<h3>Details</h3>

<p>This function takes parameters sim, Sigma and Sigma_YY_inv from  
<code>compute_mean_variance.simple</code>. It uses functions 
<code>extract_variance_covariance</code>, <code>extract_covariance_parents</code>, and
<code>extract_simulate_internal</code> to extract the needed quantities from these objects.
</p>


<h3>Value</h3>

<p>conditional_law_X (list) : list of conditional statistics :
"expectation" : matrix of size p x (ntaxa+Nnode), with ntaxa
first columns set to Y_data (tips), and from ntaxa+1 to conditional expectation
of the nodes conditioned to the tips E[Z_j|Y]
"variances" : array of size p x p x (ntaxa+Nnode) with ntaxa first 
matrices of zeros (tips) and conditional variance of the nodes conditioned to the tips 
Var[Z_j|Y]
"covariances" : array of size p x p x (ntaxa+Nnode) with ntaxa first 
matrices of zeros (tips) and conditional covariance of the nodes and their parents
conditioned to the tips Cov[Z_j,Z_pa(j)|Y], with NA for the root.
"optimal.values" : matrix of size p x ntaxa+Nnode of optimal
values beta(t_j)
</p>


</div>