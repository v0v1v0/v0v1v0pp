<div class="container">

<table style="width: 100%;"><tr>
<td>plmboxes</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>
Multibox plots
</h2>

<h3>Description</h3>

<p>Draw multibox plot(s) for given (grouped) values, possibly asymmetric.
'plbox' draws a single multibox plot (low level graphical function).
'plboxes' is a high level graphics function that draws multiboxes for
grouped data. A secondary, binary grouping factor can be given
to produce asymmetric multiboxes.
</p>


<h3>Usage</h3>

<pre><code class="language-R">plmboxes(x, ...)
## S3 method for class 'formula'
plmboxes(x, y=NULL, data, ...)

## Default S3 method:
plmboxes(x=NULL, y=NULL, data=NULL, width=1, at=NULL,
    horizontal=FALSE,
    probs=NULL, outliers=TRUE, na=FALSE, backback=NULL, refline=NULL,
    add=FALSE, xlim=NULL, ylim=NULL, axes=TRUE, xlab=NULL, ylab=NULL,
    labelsperp=FALSE, xmar=NULL, mar=NULL,
    widthfac=NULL, minheight=NULL, colors=NULL, lwd=NULL, 
    .subdefault=NULL, plargs = NULL, ploptions = NULL, marpar = NULL, ...)

plmbox(x, at=0, probs=NULL, outliers=TRUE, na.pos=NULL, horizontal=FALSE,
    width=1, wfac=NULL, minheight=NULL, adj=0.5, extquant=FALSE, 
    widthfac=c(max=2, med=1.3, medmin=0.3, outl=NA),
    colors=c(box="lightblue2",med="blue",na="gray90"),
    lwd=c(med=3, range=2), warn=options("warn"))
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>x</code></td>
<td>
<p>For 'plmboxes.formula':
a formula, such as 'y ~ grp' or 'y~grp+grp2',
where 'y' is a numeric vector of data values to be split into groups
according to the grouping variable 'grp' (usually a factor)
and, if given, according to the binary variable 'grp2'.
'y~1+grp2' produces a single asymmetric mbox.
</p>
<p>For 'plmboxes.default':
factor to be used as the grouping variable or matrix or data.frame
with 2 columns (for asymmetric mbox plot), where the second column
is binary.
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>y</code></td>
<td>
<p>a numeric vector of data values</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>data</code></td>
<td>
<p>a data.frame from which the variables in 'formula'
should be taken.
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>width</code></td>
<td>
<p>a vector giving the widths of the multibox plot
for each group 'grp1'. 
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>at</code></td>
<td>
<p>horizontal position of the multiboxes. Must have length equal
to the number of (present) levels of the factor 'grp'.
if an element of 'at' is 'NA', the group will be skipped.
Defaults to 1, 2, ...
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>horizontal</code></td>
<td>
<p>logical. If TRUE, boxes will be drawn horizontally.
Note that 'y' is then the horizontal coordinate, i.e., still the
quantitative variable defining the boxes, and 'x' is still the
grouping.
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>probs</code></td>
<td>
<p>probability values for selecting the quantiles.
If all 'probs' are &lt;=0.5, they will be mirrored at 0.5 for
'plmboxes'. The default is c(0.05,0.25,0.5) if the average number of
data per group (for 'plmboxes', or the number of data, for 'plmbox')
is less than 20, c(0.025,0.05,0.125,0.25,0.375,0.5), otherwise. 
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>outliers</code></td>
<td>
<p>logical: should outliers be marked?
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>na, na.pos</code></td>
<td>
<p>if 'na' is not NULL, NA values will be represented by
a box.
If 'na' is TRUE, the position of the box will be generated to be below
the minimum of the data.
If 'na' (for 'plmboxes') or 'na.pos' (for 'plmbox') is a scalar or
a vector of length 2,
the position of the box is at that value (with a generated width) or
between the 2 values, respectively.
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>backback</code></td>
<td>
<p>logical: Should two back-to-back multiboxes be
displayed if the (single) x factor is binary?
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>refline</code></td>
<td>
<p>vertical positions of any horizontal reference lines
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>add</code></td>
<td>
<p>logical. If TRUE, the mboxes will be added to an existing
plot without calling 'plot'.
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>xlim</code></td>
<td>
<p>plotting limits for the horizontal axis.
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>ylim</code></td>
<td>
<p>plotting limits for the vertical axis.
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>axes</code></td>
<td>
<p>logical. If FALSE, no axes are drawn.
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>xlab</code></td>
<td>
<p>label for the x axis. Defaults to the "x factor" â€“
the first name on the right hand side of 'formula'
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>ylab</code></td>
<td>
<p>label for the x axis. Defaults to the left hand side of
'formula'.
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>labelsperp</code></td>
<td>
<p>logical: Should the labels for the levels of the
"x factor" be shown in perpendicular to the axis?
If it is numeric, it determines the maximum label length, with a
maximum of 20.
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>xmar</code></td>
<td>
<p>plot margin for the "x factor" axis.
Default tries to be suitable, i.e. expand the margin if
<code>labelsperp</code> is <code>TRUE</code> according to the length of the
levels' labels. If <code>xmar</code> has two more elements,
they determine the margin lines where the variable label and the levels'
labels are shown.
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>mar</code></td>
<td>
<p>margin widths</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>widthfac</code></td>
<td>
<p>named vector used to modify the following settings:
<br>  
max=2: determes the maximal width of the boxes.
Boxes that should be wider are censored and marked as such.
<br>
med=1.3, medmin=0.3: determine the width of the mark for the data median.
The width is 'med' times the maximal width of the boxes,
but at least 'medmin'.
<br>
outl=NA: length of the marks for outliers.
<br>
sep=0.003: width of the gap between the "half" mbox plots in case of
asymmetric mboxes (only needed for 'plmboxes').
<br>
For 'plmboxes', the argument needs to contain only the elements that
should be different from the default values.
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>colors</code></td>
<td>
<p>named vector or list selecting the colors to be used,
with named elements:
</p>
<p>box="lightblue2": color with which the central box(es)
(those corresponding to probabilieties between 0.25 and 0.75)
will be filled.
</p>
<p>med="blue": color of the mark for the median.
</p>
<p>na="grey90": color with which the box for NA values will be filled.
</p>
<p>For 'plmboxes', the argument needs to contain only the elements that
should be different from the default values.
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>lwd</code></td>
<td>
<p>named vector or list selecting the line width to be used,
with named elements:
</p>
<p>med=3: line width for the mark showing the median
</p>
<p>range=2: line width for the line along the range of the data
</p>
<p>For 'plmboxes', the argument needs to contain only the elements that
should be different from the default values.
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>plargs</code></td>
<td>
<p>result of calling <code>pl.control</code>.
If <code>NULL</code>, <code>pl.control</code> will be called to generate it.
If not null, arguments given in <code>...</code> will be ignored.
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>ploptions</code></td>
<td>
<p>list of pl options.
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>marpar</code></td>
<td>
<p>margin parameters, if already available.
By default, they will be retieved from <code>ploptions</code>.
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>...</code></td>
<td>
<p>additional arguments passed to 'plot'
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>.subdefault</code></td>
<td>
<p>text for the subtitle in case that it is not
specified
</p>
</td>
</tr>
</table>
<p>Specific arguments for 'plmbox':
</p>
<table>
<tr style="vertical-align: top;">
<td><code>wfac</code></td>
<td>
<p>factor by which the widths of the boxes must be multiplied.
If given, it overrides 'width'
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>minheight</code></td>
<td>
<p>minimal class width ("height") for the boxes (in case
two quantiled are [almost] identical). The default is 0.02 times
the (median of the within group) IQR.
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>adj</code></td>
<td>
<p>adjustment of the boxes. 'adj=0' leads to boxes aligned on
the left, 'adj=1', on the right, 'adj=0.5', centered. Other values of
'adj' make little sense.
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>extquant</code></td>
<td>
<p>logical, passed to <code>quinterpol</code>:
Should the quantiles be extrapolated beyond the range of the data?
This may make sense if the sample is small or the data is rounded
or grouped or a score.
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>warn</code></td>
<td>
<p>level of warning for the case when there is no non-missing data</p>
</td>
</tr>
</table>
<h3>Details</h3>

<p>A multibox plot is a generalization (and modification) of the
ordinary box plot that draws more details of the distribution in the
form of a histogram with variable class widths.
The classes are selected such that preselected quantiles form the
class breaks. By default, these quantiled include the median and the
quartiles, thereby recovering the box of the traditional box plot.
</p>


<h3>Value</h3>

<p><code>plmboxes</code> invisibly returns the 'at' values that are finally
used.\
<code>plmbox</code> returns a scalar by which the width of the boxes are
multiplied for plotting, 
and, as attributes, the quantiles and widths used to draw the boxes
</p>


<h3>Author(s)</h3>

<p>Werner A. Stahel
</p>


<h3>See Also</h3>

<p><code>boxplot</code>
</p>


<h3>Examples</h3>

<pre><code class="language-R">plmboxes(Sepal.Length~Species, data=iris)

plmboxes(Sepal.Length~Species, data=iris,
  widthfac=c(med=2), colors=c(med="red"), horizontal=TRUE)

plmboxes(Sepal.Length~factor(Species)+I(Sepal.Width&lt;=3), data=iris[1:100,],
         labelsperp=TRUE, horizontal=TRUE)
</code></pre>


</div>