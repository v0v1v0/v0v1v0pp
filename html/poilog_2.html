<div class="container">

<table style="width: 100%;"><tr>
<td>MLE for bivariate Poisson lognormal distribution</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2> Maximum Likelihood Estimation for Bivariate Poisson Lognormal Distribution </h2>

<h3>Description</h3>

<p><code>bipoilogMLE</code> fits the bivariate Poisson lognormal distribution to data
</p>


<h3>Usage</h3>

<pre><code class="language-R">bipoilogMLE(n1, n2 = NULL, 
            startVals = c(mu1=1, mu2=1, sig1=2, sig2=2, rho=0.5), 
            nboot = 0, zTrunc = TRUE, file = NULL, 
            method = "BFGS", control = list(maxit=1000))
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>n1</code></td>
<td>
<p> a vector or a matrix with two columns of pairwise counts of observed individuals for each species </p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>n2</code></td>
<td>
<p> if n1 is not given as a matrix, a vector of counts with same ordering of species as in argument n1</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>startVals</code></td>
<td>
<p> starting values of parameters </p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>nboot</code></td>
<td>
<p> number of parametric bootstraps, defaults to zero </p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>zTrunc</code></td>
<td>
<p> logical; if TRUE (default) the zero-truncated distribution is fitted </p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>file</code></td>
<td>
<p> text file to hold copies of bootstrap estimates </p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>method</code></td>
<td>
<p> method to use during optimization, see details </p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>control</code></td>
<td>
<p> a list of control parameters for the optimization routine, see details </p>
</td>
</tr>
</table>
<h3>Details</h3>

<p>The function estimates the parameters <code>mu1</code>, <code>sig1</code>, <code>mu2</code>, <code>sig2</code> and <code>rho</code>. 
In cases of incomplete sampling the estimates of <code>mu1</code> and <code>mu2</code> will be confounded with the sampling
intensities (see <code>rbipoilog</code>). Assuming sampling intensities <code class="reqn">\nu_1</code> and <code class="reqn">\nu_2</code>, 
the estimates of the means are <code class="reqn">\code{mu1}+\ln \nu_1</code> and <code class="reqn">\code{mu2}+\ln\nu_2</code>. Parameters
<code>sig1</code>, <code>sig2</code> and <code>rho</code> can be estimated without any knowledge of sampling intensities.
The parameters must be given starting values for the optimization procedure (default starting values are 
used if starting values are not specified in the function call).
</p>
<p>A zero-truncated distribution (see <code>dbipoilog</code>) is assumed by default (<code>zTrunc = TRUE</code>).
In cases where the number of zeros is known the <code>zTrunc</code> argument should be set to <code>FALSE</code>.
</p>
<p>The function uses the optimization procedures in <code>optim</code> to obtain the maximum likelihood estimate.
The <code>method</code> and <code>control</code> arguments are passed to <code>optim</code>, see the help page for this 
function for additional methods and control parameters.
</p>
<p>The approximate fraction of species revealed by each sample is estimated as 1 minus the zero term of the 
univariate Poisson lognormal distribution: <code class="reqn">1-q(0;\code{mu1},\code{sig1})</code> and <code class="reqn">1-q(0;\code{mu2},\code{sig2})</code>.
</p>
<p>Parametric bootstrapping could be time consuming for large data sets. If argument <code>file</code> is specified, e.g. 
<code>file =</code>‘<code>C:\\myboots.txt</code>’, the matrix with bootstrap estimates are copied into a tab-separated text-file 
providing extra backup. Bootstrapping is done by simulating new sets of observations conditioned on the observed number of 
species (see <code>rbipoilog</code>).
</p>


<h3>Value</h3>

<table>
<tr style="vertical-align: top;">
<td><code>par </code></td>
<td>
<p>Maximum likelihood estimates of the parameters</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>p </code></td>
<td>
<p>Approximate fraction of species revealed by the samples for sample 1 and 2 respectively</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>logLval </code></td>
<td>
<p>Log likelihood of the data given the estimated parameters</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>gof </code></td>
<td>
<p>Goodness of fit measure obtained by checking the rank of logLval against logLval's obtained 
during the bootstrap procedure, (<code>gof</code> &lt; 0.05) or (<code>gof</code> &gt; 0.95) indicates lack of fit</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>boot </code></td>
<td>
<p>A data frame containing the bootstrap replicates of parameters and logLval</p>
</td>
</tr>
</table>
<h3>Author(s)</h3>

<p> Vidar Grotan <a href="mailto:vidar.grotan@ntnu.no">vidar.grotan@ntnu.no</a>, Steinar Engen   </p>


<h3>References</h3>

 
<p>Engen, S., R. Lande, T. Walla and P. J. DeVries. 2002. Analyzing spatial structure of communities using the two-dimensional 
Poisson lognormal species abundance model. American Naturalist <b>160</b>, 60-73.</p>


<h3>See Also</h3>

 <p><code>optim</code>, <code>dbipoilog</code>, <code>rbipoilog</code>  </p>


<h3>Examples</h3>

<pre><code class="language-R">
## simulate observations
xy  &lt;- rbipoilog(S=30,mu1=1,mu2=1,sig1=2,sig2=2,rho=0.5)

## obtain estimates of parameters
est &lt;- bipoilogMLE(xy)

## change start values and request tracing information 
## from optimization procedure
## Not run: est &lt;- bipoilogMLE(xy,startVals=c(2,2,4,4,0.3),
       control=list(maxit=1000,trace=1, REPORT=1))
## End(Not run)

## effect of sampling intensity 
xy  &lt;- rbipoilog(S=100,mu1=1,mu2=1,sig1=2,sig2=2,rho=0.5,nu1=0.5,nu2=0.5)
## Not run: est &lt;- bipoilogMLE(xy)
## the expected estimates of mu1 and mu2 are now 1-log(0.5) = 0.3 (approximately) 


</code></pre>


</div>