<div class="container">

<table style="width: 100%;"><tr>
<td>lagfit</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>Fits a piecewise glm model with lags</h2>

<h3>Description</h3>

<p>This function fits a piecewise poisson model to the frequency data of different Species. It assumes that the data
contains columns Year, Frequency and Specimens.
</p>


<h3>Usage</h3>

<pre><code class="language-R">lagfit(
  data,
  yeardata,
  species = NULL,
  knots = NULL,
  zeros = TRUE,
  plotlag = FALSE,
  plotfreq = FALSE
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>data</code></td>
<td>
<p>a dataframe containing the columns Species (optional), Year, Frequency and Specimens.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>yeardata</code></td>
<td>
<p>a dataframe containing the columns Year and Specimens giving the total number of Specimens for each Year.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>species</code></td>
<td>
<p>list of species for which the model is to be fitted. Default is NULL, which fits the model for all species in the data.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>knots</code></td>
<td>
<p>a list of knots to be used for the piecewise model. Default is NULL, which chooses the optimal model with 0-4 knots.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>zeros</code></td>
<td>
<p>logical. Specifies whether missing year for the species will be filled with zeros. Default is TRUE.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>plotlag</code></td>
<td>
<p>logical. If TRUE a plot of the fitted model will be produced for each species.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>plotfreq</code></td>
<td>
<p>logical. If TRUE frquency plots will be created for each species.</p>
</td>
</tr>
</table>
<h3>Value</h3>

<p>If the model is fit for a single species following are returned as a list
</p>

<ul>
<li>
<p> Species - Species name
</p>
</li>
<li>
<p> Scene - Different scenario of the fit between the knots. A sequence of 0, + or - is returned. A 0 indicates constant, + indicates increasing and a - indicates decreasing.
</p>
</li>
<li>
<p> Lag - Logical. Is there a lag present or not.
</p>
</li>
<li>
<p> Laglength - Length of the first lag. Position of the First Knot - the first year for that species
</p>
</li>
<li>
<p> FirstYear - The first year for that species for which data is available.
</p>
</li>
<li>
<p> EndYear - The first knot position.
</p>
</li>
<li>
<p> fit - the fitted model.
</p>
</li>
</ul>
<p>If the number of species is more than one, then a list is returned with following items:
</p>

<ul>
<li>
<p>  fitdata - dataframe is returned with the items in the above list except for the fitted model.
</p>
</li>
<li>
<p>  fitcoefs - list of coefficients for the piecewise fits for each Species
</p>
</li>
</ul>
<h3>Examples</h3>

<pre><code class="language-R">#Run lagfit for 1 species only
Species = unique(fdata$Species) #List of all species

fit1 = lagfit(fdata, yeardata, species=Species[1])
#Run lagfit for multiple species
fit2 = lagfit(fdata, yeardata, species=Species[1:3])
fitdata = fit2$fitdata  #Dataframe containing fits
fitcoefs = fit2$fitcoefs #List containing slopes of the fitted splines

## Not run: 
#Run lagfit for the whole dataset
fitall = lagfit(fdata, yeardata)

## End(Not run)
</code></pre>


</div>