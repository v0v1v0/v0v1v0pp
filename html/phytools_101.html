<div class="container">

<table style="width: 100%;"><tr>
<td>fancyTree</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>Plots special types of phylogenetic trees</h2>

<h3>Description</h3>

<p>Plots phylogenies (or phylogenetic trees and comparative data) in a variety of different styles.
</p>


<h3>Usage</h3>

<pre><code class="language-R">fancyTree(tree, type=c("extinction","traitgram3d","droptip","densitymap",
   "contmap","phenogram95","scattergram"), ..., control=list())
phyloScattergram(tree, X=NULL, ...)
phenogram95(tree, x=NULL, ...)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>tree</code></td>
<td>
<p>an object of class <code>"phylo"</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>type</code></td>
<td>
<p>the type of special plot to create. See Description.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>...</code></td>
<td>
<p>arguments to be passed to different methods. See Description.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>control</code></td>
<td>
<p>a list of control parameters, depending on <code>type</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>X</code></td>
<td>
<p>in <code>phyloScattergram</code>, a matrix of continuous trait values. Row names in the matrix should correspond to species names in the tree.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>x</code></td>
<td>
<p>in <code>phenogram95</code>, a named vector with values for a continuously distributed trait.</p>
</td>
</tr>
</table>
<h3>Details</h3>

<p>This function plots a phylogeny or phylogenetic tree and comparative data in a variety of different styles, depending on the value of <code>type</code>. In some instances, <code>fancyTree</code> is now just a wrappe for other <span class="pkg">phytools</span> functions, such as <code>contMap</code> and <code>densityMap</code>.
</p>
<p>If <code>type="extinction"</code> (or any unambiguous abbreviation) the function will plot a tree in which branches preceding the MRCA of all extant taxa and branches leading only to extinct lineages are plotted with dashed red lines. 
</p>
<p>If <code>type="traitgram3d"</code> the function will plot a three dimensional traitgram (that is, a projection of the tree into three dimensional morphospace where two dimensions are the phenotypic trait and the third axis is time since the root). In this case, the additional argument <code>X</code>, a matrix containing the tip values of all species (with species IDs as row names) should be supplied. Optionally, the user can also supply the matrix <code>A</code>, which contains the ancestral states in the tree with rows labeled by node number. 
</p>
<p>If <code>type="droptip"</code> the function will create a two panel figure in which the first panel is the tree with lineages to be pruned highlighted; and the second panel is the pruned tree. In this case, the additional argument <code>tip</code>, the tip name or vector of tip names to be dropped, must be supplied. 
</p>
<p>If <code>type="densitymap"</code>, a posterior probability density "heat-map" is created based on a set of trees in a <code>"multiSimmap"</code> object containing a binary [0,1] mapped character. (See <code>densityMap</code> for additional optional arguments if <code>type="densitymap"</code>.)
</p>
<p>If <code>type="contmap"</code>, reconstructed continuous trait evolution is mapped on the tree. Again, see <code>contMap</code> for additional arguments if <code>type="contmap"</code>.
</p>
<p>If <code>type="phenogram95"</code> a 95% traitgram (aka. "phenogram") is plotted using transparency to visualize uncertainty at ancestral nodes and along branches. Most of the options of <code>phenogram</code> are available. 
</p>
<p>Finally, if <code>type="scattergram"</code> a phylogenetic scatter plot matrix containing <code>contMap</code> style trees on the diagonal and <code>phylomorphospace</code> plots in non-diagonal panels is produced. For this type a trait matrix <code>X</code> must also be supplied. The only additional arguments available for this type are <code>ftype</code>, <code>fsize</code>, <code>colors</code>, and <code>label</code>. (See <code>phylomorphospace</code> for details on how these arguments should be used.) This function calls <code>phyloScattergram</code> (which is also now exported to the name space) internally. In addition to creating a plot, <code>phyloScattergram</code> also returns an object of class <code>"phyloScattergram"</code> which can be replotted using different options if desired.
</p>
<p>Presently only <code>type="traitgram3d"</code> uses the list <code>control</code> which can be supplied the same set of control parameters as <code>phylomorphospace3d</code>, as well as the control parameter <code>maxit</code> which will be passed to <code>anc.ML</code>. 
</p>
<p>Finally, the optional argument <code>hold</code> will be passed to multiple methods if supplied. It is a logical value that indicates whether or not the output to the graphical device should be held using <code>dev.hold</code> before plotting (defaults to <code>hold=TRUE</code>).
</p>


<h3>Value</h3>

<p>This function plots different types of phylogenetic trees. For <code>type="droptip"</code> the function also returns the pruned tree.
</p>


<h3>Author(s)</h3>

<p>Liam Revell <a href="mailto:liam.revell@umb.edu">liam.revell@umb.edu</a></p>


<h3>References</h3>

<p>Evans, M. E. K., Smith, S. A., Flynn, R. S., Donoghue, M. J. (2009) Climate, niche evolution, and diversification of the "bird-cage" evening primroses (Oenothera, sections Anogra and Kleinia). <em>American Naturalist</em>, <b>173</b>, 225-240.
</p>
<p>Revell, L. J. (2013) Two new graphical methods for mapping trait evolution on phylogenies. <em>Methods in Ecology and Evolution</em>, <b>4</b>, 754-759.
</p>
<p>Revell, L. J. (2014) Graphical methods for visualizing comparative data on phylogenies. Chapter 4 in <em>Modern phylogenetic comparative methods and their application in evolutionary biology: Concepts and practice</em> (L. Z. Garamszegi ed.), pp. 77-103.
</p>
<p>Revell, L. J. (2024) phytools 2.0: an updated R ecosystem for phylogenetic comparative methods (and other things). <em>PeerJ</em>, <b>12</b>, e16505.
</p>


<h3>See Also</h3>

<p><code>contMap</code>, <code>densityMap</code>, <code>drop.tip</code>, <code>phenogram</code>, <code>phylomorphospace3d</code>, <code>plot.phylo</code>, <code>plotSimmap</code>
</p>


<h3>Examples</h3>

<pre><code class="language-R">## plot tree with extinction
set.seed(10)
tree&lt;-pbtree(b=1,d=0.4,t=4)
fancyTree(tree,type="extinction")

## Not run: 
## plot 3D traitgram
## load data from Revell &amp; Collar (2009)
data(sunfish.tree)
data(sunfish.data)
fancyTree(sunfish.tree,type="traitgram3d",
  X=sunfish.data[,2:3],
  control=list(spin=FALSE))
## End(Not run)
	
## plot with dropped tips
tree&lt;-pbtree(n=30)
tips&lt;-sample(tree$tip.label)[1:10]
pruned&lt;-fancyTree(tree,type="droptip",tip=tips)
par(mfrow=c(1,1)) ## reset mfrow to default

## Not run: 
## plot 95-percent CI phenogram
data(mammal.tree)
data(mammal.data)
bodyMass&lt;-setNames(mammal.data$bodyMass,
  rownames(mammal.data))
fancyTree(mammal.tree,type="phenogram95",x=bodyMass,
  fsize=0.7,ftype="i")
## End(Not run)

par(mar=c(5.1,4.1,4.1,2.1)) ## reset mar to defaults
</code></pre>


</div>