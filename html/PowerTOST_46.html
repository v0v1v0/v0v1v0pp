<div class="container">

<table style="width: 100%;"><tr>
<td>power.noninf</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>
Power of the one-sided non-inferiority t-test
</h2>

<h3>Description</h3>

<p>Function calculates of the power of the one-sided non-inferiority <em>t</em>-test
for normal or log-normal distributed data.
</p>


<h3>Usage</h3>

<pre><code class="language-R">power.noninf(alpha = 0.025, logscale = TRUE, margin, theta0, CV, n, 
             design = "2x2", robust = FALSE)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>alpha</code></td>
<td>

<p>Significance level (one-sided). Defaults here to 0.025.
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>logscale</code></td>
<td>

<p>Should the data used on log-transformed or on original scale? <code>TRUE</code> (default) or <code>FALSE</code>.
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>theta0</code></td>
<td>

<p>‘True’ or assumed T/R ratio or difference.<br>
In case of <code>logscale=TRUE</code> it must be given as ratio T/R.<br>
If <code>logscale=FALSE</code>, the difference in means. In this case, the difference may be expressed in two ways: relative to the same (underlying) reference mean, i.e. as (T-R)/R = T/R - 1; or as difference in means T-R. Note that in the former case the units of <code>margin</code> and <code>CV</code> need also be given relative to the reference mean (specified as ratio).<br>
Defaults to 0.95 if <code>logscale=TRUE</code> or to -0.05 if <code>logscale=FALSE</code>
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>margin</code></td>
<td>

<p>Non-inferiority margin.<br>
In case of <code>logscale=TRUE</code> it is given as ratio.<br>
If <code>logscale=FALSE</code>, the limit may be expressed in two ways:
difference of means relative to the same (underlying) reference mean or in units of the difference of means.
Note that in the former case the units of <code>CV</code> and <code>theta0</code> need also be given relative to the reference mean (specified as ratio).<br>
Defaults to 0.8 if <code>logscale=TRUE</code> or to -0.2 if <code>logscale=FALSE</code>.
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>CV</code></td>
<td>

<p>In case of <code>logscale=TRUE</code> the (geometric) coefficient of variation given as ratio.<br>
If <code>logscale=FALSE</code> the argument refers to (residual) standard deviation of the response. In this case, standard deviation may be expressed two ways: relative to a reference mean (specified as ratio sigma/muR), i.e. again as a coefficient of variation; or untransformed, i.e. as standard deviation of the response. Note that in the former case the units of <code>theta0</code>, <code>theta1</code> and <code>theta2</code> need also be given relative to the reference mean (specified as ratio).<br></p>
<p>In case of cross-over studies this is the within-subject CV, in case of a parallel-group design the CV of the total variability.
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>n</code></td>
<td>

<p>Number of subjects under study.<br>
Is total number if given as scalar, else number of subjects in the (sequence) 
groups. In the latter case the length of the <code>n</code> vector has to be equal to the 
number of (sequence) groups.
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>design</code></td>
<td>

<p>Character string describing the study design.<br>
See <code>known.designs</code> for designs covered in this package.
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>robust</code></td>
<td>

<p>Defaults to <code>FALSE</code>. With that value the usual degrees of freedom will be used.<br>
Set to <code>TRUE</code> will use the degrees of freedom according to the ‘robust’ evaluation
(aka Senn’s basic estimator). These degrees of freedom are calculated as <code>n-seq</code>.<br>
See <code>known.designs()$df2</code> for designs covered in this package.<br>
Has only effect for higher-order crossover designs.
</p>
</td>
</tr>
</table>
<h3>Details</h3>

<p>The power is calculated exact via non-central <em>t</em>-distribution.<br></p>
<p><strong>Notes on the underlying hypotheses</strong><br>
If the supplied margin is &lt; 0 (<code>logscale=FALSE</code>) or &lt; 1 (<code>logscale=TRUE</code>), 
then it is assumed higher response values are better. The hypotheses are<br><code style="white-space: pre;">⁠  H0: theta0 &lt;= margin vs. H1: theta0 &gt; margin⁠</code><br>
where <code>theta0 = mean(test)-mean(reference)</code> if <code>logscale=FALSE</code><br>
or<br><code style="white-space: pre;">⁠  H0: log(theta0) &lt;= log(margin) vs. H1: log(theta0) &gt; log(margin)⁠</code><br>
where <code>theta0 = mean(test)/mean(reference)</code> if <code>logscale=TRUE</code>.<br></p>
<p>If the supplied margin is &gt; 0 (<code>logscale=FALSE</code>) or &gt; 1 (<code>logscale=TRUE</code>), 
then it is assumed lower response values are better. The hypotheses are<br><code style="white-space: pre;">⁠  H0: theta0 &gt;= margin vs. H1: theta0 &lt; margin⁠</code><br>
where <code>theta0 = mean(test)-mean(reference)</code> if <code>logscale=FALSE</code><br>
or<br><code style="white-space: pre;">⁠  H0: log(theta0) &gt;= log(margin) vs. H1: log(theta0) &lt; log(margin)⁠</code><br>
where <code>theta0 = mean(test)/mean(reference)</code> if <code>logscale=TRUE</code>.<br>
This latter case may also be considered as ‘non-superiority’.
</p>


<h3>Value</h3>

<p>Value of power according to the input arguments.
</p>


<h3>Warning </h3>

<p>The function does not vectorize if design is a vector.<br>
The function vectorize properly if CV or theta0 are vectors.<br>
Other vector input is not tested yet.
</p>


<h3>Note</h3>

<p>This function does not rely on TOST but may be useful in planning BE studies 
if the question is not equivalence but ‘non-superiority’.<br>
Hint: Evaluation of Fluctuation in the <a href="https://www.ema.europa.eu/en/documents/scientific-guideline/note-guidance-modified-release-oral-and-transdermal-dosage-forms-section-ii-pharmacokinetic-and-clinical-evaluation-superseded_en.pdf">EMEA’s Note for Guidance</a> between a modified release 
formulation and an immediate release product.
</p>


<h3>Author(s)</h3>

<p>D. Labes
</p>


<h3>References</h3>

<p>Julious SA. <em>Sample sizes for clinical trials with Normal data.</em> Stat Med. 2004;23(12):1921–86. <a href="https://doi.org/10.1002/sim.1783">doi:10.1002/sim.1783</a>
</p>


<h3>See Also</h3>

<p><code>known.designs, sampleN.noninf</code>
</p>


<h3>Examples</h3>

<pre><code class="language-R"># using all the defaults: margin=0.8, theta0=0.95, alpha=0.025
# log-transformed, design="2x2"
# should give: 0.4916748
power.noninf(CV=0.3, n=24)
</code></pre>


</div>