<div class="container">

<table style="width: 100%;"><tr>
<td>rotate_tunnel</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>Rotate a tunnel so that perches are approximately aligned</h2>

<h3>Description</h3>

<p>The rotation is applied about the height axis and affects tunnel length and
width only, i.e. no rotation of height.
</p>


<h3>Usage</h3>

<pre><code class="language-R">rotate_tunnel(
  obj_name,
  all_heights_min = 0.11,
  all_heights_max = 0.3,
  perch1_len_min = -0.06,
  perch1_len_max = 0.06,
  perch2_len_min = 2.48,
  perch2_len_max = 2.6,
  perch1_wid_min = 0.09,
  perch1_wid_max = 0.31,
  perch2_wid_min = 0.13,
  perch2_wid_max = 0.35,
  ...
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>obj_name</code></td>
<td>
<p>The input viewr object; a tibble or data.frame with attribute
<code>pathviewr_steps</code> that includes <code>"viewr"</code> that has been passed
through <code>relabel_viewr_axes()</code> and <code>gather_tunnel_data()</code> (or is
structured as though it has been passed through those functions).</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>all_heights_min</code></td>
<td>
<p>Minimum perch height</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>all_heights_max</code></td>
<td>
<p>Maximum perch height</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>perch1_len_min</code></td>
<td>
<p>Minimum length value of perch 1</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>perch1_len_max</code></td>
<td>
<p>Maximum length value of perch 1</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>perch2_len_min</code></td>
<td>
<p>Minimum length value of perch 2</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>perch2_len_max</code></td>
<td>
<p>Maximum length value of perch 2</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>perch1_wid_min</code></td>
<td>
<p>Minimum width value of perch 1</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>perch1_wid_max</code></td>
<td>
<p>Maximum width value of perch 1</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>perch2_wid_min</code></td>
<td>
<p>Minimum width value of perch 2</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>perch2_wid_max</code></td>
<td>
<p>Maximum width value of perch 2</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>...</code></td>
<td>
<p>Additional arguments passed to/from other pathviewr functions</p>
</td>
</tr>
</table>
<h3>Details</h3>

<p>The user first estimates the locations of the perches by specifying
bounds for where each perch is located. The function then computes the
center of each bounding box and estimates that to be the midpoint of each
perch. Then the center point of the tunnel (center between the perch
midpoints) is estimated. The angle between perch1_center,
tunnel_center_point, and arbitrary point along the length axis
(tunnel_center_point - 1 on length) is estimated. That angle is then used
to rotate the data, again only in the length and width dimensions. Height
is standardized by (approximate) perch height; values greater than 0 are
above the perch and values less than 0 are below the perch level.
</p>


<h3>Value</h3>

<p>A viewr object (tibble or data.frame with attribute
<code>pathviewr_steps</code> that includes <code>"viewr"</code>) in which data have
been rotated according to user specifications.
</p>


<h3>Author(s)</h3>

<p>Vikram B. Baliga
</p>


<h3>See Also</h3>

<p>Other data cleaning functions: 
<code>gather_tunnel_data()</code>,
<code>get_full_trajectories()</code>,
<code>quick_separate_trajectories()</code>,
<code>redefine_tunnel_center()</code>,
<code>relabel_viewr_axes()</code>,
<code>rename_viewr_characters()</code>,
<code>select_x_percent()</code>,
<code>separate_trajectories()</code>,
<code>standardize_tunnel()</code>,
<code>trim_tunnel_outliers()</code>,
<code>visualize_frame_gap_choice()</code>
</p>
<p>Other tunnel standardization functions: 
<code>redefine_tunnel_center()</code>,
<code>standardize_tunnel()</code>
</p>


<h3>Examples</h3>

<pre><code class="language-R">## Import the example Motive data included in the package
motive_data &lt;-
  read_motive_csv(system.file("extdata", "pathviewr_motive_example_data.csv",
                              package = 'pathviewr'))

## Clean the file. It is generally recommended to clean up to the
## "trimmed" step before running rotate_tunnel().
motive_trimmed &lt;-
  motive_data %&gt;%
  relabel_viewr_axes() %&gt;%
  gather_tunnel_data() %&gt;%
  trim_tunnel_outliers()

## Now rotate the tunnel using default values
motive_rotated &lt;-
  motive_trimmed %&gt;%
  rotate_tunnel()

## The following attributes store information about
## how rotation &amp; translation was applied
attr(motive_rotated, "rotation_degrees")
attr(motive_rotated, "rotation_radians")
attr(motive_rotated, "perch1_midpoint_original")
attr(motive_rotated, "perch1_midpoint_current")
attr(motive_rotated, "tunnel_centerpoint_original")
attr(motive_rotated, "perch2_midpoint_original")
attr(motive_rotated, "perch2_midpoint_current")
</code></pre>


</div>