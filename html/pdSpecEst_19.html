<div class="container">

<table style="width: 100%;"><tr>
<td>pdRankTests</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>Rank-based hypothesis tests for HPD matrices</h2>

<h3>Description</h3>

<p><code>pdRankTests</code> performs a number of generalized rank-based hypothesis tests in the metric space of HPD matrices equipped
with the affine-invariant Riemannian metric or Log-Euclidean metric for samples of HPD matrices or samples of sequences
(curves) of HPD matrices as described in Chapter 4 of (Chau 2018).
</p>


<h3>Usage</h3>

<pre><code class="language-R">pdRankTests(data, sample_sizes, test = c("rank.sum", "krusk.wall",
  "signed.rank", "bartels"), depth = c("gdd", "zonoid", "spatial"),
  metric = c("Riemannian", "logEuclidean"))
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>data</code></td>
<td>
<p>either a <code class="reqn">(d,d,S)</code>-dimensional array corresponding to an array of pooled individual samples of <code class="reqn">(d,d)</code>-dimensional
HPD matrices, or a <code class="reqn">(d,d,n,S)</code>-dimensional array corresponding to an array of pooled individual samples of length <code class="reqn">n</code> sequences
of <code class="reqn">(d,d)</code>-dimensional HPD matrices.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>sample_sizes</code></td>
<td>
<p>a numeric vector specifying the individual sample sizes in the pooled sample <code>data</code>, such that <code>sum(sample_sizes)</code> is
equal to <code>S</code>. Not required for tests <code>"signed-rank"</code> and <code>"bartels"</code>, as the sample sizes are automatically determined from the input array
<code>data</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>test</code></td>
<td>
<p>rank-based hypothesis testing procedure, one of <code>"rank.sum"</code>, <code>"krusk.wall"</code>, <code>"signed.rank"</code>, <code>"bartels"</code> explained
in the Details section below.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>depth</code></td>
<td>
<p>data depth measure used in the rank-based tests, one of <code>"gdd"</code>, <code>"zonoid"</code>, or <code>"spatial"</code> corresponding to the
geodesic distance depth, intrinsic zonoid depth and intrinsic spatial depth respectively. Defaults to <code>"gdd"</code>. Not required for test
<code>"signed.rank"</code>. See the documentation of the function <code>pdDepth</code> for additional details about the different depth measures.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>metric</code></td>
<td>
<p>the metric that the space of HPD matrices is equipped with, either <code>"Riemannian"</code> or <code>"logEuclidean"</code>. Defaults to
<code>"Riemannian"</code>.</p>
</td>
</tr>
</table>
<h3>Details</h3>

<p>For samples of <code class="reqn">(d,d)</code>-dimensional HPD matrices with pooled sample size <code class="reqn">S</code>, the argument
<code>data</code> is a <code class="reqn">(d,d,S)</code>-dimensional array of <code class="reqn">(d,d)</code>-dimensional HPD matrices, where the individual samples are
combined along the third array dimension. For samples of sequences of <code class="reqn">(d,d)</code>-dimensional HPD matrices with pooled sample
size <code class="reqn">S</code>, the argument <code>data</code> is a <code class="reqn">(d,d,n,S)</code>-dimensional array of length <code class="reqn">n</code> sequences
of <code class="reqn">(d,d)</code>-dimensional HPD matrices, where the individual samples are combined along the fourth array dimension. The argument
<code>sample_sizes</code> specifies the sizes of the individual samples so that <code>sum(sample_sizes)</code> is equal to <code>S</code>. <br>
The available generalized rank-based testing procedures (specified by the argument <code>test</code>) are:
</p>

<dl>
<dt><code>"rank.sum"</code></dt>
<dd>
<p>Intrinsic Wilcoxon rank-sum test to test for homogeneity of distributions of two independent
samples of HPD matrices or samples of sequences of HPD matrices. The usual univariate ranks are replaced by data depth
induced ranks obtained with <code>pdDepth</code>.</p>
</dd>
<dt><code>"krusk.wall"</code></dt>
<dd>
<p>Intrinsic Kruskal-Wallis test to test for homogeneity of distributions of more than two independent
samples of HPD matrices or samples of sequences of HPD matrices. The usual univariate ranks are replaced by data depth
induced ranks obtained with <code>pdDepth</code>.</p>
</dd>
<dt><code>"signed.rank"</code></dt>
<dd>
<p>Intrinsic signed-rank test to test for homogeneity of distributions of independent paired or matched samples
of HPD matrices. The intrinsic signed-rank test is <em>not</em> based on data depth induced ranks, but on a specific difference score in the Riemannian
manifold of HPD matrices equipped with either the affine-invariant Riemannian or Log-Euclidean metric.</p>
</dd>
<dt><code>"bartels"</code></dt>
<dd>
<p>Intrinsic Bartels-von Neumann test to test for randomness (i.e., exchangeability) within a single independent sample of
HPD matrices or a sample of sequences of HPD matrices. The usual univariate ranks are replaced by data depth induced
ranks obtained with <code>pdDepth</code>.</p>
</dd>
</dl>
<p>The function computes the generalized rank-based test statistics in the <em>complete</em> metric space of HPD matrices equipped with one of the following metrics:
(i) the Riemannian metric (default) as detailed in e.g., (Bhatia 2009)[Chapter 6] or (Pennec et al. 2006); or (ii) the Log-Euclidean metric,
the Euclidean inner product between matrix logarithms. The default Riemannian metric is invariant under congruence transformation by any invertible matrix,
whereas the Log-Euclidean metric is only invariant under congruence transformation by unitary matrices, see (Chau 2018)[Chapter 4] for more details.
</p>


<h3>Value</h3>

<p>The function returns a list with five components:
</p>
<table>
<tr style="vertical-align: top;">
<td><code>test </code></td>
<td>
<p>name of the rank-based test</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>p.value </code></td>
<td>
<p>p-value of the test</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>statistic </code></td>
<td>
<p>computed test statistic</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>null.distr </code></td>
<td>
<p>distribution of the test statistic under the null hypothesis</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>depth.values </code></td>
<td>
<p>computed data depth values (if available)</p>
</td>
</tr>
</table>
<h3>Note</h3>

<p>The intrinsic signed-rank test also provides a valid test for equivalence of spectral matrices of two multivariate stationary time
series based on the HPD periodogram matrices obtained via <code>pdPgram</code>, see (Chau 2018)[Chapter 4] for the details.
</p>
<p>The function does not check for positive definiteness of the input matrices, and may fail
if matrices are close to being singular.
</p>
<p>The data depth computations under the Riemannian metric are more involved than under the Log-Euclidean
metric, and may therefore result in (significantly) higher computation times.
</p>


<h3>References</h3>

<p>Bhatia R (2009).
<em>Positive Definite Matrices</em>.
Princeton University Press, New Jersey.<br><br> Chau J (2018).
<em>Advances in Spectral Analysis for Multivariate, Nonstationary and Replicated Time Series</em>.
phdthesis, Universite catholique de Louvain.<br><br> Pennec X, Fillard P, Ayache N (2006).
“A Riemannian framework for tensor computing.”
<em>International Journal of Computer Vision</em>, <b>66</b>(1), 41–66.
</p>


<h3>See Also</h3>

<p><code>pdDepth</code>, <code>pdPgram</code>
</p>


<h3>Examples</h3>

<pre><code class="language-R">## null hypothesis is true
data &lt;- replicate(100, Expm(diag(2), H.coeff(rnorm(4), inverse = TRUE)))
pdRankTests(data, sample_sizes = c(50, 50), test = "rank.sum") ## homogeneity 2 samples
pdRankTests(data, sample_sizes = rep(25, 4), test = "krusk.wall") ## homogeneity 4 samples
pdRankTests(data, test = "bartels") ## randomness

## null hypothesis is false
data1 &lt;- array(c(data, replicate(50, Expm(diag(2), H.coeff(0.5 * rnorm(4), inverse = TRUE)))),
                 dim = c(2,2,150))
pdRankTests(data1, sample_sizes = c(100, 50), test = "rank.sum")
pdRankTests(data1, sample_sizes = rep(50, 3), test = "krusk.wall")
pdRankTests(data1, test = "bartels")

## Not run: 
## signed-rank test for equivalence of spectra of multivariate time series
## ARMA(1,1) process: Example 11.4.1 in (Brockwell and Davis, 1991)
Phi &lt;- array(c(0.7, 0, 0, 0.6, rep(0, 4)), dim = c(2, 2, 2))
Theta &lt;- array(c(0.5, -0.7, 0.6, 0.8, rep(0, 4)), dim = c(2, 2, 2))
Sigma &lt;- matrix(c(1, 0.71, 0.71, 2), nrow = 2)
pgram &lt;- function(Sigma) pdPgram(rARMA(2^8, 2, Phi, Theta, Sigma)$X)$P

## null is true
pdRankTests(array(c(pgram(Sigma), pgram(Sigma)), dim = c(2,2,2^8)), test = "signed.rank")
## null is false
pdRankTests(array(c(pgram(Sigma), pgram(0.5 * Sigma)), dim = c(2,2,2^8)), test = "signed.rank")

## End(Not run)
</code></pre>


</div>