<div class="container">

<table style="width: 100%;"><tr>
<td>continuumRemoval</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>Continuum Removal</h2>

<h3>Description</h3>

<a href="https://www.tidyverse.org/lifecycle/#maturing"><img src="figures/lifecycle-maturing.svg" alt="Maturing lifecycle"></a>
<p>Compute the continuum removed values of a data matrix or vector
</p>


<h3>Usage</h3>

<pre><code class="language-R">continuumRemoval(X, wav, type = c("R", "A"),
                 interpol = c("linear", "spline"),
                 method = c("division", "substraction"))
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>X</code></td>
<td>
<p>a numeric matrix or vector to process (optionally a data frame that can
be coerced to a numerical matrix).</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>wav</code></td>
<td>
<p>optional. A numeric vector of band positions.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>type</code></td>
<td>
<p>the type of data: 'R' for reflectance (default), 'A' for
absorbance.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>interpol</code></td>
<td>
<p>the interpolation method between points on the convex hull:
'linear' (default) or 'spline'.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>method</code></td>
<td>
<p>normalization method: 'division' (default) or 'subtraction'
(see details section).</p>
</td>
</tr>
</table>
<h3>Details</h3>

<p>The continuum removal technique was introduced by Clark and Roush (1984)
as a method to highlight energy absorption features of minerals.
It can be viewed as a way to perform albedo normalization.
The algorithm find points lying on the convex hull (local maxima or envelope)
of a spectrum, connects the points by linear or spline interpolation and
normalizes the spectrum by dividing (or subtracting) the input data by the
interpolated line.
</p>


<h3>Value</h3>

<p>a matrix or vector with the filtered spectra.
</p>


<h3>Author(s)</h3>

<p>Antoine Stevens &amp; <a href="https://orcid.org/0000-0002-5369-5120">Leonardo Ramirez-Lopez</a>
</p>


<h3>References</h3>

<p>Clark, R.N., and Roush, T.L., 1984. Reflectance Spectroscopy: Quantitative
Analysis Techniques for Remote Sensing Applications. J. Geophys. Res. 89,
6329-6340.
</p>


<h3>See Also</h3>

<p><code>savitzkyGolay</code>, <code>movav</code>,
<code>gapDer</code>, <code>binning</code>
</p>


<h3>Examples</h3>

<pre><code class="language-R">data(NIRsoil)
wav &lt;- as.numeric(colnames(NIRsoil$spc))
# plot of the 10 first abs spectra
matplot(wav,
  t(NIRsoil$spc[1:10, ]),
  type = "l",
  ylim = c(0, .6),
  xlab = "Wavelength /nm",
  ylab = "Abs"
)
#  # type = 'A' is used for absorbance spectra
cr &lt;- continuumRemoval(NIRsoil$spc, wav, type = "A")
matlines(wav, t(cr[1:10, ]))
</code></pre>


</div>