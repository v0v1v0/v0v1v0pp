<div class="container">

<table style="width: 100%;"><tr>
<td>sim.phy</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>Simulate phylogenies</h2>

<h3>Description</h3>

<p>Simulate phylogenies under pure birth/death or as a function of
trait evolution
</p>


<h3>Usage</h3>

<pre><code class="language-R">sim.bd.phy(speciate = 0.1, extinction = 0.025, time.steps = 20)

sim.bd.tr.phy(
  speciate = 0.1,
  extinction = 0.025,
  time.steps = 20,
  tr.range = c(0, 1),
  sp.tr = 2,
  ext.tr = 1,
  tr.walk = 0.2,
  tr.wrap = TRUE
)

edge2phylo(edge, s, e = numeric(0), el = NA, t = NULL)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>speciate</code></td>
<td>
<p>probability each species will speciate in each
time-step (0-1)</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>extinction</code></td>
<td>
<p>probability each species will go extinct in each
time-step (0-1)</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>time.steps</code></td>
<td>
<p>number of time-steps for simulation</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>tr.range</code></td>
<td>
<p>vector of length two specifying boundaries for
trait values (see notes); initial two species will be at the 25th
and 75th percentiles of this space. See also <code>tr.wrap</code></p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>sp.tr</code></td>
<td>
<p>speciation rate's interaction with the minimum
distance between a species and the species most similar to it (see
details)</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>ext.tr</code></td>
<td>
<p>extinction rate's interaction with the minimum
distance between a species and the species most similar to it (see
details)</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>tr.walk</code></td>
<td>
<p>at each time-step a species not undergoing
speciation or extinction has its trait value drawn from a
distribution centered at its current value and with a standard
deviation set by this value. I.e., this is the rate of the Brownian
motion trait evolution.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>tr.wrap</code></td>
<td>
<p>whether to force species' trait values to stay
within the boundary defined by <code>tr.range</code>; default TRUE.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>edge</code></td>
<td>
<p>a two-column matrix where the first column is the start
node, the second the destination, as in
<code>phylo$edge</code></p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>s</code></td>
<td>
<p>which of the rows in the edge matrix represent
extant species</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>e</code></td>
<td>
<p>which of the tips in the edge matrix are extinct
(DEFAULT: empty vector, i.e., none)</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>el</code></td>
<td>
<p>a vector to be used to give edge.length to the
phylogeny (default NA, i.e., none)</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>t</code></td>
<td>
<p>if given (default NA), a vector to be used for traits
(<code>$traits</code> slot) in the phylogeny</p>
</td>
</tr>
</table>
<h3>Details</h3>

<p><code>sim.bd.tree</code> simulates a pure birth/death speciation
model. There are two important things to note: (1) speciation is
randomised before extinction, and only one thing can happen to a
lineage per timestep. (2) This code works well for my purposes, but
absurd parameter values can cause the function to crash.
</p>
<p><code>sim.bd.tr.tree</code> is an extension of <code>sim.bd.tree</code>, and
all its caveats apply to it. It additionally simulated the
evolution of a trait under Brownain motion
(<code>tr.walk</code>). Species' speciation/extinction rates change
depending on whether they have a trait value similar to other
species (<code>sp.tr</code>, <code>ext.tr</code>). When a speciation event
happens, the two daughters split evenly about the ancestor's trait
value, taking values half-way to whatever the nearest species'
value is. To be precise: <code class="reqn">p(speciate)_i = speciate_i + sp.tr
\times min(trait distance)</code>, <code class="reqn">p(extinct)_i = exinction_i + ext.tr
\times min(trait distance)</code>, where <code class="reqn">i</code> denotes each species.
</p>
<p><code>edge2phylo</code> is an internal function for the
<code>sim.phy</code> and <code>sim.meta</code> function families,
which may be of use to you. Check those functions' code for
examples of use.
</p>
<p>These functions are closely related to <code>sim.meta</code>; the
latter are extensions that simulate meta-community structure at the
same time.
</p>


<h3>Value</h3>

<p><code>phylo</code> object with random
tip.labels, and trait values if using <code>sim.br.tr.tree</code>.
</p>


<h3>Author(s)</h3>

<p>Will Pearse
</p>
<p>Will Pearse
</p>
<p>Will Pearse
</p>


<h3>See Also</h3>

<p>sim.meta scape
</p>


<h3>Examples</h3>

<pre><code class="language-R">tree &lt;- sim.bd.phy(0.1, 0, 10)
plot(tree)
</code></pre>


</div>