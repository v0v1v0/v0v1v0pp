<div class="container">

<table style="width: 100%;"><tr>
<td>rebalance</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>
Rebalance Portfolio
</h2>

<h3>Description</h3>

<p>Compute the differences between two portfolios.
</p>


<h3>Usage</h3>

<pre><code class="language-R">rebalance(current, target, price,
          notional = NULL, multiplier = 1,
          truncate = TRUE, match.names = TRUE,
          fraction = 1, drop.zero = FALSE,
          current.weights = FALSE,
          target.weights = TRUE)

## S3 method for class 'rebalance'
print(x, ..., drop.zero = TRUE)

replace_weight(weights, ..., prefix = TRUE, sep = "::")
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>current</code></td>
<td>

<p>the current holdings: a (typically named) vector of position sizes;
can also be a <code>position</code>
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>target</code></td>
<td>

<p>the target holdings: a (typically named) vector of weights;
can also be a <code>position</code>
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>price</code></td>
<td>

<p>a numeric vector: the current prices; may be named
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>notional</code></td>
<td>

<p>a single number: the value of the portfolio; if missing,
replaced by <code>sum(current*prices)</code>
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>multiplier</code></td>
<td>

<p>numeric vector, possibly named
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>truncate</code></td>
<td>

<p>truncate computed positions? Default is <code>TRUE</code>.
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>match.names</code></td>
<td>

<p>logical
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>fraction</code></td>
<td>

<p>numeric
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>x</code></td>
<td>

<p>an object of class <code>rebalance</code>.
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>...</code></td>
<td>

<p><code>rebalance</code>: arguments passed to <code>print</code>;
<code>replace_weight</code>: numeric vectors
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>drop.zero</code></td>
<td>

<p>logical: should instruments with no difference
between <code>current</code> and <code>target</code> be included?
</p>
<p>Note the different defaults for computing and
printing.
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>current.weights</code></td>
<td>

<p>logical. If <code>TRUE</code> (the default), the values in <code>current</code> are
interpreted as weights. If <code>FALSE</code>, <code>current</code> is
interpreted as a position (i.e. notional/number of contracts).
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>target.weights</code></td>
<td>

<p>logical. If <code>TRUE</code> (the default), the values in <code>target</code> are
interpreted as weights. If <code>FALSE</code>, <code>target</code> is
interpreted as a position (i.e. notional/number of contracts).
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>weights</code></td>
<td>

<p>a numeric vector with named components
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>sep</code></td>
<td>

<p>character
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>prefix</code></td>
<td>

<p>logical
</p>
</td>
</tr>
</table>
<h3>Details</h3>

<p>The function computes the necessary trades to move from the
<code>current</code> portfolio to a <code>target</code> portfolio.
</p>
<p><code>replace_weight</code> is a helper function to split
baskets into their components. All arguments passed
via <code>...</code> should be named vectors. If names are
not syntactically valid (see
<code>make.names</code>), quote them. The passed
vectors themselves should be passed as named
arguments: see examples.
</p>


<h3>Value</h3>

<p>An object of class <code>rebalance</code>, which is a
<code>data.frame</code>:
</p>
<table>
<tr style="vertical-align: top;">
<td><code>instrument</code></td>
<td>
<p>character, or <code>NA</code> when
<code>match.names</code> is <code>FALSE</code></p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>price</code></td>
<td>
<p>prices</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>current</code></td>
<td>
<p>current portfolio, in units of instrument</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>target</code></td>
<td>
<p>new portfolio, in units of instrument</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>difference</code></td>
<td>
<p>the difference between <code>current</code>
and target portfolio</p>
</td>
</tr>
</table>
<p>Attached to the data.frame are several attributes:
</p>
<table>
<tr style="vertical-align: top;">
<td><code>notional</code></td>
<td>
<p>a single number</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>match.names</code></td>
<td>
<p>logical</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>multiplier</code></td>
<td>
<p>a numeric vector with as many elements as
the resulting data.frame has rows</p>
</td>
</tr>
</table>
<h3>Author(s)</h3>

<p>Enrico Schumann
</p>


<h3>References</h3>


<p>Schumann, E. (2023) <em>Portfolio Management with R</em>.
<a href="https://enricoschumann.net/R/packages/PMwR/">https://enricoschumann.net/R/packages/PMwR/</a>;
in particular, see<br><a href="https://enricoschumann.net/R/packages/PMwR/manual/PMwR.html#rebalance">https://enricoschumann.net/R/packages/PMwR/manual/PMwR.html#rebalance</a>
</p>


<h3>See Also</h3>

<p><code>journal</code>
</p>


<h3>Examples</h3>

<pre><code class="language-R">r &lt;- rebalance(current = c(a = 100, b = 20),
               target  = c(a = 0.2, c = 0.3),
               price   = c(a = 1, b = 2, c = 3))
as.journal(r)

## replace_weight: the passed vectors must be named;
##                 'basket_3' is ignored because not
##                 component of weights is named
##                 'basket_3'

replace_weight(c(basket_1 = 0.3,
                 basket_2 = 0.7),
               basket_1 = c(a = 0.1, b = 0.4, c = .5),
               basket_2 = c(x = 0.1, y = 0.4, z = .5),
               basket_3 = c(X = 0.5, Z = 0.5),
               sep = "|")
</code></pre>


</div>