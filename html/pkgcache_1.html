<div class="container">

<table style="width: 100%;"><tr>
<td>pkgcache-package</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>Cache for package data and metadata</h2>

<h3>Description</h3>

<p>Metadata and package cache for CRAN-like repositories. This is a utility package to be used by package management tools that want to take advantage of caching.
</p>


<h3>Details</h3>

<p>Metadata and package cache for CRAN-like repositories. This is a utility
package to be used by package management tools that want to take
advantage of caching.
</p>


<h4>Installation</h4>

<p>You can install the released version of pkgcache from
<a href="https://CRAN.R-project.org">CRAN</a> with:
</p>
<div class="sourceCode r"><pre>install.packages("pkgcache")
</pre></div>
<p>If you need the development version, you can install it from
<a href="https://github.com">GitHub</a> with:
</p>
<div class="sourceCode r"><pre>pak::pak("r-lib/pkgcache")
</pre></div>



<h4>Metadata cache</h4>

<p><code>meta_cache_list()</code> lists all packages in the metadata cache. It
includes Bioconductor package, and all versions (i.e. both binary and
source) of the packages for the current platform and R version.
</p>
<p>(We load the pillar package, because it makes the pkgcache data frames
print nicer, similarly to tibbles.)
</p>
<div class="sourceCode r"><pre>library(pkgcache)
library(pillar)
meta_cache_list()
#&gt; # A data frame: 48,094 x 32
#&gt;    package     version depends suggests license imports linkingto archs enhances
#&gt;    &lt;chr&gt;       &lt;chr&gt;   &lt;chr&gt;   &lt;chr&gt;    &lt;chr&gt;   &lt;chr&gt;   &lt;chr&gt;     &lt;chr&gt; &lt;chr&gt;   
#&gt;  1 A3          1.0.0   R (&gt;= ~ randomF~ GPL (&gt;~ &lt;NA&gt;    &lt;NA&gt;      &lt;NA&gt;  &lt;NA&gt;    
#&gt;  2 AATtools    0.0.2   R (&gt;= ~ &lt;NA&gt;     GPL-3   magrit~ &lt;NA&gt;      &lt;NA&gt;  &lt;NA&gt;    
#&gt;  3 ABACUS      1.0.0   R (&gt;= ~ rmarkdo~ GPL-3   ggplot~ &lt;NA&gt;      &lt;NA&gt;  &lt;NA&gt;    
#&gt;  4 ABC.RAP     0.9.0   R (&gt;= ~ knitr, ~ GPL-3   graphi~ &lt;NA&gt;      &lt;NA&gt;  &lt;NA&gt;    
#&gt;  5 ABCanalysis 1.2.1   R (&gt;= ~ &lt;NA&gt;     GPL-3   plotrix &lt;NA&gt;      &lt;NA&gt;  &lt;NA&gt;    
#&gt;  6 ABCoptim    0.15.0  &lt;NA&gt;    testtha~ MIT + ~ Rcpp, ~ Rcpp      ABCo~ &lt;NA&gt;    
#&gt;  7 ABCp2       1.2     MASS    &lt;NA&gt;     GPL-2   &lt;NA&gt;    &lt;NA&gt;      &lt;NA&gt;  &lt;NA&gt;    
#&gt;  8 ABHgenotyp~ 1.0.1   &lt;NA&gt;    knitr, ~ GPL-3   ggplot~ &lt;NA&gt;      &lt;NA&gt;  &lt;NA&gt;    
#&gt;  9 ABM         0.4.1   &lt;NA&gt;    &lt;NA&gt;     GPL (&gt;~ R6, Rc~ Rcpp      ABM.~ &lt;NA&gt;    
#&gt; 10 ABPS        0.3     &lt;NA&gt;    testthat GPL (&gt;~ kernlab &lt;NA&gt;      &lt;NA&gt;  &lt;NA&gt;    
#&gt; # i 48,084 more rows
#&gt; # i 23 more variables: license_restricts_use &lt;chr&gt;, priority &lt;chr&gt;,
#&gt; #   license_is_foss &lt;chr&gt;, os_type &lt;chr&gt;, repodir &lt;chr&gt;, rversion &lt;chr&gt;,
#&gt; #   platform &lt;chr&gt;, needscompilation &lt;chr&gt;, ref &lt;chr&gt;, type &lt;chr&gt;,
#&gt; #   direct &lt;lgl&gt;, status &lt;chr&gt;, target &lt;chr&gt;, mirror &lt;chr&gt;, sources &lt;list&gt;,
#&gt; #   filesize &lt;int&gt;, sha256 &lt;chr&gt;, sysreqs &lt;chr&gt;, built &lt;chr&gt;, published &lt;dttm&gt;,
#&gt; #   deps &lt;list&gt;, md5sum &lt;chr&gt;, path &lt;chr&gt;
</pre></div>
<p><code>meta_cache_deps()</code> and <code>meta_cache_revdeps()</code> can be used to look up
dependencies and reverse dependencies.
</p>
<p>The metadata is updated automatically if it is older than seven days,
and it can also be updated manually with <code>meta_cache_update()</code>.
</p>
<p>See the <code>cranlike_metadata_cache</code> R6 class for a lower level API, and
more control.
</p>



<h4>Package cache</h4>

<p>Package management tools may use the <code style="white-space: pre;">⁠pkg_cache_*⁠</code> functions and in
particular the <code>package_cache</code> class, to make use of local caching of
package files.
</p>
<p>The <code style="white-space: pre;">⁠pkg_cache_*⁠</code> API is high level, and uses a user level cache:
</p>
<div class="sourceCode r"><pre>pkg_cache_summary()
#&gt; $cachepath
#&gt; [1] "/Users/gaborcsardi/Library/Caches/org.R-project.R/R/pkgcache/pkg"
#&gt; 
#&gt; $files
#&gt; [1] 40
#&gt; 
#&gt; $size
#&gt; [1] 61300737
</pre></div>
<div class="sourceCode r"><pre>pkg_cache_list()
#&gt; # A data frame: 40 x 11
#&gt;    fullpath    path  package url   etag  sha256 version platform built vignettes
#&gt;    &lt;chr&gt;       &lt;chr&gt; &lt;chr&gt;   &lt;chr&gt; &lt;chr&gt; &lt;chr&gt;  &lt;chr&gt;   &lt;chr&gt;    &lt;int&gt;     &lt;int&gt;
#&gt;  1 /Users/gab~ arch~ &lt;NA&gt;    http~ "\"1~ 9da51~ &lt;NA&gt;    &lt;NA&gt;        NA        NA
#&gt;  2 /Users/gab~ bin/~ cli     http~ "\"1~ b24b4~ 3.6.2   x86_64-~    NA        NA
#&gt;  3 /Users/gab~ bin/~ jose    http~ "\"7~ b1bac~ 1.2.0   aarch64~    NA        NA
#&gt;  4 /Users/gab~ src/~ gh      &lt;NA&gt;   &lt;NA&gt; &lt;NA&gt;   1.4.0.~ source       1         0
#&gt;  5 /Users/gab~ src/~ gh      &lt;NA&gt;   &lt;NA&gt; &lt;NA&gt;   1.4.0.~ aarch64~     1         0
#&gt;  6 /Users/gab~ bin/~ gh      http~ "\"1~ f5daf~ 1.4.0   aarch64~    NA        NA
#&gt;  7 /Users/gab~ src/~ tic     &lt;NA&gt;   &lt;NA&gt; 11103~ &lt;NA&gt;    &lt;NA&gt;         0        NA
#&gt;  8 /Users/gab~ src/~ tic     &lt;NA&gt;   &lt;NA&gt; 11103~ 0.14.0  source       1         0
#&gt;  9 /Users/gab~ src/~ tic     &lt;NA&gt;   &lt;NA&gt; 11103~ 0.14.0  aarch64~     1         0
#&gt; 10 /Users/gab~ bin/~ rhub    http~ "\"f~ af2d6~ 1.1.2   aarch64~    NA        NA
#&gt; # i 30 more rows
#&gt; # i 1 more variable: rversion &lt;chr&gt;
</pre></div>
<div class="sourceCode r"><pre>pkg_cache_find(package = "dplyr")
#&gt; # A data frame: 0 x 11
#&gt; # i 11 variables: fullpath &lt;chr&gt;, path &lt;chr&gt;, package &lt;chr&gt;, url &lt;chr&gt;,
#&gt; #   etag &lt;chr&gt;, sha256 &lt;chr&gt;, version &lt;chr&gt;, platform &lt;chr&gt;, built &lt;int&gt;,
#&gt; #   vignettes &lt;int&gt;, rversion &lt;chr&gt;
</pre></div>
<p><code>pkg_cache_add_file()</code> can be used to add a file,
<code>pkg_cache_delete_files()</code> to remove files, <code>pkg_cache_get_files()</code> to
copy files out of the cache.
</p>
<p>The <code>package_cache</code> class provides a finer API.
</p>



<h4>Installed packages</h4>

<p>pkgcache contains a very fast DCF parser to parse <code style="white-space: pre;">⁠PACKAGES*⁠</code> files, or
the <code>DESCRIPTION</code> files in installed packages. <code>parse_packages()</code> parses
all fields from <code>PACKAGES</code>, <code>PACKAGES.gz</code> or <code>PACKAGES.rds</code> files.
<code>parse_installed()</code> reads <em>all</em> metadata from packages installed into a
library:
</p>
<div class="sourceCode r"><pre>parse_installed()
#&gt; # A data frame: 888 x 128
#&gt;    Package  Type  Title Version Date  `Authors@R` Maintainer Description Imports
#&gt;    &lt;chr&gt;    &lt;chr&gt; &lt;chr&gt; &lt;chr&gt;   &lt;chr&gt; &lt;chr&gt;       &lt;chr&gt;      &lt;chr&gt;       &lt;chr&gt;  
#&gt;  1 AdaptGa~ Pack~ Gaus~ 1.6     2024~ "c(person(~ Michael T~ "Multimoda~ "Rcpp,~
#&gt;  2 Annotat~ &lt;NA&gt;  Mani~ 1.64.1  &lt;NA&gt;   &lt;NA&gt;       Bioconduc~ "Implement~ "DBI, ~
#&gt;  3 Annotat~ &lt;NA&gt;  Tool~ 1.42.2  &lt;NA&gt;   &lt;NA&gt;       Bioconduc~ "Provides ~ "DBI, ~
#&gt;  4 AsioHea~ Pack~ 'Asi~ 1.22.1~ 2022~  &lt;NA&gt;       Dirk Edde~ "'Asio' is~  &lt;NA&gt;  
#&gt;  5 AutoQua~ &lt;NA&gt;  Auto~ 1.0.1   2023~ "\n    c(p~ Adrian An~ "R package~ "bit64~
#&gt;  6 BH       Pack~ Boos~ 1.81.0~ 2023~  &lt;NA&gt;       Dirk Edde~ "Boost pro~  &lt;NA&gt;  
#&gt;  7 BayesFa~ Pack~ Comp~ 0.9.12~ 2022~ "c(person(~ Richard D~ "A suite o~ "pbapp~
#&gt;  8 Biobase  &lt;NA&gt;  Biob~ 2.62.0  &lt;NA&gt;  "c(\n    p~ Bioconduc~ "Functions~ "metho~
#&gt;  9 BiocBas~ &lt;NA&gt;  Gene~ 1.4.0   &lt;NA&gt;  "c(\n  per~ Marcel Ra~ "The packa~ "metho~
#&gt; 10 BiocFil~ &lt;NA&gt;  Mana~ 2.10.1  &lt;NA&gt;  "c(person(~ Lori Shep~ "This pack~ "metho~
#&gt; # i 878 more rows
#&gt; # i 119 more variables: Suggests &lt;chr&gt;, LinkingTo &lt;chr&gt;, Depends &lt;chr&gt;,
#&gt; #   License &lt;chr&gt;, LazyLoad &lt;chr&gt;, URL &lt;chr&gt;, Encoding &lt;chr&gt;,
#&gt; #   NeedsCompilation &lt;chr&gt;, VignetteBuilder &lt;chr&gt;, BugReports &lt;chr&gt;,
#&gt; #   Packaged &lt;chr&gt;, Author &lt;chr&gt;, Repository &lt;chr&gt;, `Date/Publication` &lt;chr&gt;,
#&gt; #   Built &lt;chr&gt;, Archs &lt;chr&gt;, RemoteType &lt;chr&gt;, RemotePkgRef &lt;chr&gt;,
#&gt; #   RemoteRef &lt;chr&gt;, RemoteRepos &lt;chr&gt;, RemotePkgPlatform &lt;chr&gt;, ...
</pre></div>



<h4>Bioconductor support</h4>

<p>Both the metadata cache and the package cache support Bioconductor by
default, automatically. See the <code>BioC_mirror</code> option and the
<code>R_BIOC_MIRROR</code> and <code>R_BIOC_VERSION</code> environment variables below to
configure Bioconductor support.
</p>



<h4>Package Options</h4>


<ul>
<li>
<p> The <code>BioC_mirror</code> option can be used to select a Bioconductor mirror.
This takes priority over the <code>R_BIOC_MIRROR</code> environment variable.
</p>
</li>
<li>
<p> You can use the <code>pkg.current_platform</code> option to set the platform
string for the current platform for the <code>current_r_platform()</code>
function. This is useful if pkgcache didn’t detect the platform
correctly. Alternatively, you can use the <code>PKG_CURRENT_PLATFORM</code>
environment variable. The option takes priority.
</p>
</li>
<li> <p><code>pkgcache_timeout</code> is the HTTP timeout for all downloads. It is in
seconds, and the limit for downloading the whole file. Defaults to
3600, one hour. It corresponds to the <a href="https://curl.se/libcurl/c/CURLOPT_TIMEOUT.html"><code>TIMEOUT</code> libcurl option</a>.
</p>
</li>
<li> <p><code>pkgcache_connecttimeout</code> is the HTTP timeout for the connection
phase. It is in seconds and defaults to 30 seconds. It corresponds to
the <a href="https://curl.se/libcurl/c/CURLOPT_CONNECTTIMEOUT.html"><code>CONNECTTIMEOUT</code> libcurl option</a>.
</p>
</li>
<li> <p><code>pkgcache_low_speed_limit</code> and <code>pkgcache_low_speed_time</code> are used for
a more sensible HTTP timeout. If the download speed is less than
<code>pkgcache_low_speed_limit</code> bytes per second for at least
<code>pkgcache_low_speed_time</code> seconds, the download errors. They
correspond to the
<a href="https://curl.se/libcurl/c/CURLOPT_LOW_SPEED_LIMIT.html"><code>LOW_SPEED_LIMIT</code></a>
and
<a href="https://curl.se/libcurl/c/CURLOPT_LOW_SPEED_TIME.html"><code>LOW_SPEED_TIME</code></a>
curl options.
</p>
</li>
</ul>
<h4>Package environment variables</h4>


<ul>
<li>
<p> The <code>R_BIOC_VERSION</code> environment variable can be used to override the
default Bioconductor version detection and force a given version. E.g.
this can be used to force the development version of Bioconductor.
</p>
</li>
<li>
<p> The <code>R_BIOC_MIRROR</code> environment variable can be used to select a
Bioconductor mirror. The <code>BioC_mirror</code> option takes priority over
this, if set.
</p>
</li>
<li>
<p> You can use the <code>PKG_CURRENT_PLATFORM</code> environment variable to set the
platform string for the current platform for the
<code>current_r_platform()</code> function. This is useful if pkgcache didn’t
detect the platform correctly. Alternatively, you can use the
<code>pkg.current_platofrm</code> option, which takes. priority over the
environment variable.
</p>
</li>
<li> <p><code>PKGCACHE_PPM_REPO</code> is the name of the Posit Package Manager
repository to use. Defaults to <code>"cran"</code>.
</p>
</li>
<li> <p><code>PKGCACHE_PPM_URL</code> is the base URL of the Posit Package Manager
instance to use. It defaults to the URL of the Posit Public Package
Manager instance at <a href="https://packagemanager.posit.co/client/#/">https://packagemanager.posit.co/client/#/</a>.
</p>
</li>
<li> <p><code>PKGCACHE_TIMEOUT</code> is the HTTP timeout for all downloads. It is in
seconds, and the limit for downloading the whole file. Defaults to
3600, one hour. It corresponds to the <a href="https://curl.se/libcurl/c/CURLOPT_TIMEOUT.html"><code>TIMEOUT</code> libcurl option</a>. The
<code>pkgcache_timeout</code> option has priority over this, if set.
</p>
</li>
<li> <p><code>PKGCACHE_CONNECTTIMEOUT</code> is the HTTP timeout for the connection
phase. It is in seconds and defaults to 30 seconds. It corresponds to
the <a href="https://curl.se/libcurl/c/CURLOPT_CONNECTTIMEOUT.html"><code>CONNECTTIMEOUT</code> libcurl option</a>. The
<code>pkgcache_connecttimeout</code> option takes precedence over this, if set.
</p>
</li>
<li> <p><code>PKGCACHE_LOW_SPEED_LIMIT</code> and <code>PKGCACHE_LOW_SPEED_TIME</code> are used for
a more sensible HTTP timeout. If the download speed is less than
<code>PKGCACHE_LOW_SPEED_LIMIT</code> bytes per second for at least
<code>PKGCACHE_LOW_SPEED_TIME</code> seconds, the download errors. They
correspond to the
<a href="https://curl.se/libcurl/c/CURLOPT_LOW_SPEED_LIMIT.html"><code>LOW_SPEED_LIMIT</code></a>
and
<a href="https://curl.se/libcurl/c/CURLOPT_LOW_SPEED_TIME.html"><code>LOW_SPEED_TIME</code></a>
curl options. The <code>pkgcache_low_speed_time</code> and
<code>pkgcache_low_speed_limit</code> options have priority over these
environment variables, if they are set.
</p>
</li>
<li> <p><code>R_PKG_CACHE_DIR</code> is used for the cache directory, if set. (Otherwise
<code>tools::R_user_dir("pkgcache", "cache")</code> is used, see also
<code>meta_cache_summary()</code> and <code>pkg_cache_summary()</code>).
</p>
</li>
</ul>
<h4>Using pkgcache in CRAN packages</h4>

<p>If you use pkgcache in your CRAN package, please make sure that
</p>

<ul>
<li>
<p> you don’t use pkgcache in your examples, and
</p>
</li>
<li>
<p> you set the <code>R_USER_CACHE_DIR</code> environment variable to a temporary
directory (e.g. via <code>tempfile()</code>) during test cases. See the
<code>tests/testthat/setup.R</code> file in pkgcache for an example.
</p>
</li>
</ul>
<p>This is to make sure that pkgcache does not modify the user’s files
while running <code style="white-space: pre;">⁠R CMD check⁠</code>.
</p>



<h4>Code of Conduct</h4>

<p>Please note that the pkgcache project is released with a <a href="https://r-lib.github.io/pkgcache/CODE_OF_CONDUCT.html">Contributor Code of Conduct</a>.
By contributing to this project, you agree to abide by its terms.
</p>



<h4>License</h4>

<p>MIT (c) <a href="https://posit.co">Posit Software, PBC</a>
</p>



<h3>Author(s)</h3>

<p><strong>Maintainer</strong>: Gábor Csárdi <a href="mailto:csardi.gabor@gmail.com">csardi.gabor@gmail.com</a>
</p>
<p>Other contributors:
</p>

<ul><li>
<p> Posit Software, PBC [copyright holder, funder]
</p>
</li></ul>
<h3>See Also</h3>

<p>Useful links:
</p>

<ul>
<li> <p><a href="https://r-lib.github.io/pkgcache/">https://r-lib.github.io/pkgcache/</a>
</p>
</li>
<li> <p><a href="https://github.com/r-lib/pkgcache">https://github.com/r-lib/pkgcache</a>
</p>
</li>
<li>
<p> Report bugs at <a href="https://github.com/r-lib/pkgcache/issues">https://github.com/r-lib/pkgcache/issues</a>
</p>
</li>
</ul>
</div>