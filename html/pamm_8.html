<div class="container">

<table style="width: 100%;"><tr>
<td>SSF</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>Simulation function to assess power of mixed models</h2>

<h3>Description</h3>

<p>Given a specific total number of observations and variance-covariance
structure for random effect, the function simulates different association of number of
group and replicates, giving the specified sample size, and assess p-values and
power of random intercept and random slope
</p>


<h3>Usage</h3>

<pre><code class="language-R">SSF(
  numsim,
  tss,
  nbstep = 10,
  randompart,
  fixed = c(0, 1, 0),
  n.X = NA,
  autocorr.X = 0,
  X.dist = "gaussian",
  intercept = 0,
  exgr = NA,
  exrepl = NA,
  heteroscedasticity = c("null")
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>numsim</code></td>
<td>
<p>number of simulation for each step</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>tss</code></td>
<td>
<p>total sample size, nb group * nb replicates</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>nbstep</code></td>
<td>
<p>number of group*replicates associations to simulate</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>randompart</code></td>
<td>
<p>vector of lenght 4 or 5 with 1: variance component
of intercept, VI; 2: variance component of slope, VS; 3: residual
variance, VR; 4: relation between random intercept and random
slope; 5: "cor" or "cov" determine id the relation between I ans S is
correlation or covariance, set to <code>"cor"</code> by default</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>fixed</code></td>
<td>
<p>vector of lenght 3 with mean, variance and estimate of fixed
effect to simulate</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>n.X</code></td>
<td>
<p>number of different values to simulate for the fixed effect (covariate).
If <code>NA</code>, all values of X are independent between groups. If the value specified
is equivalent to the number of replicates per group, <code>repl</code>, then all groups
are observed for the same values of the covariate.  Default: <code>NA</code></p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>autocorr.X</code></td>
<td>
<p>correlation between two successive covariate value for a group. Default: <code>0</code></p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>X.dist</code></td>
<td>
<p>specify the distribution of the fixed effect. Only "gaussian" (normal distribution) and
"unif" (uniform distribution) are accepted actually. Default: <code>"gaussian"</code></p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>intercept</code></td>
<td>
<p>a numeric value giving the expected intercept value. Default:0</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>exgr</code></td>
<td>
<p>a vector specifying minimum and maximum value for number of group.
Default:<code>c(2,tss/2)</code></p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>exrepl</code></td>
<td>
<p>a vector specifying minimum and maximum value for number
of replicates. Default:<code>c(2,tss/2)</code></p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>heteroscedasticity</code></td>
<td>
<p>a vector specifying heterogeneity in residual variance
across X. If <code>c("null")</code> residual variance is homogeneous across X. If
<code>c("power",t1,t2)</code> models heterogeneity with a constant plus power variance
function. Letting <code class="reqn">v</code> denote the variance covariate and <code class="reqn">\sigma^2(v)s2(v)</code>
denote the variance function evaluated at <code class="reqn">v</code>, the constant plus power
variance function is defined as <code class="reqn">\sigma^2(v) = (\theta_1 + |v|^{\theta_2})^2s2(v) = (t1 + |v|^t2)^2</code>,
where <code class="reqn">\theta_1,\theta_2t1, t2</code> are the variance function coefficients.
If <code>c("exp",t)</code>,models heterogeneity with an
exponential variance function. Letting <code class="reqn">v</code> denote the variance covariate and <code class="reqn">\sigma^2(v)s2(v)</code>
denote the variance function evaluated at <code class="reqn">v</code>, the exponential
variance function is defined as <code class="reqn">\sigma^2(v) = e^{2 * \theta * v}s2(v) = exp(2* t * v)</code>, where <code class="reqn">\theta</code> is the variance
function coefficient.</p>
</td>
</tr>
</table>
<h3>Details</h3>

<p>P-values for random effects are estimated using a log-likelihood ratio
test between two models with and without the effect. Power represent
the percentage of simulations providing a significant p-value for a
given random structure
</p>


<h3>Value</h3>

<p>data frame reporting estimated P-values and power with CI for random
intercept and random slope
</p>


<h3>See Also</h3>

<p>PAMM(), EAMM() for other simulation functions
plot.SSF() for plotting
</p>


<h3>Examples</h3>

<pre><code class="language-R">## Not run: 
oursSSF &lt;- SSF(10, 100, 10, c(0.4, 0.1, 0.6, 0))
plot(oursSSF)

## End(Not run)

</code></pre>


</div>