<div class="container">

<table style="width: 100%;"><tr>
<td>wcc</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>
Weighted auto- and cross-correlation measures
</h2>

<h3>Description</h3>

<p>Functions to calculate weighted auto- and cross-correlation
measures. The wcc is a suitable measure for the similarity of two
patterns when features may be shifted. Identical patterns lead to a
wcc value of 1.
</p>
<p>Functions <code>wcc</code> and <code>wac</code> are meant for profile data
(intensities measured at equidistant time points), whereas
<code>wcc.st</code> and <code>wac.st</code> are meant for peak lists. In general,
wcc values calculated for profiles will be higher since they will also
include the large similarity in the empty spaces, i.e., parts of the
profiles where no peaks are present (and that will appear to be
perfectly aligned), whereas the peak-based version concentrates only
on the peaks.
</p>


<h3>Usage</h3>

<pre><code class="language-R">wcc(pattern1, pattern2, trwdth, wghts = NULL, acors1 = NULL, acors2 = NULL)
wac(pattern1, trwdth, wghts = NULL)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>pattern1, pattern2</code></td>
<td>
<p>input patterns, typically spectra. Vectors</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>trwdth</code></td>
<td>
<p>triangle width, given in the number of data points for
the profile functions, and in the actual retention times for the
stick-based warpings.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>wghts</code></td>
<td>
<p>optional weights vector, will be calculated from triangle
width if necessary. Sometimes it is more efficient to
pre-calculate it and give it as an argument</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>acors1, acors2</code></td>
<td>
<p>autocorrelations of the input patterns. If not
provided, they are calculated</p>
</td>
</tr>
</table>
<h3>Details</h3>

<p>Functions <code>wcc</code> and <code>wac</code> are defined such that the
triangle width stands for  
the number of points on one side of <strong>and including</strong> the current 
point. Thus, a <code>trwdth</code> of 0 signifies a non-existent triangle and 
results in an error; a <code>trwdth</code> equal to 1 only includes the current
point with weight 1 and no neighbouring points. For the stick-based
equivalents, the units of the time axis are used for the triangle width.
</p>


<h3>Value</h3>

<p>One number, the weighted autocorrelation or crosscorrelation</p>


<h3>Author(s)</h3>

<p>Ron Wehrens</p>


<h3>References</h3>

<p>de Gelder, R., Wehrens, R. and Hageman, J.A. (2001)
"A generalized expression for the similarity of spectra: Application to powder diffraction pattern classification",
Journal of Computational Chemistry, <b>22</b>, 273 â€“ 289. 
</p>


<h3>Examples</h3>

<pre><code class="language-R">data(gaschrom)
wcc(gaschrom[1,], gaschrom[2,], 20)

wcc.st(gaschrom.st[[1]], gaschrom.st[[2]], 20)
</code></pre>


</div>