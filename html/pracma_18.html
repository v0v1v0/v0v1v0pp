<div class="container">

<table style="width: 100%;"><tr>
<td>anms</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>
Adaptive Nelder-Mead Minimization
</h2>

<h3>Description</h3>

<p>An implementation of the Nelder-Mead algorithm for derivative-free
optimization / function minimization.
</p>


<h3>Usage</h3>

<pre><code class="language-R">anms(fn, x0, ...,
     tol = 1e-10, maxfeval = NULL)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>fn</code></td>
<td>
<p>nonlinear function to be minimized.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>x0</code></td>
<td>
<p>starting vector.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>tol</code></td>
<td>
<p>relative tolerance, to be used as stopping rule.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>maxfeval</code></td>
<td>
<p>maximum number of function calls.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>...</code></td>
<td>
<p>additional arguments to be passed to the function.</p>
</td>
</tr>
</table>
<h3>Details</h3>

<p>Also called a ‘simplex’ method for finding the local minimum of a function
of several variables. The method is a pattern search that compares function
values at the vertices of the simplex. The process generates a sequence of
simplices with ever reducing sizes.
</p>
<p><code>anms</code> can be used up to 20 or 30 dimensions (then ‘tol’ and ‘maxfeval’
need to be increased). It applies adaptive parameters for simplicial search, 
depending on the problem dimension – see Fuchang and Lixing (2012).
</p>
<p>With upper and/or lower bounds, <code>anms</code> will apply a transformation of
bounded to unbounded regions before utilizing Nelder-Mead. Of course, if the
optimum is near to the boundary, results will not be as accurate as when the
minimum is in the interior.
</p>


<h3>Value</h3>

<p>List with following components:
</p>
<table>
<tr style="vertical-align: top;">
<td><code>xmin</code></td>
<td>
<p>minimum solution found.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>fmin</code></td>
<td>
<p>value of <code>f</code> at minimum.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>nfeval</code></td>
<td>
<p>number of function calls performed.</p>
</td>
</tr>
</table>
<h3>Note</h3>

<p>Copyright (c) 2012 by F. Gao and L. Han, implemented in Matlab with a
permissive license. Implemented in R by Hans W. Borchers. For another
elaborate implementation of Nelder-Mead see the package ‘dfoptim’.
</p>


<h3>References</h3>

<p>Nelder, J., and R. Mead (1965). A simplex method for function minimization.
Computer Journal, Volume 7, pp. 308-313.
</p>
<p>O'Neill, R. (1971). Algorithm AS 47: Function Minimization Using a Simplex 
Procedure. Applied Statistics, Volume 20(3), pp. 338-345.
</p>
<p>J. C. Lagarias et al. (1998). Convergence properties of the Nelder-Mead
simplex method in low dimensions. SIAM Journal for Optimization, Vol. 9,
No. 1, pp 112-147.
</p>
<p>Fuchang Gao and Lixing Han (2012). Implementing the Nelder-Mead simplex
algorithm with adaptive parameters. Computational Optimization and
Applications, Vol. 51, No. 1, pp. 259-277.
</p>


<h3>See Also</h3>

<p><code>optim</code>
</p>


<h3>Examples</h3>

<pre><code class="language-R">##  Rosenbrock function
rosenbrock &lt;- function(x) {
    n &lt;- length(x)
    x1 &lt;- x[2:n]
    x2 &lt;- x[1:(n-1)]
    sum(100*(x1-x2^2)^2 + (1-x2)^2)
}

anms(rosenbrock, c(0,0,0,0,0))
# $xmin
# [1] 1 1 1 1 1
# $fmin
# [1] 8.268732e-21
# $nfeval
# [1] 1153

# To add constraints to the optimization problem, use a slightly 
# modified objective function. Equality constraints not possible.
# Warning: Avoid a starting value too near to the boundary !

## Not run: 
# Example: 0.0 &lt;= x &lt;= 0.5
fun &lt;- function(x) {
    if (any(x &lt; 0) || any(x &gt; 0.5)) 100
    else rosenbrock(x)
}
x0 &lt;- rep(0.1, 5)

anms(fun, x0)
## $xmin
## [1] 0.500000000 0.263051265 0.079972922 0.016228138 0.000267922
## End(Not run)
</code></pre>


</div>