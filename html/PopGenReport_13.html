<div class="container">

<table style="width: 100%;"><tr>
<td>landgenreport</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>Create a landscape genetic report</h2>

<h3>Description</h3>

<p>This function is the landscape genetic version of the
<code>popgenreport</code> function. It needs to be provided with a genind
object with spatial coordinates, a friction map (raster) and a specification
which type of genetic distance should be used.  Once all three type of input
are provided with the necessary input, a landscape genetic analysis using
least cost path analysis is computed (see Cushman et al. 2010, Landguth et
al. 2010). Depending on the genetic distance meassurement this is done on a
subpopulation basis (D, Gst.Hedrick, Gst.Nei=Fst) or on an individual basis
(Kosman, Smouse).
</p>


<h3>Usage</h3>

<pre><code class="language-R">landgenreport(
  cats,
  fric.raster,
  gen.distance = "Gst.Nei",
  NN = NULL,
  pathtype = "leastcost",
  plotpath = TRUE,
  theta = 1,
  mk.resistance = TRUE,
  mapdotcolor = "blue",
  mapdotsize = 1,
  mapdotalpha = 0.4,
  mapdottype = 19,
  mapzoom = NULL,
  mk.custom = FALSE,
  fname = "LandGenReport",
  foldername = "results",
  path.pgr = NULL,
  mk.Rcode = FALSE,
  mk.complete = FALSE,
  mk.pdf = TRUE
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>cats</code></td>
<td>
<p>a <code>genind</code> object with spatial coordinates in the other
slot</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>fric.raster</code></td>
<td>
<p>friction (resistance) raster, that specifies the
landscape where the analysis should be computed on. If fric.raser is a stack
a cost distances are calculated for each layer in the stack.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>gen.distance</code></td>
<td>
<p>type of genetic distance that should be used. Depending
on the genetic distance meassurement this is done on a subpopulation basis
(D, Gst.Hedrick, Gst.Nei=Fst) or on an individual basis (Kosman, Smouse,
propShared). propShared is the proportion of shared alleles between
individuals.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>NN</code></td>
<td>
<p>Number of neighbours used when calculating the cost distance
(possible values 4,8 or 16). As the default is NULL a value has to be
provided if pathtype is 'leastcost'. NN=8 is most commonly used as it avoids
a directional bias, but be aware that linear structures may cause artefacts
in the least-cost paths in the NN=8 case, therefore we strongly recommend to
inspect the actual least-cost paths in the provided output.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>pathtype</code></td>
<td>
<p>Type of cost distance to be calculated (based on function in
the <code>gdistance</code> package. Available distances are 'leastcost',
'commute' or 'rSPDistance'. See functions in the gdistance package for
futher explanations.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>plotpath</code></td>
<td>
<p>switch if least cost paths should be plotted (works only if
pathtype='leastcost'. Be aware this slows down the computation, but it is
recommended to check least cost paths visually.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>theta</code></td>
<td>
<p>value needed for rSPDistance function. see
<code>rSPDistance</code> in package <code>gdistance</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>mk.resistance</code></td>
<td>
<p>switch to do the landscape genetic analysis based on
resistance matrices, should be set to TRUE</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>mapdotcolor</code></td>
<td>
<p>see <code>popgenreport</code></p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>mapdotsize</code></td>
<td>
<p>see <code>popgenreport</code></p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>mapdotalpha</code></td>
<td>
<p>see<code>popgenreport</code></p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>mapdottype</code></td>
<td>
<p>see <code>popgenreport</code></p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>mapzoom</code></td>
<td>
<p>see <code>popgenreport</code></p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>mk.custom</code></td>
<td>
<p>switch to add a customised part to the landgenreport</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>fname</code></td>
<td>
<p>see <code>popgenreport</code></p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>foldername</code></td>
<td>
<p>see <code>popgenreport</code></p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>path.pgr</code></td>
<td>
<p>see <code>popgenreport</code></p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>mk.Rcode</code></td>
<td>
<p>see <code>popgenreport</code></p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>mk.complete</code></td>
<td>
<p>see <code>popgenreport</code></p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>mk.pdf</code></td>
<td>
<p>see <code>popgenreport</code></p>
</td>
</tr>
</table>
<h3>Details</h3>

<p>Check the help pages of <code>popgenreport</code> how to include
coordinates to a genind object. The coordinates need to be projected.
Latlongs are not valid, because Euclidean distances are calcuated based on
these coordinates. For an example how to convert latlongs into a projected
format have a look at the vignette that comes with this package. The
friction needs to be a raster and needs to be in the same projection as the
genind object. Also the type of genetic distance to be used needs to be
specified.
</p>


<h3>Value</h3>

<p>Four distance matrices are returned. Pairwise Euclidean distances
between subpopulations/individuals, cost distances, path lengths and genetic
distances. Also following the approach of Wassermann et al. 2010 a series of
partial mantel tests are performed. A multiple regression analysis based on
Wang 2013 and Legendre 1994 is returned.The actual least-cost paths can be
found under paths
</p>


<h3>Author(s)</h3>

<p>Bernd Gruber (bernd.gruber@canberra.edu.au)
</p>


<h3>References</h3>

<p>Cushman, S., Wasserman, T., Landguth, E. and Shirk, A. (2013).
Re-Evaluating Causal Modeling with Mantel Tests in Landscape Genetics.
Diversity, 5(1), 51-72.
</p>
<p>Landguth, E. L., Cushman, S. A., Schwartz, M. K., McKelvey, K. S., Murphy,
M. and Luikart, G. (2010). Quantifying the lag time to detect barriers in
landscape genetics. Molecular ecology, 4179-4191.
</p>
<p>Wang,I 2013. Examining the full effects of landscape heterogeneity on
spatial genetic variation: a multiple matrix regression approach for
quantifying geographic and ecological isolation. Evolution: 67-12:
3403-3411.
</p>
<p>Wasserman, T. N., Cushman, S. A., Schwartz, M. K. and Wallin, D. O. (2010).
Spatial scaling and multi-model inference in landscape genetics: Martes
americana in northern Idaho. Landscape Ecology, 25(10), 1601-1612.
</p>


<h3>See Also</h3>

<p><code>popgenreport</code>, <code>wassermann</code>,
<code>genleastcost</code>, <code>lgrMMRR</code>
</p>


<h3>Examples</h3>

<pre><code class="language-R">

library(raster)
fric.raster &lt;- readRDS(system.file("extdata","fric.raster.rdata", package="PopGenReport"))
lc&lt;-landgenreport(cats=landgen, fric.raster=fric.raster,
gen.distance="D", NN=4, mk.resistance=TRUE, mk.pdf=FALSE)
names(lc$leastcost)

</code></pre>


</div>