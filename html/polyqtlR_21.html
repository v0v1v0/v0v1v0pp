<div class="container">

<table style="width: 100%;"><tr>
<td>plotQTL</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>Plot the results of QTL scan.</h2>

<h3>Description</h3>

<p>Up to package v.0.0.9, there were three plotting functions for the output of <code>QTLscan</code>, namely <code>plotQTL</code>, <code>plotLinearQTL</code> and <code>plotLinearQTL_list</code>.
Since release 0.1.0, the functionality of all three functions has been combined into a single general plotting function, named <code>plotQTL</code>.
The plot layout is now specified by a new argument <code>layout</code>, allowing the user to plot results for single chromosomes separately, or together either adjacently or in a grid layout.
Results from multiple analyses can be overlaid. Previously, it was possible to call the function <code>plotQTL</code> multiple times and overlay subsequent plots using the argument <code>overlay = TRUE</code>.
This approach is no longer supported. Instead, if multiple results are to be overlaid, they can be provided as a list of <code>QTLscan</code> or <code>singleMarkerRegression</code> outputs. Note however that this
is only possible using the default layout. If significance thresholds are
present, the default behaviour is to rescale LOD values so that multiple plots can be combined with overlapping signficance thresholds. This rescaling behaviour can also be
disabled (by setting <code>rescale = FALSE</code>). Note that not all arguments may be appropriate for all layouts.
</p>


<h3>Usage</h3>

<pre><code class="language-R">plotQTL(
  LOD_data,
  layout = "l",
  inter_chm_gap = 5,
  ylimits = NULL,
  sig.unit = "LOD",
  plot_type = "lines",
  colour = c("black", "red", "dodgerblue", "sienna4"),
  add_xaxis = TRUE,
  add_rug = TRUE,
  add_thresh = TRUE,
  override_thresh = NULL,
  thresh.lty = 3,
  thresh.lwd = 2,
  thresh.col = "darkred",
  return_plotData = FALSE,
  show_thresh_CI = FALSE,
  use_LG_names = TRUE,
  axis_label.cex = 1,
  custom_LG_names = NULL,
  LGdiv.col = "gray42",
  ylab.at = 2.5,
  highlight_positions = NULL,
  mainTitle = FALSE,
  rescale = TRUE,
  ...
)

plotLinearQTL(
  LOD_data,
  layout = "l",
  inter_chm_gap = 5,
  ylimits = NULL,
  sig.unit = "LOD",
  plot_type = "lines",
  colour = c("black", "red", "dodgerblue", "sienna4"),
  add_xaxis = TRUE,
  add_rug = TRUE,
  add_thresh = TRUE,
  override_thresh = NULL,
  thresh.lty = 3,
  thresh.lwd = 2,
  thresh.col = "darkred",
  return_plotData = FALSE,
  show_thresh_CI = FALSE,
  use_LG_names = TRUE,
  axis_label.cex = 1,
  custom_LG_names = NULL,
  LGdiv.col = "gray42",
  ylab.at = 2.5,
  highlight_positions = NULL,
  mainTitle = FALSE,
  rescale = TRUE,
  ...
)

plotLinearQTL_list(
  LOD_data,
  layout = "l",
  inter_chm_gap = 5,
  ylimits = NULL,
  sig.unit = "LOD",
  plot_type = "lines",
  colour = c("black", "red", "dodgerblue", "sienna4"),
  add_xaxis = TRUE,
  add_rug = TRUE,
  add_thresh = TRUE,
  override_thresh = NULL,
  thresh.lty = 3,
  thresh.lwd = 2,
  thresh.col = "darkred",
  return_plotData = FALSE,
  show_thresh_CI = FALSE,
  use_LG_names = TRUE,
  axis_label.cex = 1,
  custom_LG_names = NULL,
  LGdiv.col = "gray42",
  ylab.at = 2.5,
  highlight_positions = NULL,
  mainTitle = FALSE,
  rescale = TRUE,
  ...
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>LOD_data</code></td>
<td>
<p>Output of <code>QTLscan</code> function. If you wish to overlay multiple genome-wide <code>QTLscan</code> outputs, then first compile these into a single list and 
pass this to <code>LOD_data</code>, for example <code>LOD_data = list(qtl_res1, qtl_res2)</code>. If this is passed as a named list and <code>add_legend = TRUE</code>, these names will be used
in the legend as well.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>layout</code></td>
<td>
<p>There are three possible plot layouts - single chromosome plots ("s"), genome-wide plots arranged adjacently in a linear fashion ("l") which is
also the default, and genome-wide plots arranged in a grid ("g"), i.e. a grid of single chromosome plots. In the latter case, a suitable grid dimension will be determined
based on the number of linkage groups detected in <code>LOD_data</code>. If you wish to overlay results from multiple multi-chromosome analyses, use the default layout.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>inter_chm_gap</code></td>
<td>
<p>The gap size (in units of cM) between successive chromosomes when <code>layout = "l"</code>. By default a gap of 5 cM is used. Normally the user should not need to change this.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>ylimits</code></td>
<td>
<p>Use to specify ylimits of plot region, though by default <code>NULL</code> in which case a suitable plot region is automatically used.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>sig.unit</code></td>
<td>
<p>Label to use on the y-axis for significance units, by default assumed to be LOD score.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>plot_type</code></td>
<td>
<p>Plots can be either in line drawings ("lines", default) or scatter plot format ("points").</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>colour</code></td>
<td>
<p>Vector of colours to be used in the plotting. A default set of 4 colours is provided, the first of which is used when results from a single QTL scan are to be plotted.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>add_xaxis</code></td>
<td>
<p>Should an x-axis be drawn? If multiple QTL analyses are performed on different traits, specifying this to be <code>FALSE</code>
and using <code>par(mar=c(0,4.1,4.1,2.1))</code> allows subsequent plots to be neatly stacked.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>add_rug</code></td>
<td>
<p>Logical, by default <code>TRUE</code> - should original marker points be added to plot?</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>add_thresh</code></td>
<td>
<p>Logical, by default <code>TRUE</code> - should a significance threshold be added to plot?</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>override_thresh</code></td>
<td>
<p>By default <code>NULL</code>. Can be used to specify a (numeric) value for the significance threshold, overriding any stored in <code>LOD_data</code>. If you wish to override
thresholds for multiple analyses (so, when <code>LOD_data</code> is a list of QTL outputs), can also provide a vector of numeric values here.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>thresh.lty</code></td>
<td>
<p>Gives user control over the line type of the significance threshold to be drawn. Default threshold lty is 3.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>thresh.lwd</code></td>
<td>
<p>Gives user control over the line width of the significance threshold to be drawn. Default threshold lwd is 2.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>thresh.col</code></td>
<td>
<p>Gives user control over the line colour of the significance threshold to be drawn. Default threshold colour is dark red. If plotting multiple analyses with <code>rescale = FALSE</code>,
it can be useful to provide the same colours to this argument as to <code>colour</code>, so that LOD profiles can be linked to their respective LOD thresholds.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>return_plotData</code></td>
<td>
<p>Logical, by default <code>FALSE</code>. If <code>TRUE</code>, then the x and y coordinates of the plot data are returned when <code>layout = "l"</code>,
which can be useful for subsequent plot manipulations and overlays. For other layouts, no plot data is returned.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>show_thresh_CI</code></td>
<td>
<p>Logical, by default <code>FALSE</code>. Should confidence interval bounds around LOD threshold be shown if available? If <code>LOD_data</code> is a list from multiple analyses,
this option is ignored to prevent plot becoming too cluttered.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>use_LG_names</code></td>
<td>
<p>Logical, by default <code>TRUE</code>. Should original character LG names (the names of list <code>LOD_data</code>) be used as axis labels? If <code>FALSE</code>, numbering is used instead.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>axis_label.cex</code></td>
<td>
<p>Argument to adjust the size of the axis labels. Can be useful if there are many linkage groups to plot</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>custom_LG_names</code></td>
<td>
<p>Option to specify a vector that contains custom linkage group names. By default <code>NULL</code>. See previous argument <code>use_LG_names</code>, which is the usual manner
for controlling x-axis labels.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>LGdiv.col</code></td>
<td>
<p>Colour of dividing lines between linkage groups when <code>layout = "l"</code>, by default grey.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>ylab.at</code></td>
<td>
<p>Distance from the y-axis to place label (by default at 2.5 points)</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>highlight_positions</code></td>
<td>
<p>Option to include a (list of) positions to highlight (e.g. peak QTL positions). Each list element should be a 2-column data.frame with columns giving
the linkage group numbers (numeric) and the corresponding cM positions (numeric) to highlight. If <code>LOD_data</code> is the result of a single genome-wide scan, it is also possible to just directly provide the
2-column data.frame (again, with column 1 containing linkage group numbers and column 2 containing corresponding cM positions).
If <code>LOD_data</code> has been provided as a list of multiple analyses, you may wish to highlight different positions from each analysis. Then <code>highlight_positions</code> should also be a list 
of the same length and in the same order as <code>LOD_data</code>. Each data.frame of positions will be coloured in the same colour as the LOD output.
If no position is to be highlighted for some analyses, add the corresponding list element as <code>NULL</code>. For example, if you wish to highlight positions for analyses 1 and 3 in a 3-analysis overlay, 
then use something like <code>highlight_positions = list(data.frame(lg = 1, cM = 50),NULL,data.frame(lg=c(2,3),cM=c(11,99)))</code>.
The default setting is <code>NULL</code>, meaning no positions are highlighted.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>mainTitle</code></td>
<td>
<p>Option to supply vector of plot titles if <code>layout = "s"</code> or <code>layout = "g"</code>. Argument ignored if using the default layout. Single character vector also allowed and will be recycled.
For no plot titles, leave as default, i.e. <code>FALSE</code></p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>rescale</code></td>
<td>
<p>If results from multiple analyses are to be overlaid and different significance thresholds are detected, then by default plots will be rescaled so that threshold lines overlap.
This behaviour can be disabled by setting <code>rescale = FALSE</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>...</code></td>
<td>
<p>Arguments passed to <code>plot</code>, and <code>lines</code> or <code>points</code> as appropriate (see argument <code>plot_type</code>).</p>
</td>
</tr>
</table>
<h3>Value</h3>

<p>The plot data, if return_plotData = TRUE. Otherwise <code>NULL</code>. Output is returned invisibly
</p>


<h3>Examples</h3>

<pre><code class="language-R">## Not run: 
data("qtl_LODs.4x")
plotQTL(LOD_data = qtl_LODs.4x,layout = "l")

## End(Not run)
</code></pre>


</div>