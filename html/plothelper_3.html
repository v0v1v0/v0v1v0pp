<div class="container">

<table style="width: 100%;"><tr>
<td>annotation_shading_polygon</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>Layer for Drawing a Single 
Irregular Polygon 
with Shading Colors</h2>

<h3>Description</h3>

<p><code>ggplot2::annotation_raster</code> can only 
draw shading rectangles. However, this 
function can draw polygons of any shape 
with shading colors. See the <code>shape</code> 
argument and the <code>raster</code> argument.
</p>


<h3>Usage</h3>

<pre><code class="language-R">annotation_shading_polygon(
  shape = data.frame(c(-1, 1, 0), c(0, 0, 1.732)),
  xmin = NULL,
  xmax = NULL,
  ymin = NULL,
  ymax = NULL,
  raster = NULL,
  interpolate = TRUE,
  result_interpolate = TRUE,
  shape_trim = NULL,
  raster_trim = NULL,
  result_trim = NULL,
  result = c("layer", "magick"),
  width = 800,
  height = NULL,
  res = 72
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>shape</code></td>
<td>
<p>the polygon can be 
a data frame (or matrix object, or tbl_df object) 
with x and y coordinates (that is, with two columns), 
a plot created by ggplot or an image 
read into R by <code>magick::image_read</code>.
If it is a plot created by ggplot, its axes can 
be of numeric, discrete or date/datetime type; 
however, when the type is date/datetime, 
the plot should not use <code>ggplot2::coord_fixed</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>xmin</code></td>
<td>
<p>the left side of the position to 
put the polygon. When 
<code>shape</code> is something like a data frame, 
you do not need to set xmin, xmax, ymin and ymax, 
for the function will generate these values according 
to the coordinates in the polygon.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>xmax</code></td>
<td>
<p>the right side.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>ymin</code></td>
<td>
<p>the bottom side.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>ymax</code></td>
<td>
<p>the top side.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>raster</code></td>
<td>
<p>the shading colors. 
It can be a raster object, 
a matrix of colors, a ggplot plot or an 
image read into R by 
<code>magick::image_read</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>interpolate</code></td>
<td>
<p>the <code>interpolate</code>
argument used by <code>ggplot2::annotation_raster</code>
when the <code>raster</code> argument is a matrix or 
raster.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>result_interpolate</code></td>
<td>
<p>whether to interpolate in the 
final result which is essentially an output of 
<code>ggplot2::annotation_raster</code>. Default is TRUE.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>shape_trim</code></td>
<td>
<p>this argument 
decides whether to trim edges 
of <code>shape</code>.
It should be a number 
between 0 and 100. Default is NULL. If it is NULL, 
no trimming will be done.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>raster_trim</code></td>
<td>
<p>whether to trim raster. 
Most of the time we do want to trim the raster.
However, the <code>magick::image_trim</code> function 
sometimes trims wrongly. So you may want to turn 
it off. Default is NULL.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>result_trim</code></td>
<td>
<p>how to trim the 
final result. If you find your 
figure loses some parts, you can try to turn this off. 
Default is NULL.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>result</code></td>
<td>
<p>when it is "layer", the function is a
ggplot layer. When it is "magick", the function only 
create an image.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>width</code></td>
<td>
<p>the width which will be passed 
to <code>magick::image_graph</code>. Most of the time you do 
not need to modify this. Default is 800. HOWEVER, if the 
final polygon has fuzzy edges, try to enlarge <code>width</code> 
to make them look better.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>height</code></td>
<td>
<p>the height which will be passed 
to <code>magick::image_graph</code>. DO SEE Details below 
to see how to use this parameter.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>res</code></td>
<td>
<p>resolution in pixels which will be passed to 
<code>magick::image_graph</code>. Default is 72.</p>
</td>
</tr>
</table>
<h3>Details</h3>

<p><code>height</code> can be used in the 
following ways: 
</p>

<ul>
<li>
<p> (1) an integer which will be 
directly passed to <code>image::graph</code>.
</p>
</li>
<li>
<p> (2) a character-like integer, 
e.g., <code>height = "0.5"</code>. Suppose <code>width = 400</code>, 
the height that will be used is 400*0.5 = 200. 
This effectively prevents the image from becoming 
too large.
</p>
</li>
<li>
<p> (3) <code>height = "coord_fixed"</code>. 
the ratio between height and width will 
be (top-bottom)/(right-left). And top, bottom,  
right and left are extreme values of <code>shape</code> 
when the latter is of class data.frame/matrix/gg.
</p>
</li>
<li>
<p> (4) <code>height = "image"</code>. the width and height 
will be the width and height of raster when raster is 
a magick object.
</p>
</li>
<li>
<p> (5) <code>height = NULL</code>, the default. 
Now height is computed automatically. 
A ratio is computed first,  
ratio = (top-bottom)/(right-left). if the ratio is larger 
than 5 or smaller than 0.2, then height will be 
width*5 or width*0.2; else, the height will be treated 
in the same way as in (3) above. If <code>shape</code> is 
of class gg and it has uses <code>coord_flip()</code>, the 
height will be automatically adjusted. All these works 
are needed to prevent the image from becoming too large.
</p>
</li>
</ul>
<h3>Examples</h3>

<pre><code class="language-R">
# Example 1
poly=ellipsexy(-1, 0, a=1, b=1)
m=matrix(rainbow(7))
ggplot()+
	coord_fixed()+
	annotation_shading_polygon(
		poly, raster=m
	)+
	annotation_shading_polygon(
		poly, raster=m, 
		xmin=1, xmax=5, 
		ymin=-1, ymax=1, 
	)
#
# Example 2, only an image
tt=annotation_shading_polygon(
	poly, result="magick", 
	width=280, height=280
)
#
# Example 3, both shape and raster are 
# ggplot plots.
p1=ggplot()+geom_tile(aes(x=1: 5, y=1: 5))
p2=ggplot()+geom_polygon(aes(x=c(0, 1, 1, 0), 
		y=c(0, 0, 1, 1)), fill="red")+theme_void()
ggplot()+coord_fixed()+
	annotation_shading_polygon(
		shape=p1, 
		xmin=1, xmax=10, 
		ymin=1, ymax=5, 
		raster=p2
	)

</code></pre>


</div>