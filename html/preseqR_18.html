<div class="container">

<table style="width: 100%;"><tr>
<td>preseqR.sample.cov</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>
Predicting generalized sample coverage
</h2>

<h3>Description</h3>

<p><code>preseqR.sample.cov</code> predicts the probability of observing a species
represented at least <code class="reqn">r</code> times in a random sample.
</p>


<h3>Usage</h3>

<pre><code class="language-R">  preseqR.sample.cov(n, r=1, mt=20)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>n</code></td>
<td>

<p>A two-column matrix.  
The first column is the frequency <code class="reqn">j = 1,2,\dots</code>; and the second column
is <code class="reqn">N_j</code>, the number of species with each species represented exactly <code class="reqn">j</code>
times in the initial sample. The first column must be sorted in an
ascending order.
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>r</code></td>
<td>

<p>A positive integer. Default is 1.
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>mt</code></td>
<td>

<p>A positive integer constraining possible rational function
approximations. Default is 20.
</p>
</td>
</tr>
</table>
<h3>Details</h3>

<p>Suppose a sample is given and one more individual is randomly drawn from the
population. <code>preseqR.sample.cov</code> estimates the probability of the
species, which represents the individual, has been observed at least
<code class="reqn">r</code> times in the
sample. When <code class="reqn">r = 1</code>, the probability is called the sample coverage.
</p>
<p>Let <code class="reqn">N_j</code> be the number of species represented exactly <code class="reqn">j</code> times in 
a sample. The probability of observing a species represented at
least <code class="reqn">r</code> times in the sample is estimated as 
<code class="reqn">\sum_{j=r+1}^\infty jN_j / \sum_{j=1}^\infty jN_j</code>. The theory is
described by Mao and Lindsay (2002). For a random sample
where <code class="reqn">N_j</code> is unknown, a modified rational function approximation is
first used to predict the value of <code class="reqn">N_j</code>. Then the estimates are
substituted to obtain an estimator for the probability of observing a species
represented at least <code class="reqn">r</code> times in the sample.
</p>
<p>This function is the fast version of <code>preseqR.sample.cov.bootstrap</code>.
The function does not provide the confidence interval. To obtain the
confidence interval along with the estimates, one should use the function
<code>preseqR.sample.cov.bootstrap</code>.
</p>


<h3>Value</h3>

<p>The estimator for the probability of observing a species represented at least
<code class="reqn">r</code> times in a random sample.
The input of the estimator is a vector of sampling efforts <code class="reqn">t</code>, i.e.,
the relative sample sizes comparing with the initial sample. 
For example, <code class="reqn">t = 2</code> means a random sample that is twice the size of
the initial sample.
</p>


<h3>Author(s)</h3>

<p>Chao Deng
</p>


<h3>References</h3>

<p>Good, I. J. (1953). The population frequencies of species and the estimation of
population parameters. Biometrika, 40(3-4), 237-264.
</p>
<p>Mao, C. X. and Lindsay, B. G. (2002). A Poisson model for the coverage problem
with a genomic application. Biometrika, 89(3), 669-682.
</p>
<p>Deng, C., Daley, T., Calabrese, P., Ren, J., &amp; Smith, A.D. (2016). Estimating
the number of species to attain sufficient representation in a random sample.
arXiv preprint arXiv:1607.02804v3.
</p>


<h3>Examples</h3>

<pre><code class="language-R">## load library
library(preseqR)

## import data
data(FisherButterfly)

## construct the estimator for the sample coverage
estimator1 &lt;- preseqR.sample.cov(FisherButterfly, r=1) 
## Given a sample that is 10 times or 20 times the size of an initial samples,
## suppose one randomly draws one more individual from the population. The
## value of the function is the probability that the representing species 
## has been observed in the sample
estimator1(c(10, 20))

## construct the estimator
estimator2 &lt;- preseqR.sample.cov(FisherButterfly, r=2)
## the probability a species represented at least twice when the sample size
## is 50 times or 100 times of the initial sample
estimator2(c(50, 100))
</code></pre>


</div>