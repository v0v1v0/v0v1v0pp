<div class="container">

<table style="width: 100%;"><tr>
<td>ssLong.multiTime</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>
Sample size calculation for testing if mean changes for 2 groups are the
same or not for longitudinal study with more than 2 time points
</h2>

<h3>Description</h3>

<p>Sample size calculation for testing if mean changes for 2 groups are the
same or not for longitudinal study with more than 2 time points.
</p>


<h3>Usage</h3>

<pre><code class="language-R">ssLong.multiTime(es, power, nn, sx2, rho = 0.5, alpha = 0.05)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>es</code></td>
<td>

<p>effect size
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>power</code></td>
<td>

<p>power
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>nn</code></td>
<td>

<p>number of observations per subject
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>sx2</code></td>
<td>

<p>within subject variance
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>rho</code></td>
<td>

<p>within subject correlation
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>alpha</code></td>
<td>

<p>type I error rate
</p>
</td>
</tr>
</table>
<h3>Details</h3>

<p>We are interested in comparing the slopes of the 2 groups <code class="reqn">A</code> and <code class="reqn">B</code>:
</p>
<p style="text-align: center;"><code class="reqn">
\beta_{1A} = \beta_{1B}
</code>
</p>

<p>where
</p>
<p style="text-align: center;"><code class="reqn">
Y_{ijA}=\beta_{0A}+\beta_{1A} x_{jA} + \epsilon_{ijA}, j=1, \ldots, nn; i=1, \ldots, m
</code>
</p>

<p>and
</p>
<p style="text-align: center;"><code class="reqn">
Y_{ijB}=\beta_{0B}+\beta_{1B} x_{jB} + \epsilon_{ijB}, j=1, \ldots, nn; i=1, \ldots, m
</code>
</p>

<p>The sample size calculation formula is (Equation on page 30 of Diggle et al. (1994)):
</p>
<p style="text-align: center;"><code class="reqn">
m=\frac{2\left(Z_{1-\alpha}+z_{power}\right)^2 \left(1-\rho\right)}{
nn s_x^2 es^2}
</code>
</p>

<p>where <code class="reqn">es=d/\sigma</code>, <code class="reqn">d</code> is the meaninful differnce of interest, 
<code class="reqn">sigma^2</code> is the variance of the random error, 
<code class="reqn">\rho</code> is the within-subject correlation, and
<code class="reqn">s_x^2</code> is the within-subject variance.
</p>


<h3>Value</h3>

<p>subject per group
</p>


<h3>Note</h3>

<p>The test is a two-sided test. For one-sided tests, please double the 
significance level. For example, you can set <code>alpha=0.10</code>
to obtain one-sided test at 5% significance level.
</p>


<h3>Author(s)</h3>

<p>Weiliang Qiu <a href="mailto:stwxq@channing.harvard.edu">stwxq@channing.harvard.edu</a>
</p>


<h3>References</h3>

<p>Diggle PJ, Liang KY, and Zeger SL (1994). 
Analysis of Longitundinal Data.  page 30.
Clarendon Press, Oxford
</p>


<h3>See Also</h3>

<p><code>powerLong.multiTime</code>
</p>


<h3>Examples</h3>

<pre><code class="language-R"># subject per group = 196
ssLong.multiTime(es=0.5/10, power=0.8, nn=3, sx2=4.22, rho = 0.5, alpha=0.05)
</code></pre>


</div>