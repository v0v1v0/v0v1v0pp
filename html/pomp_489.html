<div class="container">

<table style="width: 100%;"><tr>
<td>wpfilter</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>Weighted particle filter</h2>

<h3>Description</h3>

<p>A sequential importance sampling (particle filter) algorithm.
Unlike in <code>pfilter</code>, resampling is performed only when triggered by
deficiency in the effective sample size.
</p>


<h3>Usage</h3>

<pre><code class="language-R">## S4 method for signature 'data.frame'
wpfilter(
  data,
  Np,
  params,
  rinit,
  rprocess,
  dmeasure,
  trigger = 1,
  target = 0.5,
  ...,
  verbose = getOption("verbose", FALSE)
)

## S4 method for signature 'pomp'
wpfilter(
  data,
  Np,
  trigger = 1,
  target = 0.5,
  ...,
  verbose = getOption("verbose", FALSE)
)

## S4 method for signature 'wpfilterd_pomp'
wpfilter(data, Np, trigger, target, ..., verbose = getOption("verbose", FALSE))
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>data</code></td>
<td>
<p>either a data frame holding the time series data,
or an object of class ‘pomp’,
i.e., the output of another <span class="pkg">pomp</span> calculation.
Internally, <code>data</code> will be coerced to an array with storage-mode <code>double</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>Np</code></td>
<td>
<p>the number of particles to use.
This may be specified as a single positive integer, in which case the same number of particles will be used at each timestep.
Alternatively, if one wishes the number of particles to vary across timesteps, one may specify <code>Np</code> either as a vector of positive integers of length </p>
<pre>length(time(object,t0=TRUE))</pre>
<p> or as a function taking a positive integer argument.
In the latter case, <code>Np(k)</code> must be a single positive integer, representing the number of particles to be used at the <code>k</code>-th timestep:
<code>Np(0)</code> is the number of particles to use going from <code>timezero(object)</code> to <code>time(object)[1]</code>,
<code>Np(1)</code>, from <code>timezero(object)</code> to <code>time(object)[1]</code>,
and so on,
while when <code>T=length(time(object))</code>, <code>Np(T)</code> is the number of particles to sample at the end of the time-series.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>params</code></td>
<td>
<p>optional; named numeric vector of parameters.
This will be coerced internally to storage mode <code>double</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>rinit</code></td>
<td>
<p>simulator of the initial-state distribution.
This can be furnished either as a C snippet, an <span style="font-family: Courier New, Courier; color: #666666;"><b>R</b></span> function, or the name of a pre-compiled native routine available in a dynamically loaded library.
Setting <code>rinit=NULL</code> sets the initial-state simulator to its default.
For more information, see rinit specification.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>rprocess</code></td>
<td>
<p>simulator of the latent state process, specified using one of the rprocess plugins.
Setting <code>rprocess=NULL</code> removes the latent-state simulator.
For more information, see rprocess specification for the documentation on these plugins.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>dmeasure</code></td>
<td>
<p>evaluator of the measurement model density, specified either as a C snippet, an <span style="font-family: Courier New, Courier; color: #666666;"><b>R</b></span> function, or the name of a pre-compiled native routine available in a dynamically loaded library.
Setting <code>dmeasure=NULL</code> removes the measurement density evaluator.
For more information, see dmeasure specification.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>trigger</code></td>
<td>
<p>numeric; if the effective sample size becomes smaller than <code>trigger * Np</code>, resampling is triggered.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>target</code></td>
<td>
<p>numeric; target power.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>...</code></td>
<td>
<p>additional arguments are passed to <code>pomp</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>verbose</code></td>
<td>
<p>logical; if <code>TRUE</code>, diagnostic messages will be printed to the console.</p>
</td>
</tr>
</table>
<h3>Details</h3>

<p><b>This function is experimental and should be considered in alpha stage.
Both interface and underlying algorithms may change without warning at any time.
Please explore the function and give feedback via the <span class="pkg">pomp</span> Issues page.</b>
</p>


<h3>Value</h3>

<p>An object of class ‘wpfilterd_pomp’, which extends class ‘pomp’.
Information can be extracted from this object using the methods documented below.
</p>


<h3>Methods</h3>


<dl>
<dt><code>logLik</code></dt>
<dd>
<p> the estimated log likelihood</p>
</dd>
<dt><code>cond_logLik</code></dt>
<dd>
<p> the estimated conditional log likelihood</p>
</dd>
<dt><code>eff_sample_size</code></dt>
<dd>
<p>the (time-dependent) estimated effective sample size</p>
</dd>
<dt><code>as.data.frame</code></dt>
<dd>
<p> coerce to a data frame</p>
</dd>
<dt><code>plot</code></dt>
<dd>
<p>diagnostic plots</p>
</dd>
</dl>
<h3>Note for Windows users</h3>

<p>Some Windows users report problems when using C snippets in parallel computations.
These appear to arise when the temporary files created during the C snippet compilation process are not handled properly by the operating system.
To circumvent this problem, use the <code>cdir</code> and <code>cfile</code> options to cause the C snippets to be written to a file of your choice, thus avoiding the use of temporary files altogether.
</p>


<h3>Author(s)</h3>

<p>Aaron A. King
</p>


<h3>References</h3>

<p>M.S. Arulampalam, S. Maskell, N. Gordon, and T. Clapp. A tutorial on particle filters for online nonlinear, non-Gaussian Bayesian tracking. <em>IEEE Transactions on Signal Processing</em> <b>50</b>, 174–188, 2002. <a href="https://doi.org/10.1109/78.978374">doi:10.1109/78.978374</a>.
</p>


<h3>See Also</h3>

<p>More on <span class="pkg">pomp</span> elementary algorithms: 
<code>elementary_algorithms</code>,
<code>kalman</code>,
<code>pfilter()</code>,
<code>pomp-package</code>,
<code>probe()</code>,
<code>simulate()</code>,
<code>spect()</code>,
<code>trajectory()</code>
</p>
<p>More on sequential Monte Carlo methods: 
<code>bsmc2()</code>,
<code>cond_logLik()</code>,
<code>eff_sample_size()</code>,
<code>filter_mean()</code>,
<code>filter_traj()</code>,
<code>kalman</code>,
<code>mif2()</code>,
<code>pfilter()</code>,
<code>pmcmc()</code>,
<code>pred_mean()</code>,
<code>pred_var()</code>,
<code>saved_states()</code>
</p>
<p>More on full-information (i.e., likelihood-based) methods:
<code>bsmc2()</code>,
<code>mif2()</code>,
<code>pfilter()</code>,
<code>pmcmc()</code>
</p>


</div>