<div class="container">

<table style="width: 100%;"><tr>
<td>BDportfolio_optim</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>Portfolio Optimization by Benders decomposition</h2>

<h3>Description</h3>

<p>BDportfolio_optim is a linear program  for financial portfolio optimization. 
Portfolio risk is measured by one of the risk measures from the list  c("CVAR", "DCVAR", "LSAD", "MAD"). 
Benders decomposition method is explored to enable optimization for very large returns samples (<code class="reqn">\sim 10^6</code>). 
</p>
<p>The optimization problem is:<br><code class="reqn">\min F({\theta^{T}} r)</code> <br>  
over <br><code class="reqn">\theta^{T} E(r)</code> <code class="reqn">\ge</code> <code class="reqn">portfolio\_return</code>, <br><code class="reqn">LB</code> <code class="reqn">\le \theta \le</code> <code class="reqn">UB</code>, <br><code class="reqn">Aconstr</code> <code class="reqn">\theta \le</code> <code class="reqn">bconstr</code>, <br> 
where <br><code class="reqn">F</code> is a measure of risk; <br><code class="reqn">r</code> is a time series of returns of assets; <br><code class="reqn">\theta</code> is a vector of portfolio weights. <br></p>


<h3>Usage</h3>

<pre><code class="language-R">BDportfolio_optim(dat, portfolio_return,  
risk=c("CVAR", "DCVAR","LSAD","MAD"), alpha=0.95,  
Aconstr=NULL, bconstr=NULL, LB=NULL, UB=NULL, maxiter=500,tol=1e-8)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>dat</code></td>
<td>
<p>Time series of returns data; dat = cbind(rr, pk), where <code class="reqn">rr</code> is an array (time series) of asset returns,
for <code class="reqn">n</code> returns and <code class="reqn">k</code> assets it is an array with <code class="reqn">\dim(rr) = (n, k)</code>,     
<code class="reqn">pk</code> is a vector of length <code class="reqn">n</code> containing probabilities of returns.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>portfolio_return</code></td>
<td>
<p>Target portfolio return.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>risk</code></td>
<td>
<p>Risk measure chosen for optimization; one of "CVAR", "DCVAR", "LSAD", "MAD", where 
"CVAR" – denotes Conditional Value-at-Risk (CVaR),
"DCVAR" – denotes deviation CVaR,
"LSAD" – denotes Lower Semi Absolute Deviation,
"MAD" – denotes Mean Absolute Deviation.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>alpha</code></td>
<td>
<p>Value of alpha quantile used to compute portfolio VaR and CVaR; used also as quantile value for risk measures CVAR and DCVAR.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>Aconstr</code></td>
<td>
<p>Matrix defining additional constraints,   <code class="reqn">\dim (Aconstr) = (m,k)</code>, where 
<code class="reqn">k</code> – number of assets, <code class="reqn">m</code> – number of constraints.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>bconstr</code></td>
<td>
<p>Vector defining additional constraints, length (<code class="reqn">bconstr</code>) <code class="reqn"> = m</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>LB</code></td>
<td>
<p>Vector of length k, lower bounds of portfolio weights <code class="reqn">\theta</code>; warning: condition LB = NULL is equivalent to LB = rep(0, k) (lower bound zero).</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>UB</code></td>
<td>
<p>Vector of length k, upper bounds for portfolio weights <code class="reqn">\theta</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>maxiter</code></td>
<td>
<p>Maximal number of iterations.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>tol</code></td>
<td>
<p>Accuracy of computations, stopping rule.</p>
</td>
</tr>
</table>
<h3>Value</h3>

<p>BDportfolio_optim returns a list with items: 
</p>

<table>
<tr>
<td style="text-align: left;"> 
<code>return_mean</code> </td>
<td style="text-align: left;"> vector of asset returns  mean values. </td>
</tr>
<tr>
<td style="text-align: left;"> 

<code>mu</code> </td>
<td style="text-align: left;">  realized portfolio return.</td>
</tr>
<tr>
<td style="text-align: left;"> 

<code>theta</code> </td>
<td style="text-align: left;">  portfolio weights.</td>
</tr>
<tr>
<td style="text-align: left;"> 

<code>CVaR</code> </td>
<td style="text-align: left;">  portfolio CVaR.</td>
</tr>
<tr>
<td style="text-align: left;"> 

<code>VaR</code> </td>
<td style="text-align: left;">  portfolio VaR.</td>
</tr>
<tr>
<td style="text-align: left;"> 

<code>MAD</code> </td>
<td style="text-align: left;">  portfolio MAD.</td>
</tr>
<tr>
<td style="text-align: left;"> 

<code>risk</code> </td>
<td style="text-align: left;">  portfolio risk measured by the risk measure chosen for optimization.</td>
</tr>
<tr>
<td style="text-align: left;"> 

<code>new_portfolio_return</code> </td>
<td style="text-align: left;">  modified target portfolio return; when the original target portfolio return </td>
</tr>
<tr>
<td style="text-align: left;"> 

 </td>
<td style="text-align: left;"> is to high for the problem, the optimization problem is solved for </td>
</tr>
<tr>
<td style="text-align: left;"> 

 </td>
<td style="text-align: left;"> new_portfolio_return as the target return. </td>
</tr>
<tr>
<td style="text-align: left;"> 
</td>
</tr>
</table>
<h3>References</h3>

<p>Benders, J.F.,   Partitioning procedures for solving mixed-variables programming problems. Number. Math., 4 (1962),  238–252, reprinted in 
Computational Management Science 2 (2005), 3–19. DOI: 10.1007/s10287-004-0020-y. 
</p>
<p>Konno, H., Piecewise linear risk function and portfolio optimization, Journal of the Operations Research Society of Japan, 33 (1990), 139–156. 
</p>
<p>Konno, H., Yamazaki, H.,  Mean-absolute deviation portfolio optimization model and its application to Tokyo stock market. Management Science, 37 (1991), 519–531. 
</p>
<p>Konno, H., Waki, H.,   Yuuki, A., Portfolio optimization under lower partial risk measures, Asia-Pacific Financial Markets, 9 (2002), 127–140. DOI: 10.1023/A:1022238119491. 
</p>
<p>Kunzi-Bay, A.,  Mayer, J., Computational aspects of minimizing conditional value at risk. Computational Management Science, 3 (2006), 3–27. DOI: 10.1007/s10287-005-0042-0. 
</p>
<p>Rockafellar, R.T., Uryasev, S.,  Optimization of conditional value-at-risk. Journal of Risk, 2 (2000), 21–41. DOI: 10.21314/JOR.2000.038.  
</p>
<p>Rockafellar, R. T., Uryasev, S.,  Zabarankin, M.,  Generalized deviations in risk analysis. Finance and Stochastics, 10 (2006), 51–74. DOI: 10.1007/s00780-005-0165-8.
</p>


<h3>Examples</h3>

<pre><code class="language-R">
library (Rsymphony)  
library(Rglpk) 
library(mvtnorm)
k = 3 
num =100
dat &lt;-  cbind(rmvnorm (n=num, mean = rep(0,k), sigma=diag(k)), matrix(1/num,num,1)) 
# a data sample with num rows and (k+1) columns for k assets; 
port_ret = 0.05 # target portfolio return 
alpha_optim = 0.95 

# minimal constraints set: \eqn{\sum \theta_{i} = 1} 
# has to be in two inequalities: \eqn{1 - \epsilon &lt;= \sum \theta_{i} &lt;= 1 + \epsilon} 
a0 &lt;- rep(1,k) 
Aconstr &lt;- rbind(a0,-a0) 
bconstr &lt;- c(1+1e-8, -1+1e-8) 

LB &lt;- rep(0,k) 
UB &lt;- rep(1,k) 

res &lt;- BDportfolio_optim(dat, port_ret, "CVAR", alpha_optim, 
Aconstr, bconstr, LB, UB, maxiter=200, tol=1e-8) 

cat ( c("Benders decomposition portfolio:\n\n")) 
cat(c("weights \n")) 
print(res$theta) 

cat(c("\n mean = ", res$mu, " risk  = ", res$risk, 
"\n CVaR = ", res$CVaR, " VaR = ", res$VaR, "\n MAD = ", res$MAD, "\n\n")) 
 

</code></pre>


</div>