<div class="container">

<table style="width: 100%;"><tr>
<td>PROJOT</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>Orthogonal Tensor projection </h2>

<h3>Description</h3>

<p>Orthogonal-tensoriel projection of a tensor according to a rank-1
tensor, or a to bigger structure defined by kronecker product of
matrices. </p>


<h3>Usage</h3>

<pre><code class="language-R"> PROJOT(X,solu,numo=1,bortho=TRUE,Ortho=TRUE,metrics=NULL)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>X</code></td>
<td>
<p>a tensor(as an array) of any order </p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>solu</code></td>
<td>
<p>an object like a <code>solutions.PTAk</code> object with at least <code>v</code></p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>numo</code></td>
<td>

<p>a vector of numbers  or a list of vectors  (length the order of the
tensor) identifying for each space the structure to project onto, if
NULL for a specific space then no projection is done for this space</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>bortho</code></td>
<td>
<p>list of logicals saying if the structures are othogonal
or not.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>Ortho</code></td>
<td>

<p>list of logicals telling the projectors on each space to be  on the
structure  or on its orthogonal.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>metrics</code></td>
<td>
<p>NULL or list of metrics (either diagonal or not) for each entry of <code>X</code></p>
</td>
</tr>
</table>
<h3>Details</h3>

<p>This function computes the <em>tensorial orthogonal projection</em> of
<code>X</code> onto the <em>tensorial structure</em> defined by <code>solu</code>
and <code>numo</code>. For each space (involved in the tensorial product
where from  <code>X</code> belongs), one defined the projector onto
<code>solu[[i]]$v[numo,]</code> (or on its orthogonal if
<code>Ortho[[i]]==TRUE</code>), then the result is the image of <code>X</code> by
the tensorial product of the projectors, i.e.
</p>
<p style="text-align: center;"><code class="reqn">(P_{S1} \otimes P_{S2} \otimes \ldots \otimes P_{Sk})(X)</code>
</p>
<p>.
</p>


<h3>Value</h3>

<p>A tensor with dimensions as <code>X</code></p>


<h3>Note</h3>

<p>For PTA-<em>k</em>modes the projection used is only on rank-one tensors
(Principal Tensors), <em>i.e.</em> <code>numo</code> is a number. The code
here can be used for any structure (on each spaces) and constitutes
the projector onto a tensorial structure, and can define the
PTAIV-<em>k</em>modes (PTAk on Instrumental Variables Leibovici(1993).
(see other references  for tensorial product of linear operators in
Leibovici(2000) <em>e.g.</em> Dauxois et al.(1994))</p>


<h3>Author(s)</h3>

<p>Didier G. Leibovici <a href="mailto:GeotRycs@gmail.com">GeotRycs@gmail.com</a></p>


<h3>References</h3>

<p>Leibovici D(1993) <em>Facteurs &lt;e0&gt; Mesures R&lt;e9&gt;p&lt;e9&gt;t&lt;e9&gt;es et Analyses Factorielles :
applications &lt;e0&gt; un suivi &lt;e9&gt;pid&lt;e9&gt;miologique</em>. Universit&lt;e9&gt; de Montpellier
II. PhD Thesis in Math&lt;e9&gt;matiques et Applications (Biostatistiques).
</p>
<p>Leibovici D (2000) <em>Multiway Multidimensional Analysis for
Pharmaco-EEG Studies</em>. <a href="http://www.fmrib.ox.ac.uk/analysis/techrep/tr00dl2/tr00dl2.pdf">http://www.fmrib.ox.ac.uk/analysis/techrep/tr00dl2/tr00dl2.pdf</a>
</p>


<h3>See Also</h3>

<p><code>PTAk</code> </p>


<h3>Examples</h3>

<pre><code class="language-R">
don &lt;- array(1:360,c(5,4,6,3))
 don &lt;- don + rnorm(360,10,2)

 ones &lt;- list(list(v=rep(1,5)),list(v=rep(1,4)),list(v=rep(1,6)),list(v=rep(1,3)))
 donfc &lt;- PROJOT(don,ones)

 apply(donfc,c(2,3,4),mean)
 apply(donfc,c(1),mean)

  # implementation de PTAIVk with obvious settings
 PTAIVk &lt;- function(X,STruct,...)
         {X &lt;- PROJOT(X$data,STruct,numo=Struct[[1]]$numo,Ortho=Struct[[1]]$Ortho,metrics=X$met)
         PTAk(X,...)
         }

   </code></pre>


</div>