<div class="container">

<table style="width: 100%;"><tr>
<td>fillPCMatrix</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>Calculate and Record Causality Strengths</h2>

<h3>Description</h3>

<p>Computes the causality strengths based on the comparison between predicted and real patterns
and signatures in a system's dynamic model. It applies a normalization function to measure the intensity of
causal influences and uses an error function for weighting if required.
</p>


<h3>Usage</h3>

<pre><code class="language-R">fillPCMatrix(
  weighted,
  predictedPatternY,
  realPatternY,
  predictedSignatureY,
  realSignatureY,
  patternX,
  signatureX
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>weighted</code></td>
<td>
<p>Logical, if TRUE, the causality strength is calculated using the error function for normalization,
otherwise a binary indication (1 for accurate prediction and 0 otherwise) is used.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>predictedPatternY</code></td>
<td>
<p>Numeric vector, the predicted pattern of variable Y at a future time step.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>realPatternY</code></td>
<td>
<p>Numeric vector, the actual observed pattern of variable Y at the same future time step.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>predictedSignatureY</code></td>
<td>
<p>Numeric vector, the predicted signature vector derived from the system model for Y.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>realSignatureY</code></td>
<td>
<p>Numeric vector, the actual observed signature vector for Y.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>patternX</code></td>
<td>
<p>Numeric vector, the current observed pattern of variable X, used as the basis for prediction.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>signatureX</code></td>
<td>
<p>Numeric vector, the current observed signature vector of variable X.</p>
</td>
</tr>
</table>
<h3>Details</h3>

<p>Fill Pattern Causality Matrix with Causality Strengths
</p>
<p>This function calculates and fills the causality strengths between predicted and real patterns and signatures
for a complex system analysis. It evaluates the accuracy of predictions and computes the strength of causal
relationships based on norm vectors and optionally weights these strengths using the error function (erf).
</p>


<h3>Value</h3>

<p>A dataframe with two columns: 'real' and 'predicted', representing the real and predicted causality strengths.
</p>


<h3>Examples</h3>

<pre><code class="language-R">set.seed(123)
E &lt;- 3
tau &lt;- 1
Mx &lt;- matrix(rnorm(200), nrow = 20)
My &lt;- matrix(rnorm(200), nrow = 20)
Dx &lt;- distanceMatrix(Mx, "minkowski")
Dy &lt;- distanceMatrix(My, "minkowski")
SMx &lt;- signatureSpace(Mx, E)
SMy &lt;- signatureSpace(My, E)
PSMx &lt;- patternSpace(SMx, E)
PSMy &lt;- patternSpace(SMy, E)
CCSPAN &lt;- (E - 1) * tau
NNSPAN &lt;- E + 1
i &lt;- 15
h &lt;- 2
NNx &lt;- pastNNsInfo(CCSPAN, NNSPAN, Mx, Dx, SMx, PSMx, i, h)
timesX &lt;- NNx$times
projNNy &lt;- projectedNNsInfo(My, Dy, SMy, PSMy, timesX, i, h)
pSY &lt;- predictionY(E, projNNy, zeroTolerance = E - 1)$predictedSignatureY
pPY &lt;- predictionY(E, projNNy, zeroTolerance = E - 1)$predictedPatternY[1]
rSY &lt;- SMy[(i + h), ]
rPY &lt;- PSMy[i + h]
signatureX &lt;- SMx[i, ]
patternX &lt;- PSMx[i, ]
weighted &lt;- 0
pc &lt;- fillPCMatrix(weighted, pPY, rPY, pSY, rSY, patternX, signatureX)
</code></pre>


</div>