<div class="container">

<table style="width: 100%;"><tr>
<td>convert_dia</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>Searches diagnosis columns for given diseases.</h2>

<h3>Description</h3>

<p>Analyzes diagnosis data loaded using <em>load_dia</em>. Searches diagnosis columns for a specified set of diseases.
By default, the data.table is returned with new columns corresponding to boolean values, whether given group of diagnoses are present among the diagnoses.
If <em>collapse</em> is given, then the information is aggregated based-on the <em>collapse</em> column and the earliest of latest time of the given diagnosis is provided.
</p>


<h3>Usage</h3>

<pre><code class="language-R">convert_dia(
  d,
  code = "dia_code",
  code_type = "dia_code_type",
  codes_to_find = NULL,
  collapse = NULL,
  code_time = "time_dia",
  aggr_type = "earliest",
  nThread = parallel::detectCores() - 1
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>d</code></td>
<td>
<p>data.table, database containing diagnosis information data loaded using the <em>load_dia</em> function.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>code</code></td>
<td>
<p>string, column name of the diagnosis code column. Defaults to <em>dia_code</em>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>code_type</code></td>
<td>
<p>string, column name of the code_type column. Defaults to <em>dia_code_type</em>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>codes_to_find</code></td>
<td>
<p>list, a list of string arrays corresponding to sets of code types and codes separated by <em>:</em>, i.e.: "ICD9:250.00".
The function searches for the given disease code type and code pair and adds new boolean columns with the name of each list element.
These columns are indicators whether any of the disease code type and code pair occurs in the set of codes.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>collapse</code></td>
<td>
<p>string, a column name on which to collapse the data.table.
Used in case we wish to assess whether given disease codes are present within all the same instances of <em>collapse</em>. See vignette for details.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>code_time</code></td>
<td>
<p>string, column name of the time column. Defaults to <em>time_dia</em>. Used in case collapse is present to provide the earliest or latest instance of diagnosing the given disease.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>aggr_type</code></td>
<td>
<p>string, if multiple diagnoses are present within the same case of <em>collapse</em>, which timepoint to return. Supported are: "earliest" or "latest". Defaults to <em>earliest</em>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>nThread</code></td>
<td>
<p>integer, number of threads to use for parallelization. If it is set to 1, then no parallel backends are created and the function is executed sequentially.</p>
</td>
</tr>
</table>
<h3>Value</h3>

<p>data.table, with indicator columns whether the any of the given diagnoses are reported.
If <em>collapse</em> is present, then only unique ID and the summary columns are returned.
</p>


<h3>Examples</h3>

<pre><code class="language-R">## Not run: 
#Search for Hypertension and Stroke ICD codes
diseases &lt;- list(HT = c("ICD10:I10"), Stroke = c("ICD9:434.91", "ICD9:I63.50"))
data_dia_parse &lt;- convert_dia(d = data_dia, codes_to_find = diseases, nThread = 2)

#Search for Hypertension and Stroke ICD codes and summarize per patient providing earliest time
diseases &lt;- list(HT = c("ICD10:I10"), Stroke = c("ICD9:434.91", "ICD9:I63.50"))
data_dia_disease &lt;-  convert_dia(d = data_dia, codes_to_find = diseases, nThread = 2,
collapse = "ID_MERGE", aggr_type = "earliest")

## End(Not run)
</code></pre>


</div>