<div class="container">

<table style="width: 100%;"><tr>
<td>phyloCorrelogram</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>Phylogenetic correlogram</h2>

<h3>Description</h3>

<p>This function computes a phylogenetic correlogram.
</p>


<h3>Usage</h3>

<pre><code class="language-R">phyloCorrelogram(
  p4d,
  trait = names(tdata(p4d)),
  dist.phylo = "patristic",
  sigma = NULL,
  n.points = 100,
  ci.bs = 1000,
  ci.conf = 0.95
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>p4d</code></td>
<td>
<p>a <code>phylo4d</code> object.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>trait</code></td>
<td>
<p>the traits in the <code>phylo4d</code> object to use for the correlogram.
Can be a character vector giving the name of the traits or numbers giving the column index
in the table of the data slot of the <code>phylo4d</code> object.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>dist.phylo</code></td>
<td>
<p>a matrix of phylogenetic distances or a character string specifying a method to compute it.
See Details.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>sigma</code></td>
<td>
<p>a numeric value giving the standard deviation of the normal distribution used
to compute the matrix of phylogenetic weights. If <code>NULL</code> (default),
the function computes a value from the phylogeny.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>n.points</code></td>
<td>
<p>an integer giving the number of points at which to compute the correlogram's statistics.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>ci.bs</code></td>
<td>
<p>an integer giving the number of bootstrap replicates for confidence interval estimation.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>ci.conf</code></td>
<td>
<p>a value between 0 and 1 giving the confidence level of the confidence interval.</p>
</td>
</tr>
</table>
<h3>Details</h3>

<p>This function computes a correlogram on a continuous scale of phylogenetic distance.
This is achieved by using a collection of specific phylogenetic weights matrices generated
with the "<code>lag-norm</code>" method of <code>phyloWeights</code> and different values of "<code>mu</code>".
</p>
<p>The confidence envelope is computed by bootstrapping.
At each iteration, the autocorrelation is re-estimated after re-standardization of the
matrix of phylogenetic weights.
The nonparametric confidence intervals are computed at each lag by first order normal approximation.
Intervals are constrained between 0 and 1.
</p>
<p>If there is one trait, the function computes Moran's I. If there is more than one trait,
the function computes the Mantel's statistic (Oden and Sokal 1986).
</p>
<p>If "<code>dist.phylo</code>" is a character string,
the phylogenetic distance matrix is computed internally
using the function <code>distTips</code> from the package <span class="pkg">adephylo</span>.
See <code>distTips</code> for details about the methods.
</p>


<h3>Value</h3>

<p>An object of class "<code>phylocorrelogram</code>".
</p>


<h3>References</h3>

<p>Oden N.L. &amp; Sokal R.R. (1986) Directional Autocorrelation: An Extension of Spatial Correlograms to Two Dimensions. Systematic Zoology 35, 608-617.
</p>


<h3>See Also</h3>

<p><code>plot.phylocorrelogram</code>,
<code>correlogram.formula</code> in <span class="pkg">ape</span> for correlograms based on taxonomic levels.
</p>


<h3>Examples</h3>

<pre><code class="language-R">## Not run: 
data(navic)
pc &lt;- phyloCorrelogram(navic)
plot(pc)

## End(Not run)
</code></pre>


</div>