<div class="container">

<table style="width: 100%;"><tr>
<td>findNN</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>find index of nearest neighbor</h2>

<h3>Description</h3>

<p>Given a vector of sorted double values <code>vec</code> of size
<code>n</code> and a vector of <code>m</code> query objects <code>q</code>. 
</p>
<p><code>findNN</code> determines for each element <code>q[i]</code> in <code>q</code> 
the nearest neighbor index <code>o</code> so that the following remains true:
</p>
<p>there is no element <code>k</code> with <code>1</code> <code class="reqn">\le</code> <code>k</code> 
<code class="reqn">\le</code> <code>n</code> and <code>k</code> is not <code>o</code> so that 
</p>
<p><code>abs(vec[k] - q[i])</code> &lt; <code>abs(vec[o] - q[i])</code>. 
</p>


<h3>Usage</h3>

<pre><code class="language-R">
    findNN(q, vec, check) 
    findNN_(q, vec, check) 

</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>q</code></td>
<td>
<p>a double vector which can be considered as query objects.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>vec</code></td>
<td>
<p>a sorted double vector which can be considered as a data base.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>check</code></td>
<td>
<p>boolean enables test if <code>vec</code> is sorted. default is
<code>FALSE</code>.</p>
</td>
</tr>
</table>
<h3>Details</h3>

<p>The internal algorithm of <code>findNN</code> is implemented as binary search.
<code>findNN</code> has <code class="reqn">O(m * log_2(n))</code> time complexity where n is defined as 
<code>length(vec)</code> and m is <code>length(m)</code>. 
</p>
<p><code>findNN</code> is implemented using C library function - bsearch(),
while <code>findNN_</code> uses C++11 STL function lower_bound().
</p>


<h3>Author(s)</h3>

<p>Christian Panse 2007, 2008, 2009, 2010, 2012 , 2015
based on the C++ STL lower_bound method.
</p>


<h3>References</h3>


<ul><li>
<p><a href="https://cplusplus.com/reference/algorithm/lower_bound/">https://cplusplus.com/reference/algorithm/lower_bound/</a>
</p>
</li></ul>
<h3>See Also</h3>

<p><code>findInterval</code>
</p>


<h3>Examples</h3>

<pre><code class="language-R">
    (NNidx &lt;- findNN(q &lt;- c(1, 1.0001, 1.24, 1.26), DB &lt;- seq(1, 5 , by = 0.25)))
    (NNidx == c(1, 1, 2, 2))

    DB &lt;- sort(rnorm(100, mean=100, sd = 10))

    # should be 0
    unique(DB[findNN(DB,DB)] - DB)

    q &lt;- rnorm(100, mean=100)

    idx.NN &lt;- findNN(q,DB)
    hist(DB[findNN(q,DB)] - q)

    # definition of findNN holds
    i &lt;- 1:5
    findNN(3.5, i)

    i &lt;- 1:6
    findNN(3.5, i)
    
     # compare ANSI-C binary search with C++ std::lower_bound
    DB &lt;- c(rep(1.0, 3), rep(2.0, 3))
    q &lt;- c(-1, 1.0, 1.01, 1.5, 1.9)
    abs(DB[findNN(q, DB)] - q)
    abs(DB[findNN_(q, DB)] - q)


    DB &lt;- sort(rnorm(100, mean=100, sd=10))
    # should be 0
    unique(DB[findNN_(DB,DB)] - DB)

    q &lt;- rnorm(100, mean=100)

    idx.NN &lt;- findNN_(q, DB)
    hist(DB[findNN_(q, DB)] - q)

    # definition of findNN_ holds
    i &lt;- 1:5
    findNN_(3.5, i)

    i &lt;- 1:6
    findNN_(3.5, i)
</code></pre>


</div>