<div class="container">

<table style="width: 100%;"><tr>
<td>treedist</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>Distances between trees</h2>

<h3>Description</h3>

<p><code>treedist</code> computes different tree distance methods and <code>RF.dist</code>
the Robinson-Foulds or symmetric distance. The Robinson-Foulds distance only
depends on the topology of the trees. If edge weights should be considered
<code>wRF.dist</code> calculates the weighted RF distance (Robinson &amp; Foulds
1981). and <code>KF.dist</code> calculates the branch score distance (Kuhner &amp;
Felsenstein 1994).  <code>path.dist</code> computes the path difference metric as
described in Steel and Penny 1993).
<code>sprdist</code> computes the approximate SPR distance (Oliveira Martins et
al. 2008, de Oliveira Martins 2016).
</p>


<h3>Usage</h3>

<pre><code class="language-R">treedist(tree1, tree2, check.labels = TRUE)

sprdist(tree1, tree2)

SPR.dist(tree1, tree2 = NULL)

RF.dist(tree1, tree2 = NULL, normalize = FALSE, check.labels = TRUE,
  rooted = FALSE)

wRF.dist(tree1, tree2 = NULL, normalize = FALSE, check.labels = TRUE,
  rooted = FALSE)

KF.dist(tree1, tree2 = NULL, check.labels = TRUE, rooted = FALSE)

path.dist(tree1, tree2 = NULL, check.labels = TRUE, use.weight = FALSE)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>tree1</code></td>
<td>
<p>A phylogenetic tree (class <code>phylo</code>) or vector of trees (an
object of class <code>multiPhylo</code>). See details</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>tree2</code></td>
<td>
<p>A phylogenetic tree.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>check.labels</code></td>
<td>
<p>compares labels of the trees.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>normalize</code></td>
<td>
<p>compute normalized RF-distance, see details.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>rooted</code></td>
<td>
<p>take bipartitions for rooted trees into account, default is
unrooting the trees.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>use.weight</code></td>
<td>
<p>use edge.length argument or just count number of edges on
the path (default)</p>
</td>
</tr>
</table>
<h3>Details</h3>

<p>The Robinson-Foulds distance between two trees <code class="reqn">T_1</code> and
<code class="reqn">T_2</code> with <code class="reqn">n</code> tips is defined as (following the notation Steel and
Penny 1993):
</p>
<p style="text-align: center;"><code class="reqn">d(T_1, T_2) = i(T_1) + i(T_2) - 2v_s(T_1, T_2)</code>
</p>
<p> where <code class="reqn">i(T_1)</code>
denotes the number of internal edges and <code class="reqn">v_s(T_1, T_2)</code> denotes the
number of internal splits shared by the two trees. The normalized
Robinson-Foulds distance is derived by dividing <code class="reqn">d(T_1, T_2)</code> by the
maximal possible distance <code class="reqn">i(T_1) + i(T_2)</code>. If both trees are unrooted
and binary this value is <code class="reqn">2n-6</code>.
</p>
<p>Functions like <code>RF.dist</code> returns the Robinson-Foulds distance (Robinson
and Foulds 1981) between either 2 trees or computes a matrix of all pairwise
distances if a <code>multiPhylo</code> object is given.
</p>
<p>For large number of trees the distance functions can use a lot of memory!
</p>


<h3>Value</h3>

<p><code>treedist</code> returns a vector containing the following tree
distance methods </p>
<table>
<tr style="vertical-align: top;">
<td><code>symmetric.difference</code></td>
<td>
<p>symmetric.difference or
Robinson-Foulds distance</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>branch.score.difference</code></td>
<td>
<p>branch.score.difference</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>path.difference</code></td>
<td>
<p>path.difference</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>weighted.path.difference</code></td>
<td>
<p>weighted.path.difference</p>
</td>
</tr>
</table>
<h3>Author(s)</h3>

<p>Klaus P. Schliep <a href="mailto:klaus.schliep@gmail.com">klaus.schliep@gmail.com</a>,
Leonardo de Oliveira Martins
</p>


<h3>References</h3>

<p>de Oliveira Martins L., Leal E., Kishino H. (2008)
<em>Phylogenetic Detection of Recombination with a Bayesian Prior on the
Distance between Trees</em>. PLoS ONE <b>3(7)</b>. e2651. doi:
10.1371/journal.pone.0002651
</p>
<p>de Oliveira Martins L., Mallo D., Posada D. (2016) <em>A Bayesian
Supertree Model for Genome-Wide Species Tree Reconstruction</em>. Syst. Biol.
<b>65(3)</b>: 397-416, doi:10.1093/sysbio/syu082
</p>
<p>Steel M. A. and Penny P. (1993) <em>Distributions of tree comparison
metrics - some new results</em>, Syst. Biol., <b>42(2)</b>, 126–141
</p>
<p>Kuhner, M. K. and Felsenstein, J. (1994) <em>A simulation comparison of
phylogeny algorithms under equal and unequal evolutionary rates</em>, Molecular
Biology and Evolution, <b>11(3)</b>, 459–468
</p>
<p>D.F. Robinson and L.R. Foulds (1981) <em>Comparison of phylogenetic
trees</em>, Mathematical Biosciences, <b>53(1)</b>, 131–147
</p>
<p>D.F. Robinson and L.R. Foulds (1979) Comparison of weighted labelled trees.
In Horadam, A. F. and Wallis, W. D. (Eds.), <em>Combinatorial Mathematics
VI: Proceedings of the Sixth Australian Conference on Combinatorial
Mathematics, Armidale, Australia</em>, 119–126
</p>


<h3>See Also</h3>

<p><code>dist.topo</code>, <code>nni</code>,
<code>superTree</code>, <code>mast</code>
</p>


<h3>Examples</h3>

<pre><code class="language-R">
tree1 &lt;- rtree(100, rooted=FALSE)
tree2 &lt;- rSPR(tree1, 3)
RF.dist(tree1, tree2)
treedist(tree1, tree2)
sprdist(tree1, tree2)
trees &lt;- rSPR(tree1, 1:5)
SPR.dist(tree1, trees)

</code></pre>


</div>