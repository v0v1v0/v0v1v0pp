<div class="container">

<table style="width: 100%;"><tr>
<td>simultest.chisq</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>Two-sample simultaneous test using chi-squared approximation</h2>

<h3>Description</h3>

<p>This function implements the two-sample simultaneous test on high-dimensional
mean vectors and covariance matrices using chi-squared approximation.
Suppose <code class="reqn">\{\mathbf{X}_1, \ldots, \mathbf{X}_{n_1}\}</code> are i.i.d.
copies of <code class="reqn">\mathbf{X}</code>, and <code class="reqn">\{\mathbf{Y}_1, \ldots, \mathbf{Y}_{n_2}\}</code>
are i.i.d. copies of <code class="reqn">\mathbf{Y}</code>.
Let <code class="reqn">M_{CQ}/\hat\sigma_{M_{CQ}}</code> denote
the <code class="reqn">l_2</code>-norm-based mean test statistic proposed in Chen and Qin (2010)
(see <code>meantest.cq</code> for details),
and let <code class="reqn">T_{LC}/\hat\sigma_{T_{LC}}</code>
denote the <code class="reqn">l_2</code>-norm-based covariance test statistic
proposed in Li and Chen (2012) (see <code>covtest.lc</code> for details).
The simultaneous test statistic via chi-squared approximation is defined as
</p>
<p style="text-align: center;"><code class="reqn">S_{n_1, n_2} = M_{CQ}^2/\hat\sigma^2_{M_{CQ}} + T_{LC}^2/\hat\sigma^2_{T_{LC}}.</code>
</p>

<p>It has been proved that with some regularity conditions, under the null hypothesis
<code class="reqn">H_0: \boldsymbol{\mu}_1 = \boldsymbol{\mu}_2 \ \text{ and }
\ \mathbf{\Sigma}_1 = \mathbf{\Sigma}_2</code>,
the two tests are asymptotically independent as <code class="reqn">n_1, n_2, p\rightarrow \infty</code>,
and therefore <code class="reqn">S_{n_1,n_2}</code> asymptotically converges in distribution to
a <code class="reqn">\chi_2^2</code> distribution.
The asymptotic <code class="reqn">p</code>-value is obtained by
</p>
<p style="text-align: center;"><code class="reqn">p\text{-value} = 1-F_{\chi_2^2}(S_{n_1,n_2}),</code>
</p>

<p>where <code class="reqn">F_{\chi_2^2}(\cdot)</code> is the cdf of the <code class="reqn">\chi_2^2</code> distribution.
</p>


<h3>Usage</h3>

<pre><code class="language-R">simultest.chisq(dataX,dataY)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>dataX</code></td>
<td>
<p>n1 by p data matrix</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>dataY</code></td>
<td>
<p>n2 by p data matrix</p>
</td>
</tr>
</table>
<h3>Value</h3>

<p><code>stat</code> the value of test statistic
</p>
<p><code>pval</code> the p-value for the test.
</p>


<h3>References</h3>

<p>Yu, X., Li, D., Xue, L., and Li, R. (2022). Power-enhanced simultaneous test
of high-dimensional mean vectors and covariance matrices with application
to gene-set testing. <em>Journal of the American Statistical Association</em>,
(in press):1â€“14.
</p>


<h3>Examples</h3>

<pre><code class="language-R">n1 = 100; n2 = 100; pp = 500
set.seed(1)
X = matrix(rnorm(n1*pp), nrow=n1, ncol=pp)
Y = matrix(rnorm(n2*pp), nrow=n2, ncol=pp)
simultest.chisq(X,Y)
</code></pre>


</div>