<div class="container">

<table style="width: 100%;"><tr>
<td>pool.var</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>Compute a pooled variance</h2>

<h3>Description</h3>

<p>Computes a pooled variance from samples in a paleontological
time-series
</p>


<h3>Usage</h3>

<pre><code class="language-R">pool.var(y, nn = NULL, minN = NULL, ret.paleoTS = FALSE)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>y</code></td>
<td>
<p>either a <code>paleoTS</code> object, or a vector of sample variances</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>nn</code></td>
<td>
<p>a vector of sample sizes</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>minN</code></td>
<td>
<p>sample size below which variances are replaced with pooled
variances. See Details.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>ret.paleoTS</code></td>
<td>
<p>if TRUE, a <code>paleoTS</code> object is returned. If FALSE,
the value of the pooled variance is returned.</p>
</td>
</tr>
</table>
<h3>Details</h3>

<p>A pooled variance of a set of populations is the weighted average
of the individual variances of the populations, with the weight for each
population equal to its sample size minus one. <br><br> For many kinds of
traits, variation levels tend to be similar among closely related
populations. When this is true and sample sizes are low, much of the
observed differences in variance among samples will be due to the high
noise of estimated the variances. Replacing the observed variances of all
populations (or only those with <code>nn &lt; minN</code>) with the estimated pooled
variance can reduce this noise.
</p>


<h3>Value</h3>

<p>if <code>ret.paleoTS = TRUE</code> a <code>paleoTS</code> object with all (or
some) variances replaced with the pooled variance; otherwise the pooled
variance
</p>


<h3>Examples</h3>

<pre><code class="language-R">data(cantius_L)
cant_all &lt;- pool.var(cantius_L, ret.paleoTS = TRUE)   # replace all variances with pooled variance
cant_n5  &lt;- pool.var(cantius_L, minN = 5, ret.paleoTS = TRUE)  # replace only pops with n &lt; 5

</code></pre>


</div>