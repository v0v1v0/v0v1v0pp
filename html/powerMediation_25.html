<div class="container">

<table style="width: 100%;"><tr>
<td>ssLong</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>
Sample size calculation for longitudinal study with 2 time point
</h2>

<h3>Description</h3>

<p>Sample size calculation for testing if mean changes for 2 groups are the same or not for longitudinal study with 2 time point.
</p>


<h3>Usage</h3>

<pre><code class="language-R">ssLong(es, 
       rho = 0.5, 
       alpha = 0.05, 
       power = 0.8)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>es</code></td>
<td>

<p>effect size of the difference of mean change.
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>rho</code></td>
<td>

<p>correlation coefficient between baseline and follow-up values within a treatment group.
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>alpha</code></td>
<td>

<p>Type I error rate.
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>power</code></td>
<td>

<p>power for testing for difference of mean changes.
</p>
</td>
</tr>
</table>
<h3>Details</h3>

<p>The sample size formula is based on Equation 8.30 on page 335 of Rosner (2006).
</p>
<p style="text-align: center;"><code class="reqn">
n=\frac{2\sigma_d^2 (Z_{1-\alpha/2} + Z_{power})^2}{\delta^2}
</code>
</p>

<p>where <code class="reqn">\sigma_d = \sigma_1^2+\sigma_2^2-2\rho\sigma_1\sigma_2</code>, <code class="reqn">\delta=|\mu_1 - \mu_2|</code>,
<code class="reqn">\mu_1</code> is the mean change over time <code class="reqn">t</code> in group 1, 
<code class="reqn">\mu_2</code> is the mean change over time <code class="reqn">t</code> in group 2, 
<code class="reqn">\sigma_1^2</code> is the variance of baseline values within a treatment group,
<code class="reqn">\sigma_2^2</code> is the variance of follow-up values within a treatment group,
<code class="reqn">\rho</code> is the correlation coefficient between baseline and follow-up values within a treatment group,
and <code class="reqn">Z_u</code> is the u-th percentile of the standard normal distribution.
</p>
<p>We wish to test <code class="reqn">\mu_1 = \mu_2</code>.
</p>
<p>When <code class="reqn">\sigma_1=\sigma_2=\sigma</code>, then formula reduces to
</p>
<p style="text-align: center;"><code class="reqn">
n=\frac{4(1-\rho)(Z_{1-\alpha/2}+Z_{\beta})^2}{d^2}
</code>
</p>

<p>where <code class="reqn">d=\delta/\sigma</code>.
</p>


<h3>Value</h3>

<p>required sample size per group
</p>


<h3>Note</h3>

<p>The test is a two-sided test. For one-sided tests, please double the 
significance level. For example, you can set <code>alpha=0.10</code>
to obtain one-sided test at 5% significance level.
</p>


<h3>Author(s)</h3>

<p>Weiliang Qiu <a href="mailto:stwxq@channing.harvard.edu">stwxq@channing.harvard.edu</a>
</p>


<h3>References</h3>

<p>Rosner, B.
<em>Fundamentals of Biostatistics</em>. Sixth edition. Thomson Brooks/Cole. 2006.
</p>


<h3>See Also</h3>

<p><code>ssLongFull</code>, <code>powerLong</code>, 
<code>powerLongFull</code>.
</p>


<h3>Examples</h3>

<pre><code class="language-R">    # Example 8.33 on page 336 of Rosner (2006)
    # n=85
    ssLong(es=5/15, rho=0.7, alpha=0.05, power=0.8)
</code></pre>


</div>