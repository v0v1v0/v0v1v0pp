<div class="container">

<table style="width: 100%;"><tr>
<td>lumpedMatrix</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>Combine alleles in a mutation matrix</h2>

<h3>Description</h3>

<p>Reduce a mutation matrix by combining a set of alleles into one "lump", if
this can be done without distorting the mutation process of the remaining
alleles. Such "allele lumping" can give dramatic efficiency improvements in
likelihood computations with multi-allelic markers, in cases where only some
of the alleles are observed in the pedigree.
</p>


<h3>Usage</h3>

<pre><code class="language-R">lumpedMatrix(mutmat, lump, afreq = NULL, check = TRUE, labelSep = NULL)

lumpedModel(mutmod, lump, afreq = NULL, check = TRUE)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>mutmat</code></td>
<td>
<p>A <code>mutationMatrix</code> object, typically made with
<code>mutationMatrix()</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>lump</code></td>
<td>
<p>A nonempty subset of the alleles (i.e., the column names of
<code>mutmat</code>), or a list of several such subsets.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>afreq</code></td>
<td>
<p>A vector with frequency vector, of the same length as the size
of <code>mutmat</code>. If not given, the <code>afreq</code> attribute of the matrix is used.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>check</code></td>
<td>
<p>A logical indicating if lumpability should be checked before
lumping. Default: TRUE.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>labelSep</code></td>
<td>
<p>((For debugging) A character used to name lumps by pasting
allele labels.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>mutmod</code></td>
<td>
<p>A <code>mutationModel</code> object, typically made with
<code>mutationModel()</code>.</p>
</td>
</tr>
</table>
<h3>Value</h3>

<p>A reduced mutation model. If the original matrix has dimensions
<code class="reqn">n\times n</code>, the result will be <code class="reqn">k\times k</code>, where <code class="reqn">k
  = n - length(lump) + 1</code>.
</p>


<h3>See Also</h3>

<p><code>mutationModel()</code>, <code>mutationMatrix()</code>
</p>


<h3>Examples</h3>

<pre><code class="language-R">

### Example 1: Lumping a mutation matrix
mat = mutationMatrix("eq", alleles = 1:5,
                     afreq = rep(0.2, 5), rate = 0.1)
mat

# Lump alleles 3, 4 and 5
mat2 = lumpedMatrix(mat, lump = 3:5)
mat2

# Example 2: Full model, proportional
mutrate = list(male = 0.1, female = 0.2)
mod = mutationModel("prop", alleles = 1:4,
                    rate = mutrate, afreq = c(.1,.2,.3,.4))
mod

# Lump alleles 3 and 4
mod2 = lumpedModel(mod, lump = 3:4)
mod2

</code></pre>


</div>