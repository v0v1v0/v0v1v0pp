<div class="container">

<table style="width: 100%;"><tr>
<td>lmer_bs</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>Sampling of bootstrap data from a given random effects model</h2>

<h3>Description</h3>

<p><code>lmer_bs()</code> draws bootstrap samples based on the estimates for the mean
and the variance components drawn from a random effects model fit with <code>lme4::lmer()</code>.
Contrary to <code>lme4::bootMer()</code>, the number of observations for each random factor
can vary between the original data set and the bootstrapped data. Random effects
in <code>model</code> have to be specified as <code>(1|random effect)</code>.
</p>


<h3>Usage</h3>

<pre><code class="language-R">lmer_bs(model, newdat = NULL, futmat_list = NULL, nboot)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>model</code></td>
<td>
<p>a random effects model of class lmerMod</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>newdat</code></td>
<td>
<p>a <code>data.frame</code> with the same column names as the historical data
on which <code>model</code> depends</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>futmat_list</code></td>
<td>
<p>a list that contains design matrices for each random factor</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>nboot</code></td>
<td>
<p>number of bootstrap samples</p>
</td>
</tr>
</table>
<h3>Details</h3>

<p>The data sampling is based on a list of design matrices (one for each random factor)
that can be obtained if <code>newdat</code> and the model formula are provided to
<code>lme4::lFormula()</code>. Hence, each random factor that is part of the initial
model must have at least two replicates in <code>newdat</code>. <br>
If a random factor in the future data set does not have any replicate, a list
that contains design matrices (one for each random factor) can be provided via
<code>futmat_list</code>.
</p>


<h3>Value</h3>

<p>A list of length <code>nboot</code> containing the bootstrapped observations.
</p>


<h3>Examples</h3>

<pre><code class="language-R">
# loading lme4
library(lme4)

# Fitting a random effects model based on c2_dat1

fit &lt;- lmer(y_ijk~(1|a)+(1|b)+(1|a:b), c2_dat1)
summary(fit)

#----------------------------------------------------------------------------

### Using c2_dat2 as newdat

c2_dat2

lmer_bs(model=fit, newdat=c2_dat2, nboot=100)

#----------------------------------------------------------------------------

### Using futmat_list

# c2_dat4 has no replication for b. Hence the list of design matrices can not be
# generated by lme4::lFormula() and have to be provided by hand via futmat_list.

c2_dat4

# Build a list containing the design matrices

fml &lt;- vector(length=4, "list")

names(fml) &lt;- c("a:b", "b", "a", "Residual")

fml[["a:b"]] &lt;- matrix(nrow=6, ncol=2, data=c(1,1,0,0,0,0, 0,0,1,1,1,1))

fml[["b"]] &lt;- matrix(nrow=6, ncol=1, data=c(1,1,1,1,1,1))

fml[["a"]] &lt;- matrix(nrow=6, ncol=2, data=c(1,1,0,0,0,0, 0,0,1,1,1,1))

fml[["Residual"]] &lt;- diag(6)

fml

lmer_bs(model=fit, futmat_list=fml, nboot=100)

</code></pre>


</div>