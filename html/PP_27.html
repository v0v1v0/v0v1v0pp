<div class="container">

<table style="width: 100%;"><tr>
<td>PPall</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>Estimate Person Parameters</h2>

<h3>Description</h3>

<p>Compute person parameters for the 1,2,3,4-PL model and for the GPCM. Choose between ML, WL, MAP, EAP and robust estimation. Use this function if 4-PL items and GPCM items are mixed for each person.
</p>


<h3>Usage</h3>

<pre><code class="language-R">PPall(
  respm,
  thres,
  slopes,
  lowerA,
  upperA,
  theta_start = NULL,
  mu = NULL,
  sigma2 = NULL,
  type = "wle",
  model2est,
  maxsteps = 100,
  exac = 0.001,
  H = 1,
  ctrl = list()
)

## S3 method for class 'ppeo'
print(x, ...)

## S3 method for class 'ppeo'
summary(object, nrowmax = 15, ...)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>respm</code></td>
<td>
<p>An integer matrix, which contains the examinees responses. A persons x items matrix is expected.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>thres</code></td>
<td>
<p>A numeric matrix which contains the threshold parameter for each item. If the first row of the matrix is not set to zero (only zeroes in the first row) - then a row-vector with zeroes is added by default.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>slopes</code></td>
<td>
<p>A numeric vector, which contains the slope parameters for each item - one parameter per item is expected.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>lowerA</code></td>
<td>
<p>A numeric vector, which contains the lower asymptote parameters (kind of guessing parameter) for each item. In the case of polytomous items, the value must be 0.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>upperA</code></td>
<td>
<p>numeric vector, which contains the upper asymptote parameters for each item. In the case of polytomous items, the value must be 1.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>theta_start</code></td>
<td>
<p>A vector which contains a starting value for each person. If NULL is submitted, the starting values are set automatically. If a scalar is submitted, this start value is used for each person.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>mu</code></td>
<td>
<p>A numeric vector of location parameters for each person in case of MAP estimation. If nothing is submitted this is set to 0 for each person for MAP estimation.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>sigma2</code></td>
<td>
<p>A numeric vector of variance parameters for each person in case of MAP or EAP estimation. If nothing is submitted this is set to 1 for each person for MAP estimation.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>type</code></td>
<td>
<p>Which maximization should be applied? There are five valid entries possible: "mle", "wle", "map", "eap" and "robust". To choose between the methods, or just to get a deeper understanding the papers mentioned below are quite helpful. The default is <code>"wle"</code> which is a good choice in many cases.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>model2est</code></td>
<td>
<p>A character vector with length equal to the number of submitted items. It defines itemwise the response model under which the item parameter was estimated. There are 2 valid inputs up to now: <code>"GPCM"</code> and <code>"4PL"</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>maxsteps</code></td>
<td>
<p>The maximum number of steps the NR algorithm will take. Default = 100.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>exac</code></td>
<td>
<p>How accurate are the estimates supposed to be? Default is 0.001.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>H</code></td>
<td>
<p>In case <code>type = "robust"</code> a Huber ability estimate is performed, and <code>H</code> modulates how fast the downweighting takes place (for more Details read Schuster &amp; Yuan 2011).</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>ctrl</code></td>
<td>
<p>More controls:
</p>

<ul>
<li> <p><code>killdupli</code>: Should duplicated response pattern be removed for estimation (estimation is faster)? This is especially resonable in case of a large number of examinees and a small number of items.  Use this option with caution (for map and eap), because persons with different <code>mu</code> and <code>sigma2</code> will have different ability estimates despite they responded identically. Default value is <code>FALSE</code>.
</p>
</li>
<li> <p><code>skipcheck</code>: Default = FALSE. If TRUE data matrix and arguments are not checked - this saves time e.g. when you use this function for simulations.
</p>
</li>
</ul>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>x</code></td>
<td>
<p>an object of class <code>gpcm4pl</code> which is the result of using the <code>PPall()</code> function</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>...</code></td>
<td>
<p>just some points.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>object</code></td>
<td>
<p>An object of class <code>gpcm4pl</code> which is the result of using the <code>PPall()</code> function</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>nrowmax</code></td>
<td>
<p>When printing the matrix of estimates - how many rows should be shown? Default = 15.</p>
</td>
</tr>
</table>
<h3>Details</h3>

<p>For a test with both: dichotomous and polytomous items which have been scaled under 1/2/3/4-PL model or the GPCM, use this function to estimate the person ability parameters. You have to define the appropriate model for each item. 
</p>
<p>Please note, that  <code>robust</code> estimation with (Huber ability estimate) polytomous items is still experimental!
</p>


<h3>Value</h3>

<p>The function returns a list with the estimation results and pretty much everything which has been submitted to fit the model. The estimation results can be found in <code>OBJ$resPP</code>. The core result is a number_of_persons x 2 matrix, which contains the ability estimate and the SE for each submitted person.
</p>


<h3>Author(s)</h3>

<p>Manuel Reif
</p>


<h3>References</h3>

<p>Baker, Frank B., and Kim, Seock-Ho (2004). Item Response Theory - Parameter Estimation Techniques. CRC-Press.
</p>
<p>Barton, M. A., &amp; Lord, F. M. (1981). An Upper Asymptote for the Three-Parameter Logistic Item-Response Model.
</p>
<p>Magis, D. (2013). A note on the item information function of the four-parameter logistic model. Applied Psychological Measurement, 37(4), 304-315.
</p>
<p>Muraki, Eiji (1992). A Generalized Partial Credit Model: Application of an EM Algorithm. Applied Psychological Measurement, 16, 159-176.
</p>
<p>Muraki, Eiji (1993). Information Functions of the Generalized Partial Credit Model. Applied Psychological Measurement, 17, 351-363.
</p>
<p>Samejima, Fumiko (1993). The bias function of the maximum likelihood estimate of ability for the dichotomous response level. Psychometrika,  58, 195-209.
</p>
<p>Samejima, Fumiko (1993). An approximation of the bias function of the maximum likelihood estimate of a latent variable for the general case where the item responses are discrete. Psychometrika,  58, 119-138.
</p>
<p>Schuster, C., &amp; Yuan, K. H. (2011). Robust estimation of latent ability in item response models. Journal of Educational and Behavioral Statistics, 36(6), 720-735.
</p>
<p>Wang, S. and Wang, T. (2001). Precision of Warm's Weighted Likelihood Estimates for a Polytomous Model in Computerized Adaptive Testing. Applied Psychological Measurement, 25, 317-331.
</p>
<p>Warm, Thomas A. (1989). Weighted Likelihood Estimation Of Ability In Item Response Theory. Psychometrika, 54, 427-450.
</p>
<p>Yen, Y.-C., Ho, R.-G., Liao, W.-W., Chen, L.-J., &amp; Kuo, C.-C. (2012). An empirical evaluation of the slip correction in the four parameter logistic models with computerized adaptive testing. Applied Psychological Measurement, 36, 75-87.
</p>


<h3>See Also</h3>

<p>PPass, PP_gpcm, PP_4pl, JKpp, PV
</p>


<h3>Examples</h3>

<pre><code class="language-R">################# GPCM  and 4PL mixed #########################################

# some threshold parameters
THRES  &lt;- matrix(c(-2,-1.23,1.11,3.48,1
                   ,2,-1,-0.2,0.5,1.3,-0.8,1.5),nrow=2)
# slopes
sl     &lt;- c(0.5,1,1.5,1.1,1,0.98)

THRESx &lt;- THRES
THRESx[2,1:3] &lt;- NA

# for the 4PL item the estimated parameters are submitted, 
# for the GPCM items the lower asymptote = 0 
# and the upper asymptote = 1.
la     &lt;- c(0.02,0.1,0,0,0,0)
ua     &lt;- c(0.97,0.91,1,1,1,1)

awmatrix &lt;- matrix(c(1,0,1,0,1,1,1,0,0,1
                     ,2,0,0,0,0,0,0,0,0,1
                     ,1,2,2,1,1,1,1,0,0,1),byrow=TRUE,nrow=5)

# create model2est
# this function tries to help finding the appropriate 
# model by inspecting the THRESx.
model2est &lt;- findmodel(THRESx)


# MLE
respmixed_mle &lt;- PPall(respm = awmatrix,thres = THRESx, 
                     slopes = sl,lowerA = la, upperA=ua,type = "mle",
                     model2est=model2est)
# WLE
respmixed_wle &lt;- PPall(respm = awmatrix,thres = THRESx, 
                    slopes = sl,lowerA = la, upperA=ua,type = "wle",
                    model2est=model2est)
# MAP estimation
respmixed_map &lt;- PPall(respm = awmatrix,thres = THRESx, 
                    slopes = sl,lowerA = la, upperA=ua, type = "map",
                    model2est=model2est)

# EAP estimation
respmixed_eap &lt;- PPall(respm = awmatrix,thres = THRESx, 
                    slopes = sl,lowerA = la, upperA=ua, type = "eap",
                    model2est=model2est)

# Robust estimation
respmixed_rob &lt;- PPall(respm = awmatrix,thres = THRESx, 
                    slopes = sl,lowerA = la, upperA=ua, type = "robust",
                    model2est=model2est)


# summary to summarize the results
summary(respmixed_mle)
summary(respmixed_wle)
summary(respmixed_map)
summary(respmixed_eap)
summary(respmixed_rob)

</code></pre>


</div>