<div class="container">

<table style="width: 100%;"><tr>
<td>multiClusterPeaks</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>multiClusterPeaks</h2>

<h3>Description</h3>

<p>Cluster <code>peaks</code> into overlapping groups.</p>


<h3>Usage</h3>

<pre><code class="language-R">multiClusterPeaks(peaks)</code></pre>


<h3>Arguments</h3>

<table><tr style="vertical-align: top;">
<td><code>peaks</code></td>
<td>
<p>data.frame with columns chromStart, chromEnd.</p>
</td>
</tr></table>
<h3>Value</h3>

<p><code>peaks</code> data.frame, sorted by chromStart, with an additional column
cluster.</p>


<h3>Author(s)</h3>

<p>Toby Dylan Hocking &lt;toby.hocking@r-project.org&gt; [aut, cre]</p>


<h3>Examples</h3>

<pre><code class="language-R">
library(PeakSegJoint)
data(chr7.peaks, envir=environment())
library(ggplot2)
ggplot()+
  geom_segment(aes(
    chromStart/1e3, sample.id,
    xend=chromEnd/1e3, yend=sample.id),
    data=chr7.peaks)

clustered &lt;- multiClusterPeaks(chr7.peaks)
clustered.list &lt;- split(clustered, clustered$cluster)
clusters.list &lt;- list()
for(cluster.name in names(clustered.list)){
  clusters.list[[cluster.name]] &lt;- with(
    clustered.list[[cluster.name]], data.frame(
      cluster=cluster[1],
      clusterStart=as.integer(median(chromStart)),
      clusterEnd=as.integer(median(chromEnd))))
}
clusters &lt;- do.call(rbind, clusters.list)
ggplot()+
  geom_segment(aes(
    chromStart/1e3, sample.id,
    color=factor(cluster),
    xend=chromEnd/1e3, yend=sample.id),
    data=clustered)+
geom_segment(aes(
  clusterStart/1e3, "clusters",
  color=factor(cluster),
  xend=clusterEnd/1e3, yend="clusters"),
  data=clusters)

</code></pre>


</div>