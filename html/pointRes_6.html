<div class="container">

<table style="width: 100%;"><tr>
<td>pointer.rgc</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>Calculate pointer years using the relative growth change method</h2>

<h3>Description</h3>

<p>The function calculates event and pointer years on a <code>data.frame</code> with tree-ring series using the relative growth change method, described as abrupt growth change method in Schweingruber et al. (1990). This method relates tree growth in year <code><var>i</var></code> to the average growth of <code><var>n</var></code> preceding years. Thresholds for event- and pointer-year calculations can be adjusted.
</p>


<h3>Usage</h3>

<pre><code class="language-R">pointer.rgc(data, period = NULL, nb.yrs = 4, rgc.thresh.pos = 60, rgc.thresh.neg = 40, 
            series.thresh = 75, make.plot = FALSE)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>data</code></td>
<td>
<p>a <code>data.frame</code> with tree-ring series (raw or detrended) as columns and years as rows (e.g., output of <code>read.rwl</code> or <code>detrend</code> of package dplR).</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>period</code></td>
<td>
<p>a <code>vector</code> specifying the start and end year of the analysis. Defaults to the full period covered by the data.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>nb.yrs</code></td>
<td>
<p>an <code>integer</code> specifying the number of preceding years to be used in calculating relative growth changes. Defaults to 4.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>rgc.thresh.pos</code></td>
<td>
<p>a <code>numeric</code> specifying the threshold above which a relative growth change (in percentage) for a specific tree and year is considered a positive event year. Defaults to 60.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>rgc.thresh.neg</code></td>
<td>
<p>a <code>numeric</code> specifying the threshold below which a relative growth change (in percentage) for a specific tree and year is considered a negative event year. Defaults to 40.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>series.thresh</code></td>
<td>
<p>a <code>numeric</code> specifying the minimum percentage of trees that should display a positive (or negative) event year for that year to be considered as positive (or negative) pointer year. Defaults to 75.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>make.plot</code></td>
<td>
<p>a <code>logical</code> specifying whether a bar plot, showing mean relative growth changes, should be created. Pointer years are indicated with dark-gray bars. Defaults to FALSE.</p>
</td>
</tr>
</table>
<h3>Details</h3>

<p>The function calculates the ratio of tree growth in year <code><var>t</var></code> and the average growth of <code><var>n</var></code> preceding years for individual trees. Resulting relative growth changes are used to identify event years for trees, and these event years to define pointer years for the site.
</p>
<p>Following Schweingruber et al. (1990), <code><var>nb.yrs</var></code>, <code><var>rgc.thresh.pos</var></code>, <code><var>rgc.thresh.neg</var></code> and <code><var>series.thresh</var></code> are set to 4, 60, 40 and 75 respectively, meaning that a positive or negative pointer year will be defined when at least 75% of the tree-ring series display an event year with a growth increase or decrease of at least 60% or 40%, respectively, relative to the average growth in the four preceding years. Depending on the sensitivity of the tree-ring series, the thresholds <code><var>rgc.thresh.pos</var></code> and <code><var>rgc.thresh.neg</var></code> may be adjusted (e.g., lowered for more complacent series; Jetschke et al. 2019).
</p>
<p>Note that the resulting time series are truncated by <code><var>nb.yrs</var></code> at the beginning inherent to the calculation method.
</p>


<h3>Value</h3>

<p>The function returns a <code>list</code> containing the following components:
</p>
<table>
<tr style="vertical-align: top;">
<td><code>rgc</code></td>
<td>
<p>a <code>matrix</code> with relative growth changes for individual tree-ring series</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>EYvalues</code></td>
<td>
<p>a <code>matrix</code> indicating positive (1), negative (-1) and non-event years (0) for individual tree-ring series</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>out</code></td>
<td>
<p>a <code>data.frame</code> containing the following columns: <code>year</code> - time stamp, <code>nb.series</code> - number of series considered, <code>perc.pos</code> - percentage of trees showing a positive event year, <code>perc.neg</code> - percentage of trees showing a negative event year, <code>nature</code> - number indicating whether the year is a positive (1), negative (-1) or no pointer year (0), <code>dev_mean</code> - mean growth deviation in percentage over the available series for each year, and <code>dev_sd</code> - standard deviation of the growth deviation for each year</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>spec.param</code></td>
<td>
<p>a <code>data.frame</code> specifying the arguments used in the calculation</p>
</td>
</tr>
</table>
<h3>Author(s)</h3>

<p>Marieke van der Maaten-Theunissen and Ernst van der Maaten.
</p>


<h3>References</h3>

<p>Jetschke, G., van der Maaten, E. and van der Maaten-Theunissen, M. (2019) Towards the extremes: A critical analysis of pointer year detection methods. <em>Dendrochronologia</em> 53: 55-62.
</p>
<p>Schweingruber, F.H., Eckstein, D., Serre-Bachet, F. and Bräker, O.U. (1990) Identification, presentation and interpretation of event years and pointer years in dendrochronology. <em>Dendrochronologia</em> 8: 9-38.
</p>
<p>In writing the function, the code of the dplR function <code>pointer</code> (Pierre Mérian) was used as a reference.
</p>


<h3>Examples</h3>

<pre><code class="language-R">## Calculate pointer years on tree-ring series
data(s033)
py1 &lt;- pointer.rgc(s033)
head(py1$out)

## Calculate pointer years with user-defined arguments
data(s033)
py2 &lt;- pointer.rgc(s033, period = c(1950,2010), nb.yrs = 5, rgc.thresh.pos = 50,
                   rgc.thresh.neg = 50, series.thresh = 50, make.plot = TRUE)
head(py2$out)

</code></pre>


</div>