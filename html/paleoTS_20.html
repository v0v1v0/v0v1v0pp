<div class="container">

<table style="width: 100%;"><tr>
<td>Kfiltertv</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>Time-varying Kalman filter calculations</h2>

<h3>Description</h3>

<p>Time-varying Kalman filter calculations
</p>


<h3>Usage</h3>

<pre><code class="language-R">Kfiltertv(num, y, Atv, mu0, Sigma0, Phitv, Ups, Gam, Qtv, Rtv, input)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>num</code></td>
<td>
<p>the number of samples in the time-series</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>y</code></td>
<td>
<p>values of the time-series</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>Atv</code></td>
<td>
<p>q x p x n observation array</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>mu0</code></td>
<td>
<p>p x 1 vector setting the mean of the system at time zero</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>Sigma0</code></td>
<td>
<p>p x p variance matrix of the system at time zero</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>Phitv</code></td>
<td>
<p>p x p x n array reflecting autoregression of the state variables</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>Ups</code></td>
<td>
<p>p x r matrix with the coefficients/parameters relating the inputs to the system equation</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>Gam</code></td>
<td>
<p>q x r matrix with the coefficients/parameters relating the inputs to the observation equation</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>Qtv</code></td>
<td>
<p>p x p x n array of system stochastic  variance; user needs to ensure positive definite</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>Rtv</code></td>
<td>
<p>q x q x n array observation stochastic variance; user needs to ensure positive definite</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>input</code></td>
<td>
<p>n x r array of the exogenous variables/covariates</p>
</td>
</tr>
</table>
<h3>Details</h3>

<p>For the dimensions of the argument arrays, <code>n</code> is the length of the
time-series, <code>q</code> is the dimension of the observation variable(s),
<code>p</code> is the dimension of the state variable(s), and <code>r</code> isthe
dimension of the input variable(s). <br><br> This function is based on the
<code>Kfilter</code> function of the <em>astsa</em> package, modified modified to
allow for time-varying terms for the Kalman filter.  This modification
facilitates fitting a broader array of models and handling non-uniform
temporal spacing of samples.  See the documentation for that function, and
the reference below for additional information.
</p>


<h3>Value</h3>

<p>A list of the following elements:
</p>

<ul>
<li> <p><code>xp</code>   one-step-ahead prediction of the state
</p>
</li>
<li> <p><code>Pp</code>   mean square prediction error
</p>
</li>
<li> <p><code>xf</code>   filter value of the state
</p>
</li>
<li> <p><code>Pf</code>   mean square filter error
</p>
</li>
<li>
<p><code>like</code>   log-likelihood
</p>
</li>
<li>
<p><code>innov</code>   innovation series
</p>
</li>
<li>
<p><code>sig</code>   innovation covariances
</p>
</li>
<li>
<p><code>Kn</code>   last value of the gain, needed for smoothing
</p>
</li>
</ul>
<h3>Note</h3>

<p>This function is used in the internal SSM log-likelihood functions for the models.  The user will not need to use this
they create their own model-fitting functions.
</p>


<h3>Author(s)</h3>

<p>John Fricks (jfricks@asu.edu)
</p>


<h3>References</h3>

<p>Shumway, R. H., and D. S. Stoffer. 2017. Time Series Analysis and its Applications (4th Ed.) Springer International.
</p>


<h3>Examples</h3>

<pre><code class="language-R">y &lt;- sim.GRW(ms = 0, vs = 1, vp = 0)
n &lt;- length(y)
kf &lt;- Kfiltertv(n ,y = y$mm, Atv = array(1, dim = c(1,1,n)), mu0 = y$mm[1],
                Sigma0 = y$vv[1]/y$nn[1], Phitv = array(1, dim = c(1,1,n)),
                Ups = NULL, Gam = NULL, Qtv = array(1, dim = c(1,1,n)),
                Rtv = array(0, dim = c(1,1,n)), input = NULL)

</code></pre>


</div>