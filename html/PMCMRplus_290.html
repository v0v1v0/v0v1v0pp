<div class="container">

<table style="width: 100%;"><tr>
<td>williamsTest</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>Williams Trend Test</h2>

<h3>Description</h3>

<p>Performs Williams' test for contrasting increasing (decreasing) dose levels of a treatment.
</p>


<h3>Usage</h3>

<pre><code class="language-R">williamsTest(x, ...)

## Default S3 method:
williamsTest(x, g, alternative = c("greater", "less"), ...)

## S3 method for class 'formula'
williamsTest(
  formula,
  data,
  subset,
  na.action,
  alternative = c("greater", "less"),
  ...
)

## S3 method for class 'aov'
williamsTest(x, alternative = c("greater", "less"), ...)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>x</code></td>
<td>
<p>a numeric vector of data values, or a list of numeric data
vectors.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>...</code></td>
<td>
<p>further arguments to be passed to or from methods.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>g</code></td>
<td>
<p>a vector or factor object giving the group for the
corresponding elements of <code>"x"</code>.
Ignored with a warning if <code>"x"</code> is a list.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>alternative</code></td>
<td>
<p>the alternative hypothesis. Defaults to <code>greater</code></p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>formula</code></td>
<td>
<p>a formula of the form <code>response ~ group</code> where
<code>response</code> gives the data values and <code>group</code> a vector or
factor of the corresponding groups.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>data</code></td>
<td>
<p>an optional matrix or data frame (or similar: see
<code>model.frame</code>) containing the variables in the
formula <code>formula</code>.  By default the variables are taken from
<code>environment(formula)</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>subset</code></td>
<td>
<p>an optional vector specifying a
subset of observations to be used.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>na.action</code></td>
<td>
<p>a function which indicates what should happen when
the data contain <code>NA</code>s.  Defaults to <code>getOption("na.action")</code>.</p>
</td>
</tr>
</table>
<h3>Details</h3>

<p>Williams' test is a step-down trend test for testing several treatment levels
with a zero control in a one-factorial design with normally distributed
errors of homogeneous variance. Let there be <code class="reqn">k</code> groups including the control and let
the zero dose level be indicated with <code class="reqn">i = 0</code> and the treatment
levels indicated as <code class="reqn">1 \le i \le m</code>, then the following <code class="reqn">m = k - 1</code> hypotheses are tested:
</p>
<p style="text-align: center;"><code class="reqn">
\begin{array}{ll}
\mathrm{H}_{m}: \bar{x}_0 = m_1 = \ldots = m_m, &amp; \mathrm{A}_{m}: \bar{x}_0 \le m_1 \le \ldots m_m, \bar{x}_0 &lt; m_m \\
\mathrm{H}_{m-1}: \bar{x}_0 = m_1 = \ldots = m_{m-1}, &amp; \mathrm{A}_{m-1}: \bar{x}_0 \le m_1 \le \ldots m_{m-1}, \bar{x}_0 &lt; m_{m-1} \\
\vdots &amp; \vdots \\
\mathrm{H}_{1}: \bar{x}_0 = m_1, &amp; \mathrm{A}_{1}: \bar{x}_0 &lt; m_1,\\
\end{array}
</code>
</p>

<p>where <code class="reqn">m_i</code> denotes the isotonic mean of the <code class="reqn">i</code>th dose level group.
</p>
<p>William's test bases on a order restriction:
</p>
<p style="text-align: center;"><code class="reqn">
\mu_i^{*} = \max_{1\le u \le i}~\min_{i \le v \le m}~ \sum_{j=u}^v n_j \bar{x}_j^{*} ~/~ \sum_{j=u}^v n_j \qquad (1 \le i \le m),
</code>
</p>

<p>where <code class="reqn">\bar{x}_j^*</code> denotes the <code class="reqn">j</code>-th isotonic
mean estimated with isotonic regression using the
pool adjacent violators algorithm (PAVA) with the vector
of means <code class="reqn">\left\{\bar{x}_1, \bar{x}_2, \ldots, \bar{x}_m\right\}^T</code>
and the vector of weights
<code class="reqn">\left\{n_1, n_2, \ldots, n_m\right\}^T</code>.
</p>
<p>For the alternative hypothesis of decreasing trend,
max and min are interchanged in the above Equation.
</p>
<p>The <code class="reqn">i</code>-the test statistic is calculated as follows:
</p>
<p style="text-align: center;"><code class="reqn">
\bar{t}_i = \frac{\mu_m^* - \bar{x}_0}{s_{\mathrm{E}} \sqrt{1/n_m - 1/n_0}}
</code>
</p>

<p>The procedure starts from the highest dose level (<code class="reqn">m</code>) to the the lowest dose level (<code class="reqn">1</code>) and
stops at the first non-significant test. The consequent lowest effect dose
is the treatment level of the previous test number.
</p>
<p>The function does not return p-values. Instead the critical t-values
as given in the tables of Williams (1972) for <code class="reqn">\alpha = 0.05</code> (one-sided)
are looked up according to the degree of freedoms (<code class="reqn">v</code>) and the order number of the
dose level (<code class="reqn">i</code>) and (potentially) modified according to the given extrapolation
coefficient <code class="reqn">\beta</code>.
</p>
<p>Non tabulated values are linearly interpolated as recommended by Williams (1972).
The function <code>approx</code> is used.
</p>
<p>For the comparison of the first dose level (i = 1) with the control, the critical t-value
from the Student t distribution is used (<code>TDist</code>).
</p>


<h3>Value</h3>

<p>A list with class <code>"osrt"</code> that contains the following components:
</p>

<dl>
<dt>method</dt>
<dd>
<p>a character string indicating what type of test was performed.</p>
</dd>
<dt>data.name</dt>
<dd>
<p>a character string giving the name(s) of the data.</p>
</dd>
<dt>statistic</dt>
<dd>
<p>the estimated statistic(s)</p>
</dd>
<dt>crit.value</dt>
<dd>
<p>critical values for <code class="reqn">\alpha = 0.05</code>.</p>
</dd>
<dt>alternative</dt>
<dd>
<p>a character string describing the alternative hypothesis.</p>
</dd>
<dt>parameter</dt>
<dd>
<p>the parameter(s) of the test distribution.</p>
</dd>
<dt>dist</dt>
<dd>
<p>a string that denotes the test distribution.</p>
</dd>
</dl>
<p>There are print and summary methods available.
</p>


<h3>Source</h3>

<p>The source code for the application of the pool adjacent violators
theorem to calculate the isotonic means
was taken from the file <code>"pava.f"</code>, which is included in the
package <span class="pkg">Iso</span>:
</p>
<p>Rolf Turner (2015). Iso: Functions to Perform Isotonic Regression. R
package version 0.0-17. <a href="https://CRAN.R-project.org/package=Iso">https://CRAN.R-project.org/package=Iso</a>.
</p>
<p>The file <code>pava.f</code> is a Ratfor modification of Algorithm AS 206.1:
</p>
<p>Bril, G., Dykstra, R., Pillers, C., Robertson, T. (1984)
Statistical Algorithms: Algorithm AS 206: Isotonic
Regression in Two Independent Variables, <em>Appl. Statist.</em>,
34, 352–357.
</p>
<p>The Algorith AS 206 is available from StatLib
<a href="https://lib.stat.cmu.edu/apstat/">https://lib.stat.cmu.edu/apstat/</a>. The Royal Statistical Society
holds the copyright to these routines,
but has given its permission for their distribution provided that
no fee is charged.
</p>


<h3>Note</h3>

<p>In the current implementation, only tests on the level of <code class="reqn">\alpha = 0.05</code>
can be performed. The included extrapolation function assumes either
a balanced design, or designs, where the number of replicates in the control excdeeds the number of replicates
in the treatment levels. A warning message appears, if the following
condition is not met, <code class="reqn">1 \le n_0 / n_i \le 6</code> for <code class="reqn">1 \le i \le m</code>.
</p>


<h3>References</h3>

<p>Williams, D. A. (1971) A test for differences between treatment means
when several dose levels are compared with a zero dose control,
<em>Biometrics</em> <b>27</b>, 103–117.
</p>
<p>Williams, D. A. (1972) The comparison of several dose levels with a zero
dose control, <em>Biometrics</em> <b>28</b>, 519–531.
</p>


<h3>See Also</h3>

<p><code>TDist</code>, <code>approx</code>, <code>print.osrt</code>,
<code>summary.osrt</code>
</p>


<h3>Examples</h3>

<pre><code class="language-R">## Example from Sachs (1997, p. 402)
x &lt;- c(106, 114, 116, 127, 145,
110, 125, 143, 148, 151,
136, 139, 149, 160, 174)
g &lt;- gl(3,5)
levels(g) &lt;- c("0", "I", "II")

## Williams Test
williamsTest(x ~ g)

</code></pre>


</div>