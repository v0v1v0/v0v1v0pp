<div class="container">

<table style="width: 100%;"><tr>
<td>pseudoci</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>Pseudo-observations for the cumulative incidence function</h2>

<h3>Description</h3>

<p>Computes pseudo-observations for modeling competing risks based on the cumulative incidence function.
</p>


<h3>Usage</h3>

<pre><code class="language-R">pseudoci(time,event, tmax)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>time</code></td>
<td>
<p>the follow up time.
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>event</code></td>
<td>

<p>the cause indicator, use 0 as censoring code and integers to name the other causes.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>tmax</code></td>
<td>

<p>a vector of time points at which the pseudo-observations are to be computed. If missing, the pseudo-observations are
reported at each event time.
</p>
</td>
</tr>
</table>
<h3>Details</h3>

<p>The function calculates the pseudo-observations for the cumulative incidence function for each individual and each risk at all the required time points. 
The pseudo-observations can be used for fitting a regression model with a generalized estimating equation. No missing values in either <code>time</code> or <code>event</code>
vector are allowed.
</p>
<p>Please note that the output of the function has changed and the usage is thus no longer the same as in the reference paper - the new usage is described in the example below.
Similar (faster) version of the function is available in the R-package prodlim (<code>jackknife</code>).
</p>


<h3>Value</h3>

<p>A list containing the following objects:
</p>
<table>
<tr style="vertical-align: top;">
<td><code>time</code></td>
<td>
<p>The ordered time points at which the pseudo-observations are evaluated.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>cause</code></td>
<td>
<p>The ordered codes for different causes.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>pseudo</code></td>
<td>
<p>A list of matrices - a matrix for each of the causes, ordered by codes. Each row of a matrix belongs to one individual (ordered as in the original data set),
each column presents a time point (ordered in time). </p>
</td>
</tr>
</table>
<h3>References</h3>

<p>Klein J.P., Gerster M., Andersen P.K., Tarima S., POHAR PERME, M.: "SAS and R Functions to Compute Pseudo-values for Censored Data Regression." <em>Comput. methods programs biomed.</em>, 2008, 89 (3): 289-300 
</p>


<h3>See Also</h3>

<p><code>pseudoyl</code>,
<code>pseudomean</code>,
<code>pseudosurv</code>
</p>


<h3>Examples</h3>

<pre><code class="language-R">library(KMsurv)
data(bmt)

#calculate the pseudo-observations
cutoffs &lt;- c(50,105,170,280,530)
bmt$icr &lt;- bmt$d1 +  bmt$d3
pseudo &lt;- pseudoci(time=bmt$t2,event=bmt$icr,tmax=cutoffs)

#rearrange the data into a long data set, use only pseudo-observations for relapse (icr=2)
b &lt;- NULL
for(it in 1:length(pseudo$time)){
	b &lt;- rbind(b,cbind(bmt,pseudo = pseudo$pseudo[[2]][,it],
	     tpseudo = pseudo$time[it],id=1:nrow(bmt)))
}
b &lt;- b[order(b$id),]


# fit the model
library(geepack)
fit &lt;- geese(pseudo ~ as.factor(tpseudo) + as.factor(group) + as.factor(z8) +
	z1 - 1, data =b, id=id, jack = TRUE, scale.fix=TRUE, family=gaussian,
	mean.link = "cloglog", corstr="independence")

#The results using the AJ variance estimate
cbind(mean = round(fit$beta,4), SD = round(sqrt(diag(fit$vbeta.ajs)),4),
	Z = round(fit$beta/sqrt(diag(fit$vbeta.ajs)),4),
	PVal = round(2-2*pnorm(abs(fit$beta/sqrt(diag(fit$vbeta.ajs)))),4))

</code></pre>


</div>