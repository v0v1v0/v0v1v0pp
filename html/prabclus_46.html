<div class="container">

<table style="width: 100%;"><tr>
<td>prab.sarestimate</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>Estimates SAR model from log-abundance matrix of prab-object.</h2>

<h3>Description</h3>

 
<p>This is either an interface for the function <code>errorsarlm</code>
for abundance data stored in an object of class <code>prab</code>
implemented for use in <code>abundtest</code>, or, in case that spatial
information should be ignored, it estimates a two-way additive
unreplicated linear
model for log-abundances on factors species and region. 
</p>


<h3>Usage</h3>

<pre><code class="language-R">prab.sarestimate(abmat, prab01=NULL,sarmethod="eigen",
                             weightstyle="C",
                             quiet=TRUE, sar=TRUE,
                             add.lmobject=TRUE)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>abmat</code></td>
<td>
<p>object of class <code>prab</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>prab01</code></td>
<td>
<p>presence-absence matrix of same dimensions than the
abundance matrix of <code>prabobj</code>. This specifies the presences and
absences on which the presence/absence step of abundance-based tests
is based (see details). If <code>NULL</code> (which is usually the only
reasonable choice), <code>prab01</code> is computed in order to indicate
the nonzeroes of <code>prabobj$prab</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>sarmethod</code></td>
<td>
<p>this is passed on as parameter <code>method</code> to
<code>errorsarlm</code> and documented there. We don't have
experience with any other choice than <code>"eigen"</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>weightstyle</code></td>
<td>
<p>can take values "W", "B", "C", "U", and "S" though tests
suggest that "C" should be chosen. See <code>nb2listw</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>quiet</code></td>
<td>
<p>this is passed on as parameter <code>quiet</code> to
<code>errorsarlm</code> and documented there.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>sar</code></td>
<td>
<p>logical. If <code>TRUE</code>, a simultaneous autoregression
model is fitted by calling <code>errorsarlm</code>. If
<code>FALSE</code>, a two-way additive
unreplicated linear
model for log-abundances on factors species and region is computed
by <code>lm</code>,
ignoring the spatial arrangement of the regions.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>add.lmobject</code></td>
<td>
<p>logical. If <code>TRUE</code>, the whole output object
of <code>errorsarlm</code> (or <code>lm</code>) is given out.</p>
</td>
</tr>
</table>
<h3>Value</h3>

<p>A list with the following components:
</p>
<table>
<tr style="vertical-align: top;">
<td><code>sar</code></td>
<td>
<p>see above.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>intercept</code></td>
<td>
<p>numeric. Estimator of the intercept.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>sigma</code></td>
<td>
<p>numeric. Estimator of error standard deviation.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>regeffects</code></td>
<td>
<p>numeric vector. Estimator for region effects.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>speceffects</code></td>
<td>
<p>numeric vector. Estimator for species effects.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>lamda</code></td>
<td>
<p>numeric. Governs the degree of spatial
autocorrelation. See <code>errorsarlm</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>size</code></td>
<td>
<p>integer. Length of neighborhood list generated by
<code>nb2listw</code> used by
<code>errorsarlm</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>nbweight</code></td>
<td>
<p>numeric. Average weight of neighbors.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>lmobject</code></td>
<td>
<p>if <code>add.lmobject=TRUE</code>, output object of either
<code>lm</code> or <code>errorsarlm</code>.</p>
</td>
</tr>
</table>
<h3>Author(s)</h3>

<p>Christian Hennig
<a href="mailto:christian.hennig@unibo.it">christian.hennig@unibo.it</a>
<a href="https://www.unibo.it/sitoweb/christian.hennig/en">https://www.unibo.it/sitoweb/christian.hennig/en</a></p>


<h3>See Also</h3>

<p><code>errorsarlm</code>,
<code>abundtest</code>
</p>


<h3>Examples</h3>

<pre><code class="language-R">  options(digits=4)
  data(siskiyou)
  x &lt;- prabinit(prabmatrix=siskiyou, neighborhood=siskiyou.nb,
             distance="none")
#  Not run; this needs package spdep 
#  prab.sarestimate(x)
  prab.sarestimate(x, sar=FALSE)
</code></pre>


</div>