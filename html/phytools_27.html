<div class="container">

<table style="width: 100%;"><tr>
<td>phyl.pca</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>Phylogenetic principal components analysis</h2>

<h3>Description</h3>

<p>This function performs phylogenetic PCA following Revell (2009).
</p>


<h3>Usage</h3>

<pre><code class="language-R">phyl.pca(tree, Y, method="BM", mode="cov", ...)
## S3 method for class 'phyl.pca'
biplot(x, ...)
scores(object, ...)
## S3 method for class 'phyl.pca'
scores(object, ...)
as.princomp(x, ...)
as.prcomp(x, ...)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>tree</code></td>
<td>
<p>phylogeny as an object of class <code>"phylo"</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>Y</code></td>
<td>
<p>data matrix with traits in columns.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>method</code></td>
<td>
<p>method to obtain the correlation structure: can be <code>"BM"</code> or <code>"lambda"</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>mode</code></td>
<td>
<p>is the mode for the PCA: can be <code>"cov"</code> or <code>"corr"</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>x</code></td>
<td>
<p>object of class <code>"phyl.pca"</code> for <code>biplot</code>, <code>as.princomp</code>, and <code>as.prcomp</code> methods.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>object</code></td>
<td>
<p>object of class <code>"phyl.pca"</code> for <code>scores</code> method.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>...</code></td>
<td>
<p>for S3 plotting method <code>biplot.phyl.pca</code>, other arguments to be passed to <code>biplot</code>.</p>
</td>
</tr>
</table>
<h3>Details</h3>

<p>If <code>method="lambda"</code> then <code class="reqn">\lambda</code> will be optimized on the interval (0,1) using <code>optimize</code>. Optimization method can be set using the option <code>opt</code> which can take values <code>"ML"</code>, <code>"REML"</code>, or <code>"fixed"</code>. If the last of these is selected than the user should also specify a value of <code class="reqn">\lambda</code> to use via the argument <code>lambda</code>. 
</p>
<p>S3 methods (<code>print</code>, <code>summary</code>, and <code>biplot</code>) are modified from code provided by Joan Maspons and are based on the same methods for objects of class <code>"prcomp"</code>. Function <code>biplot</code> now permits the argument <code>choices</code> to be supplied, which should be a vector of length two indicated the two PC axes to be plotted.
</p>
<p>S3 method <code>scores</code> extracts or computes (for a matrix of <code>newdata</code>) PC scores given an object of class <code>"phyl.pca"</code>.
</p>
<p>S3 methods <code>as.prcomp</code> and <code>as.princomp</code> convert the object of class <code>"phyl.pca"</code> to objects of class <code>"prcomp"</code> and <code>"princomp"</code>, respectively.
</p>


<h3>Value</h3>

<p>An object of class <code>"phyl.pca"</code> consisting of a list with some or all of the following elements:
</p>
<table>
<tr style="vertical-align: top;">
<td><code>Eval</code></td>
<td>
<p>diagonal matrix of eigenvalues.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>Evec</code></td>
<td>
<p>matrix with eigenvectors in columns.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>S</code></td>
<td>
<p>matrix with scores.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>L</code></td>
<td>
<p>matrix with loadings.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>lambda</code></td>
<td>
<p>fitted value of <code class="reqn">\lambda</code> (<code>method="lambda"</code> only).</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>logL</code></td>
<td>
<p>log-likelihood for <code class="reqn">\lambda</code> model (<code>method="logL"</code> only).</p>
</td>
</tr>
</table>
<h3>Author(s)</h3>

<p>Liam Revell <a href="mailto:liam.revell@umb.edu">liam.revell@umb.edu</a>, Joan Maspons</p>


<h3>References</h3>

<p>Revell, L. J. (2009) Size-correction and principal components for interspecific comparative studies. <em>Evolution</em>, <b>63</b>, 3258-3268.
</p>
<p>Revell, L. J. (2024) phytools 2.0: an updated R ecosystem for phylogenetic comparative methods (and other things). <em>PeerJ</em>, <b>12</b>, e16505.
</p>


<h3>See Also</h3>

<p><code>phyl.cca</code>, <code>phyl.resid</code>, <code>prcomp</code>, <code>princomp</code>
</p>


<h3>Examples</h3>

<pre><code class="language-R">## load data from Mahler et al. (2010)
data(anoletree)
data(anole.data)
## run phylogenetic PCA
anole.pca&lt;-phyl.pca(anoletree,anole.data)
print(anole.pca)
## plot results
plot(anole.pca)
biplot(anole.pca)
</code></pre>


</div>