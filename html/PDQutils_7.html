<div class="container">

<table style="width: 100%;"><tr>
<td>dapx_edgeworth</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>Approximate density and distribution via Edgeworth expansion.</h2>

<h3>Description</h3>

<p>Approximate the probability density or cumulative distribution function of a distribution via its raw cumulants.
</p>


<h3>Usage</h3>

<pre><code class="language-R">dapx_edgeworth(x, raw.cumulants, support=c(-Inf,Inf), log=FALSE)

papx_edgeworth(q, raw.cumulants, support=c(-Inf,Inf), lower.tail=TRUE, log.p=FALSE)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>x</code></td>
<td>
<p>where to evaluate the approximate density.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>raw.cumulants</code></td>
<td>
<p>an atomic array of the 1st through kth raw cumulants
of the probability distribution. The first cumulant is the mean, the
second is the variance. The third is <em>not</em> the typical unitless skew.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>support</code></td>
<td>
<p>the support of the density function. It is assumed
that the density is zero on the complement of this open interval.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>log</code></td>
<td>
<p>logical; if TRUE, densities <code class="reqn">f</code> are given 
as <code class="reqn">\mbox{log}(f)</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>q</code></td>
<td>
<p>where to evaluate the approximate distribution.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>log.p</code></td>
<td>
<p>logical; if TRUE, probabilities p are given 
as <code class="reqn">\mbox{log}(p)</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>lower.tail</code></td>
<td>
<p>whether to compute the lower tail. If false, we approximate the survival function.</p>
</td>
</tr>
</table>
<h3>Details</h3>

<p>Given the raw cumulants of a probability distribution, we can approximate the probability 
density function, or the cumulative distribution function, via an Edgeworth
expansion on the standardized distribution. The derivation of the Edgeworth
expansion is rather more complicated than that of the Gram Charlier
approximation, involving the characteristic function and an expression of
the higher order derivatives of the composition of functions; see
Blinnikov and Moessner for more details. The Edgeworth expansion can
be expressed succinctly as
</p>
<p style="text-align: center;"><code class="reqn">\sigma f(\sigma x) = \phi(x) + \phi(x)\sum_{1 \le s}\sigma^s \sum_{\{k_m\}} He_{s+2r}(x) c_{k_m},</code>
</p>

<p>where the second sum is over some partitions, and the constant <code class="reqn">c</code> 
involves cumulants up to order <code class="reqn">s+2</code>. Unlike the Gram Charlier
expansion, of which it is a rearrangement, the Edgeworth expansion
is arranged in increasing powers of the standard deviation
<code class="reqn">\sigma</code>.
</p>


<h3>Value</h3>

<p>The approximate density at <code>x</code>, or the approximate CDF at
<code>q</code>.
</p>


<h3>Note</h3>

<p>Monotonicity of the CDF is not guaranteed.
</p>


<h3>Author(s)</h3>

<p>Steven E. Pav <a href="mailto:shabbychef@gmail.com">shabbychef@gmail.com</a>
</p>


<h3>References</h3>

<p>S. Blinnikov and R. Moessner. "Expansions for nearly Gaussian
distributions." Astronomy and Astrophysics Supplement 130 (1998): 193-205.
<a href="http://arxiv.org/abs/astro-ph/9711239">http://arxiv.org/abs/astro-ph/9711239</a>
</p>


<h3>See Also</h3>

<p>the Gram Charlier expansions, <code>dapx_gca, papx_gca</code>
</p>


<h3>Examples</h3>

<pre><code class="language-R"># normal distribution, for which this is silly
xvals &lt;- seq(-2,2,length.out=501)
d1 &lt;- dapx_edgeworth(xvals, c(0,1,0,0,0,0))
d2 &lt;- dnorm(xvals)
d1 - d2

qvals &lt;- seq(-2,2,length.out=501)
p1 &lt;- papx_edgeworth(qvals, c(0,1,0,0,0,0))
p2 &lt;- pnorm(qvals)
p1 - p2
</code></pre>


</div>