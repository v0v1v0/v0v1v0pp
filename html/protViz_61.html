<div class="container">

<table style="width: 100%;"><tr>
<td>peakplot</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>Labelling of Peptide Fragment Mass Spectra</h2>

<h3>Description</h3>

<p><code>peakplot</code> labels a mass spectrum from a peptide sequence  
assignment by using the <code>psm</code> function with the appropriate 
fragment ion labels.
Using <code>peakplot</code> it is possible to compute the fragment ion 
coverage and customize the fragmentation ions used for labelling.
</p>


<h3>Usage</h3>

<pre><code class="language-R">
    peakplot(peptideSequence, spec, 
        FUN=defaultIon, 
        fi=fragmentIon(peptideSequence, FUN=FUN)[[1]],
        sub=paste(peptideSequence, spec$title, sep=" / "),
        itol=0.6,
        pattern.abc="[abc].*",
        pattern.xyz="[xyz].*",
        ion.axes=TRUE, ...) 

</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>peptideSequence</code></td>
<td>
<p>peptide sequence encoded as a character sequence using 
the 20 amino acid letter code.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>spec</code></td>
<td>
<p>a <code>peaklist</code> or a tandem mass spec data structure which is a list having two 
eq sized vectors calles mZ and intensity. mZ values are sorted.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>FUN</code></td>
<td>
<p>the function to be applied to compute further ions. If no 
function is assigned <code>fragmentIon</code> will
use <code>defaultIon</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>fi</code></td>
<td>
<p>fragment ion table, if not specified 
<code>fragmentIon(sequence, FUN=FUN)[[1]]</code> is called.
This argument is useful if you have PTM or specific ion series.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>sub</code></td>
<td>
<p>a sub title for the plot</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>itol</code></td>
<td>
<p>fragment ion tolerance default is 0.6 Dalton. values below are considered as hit.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>pattern.abc</code></td>
<td>
<p><code>regexpr pattern</code> for a, b, c like ions. if the pattern does not match ion are not plotted.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>pattern.xyz</code></td>
<td>
<p><code>regexpr pattern</code> for x, y, z like ions.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>ion.axes</code></td>
<td>
<p>boolean default is <code>TRUE</code>. determines whether the fragment ion labels should be plotted instead of m/z values.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>...</code></td>
<td>
<p>passed to the default plot function.</p>
</td>
</tr>
</table>
<h3>Details</h3>

<p><code>peakplot</code> computes the in-silico fragment ion, using the 
<code>fragmentIon</code> function, and matches them again with
the MS2. If the mass error between the in-silico peak and the measured one 
is below 0.6 Da (default setting), the peptide spectrum match 
(<code>psm</code>) is considered as a hit.
</p>
<p>The major objective of the labelling is the avoidance of overlapping labels, for 
which purpose <code>peakplot</code> applies filtering. A label is only drawn if the 
corresponding ion count of the m/z peak is higher than a given threshold. 
Experience from several hundred annotations shows that the 0.9 percentile is 
a good cut-off value. To most efficiently use the limited screen and printout 
space and to ensure that labels representing important local peaks are also 
considered for the drawing, <code>peakplot</code> divides the display space into a 
number of bins depending on the peptide sequence length along the m/z axis. 
From these bins, the top n labels are ordered according to abundance. For the 
visual clustering effect, the abc and xyz ions are drawn on different y-axis 
levels using different colors. Ion types considered for labelling is 
dependent on the instrument setting applied during the initial search.
</p>


<h3>Value</h3>

<p>returns a list object containing all the peptide spectrum match relevant
information.
</p>


<h3>Author(s)</h3>

<p>Bertran Gerrits, Christian Panse 
</p>
<p>2006-2017; 
</p>


<h3>References</h3>


<ul><li>
<p> PEAKPLOT: Visualizing Fragmented Peptide Mass Spectra in Proteomics (2009)
Panse Christian, Gerrits Bertran, Schlapbach Ralph, useR!2009,
</p>
<p>abstract: <a href="https://www.r-project.org/conferences/useR-2009/abstracts/pdf/Panse+Gerrits+Schlapbach.pdf">https://www.r-project.org/conferences/useR-2009/abstracts/pdf/Panse+Gerrits+Schlapbach.pdf</a>,
</p>
<p>slides: <a href="https://www.r-project.org/conferences/useR-2009/slides/Panse+Gerrits+Schlapbach.pdf">https://www.r-project.org/conferences/useR-2009/slides/Panse+Gerrits+Schlapbach.pdf</a>.
</p>
</li></ul>
<h3>See Also</h3>


<ul>
<li> <p>mascot
</p>
</li>
<li>
<p><code>fragmentIon</code>
</p>
</li>
<li>
<p><code>psm</code>
</p>
</li>
<li>
<p><code>PTM_MarkerFinder</code>
</p>
</li>
<li> <p><code>peakplot</code> has been used for generating 
figures and supplemental material in:  
</p>
<p><a href="https://doi.org/10.1074/mcp.M600046-MCP200">doi:10.1074/mcp.M600046-MCP200</a>,
<a href="https://doi.org/10.1038/msb4100182">doi:10.1038/msb4100182</a>,
<a href="https://doi.org/10.1371/journal.pone.0036980">doi:10.1371/journal.pone.0036980</a>,
<a href="https://doi.org/10.1002/pmic.201300036">doi:10.1002/pmic.201300036</a>,
<a href="https://doi.org/10.1074/mcp.M115.052548">doi:10.1074/mcp.M115.052548</a>
</p>
</li>
</ul>
<h3>Examples</h3>

<pre><code class="language-R">
    data(msms)
    op &lt;- par(mfrow=c(2,1))
    peakplot("TAFDEAIAELDTLNEESYK", msms[[1]])
    peakplot("TAFDEAIAELDTLSEESYK", msms[[2]])
    par(op)


    # filter cand. fragment ions
    fi &lt;- fragmentIon("TAFDEAIAELDTLNEESYK")
    fi.cyz &lt;- as.data.frame(cbind(c=fi[[1]]$c, y=fi[[1]]$y, z=fi[[1]]$z))

    p &lt;- peakplot("TAFDEAIAELDTLNEESYK", spec=msms[[1]],
        fi=fi.cyz,
        itol=0.6,
        ion.axes=FALSE)
        
          
    # customizing the ion series
    ions &lt;- function(b, y){
      Hydrogen &lt;- 1.007825
      Oxygen &lt;- 15.994915
      Nitrogen &lt;- 14.003074
  
      y0 &lt;- fi$y - Oxygen - Hydrogen - Hydrogen
      c &lt;- b + (Nitrogen + (3 * Hydrogen))
      z &lt;- y - (Nitrogen + (3 * Hydrogen))
      
      return(cbind(b, y, c ,z, y0))
  }
</code></pre>


</div>