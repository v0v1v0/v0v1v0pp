<div class="container">

<table style="width: 100%;"><tr>
<td>PH1ARMA</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>Phase I individual control chart with an ARMA model</h2>

<h3>Description</h3>

<p>Build a Phase I individual control chart for the ARMA models. The charting constant is corrected by this approach.
</p>


<h3>Usage</h3>

<pre><code class="language-R">PH1ARMA(
  X,
  cc = NULL,
  fap0 = 0.05,
  order = c(1, 0, 0),
  plot.option = TRUE,
  interval = c(1, 4),
  case = "U",
  phi.vec = NULL,
  theta.vec = NULL,
  mu0 = NULL,
  sigma0 = NULL,
  method = "MLE+MOM",
  nsim.coefs = 100,
  nsim.process = 1000,
  burn.in = 50,
  sim.type = "Matrix",
  standardize = TRUE,
  verbose = FALSE
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>X</code></td>
<td>
<p>input and it must be a vector</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>cc</code></td>
<td>
<p>nominal Phase I charting constant. If this is given, the function will not re-compute the charting constant.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>fap0</code></td>
<td>
<p>nominal false Alarm Probabilty in Phase I</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>order</code></td>
<td>
<p>order for ARMA model</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>plot.option</code></td>
<td>
<p>- draw a plot for the process; FALSE - Not draw a plot for the process</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>interval</code></td>
<td>
<p>searching range of charting constants for the exact method</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>case</code></td>
<td>
<p>known or unknown case.  When case = 'U', the parameters are estimated</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>phi.vec</code></td>
<td>
<p>vector of autoregressive coefficient(s).  When case = 'K', the vector needs to be provided with the length same as the first value in the order.  If autoregressive coefficents does not present, phi needs to be NULL</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>theta.vec</code></td>
<td>
<p>vector of moving-average coefficient(s).  When case = 'K', the vector needs to be provided with the length same as the third value in the order.  If moving-average coefficents does not present, theta needs to be NULL</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>mu0</code></td>
<td>
<p>value of the IC process mean.  When case = 'K', the value needs to be provided.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>sigma0</code></td>
<td>
<p>value of the IC process standard deviation.  When case = 'K', the value needs to be provided.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>method</code></td>
<td>
<p>estimation method for the control chart. When method = 'MLE+MOM' is maximum likehood estimations plus method of moments. Other options are 'MLE' which is pure MLE and 'CSS' which is pure CSS.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>nsim.coefs</code></td>
<td>
<p>number of simulation for coeficients.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>nsim.process</code></td>
<td>
<p>number of simulation for ARMA processes</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>burn.in</code></td>
<td>
<p>number of burn-ins.  When burn.in = 0, the simulated process is assumed to be in the initial stage.  When burn.in is large enough, the simulated process is assumed to be in the stable stage.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>sim.type</code></td>
<td>
<p>type of simulation.  When sim.type = 'Matrix', the simulation is generated using matrix computation.  When sim.type = 'Recursive', the simulation is based on a recursion.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>standardize</code></td>
<td>
<p>Output standardized data instead of raw data</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>verbose</code></td>
<td>
<p>print diagnostic information about fap0 and the charting constant during the simulations for the exact method</p>
</td>
</tr>
</table>
<h3>Value</h3>

<p>CL Object type double - central line
</p>
<p>gamma Object type double - process variance estimate
</p>
<p>cc Object type double - charting constant
</p>
<p>order Object type integer - order for ARMA model
</p>
<p>phi.vec Object type integer - values of autoregressors
</p>
<p>theta.vec Object type integer - values of moving averages
</p>
<p>LCL Object type double - lower charting limit
</p>
<p>UCL Object type double - upper charting limit
</p>
<p>CS Object type double - charting statistic
</p>


<h3>References</h3>

<p>Yao, Y., Chakraborti, S., Yang, X., Parton, J., Lewis Jr, D., and Hudnall, M. (2023). Phase I control chart for individual autocorrelated data: application to prescription opioid monitoring. Journal of Quality Technology, 55(3), 302-317.
</p>


<h3>Examples</h3>

<pre><code class="language-R"># load the data in the package as an example
data(preston_data)

# set number of simulations
nsim.process &lt;- 10
nsim.coefs &lt;- 10

# An example using the default setting whose fap0 = 0.1
PH1ARMA(preston_data, nsim.process = nsim.process, nsim.coefs = nsim.coefs)

# When users get an error message about the size of matrix,
# the function needs to use the alternative simulation type as follows
PH1ARMA(preston_data, fap0 = 0.05, 
	nsim.process = nsim.process, nsim.coefs = nsim.coefs, sim.type = 'Recursive')

</code></pre>


</div>