<div class="container">

<table style="width: 100%;"><tr>
<td>heft</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>Heft: hazard estimation with flexible tails</h2>

<h3>Description</h3>

<p>Hazard estimation using cubic splines to 
approximate the log-hazard function and special functions to allow
non-polynomial shapes in both tails. 
</p>


<h3>Usage</h3>

<pre><code class="language-R">heft(data, delta, penalty, knots, leftlin, shift, leftlog,
rightlog, maxknots, mindist, silent = TRUE) </code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>data</code></td>
<td>

<p>vector of observations. Observations may or may not be right censored. All
observations should be nonnegative.
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>delta</code></td>
<td>

<p>binary vector with the same length as <code>data</code>. Elements of <code>data</code>
for which the corresponding element of <code>delta</code> is 0 are assumed to be
right censored, elements of <code>data</code>
for which the corresponding element of <code>delta</code> is 1 are assumed to be
uncensored. If <code>delta</code> is missing, all observations are assumed to be uncensored.
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>penalty</code></td>
<td>

<p>the parameter to be used in the AIC criterion. The method chooses
the number of knots that minimizes <code>-2 * loglikelihood + penalty * (dimension)</code>.
The default is to use <code>penalty = log(samplesize)</code> as in BIC. The effect of
this parameter is summarized in <code>summary.heft</code>.
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>knots</code></td>
<td>

<p>ordered vector of values, which forces the method to start with these knots. 
If <code>knots</code> is not specified, a default knot-placement rule is employed. 
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>leftlin</code></td>
<td>

<p>if <code>leftlin</code> is <code>TRUE</code> an extra basis-function, which is linear to the left 
of the first knot, is included in the basis. 
If any of <code>data</code> is exactly 0, the default of <code>leftlin</code> is <code>TRUE</code>,
otherwise it is <code>FALSE</code>.
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>shift</code></td>
<td>

<p>parameter for the log terms. Default is <code>quantile(data[delta == 1], .75)</code>. 
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>leftlog</code></td>
<td>

<p>coefficient of <code class="reqn">\log \frac x{x + \mbox{shift}}</code>, which must be greater than 
<code>-1</code>. 
(In particular, if <code>leftlog</code> equals zero no 
<code class="reqn">\log \frac x{x + \mbox{shift}}</code> term 
is included.) If <code>leftlog</code> is missing its maximum likelihood estimate is used. 
If any of <code>data</code> is exactly zero, <code>leftlog</code> is  
set to zero. 
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>rightlog</code></td>
<td>

<p>coefficient of <code class="reqn">\log (x + \mbox{shift})</code>, which must be greater than 
<code>-1</code>.
(In particular, if <code>leftlog</code> equals zero no  
<code class="reqn">\log (x + \mbox{shift})</code> term
is included.)
If <code>rightlog</code> is missing its maximum likelihood estimate is used. 
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>maxknots</code></td>
<td>

<p>maximum number of knots allowed in the model (default is 
<code class="reqn">4*n^{0.2})</code>, where <code class="reqn">n</code> is the length of
<code>data</code>.
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>mindist</code></td>
<td>
<p> minimum distance in order statistics between knots. The
default is 5.  </p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>silent</code></td>
<td>

<p>suppresses the printing of diagnostic output about knots added or deleted, 
Rao-statistics, Wald-statistics and log-likelihoods. 
</p>
</td>
</tr>
</table>
<h3>Value</h3>

<p>An object of class
<code>heft</code>, which is organized to serve as input for <code>plot.heft</code>,
<code>summary.heft</code>, <code>dheft</code> (density), <code>hheft</code>
(hazard rate), <code>pheft</code> (probabilities), <code>qheft</code>
(quantiles), and <code>rheft</code> (random numbers).
The object is a list with the following members:
</p>
<table>
<tr style="vertical-align: top;">
<td><code>knots </code></td>
<td>

<p>vector of the locations of the knots in the <code>heft</code> model. 
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>logl</code></td>
<td>

<p>the <code>k</code>-th element is the log-likelihood of the fit with <code>k</code> knots. 
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>thetak</code></td>
<td>

<p>coefficients of the knot part of the 
spline. The k-th coefficient is the coefficient 
of  <code class="reqn">(x-t(k))^3_+</code>. If a coefficient is zero the corresponding 
knot was considered and then deleted from the model. 
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>thetap</code></td>
<td>

<p>coefficients of the polynomial part of the spline. 
The first element is the constant term and 
the second element is the linear term. 
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>thetal</code></td>
<td>

<p>coefficients of the logarithmic terms. The first element equals 
<code>leftlog</code> and the second element equals <code>rightlog</code>. 
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>penalty</code></td>
<td>

<p>the penalty that was used. 
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>shift</code></td>
<td>
<p> parameter used in the definition of the log terms.  </p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>sample</code></td>
<td>
<p> the sample size.  </p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>logse</code></td>
<td>
<p> the standard errors of <code>thetal</code>.  </p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>max</code></td>
<td>
<p> the largest element of data.  </p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>ad</code></td>
<td>
<p> vector indicating whether a model of this dimension 
was not fit (2), fit during the addition stage (0) or during 
the deletion stage (1).  </p>
</td>
</tr>
</table>
<h3>Author(s)</h3>

<p> Charles Kooperberg <a href="mailto:clk@fredhutch.org">clk@fredhutch.org</a>.</p>


<h3>References</h3>

<p>Charles Kooperberg, Charles J. Stone and Young K. Truong (1995).
Hazard regression.  <em>Journal of the American Statistical
Association</em>, <b>90</b>, 78-94.
</p>
<p>Charles J. Stone, Mark Hansen, Charles Kooperberg, and Young K. Truong.
The use of polynomial splines and their tensor products in extended
linear modeling (with discussion) (1997).  <em>Annals of Statistics</em>,
<b>25</b>, 1371â€“1470.</p>


<h3>See Also</h3>

<p><code>hare</code>,
<code>plot.heft</code>,
<code>summary.heft</code>,
<code>dheft</code>,
<code>hheft</code>,
<code>pheft</code>,
<code>qheft</code>,
<code>rheft</code>.</p>


<h3>Examples</h3>

<pre><code class="language-R">fit1 &lt;- heft(testhare[,1], testhare[,2])
# modify tail behavior
fit2 &lt;- heft(testhare[,1], testhare[,2], leftlog = FALSE, rightlog = FALSE, 
          leftlin = TRUE)   
fit3 &lt;- heft(testhare[,1], testhare[,2], penalty = 0)   # select largest model
</code></pre>


</div>