<div class="container">

<table style="width: 100%;"><tr>
<td>phylomorphospace3d</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>Creates three-dimensional phylomorphospace plot</h2>

<h3>Description</h3>

<p>Creates a phylomorphospace plot in three dimensions.
</p>


<h3>Usage</h3>

<pre><code class="language-R">phylomorphospace3d(tree, X, A=NULL, label=TRUE, control=list(), 
   method=c("dynamic","static"), ...)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>tree</code></td>
<td>
<p>a phylogenetic tree in <code>"phylo"</code> format.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>X</code></td>
<td>
<p>an <code>n</code> x 3 matrix of tip values for two characters in <code>n</code> species.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>A</code></td>
<td>
<p>an optional <code>m</code> x 3 matrix (for <code>m</code> nodes) of values for two traits at internal nodes in the tree - if not supplied, these values will be estimated using <code>anc.ML</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>label</code></td>
<td>
<p>logical value indicating whether to print tip labels next to terminal nodes in the plot (presently doesn't do anything, but labels can be dropped using <code>control</code>).</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>control</code></td>
<td>
<p>a list containing the following optional control parameters: <code>spin</code>: a logical value indicating whether to animate the plot when created; <code>axes</code>: a logical indicating whether to plot the axes; <code>box</code>: a logical value indicating whether to plot in box; <code>simple.axes</code>: logical value indicating whether to replace <code>box</code> and <code>axes</code> with simpler axes; <code>lwd</code>: line widths; <code>ftype</code>: font type ("off" turns off labels altogether); <code>col.edge</code> a vector of colors of length <code>nrow(tree$edge)</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>method</code></td>
<td>
<p>a string either <code>"dynamic"</code> for a dynamic (animated) plot created using <span class="pkg">rgl</span>; or <code>"static"</code> for a flat 3D plot created using <code>scatterplot3d</code> and base graphics. The latter has the advantage of being very easy to export in standard format.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>...</code></td>
<td>
<p>optional arguments to be passed to <code>scatterplot3d</code>. Most options not available. <code>angle</code> is an important option that does work here.</p>
</td>
</tr>
</table>
<h3>Details</h3>

<p>This function creates a phylomorphospace plot for three characters using the 3D visualization package, <span class="pkg">rgl</span> (if available) or statically, by simulating 3D on a flat graphical device.
</p>


<h3>Value</h3>

<p>This function creates a three dimensional phylomorphospace plot. The function returns a function from <code>spin3d</code> (for <code>method="dynamic"</code>); or a series of functions from <code>scatterplot3d</code> (for <code>method="static"</code>).
</p>


<h3>Author(s)</h3>

<p>Liam Revell <a href="mailto:liam.revell@umb.edu">liam.revell@umb.edu</a></p>


<h3>References</h3>

<p>Revell, L. J. (2014) Graphical methods for visualizing comparative data on phylogenies. Chapter 4 in <em>Modern phylogenetic comparative methods and their application in evolutionary biology: Concepts and practice</em> (L. Z. Garamszegi ed.), pp. 77-103.
</p>
<p>Revell, L. J. (2024) phytools 2.0: an updated R ecosystem for phylogenetic comparative methods (and other things). <em>PeerJ</em>, <b>12</b>, e16505.
</p>
<p>Sidlauskas, B. (2008) Continuous and arrested morphological diversification in sister clades of characiform fishes: A phylomorphospace approach. <em>Evolution</em>, <b>62</b>, 3135-3156.
</p>


<h3>See Also</h3>

<p><code>fancyTree</code>, <code>phenogram</code>, <code>phylomorphospace</code>
</p>


<h3>Examples</h3>

<pre><code class="language-R">data(anoletree)
data(anole.data)
anole.pca&lt;-phyl.pca(anoletree,anole.data)
## Not run: 
phylomorphospace3d(anoletree,scores(anole.pca)[,1:3],
    control=list(spin=FALSE))
## End(Not run)
par(cex=0.5)
phylomorphospace3d(anoletree,scores(anole.pca)[,1:3],
    method="static",angle=-30)
par(cex=1)
</code></pre>


</div>