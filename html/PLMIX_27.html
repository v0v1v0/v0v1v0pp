<div class="container">

<table style="width: 100%;"><tr>
<td>mapPLMIX_multistart</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>MAP estimation for a Bayesian mixture of Plackett-Luce models with multiple starting values</h2>

<h3>Description</h3>

<p>Perform MAP estimation via EM algorithm with multiple starting values for a Bayesian mixture of Plackett-Luce models fitted to partial orderings.
</p>


<h3>Usage</h3>

<pre><code class="language-R">mapPLMIX_multistart(pi_inv, K, G, n_start = 1, init = rep(list(list(p =
  NULL, omega = NULL)), times = n_start), n_iter = 200,
  hyper = list(shape0 = matrix(1, nrow = G, ncol = K), rate0 = rep(0, G),
  alpha0 = rep(1, G)), eps = 10^(-6), plot_objective = FALSE,
  init_index = 1:n_start, parallel = FALSE, centered_start = FALSE)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>pi_inv</code></td>
<td>
<p>An object of class <code>top_ordering</code>, collecting the numeric <code class="reqn">N</code><code class="reqn">\times</code><code class="reqn">K</code> data matrix of partial orderings, or an object that can be coerced with <code>as.top_ordering</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>K</code></td>
<td>
<p>Number of possible items.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>G</code></td>
<td>
<p>Number of mixture components.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>n_start</code></td>
<td>
<p>Number of starting values.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>init</code></td>
<td>
<p>List of <code>n_start</code> lists of named objects with initialization values: <code>p</code> is a numeric <code class="reqn">G</code><code class="reqn">\times</code><code class="reqn">K</code> matrix of component-specific support parameters; <code>omega</code> is a numeric vector of <code class="reqn">G</code> mixture weights. If starting values are not supplied (<code>NULL</code>), they are randomly generated with a uniform distribution. Default is <code>NULL</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>n_iter</code></td>
<td>
<p>Maximum number of EM iterations.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>hyper</code></td>
<td>
<p>List of named objects with hyperparameter values for the conjugate prior specification: <code>shape0</code> is a numeric <code class="reqn">G</code><code class="reqn">\times</code><code class="reqn">K</code> matrix of shape hyperparameters; <code>rate0</code> is a numeric vector of <code class="reqn">G</code> rate hyperparameters; <code>alpha0</code> is a numeric vector of <code class="reqn">G</code> Dirichlet hyperparameters. Default is noninformative (flat) prior setting.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>eps</code></td>
<td>
<p>Tolerance value for the convergence criterion.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>plot_objective</code></td>
<td>
<p>Logical: whether the objective function (that is the kernel of the log-posterior distribution) should be plotted. Default is <code>FALSE</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>init_index</code></td>
<td>
<p>Numeric vector indicating the positions of the starting values in the <code>init</code> list to be actually launched. Useful to launch the most promising starting values identified after a preliminary run. Default is run all the starting points in the <code>init</code> list.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>parallel</code></td>
<td>
<p>Logical: whether parallelization should be used. Default is <code>FALSE</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>centered_start</code></td>
<td>
<p>Logical: whether a random start whose support parameters and weights should be centered around the observed relative frequency that each item has been ranked top. Default is <code>FALSE</code>. Ignored when <code>init</code> is not <code>NULL</code>.</p>
</td>
</tr>
</table>
<h3>Details</h3>

<p>Under noninformative (flat) prior setting, the EM algorithm for MAP estimation corresponds to the EMM algorithm described by Gormley and Murphy (2006) to perform frequentist inference. In this case the MAP solution coincides with the MLE. The best model in terms of maximized posterior distribution is returned.
</p>


<h3>Value</h3>

<p>A list of S3 class <code>mpPLMIX</code> with named elements:
</p>
<table>
<tr style="vertical-align: top;">
<td><code>mod</code></td>
<td>
<p> List of named objects describing the best model in terms of maximized posterior distribution. See output values of the single-run <code>mapPLMIX</code> function for a detailed explanation of the list elements.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>max_objective</code></td>
<td>
<p> Numeric vector of the maximized objective function values for each initialization.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>convergence</code></td>
<td>
<p> Binary vector with <code>length(init_index)</code> convergence indicators for each initialization: 1 = convergence has been achieved, 0 = otherwise.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>call</code></td>
<td>
<p> The matched call.</p>
</td>
</tr>
</table>
<h3>Author(s)</h3>

<p>Cristina Mollica and Luca Tardella
</p>


<h3>References</h3>

<p>Mollica, C. and Tardella, L. (2017). Bayesian Plackett-Luce mixture models for partially ranked data. <em>Psychometrika</em>, <b>82</b>(2), pages 442–458, ISSN: 0033-3123, DOI: 10.1007/s11336-016-9530-0.
</p>
<p>Gormley, I. C. and Murphy, T. B. (2006). Analysis of Irish third-level college applications data. <em>Journal of the Royal Statistical Society: Series A</em>, <b>169</b>(2), pages 361–379, ISSN: 0964-1998, DOI: 10.1111/j.1467-985X.2006.00412.x.
</p>


<h3>See Also</h3>

<p><code>mapPLMIX</code>
</p>


<h3>Examples</h3>

<pre><code class="language-R">
data(d_carconf)
MAP_mult &lt;- mapPLMIX_multistart(pi_inv=d_carconf, K=ncol(d_carconf), G=3, 
                                            n_start=2, n_iter=400*3)
str(MAP_mult)
MAP_mult$mod$P_map
MAP_mult$mod$W_map

</code></pre>


</div>