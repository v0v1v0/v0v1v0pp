<div class="container">

<table style="width: 100%;"><tr>
<td>prep_func_node_info</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>Get node indices of FSN and BSN categories across tree for a given function</h2>

<h3>Description</h3>

<p>Parse POMS_pipeline output to look at FSNs for a specific function (e.g., a specific gene family). Will also parse BSN information (which is not dependent on a particular function).
This is convenient to do before plotting the distribution of FSNs and BSNs across the tree with the ggtree R package for instance.
When a taxa label table is specified, labels of tested nodes in the tree (found in the POMS_pipeline output object) will be renamed to be the representative taxa on each side.
</p>


<h3>Usage</h3>

<pre><code class="language-R">prep_func_node_info(
  POMS_output,
  func_id,
  taxa_table = NULL,
  taxa_threshold = 0.75,
  full_taxon_label = FALSE
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>POMS_output</code></td>
<td>
<p>output object from POMS_pipeline function.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>func_id</code></td>
<td>
<p>label of function for which should FSNs should be parsed. Must be present in POMS_output$FSNs_summary.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>taxa_table</code></td>
<td>
<p>optional dataframe containing taxa labels for each tip of tree. Must be in same format as expected for node_taxa function.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>taxa_threshold</code></td>
<td>
<p>float &gt; 0.5 and &lt;= 1.0 specifying the proportion of tips that must share a taxon label for it to be considered representative. Only relevant if taxa_table specified.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>full_taxon_label</code></td>
<td>
<p>boolean flag for whether taxon labels should be combined, so that all higher taxonomic labels are included. Specifically, when TRUE, all higher labels are concatenated and delimited by "; ".
E.g., rather than just the genus "Odoribacter" the label would be "Bacteria; Bacteroidetes; Bacteroidia; Bacteroidales; Porphyromonadaceae; Odoribacter". Only relevant if taxa_table specified.</p>
</td>
</tr>
</table>
<h3>Value</h3>

<p>List containing final tree as well as indices of nodes corresponding to different FSN and BSN categories.
If taxa_table was specified, then node labels in tree will correspond to representative taxa on each side of the
nodes that were tested (i.e., those that were non-negligible).
</p>


</div>