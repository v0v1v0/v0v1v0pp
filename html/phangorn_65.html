<div class="container">

<table style="width: 100%;"><tr>
<td>bootstrap.pml</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>Bootstrap</h2>

<h3>Description</h3>

<p><code>bootstrap.pml</code> performs (non-parametric) bootstrap analysis and
<code>bootstrap.phyDat</code> produces a list of bootstrapped data sets.
<code>plotBS</code> plots a phylogenetic tree with the bootstrap values assigned
to the (internal) edges.
</p>


<h3>Usage</h3>

<pre><code class="language-R">bootstrap.pml(x, bs = 100, trees = TRUE, multicore = FALSE,
  mc.cores = NULL, tip.dates = NULL, ...)

bootstrap.phyDat(x, FUN, bs = 100, multicore = FALSE, mc.cores = NULL,
  jumble = TRUE, ...)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>x</code></td>
<td>
<p>an object of class <code>pml</code> or <code>phyDat</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>bs</code></td>
<td>
<p>number of bootstrap samples.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>trees</code></td>
<td>
<p>return trees only (default) or whole <code>pml</code> objects.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>multicore</code></td>
<td>
<p>logical, whether models should estimated in parallel.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>mc.cores</code></td>
<td>
<p>The number of cores to use during bootstrap. Only supported
on UNIX-alike systems.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>tip.dates</code></td>
<td>
<p>A named vector of sampling times associated to the
tips/sequences. Leave empty if not estimating tip dated phylogenies.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>...</code></td>
<td>
<p>further parameters used by <code>optim.pml</code> or
<code>plot.phylo</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>FUN</code></td>
<td>
<p>the function to estimate the trees.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>jumble</code></td>
<td>
<p>logical, jumble the order of the sequences.</p>
</td>
</tr>
</table>
<h3>Details</h3>

<p>It is possible that the bootstrap is performed in parallel, with help of the
multicore package. Unfortunately the multicore package does not work under
windows or with GUI interfaces ("aqua" on a mac). However it will speed up
nicely from the command line ("X11").
</p>


<h3>Value</h3>

<p><code>bootstrap.pml</code> returns an object of class <code>multi.phylo</code>
or a list where each element is an object of class <code>pml</code>. <code>plotBS</code>
returns silently a tree, i.e. an object of class <code>phylo</code> with the
bootstrap values as node labels. The argument <code>BStrees</code> is optional and
if not supplied the tree with labels supplied in the <code>node.label</code> slot.
</p>


<h3>Author(s)</h3>

<p>Klaus Schliep <a href="mailto:klaus.schliep@gmail.com">klaus.schliep@gmail.com</a>
</p>


<h3>References</h3>

<p>Felsenstein J. (1985) Confidence limits on phylogenies. An
approach using the bootstrap. <em>Evolution</em> <b>39</b>, 783–791
</p>
<p>Lemoine, F., Entfellner, J. B. D., Wilkinson, E., Correia, D., Felipe, M. D.,
De Oliveira, T., &amp; Gascuel, O. (2018). Renewing Felsenstein’s phylogenetic
bootstrap in the era of big data. <em>Nature</em>, <b>556(7702)</b>, 452–456.
</p>
<p>Penny D. and Hendy M.D. (1985) Testing methods evolutionary tree
construction. <em>Cladistics</em> <b>1</b>, 266–278
</p>
<p>Penny D. and Hendy M.D. (1986) Estimating the reliability of evolutionary
trees. <em>Molecular Biology and Evolution</em> <b>3</b>, 403–417
</p>


<h3>See Also</h3>

<p><code>optim.pml</code>, <code>pml</code>,
<code>plot.phylo</code>, <code>maxCladeCred</code>
<code>nodelabels</code>,<code>consensusNet</code> and
<code>SOWH.test</code> for parametric bootstrap
</p>


<h3>Examples</h3>

<pre><code class="language-R">
## Not run: 
data(Laurasiatherian)
dm &lt;- dist.hamming(Laurasiatherian)
tree &lt;- NJ(dm)
# NJ
set.seed(123)
NJtrees &lt;- bootstrap.phyDat(Laurasiatherian,
     FUN=function(x)NJ(dist.hamming(x)), bs=100)
treeNJ &lt;- plotBS(tree, NJtrees, "phylogram")

# Maximum likelihood
fit &lt;- pml(tree, Laurasiatherian)
fit &lt;- optim.pml(fit, rearrangement="NNI")
set.seed(123)
bs &lt;- bootstrap.pml(fit, bs=100, optNni=TRUE)
treeBS &lt;- plotBS(fit$tree,bs)

# Maximum parsimony
treeMP &lt;- pratchet(Laurasiatherian)
treeMP &lt;- acctran(treeMP, Laurasiatherian)
set.seed(123)
BStrees &lt;- bootstrap.phyDat(Laurasiatherian, pratchet, bs = 100)
treeMP &lt;- plotBS(treeMP, BStrees, "phylogram")
add.scale.bar()

# export tree with bootstrap values as node labels
# write.tree(treeBS)

## End(Not run)

</code></pre>


</div>