<div class="container">

<table style="width: 100%;"><tr>
<td>findPolys</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>Find Polygons that Contain Events</h2>

<h3>Description</h3>

<p>Find the polygons in a PolySet that contain events specified in
EventData.
</p>


<h3>Usage</h3>

<pre><code class="language-R">findPolys (events, polys, maxRows = 1e+05, includeBdry=NULL)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>events</code></td>
<td>
<p>EventData to use.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>polys</code></td>
<td>
<p>PolySet to use.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>maxRows</code></td>
<td>
<p>estimated maximum number of rows in the output LocationSet.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>includeBdry</code></td>
<td>
<p>numeric: determines how points on boundaries are handled: <br>
if <code>NULL</code> then report all points on polygon boundaries (default behaviour); <br>
if <code>0</code> then exclude all points on polygon boundaries; <br>
if <code>1</code> then report only the first (lowest PID/SID) polygon boundary; <br>
if <code>2,...,n</code> then report the last (highest PID/SID) polygon boundary.</p>
</td>
</tr>
</table>
<h3>Details</h3>

<p>The resulting data frame, a LocationSet, contains the columns
<code>EID</code>, <code>PID</code>, <code>SID</code> (<em>if in</em> <code>polys</code>), and
<code>Bdry</code>, where an event (<code>EID</code>) occurs in a polygon
(<code>PID</code>, <code>SID</code>) and <code>SID</code> does not correspond to an
inner boundary.  The Boolean variable <code>Bdry</code> indicates whether an
event lies on a polygon's edge.  Note that if an event lies properly
outside of all the polygons, then a record with (<code>EID</code>,
<code>PID</code>, <code>SID</code>) does not occur in the output.  It may happen,
however, that an event occurs in multiple polygons.  Thus, the same
<code>EID</code> can occur more than once in the output.
</p>
<p>If an event happens to lie at the boundary intersection of two or more polygons
then one <code>EID</code> will be associated with two or more polygons. A user
can choose to manipulate this result by setting the argument <code>includeBdry</code>
to a numeric value that constrains the association of a boundary event to
0 or 1 polygon (see argument description above).
</p>


<h3>Value</h3>

<p>LocationSet that links events with polygons.
</p>


<h3>Author(s)</h3>

<p><a href="https://github.com/boersn/">Nicholas M. Boers</a>, Staff Software Engineer<br>
Jobber, Edmonton AB<br>
Last modified <code>Rd: 2014-12-15</code>
</p>


<h3>See Also</h3>

<p><code>combineEvents</code>,
<code>findCells</code>,
<code>locateEvents</code>,
<code>locatePolys</code>,
LocationSet,
<code>makeGrid</code>.
</p>


<h3>Examples</h3>

<pre><code class="language-R">local(envir=.PBSmapEnv,expr={
  oldpar = par(no.readonly=TRUE)
  #--- create some EventData: a column of points at X = 0.5
  events &lt;- data.frame(EID=1:10, X=.5, Y=seq(0, 2, length=10))
  events &lt;- as.EventData(events, projection=1)
  #--- create a PolySet: two squares with the second above the first
  polys &lt;- data.frame(PID=c(rep(1, 4), rep(2, 4)), POS=c(1:4, 1:4),
    X=c(0, 1, 1, 0, 0, 1, 1, 0),
    Y=c(0, 0, 1, 1, 1, 1, 2, 2))
  polys &lt;- as.PolySet(polys, projection=1)
  #--- show a picture
  plotPolys(polys, xlim=range(polys$X)+c(-0.1, 0.1),
    ylim=range(polys$Y)+c(-0.1, 0.1), projection=1);
  addPoints(events, col=2);
  #--- run findPolys and print the results
  print(findPolys(events, polys))
  par(oldpar)
})
</code></pre>


</div>