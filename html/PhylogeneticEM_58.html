<div class="container">

<table style="width: 100%;"><tr>
<td>find_grid_alpha</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>Find a reasonable grid for alpha</h2>

<h3>Description</h3>

<p>Grid so that 
2*ln(2)*quantile(d_ij)/factor_up_alpha &lt; t_1/2 &lt; factor_down_alpha * ln(2) * h_tree,
with t_1/2 the phylogenetic half life: t_1/2 = log(2)/alpha.
Ensures that for alpha_min, it is almost a BM, and for alpha_max,
almost all the tips are decorrelated.
</p>


<h3>Usage</h3>

<pre><code class="language-R">find_grid_alpha(
  phy,
  alpha = NULL,
  nbr_alpha = 10,
  factor_up_alpha = 2,
  factor_down_alpha = 3,
  quantile_low_distance = 1e-04,
  log_transform = TRUE,
  allow_negative = FALSE,
  ...
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>phy</code></td>
<td>
<p>phylogenetic tree of class "<code>phylo</code>"</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>alpha</code></td>
<td>
<p>fixed vector of alpha values if already known. Default to NULL.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>nbr_alpha</code></td>
<td>
<p>the number of elements in the grid</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>factor_up_alpha</code></td>
<td>
<p>factor for up scalability</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>factor_down_alpha</code></td>
<td>
<p>factor for down scalability</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>quantile_low_distance</code></td>
<td>
<p>quantile for min distance</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>log_transform</code></td>
<td>
<p>whether to take a log scale for the spacing of alpha
values. Default to TRUE.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>allow_negative</code></td>
<td>
<p>whether to allow negative values for alpha (Early Burst).
See documentation of <code>PhyloEM</code> for more details. Default to FALSE.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>...</code></td>
<td>
<p>not used.</p>
</td>
</tr>
</table>
<h3>Details</h3>

<p>If <code>quantile_low_distance=0</code>, then <code>quantile(d_ij)=min(d_ij)</code>, and, for any
two tips i,j, the correlation between i and j is bounded by exp(-factor_up_alpha/2).
Those values of alpha will be used for the re-scaling of the tree, which has an 
exponential term in exp(2*alpha*h). The function makes sure that this number is
below the maximal float allowed (equals to <code>.Machine$double.xmax</code>).
</p>


<h3>Value</h3>

<p>A grid of alpha values
</p>


<h3>See Also</h3>

<p><code>transform_branch_length</code>, <code>.Machine</code>
</p>


</div>