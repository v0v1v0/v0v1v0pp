<div class="container">

<table style="width: 100%;"><tr>
<td>pointdensity</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>Point density function for geospatial data</h2>

<h3>Description</h3>

<p>This function maps a dataset of geospatial points to a regular grid and calculates the density and temporal average of the points.
</p>


<h3>Usage</h3>

<pre><code class="language-R">pointdensity(df, lat_col, lon_col, date_col = NULL, grid_size, radius)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>df</code></td>
<td>
<p>Data frame minimally containing latitude and longitude of spatial point data</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>lat_col</code></td>
<td>
<p>name of column in <code>df</code> that contains latitude or vertical dimension of data</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>lon_col</code></td>
<td>
<p>name of column in <code>df</code> that contains longitude or horizontal dimension of data</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>date_col</code></td>
<td>
<p>name of column in <code>df</code> that contains date associated with the event</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>grid_size</code></td>
<td>
<p>distance in kilometers between the grid lines that will support discretization of data and density reference</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>radius</code></td>
<td>
<p>distance in kilometers that represents the local neighborhood where an event adds density</p>
</td>
</tr>
</table>
<h3>Details</h3>

<p><code>pointdensity</code> returns a density count and the temporal average for every point in the original list.  The dataframe returned includes four columns:  lat, lon, count, and date_avg.  The "lat" column is the original latitude data; the "lon" column is the original longitude data; the "count" is the density count of the number of points within a defined radius (the neighborhood); and the date_avg column includes the average date of each point in the neighborhood.  Designed specifically for geospatial point processes and originally developed for military applications, this technique applies to any geospatial point process where there is a desire for an explainable measurement of density and maintaining fidelity of the original point locations.  Typical spatial density plotting algorithms, such as kernel density estimation, implement some type of smoothing function that often results in a density value that is difficult to interpret.  <code>pointdensity</code> was designed for ease of interpretation.  Potential applications include analysis of military events,  crime, and real estate transactions.  An example follows with the Arigon data using <span class="pkg">ggmap</span> (recommended) for visualization: <br><br><code>Arigon_density &lt;- pointdensity(df = Arigon, lat_col = "latitude", lon_col = "longitude",</code> <br><code>date_col = "date", grid_size = 1, radius = 2)</code> <br><code>map_base &lt;- qmap(location="44.12,-120.83", zoom = 7, darken=0.3)</code> <br><code>map_base + geom_point(aes(x = lon, y = lat, colour = count), shape = 16, size = 2,</code> <br><code>data = Arigon_density) + scale_colour_gradient(low = "green", high = "red")</code> <br><br></p>
<p>Here is another example using the crime dataset from <span class="pkg">ggmap</span>:<br><br><code>H_crime &lt;- pointdensity(df = clean_crime, lat_col = "lat", lon_col = "lon",</code> <br><code>grid_size = 1, radius = 4)</code><br><code>map_base &lt;- qmap(location="29.76,-95.42", zoom = 11, darken=0.3)</code><br><code>map_base + geom_point(aes(x = lon, y = lat, colour = count), shape = 16, size = 2,</code> <br><code>data = H_crime) + scale_colour_gradient(low = "green", high = "red")</code>
</p>


<h3>Author(s)</h3>

<p>Paul Evangelista <a href="mailto:paul.evangelista@usma.edu">paul.evangelista@usma.edu</a>
</p>
<p>David Beskow <a href="mailto:david.beskow@usma.edu">david.beskow@usma.edu</a>
</p>


<h3>References</h3>

<p>Wand, M. P. (1994). Fast Computation of Multivariate Kernel Estimators. <em>Journal of Computational and Graphical Statistics</em>, 3, 433-445.
</p>


<h3>Examples</h3>

<pre><code class="language-R">Arigon_test &lt;- Arigon[1:1000,]
Arigon_density &lt;- pointdensity(df = Arigon_test, lat_col = "latitude", 
lon_col = "longitude", date_col = "date", grid_size = 1, radius = 2)
</code></pre>


</div>