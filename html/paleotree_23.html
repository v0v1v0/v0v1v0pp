<div class="container">

<table style="width: 100%;"><tr>
<td>testEdgeMat</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>Test the Edge Matrix of a '<code>phylo</code>' Phylogeny Object for Inconsistencies</h2>

<h3>Description</h3>

<p><code>testEdgeMat</code> is a small simple function which tests
the <code>$edge</code> matrix of <code>phylo</code> objects for
inconsistencies that can cause downstream analytical problems.
The associated function, <code>cleanNewPhylo</code> puts an input
<code>phylo</code> object, presumably freshly created or
reconstituted by some function, through a series
of post-processing, This includes having singles collapsed,
nodes reordered and being written out as a Newick string and read back in,
to ensure functionality with ape functions
and <code>ape</code>-derived functions.
</p>


<h3>Usage</h3>

<pre><code class="language-R">testEdgeMat(tree)

cleanNewPhylo(tree)
</code></pre>


<h3>Arguments</h3>

<table><tr style="vertical-align: top;">
<td><code>tree</code></td>
<td>
<p>A phylogeny object of type <code>phylo</code>.</p>
</td>
</tr></table>
<h3>Details</h3>

<p>Useful when doing complex manipulations of <code>phylo</code> objects (or reconstituting them, or their
<em>de novo</em> construction), and thus is used by a number of <code>paleotree</code> functions.
</p>


<h3>Value</h3>

<p>For <code>testEdgeMat</code>, if all the checks in the function pass correctly, 
the logical <code>TRUE</code> is returned.
</p>
<p>For <code>cleanNewPhylo</code>, an object of class <code>phylo</code> is returned.
</p>


<h3>Author(s)</h3>

<p>David W. Bapst, with a large number of tests incorporated from 
Emmanuel Paradis's <code>checkValidPhylo</code> function in package <code>ape</code>,
(released under the GPL v&gt;2).
</p>


<h3>Examples</h3>

<pre><code class="language-R">
set.seed(444)
tree &lt;- rtree(10)
# should return TRUE
testEdgeMat(tree)

# should also work on star trees
testEdgeMat(stree(10))

# should also work on trees with two taxa
testEdgeMat(rtree(2))

# should also work on trees with one taxon
testEdgeMat(stree(1))

#running cleanNewPhylo on this tree should have little effect
		#beyond ladderizing it...
tree1 &lt;- cleanNewPhylo(tree)

#compare outputs
layout(1:2)
plot(tree)
plot(tree1)
layout(1)
</code></pre>


</div>