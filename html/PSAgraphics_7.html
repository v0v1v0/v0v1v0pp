<div class="container">

<table style="width: 100%;"><tr>
<td>cat.psa</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>Compare balance graphically of a categorical covariate as part of a PSA</h2>

<h3>Description</h3>

<p>Given predefined strata and two level treatment for a categorical covariate
from a propensity score analysis, <code>cat.psa</code> draws pairs of side by side
barplots corresponding to control and treatment for each stratum.
</p>


<h3>Usage</h3>

<pre><code class="language-R">cat.psa(
  categorical,
  treatment = NULL,
  strata = NULL,
  catnames = NULL,
  catcol = "terrain.colors",
  width = 0.25,
  barlab = c("A", "B"),
  barnames = NULL,
  rtmar = 1.5,
  balance = FALSE,
  B = 1000,
  tbl = TRUE,
  cex.leg = 1,
  ...
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>categorical</code></td>
<td>
<p>Vector or N X 3 dataframe or matrix. If a vector, then
represents a categorical covariate that is being balanced within strata in a
PSA. If <code>categorical</code> has three columns, then the second and third are
assumed to be the <code>treatment</code> and <code>strata</code> respectively.  Missing
values are not allowed. May be factor or numeric.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>treatment</code></td>
<td>
<p>Binary vector or factor of same length as <code>continuous</code>
representing the two treatments.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>strata</code></td>
<td>
<p>A vector or factor of same length as <code>continuous</code>
indicating the derived strata from estimated propensity scores. Strata are
ordered lexicographically in plot.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>catnames</code></td>
<td>
<p>List of names in order of the categories; used in the plot
legend. Default is <code>1:n</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>catcol</code></td>
<td>
<p>List of colors used for the categories, default is
<code>terrain.colors</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>width</code></td>
<td>
<p>Controls width of bars, default = 0.25.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>barlab</code></td>
<td>
<p>Binary list of single <code>treatment</code> character labels for
the bars, default is <code>c("A", "B")</code>.  These are defined in a legend by
<code>barnames</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>barnames</code></td>
<td>
<p>Binary list of treatment names used in the legend; by
default names are taken from <code>treatment</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>rtmar</code></td>
<td>
<p>Numeric.  Governs size of right margin allocated for legend.
Default = 1.5</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>balance</code></td>
<td>
<p>Logical.  If <code>TRUE</code> a call is made to functions
<code>bal.cs.psa</code> and <code>bal.cws.psa</code>. The former provides a reference
histogram and ad hoc balance statistic, the second provides bootstrapped
p-values for the two-way table formed in each statum.  Default is
<code>FALSE</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>B</code></td>
<td>
<p>Numeric; passed to <code>bal.cs.psa</code> governing size of reference
histogram generated.  Default is 100.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>tbl</code></td>
<td>
<p>Logical; if <code>TRUE</code>, then a matrix of the proportions used in
the creation of the bargraph is returned.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>cex.leg</code></td>
<td>
<p>Numeric; value of <code>cex</code> (governing font size) passed to
legend.  Default = 1.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>...</code></td>
<td>
<p>Other graphical parameters passed to plot.</p>
</td>
</tr>
</table>
<h3>Details</h3>

<p>Pairs of bars are graphed side by side so that comparisons may be made
within each stratum and across strata.  If <code>balance</code> is <code>TRUE</code>,
then the histogram represents an ad hoc balance measure of the given strata
as compared to randomly generated strata.  The p-values provided on the
bargraph are bootstrapped in a standard fashion via randomly generated
treatment divisions within given strata.  For continuous covariates use
<code>box.psa</code>.
</p>


<h3>Value</h3>

<p>If <code>tbl</code> is <code>TRUE</code>, then a matrix is returned containing
the proportions of each category, and in each treatment level and stratum
that were used to draw the bargraph.
</p>


<h3>Author(s)</h3>

<p>James E. Helmreich <a href="mailto:James.Helmreich@Marist.edu">James.Helmreich@Marist.edu</a>
</p>
<p>Robert M. Pruzek <a href="mailto:RMPruzek@yahoo.com">RMPruzek@yahoo.com</a>
</p>


<h3>See Also</h3>

<p><code>bal.cs.psa</code>, <code>bal.cws.psa</code>, <code>box.psa</code>
</p>


<h3>Examples</h3>

<pre><code class="language-R">
categorical&lt;-sample(1:7,1000,replace=TRUE)
treatment&lt;-sample(c(0,1),1000,replace=TRUE)
strata&lt;-sample(5,1000,replace=TRUE)
cat.psa(categorical,treatment,strata)

data(lindner)
attach(lindner)
lindner.ps &lt;- glm(abcix ~ stent + height + female +
      diabetic + acutemi + ejecfrac + ves1proc,
      data = lindner, family = binomial)
ps&lt;-lindner.ps$fitted
lindner.s5 &lt;- as.numeric(cut(ps, quantile(ps, seq(0, 1, 1/5)),
      include.lowest = TRUE, labels = FALSE))
cat.psa(stent, abcix, lindner.s5, xlab = "stent")

lindner.s10 &lt;- as.numeric(cut(ps, quantile(ps, seq(0, 1, 1/10)),
      include.lowest = TRUE, labels = FALSE))
cat.psa(ves1proc,abcix, lindner.s10, balance = TRUE, xlab = "ves1proc")

#Using a rpart tree for strata
library(rpart)
lindner.rpart&lt;-rpart(abcix ~ stent + height + female + diabetic +
      acutemi + ejecfrac + ves1proc, data=lindner, method="class")
lindner.tree&lt;-factor(lindner.rpart$where, labels = 1:6)
cat.psa(stent, abcix, lindner.tree, xlab = "stent")
cat.psa(ves1proc, abcix, lindner.tree, xlab = "ves1proc")

</code></pre>


</div>