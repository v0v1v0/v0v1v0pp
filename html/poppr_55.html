<div class="container">

<table style="width: 100%;"><tr>
<td>filter_stats</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>Utilize all algorithms of mlg.filter</h2>

<h3>Description</h3>

<p>This function is a wrapper to mlg.filter. It will calculate all of the stats 
for mlg.filter utilizing all of the algorithms.
</p>


<h3>Usage</h3>

<pre><code class="language-R">filter_stats(
  x,
  distance = bitwise.dist,
  threshold = 1e+06 + .Machine$double.eps^0.5,
  stats = "All",
  missing = "ignore",
  plot = FALSE,
  cols = NULL,
  nclone = NULL,
  hist = "Scott",
  threads = 1L,
  ...
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>x</code></td>
<td>
<p>a <code>genind</code>, <code>genclone</code>,
<code>genlight</code>, or <code>snpclone</code> object</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>distance</code></td>
<td>
<p>a distance function or matrix</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>threshold</code></td>
<td>
<p>a threshold to be passed to <code>mlg.filter</code> 
(Default: 1e6)</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>stats</code></td>
<td>
<p>what statistics should be calculated.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>missing</code></td>
<td>
<p>how to treat missing data with mlg.filter</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>plot</code></td>
<td>
<p>If the threshold is a maximum threshold, should the statistics be
plotted (Figure 2)</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>cols</code></td>
<td>
<p>the colors to use for each algorithm (defaults to set1 of 
<span class="pkg">RColorBrewer</span>).</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>nclone</code></td>
<td>
<p>the number of multilocus genotypes you expect for the data. 
This will draw horizontal line on the graph at the value nclone and then 
vertical lines showing the cutoff thresholds for each algorithm.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>hist</code></td>
<td>
<p>if you want a histogram to be plotted behind the statistics, 
select a method here. Available methods are "sturges", "fd", or "scott" 
(default) as documented in <code>hist</code>. If you don't want 
to plot the histogram, set <code>hist = NULL</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>threads</code></td>
<td>
<p>(unused) Previously the number of threads to be used. As of
poppr version 2.4.1, this is by default set to 1.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>...</code></td>
<td>
<p>extra parameters passed on to the distance function.</p>
</td>
</tr>
</table>
<h3>Value</h3>

<p>a list of results from mlg.filter from the three
algorithms. (returns invisibly if <code>plot = TRUE</code>)
</p>


<h3>Note</h3>

<p>This function originally appeared in 
<a href="https://doi.org/10.5281/zenodo.17424">doi:10.5281/zenodo.17424</a>
</p>


<h3>Author(s)</h3>

<p>Zhian N. Kamvar, Jonah C. Brooks
</p>


<h3>References</h3>

<p>ZN Kamvar, JC Brooks, and NJ Grünwald. 2015. Supplementary 
Material for Frontiers Plant Genetics and Genomics 'Novel R tools for 
analysis of genome-wide population genetic data with emphasis on
clonality'. DOI:
<a href="https://doi.org/10.5281/zenodo.17424">doi:10.5281/zenodo.17424</a>
</p>
<p>Kamvar ZN, Brooks JC and Grünwald NJ (2015) Novel R tools for analysis of 
genome-wide population genetic data with emphasis on clonality. Front.
Genet. 6:208. doi: 
<a href="https://doi.org/10.3389/fgene.2015.00208">doi:10.3389/fgene.2015.00208</a>
</p>


<h3>See Also</h3>

<p><code>mlg.filter</code> <code>cutoff_predictor</code> 
<code>bitwise.dist</code> <code>diss.dist</code>
</p>


<h3>Examples</h3>

<pre><code class="language-R">
# Basic usage example: Bruvo's Distance --------------------------------
data(Pinf)
pinfreps &lt;- fix_replen(Pinf, c(2, 2, 6, 2, 2, 2, 2, 2, 3, 3, 2))
bres &lt;- filter_stats(Pinf, distance = bruvo.dist, replen = pinfreps, plot = TRUE, threads = 1L)
print(bres) # shows all of the statistics

# Use these results with cutoff_filter()
print(thresh &lt;- cutoff_predictor(bres$farthest$THRESHOLDS))
mlg.filter(Pinf, distance = bruvo.dist, replen = pinfreps) &lt;- thresh
Pinf 

# Different distances will give different results -----------------------
nres &lt;- filter_stats(Pinf, distance = nei.dist, plot = TRUE, threads = 1L, missing = "mean")
print(thresh &lt;- cutoff_predictor(nres$farthest$THRESHOLDS))
mlg.filter(Pinf, distance = nei.dist, missing = "mean") &lt;- thresh
Pinf 
</code></pre>


</div>