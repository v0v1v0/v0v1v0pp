<div class="container">

<table style="width: 100%;"><tr>
<td>dpmd</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>Probability Mass Function of Poisson-Multinomial Distribution</h2>

<h3>Description</h3>

<p>Computes the pmf of Poisson-Multinomial distribution (PMD), 
specified by the success probability matrix, using various methods. This function 
is capable of computing all probability mass points as well as
of pmf at certain point(s).
</p>


<h3>Usage</h3>

<pre><code class="language-R">dpmd(pmat, xmat = NULL, method = "DFT-CF", B = 1000)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>pmat</code></td>
<td>
<p>An <code class="reqn">\rm n \times m</code> success probability matrix. Here, <code class="reqn">\rm n</code> is the number of independent trials, and
<code class="reqn">\rm m</code> is the number of categories.
Each row of pmat describes the success probability for the corresponding
trial and it should add up to 1.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>xmat</code></td>
<td>
<p>A matrix with <code class="reqn">\rm m</code> columns that specifies where the pmf is to be computed. Each row of the matrix should has the form
<code class="reqn">\rm x = (x_{1}, \ldots, x_{m})</code> which is used for computing 
<code class="reqn">\rm P(X_{1}=x_{1}, \ldots, X_{m} = x_{m})</code>, the values of <code class="reqn">\rm x</code> should sum up to <code class="reqn">\rm n</code>. It can be a vector of length <code class="reqn">\rm m</code>. If <code>xmat</code> is <code>NULL</code>, the pmf at all probability mass points will be computed.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>method</code></td>
<td>
<p>Character string stands for the method selected by users to 
compute the cdf. The method can only be one of 
the following three: 
<code>"DFT-CF"</code>,
<code>"NA"</code>,
<code>"SIM"</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>B</code></td>
<td>
<p>Number of repeats used in the simulation method. It is ignored for methods other than
the <code>"SIM"</code> method.</p>
</td>
</tr>
</table>
<h3>Details</h3>

<p>Consider <code class="reqn">\rm n</code> independent trials and each trial leads to a success outcome for exactly one of the <code class="reqn">\rm m</code> categories. 
Each category has varying success probabilities from different trials. The Poisson multinomial distribution (PMD) gives the probability 
of any particular combination of numbers of successes for the <code class="reqn">\rm m</code> categories. 
The success probabilities form an <code class="reqn">\rm n \times m</code> matrix, which is called the success probability matrix and denoted by <code>pmat</code>.  
For the methods we applied in <code>dpmd</code>, <code>"DFT-CF"</code> is an exact method that computes all probability mass points of the distribution,
using multi-dimensional FFT algorithm. When the dimension of <code>pmat</code> increases, the computation burden of <code>"DFT-CF"</code> may challenge the capability 
of a computer because the method automatically computes all probability mass points regardless of the input of <code>xmat</code>.
</p>
<p><code>"SIM"</code> is a simulation method that generates random samples from the distribution, and uses relative frequency to estimate the pmf. Note that the accuracy and running time will be affected by user choice of <code>B</code>. 
Usually <code>B</code>=1e5 or 1e6 will be accurate enough. Increasing <code>B</code> to larger than 1e8 will heavily increase the
computational burden of the computer. 
</p>
<p><code>"NA"</code> is an approximation method that uses a multivariate normal distribution to approximate 
the pmf at the points specified in <code>xmat</code>. This method requires an input of <code>xmat</code>.
</p>
<p>Notice if <code>xmat</code> is not specified then it will be set as <code>NULL</code>. In this case, <code>dpmd</code> will 
compute the entire pmf if the chosen method is <code>"DFT-CF"</code> or <code>"SIM"</code>. 
If <code>xmat</code> is provided, only the pmf at the points specified 
by <code>xmat</code> will be outputted.
</p>


<h3>Value</h3>

<p>For a given <code>xmat</code>, <code>dpmd</code> returns the pmf at points specified by <code>xmat</code>. 
</p>
<p>If <code>xmat</code> is <code>NULL</code>, all probability mass points for the distribution specified by the success probability matrix <code>pmat</code> will be computed, and the results are
stored and outputted in a multi-dimensional array, denoted by <code>res</code>. Note the dimension of 
<code>pmat</code> is <code class="reqn">\rm n \times m</code>, thus <code>res</code> will be an <code class="reqn">\rm (n+1)^{(m-1)}</code> array. Then 
the value of the pmf <code class="reqn">\rm P(X_{1}=x_{1}, \ldots, X_{m} = x_{m})</code> can be extracted as <code class="reqn">\rm res[x_{1}+1, \ldots, x_{m-1}+1]</code>.
</p>
<p>For example, for the <code>pmat</code> matrix in the example section, the array element <code>res[1,2,1]=0.90</code> gives 
the value of the pmf <code class="reqn">\rm P(X_{1}=0, X_{2}=1, X_{3}=0, X_{4}=2)=0.90</code>.
</p>


<h3>References</h3>

<p>Lin, Z., Wang, Y., and Hong, Y. (2023). The computing of the Poisson multinomial distribution and applications in ecological inference and machine learning, Computational Statistics, Vol. 38, pp. 1851-1877.
</p>


<h3>Examples</h3>

<pre><code class="language-R">pp &lt;- matrix(c(.1, .1, .1, .7, .1, .3, .3, .3, .5, .2, .1, .2), nrow = 3, byrow = TRUE)
x &lt;- c(0,0,1,2) 
x1 &lt;- matrix(c(0,0,1,2,2,1,0,0),nrow=2,byrow=TRUE)

dpmd(pmat = pp)
dpmd(pmat = pp, xmat = x1)
dpmd(pmat = pp, xmat = x)

dpmd(pmat = pp, xmat = x, method = "NA" )
dpmd(pmat = pp, xmat = x1, method = "NA" )

dpmd(pmat = pp, method = "SIM", B = 1e3)
dpmd(pmat = pp, xmat = x, method = "SIM", B = 1e3)
dpmd(pmat = pp, xmat = x1, method = "SIM", B = 1e3)

</code></pre>


</div>