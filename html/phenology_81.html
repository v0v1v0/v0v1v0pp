<div class="container">

<table style="width: 100%;"><tr>
<td>Tagloss_mcmc</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>Bayesian model of tag loss using a CMR database.</h2>

<h3>Description</h3>

<p>This function fits a model of tag loss using a CMR database using Bayesian mcmc.<br>
The parameters must be stored in a data.frame with named rows for each parameter with the following columns:<br></p>

<ul>
<li>
<p> Density. The density function name, example <code>dnorm</code>, <code>dlnorm</code>, <code>dunif</code>
</p>
</li>
<li>
<p> Prior1. The first parameter to send to the <code>Density</code> function
</p>
</li>
<li>
<p> Prior2. The second parameter to send to the <code>Density</code> function
</p>
</li>
<li>
<p> SDProp. The standard error from new proposition value of this parameter
</p>
</li>
<li>
<p> Min. The minimum value for this parameter
</p>
</li>
<li>
<p> Max. The maximum value for this parameter
</p>
</li>
<li>
<p> Init. The initial value for this parameter
</p>
</li>
</ul>
<h3>Usage</h3>

<pre><code class="language-R">Tagloss_mcmc(
  data = stop("A database formated using Tagloss_format() must be used"),
  parameters = stop("Priors must be supplied"),
  fixed.parameters = NULL,
  model_before = NULL,
  model_after = NULL,
  mc.cores = detectCores(all.tests = FALSE, logical = TRUE),
  groups = detectCores(all.tests = FALSE, logical = TRUE),
  n.iter = 10000,
  n.chains = 1,
  n.adapt = 100,
  thin = 30,
  trace = FALSE,
  traceML = FALSE,
  adaptive = FALSE,
  adaptive.lag = 500,
  adaptive.fun = function(x) {
     ifelse(x &gt; 0.234, 1.3, 0.7)
 },
  intermediate = NULL,
  filename = "intermediate.Rdata",
  previous = NULL
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>data</code></td>
<td>
<p>An object formated using Tagloss_format</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>parameters</code></td>
<td>
<p>A data.frame with priors; see description and examples</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>fixed.parameters</code></td>
<td>
<p>Set of fixed parameters</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>model_before</code></td>
<td>
<p>Transformation of parameters before to use Tagloss_model()</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>model_after</code></td>
<td>
<p>Transformation of parameters after to use Tagloss_model()</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>mc.cores</code></td>
<td>
<p>Number of cores to use for parallel computing</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>groups</code></td>
<td>
<p>Number of groups for parallel computing</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>n.iter</code></td>
<td>
<p>Number of iterations for each chain</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>n.chains</code></td>
<td>
<p>Number of chains</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>n.adapt</code></td>
<td>
<p>Number of iteration to stabilize likelihood</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>thin</code></td>
<td>
<p>Interval for thinning Markov chain</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>trace</code></td>
<td>
<p>Or FALSE or period to show progress</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>traceML</code></td>
<td>
<p>TRUE or FALSE to show ML</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>adaptive</code></td>
<td>
<p>Should an adaptive process for SDProp be used</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>adaptive.lag</code></td>
<td>
<p>Lag to analyze the SDProp value in an adaptive context</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>adaptive.fun</code></td>
<td>
<p>Function used to change the SDProp</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>intermediate</code></td>
<td>
<p>Or NULL of period to save intermediate result</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>filename</code></td>
<td>
<p>Name of file in which intermediate results are saved</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>previous</code></td>
<td>
<p>The content of the file in which intermediate results are saved</p>
</td>
</tr>
</table>
<h3>Details</h3>

<p>Tagloss_mcmc Bayesian model of tag loss using a CMR database.
</p>


<h3>Value</h3>

<p>Return a list object with the Bayesian model describing tag loss.
</p>


<h3>Author(s)</h3>

<p>Marc Girondot
</p>


<h3>See Also</h3>

<p>Other Model of Tag-loss: 
<code>Tagloss_L()</code>,
<code>Tagloss_LengthObs()</code>,
<code>Tagloss_cumul()</code>,
<code>Tagloss_daymax()</code>,
<code>Tagloss_fit()</code>,
<code>Tagloss_format()</code>,
<code>Tagloss_mcmc_p()</code>,
<code>Tagloss_model()</code>,
<code>Tagloss_simulate()</code>,
<code>logLik.Tagloss()</code>,
<code>o_4p_p1p2</code>,
<code>plot.Tagloss()</code>,
<code>plot.TaglossData()</code>
</p>


<h3>Examples</h3>

<pre><code class="language-R">## Not run: 
library(phenology)
# Example
data_f_21 &lt;- Tagloss_format(outLR, model="21")

# model fitted by Rivalan et al. 2005
par &lt;- c(a0_2=-5.43E-2, a1_2=-103.52, a4_2=5.62E-4, 
         delta_1=3.2E-4)
pfixed &lt;- c(a2_2=0, a3_2=0, a2_1=0, a3_1=0)
model_before &lt;- "par['a0_1']=par['a0_2'];par['a1_1']=par['a1_2'];par['a4_1']=par['a4_2']"
o &lt;- Tagloss_fit(data=data_f_21, fitted.parameters=par, fixed.parameters=pfixed, 
                 model_before=model_before)
pMCMC &lt;- Tagloss_mcmc_p(o, accept=TRUE)
o_MCMC &lt;- Tagloss_mcmc(data=data_f_21, parameters=pMCMC, fixed.parameters=pfixed, 
                 model_before=model_before, 
                 n.iter=10000, n.chains = 1, n.adapt = 100, thin=30)

## End(Not run)
</code></pre>


</div>