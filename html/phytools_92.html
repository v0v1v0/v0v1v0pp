<div class="container">

<table style="width: 100%;"><tr>
<td>estDiversity</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>Estimate diversity at each node of the tree</h2>

<h3>Description</h3>

<p>Estimates the lineage density at each node in the tree based on a biogeographic model (similar to Mahler et al. 2010).
</p>


<h3>Usage</h3>

<pre><code class="language-R">estDiversity(tree, x, method=c("asr","simulation"), model="ER", ...)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>tree</code></td>
<td>
<p>is a phylogenetic tree in <code>"phylo"</code> format.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>x</code></td>
<td>
<p>a vector containing the biogeographic area for each of the tip taxa.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>method</code></td>
<td>
<p>method for reconstructing ancestral biogeography.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>model</code></td>
<td>
<p>model for ancestral character estimation. In theory, any model from <code>ace</code>; however only symmetric models permitted for <code>method="asr"</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>...</code></td>
<td>
<p>optional arguments. So far, this includes only <code>nsim</code>, the number of stochastic mappings to conduct using <code>make.simmap</code> for <code>method="simulation"</code>.</p>
</td>
</tr>
</table>
<h3>Details</h3>

<p>Two different methods are implemented in the current version.
</p>
<p>For <code>method="asr"</code> the state at the current node, and at each position along each co-extant internal edge, is computed as the marginal (empirical Bayesian) ancestral state reconstruction using the re-rooting method of Yang (2006). The lineage density is then computed as the sum of the marginal reconstructions (posterior probabilities) times the summed marginal ancestral reconstructions across co-extant edges. 
</p>
<p>For <code>method="simulation"</code>, stochastic character mapping is used to generate optional argument <code>nsim</code> stochastic maps of ancestral biogeography. Then the lineage density at each node is computed as the number of co-existing lineages with the same biogeography as the focal node, averaged across stochastic maps.
</p>
<p>The importance of this distinction may depend on the degree to which reconstructions at internal nodes are independent, which relates to the distinction between marginal and joint reconstruction (e.g., see Yang 2006).
</p>


<h3>Value</h3>

<p>A vector containing the estimated lineage density at each node
</p>


<h3>Author(s)</h3>

<p>Liam Revell <a href="mailto:liam.revell@umb.edu">liam.revell@umb.edu</a></p>


<h3>References</h3>

<p>Mahler, D. L, L. J. Revell, R. E. Glor, and J. B. Losos. (2010) Ecological opportunity and the rate of morphological evolution in the diversification of Greater Antillean anoles. <em>Evolution</em>, <b>64</b>, 2731-2745.
</p>
<p>Revell, L. J. (2024) phytools 2.0: an updated R ecosystem for phylogenetic comparative methods (and other things). <em>PeerJ</em>, <b>12</b>, e16505.
</p>
<p>Yang, Z. (2006) <em>Computational Molecular Evolution</em>. Oxford University Press.
</p>


<h3>See Also</h3>

<p><code>fitDiversityModel</code>
</p>


</div>