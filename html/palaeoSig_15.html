<div class="container">

<table style="width: 100%;"><tr>
<td>jointsig</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>Test if two variables jointly control changes in fossil data</h2>

<h3>Description</h3>

<p>Generates synthetic variables with different proportion of two
environmental variables, and tests how much variance in the fossil data
reconstructions of these synthetic variables explain.
</p>


<h3>Usage</h3>

<pre><code class="language-R">jointsig(spp, fos, var1, var2, method = "randomTF", n = 99, r = 32, ...)

## S3 method for class 'js'
plot(x, names.v1, names.v2, ...)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>spp</code></td>
<td>
<p>Data frame of modern training set species data, transformed as
required, for example with sqrt</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>fos</code></td>
<td>
<p>Data frame of fossil species data, with same species codes and
transformations as spp</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>var1</code></td>
<td>
<p>Training set environmental variable 1</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>var2</code></td>
<td>
<p>Training set environmental variable 2</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>method</code></td>
<td>
<p>Which significance test to use.
Current option are randomTF and obs.cor.
The latter may give strange results - use with caution.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>n</code></td>
<td>
<p>number of random training sets used to generate the null model</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>r</code></td>
<td>
<p>How many synthetic variables to make. More is better but slower</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>...</code></td>
<td>
<p>Other arguments to plot</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>x</code></td>
<td>
<p>Output from jointsig</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>names.v1</code></td>
<td>
<p>Vector length 2 with names of the end members of the first
environmental variable, e.g., c("cold", "warm") for temperature.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>names.v2</code></td>
<td>
<p>Ditto for the second variable.</p>
</td>
</tr>
</table>
<h3>Details</h3>

<p>With <code>method="randomTF"</code>, the function calculates the proportion of
variance in the fossil data explained by transfer function reconstructions of
synthetic variables.
The synthetic variables are composed of two environmental variables, weighted
between -1 and +1, so to represent a circle.
This is compared with a null distribution of the proportion of variance
explained by reconstructions based on random environmental variables.
Any transfer function in the rioja library can be used.
With method="obs.cor", the aim is the same, but the function reports the
correlation between the species weighted average optima on the synthetic
variables and the species first axis scores.
This option has some pathological behaviour and should probably be avoided.
</p>


<h3>Value</h3>

<p>A list with components
</p>

<ul>
<li>
<p>PCA The unconstrained ordination of the fossil data.
</p>
</li>
<li>
<p>preds A list of the containing the reconstructions for each
environmental variable.
</p>
</li>
<li>
<p>MAX Proportion of the variance explained by the first axis of the
unconstrained ordination. This is the maximum amount that a reconstruction
of a single variable can explain.
</p>
</li>
<li>
<p>EX The proportion of the variance in the fossil data explained by
each reconstruction.
</p>
</li>
<li>
<p>sim.ex The proportion of variance explained by each of the random
environmental variables.
</p>
</li>
<li>
<p>sig The p-value of each reconstruction.
</p>
</li>
</ul>
<h3>Functions</h3>


<ul><li> <p><code>plot(js)</code>: Plot js object
</p>
</li></ul>
<h3>Author(s)</h3>

<p>Richard Telford <a href="mailto:richard.telford@bio.uib.no">richard.telford@bio.uib.no</a>
</p>


<h3>References</h3>

<p>Unpublished method - use with caution. Can give spurious results
with weighted averaging.
</p>


<h3>See Also</h3>

<p><code>randomTF</code>,<code>obs.cor</code>
</p>


<h3>Examples</h3>

<pre><code class="language-R">require(rioja)
data(SWAP)
data(RLGH)

rlgh.js &lt;- jointsig(
  spp = sqrt(SWAP$spec),
  fos = sqrt(RLGH$spec),
  var1 = SWAP$pH,
  var2 = sample(SWAP$pH),
  method = "randomTF",
  n = 49, r = 32, fun = WA, col = 1
)
# nonsense second variable

plot(rlgh.js, c("acid", "alkaline"), c("down", "up"))
</code></pre>


</div>