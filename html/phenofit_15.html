<div class="container">

<table style="width: 100%;"><tr>
<td>curvefit</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>Fine curve fitting</h2>

<h3>Description</h3>

<p>Curve fit vegetation index (VI) time-series of every growing season using
fine curve fitting methods.
</p>


<h3>Usage</h3>

<pre><code class="language-R">curvefit(
  y,
  t = index(y),
  tout = t,
  methods = c("AG", "Beck", "Elmore", "Gu", "Klos", "Zhang"),
  w = NULL,
  ...,
  type = 1L,
  use.cpp = FALSE
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>y</code></td>
<td>
<p>Vegetation time-series index, numeric vector</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>t</code></td>
<td>
<p>The corresponding doy of x</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>tout</code></td>
<td>
<p>The output interpolated time.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>methods</code></td>
<td>
<p>Fine curve fitting methods, can be one or more of <code>c('AG', 'Beck', 'Elmore', 'Gu', 'Klos', 'Zhang')</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>w</code></td>
<td>
<p>(optional) Numeric vector, weights of <code>y</code>. If not specified,
weights of all <code>NA</code> values will be <code>wmin</code>, the others will be 1.0.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>...</code></td>
<td>
<p>other parameters passed to curve fitting function.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>type</code></td>
<td>
<p>integer, <code>1</code> or <code>-1</code>
</p>

<ul>
<li> <p><code>1</code>: trough-to-trough curve fitting
</p>
</li>
<li> <p><code>-1</code>: peak-to-peak curve fitting
</p>
</li>
</ul>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>use.cpp</code></td>
<td>
<p>(unstable, not used) boolean, whether to use c++ defined fine
fitting function? If <code>FALSE</code>, R version will be used.</p>
</td>
</tr>
</table>
<h3>Value</h3>

<p>fFITs S3 object, see <code>fFITs()</code> for details.
</p>


<h3>Note</h3>

<p>'Klos' have too many parameters. It will be slow and not stable.
</p>


<h3>See Also</h3>

<p><code>fFITs()</code>
</p>


<h3>Examples</h3>

<pre><code class="language-R">library(phenofit)
# simulate vegetation time-series
FUN = doubleLog.Beck
par = c(mn  = 0.1, mx  = 0.7, sos = 50, rsp = 0.1, eos = 250, rau = 0.1)
t    &lt;- seq(1, 365, 8)
tout &lt;- seq(1, 365, 1)
y &lt;- FUN(par, t)

methods &lt;- c("AG", "Beck", "Elmore", "Gu", "Zhang") # "Klos" too slow
fit &lt;- curvefit(y, t, tout = tout, methods)
</code></pre>


</div>