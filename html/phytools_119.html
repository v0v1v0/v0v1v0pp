<div class="container">

<table style="width: 100%;"><tr>
<td>fitPagel</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>Function to test for correlated evolution of binary traits</h2>

<h3>Description</h3>

<p>Fits Pagel's (1994) model for the correlated evolution of two binary characters.
</p>


<h3>Usage</h3>

<pre><code class="language-R">fitPagel(tree, x, y, method="fitMk", model="ARD", dep.var="xy", ...)
## S3 method for class 'fitPagel'
plot(x, ...)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>tree</code></td>
<td>
<p>an object of class <code>"phylo"</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>x</code></td>
<td>
<p>a vector of phenotypic values for a binary trait for the species in <code>tree</code>; or a matrix in which the rows of <code>x</code> give the probability of being in each column state. (The latter option is only supported for <code>method="fitMk"</code>.) For S3 <code>plot</code> method, an object of class <code>"fitPagel"</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>y</code></td>
<td>
<p>a second binary character for the species in <code>tree</code>; or a matrix in which the rows give the probability of being in each column state.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>method</code></td>
<td>
<p>function to use for optimization (defaults to <code>method="fitMk"</code>). Other options are <code>"ace"</code> to use the <code>ace</code> function in <span class="pkg">ape</span> for optimization, or to <code>"fitDiscrete"</code> (if the <span class="pkg">geiger</span> package is installed) to use <span class="pkg">geiger</span>'s <code>fitDiscrete</code> for optimization.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>model</code></td>
<td>
<p>model of evolution for the individual characters. Can be <code>model="ER"</code>, <code>"SYM"</code> (equivalent to <code>"ER"</code> in this case),
and <code>"ARD"</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>dep.var</code></td>
<td>
<p>dependent variable. If <code>dep.var="xy"</code> than the rate of substitution in <code>x</code> depends on <code>y</code> &amp; vice versa. If <code>dep.var="x"</code> than the substitution rate in <code>x</code> depends on <code>y</code>, but not the converse. Finally, if <code>dep.var="y"</code> than the rate of substitution in <code>y</code> depends on <code>x</code>, but not the converse.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>...</code></td>
<td>
<p>optional arguments to be passed to <code>fitMk</code>, <code>ace</code>, or <code>fitDiscrete</code>. For <code>plot</code> method optional arguments include (but may not be limited to): <code>signif</code>, the number of digits for the rates to be plotted; <code>main</code>, a character vector of length two with the headings for each subplot; <code>cex.main</code>, <code>cex.sub</code>, <code>cex.traits</code>, and <code>cex.rates</code>, font sizes for the various text elements of the plot; and <code>lwd.by.rate</code>, a logical argument specifying whether or not to scale arrow line widths in proportion to the estimated rates.</p>
</td>
</tr>
</table>
<h3>Details</h3>

<p><code>fitPagel</code> fits both an independent evolution model, as well as Pagel's (1994) binary dependent model, and compares them with a likelihood-ratio test.
</p>
<p><code>plot.fitPagel</code> plots the fitted models using arrows.
</p>


<h3>Value</h3>

<p>An object of class <code>"fitPagel"</code> which contains the optimized matrices under an independence &amp; a dependence model, log-likelihoods, a likelihood ratio, and a P-value for the independence model based on a chi-squared test.
</p>
<p><code>plot.fitPagel</code> creates a plot showing the different fitted models with arrows.
</p>


<h3>Author(s)</h3>

<p>Liam Revell <a href="mailto:liam.revell@umb.edu">liam.revell@umb.edu</a></p>


<h3>References</h3>

<p>Pagel, M. (1994) Detecting correlated evolution on phylogenies: A general method for the comparative analysis of discrete characters. <em>Proceedings of the Royal Society B</em>, <b>255</b>, 37-45.
</p>
<p>Revell, L. J. (2024) phytools 2.0: an updated R ecosystem for phylogenetic comparative methods (and other things). <em>PeerJ</em>, <b>12</b>, e16505.
</p>


<h3>See Also</h3>

<p><code>ace</code>, <code>fitMk</code>, <code>make.simmap</code>
</p>


<h3>Examples</h3>

<pre><code class="language-R">## Not run: 
## load data
data(bonyfish.tree)
data(bonyfish.data)
## extract discrete characters
spawning_mode&lt;-setNames(bonyfish.data$spawning_mode,
    rownames(bonyfish.data))
paternal_care&lt;-setNames(bonyfish.data$paternal_care,
    rownames(bonyfish.data))
## fit correlational model
bonyfish.pagel&lt;-fitPagel(bonyfish.tree,paternal_care,
    spawning_mode)
## test for a difference between models
anova(bonyfish.pagel)
## plot fitted models
plot(bonyfish.pagel,lwd.by.rate=TRUE)
## reset par
par(mar=c(5.1,4.1,4.1,2.1),
    mfrow=c(1,1))
## End(Not run)
</code></pre>


</div>