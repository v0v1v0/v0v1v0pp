<div class="container">

<table style="width: 100%;"><tr>
<td>assignClones</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>
Group Individuals Based on a Distance Threshold
</h2>

<h3>Description</h3>

<p><code>assignClones</code> uses a distance matrix such as that produced by
<code>meandistance.matrix</code> or <code>meandistance.matrix2</code>
to place individuals into groups representing asexually-related ramets,
or any other grouping based on a distance threshold.
</p>


<h3>Usage</h3>

<pre><code class="language-R">assignClones(d, samples = dimnames(d)[[1]], threshold = 0)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>d</code></td>
<td>

<p>A symmetrical, square matrix containing genetic distances between
individuals.  Both dimensions should be named according to the names
of the individuals (samples).  A matrix produced by
<code>meandistance.matrix</code> or <code>meandistance.matrix2</code> when
<code>all.distances = FALSE</code>, or the matrix that is the second item in
the list produced if <code>all.distances = TRUE</code>, will be in the right
format. <code>meandist.from.array</code> will also produce a matrix
in the correct format.
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>samples</code></td>
<td>

<p>A character vector containing the names of samples to analyze.  This
should be all or a subset of the names of <code>d</code>.
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>threshold</code></td>
<td>

<p>A number indicating the maximum distance between two individuals that
will be placed into the same group.
</p>
</td>
</tr>
</table>
<h3>Details</h3>

<p>This function groups individuals very similarly to the software GenoType
(Meirmans and van Tienderen, 2004).  If a distance matrix from
<span class="pkg">polysat</span> is exported to GenoType, the results will be the same as
those from <code>assignClones</code> assuming the same threshold is used.  Note
that GenoType requires that
distances be integers rather than decimals, so you will have to
multiply the distances produced by <span class="pkg">polysat</span> by a large number and
round them to the nearest integer if you wish to export them to GenoType.
When comparing the
results of <code>assignClones</code> and GenoType using my own data, the only
differences I have seen have been the result of rounding; a decimal that
was slightly above the threshold in when analyzed in R was rounded down
to the threshold when analyzed in GenoType.
</p>
<p>Note that when using a distance threshold of zero (the default), it is
advisable to exclude all samples with missing data, in order to prevent
the merging of non-identical clones.  At higher thresholds, some missing
data are allowable, but samples that have missing data at many loci should
be excluded.
</p>
<p>The <code>write.table</code> function can be used for exporting the results to
GenoDive.  See the R documentation for information on how to
make a tab-delimited file with no header.
</p>


<h3>Value</h3>

<p>A numeric vector, named by <code>samples</code>.  Each clone or group is given
a number, and the number for each sample indicates the clone or group
to which it belongs.
</p>


<h3>Author(s)</h3>

<p>Lindsay V. Clark
</p>


<h3>References</h3>

<p>Meirmans, P. G. and Van Tienderen, P. H. (2004) GENOTYPE and GENODIVE:
two programs for the analysis of genetic diversity of asexual
organisms. <em>Molecular Ecology Notes</em> <b>4</b>, 792â€“794.
</p>


<h3>See Also</h3>

<p><code>genotypeDiversity</code>
</p>


<h3>Examples</h3>

<pre><code class="language-R"># set up a simple matrix with three samples
test &lt;- matrix(c(0,0,.5,0,0,.5,.5,.5,0), ncol=3, nrow=3)
abc &lt;- c("a", "b", "c")
dimnames(test) &lt;- list(abc,abc)

# assign clones with a threshold of zero or 0.5
assignClones(test)
assignClones(test, threshold=0.5)
</code></pre>


</div>