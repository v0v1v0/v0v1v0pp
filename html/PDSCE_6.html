<div class="container">

<table style="width: 100%;"><tr>
<td>pdsoft.cv</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>
Tuning parameter selection and computation for the positive definite and sparse covariance matrix estimator
</h2>

<h3>Description</h3>

<p>Computes and selects the tuning parameter for
the sparse and positive definite covariance matrix estimator proposed by Rothman (2012).
</p>


<h3>Usage</h3>

<pre><code class="language-R">pdsoft.cv(x, lam.vec = NULL, standard = TRUE, 
          init = c("diag", "soft", "dense"), tau = 1e-04, 
          nsplits = 10, n.tr = NULL, tolin = 1e-08, tolout = 1e-08, 
          maxitin = 10000, maxitout = 1000, quiet = TRUE)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>x</code></td>
<td>

<p>A data matrix with <code class="reqn">n</code> rows and <code class="reqn">p</code> columns. The rows are assumed to be a realization of <code class="reqn">n</code>
independent copies of a <code class="reqn">p</code>-variate random vector. 
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>lam.vec</code></td>
<td>

<p>An optional vector of candidate lasso-type penalty tuning parameter values.  
The default for <code>standard=TRUE</code> is <code>seq(from=0, to=1, by=0.05)</code>
and the default for <code>standard=FALSE</code> is <code>seq(from=0, to=m, length.out=20)</code>, 
where <code>m</code> is the maximum magnitude of the off-diagonal entries in <code>s</code>.  Both of these default choices
are far from excellent and are time consuming, particularly for values close to zero.  
The user should consider refining this set by increasing its resolution in a narrower range.
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>standard</code></td>
<td>

<p>Logical: <code>standard=TRUE</code> first computes the observed sample correlation matrix from <code>s</code>, then 
computes the sparse correlation matrix estimate, and finally rescales to return the sparse covariance
matrix estimate.  The strongly recommended default is <code>standard=TRUE</code>.
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>init</code></td>
<td>

<p>The type of initialization used for the estimate computed at the maximum element in <code>lam.vec</code>. Subsequent
initializations use the final iterates for <code>sigma</code> and <code>omega</code> at the previous value in <code>lam.vec</code>.  
The default option <code>init="diag"</code> uses 
diagonal starting values.  The second option
<code>init="soft"</code> uses a positive definite version of the soft thresholded 
covariance or correlation estimate, depending on <code>standard</code>.  The third option <code>init="dense"</code>
uses the closed-form solution when <code>lam=0</code>.
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>tau</code></td>
<td>

<p>The logarithmic barrier parameter.  The default is <code>tau=1e-4</code>, which works well when <code>standard=TRUE</code>
with the default choices for the convergence tolerances.  
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>nsplits</code></td>
<td>

<p>The number of random splits to use for the tuning parameter selection.
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>n.tr</code></td>
<td>

<p>Optional number of cases to use in the training set. The default is the nearest 
integer to <code class="reqn">n(1-1/\log(n))</code>.  The value must be in <code class="reqn">\{3, \ldots, n-2\}</code>.
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>tolin</code></td>
<td>

<p>Convergence tolerance for the inner loop of the algorithm that solves the lasso regression.
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>tolout</code></td>
<td>

<p>Convergence tolerance for the outer loop of the algorithm.
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>maxitin</code></td>
<td>

<p>Maximum number of inner-loop iterations allowed
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>maxitout</code></td>
<td>

<p>Maximum number of outer-loop iterations allowed
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>quiet</code></td>
<td>

<p>Logical: <code>quiet=TRUE</code> suppresses the printing of progress updates.
</p>
</td>
</tr>
</table>
<h3>Details</h3>

<p>See Rothman (2012) for the objective function and more information.
</p>


<h3>Value</h3>

<p>A list with
</p>
<table>
<tr style="vertical-align: top;">
<td><code>sigma</code></td>
<td>
<p>covariance estimate at the selected tuning parameter</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>omega</code></td>
<td>
<p>inverse covariance estimate at the selected tuning parameter</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>best.lam</code></td>
<td>
<p>the selected value of the tuning parameter</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>cv.err</code></td>
<td>
<p>a vector of the validation errors, one for each element in <code>lam.vec</code></p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>lam.vec</code></td>
<td>
<p>the vector of candidate tuning parameter values</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>n.tr</code></td>
<td>
<p>the number of cases used for the training set</p>
</td>
</tr>
</table>
<h3>Note</h3>

<p>It is always the case that <code>omega</code> is positive definite.  If <code>tolin</code> and <code>tolout</code> are too large, 
or <code>maxitin</code> and <code>maxitout</code> are too small, then <code>sigma</code> may be indefinite.
</p>


<h3>Author(s)</h3>

<p>Adam J. Rothman
</p>


<h3>References</h3>

<p>Rothman, A. J. (2012).  Positive definite estimators of large covariance matrices. Biometrika 99(3): 733-740
</p>


<h3>See Also</h3>

<p><code>pdsoft</code>
</p>


<h3>Examples</h3>

<pre><code class="language-R">set.seed(1)
n=50
p=20
true.cov=diag(p)
true.cov[cbind(1:(p-1), 2:p)]=0.4
true.cov[cbind(2:p, 1:(p-1))]=0.4
eo=eigen(true.cov, symmetric=TRUE)
z=matrix(rnorm(n*p), nrow=n, ncol=p)
x=z%*% tcrossprod(eo$vec*rep(eo$val^(0.5), each=p),eo$vec)
output=pdsoft.cv(x=x)
plot(output$lam.vec, output$cv.err)
output$best.lam
output$sigma
</code></pre>


</div>