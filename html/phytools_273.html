<div class="container">

<table style="width: 100%;"><tr>
<td>ratebytree</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>Likelihood test for rate variation among trees, clades, or traits</h2>

<h3>Description</h3>

<p>Multiple methods for comparing the rate or process of evolution between trees.
</p>


<h3>Usage</h3>

<pre><code class="language-R">ratebytree(trees, x, ...)
## S3 method for class 'ratebytree'
posthoc(x, ...)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>trees</code></td>
<td>
<p>an object of class <code>"multiPhylo"</code>. If <code>x</code> consists of a list of different traits to be compared, then <code>trees</code> could also be a simple set of duplicates of the same tree, e.g., <code>rep(tree,length(x))</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>x</code></td>
<td>
<p>a list of trait vectors for a continuous trait in which the names of each vectors correspond to the tip labels of <code>trees</code>. This is not used if <code>type="diversification"</code>. In the case of <code>posthoc.ratebytree</code>, an object of class <code>"ratebytree"</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>...</code></td>
<td>
<p>optional arguments, including the argument <code>type</code> (<code>"continuous"</code>, <code>"discrete"</code>, or <code>"diversification"</code>), which, if not specified, the function will attempt to ascertain. See <code>Details</code> for more information.</p>
</td>
</tr>
</table>
<h3>Details</h3>

<p>This function essentially implements three different methods for comparing the rate or process of evolution between trees: one for continuously-valued traits, a second for discrete characters, and a third for the rate of diversification (speciation &amp; extinction).
</p>
<p>In all cases, the function takes an object of class <code>"multiPhylo"</code> containing two or more phylogenies (<code>trees</code>), and (for the first two analyses) a list of trait vectors (<code>x</code>).
</p>
<p>For continuous traits, the function then proceeds to fit two models: one in which the rate (or regime, for models <code>"OU"</code> and <code>"EB"</code>) of trait evolution is equal among all trees; and a second in which the rates or regimes can differ between trees.
</p>
<p>The latter model corresponds to an extension of the <em>censored</em> approach of O'Meara et al. (2006; Revell et al. 2018) and should also be related to the method of Adams (2012) for comparing rates among traits. See <code>brownie.lite</code> for a different implementation of the <em>noncensored</em> approach of O'Meara et al. (2006).
</p>
<p>For discrete traits, the function instead proceeds to fit two variants of the M<em>k</em> model (Lewis 2001): one in which the parameters values (transition rates) of the process are free to vary between trees, and a second in which they are fixed to be the same. 
</p>
<p>For diversification alone, the function fits two different diversification (speciation &amp; extinction) models (Nee et al. 1994; Stadler 2012): one in which the birth (speciation) and death (extinction) rates are identical between the trees, and a second in which they are permitted to differ in various ways depending on the value of <code>"model"</code> (Revell 2018).
</p>
<p>The method <code>posthoc</code> conducts a post-hoc comparison of parameter estimates between trees in the multi-rate or multi-process model. The parameter that is compared depends on the fitted model. For instance, in <code>model="BM"</code> posthoc comparison is made of <code>sig2</code>; if <code>model="OU"</code> fitted values of <code>alpha</code> are compared; and so on. The argument <code>p.adjust.method</code> can be used to specify a method for adjusting P-values for multiple tests following <code>p.adjust</code> (defaults to <code>p.adjust.method="none"</code>.
</p>
<p>At present it is not possible to specify different models to fit for the different trees - although if (for instance) character evolution on tree 1 proceeded by a strong <em>OU</em> process while character evolution on tree 2 was by <em>BM</em>, we would probably reject a constant-process model and tree 2 should show a very low value of <code>alpha</code>.
</p>
<p>To compute the standard errors for each fitted parameter value, the function computes the negative inverse of the Hessian matrix at the MLEs; however, if this matrix is computationally singular the generalized inverse (<code>ginv</code>) will be used instead without warning.
</p>
<p>The function also conducts a likelihood-ratio test to compare the two models.
</p>
<p>For continuous character, optional arguments presently include the following: <code>model</code>, the model of continuous trait evolution (options are <code>"BM"</code>, the default, <code>"OU"</code>, and <code>"EB"</code>). <code>tol</code>, used as a minimum value for the fitting rates, to prevent problems in optimization. <code>trace</code>, a logical value indicating whether or not to report progress in the optimization. <code>test</code>, the method for hypothesis testing (options are <code>"chisq"</code> and <code>"simulation"</code>). <code>quiet</code>, a logical value indicating whether or not to run perfectly quietly. Finally, <code>se</code>, a list of vectors containing the standard errors for each value of <code>x</code>. 
</p>
<p>For <code>type="discrete"</code> the optional arguments are slightly different. The argument <code>model</code> can be used, but it must assume the values <code>"ER"</code>, <code>"SYM"</code>, <code>"ARD"</code>, or a numeric matrix following <code>ace</code>. 
</p>
<p>Finally, for <code>type= "diversification"</code> models are so far <code>"birth-death"</code>, <code>"equal-extinction"</code>, and <code>"equal-specation"</code>, and <code>"Yule"</code>. It is also important to consider supplying the sampling fractions, <code>rho</code>, which is a vector of values between 0 and 1 of the same length as <code>trees</code>. If not provided the method will assume a sampling fraction of 1.0 for all trees - which is seldom true of empirical studies.
</p>


<h3>Value</h3>

<p>An object of class <code>"ratebytree"</code> or an object of class <code>"posthoc.ratebytree"</code> in the case of the method <code>posthoc</code>.
</p>


<h3>Author(s)</h3>

<p>Liam Revell <a href="mailto:liam.revell@umb.edu">liam.revell@umb.edu</a></p>


<h3>References</h3>

<p>Adams, D. C. (2012) Comparing evolutionary rates for different phenotypic traits on a phylogeny using likelihood. <em>Syst. Biol.</em>, <b>62</b>, 181-192.
</p>
<p>Lewis, P. O. (2001) A likelihood approach to estimating phylogeny from discrete morphological character data. <em>Systematic Biology</em>, <b>50</b>, 913-925.
</p>
<p>Nee, S., May, R. M. and Harvey, P. H. (1994) The reconstructed evolutionary process. <em>Philosophical Transactions of the Royal Society of London B</em>, <b>344</b>, 305-311.
</p>
<p>O'Meara, B. C., C. Ane, M. J. Sanderson, and P. C. Wainwright. (2006) Testing for different rates of continuous trait evolution using likelihood. <em>Evolution</em>, <b>60</b>, 922-933.
</p>
<p>Revell, L. J. (2018) Comparing the rates of speciation and extinction between phylogenetic trees. <em>Ecology and Evolution</em>, <b>8</b>, 5303-5312.
</p>
<p>Revell, L. J. (2024) phytools 2.0: an updated R ecosystem for phylogenetic comparative methods (and other things). <em>PeerJ</em>, <b>12</b>, e16505.
</p>
<p>Revell, L. J., Gonzalez-Valenzuela, L. E., Alfonso, A., Castellanos-Garcia, L. A., Guarnizo, C. E., and Crawford, A. J. (2018) Comparing evolutionary rates between trees, clades, &amp; traits. <em>Methods Ecol. Evol.</em>, <b>9</b>, 994-1005.
</p>
<p>Stadler, T. (2012) How can we improve the accuracy of macroevolutionary rate estimates? <em>Systematic Biology</em>, <b>62</b>, 321-329.
</p>


<h3>See Also</h3>

<p><code>brownie.lite</code>, <code>fitMk</code>
</p>


</div>