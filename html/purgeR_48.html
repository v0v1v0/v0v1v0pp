<div class="container">

<table style="width: 100%;"><tr>
<td>op</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>Opportunity of purging</h2>

<h3>Description</h3>

<p>The potential reduction in individual inbreeding load can be
estimated by means of the opportunity of purging (<em>O</em>) and expressed
opportunity of purging (<em>Oe</em>) parameters described by Gulisija
and Crow (2007). Whereas <em>O</em> relates to the total potential reduction
of the inbreeding load in an individual, as a consequence of it having
inbred ancestors, <em>Oe</em> relates to the expressed potential reduction of the
inbreeding load. In both cases, these measures are referred to fully recessive,
high effect size alleles (e.g. lethals). For complex pedigrees, involving more than one
autozygous individual per path from a reference individual to an
ancestor, these estimates are estimated following an heuristic approach
(see details below).
</p>


<h3>Usage</h3>

<pre><code class="language-R">op(ped, pi, Fi, name_O, name_Oe, sufix, compute_O = FALSE)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>ped</code></td>
<td>
<p>A dataframe containing the pedigree. Individual (id), maternal (dam), and paternal (sire) identities are mandatory columns.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>pi</code></td>
<td>
<p>Partial inbreeding matrix</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>Fi</code></td>
<td>
<p>Vector of inbreeding coefficient values</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>name_O</code></td>
<td>
<p>A string naming the new output column for total opportunity of purging (defaults to "O")</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>name_Oe</code></td>
<td>
<p>A string naming the new output column for the expressed opportunity of purging (defaults to "Oe")</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>sufix</code></td>
<td>
<p>A string naming the sufix for non-corrected O and Oe measures</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>compute_O</code></td>
<td>
<p>Enable computation of total opportunity of purging (false by default)</p>
</td>
</tr>
</table>
<h3>Details</h3>

<p>In simple pedigrees, the opportunity of purging (<em>O</em>) and the expressed
opportunity of purging (<em>Oe</em>) are estimated as in Gulisija and Crow (2007).
For complex pedigrees involving more than one autozygous individual per
path from an individual to an ancestor, <em>O</em> and <em>Oe</em> in the closer ancestors
need to be discounted for what was already accounted for in their predecessors.
To solve this problem, Gulisija and Crow (2007) provide expression to 
correct <em>O</em> and <em>Oe</em> (see equations 21 and 22 in the manuscript).
</p>
<p>Here, an heuristic approach is used to prevent the inflation of <em>O</em> and <em>Oe</em>,
and avoid the use of additional looped expressions that may result in an
excessive computational cost. To do so, when using <code>ip_op(complex = TRUE)</code>
only the contribution of the most recent ancestors in a path will be considered.
This may not provide exact values of <em>O</em> and <em>Oe</em>, but we expect little bias, since
more distant ancestors also contribute lesser to <em>O</em> and <em>Oe</em>.
</p>


<h3>Value</h3>

<p>The input dataframe, plus two additional column named "O" and "Oe", containing total and expressed opportunity of purging measures.
</p>


<h3>References</h3>


<ul><li>
<p>Gulisija D, Crow JF. 2007. Inferring purging from pedigree data. Evolution 61(5): 1043-1051.
</p>
</li></ul>
</div>