<div class="container">

<table style="width: 100%;"><tr>
<td>simresiduals</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>Simulate Residuals</h2>

<h3>Description</h3>

<p>Simulates residuals for a given regression model
</p>


<h3>Usage</h3>

<pre><code class="language-R">simresiduals(object, ...)
## Default S3 method:
simresiduals(object, nrep=19, simfunction=NULL,
  stdresiduals = NULL, sigma = object$sigma, ...)
## S3 method for class 'glm'
simresiduals(object, nrep=19, simfunction=NULL,
        glm.restype="working", ...)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>object</code></td>
<td>
<p>result of fitting a regression</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>nrep</code></td>
<td>
<p>number of replicates</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>simfunction</code></td>
<td>
<p>if a function, it is used to generate random values for
the target variable, with three arguments, which will be fed by
the number of observations, the fitted values, and
<code>object$sigma</code> in the case of <code>simresiduals.default</code>,
respectively. <br>
If TRUE, the appropriate random number generator will be used.<br>
If NULL (default) the standardized residuals of
<code>object</code> will be randomly permuted in the case of
<code>simresiduals.default</code>. For <code>simresiduals.glm</code>,
this is the same as TRUE.
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>stdresiduals</code></td>
<td>
<p>logical: should standardized residuals be
produced?</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>sigma</code></td>
<td>
<p>scale parameter to be used, defaults to
<code>object$sigma</code>
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>glm.restype</code></td>
<td>
<p>type of residuals to be generated (for glm)
Warning: type "deviance" may produce NAs.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>...</code></td>
<td>
<p>further arguments passed to forthcoming methods.</p>
</td>
</tr>
</table>
<h3>Details</h3>

<p>The simulated residuals are obtained for the default method
by replacing the response variable by permuted standardized residuals
of the fitted regression, multiplied by the scale
<code>object\$sigma</code>, then fitting the model to these residuals and
getting the reseiduals  from this new fit.
This is repeated <code>nrep</code> times.
If standarized residuals are not available, ordinary residuals are
used.
</p>
<p>For the <code>glm</code> method, the values of the response variable are
obtained from simulating according to the model (binomial or Poisson),
and the model is re-fitted to these generated values.
</p>


<h3>Value</h3>

<p>A matrix of which each column contains an set of simulated residuals.
If standardized residuals are available,
attribute <code>"stdresisduals"</code> is the matrix containing corresponding
standardized residuals.
</p>


<h3>Author(s)</h3>

<p>Werner A. Stahel, ETH Zurich</p>


<h3>Examples</h3>

<pre><code class="language-R">data(d.blast)
r.blast &lt;-
  lm(log10(tremor)~location+log10(distance)+log10(charge),
  data=d.blast)
r.simblast &lt;- simresiduals(r.blast, nrep=5)
showd(r.simblast)
## --------------------------
data(d.babysurvival)
r.babysurv &lt;- lm( Survival~Weight+Age+Apgar1, data=d.babysurvival)
r.simbs &lt;- simresiduals(r.babysurv, nrep=5)
showd(r.simbs)
</code></pre>


</div>