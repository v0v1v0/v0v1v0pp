<div class="container">

<table style="width: 100%;"><tr>
<td>run_check_relatedness</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>Run PLINK IBD estimation</h2>

<h3>Description</h3>

<p>Run LD pruning on dataset with plink –exclude range highldfile
–indep-pairwise 50 5 0.2, where highldfile contains regions of high LD as
provided by Anderson et (2010) Nature Protocols. Subsequently, plink
–genome is run on the LD pruned, maf-filtered data. plink –genome
calculates identity by state (IBS) for each pair of individuals based on the
average proportion of alleles shared at genotyped SNPs. The degree of recent
shared ancestry,i.e. the identity by descent (IBD) can be estimated from the
genome-wide IBS. The proportion of IBD between two individuals is returned by
–genome as PI_HAT.
</p>


<h3>Usage</h3>

<pre><code class="language-R">run_check_relatedness(
  indir,
  name,
  qcdir = indir,
  highIBDTh = 0.185,
  mafThRelatedness = 0.1,
  path2plink = NULL,
  filter_high_ldregion = TRUE,
  high_ldregion_file = NULL,
  genomebuild = "hg19",
  showPlinkOutput = TRUE,
  keep_individuals = NULL,
  remove_individuals = NULL,
  exclude_markers = NULL,
  extract_markers = NULL,
  verbose = FALSE
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>indir</code></td>
<td>
<p>[character] /path/to/directory containing the basic PLINK data
files name.bim, name.bed, name.fam files.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>name</code></td>
<td>
<p>[character] Prefix of PLINK files, i.e. name.bed, name.bim,
name.fam.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>qcdir</code></td>
<td>
<p>[character] /path/to/directory to save name.genome as returned
by plink –genome. User needs writing permission to qcdir. Per default
qcdir=indir.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>highIBDTh</code></td>
<td>
<p>[double] Threshold for acceptable proportion of IBD between
pair of individuals; only pairwise relationship estimates larger than this
threshold will be recorded.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>mafThRelatedness</code></td>
<td>
<p>[double] Threshold of minor allele frequency filter
for selecting variants for IBD estimation.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>path2plink</code></td>
<td>
<p>[character] Absolute path to PLINK executable
(<a href="https://www.cog-genomics.org/plink/1.9/">https://www.cog-genomics.org/plink/1.9/</a>) i.e.
plink should be accessible as path2plink -h. The full name of the executable
should be specified: for windows OS, this means path/plink.exe, for unix
platforms this is path/plink. If not provided, assumed that PATH set-up works
and PLINK will be found by <code>exec</code>('plink').</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>filter_high_ldregion</code></td>
<td>
<p>[logical] Should high LD regions be filtered
before IBD estimation; carried out per default with high LD regions for
hg19 provided as default via <code>genomebuild</code>. For alternative genome
builds not provided or non-human data, high LD regions files can be
provided via <code>high_ldregion_file</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>high_ldregion_file</code></td>
<td>
<p>[character] Path to file with high LD regions used
for filtering before IBD estimation if <code>filter_high_ldregion</code> == TRUE,
otherwise ignored; for human genome data, high LD region files are provided
and can simply be chosen via <code>genomebuild</code>. Files have to be
space-delimited, no column names with the following columns: chromosome,
region-start, region-end, region number. Chromosomes are specified without
'chr' prefix. For instance:
1 48000000 52000000 1
2 86000000 100500000 2</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>genomebuild</code></td>
<td>
<p>[character] Name of the genome build of the PLINK file
annotations, ie mappings in the name.bim file. Will be used to remove
high-LD regions based on the coordinates of the respective build. Options
are hg18, hg19 and hg38. See @details.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>showPlinkOutput</code></td>
<td>
<p>[logical] If TRUE, plink log and error messages are
printed to standard out.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>keep_individuals</code></td>
<td>
<p>[character] Path to file with individuals to be
retained in the analysis. The file has to be a space/tab-delimited text file
with family IDs in the first column and within-family IDs in the second
column. All samples not listed in this file will be removed from the current
analysis. See <a href="https://www.cog-genomics.org/plink/1.9/filter#indiv">https://www.cog-genomics.org/plink/1.9/filter#indiv</a>.
Default: NULL, i.e. no filtering on individuals.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>remove_individuals</code></td>
<td>
<p>[character] Path to file with individuals to be
removed from the analysis. The file has to be a space/tab-delimited text file
with family IDs in the first column and within-family IDs in the second
column. All samples listed in this file will be removed from the current
analysis. See <a href="https://www.cog-genomics.org/plink/1.9/filter#indiv">https://www.cog-genomics.org/plink/1.9/filter#indiv</a>.
Default: NULL, i.e. no filtering on individuals.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>exclude_markers</code></td>
<td>
<p>[character] Path to file with makers to be
removed from the analysis. The file has to be a text file with a list of
variant IDs (usually one per line, but it's okay for them to just be
separated by spaces). All listed variants will be removed from the current
analysis. See <a href="https://www.cog-genomics.org/plink/1.9/filter#snp">https://www.cog-genomics.org/plink/1.9/filter#snp</a>.
Default: NULL, i.e. no filtering on markers.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>extract_markers</code></td>
<td>
<p>[character] Path to file with makers to be
included in the analysis. The file has to be a text file with a list of
variant IDs (usually one per line, but it's okay for them to just be
separated by spaces). All unlisted variants will be removed from the current
analysis. See <a href="https://www.cog-genomics.org/plink/1.9/filter#snp">https://www.cog-genomics.org/plink/1.9/filter#snp</a>.
Default: NULL, i.e. no filtering on markers.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>verbose</code></td>
<td>
<p>[logical] If TRUE, progress info is printed to standard out.</p>
</td>
</tr>
</table>
<h3>Details</h3>

<p>Both <code>run_check_relatedness</code> and its evaluation via
<code>evaluate_check_relatedness</code> can simply be invoked by
<code>check_relatedness</code>.
</p>
<p>The IBD estimation is conducted on LD pruned data and in a first
step, high LD regions are excluded. The regions were derived from the
high-LD-regions file provided by Anderson et (2010) Nature Protocols. These
regions are in NCBI36 (hg18) coordinates and were lifted to GRCh37 (hg19)
and GRC38 (hg38) coordinates using the liftOver tool available here:
<a href="https://genome.ucsc.edu/cgi-bin/hgLiftOver">https://genome.ucsc.edu/cgi-bin/hgLiftOver</a>. The 'Minimum ratio of bases
that must remap' which was set to 0.5 and the 'Allow multiple output regions'
box ticked; for all other parameters, the default options were selected.
LiftOver files were generated on July 9,2019. The commands for formatting
the files are provided in system.file("extdata", 'liftOver.cmd',
package="plinkQC").
</p>


<h3>Examples</h3>

<pre><code class="language-R">indir &lt;- system.file("extdata", package="plinkQC")
name &lt;- 'data'
qcdir &lt;- tempdir()
path2plink &lt;- '/path/to/plink'
# the following code is not run on package build, as the path2plink on the
# user system is not known.
## Not run: 
# Relatedness estimation based in all markers in dataset
run &lt;- run_check_relatedness(indir=indir, qcdir=qcdir, name=name,
path2plink=path2plink)

# relatedness estimation on subset of dataset
keep_individuals_file &lt;- system.file("extdata", "keep_individuals",
package="plinkQC")
run &lt;- run_check_relatedness(indir=indir, qcdir=qcdir, name=name,
keep_individuals=keep_individuals_file, path2plink=path2plink)

## End(Not run)
</code></pre>


</div>