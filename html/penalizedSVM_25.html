<div class="container">

<table style="width: 100%;"><tr>
<td>sim.data</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2> Simulation of microarray data </h2>

<h3>Description</h3>

<p>Simulation of 'n' samples. Each sample has 'sg' genes,  only 'nsg' of them are called significant and 
have influence on class labels. All other '(ng - nsg)' genes are called ballanced.
All gene ratios are drawn from a multivariate normal distribution. 
There is a posibility to create blocks of highly correlated genes.     
</p>


<h3>Usage</h3>

<pre><code class="language-R">sim.data(n = 256, ng = 1000, nsg = 100,
		 p.n.ratio = 0.5, 
		 sg.pos.factor= 1, sg.neg.factor= -1,
		 # correlation info:
		 corr = FALSE, corr.factor = 0.8,
		 # block info:
		 blocks = FALSE, n.blocks = 6, nsg.block = 1, ng.block = 5, 
		 seed = 123, ...)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>n</code></td>
<td>
<p> number of samples, logistic regression works well if <code class="reqn">n&gt;200</code>!</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>ng</code></td>
<td>
<p> number of genes</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>nsg</code></td>
<td>
<p> number of significant genes</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>p.n.ratio</code></td>
<td>
<p> ratio between positive and negative significant genes (default 0.5)</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>sg.pos.factor</code></td>
<td>
<p> impact factor of <b>positive</b> significant genes on the classifaction, default:  1  </p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>sg.neg.factor</code></td>
<td>
<p> impact factor of <b>negative</b> significant genes on the classifaction,default:  -1  </p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>corr</code></td>
<td>
<p> are the genes correalted to each other? (default FALSE). see Details</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>corr.factor</code></td>
<td>
<p> correlation factorfor genes, between 0 and 1 (default 0.8)   </p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>blocks</code></td>
<td>
<p> are blocks of highly correlated genes are allowed? (default FALSE)</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>n.blocks</code></td>
<td>
<p> number of blocks </p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>nsg.block</code></td>
<td>
<p> number of significant genes per block</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>ng.block</code></td>
<td>
<p> number of genes per block</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>seed</code></td>
<td>
<p> seed</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>...</code></td>
<td>
<p> additional argument(s) </p>
</td>
</tr>
</table>
<h3>Details</h3>

<p>If no blockes (n.blocks=0 or blocks=FALSE) are defined and corr=TRUE
create covarance matrix for all genes! with decrease of correlation :  <code class="reqn">cov(i,j)=cov(j,i)= corr.factor^(i-j)</code>
</p>


<h3>Value</h3>

<table>
<tr style="vertical-align: top;">
<td><code> x </code></td>
<td>
<p>matrix of simulated data. Genes in rows and samples in columns</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code> y </code></td>
<td>
<p>named vector of class labels</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code> seed </code></td>
<td>
<p>seed</p>
</td>
</tr>
</table>
<h3>Author(s)</h3>

<p> Wiebke Werft, Natalia Becker </p>


<h3>See Also</h3>

 <p><code>mvrnorm</code> </p>


<h3>Examples</h3>

<pre><code class="language-R">
my.seed&lt;-123

# 1. simulate 20 samples, with 100 genes in each. Only the first two genes
# have an impact on the class labels.
# All genes are assumed to be i.i.d. 
train&lt;-sim.data(n = 20, ng = 100, nsg = 3, corr=FALSE, seed=my.seed )
print(str(train)) 

# 2. change the proportion between positive and negative significant genes 
#(from 0.5 to 0.8)
train&lt;-sim.data(n = 20, ng = 100, nsg = 10, p.n.ratio = 0.8,  seed=my.seed )
rownames(train$x)[1:15]
# [1] "pos1" "pos2" "pos3" "pos4" "pos5" "pos6" "pos7" "pos8" 
# [2] "neg1" "neg2" "bal1" "bal2" "bal3" "bal4" "bal5"

# 3. assume to have correlation for positive significant genes, 
# negative significant genes and 'balanced' genes separatly. 
train&lt;-sim.data(n = 20, ng = 100, nsg = 10, corr=TRUE, seed=my.seed )
#cor(t(train$x[1:15,]))

# 4. add 6 blocks of 5 genes each and only one significant gene per block.
# all genes in the block are correlated with constant correlation factor
#  corr.factor=0.8 		
train&lt;-sim.data(n = 20, ng = 100, nsg = 6, corr=TRUE, corr.factor=0.8,
			 blocks=TRUE, n.blocks=6, nsg.block=1, ng.block=5, seed=my.seed )
print(str(train)) 
# first block
#cor(t(train$x[1:5,]))
# second block
#cor(t(train$x[6:10,]))

</code></pre>


</div>