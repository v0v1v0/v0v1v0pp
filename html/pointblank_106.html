<div class="container">

<table style="width: 100%;"><tr>
<td>info_snippet</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>Generate a useful text 'snippet' from the target table</h2>

<h3>Description</h3>

<p>Getting little snippets of information from a table goes hand-in-hand with
mixing those bits of info with your table info. Call <code>info_snippet()</code> to
define a snippet and how you'll get that from the target table. The snippet
definition is supplied either with a formula, or, with a
<strong>pointblank</strong>-supplied <code style="white-space: pre;">⁠snip_*()⁠</code> function. So long as you know how to
interact with a table and extract information, you can easily define snippets
for a <em>informant</em> object. And once those snippets are defined, you can insert
them into the <em>info text</em> as defined through the other <code style="white-space: pre;">⁠info_*()⁠</code> functions
(<code>info_tabular()</code>, <code>info_columns()</code>, and <code>info_section()</code>). Use curly braces
with just the <code>snippet_name</code> inside (e.g., <code>"This column has {n_cat} categories."</code>).
</p>


<h3>Usage</h3>

<pre><code class="language-R">info_snippet(x, snippet_name, fn)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>x</code></td>
<td>
<p><em>The pointblank informant object</em>
</p>
<p><code style="white-space: pre;">⁠obj:&lt;ptblank_informant&gt;⁠</code> // <strong>required</strong>
</p>
<p>A <strong>pointblank</strong> <em>informant</em> object that is commonly created through the
use of the <code>create_informant()</code> function.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>snippet_name</code></td>
<td>
<p><em>The snippet name</em>
</p>
<p><code style="white-space: pre;">⁠scalar&lt;character&gt;⁠</code> // <strong>required</strong>
</p>
<p>The name for snippet, which is used for interpolating the result of the
snippet formula into <em>info text</em> defined by an <code style="white-space: pre;">⁠info_*()⁠</code> function.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>fn</code></td>
<td>
<p><em>Function for snippet text generation</em>
</p>
<p><code style="white-space: pre;">⁠&lt;function&gt;⁠</code> // <strong>required</strong>
</p>
<p>A formula that obtains a snippet of data from the target table. It's best
to use a leading dot (<code>.</code>) that stands for the table itself and use pipes
to construct a series of operations to be performed on the table (e.g.,
<code>~ . %&gt;% dplyr::pull(column_2) %&gt;% max(na.rm = TRUE)</code>). So long as the
result is a length-1 vector, it'll likely be valid for insertion into some
info text. Alternatively, a <code style="white-space: pre;">⁠snip_*()⁠</code> function can be used here (these
functions always return a formula that's suitable for all types of data
sources).</p>
</td>
</tr>
</table>
<h3>Value</h3>

<p>A <code>ptblank_informant</code> object.
</p>


<h3>Snip functions provided in <strong>pointblank</strong>
</h3>

<p>For convenience, there are several <code style="white-space: pre;">⁠snip_*()⁠</code> functions provided in the
package that work on column data from the <em>informant</em>'s target table. These
are:
</p>

<ul>
<li> <p><code>snip_list()</code>: get a list of column categories
</p>
</li>
<li> <p><code>snip_stats()</code>: get an inline statistical summary
</p>
</li>
<li> <p><code>snip_lowest()</code>: get the lowest value from a column
</p>
</li>
<li> <p><code>snip_highest()</code> : get the highest value from a column
</p>
</li>
</ul>
<p>As it's understood what the target table is, only the <code>column</code> in each of
these functions is necessary for obtaining the resultant text.
</p>


<h3>YAML</h3>

<p>A <strong>pointblank</strong> informant can be written to YAML with <code>yaml_write()</code> and the
resulting YAML can be used to regenerate an informant (with
<code>yaml_read_informant()</code>) or perform the 'incorporate' action using the target
table (via <code>yaml_informant_incorporate()</code>). Snippets are stored in the YAML
representation and here is is how they are expressed in both R code and in
the YAML output (showing both the <code>meta_snippets</code> and <code>columns</code> keys to
demonstrate their relationship here).
</p>
<div class="sourceCode"><pre># R statement
informant %&gt;% 
  info_columns(
    columns = date_time,
    `Latest Date` = "The latest date is {latest_date}."
  ) %&gt;%
  info_snippet(
    snippet_name = "latest_date",
    fn = ~ . %&gt;% dplyr::pull(date) %&gt;% max(na.rm = TRUE)
  ) %&gt;%
  incorporate()

# YAML representation
meta_snippets:
  latest_date: ~. %&gt;% dplyr::pull(date) %&gt;% max(na.rm = TRUE)
...
columns:
  date_time:
    _type: POSIXct, POSIXt
    Latest Date: The latest date is {latest_date}.
  date:
    _type: Date
  item_count:
    _type: integer
</pre></div>


<h3>Examples</h3>

<p>Take the <code>small_table</code> dataset included in <strong>pointblank</strong> and assign it to
<code>test_table</code>. We'll modify it later.
</p>
<div class="sourceCode r"><pre>test_table &lt;- small_table
</pre></div>
<p>Generate an informant object, add two snippets with <code>info_snippet()</code>,
add information with some other <code style="white-space: pre;">⁠info_*()⁠</code> functions and then <code>incorporate()</code>
the snippets into the info text. The first snippet will be made with the
expression <code>~ . %&gt;% nrow()</code> (giving us the number of rows in the dataset) and
the second uses the <code>snip_highest()</code> function with column <code>a</code> (giving us
the highest value in that column).
</p>
<div class="sourceCode r"><pre>informant &lt;- 
  create_informant(
    tbl = ~ test_table,
    tbl_name = "test_table",
    label = "An example."
  ) %&gt;%
  info_snippet(
    snippet_name = "row_count",
    fn = ~ . %&gt;% nrow()
  ) %&gt;%
  info_snippet(
    snippet_name = "max_a",
    fn = snip_highest(column = "a")
  ) %&gt;%
  info_columns(
    columns = a,
    info = "In the range of 1 to {max_a}. ((SIMPLE))"
  ) %&gt;%
  info_columns(
    columns = starts_with("date"),
    info = "Time-based values (e.g., `Sys.time()`)."
  ) %&gt;%
  info_columns(
    columns = date,
    info = "The date part of `date_time`. ((CALC))"
  ) %&gt;%
  info_section(
    section_name = "rows",
    row_count = "There are {row_count} rows available."
  ) %&gt;%
  incorporate()
</pre></div>
<p>We can print the <code>informant</code> object to see the information report.
</p>
<div class="sourceCode r"><pre>informant
</pre></div>


<img src="https://raw.githubusercontent.com/rstudio/pointblank/main/images/man_info_snippet_1.png" alt="This image was generated from the first code example in the `info_snippet()` help file." style="width:100%;"><p>Let's modify <code>test_table</code> with some <strong>dplyr</strong> to give it more rows and an
extra column.
</p>
<div class="sourceCode r"><pre>test_table &lt;- 
  dplyr::bind_rows(test_table, test_table) %&gt;%
  dplyr::mutate(h = a + c)
</pre></div>
<p>Using <code>incorporate()</code> on the <code>informant</code> object will cause the snippets to be
reprocessed, and, the info text to be updated.
</p>
<div class="sourceCode r"><pre>informant &lt;- informant %&gt;% incorporate()

informant
</pre></div>


<img src="https://raw.githubusercontent.com/rstudio/pointblank/main/images/man_info_snippet_2.png" alt="This image was generated from the second code example in the `info_snippet()` help file." style="width:100%;"><h3>Function ID</h3>

<p>3-5
</p>


<h3>See Also</h3>

<p>Other Information Functions: 
<code>info_columns()</code>,
<code>info_columns_from_tbl()</code>,
<code>info_section()</code>,
<code>info_tabular()</code>,
<code>snip_highest()</code>,
<code>snip_list()</code>,
<code>snip_lowest()</code>,
<code>snip_stats()</code>
</p>


</div>