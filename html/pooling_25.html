<div class="container">

<table style="width: 100%;"><tr>
<td>p_logreg</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>Poolwise Logistic Regression</h2>

<h3>Description</h3>

<p>Fit homogeneous-pools logistic regression model described by Weinberg &amp;
Umbach (1999).
</p>


<h3>Usage</h3>

<pre><code class="language-R">p_logreg(g, y, x, method = "glm", prev = NULL, samp_y1y0 = NULL,
  estimate_var = TRUE, start = 0.01, lower = -Inf, upper = Inf,
  nlminb_list = list(control = list(trace = 1, eval.max = 500, iter.max =
  500)), hessian_list = list(method.args = list(r = 4)))
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>g</code></td>
<td>
<p>Numeric vector with pool sizes, i.e. number of members in each pool.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>y</code></td>
<td>
<p>Numeric vector with poolwise <code>Y</code> values, coded 0 if all members
are controls and 1 if all members are cases.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>x</code></td>
<td>
<p>Numeric matrix with poolwise <strong><code>X</code></strong> values, with one row
for each pool. Can be a vector if there is only 1 predictor.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>method</code></td>
<td>
<p>Character string specifying method to use for estimation.
Choices are "glm" for <code>glm</code> function and <code>"ml"</code> for
maximum likelihood.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>prev</code></td>
<td>
<p>Numeric value specifying disease prevalence, allowing
for valid estimation of the intercept with case-control sampling. Can specify
<code>samp_y1y0</code> instead if sampling rates are known.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>samp_y1y0</code></td>
<td>
<p>Numeric vector of length 2 specifying sampling probabilities
for cases and controls, allowing for valid estimation of the intercept with
case-control sampling. Can specify <code>prev</code> instead if it's easier.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>estimate_var</code></td>
<td>
<p>Logical value for whether to return variance-covariance
matrix for parameter estimates.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>start</code></td>
<td>
<p>Numeric value specifying starting values for parameters. Only
used if <code>method = "ml"</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>lower</code></td>
<td>
<p>Numeric value specifying lower bounds for parameters. Only used
if <code>method = "ml"</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>upper</code></td>
<td>
<p>Numeric value specifying upper bounds for parameters. Only used
if <code>method = "ml"</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>nlminb_list</code></td>
<td>
<p>List of arguments to pass to <code>nlminb</code>
for log-likelihood maximization.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>hessian_list</code></td>
<td>
<p>List of arguments to pass to
<code>hessian</code> for approximating the Hessian matrix. Only
used if <code>method = "ml"</code> and <code>estimate_var = TRUE</code>.</p>
</td>
</tr>
</table>
<h3>Value</h3>

<p>List containing:
</p>

<ol>
<li>
<p> Numeric vector of parameter estimates.
</p>
</li>
<li>
<p> Variance-covariance matrix (if <code>estimate_var = TRUE</code>).
</p>
</li>
<li>
<p> Fitted <code>glm</code> object (if <code>method = "glm"</code>) or
returned <code>nlminb</code> object (if <code>method = "ml"</code>).
</p>
</li>
<li>
<p> Akaike information criterion (AIC).
</p>
</li>
</ol>
<h3>References</h3>

<p>Weinberg, C.R. and Umbach, D.M. (1999) "Using pooled exposure assessment to
improve efficiency in case-control studies." <em>Biometrics</em> <strong>55</strong>:
718–726.
</p>
<p>Weinberg, C.R. and Umbach, D.M. (2014) "Correction to 'Using pooled exposure
assessment to improve efficiency in case-control studies' by Clarice R.
Weinberg and David M. Umbach; 55, 718–726, September 1999."
<em>Biometrics</em> <strong>70</strong>: 1061.
</p>


<h3>Examples</h3>

<pre><code class="language-R"># Load dataset containing (Y, Xtilde, C) values for pools of size 1, 2, and 3
data(pdat1)

# Estimate log-OR for Xtilde and Y adjusted for C
fit &lt;- p_logreg(g = pdat1$g, y = pdat1$allcases, x = pdat1[, c("xtilde", "c")])
fit$theta.hat


</code></pre>


</div>