<div class="container">

<table style="width: 100%;"><tr>
<td>retlev</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>Return Level Plot</h2>

<h3>Description</h3>

<p><code>retlev</code> is a generic function used to show return level plot. 
The function invokes particular <code>methods</code> 
which depend on the <code>class</code> of the first argument.
So the function makes a return level plot for POT models. 
</p>


<h3>Usage</h3>

<pre><code class="language-R">retlev(object, ...)

## S3 method for class 'uvpot'
retlev(object, npy, main, xlab, ylab, xlimsup,
ci = TRUE, points = TRUE, ...)
## S3 method for class 'mcpot'
retlev(object, opy, exi, main, xlab, ylab, xlimsup,
...)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>object</code></td>
<td>
<p>A fitted object. When using the POT package, an object 
of class <code>'uvpot'</code> or <code>'mcpot'</code>. Most often, the
return of  <code>fitgpd</code> or <code>fitmcgpd</code> functions.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>npy</code></td>
<td>
<p>The mean <b>N</b>umber of events <b>P</b>er <b>Y</b>ear (or
more generally per block).if missing, setting it to 1.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>main</code></td>
<td>
<p>The title of the graphic. If missing, the title is set to
<code>"Return Level Plot"</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>xlab,ylab</code></td>
<td>
<p>The labels for the x and y axis. If missing, they are
set to <code>"Return Period (Years)"</code> and <code>"Return Level"</code> respectively.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>xlimsup</code></td>
<td>
<p>Numeric. The right limit for the x-axis. If missing, a
suited value is computed.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>ci</code></td>
<td>
<p>Logical. Should the 95% pointwise confidence interval be
plotted?</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>points</code></td>
<td>
<p>Logical. Should observations be plotted?</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>...</code></td>
<td>
<p>Other arguments to be passed to the <code>plot</code>
function.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>opy</code></td>
<td>
<p>The number of <b>O</b>bservations <b>P</b>er <b>Y</b>ear (or
more generally per block). If missing, it is set it to 365 i.e. daily
values with a warning.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>exi</code></td>
<td>
<p>Numeric. The extremal index. If missing, an estimate is
given using the <code>fitexi</code> function.</p>
</td>
</tr>
</table>
<h3>Details</h3>

<p>For class <code>"uvpot"</code>, the return level plot consists of plotting the theoretical quantiles
in function of the return period (with a logarithmic scale for the
x-axis). For the definition of the return period see the
<code>prob2rp</code> function. Thus, the return level plot consists
of plotting the points defined by:
</p>
<p style="text-align: center;"><code class="reqn">(T(p), F^{-1}(p))</code>
</p>

<p>where <code class="reqn">T(p)</code> is the return period related to the non
exceedance probability <code class="reqn">p</code>, <code class="reqn">F^{-1}</code> is the
fitted quantile function.
</p>
<p>If <code>points = TRUE</code>, the probabilities <code class="reqn">p_j</code> related to
each observation are computed using the following plotting position
estimator proposed by Hosking (1995):
</p>
<p style="text-align: center;"><code class="reqn">p_j = \frac{j - 0.35}{n}</code>
</p>

<p>where <code class="reqn">n</code> is the total number of observations.
</p>
<p>If the theoretical model is correct, the points should be “close”
to the “return level” curve.
</p>
<p>For class <code>"mcpot"</code>, let <code class="reqn">X_1, \ldots,X_n</code> be the first <code class="reqn">n</code>
observations from a stationary sequence with marginal distribution
function <code class="reqn">F</code>. Thus, we can use the following (asymptotic)
approximation:
</p>
<p style="text-align: center;"><code class="reqn">\Pr\left[\max\left\{X_1,\ldots,X_n\right\} \leq x \right] =
    \left[ F(x) \right]^{n \theta}</code>
</p>

<p>where <code class="reqn">\theta</code> is the extremal index.
</p>
<p>Thus, to obtain the T-year return level, we equate this equation to
<code class="reqn">1 - 1/T</code> and solve for <code class="reqn">x</code>.  
</p>


<h3>Value</h3>

<p>A graphical window. In addition, it returns invisibly the return level
function.
</p>


<h3>Warning</h3>

<p>For class <code>"mcpot"</code>, though this is computationally expensive, we recommend to give the
extremal index estimate using the <code>dexi</code> function. Indeed,
there is a severe bias when using the Ferro and Segers (2003)
estimator - as it is estimated using observation and not the Markov
chain model.
</p>


<h3>Author(s)</h3>

<p>Mathieu Ribatet</p>


<h3>References</h3>

<p>Hosking, J. R. M. and Wallis, J. R. (1995). A comparison of unbiased
and plotting-position estimators of L moments. Water Resources
Research. <b>31</b>(8): 2019–2025.
</p>
<p>Ferro, C. and Segers, J. (2003). Inference for clusters of extreme
values. Journal of the Royal Statistical Society B. <b>65</b>:
545–556.  
</p>


<h3>See Also</h3>

<p><code>prob2rp</code>, <code>fitexi</code>.
</p>


<h3>Examples</h3>

<pre><code class="language-R">
#for uvpot class
x &lt;- rgpd(75, 1, 2, 0.1)
pwmu &lt;- fitgpd(x, 1, "pwmu")
rl.fun &lt;- retlev(pwmu)
rl.fun(100)

#for mcpot class
data(ardieres)
Mcalog &lt;- fitmcgpd(ardieres[,"obs"], 5, "alog")
retlev(Mcalog, opy = 990)
</code></pre>


</div>