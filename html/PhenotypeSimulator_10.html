<div class="container">

<table style="width: 100%;"><tr>
<td>noiseBgEffects</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>Simulate observational noise effects.</h2>

<h3>Description</h3>

<p>noiseBgEffects simulates observational noise with a proportion of the effect 
shared across samples and a proportion independent across samples.
</p>


<h3>Usage</h3>

<pre><code class="language-R">noiseBgEffects(
  N,
  P,
  mean = 0,
  sd = 1,
  sampleID = "ID_",
  phenoID = "Trait_",
  shared = TRUE,
  independent = TRUE,
  id_samples = NULL,
  id_phenos = NULL
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>N</code></td>
<td>
<p>Number [integer] of samples to simulate.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>P</code></td>
<td>
<p>Number [integer] of phenotypes to simulate.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>mean</code></td>
<td>
<p>Mean [double] of the normal distribution.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>sd</code></td>
<td>
<p>Standard deviation [double] of the normal distribution.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>sampleID</code></td>
<td>
<p>Prefix [string] for naming samples.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>phenoID</code></td>
<td>
<p>Prefix [string] for naming traits.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>shared</code></td>
<td>
<p>[bool] shared effect simulated if set to TRUE; at least one of 
shared or independent has to be set to TRUE.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>independent</code></td>
<td>
<p>[bool] independent effect simulated if set to TRUE.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>id_samples</code></td>
<td>
<p>Vector of [NrSamples] sample IDs [string]; if not provided
constructed by paste(sampleID, 1:N, sep="").</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>id_phenos</code></td>
<td>
<p>Vector of [NrTraits] phenotype IDs [string]; if not provided
constructed by paste(phenoID, 1:P, sep="").</p>
</td>
</tr>
</table>
<h3>Details</h3>

<p>For the simulation of the observational noise effects, two 
components are used: i) matrix B [N x P] with vec(B) drawn from a normal 
distribution with mean=mean and sd=sd and ii) the trait design matrix A 
[P x P]. For the independent effect, A is a diagonal matrix with normally 
distributed values.  A for the shared effect is a matrix of rowrank one, with 
normally distributed entries in row 1 and zeros elsewhere.  To construct the 
final effects, the two matrices are multiplied as: E = BA^T.
</p>


<h3>Value</h3>

<p>Named list of shared noise effects (shared: [N x P] matrix) and 
independent noise effects (independent: [N x P] matrix), the covariance term 
of the shared effect (cov_shared: [P x P] matrix) and the covariance term of 
the independent effect (cov_independent: [P x P] matrix).
</p>


<h3>Examples</h3>

<pre><code class="language-R">noiseBG &lt;- noiseBgEffects(N=100, P=20, mean=2)
</code></pre>


</div>