<div class="container">

<table style="width: 100%;"><tr>
<td>pcdtest</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>Tests of cross-section dependence for panel models</h2>

<h3>Description</h3>

<p>Pesaran's CD or Breusch–Pagan's LM (local or global) tests for cross
sectional dependence in panel models
</p>


<h3>Usage</h3>

<pre><code class="language-R">pcdtest(x, ...)

## S3 method for class 'formula'
pcdtest(
  x,
  data,
  index = NULL,
  model = NULL,
  test = c("cd", "sclm", "bcsclm", "lm", "rho", "absrho"),
  w = NULL,
  ...
)

## S3 method for class 'panelmodel'
pcdtest(
  x,
  test = c("cd", "sclm", "bcsclm", "lm", "rho", "absrho"),
  w = NULL,
  ...
)

## S3 method for class 'pseries'
pcdtest(
  x,
  test = c("cd", "sclm", "bcsclm", "lm", "rho", "absrho"),
  w = NULL,
  ...
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>x</code></td>
<td>
<p>an object of class <code>formula</code>, <code>panelmodel</code>, or <code>pseries</code>
(depending on the respective interface) describing the model to
be tested,</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>...</code></td>
<td>
<p>further arguments to be passed on for model estimation to <code>plm</code>,
such as <code>effect</code> or <code>random.method</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>data</code></td>
<td>
<p>a <code>data.frame</code>,</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>index</code></td>
<td>
<p>an optional numerical index, if <code>NULL</code>, the first two
columns of the data.frame provided in argument <code>data</code> are
assumed to be the index variables; for further details see
<code>pdata.frame()</code>,</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>model</code></td>
<td>
<p>an optional character string indicating which type of
model to estimate; if left to <code>NULL</code>, the original
heterogeneous specification of Pesaran is used,</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>test</code></td>
<td>
<p>the type of test statistic to be returned. One of
</p>
 <ul>
<li> <p><code>"cd"</code> for Pesaran's CD statistic, </p>
</li>
<li> <p><code>"lm"</code>
for Breusch and Pagan's original LM statistic, </p>
</li>
<li> <p><code>"sclm"</code>
for the scaled version of Breusch and Pagan's LM statistic,
</p>
</li>
<li> <p><code>"bcsclm"</code> for the bias-corrected scaled version of
Breusch and Pagan's LM statistic, </p>
</li>
<li> <p><code>"rho"</code> for the average
correlation coefficient, </p>
</li>
<li> <p><code>"absrho"</code> for the average
absolute correlation coefficient,</p>
</li>
</ul>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>w</code></td>
<td>
<p>either <code>NULL</code> (default) for the global tests or – for the
local versions of the statistics – a <code style="white-space: pre;">⁠n x n⁠</code> <code>matrix</code>
describing proximity between individuals, with <code class="reqn">w_ij = a</code>
where <code class="reqn">a</code> is any number such that <code>as.logical(a)==TRUE</code>, if
<code class="reqn">i,j</code> are neighbours, <code class="reqn">0</code> or any number <code class="reqn">b</code> such
that <code>as.logical(b)==FALSE</code> elsewhere. Only the lower
triangular part (without diagonal) of <code>w</code> after coercing by
<code>as.logical()</code> is evaluated for neighbouring information (but
<code>w</code> can be symmetric). See also <strong>Details</strong> and
<strong>Examples</strong>,</p>
</td>
</tr>
</table>
<h3>Details</h3>

<p>These tests are originally meant to use the residuals of separate
estimation of one time–series regression for each cross-sectional
unit in order to check for cross–sectional dependence (<code>model = NULL</code>).
If a different model specification (<code>model = "within"</code>, <code>"random"</code>,
...) is assumed consistent, one can resort to its residuals for
testing (which is common, e.g., when the time dimension's length is
insufficient for estimating the heterogeneous model).
</p>
<p>If the time
dimension is insufficient and <code>model = NULL</code>, the function defaults
to estimation of a <code>within</code> model and issues a warning. The main
argument of this function may be either a model of class
<code>panelmodel</code> or a <code>formula</code> and <code style="white-space: pre;">⁠data frame⁠</code>; in the second case,
unless <code>model</code> is set to <code>NULL</code>, all usual parameters relative to
the estimation of a <code>plm</code> model may be passed on. The test is
compatible with any consistent <code>panelmodel</code> for the data at hand,
with any specification of <code>effect</code> (except for <code>test = "bcsclm"</code> which
requires a within model with either individual or two-ways effect).
E.g., specifying  <code>effect = "time"</code> or <code>effect = "twoways"</code> allows
to test for residual cross-sectional dependence after the introduction
of time fixed effects to account for common shocks.
</p>
<p>A <strong>local</strong> version of either test can be computed by supplying a
proximity matrix (elements coercible to <code>logical</code>) with argument
<code>w</code> which provides information on whether any pair of individuals
are neighbours or not. If <code>w</code> is supplied, only neighbouring pairs
will be used in computing the test; else, <code>w</code> will default to
<code>NULL</code> and all observations will be used. The matrix need not be
binary, so commonly used "row–standardized" matrices can be
employed as well. <code>nb</code> objects from <a href="https://CRAN.R-project.org/package=spdep"><span class="pkg">spdep</span></a> must instead be
transformed into matrices by <a href="https://CRAN.R-project.org/package=spdep"><span class="pkg">spdep</span></a>'s function <code>nb2mat</code>
before using.
</p>
<p>The methods implemented are suitable also for unbalanced panels.
</p>
<p>Pesaran's CD test (<code>test="cd"</code>), Breusch and Pagan's LM test
(<code>test="lm"</code>), and its scaled version (<code>test="sclm"</code>) are all
described in Pesaran (2004) (and complemented by
Pesaran (2005)). The bias-corrected scaled test (<code>test="bcsclm"</code>)
is due to (Baltagi et al. 2012) and only valid for
within models including the individual effect (it's unbalanced
version uses max(Tij) for T) in the bias-correction term).
Breusch and Pagan (1980) is the original source for
the LM test.
</p>
<p>The test on a <code>pseries</code> is the same as a test on a pooled
regression model of that variable on a constant, i.e.,
<code>pcdtest(some_pseries)</code> is equivalent to <code style="white-space: pre;">⁠pcdtest(plm(some_var ~ 1, data = some_pdata.frame, model = "pooling")⁠</code> and also equivalent to
<code>pcdtest(some_var ~ 1, data = some_data)</code>, where <code>some_var</code> is
the variable name in the data which corresponds to <code>some_pseries</code>.
</p>


<h3>Value</h3>

<p>An object of class <code>"htest"</code>.
</p>


<h3>References</h3>

<p>Baltagi BH, Feng Q, Kao C (2012).
“A Lagrange Multiplier test for cross-sectional dependence in a fixed effects panel data model.”
<em>Journal of Econometrics</em>, <b>170</b>(1), 164 - 177.
ISSN 0304-4076, <a href="https://www.sciencedirect.com/science/article/pii/S030440761200098X">https://www.sciencedirect.com/science/article/pii/S030440761200098X</a>.
</p>
<p>Breusch TS, Pagan AR (1980).
“The Lagrange Multiplier Test and Its Applications to Model Specification in Econometrics.”
<em>Review of Economic Studies</em>, <b>47</b>, 239–253.
</p>
<p>Pesaran MH (2004).
“General Diagnostic Tests for Cross Section Dependence in Panels.”
CESifo Working Paper Series, 1229.
</p>
<p>Pesaran MH (2015).
“Testing Weak Cross-Sectional Dependence in Large Panels.”
<em>Econometric Reviews</em>, <b>34</b>(6-10), 1089-1117.
<a href="https://doi.org/10.1080/07474938.2014.956623">doi:10.1080/07474938.2014.956623</a>, https://doi.org/10.1080/07474938.2014.956623.
</p>


<h3>Examples</h3>

<pre><code class="language-R">
data("Grunfeld", package = "plm")
## test on heterogeneous model (separate time series regressions)
pcdtest(inv ~ value + capital, data = Grunfeld,
        index = c("firm", "year"))

## test on two-way fixed effects homogeneous model
pcdtest(inv ~ value + capital, data = Grunfeld, model = "within",
        effect = "twoways", index = c("firm", "year"))

## test on panelmodel object
g &lt;- plm(inv ~ value + capital, data = Grunfeld, index = c("firm", "year"))
pcdtest(g)

## scaled LM test
pcdtest(g, test = "sclm")

## test on pseries
pGrunfeld &lt;- pdata.frame(Grunfeld)
pcdtest(pGrunfeld$value)

## local test
## define neighbours for individual 2: 1, 3, 4, 5 in lower triangular matrix
w &lt;- matrix(0, ncol= 10, nrow=10)
w[2,1] &lt;- w[3,2] &lt;- w[4,2] &lt;- w[5,2] &lt;- 1
pcdtest(g, w = w)

</code></pre>


</div>