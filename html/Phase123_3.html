<div class="container">

<table style="width: 100%;"><tr>
<td>PieceMCMC</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>Returns posterior distribution for key mixture model parameters</h2>

<h3>Description</h3>

<p>This function performs MCMC with Metropolis-Hastings-Green steps for the baseline hazard function and is used in the functions Reoptimize, SimPhase123 and SimPhase3.
</p>


<h3>Usage</h3>

<pre><code class="language-R">PieceMCMC(Y, I, YE, YT, Doses, Dose, B, prob, MaxObs)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>Y</code></td>
<td>
<p>Patient survival or followup times.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>I</code></td>
<td>
<p>Patient event indicators.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>YE</code></td>
<td>
<p>Vector of indicators for patient efficacy.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>YT</code></td>
<td>
<p>Vector of indicators for patient toxicity.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>Doses</code></td>
<td>
<p>Vector of standardized doses given to patients.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>Dose</code></td>
<td>
<p>Vector of standardized doses considered in trial.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>B</code></td>
<td>
<p>Number of iterations to perform in MCMC.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>prob</code></td>
<td>
<p>length(Doses) X 4 matrix containing the estimated posterior probabilities for each dose and each (Efficacy, Toxicity) outcomes.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>MaxObs</code></td>
<td>
<p>length(Doses) X 4 matrix containing the maximum observed survival time we want to evaluate the means to.</p>
</td>
</tr>
</table>
<h3>Value</h3>

<p>Returns a list containing a matrix of posterior means for each dose, regression coefficients in the cox models, locations of the split points, log hazard heights on each interval, and the number of intervals in the baseline hazard.
</p>


<h3>Examples</h3>

<pre><code class="language-R">n=100
Y=rexp(n,1)
I = rbinom(n,1,.9)
YE = rbinom(n,1,.5)
YT = rbinom(n,1,.5)
Dose = c(1,2,3,3.5,5)
Dose=(Dose-mean(Dose))/sd(Dose)
Doses = sample(1:5,n,replace=TRUE)
Doses=Dose[Doses]
B=2000
MaxObs = matrix(rep(0,length(Dose)*4),nrow=4)
prob=matrix(rep(0,length(Dose)*4),ncol=4)
prob=prob+1/4
MaxObs=MaxObs+max(Y)
G=PieceMCMC(Y,I,YE,YT,Doses,Dose,B,prob,MaxObs)
</code></pre>


</div>