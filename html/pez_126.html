<div class="container">

<table style="width: 100%;"><tr>
<td>scape</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>Simulate phylogenetic community structure across a landscape</h2>

<h3>Description</h3>

<p><code>scape</code> simulates communities that are phylogenetically structured
</p>


<h3>Usage</h3>

<pre><code class="language-R">scape(
  tree,
  scape.size = 10,
  g.center = 1,
  g.range = 1,
  g.repulse = 1,
  wd.all = 150,
  signal.center = TRUE,
  signal.range = TRUE,
  same.range = TRUE,
  repulse = TRUE,
  center.scale = 1,
  range.scale = 1,
  repulse.scale = 1,
  site.stoch.scale = 0.5,
  sd.center = 1,
  sd.range = 1,
  rho = NULL,
  th = 8
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>tree</code></td>
<td>
<p><code>phylo</code> object</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>scape.size</code></td>
<td>
<p>edge dimension of square landscape</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>g.center</code></td>
<td>
<p>strength of phylogenetic signal in species range centers</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>g.range</code></td>
<td>
<p>strength of phylogenetic signal in species range sizes</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>g.repulse</code></td>
<td>
<p>strength of phylogenetic repulsion</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>wd.all</code></td>
<td>
<p>niche width, larger values simulate broader range sizes</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>signal.center</code></td>
<td>
<p>simulate with phylosignal in range centers</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>signal.range</code></td>
<td>
<p>simulate with phylosignal in range size</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>same.range</code></td>
<td>
<p>make all range sizes equal</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>repulse</code></td>
<td>
<p>include phylogenetic repulsion in range centers</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>center.scale</code></td>
<td>
<p>adjust strength of phylogenetic attraction in
range centers independent of <code>g.center</code></p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>range.scale</code></td>
<td>
<p>adjust strength of phylogenetic signal in range
size independent of <code>g.range</code></p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>repulse.scale</code></td>
<td>
<p>adjust strength of phylogenetic repulsion
independent of <code>g.repulse</code></p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>site.stoch.scale</code></td>
<td>
<p>adjust strength of random variation in
species richness across sites</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>sd.center</code></td>
<td>
<p>sd in <code>rnorm</code> for the range centers,
increase to get more variation in center values across species</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>sd.range</code></td>
<td>
<p>sd <code>rnorm</code> for the range sizes,
increase to get more variation in range sizes across gradients</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>rho</code></td>
<td>
<p>Grafen branch adjustment of phylogenetic tree see
<code>corGrafen</code></p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>th</code></td>
<td>
<p>probability threshold 10^-th above which species are
considered present at a site</p>
</td>
</tr>
</table>
<h3>Details</h3>

<p>Simulates a landscape with species (i.e., tree tips)
distributions dependent on a supplied phylogenetic tree.  The
amount and type of structure is determened by the signal parameters
<code>g.center</code>, <code>g.range</code> and <code>g.repulse</code>. Parameters
are based on an Ornstein-Uhlenbeck model of evolution with
stabilizing selection. Values of g=1 indicate no stabilizing
selection and correspond to the Brownian motion model of evolution;
0&lt;g&lt;1 represents stabilizing selection; and g&gt;1 corresponds to
disruptive selection where phylogenetic signal for the supplied
tree is amplified. See <code>corBlomberg</code>.  Communities are
simulated along two gradients where the positions along those
gradients, <code>g.center</code> and range sizes <code>g.range</code>, can
exhibit phylogenetic signal. Phylogenetic attraction is simulated
in the <code>g.center</code> paramter, while repulsion in
<code>g.repulse</code>. Both can be exhibited such that closly related
species are generally found with similar range centers
(phylogenetic attraction) but just not at the same site
(phylogenetic repulsion).  The function then returns probabilities
of of each species across sites and the presence and absences of
species based a supplied threshold, <code>th</code>, which can be
increased to obtain more species at sites and thus increase average
site species richness.
</p>


<h3>Value</h3>

<table>
<tr style="vertical-align: top;">
<td><code>cc</code></td>
<td>
<p><code>comparative.comm</code> object with presence/absence
results of simulations. The site names are the row.columns of the
cells in the original grid cells that made up the data, and these
co-ordinates are also given in the <code>env</code> slot of the object.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>X.joint</code></td>
<td>
<p>full probabilities of species at sites, used
to construct <code>cc</code></p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>X1</code></td>
<td>
<p>probabilities of species along gradient 1</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>X2</code></td>
<td>
<p>probabilities of species along gradient 2</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>sppXs</code></td>
<td>
<p>full probabilities of each species as an array
arranged in a <code>scape.size</code>-by-<code>scape.size</code> matrix</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>V.phylo</code></td>
<td>
<p>initial phylogenetic covariance matrix from
tree</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>V.phylo.rho</code></td>
<td>
<p>phylogenetic covariance matrix from tree
scaled by Grafen if rho is provided</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>V.center</code></td>
<td>
<p>scaled by <code>g.center</code> phylo covariance
matrix used in the simulations</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>V.range</code></td>
<td>
<p>scaled by <code>g.range</code> phylo covariance
matrix used in the simulations</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>V.repulse</code></td>
<td>
<p>scaled by <code>g.repulse</code> phylo
covariance matrix used in the simulations</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>bspp1</code></td>
<td>
<p>species optima for gradient 1</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>bspp2</code></td>
<td>
<p>species optima for gradient 2</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>u</code></td>
<td>
<p>the env gradients values for the two gradients</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>wd</code></td>
<td>
<p>the denominator for species ranges</p>
</td>
</tr>
</table>
<h3>Author(s)</h3>

<p>M.R. Helmus, cosmetic changes by Will Pearse
</p>


<h3>References</h3>

<p>Helmus M.R. &amp; Ives A.R. (2012). Phylogenetic diversity
area curves. Ecology, 93, S31-S43.
</p>


<h3>See Also</h3>

<p><code>eco.scape</code> <code>sim.phy</code>
<code>sim.meta</code>
</p>


<h3>Examples</h3>

<pre><code class="language-R">#Create balanced tree with equal branch-lengths (signal in centers)
tree &lt;- stree(8,type="balanced")
tree$edge.length &lt;- rep(1, nrow(tree$edge))
tree$root &lt;- 1
kk &lt;- scape(tree, scape.size=100, g.center=100, g.range=1, g.repulse=1, wd.all=150,
    signal.center=TRUE, signal.range=FALSE, same.range=FALSE, repulse=FALSE,center.scale = 1,
    range.scale = 1, repulse.scale = 1, site.stoch.scale = 0, sd.center=3, sd.range=1,
    rho=NULL, th=20)

#Make some plots
par(mfrow=c(1,Ntip(tree)),mar=c(.1,.1,.1,.1))
for(j in seq_along(tree$tip.label))
    image(t(1 - kk$sppXs[,,j]/max(kk$sppXs[,,j])), xlab = "",
              ylab = "",main = "",axes=FALSE, col=grey.colors(10))

par(mfrow=c(2,1))
matplot((kk$X1), type = "l", xlab="gradient",ylab = "probability",
main = "Gradient 1",col=rainbow(dim(kk$X1)[2]),lty=1)
matplot((kk$X2), type = "l", xlab="gradient",ylab = "probability",
main = "Gradient 2",col=rainbow(dim(kk$X2)[2]),lty=1)

plot(x=seq_along(sites(kk$cc)),y = rowSums(comm(kk$cc)), main = "SR",type = "l")
cor(kk$X1)
</code></pre>


</div>