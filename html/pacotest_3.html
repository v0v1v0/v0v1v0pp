<div class="container">

<table style="width: 100%;"><tr>
<td>pacotestRvineSeq</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>
Sequentially Testing the Simplifying Assumption for R-Vine Copulas
</h2>

<h3>Description</h3>

<p>The function can be used to test the simplifying assumption for R-vine copulas in a sequential manner. Each pair-copula from the second tree on is tested to be a (j-1)-th order partial copula. To apply the function one needs to provide the data and a specified/estimated R-vine copula model in form of a RVineMatrix from the VineCopula-package. Additionally, a pacotest options list, which can be generated with the <code>pacotestset</code> function, needs to be provided.
</p>


<h3>Usage</h3>

<pre><code class="language-R">pacotestRvineSeq(data, RVM, pacotestOptions,
  level = 0.05, illustration = 2, stopIfRejected = TRUE)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>data</code></td>
<td>

<p>A (n x d) matrix (or data frame) of [0,1] data (i.e. uniform margins).
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>RVM</code></td>
<td>

<p>An RVineMatrix object (VineCopula-package) which includes the structure, the pair-copula families and parameters of an R-vine copula.
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>pacotestOptions</code></td>
<td>

<p>A options list generated by the <code>pacotestset</code> function or the test type as string, i.e., <code>CCC</code> or <code>VI</code>.
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>level</code></td>
<td>

<p>The level of the test.
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>illustration</code></td>
<td>

<p>Either 1 or 2. If illustration = 1, the p-value for each test for a (j-1)-th order partial copula is displayed. If illustration = 2, a progress information is displayed for each tree. It consists of the individual test level and the number of H0 rejections.
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>stopIfRejected</code></td>
<td>

<p>A logical variable indicating whether the sequential test procedure should be stopped in the first tree where an H0 for one of the conditional copulas is rejected.
</p>
</td>
</tr>
</table>
<h3>Value</h3>

<p>A list consisting of the following elements:
</p>
<table>
<tr style="vertical-align: top;">
<td><code>pacotestResultLists</code></td>
<td>

<p>A matrix in the same structure like the <code>Matrix</code>, <code>family</code>, <code>par</code>, etc. entries in the RVineMatrix object from the VineCopula-package. Each entry of the matrix is a list containing the test result from a test for a (j-1)-th order partial copula obtained from a call to <code>pacotest</code>. Depending on the chosen test, it could consist of different elements. A documentation of the <code>pacotestResultLists</code> can be found in the documentation of <code>pacotest</code>.
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>pValues</code></td>
<td>

<p>A matrix in the same structure like the <code>Matrix</code>, <code>family</code>, <code>par</code>, etc. entries in the RVineMatrix object from the VineCopula-package. Each entry of the matrix is a p-value corresponding to the test result from a test for a (j-1)-th order partial copula.
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>testResultSummary</code></td>
<td>

<p>A data.frame summarizing the test results.
The first column, <code>Tree</code>, is the tree number.
The second column, <code>NumbOfRejections</code>, is the number of of rejections in the corresponding tree.
The third column, <code>IndividualTestLevel</code>, is the level at which each individual test has been performed.
The fourth column, <code>Interpretation</code>, provides an interpretation of the test result.
</p>
</td>
</tr>
</table>
<h3>Author(s)</h3>

<p>Malte S. Kurz
</p>


<h3>References</h3>

<p>Kurz, M. S. and F. Spanhel (2022), "Testing the simplifying assumption in high-dimensional vine copulas", Electronic Journal of Statistics 16 (2), pp. 5226-5276.
</p>
<p>Spanhel, F. and M. S. Kurz (2019), "Simplified vine copula models: Approximations based on the simplifying assumption", Electronic Journal of Statistics 13 (1), pp. 1254-1291.
</p>


<h3>See Also</h3>

<p><code>pacotest-package</code>, <code>pacotest</code>, <code>pacotestset</code>, <code>pacotestRvineSingleCopula</code>
</p>


<h3>Examples</h3>

<pre><code class="language-R"># Sample data and R-vine copula selection are taken
# from the documentation of RVineStructureSelect
# of the VineCopula package.

# Obtain sample data
data(daxreturns, package ="VineCopula")
dataSet = daxreturns[1:750,1:4]

# Specify an R-vine copula model
# (can be obtained by calling: RVM = VineCopula::RVineStructureSelect(dataSet))
vineStructure = matrix(c(3,4,1,2,0,2,4,1,0,0,1,4,0,0,0,4),4,4)
families = matrix(c(0,5,2,2,0,0,2,14,0,0,0,14,0,0,0,0),4,4)
par = matrix(c(0,0.8230664,0.1933472,0.6275062,
             0,0,0.2350109,1.6619945,
             0,0,0,1.599363,
             0,0,0,0),4,4)
par2 = matrix(c(0,0,11.757700,4.547847,
             0,0,17.15717,0,
             0,0,0,0,0,0,0,0),4,4)
RVM = VineCopula::RVineMatrix(vineStructure, families, par, par2)


# Specify a pacotestOptions list:
pacotestOptions = pacotestset('CCC')

# Test for the simplifying assumption.
pacotestResultList = pacotestRvineSeq(dataSet, RVM,
                                      pacotestOptions)
</code></pre>


</div>