<div class="container">

<table style="width: 100%;"><tr>
<td>parSeqSimDisk</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>Parallel Protein Sequence Similarity Calculation Based on
Sequence Alignment (Disk-Based Version)</h2>

<h3>Description</h3>

<p>Parallel calculation of protein sequence similarity based on
sequence alignment.
This version offloads the partial results in each batch to the
hard drive and merges the results together in the end, which
reduces the memory usage.
</p>


<h3>Usage</h3>

<pre><code class="language-R">parSeqSimDisk(
  protlist,
  cores = 2,
  batches = 1,
  path = tempdir(),
  verbose = FALSE,
  type = "local",
  submat = "BLOSUM62",
  gap.opening = 10,
  gap.extension = 4
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>protlist</code></td>
<td>
<p>A length <code>n</code> list containing <code>n</code> protein sequences,
each component of the list is a character string, storing one protein
sequence. Unknown sequences should be represented as <code>""</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>cores</code></td>
<td>
<p>Integer. The number of CPU cores to use for parallel execution,
default is <code>2</code>. Users can use the <code>availableCores()</code> function
in the parallelly package to see how many cores they could use.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>batches</code></td>
<td>
<p>Integer. How many batches should we split the pairwise
similarity computations into. This is useful when you have a large
number of protein sequences, enough number of CPU cores, but not
enough RAM to compute and fit all the pairwise similarities
into a single batch. Defaults to 1.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>path</code></td>
<td>
<p>Directory for caching the results in each batch.
Defaults to the temporary directory.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>verbose</code></td>
<td>
<p>Print the computation progress?
Useful when <code>batches &gt; 1</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>type</code></td>
<td>
<p>Type of alignment, default is <code>"local"</code>,
can be <code>"global"</code> or <code>"local"</code>,
where <code>"global"</code> represents Needleman-Wunsch global alignment;
<code>"local"</code> represents Smith-Waterman local alignment.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>submat</code></td>
<td>
<p>Substitution matrix, default is <code>"BLOSUM62"</code>,
can be one of <code>"BLOSUM45"</code>, <code>"BLOSUM50"</code>, <code>"BLOSUM62"</code>,
<code>"BLOSUM80"</code>, <code>"BLOSUM100"</code>, <code>"PAM30"</code>,
<code>"PAM40"</code>, <code>"PAM70"</code>, <code>"PAM120"</code>, or <code>"PAM250"</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>gap.opening</code></td>
<td>
<p>The cost required to open a gap of any length
in the alignment. Defaults to 10.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>gap.extension</code></td>
<td>
<p>The cost to extend the length of an existing
gap by 1. Defaults to 4.</p>
</td>
</tr>
</table>
<h3>Value</h3>

<p>A <code>n</code> x <code>n</code> similarity matrix.
</p>


<h3>Author(s)</h3>

<p>Nan Xiao &lt;<a href="https://nanx.me">https://nanx.me</a>&gt;
</p>


<h3>See Also</h3>

<p>See <code>parSeqSim</code> for the in-memory version.
</p>


<h3>Examples</h3>

<pre><code class="language-R">## Not run: 

# Be careful when testing this since it involves parallelization
# and might produce unpredictable results in some environments

library("Biostrings")
library("foreach")
library("doParallel")

s1 &lt;- readFASTA(system.file("protseq/P00750.fasta", package = "protr"))[[1]]
s2 &lt;- readFASTA(system.file("protseq/P08218.fasta", package = "protr"))[[1]]
s3 &lt;- readFASTA(system.file("protseq/P10323.fasta", package = "protr"))[[1]]
s4 &lt;- readFASTA(system.file("protseq/P20160.fasta", package = "protr"))[[1]]
s5 &lt;- readFASTA(system.file("protseq/Q9NZP8.fasta", package = "protr"))[[1]]
set.seed(1010)
plist &lt;- as.list(c(s1, s2, s3, s4, s5)[sample(1:5, 100, replace = TRUE)])
psimmat &lt;- parSeqSimDisk(
  plist,
  cores = 2, batches = 10, verbose = TRUE,
  type = "local", submat = "BLOSUM62"
)

## End(Not run)
</code></pre>


</div>