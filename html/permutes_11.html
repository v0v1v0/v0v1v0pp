<div class="container">

<table style="width: 100%;"><tr>
<td>perm.lmer</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>A general permutation test for mixed-effects models or other <code>buildmer</code> models.</h2>

<h3>Description</h3>

<p>A general permutation test for mixed-effects models or other <code>buildmer</code> models.
</p>


<h3>Usage</h3>

<pre><code class="language-R">perm.lmer(
  formula,
  data = NULL,
  family = gaussian(),
  weights = NULL,
  offset = NULL,
  buildmerControl = list(direction = "order", crit = "LRT", quiet = TRUE, ddf = "lme4"),
  nperm = 1000,
  type = "regression",
  progress = TRUE
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>formula</code></td>
<td>
<p>A normal formula, possibly using <code>lme4</code>-style random effects. This can also be a buildmer terms object, provided <code>dep</code> is passed in <code>buildmerControl</code>. Only a single response variable is supported. For binomial models, the <code>cbind</code> syntax is not supported; please convert your dependent variable to a proportion and use weights instead.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>data</code></td>
<td>
<p>The data.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>family</code></td>
<td>
<p>The family.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>weights</code></td>
<td>
<p>An optional vector of prior case weights. This vector is evaluated in the calling environment, not in the formula or data frame!</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>offset</code></td>
<td>
<p>An optional vector containing a prior offset term. This vector is evaluated in the calling environment, not in the formula or data frame!</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>buildmerControl</code></td>
<td>
<p>Options overriding the defaults in <code>buildmerControl</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>nperm</code></td>
<td>
<p>The number of permutations.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>type</code></td>
<td>
<p>A character string of either <code>'anova'</code> or <code>'regression'</code>. The former runs an analysis of variance and returns F-values and p-values based on the explained variance of each factor in the design. The latter runs a linear-regression analysis and returns t-values and p-values based on individual effects. When running ANOVA, it is advised to use orthogonal predictors, as type III sums of squares are used.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>progress</code></td>
<td>
<p>Logical indicating whether to print progress messages during the permutation testing.</p>
</td>
</tr>
</table>
<h3>Details</h3>

<p>If not explicitly overridden in the <code>buildmerControl</code> argument, the function changes a few buildmer defaults to make more sense for permutation testing. This includes setting <code>direction='order'</code> and <code>quiet=TRUE</code>. Set these options explicitly to override this behavior.
Because model comparisons are used for efficient permutation testing, REML is not supported.
Omega squared is not available for mixed-effects ANOVA; the <code>w2</code> column will not be included in the resulting <code>permutes</code> object.
The returned object provides the raw bootstrap samples in the <code>pb</code> attribute. These are used to compute a corrected p-value using Maris &amp; Oostenveld's (2007) cluster mass statistic, but can also be used by the user to compute other such statistics. These obviously significantly increase the size of the R object; if this becomes a problem, there is no harm in deleting them using e.g. <code>attr(x,'perms') &lt;- NULL</code>.
</p>


<h3>Value</h3>

<p>A data frame.
</p>


<h3>Examples</h3>

<pre><code class="language-R">
# Testing a single EEG electrode, with random effects by participants
perms &lt;- perm.lmer(Fz ~ Deviant * Session + (Deviant * Session | Subject),
                   data=MMN[MMN$Time &gt; 150 &amp; MMN$Time &lt; 250,])
# Testing a single EEG electrode, with random effects by participants, ANOVA inference
perms &lt;- perm.lmer(Fz ~ Deviant * Session + (Deviant * Session | Subject),
                   data=MMN[MMN$Time &gt; 150 &amp; MMN$Time &lt; 250,],type='anova')


</code></pre>


</div>