<div class="container">

<table style="width: 100%;"><tr>
<td>pis.fit</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>Estimating the incubation period distribution of a post-infectious syndrome</h2>

<h3>Description</h3>

<p>This function estimates the incubation period distribution of a post-infectious syndrome with maximum likelihood estimation. The incubation period distribution of the antecedent infection and the post-infectious syndrome are allowed to be lognormal ("<code>LN</code>"), Weibull ("<code>WB</code>") or gamma ("<code>GM</code>") distributed. The data set is allowed to have cases with the actecedent diseases whose incuation periods come from different distributions (see Examples).
</p>


<h3>Usage</h3>

<pre><code class="language-R">pis.fit(data,postinfect=c("LN","WB","GM"),theta)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>data</code></td>
<td>
<p>A data.frame containing at least 4 columns. The first two columns represent (1) the time between the symptom onset of the antecedent infection and post-infectious syndrome and (2) the incubation period distribution of the antecedent infection (only "<code>LN</code>", "<code>WB</code>" and "<code>GM</code>"). The last two columns refer to the parameters of the incubation period distribution of the antecedent infection; for "<code>LN</code>", they are <code>meanlog</code> and <code>sdlog</code> as in <code>dlnorm</code>; for "<code>WB</code>", they are <code>shape</code> and <code>scale</code> as in <code>dweibull</code>; for "<code>GM</code>", they are <code>shape</code> and <code>rate</code> as in <code>dgamma</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>postinfect</code></td>
<td>
<p>The incubation period distribution of the post-infectious disease. It can only be "<code>LN</code>", "<code>WB</code>" and "<code>GM</code>".</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>theta</code></td>
<td>
<p>A vector of two numbers as the initial value for optimisation.</p>
</td>
</tr>
</table>
<h3>Details</h3>

<p>For each observed case, let <code class="reqn">S_{0}</code> and <code class="reqn">S</code> be the incubation period of the antecedent infection and post-infectious syndrome, respectively. As the antecedent infection is the antigenic factor of the post-infectious syndrome, they both share the same time of infection exposure. The difference between <code class="reqn">S_{0}</code> and <code class="reqn">S</code>, denoted by <code class="reqn">X</code>, is the time between the two symptom onsets. Also let <code class="reqn">\theta_{0}</code> and <code class="reqn">\theta</code> be the set of the parameters of the distribution of <code class="reqn">S_{0}</code> and <code class="reqn">S</code> then the likelihood of such observed case is given by,
</p>
<p style="text-align: center;"><code class="reqn">\int_{-\infty}^{\infty}f_0(S_0,\theta_0)f(S_0+X,\theta)dS_0</code>
</p>

<p>where <code class="reqn">f_0</code> and <code class="reqn">f</code> are the probability density function of <code class="reqn">S_{0}</code> and <code class="reqn">S</code>, respectively. <code class="reqn">\theta</code> is then estimated by maximising the sum of likelihood of all observed cases.
</p>


<h3>Value</h3>

<table>
<tr style="vertical-align: top;">
<td><code>Parameter</code></td>
<td>
<p>Estimates of the parameters of the incubation period distribution of the post-infectious syndrome.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>SE</code></td>
<td>
<p>Standard errors of <code>Parameter</code></p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>AIC</code></td>
<td>
<p>Akaike Information Criterion.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>Convergence</code></td>
<td>
<p>The convergence message of <code>optim</code></p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>Median</code></td>
<td>
<p>The median incubation period distribution of the post-infectious syndrome.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>Theta.initial</code></td>
<td>
<p>Initial values used in <code>optim</code></p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>Distribution</code></td>
<td>
<p>The Distribution assumed in the estimation, i.e. "<code>LN</code>", "<code>WB</code>" or "<code>GM</code>".</p>
</td>
</tr>
</table>
<h3>Author(s)</h3>

<p>Char Leung</p>


<h3>Examples</h3>

<pre><code class="language-R">#generate artificial data
S&lt;-c(56,37,32,7,8,3,5)
S0&lt;-c(2,1,3,1,1,1,3)
X&lt;-S-S0
f0&lt;-c(rep("LN",4),rep("WB",3))
phi&lt;-matrix(c(rep(c(0,1),4),rep(c(1,2),3)),byrow=TRUE,ncol=2)
data&lt;-data.frame(X,f0,phi)
pis.fit(data,"LN",theta=c(2.5,1))
</code></pre>


</div>