<div class="container">

<table style="width: 100%;"><tr>
<td>predkmeans</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>Predictive K-means Clustering</h2>

<h3>Description</h3>

<p>Uses a Mixture-of-experts algorithm to find 
cluster centers that are influenced by prediction covariates.
</p>


<h3>Usage</h3>

<pre><code class="language-R">predkmeans(
  X,
  R,
  K,
  mu = NULL,
  muStart = c("kmeans", "random"),
  sigma2 = 0,
  sigma2fixed = FALSE,
  maxitEM = 100,
  tol = 1e-05,
  convEM = c("both", "mu", "gamma"),
  nStarts = 1,
  maxitMlogit = 500,
  verbose = 0,
  muRestart = 1000,
  returnAll = FALSE,
  ...
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>X</code></td>
<td>
<p>An <code>n</code> by <code>p</code> matrix or data frame of data to be clustered.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>R</code></td>
<td>
<p>Covariates used for clustering. Required unless doing k-means
clustering (i.e. <code>sigma2=0</code> and <code>sigma2fixed=TRUE</code>).</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>K</code></td>
<td>
<p>Number of clusters</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>mu</code></td>
<td>
<p>starting values for cluster centers. If NULL (default), 
then value is chosen according to <code>muStart</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>muStart</code></td>
<td>
<p>Character string indicating how initial value
of mu should be selected. Only used if mu=NULL.  Possible
values are <code>"random"</code> or <code>"kmeans"</code> (default).</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>sigma2</code></td>
<td>
<p>starting value of sigma2. If set to <code>0</code> and
<code>sigma2fixed=TRUE</code>, the standard k-means is done
instead of predictive k-means.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>sigma2fixed</code></td>
<td>
<p>Logical indicating whether sigma2
should be held fixed.  If FALSE, then
sigma2 is estimated using Maximum Likelihood.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>maxitEM</code></td>
<td>
<p>Maximum number of EM iterations for
finding the Mixture of Experts solution. If doing regular
k-means, this is passed as <code>iter.max</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>tol</code></td>
<td>
<p>convergence criterion</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>convEM</code></td>
<td>
<p>controls the measure of convergence for the 
EM algorithm.  Should be one of "mu", "gamma", or
"both".  Defaults to "both."  The EM algorithm 
stops when the Frobenius norm of the change in mu,
the change in gamma, or the change in mu and the change in gamma
is less than 'tol'.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>nStarts</code></td>
<td>
<p>number of times to perform EM algorithm</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>maxitMlogit</code></td>
<td>
<p>Maximum number of iterations in the
mlogit optimization (nested within EM algorithm)</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>verbose</code></td>
<td>
<p>numeric vector indicating how much output to produce</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>muRestart</code></td>
<td>
<p>Gives max number of attempts at picking
starting values. Only used when muStart='random'.
If selected starting values for mu are constant
within each cluster, then the starting values
are re-selected up to muRestart times.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>returnAll</code></td>
<td>
<p>A list containing all <code>nStarts</code> solutions is
included in the output.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>...</code></td>
<td>
<p>Additional arguments passed to <code>mlogit</code></p>
</td>
</tr>
</table>
<h3>Details</h3>

<p>A thorough description of this method is provided in Keller et al. (2017).
The algorithm for sovling the mixture of Experts model is 
based upon the approach presented by Jordan and Jacobs (1994). 
</p>
<p>If <code>sigma2</code> is 0 and <code>sigm2fixed</code> is TRUE, then standard k-means clustering (using <code>kmeans</code>) is done instead.
</p>


<h3>Value</h3>

<p>An object of class <code>predkmeans</code>, containing the following elements:
</p>
<table>
<tr style="vertical-align: top;">
<td><code>res.best</code></td>
<td>
<p>A list containing the results from the best-fitting solution to the Mixture of Experts problem: 
</p>

<dl>
<dt>mu</dt>
<dd>
<p>Maximum-likelihood estimate of intercepts from normal mixture model. These are the cluster centers.</p>
</dd>
<dt>gamma</dt>
<dd>
<p>Maximum-likelihood estimates of the mixture coefficeints.</p>
</dd>
<dt>sigma2</dt>
<dd>
<p>If <code>sigma2fixed=FALSE</code>, the maximum likelihood estimate of <code>sigma2</code></p>
</dd>
<dt>conv</dt>
<dd>
<p>Indicator of covergence.</p>
</dd>
<dt>objective</dt>
<dd>
<p>Value of the log-likelihood.</p>
</dd>
<dt>iter</dt>
<dd>
<p>Number of iterations.</p>
</dd>
<dt>mfit</dt>
<dd>
<p>A subset of output from <code>mlogit</code>.</p>
</dd>
</dl>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>center</code></td>
<td>
<p>Matrix of cluster centers</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>cluster</code></td>
<td>
<p>Vector of cluster labels assigned to observations</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>K</code></td>
<td>
<p>Number of clusters</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>sigma2</code></td>
<td>
<p>Final value of sigma^2.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>wSS</code></td>
<td>
<p>Mean within-cluster sum-of-squares</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>sigma2fixed</code></td>
<td>
<p>Logical indicator of whether sigma2 was held fixed</p>
</td>
</tr>
</table>
<h3>Author(s)</h3>

<p>Joshua Keller
</p>


<h3>References</h3>

<p>Keller, J.P., Drton, M., Larson, T., Kaufman, J.D., Sandler, D.P., and Szpiro, A.A. (2017). Covariate-adaptive clustering of exposures for air pollution epidemiology cohorts. <em>Annals of Applied Statistics</em>, 11(1):93â€“113.
</p>
<p>Jordan M. and Jacobs R. (1994). Hierarchical mixtures of
experts and the EM algorithm. <em>Neural computation 6</em>(2),
181-214.
</p>


<h3>See Also</h3>

<p><code>predictML.predkmeans, predkmeansCVest</code>
</p>


<h3>Examples</h3>

<pre><code class="language-R">n &lt;- 200
r1 &lt;- rnorm(n)
r2 &lt;- rnorm(n)
u1 &lt;- rbinom(n, size=1,prob=0)
cluster &lt;- ifelse(r1&lt;0, ifelse(u1, "A", "B"), ifelse(r2&lt;0, "C", "D"))
mu1 &lt;- c(A=2, B=2, C=-2, D=-2)
mu2 &lt;- c(A=1, B=-1, C=-1, D=-1)
x1 &lt;- rnorm(n, mu1[cluster], 4)
x2 &lt;- rnorm(n, mu2[cluster], 4)
R &lt;- model.matrix(~r1 + r2)
X &lt;- cbind(x1, x2)
pkm &lt;- predkmeans(X=cbind(x1, x2), R=R, K=4)
summary(pkm)
</code></pre>


</div>