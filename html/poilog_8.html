<div class="container">

<table style="width: 100%;"><tr>
<td>Poisson lognormal</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2> Poisson lognormal distribution </h2>

<h3>Description</h3>

<p>Density and random generation for the Poisson lognormal distribution with parameters <code>mu</code> and <code>sig</code>.
</p>


<h3>Usage</h3>

<pre><code class="language-R">dpoilog(n, mu, sig)
rpoilog(S, mu, sig, nu=1, condS=FALSE, keep0=FALSE)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>n</code></td>
<td>
<p> vector of observed individuals for each species </p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>S</code></td>
<td>
<p> number of species in the community </p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>mu</code></td>
<td>
<p> mean of lognormal distribution  </p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>sig</code></td>
<td>
<p> standard deviation of lognormal distribution </p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>nu</code></td>
<td>
<p> sampling intensity, defaults to 1 </p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>condS</code></td>
<td>
<p> logical; if TRUE random deviates are conditional on S</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>keep0</code></td>
<td>
<p> logical; if TRUE species with count 0 are included in the random deviates </p>
</td>
</tr>
</table>
<h3>Details</h3>

<p>The following is written from the perspective of using the Poisson lognormal distribution 
to describe community structure (the distribution of species when sampling individuals 
from a community of several species). 
</p>
<p>Under the assumption of random sampling, the number of individuals sampled from a given 
species with abundance <em>y</em>, say <em>N</em>, is Poisson distributed with mean <code class="reqn">\code{nu}\,y</code> 
where the parameter <code>nu</code> expresses the sampling intensity. If ln <em>y</em> is normally distributed 
with mean <code>mu</code> and standard deviation <code>sig</code> among species, then the vector of individuals sampled 
from all <code>S</code> species then constitutes a sample from the Poisson lognormal distribution
with parameters (<code>mu</code> + ln <code>nu</code>, <code>sig</code>), where <code>mu</code> and <code>sig</code> 
are the mean and standard deviation of the log abundances. For <code>nu</code> = 1, this is the Poisson 
lognormal distribution with parameters (<code>mu</code>,<code>sig</code>) which may be written in the form
</p>
<p style="text-align: center;"><code class="reqn">P(N=\code{n};\code{mu},\code{sig}) = q(\code{n};\code{mu},\code{sig}) = \int\limits_{-\infty}^{\infty} g_\code{n}(\code{mu},\code{sig},u)\phi(u)\;du,</code>
</p>

<p>where <code class="reqn">\phi(u)</code> is the standard normal distribution and
</p>
<p style="text-align: center;"><code class="reqn">g_\code{n}(\code{mu},\code{sig},u) = \frac{\exp(u\,\code{sig}\,\code{n} + \code{mu}\,\code{n} - \exp(u\,\code{sig} + \code{mu}))}{\code{n}!}</code>
</p>
 
<p>Since <code>S</code> is usually unknown, we only consider the observed number of individuals for the observed species.
With a general sampling intensity <code>nu</code>, the distribution of the number of individuals then follows the
zero-truncated Poisson lognormal distribution
</p>
<p style="text-align: center;"><code class="reqn">\frac{q(\code{n};\code{mu},\code{sig})}{1-q(0;\code{mu},\code{sig})}</code>
</p>



<h3>Value</h3>

<p><code>dpoilog</code> returns the density<br><code>rpoilog</code> returns random deviates
</p>


<h3>Author(s)</h3>

<p> Vidar Grotan <a href="mailto:vidar.grotan@ntnu.no">vidar.grotan@ntnu.no</a> and Steinar Engen   </p>


<h3>References</h3>

<p> Engen, S., R. Lande, T. Walla &amp; P. J. DeVries. 2002. Analyzing spatial structure of communities using the two-dimensional 
Poisson lognormal species abundance model. American Naturalist 160: 60-73.
</p>


<h3>See Also</h3>

<p><code>poilogMLE</code> for ML estimation</p>


<h3>Examples</h3>

<pre><code class="language-R">
### plot density for given parameters 
barplot(dpoilog(n=0:20,mu=2,sig=1),names.arg=0:20)

### draw random deviates from a community of 50 species 
rpoilog(S=50,mu=2,sig=1)

### draw random deviates including zeros 
rpoilog(S=50,mu=2,sig=1,keep0=TRUE)

### draw random deviates with sampling intensity = 0.5 
rpoilog(S=50,mu=2,sig=1,nu=0.5)

### how many species are likely to be observed 
### (given S,mu,sig2 and nu)? 
hist(replicate(1000,length(rpoilog(S=30,mu=0,sig=3,nu=0.7))))

### how many individuals are likely to be observed
### (given S,mu,sig2 and nu)? 
hist(replicate(1000,sum(rpoilog(S=30,mu=0,sig=3,nu=0.7))))


</code></pre>


</div>