<div class="container">

<table style="width: 100%;"><tr>
<td>powerCT.default</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2> Power Calculation in the Analysis of Survival Data for Clinical Trials </h2>

<h3>Description</h3>

<p>Power calculation for the Comparison of Survival Curves Between Two Groups under
the Cox Proportional-Hazards Model for clinical trials.
</p>


<h3>Usage</h3>

<pre><code class="language-R">powerCT.default(nE, 
		nC, 
		pE, 
		pC, 
		RR, 
		alpha = 0.05)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>nE</code></td>
<td>
<p>integer. number of participants in the experimental group. </p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>nC</code></td>
<td>
<p>integer. number of participants in the control group. </p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>pE</code></td>
<td>
<p>numeric. probability of failure in group E (experimental group) over the maximum time period of the study (t years). </p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>pC</code></td>
<td>
<p>numeric. probability of failure in group C (control group) over the maximum time period of the study (t years). </p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>RR</code></td>
<td>
<p>numeric. postulated hazard ratio.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>alpha</code></td>
<td>
<p>numeric. type I error rate. </p>
</td>
</tr>
</table>
<h3>Details</h3>

<p>This is an implementation of the power calculation method described in Section 14.12 (page 807)
of Rosner (2006). The method was proposed by Freedman (1982).
</p>
<p>Suppose we want to compare the survival curves between an experimental group (<code class="reqn">E</code>) and 
a control group (<code class="reqn">C</code>) in a clinical trial with a maximum follow-up of <code class="reqn">t</code> years. 
The Cox proportional hazards regression model is assumed to have the form:
</p>
<p style="text-align: center;"><code class="reqn">h(t|X_1)=h_0(t)\exp(\beta_1 X_1).</code>
</p>

<p>Let <code class="reqn">n_E</code> be the number of participants in the <code class="reqn">E</code> group
and <code class="reqn">n_C</code> be the number of participants in the <code class="reqn">C</code> group.  
We wish to test the hypothesis <code class="reqn">H0: RR=1</code> versus <code class="reqn">H1: RR</code> not equal to 1, 
where <code class="reqn">RR=\exp(\beta_1)=</code>underlying hazard ratio
for the <code class="reqn">E</code> group versus the <code class="reqn">C</code> group. Let <code class="reqn">RR</code> be the postulated hazard ratio,
<code class="reqn">\alpha</code> be the significance level. Assume that the test is a two-sided test.
If the ratio of participants in group 
E compared to group C <code class="reqn">= n_E/n_C=k</code>, then the power of the test is
</p>
<p style="text-align: center;"><code class="reqn">power=\Phi(\sqrt{k*m}*|RR-1|/(k*RR+1)-z_{1-\alpha/2}),</code>
</p>
 
<p>where </p>
<p style="text-align: center;"><code class="reqn">m=n_E p_E+n_C p_C,</code>
</p>
 
<p>and <code class="reqn">z_{1-\alpha/2}</code> 
is the <code class="reqn">100 (1-\alpha/2)</code>-th percentile of
the standard normal distribution <code class="reqn">N(0, 1)</code>, <code class="reqn">\Phi</code> is the cumulative distribution function (CDF) 
of <code class="reqn">N(0, 1)</code>.
</p>


<h3>Value</h3>

<p>The power of the test.
</p>


<h3>Note</h3>

 
<p>The power formula assumes that the central-limit theorem is valid and hence is appropriate for large samples.
</p>


<h3>References</h3>

 
<p>Freedman, L.S. (1982). 
Tables of the number of patients required in clinical trials using the log-rank test. 
<em>Statistics in Medicine</em>. 1: 121-129
</p>
<p>Rosner B. (2006).
<em>Fundamentals of Biostatistics</em>. (6-th edition). Thomson Brooks/Cole.
</p>


<h3>See Also</h3>

 <p><code>powerCT.default0</code>, 
<code>powerCT</code> </p>


<h3>Examples</h3>

<pre><code class="language-R">  # Example 14.42 in Rosner B. Fundamentals of Biostatistics. 
  # (6-th edition). (2006) page 809
  powerCT.default(nE = 200, 
		  nC = 200, 
		  pE = 0.3707, 
		  pC = 0.4890, 
                  RR = 0.7, 
		  alpha = 0.05)
</code></pre>


</div>