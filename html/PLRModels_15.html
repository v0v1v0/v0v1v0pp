<div class="container">

<table style="width: 100%;"><tr>
<td>par.gof</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>
Goodness-of-Fit tests in linear regression models
</h2>

<h3>Description</h3>

<p>This routine tests the equality of the vector of coefficients, <code class="reqn">\beta</code>, in a linear regression model and a given parameter vector, <code class="reqn">\beta_0</code>, from a sample <code class="reqn">{(Y_i, X_{i1},...,X_{ip}): i=1,...,n}</code>, where:
</p>
<p style="text-align: center;"><code class="reqn">\beta = (\beta_1,...,\beta_p)</code>
</p>

<p>is an unknown vector parameter and
</p>
<p style="text-align: center;"><code class="reqn">Y_i = X_{i1}*\beta_1+ ... + X_{ip}*\beta_p + \epsilon_i.</code>
</p>

<p>The random errors, <code class="reqn">\epsilon_i</code>, are allowed to be time series. The test statistic used for testing the null hypothesis, <code class="reqn">H0: \beta = \beta_0</code>, derives from the asymptotic normality of the ordinary least squares estimator of <code class="reqn">\beta</code>, this result giving a <code class="reqn">\chi^2</code>-test.
</p>


<h3>Usage</h3>

<pre><code class="language-R">par.gof(data = data, beta0 = NULL, time.series = FALSE, 
Var.Cov.eps = NULL, p.max = 3, q.max = 3, ic = "BIC", 
num.lb = 10, alpha = 0.05)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>data</code></td>
<td>

<p><code>data[, 1]</code> contains the values of the response variable, <code class="reqn">Y</code>;
</p>
<p><code>data[, 2:(p+1)]</code> contains the values of the explanatory variables, <code class="reqn">X_1, ..., X_p</code>.
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>beta0</code></td>
<td>
<p>the considered parameter vector in the null hypothesis. If <code>NULL</code> (the default), the zero vector is considered.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>time.series</code></td>
<td>
<p>it denotes whether the data are independent (FALSE) or if data is a time series (TRUE). The default is FALSE.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>Var.Cov.eps</code></td>
<td>
 <p><code>n x n</code> matrix of variances-covariances associated to the random errors of the regression model. If NULL (the default), the function tries to estimate it: it fits an ARMA model (selected according to an information criterium) to the residuals from the fitted linear regression model and, then, it obtains the var-cov matrix of such ARMA model.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>p.max</code></td>
<td>
<p>if <code>Var.Cov.eps=NULL</code>, the ARMA model is selected between the models ARMA(p,q) with 0&lt;=p&lt;=<code>p.max</code> and 0&lt;=q&lt;=<code>q.max</code>. The default is 3.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>q.max</code></td>
<td>
<p>if <code>Var.Cov.eps=NULL</code>, the ARMA model is selected between the models ARMA(p,q) with 0&lt;=p&lt;=<code>p.max</code> and 0&lt;=q&lt;=<code>q.max</code>. The default is 3.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>ic</code></td>
<td>
<p>if <code>Var.Cov.eps=NULL</code>, <code>ic</code> contains the information criterion used to suggest the ARMA model. It allows us to choose between: "AIC", "AICC" or "BIC" (the default).</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>num.lb</code></td>
<td>
<p>if <code>Var.Cov.eps=NULL</code>, it checks the suitability of the selected ARMA model according to the Ljung-Box test and the t-test. It uses up to <code>num.lb</code> delays in the Ljung-Box test. The default is 10.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>alpha</code></td>
<td>
<p>if <code>Var.Cov.eps=NULL</code>, <code>alpha</code> contains the significance level which the ARMA model is checked. The default is 0.05.</p>
</td>
</tr>
</table>
<h3>Details</h3>

<p>If <code>Var.Cov.eps=NULL</code> and the routine is not able to suggest an approximation for <code>Var.Cov.eps</code>, it warns the user with a message saying that the model could be not appropriate and then it shows the results. In order to construct <code>Var.Cov.eps</code>, the procedure suggested in Domowitz (1982) can be followed.
</p>
<p>The implemented procedure particularizes the parametric test in the routine <code>plrm.gof</code> to the case where is known that the nonparametric component in the corresponding PLR model is null.
</p>


<h3>Value</h3>

<p>A list with a dataframe containing:
</p>
<table>
<tr style="vertical-align: top;">
<td><code>Q.beta</code></td>
<td>
<p>value of the test statistic.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>p.value</code></td>
<td>
<p>p-value of the corresponding statistic test.</p>
</td>
</tr>
</table>
<p>Moreover, if <code>data</code> is a time series and <code>Var.Cov.eps</code> is not especified:
</p>
<table>
<tr style="vertical-align: top;">
<td><code>pv.Box.test</code></td>
<td>
<p>p-values of the Ljung-Box test for the model fitted to the residuals.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>pv.t.test</code></td>
<td>
<p>p-values of the t.test for the model fitted to the residuals.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>ar.ma</code></td>
<td>
<p>ARMA orders for the model fitted to the residuals.</p>
</td>
</tr>
</table>
<h3>Author(s)</h3>

<p>German Aneiros Perez <a href="mailto:ganeiros@udc.es">ganeiros@udc.es</a>
</p>
<p>Ana Lopez Cheda <a href="mailto:ana.lopez.cheda@udc.es">ana.lopez.cheda@udc.es</a></p>


<h3>References</h3>

<p>Domowitz, J. (1982) The linear model with stochastic regressors and heteroscedastic dependent errors. Discussion paper No 543, Center for Mathematical studies in Economic and Management Science, Northwestern University, Evanston, Illinois.
</p>
<p>Judge, G.G., Griffiths, W.E., Carter Hill, R., Lutkepohl, H. and Lee, T-C. (1980) <em>The Theory and Practice of Econometrics</em>. Wiley.
</p>
<p>Seber, G.A.F. (1977) <em>Linear Regression Analysis</em>. Wiley.
</p>


<h3>See Also</h3>

<p>Other related functions are <code>np.gof</code> and <code>plrm.gof</code>.
</p>


<h3>Examples</h3>

<pre><code class="language-R"># EXAMPLE 1: REAL DATA
data(barnacles1)
data &lt;- as.matrix(barnacles1)
data &lt;- diff(data, 12)
data &lt;- cbind(data[,1],1,data[,-1])

## Example 1.1: false null hypothesis
par.gof(data)
## Example 1.2: true null hypothesis
par.gof(data, beta0=c(0,0.15,0.4))



# EXAMPLE 2: SIMULATED DATA
## Example 2a: dependent data

set.seed(1234)
# We generate the data
n &lt;- 100
beta &lt;- c(0.05, 0.01)

x &lt;- matrix(rnorm(200,0,1), nrow=n)
sum &lt;- x%*%beta
epsilon &lt;- arima.sim(list(order = c(1,0,0), ar=0.7), sd = 0.01, n = n)
y &lt;-  sum + epsilon
data &lt;- cbind(y,x)

## Example 2a.1: true null hypothesis
par.gof(data, beta0=c(0.05, 0.01))

## Example 2a.2: false null hypothesis
par.gof(data) 

</code></pre>


</div>