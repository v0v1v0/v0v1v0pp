<div class="container">

<table style="width: 100%;"><tr>
<td>plot_fit</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>Visualization of estimated mean trajectories and nonlinear functions from a PLSMM</h2>

<h3>Description</h3>

<p>This function plots the observed data, the estimated mean trajectories, and
the estimated nonlinear functions from the output of <code>plsmm_lasso</code>.
</p>


<h3>Usage</h3>

<pre><code class="language-R">plot_fit(
  x,
  y,
  series,
  t,
  name_group_var,
  plsmm_output,
  predicted = FALSE,
  show_obs = FALSE
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>x</code></td>
<td>
<p>A matrix of predictors.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>y</code></td>
<td>
<p>A continuous vector of response variable.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>series</code></td>
<td>
<p>A variable representing different series or groups in the data modeled as a random intercept.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>t</code></td>
<td>
<p>A numeric vector indicating the time points.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>name_group_var</code></td>
<td>
<p>A character string specifying the name of the grouping variable.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>plsmm_output</code></td>
<td>
<p>Output object obtained from the <code>plsmm_lasso</code> function.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>predicted</code></td>
<td>
<p>Logical indicating whether to plot predicted values. If <code>FALSE</code> only the observed time points are used.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>show_obs</code></td>
<td>
<p>Logical. If <code>TRUE</code> the observed time points are used for the position scale of the x-axis.</p>
</td>
</tr>
</table>
<h3>Details</h3>

<p>If <code>predicted</code> is <code>TRUE</code> the function uses the model from <code>plsmm_output</code> to predict unobserved time points on a continuous grid of time.
</p>


<h3>Value</h3>

<p>Two plots:
</p>

<ul>
<li>
<p> The first plot shows the observed data and the estimated mean trajectories.
</p>
</li>
<li>
<p> The second plot shows the estimated nonlinear functions.
</p>
</li>
</ul>
<h3>Examples</h3>

<pre><code class="language-R">
set.seed(123)
data_sim &lt;- simulate_group_inter(
  N = 50, n_mvnorm = 3, grouped = TRUE,
  timepoints = 3:5, nonpara_inter = TRUE,
  sample_from = seq(0, 52, 13),
  cos = FALSE, A_vec = c(1, 1.5)
)
sim &lt;- data_sim$sim
x &lt;- as.matrix(sim[, -1:-3])
y &lt;- sim$y
series &lt;- sim$series
t &lt;- sim$t
bases &lt;- create_bases(t)
lambda &lt;- 0.0046
gamma &lt;- 0.00000001
plsmm_output &lt;- plsmm_lasso(x, y, series, t,
  name_group_var = "group", bases$bases,
  gamma = gamma, lambda = lambda, timexgroup = TRUE,
  criterion = "BIC"
)
plot_fit(x, y, series, t, name_group_var = "group", plsmm_output)

</code></pre>


</div>