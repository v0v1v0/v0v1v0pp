<div class="container">

<table style="width: 100%;"><tr>
<td>imd_anova</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>Test for a qualitative and quantitative difference between groups using IMD
and ANOVA, respectively</h2>

<h3>Description</h3>

<p>This is the IMD-ANOVA test defined in Webb-Robertson et al. (2010).
</p>


<h3>Usage</h3>

<pre><code class="language-R">imd_anova(
  omicsData,
  comparisons = NULL,
  test_method,
  pval_adjust_a_multcomp = "none",
  pval_adjust_g_multcomp = "none",
  pval_adjust_a_fdr = "none",
  pval_adjust_g_fdr = "none",
  pval_thresh = 0.05,
  equal_var = TRUE,
  parallel = TRUE
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>omicsData</code></td>
<td>
<p>pmartR data object of any class, which has a 'group_df'
attribute created by the 'group_designation()' function</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>comparisons</code></td>
<td>
<p>data frame with columns for "Control" and "Test"
containing the different comparisons of interest. Comparisons will be made
between the Test and the corresponding Control. If left NULL, then all
pairwise comparisons are executed.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>test_method</code></td>
<td>
<p>character string specifying the filter method to use:
"combined", "gtest", or "anova". Specifying "combined" implements both the gtest and
anova filters.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>pval_adjust_a_multcomp</code></td>
<td>
<p>character string specifying the type of multiple
comparison adjustment to implement for ANOVA tests. Valid options include:
"bonferroni", "holm", "tukey", and "dunnett". The default is "none" which
corresponds to no p-value adjustment.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>pval_adjust_g_multcomp</code></td>
<td>
<p>character string specifying the type of multiple
comparison adjustment to implement for G-test tests. Valid options include:
"bonferroni" and "holm". The default is "none" which corresponds to no
p-value adjustment.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>pval_adjust_a_fdr</code></td>
<td>
<p>character string specifying the type of FDR
adjustment to implement for ANOVA tests. Valid options include:
"bonferroni", "BH", "BY", and "fdr". The default is "none" which corresponds
to no p-value adjustment.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>pval_adjust_g_fdr</code></td>
<td>
<p>character string specifying the type of FDR
adjustment to implement for G-test tests. Valid options include:
"bonferroni", "BH", "BY", and "fdr". The default is "none" which corresponds
to no p-value adjustment.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>pval_thresh</code></td>
<td>
<p>numeric p-value threshold, below or equal to which
biomolecules are considered differentially expressed. Defaults to 0.05</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>equal_var</code></td>
<td>
<p>logical; should the variance across groups be assumed equal?</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>parallel</code></td>
<td>
<p>logical value indicating whether or not to use a
"doParallel" loop when running the G-Test with covariates. Defaults to
TRUE.</p>
</td>
</tr>
</table>
<h3>Value</h3>

<p>An object of class 'statRes', which is a data frame containing
columns (when relevant based on the test(s) performed) for: e_data cname,
group counts, group means, ANOVA p-values, IMD p-values, fold change
estimates on the same scale as the data (e.g. log2, log10, etc.), and fold
change significance flags (0 = not significant; +1 = significant and
positive fold change (ANOVA) or more observations in test group relative to
reference group (IMD); -1 = significant and negative fold change (ANOVA) or
fewer observations in test group relative to reference group (IMD))
</p>


<h3>Author(s)</h3>

<p>Bryan Stanfill, Kelly Stratton
</p>


<h3>References</h3>

<p>Webb-Robertson, Bobbie-Jo M., et al. "Combined statistical
analyses of peptide intensities and peptide occurrences improves
identification of significant peptides from MS-based proteomics data."
Journal of proteome research 9.11 (2010): 5748-5756.
</p>


<h3>Examples</h3>

<pre><code class="language-R">
library(pmartRdata)
# Transform the data
mymetab &lt;- edata_transform(omicsData = metab_object, data_scale = "log2")

# Group the data by condition
mymetab &lt;- group_designation(omicsData = mymetab, main_effects = c("Phenotype"))

# Apply the IMD ANOVA filter
imdanova_Filt &lt;- imdanova_filter(omicsData = mymetab)
mymetab &lt;- applyFilt(filter_object = imdanova_Filt, omicsData = mymetab, min_nonmiss_anova = 2)

# Implement IMD ANOVA and compute all pairwise comparisons 
# (i.e. leave the comparisons argument NULL), with FDR adjustment
anova_res &lt;- imd_anova(omicsData = mymetab, test_method = "anova",
                       pval_adjust_a_multcomp = "Holm", pval_adjust_a_fdr = "BY")
imd_res &lt;- imd_anova(omicsData = mymetab, test_method = "gtest",
                     pval_adjust_g_multcomp = "bon", pval_adjust_g_fdr = "BY")
imd_anova_res &lt;- imd_anova(omicsData = mymetab, test_method = "combined",
                           pval_adjust_a_fdr = "BY", pval_adjust_g_fdr = "BY")
imd_anova_res &lt;- imd_anova(omicsData = mymetab, test_method = "combined",
                           pval_adjust_a_multcomp = "bon", pval_adjust_g_multcomp = "bon",
                           pval_adjust_a_fdr = "BY", pval_adjust_g_fdr = "BY")

# Two main effects and a covariate
mymetab &lt;- group_designation(omicsData = mymetab, main_effects = c("Phenotype", "SecondPhenotype"),
                             covariates = "Characteristic")
imd_anova_res &lt;- imd_anova(omicsData = mymetab, test_method = 'comb')

# Same but with custom comparisons
comp_df &lt;- data.frame(Control = c("Phenotype1", "A"), Test = c("Phenotype2", "B"))
custom_comps_res &lt;- imd_anova(omicsData = mymetab, comparisons = comp_df, test_method = "combined")

</code></pre>


</div>