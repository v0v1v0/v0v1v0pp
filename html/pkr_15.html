<div class="container">

<table style="width: 100%;"><tr>
<td>NCA</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>Noncompartmental analysis for a dataset with multiple subjects</h2>

<h3>Description</h3>

<p>conduct noncompartmental analysis for many subjects in a data table
</p>


<h3>Usage</h3>

<pre><code class="language-R">NCA(concData, id, Time, conc, trt="", fit = "Linear", dose = 0, 
           adm = "Extravascular", dur = 0, report = "Table", iAUC = "", 
           uTime = "h", uConc = "ug/L", uDose = "mg")</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>concData</code></td>
<td>
<p>name of data table containing time-concentration data of multiple subjects</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>id</code></td>
<td>
<p>column name for subject ID</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>Time</code></td>
<td>
<p>column name for the time</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>conc</code></td>
<td>
<p>column name for the concentration</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>trt</code></td>
<td>
<p>column name for the treatment code. This is useful for crossover study like bioequivalence trial.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>fit</code></td>
<td>
<p>one of <code>"Linear"</code> or <code>"Log"</code> to indicate the way to calculate AUC</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>dose</code></td>
<td>
<p>administered dose. One should be careful for the unit. This can be a vector containing dose for each subject in order.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>adm</code></td>
<td>
<p>one of <code>"Bolus"</code> or <code>"Infusion"</code> or <code>"Extravascular"</code> to indicate drug administration mode</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>dur</code></td>
<td>
<p>infusion duration for constant infusion, otherwise 0.  This can be a vector containing values for each subject in order.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>report</code></td>
<td>
<p>either of <code>"Table"</code> or <code>"Text"</code> to specify the type of return value</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>iAUC</code></td>
<td>
<p>data.frame with three columns, "Name", "Start", "End" to specify partial interval AUC</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>uTime</code></td>
<td>
<p>unit of time</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>uConc</code></td>
<td>
<p>unit of concentration</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>uDose</code></td>
<td>
<p>unit of dose</p>
</td>
</tr>
</table>
<h3>Details</h3>

<p>This function calls <code>IndiNCA</code> repeatedly to do NCA for each subject.
If you specify <code>Report="Text"</code>, this function returns in free text format to be used in a report file.
</p>


<h3>Value</h3>

<table>
<tr style="vertical-align: top;">
<td><code>CMAX</code></td>
<td>
<p>maximum concentration, Cmax</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>CMAXD</code></td>
<td>
<p>dose normalized Cmax, CMAX / Dose, Cmax / Dose</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>TMAX</code></td>
<td>
<p>time of maximum concentration, Tmax</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>TLAG</code></td>
<td>
<p>time to observe the first non-zero concentration, for extravascular administration only</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>CLST</code></td>
<td>
<p>last positive concentration observed, Clast</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>CLSTP</code></td>
<td>
<p>last positive concentration predicted, Clast_pred</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>TLST</code></td>
<td>
<p>time of last positive concentration, Tlast</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>LAMZHL</code></td>
<td>
<p>half-life by lambda z, ln(2)/LAMZ</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>LAMZ</code></td>
<td>
<p>lambda_z negative of best fit terminal slope</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>LAMZLL</code></td>
<td>
<p>earliest time for LAMZ</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>LAMZUL</code></td>
<td>
<p>last time for LAMZ</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>LAMZNPT</code></td>
<td>
<p>number of points for LAMZ</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>CORRXY</code></td>
<td>
<p>correlation of log(concentration) and time</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>R2</code></td>
<td>
<p>R-squared</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>R2ADJ</code></td>
<td>
<p>R-squared adjusted</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>C0</code></td>
<td>
<p>back extrapolated concentration at time 0, for bolus intravascular administration only</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>AUCLST</code></td>
<td>
<p>AUC from 0 to TLST</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>AUCALL</code></td>
<td>
<p>AUC using all the given points, including trailing zero concentrations</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>AUCIFO</code></td>
<td>
<p>AUC infinity observed</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>AUCIFOD</code></td>
<td>
<p>AUCIFO / Dose</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>AUCIFP</code></td>
<td>
<p>AUC infinity predicted using CLSTP instead of CLST</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>AUCIFPD</code></td>
<td>
<p>AUCIFP / Dose</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>AUCPEO</code></td>
<td>
<p>AUC % extrapolation observed</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>AUCPEP</code></td>
<td>
<p>AUC % extrapolated for AUCIFP</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>AUCPBEO</code></td>
<td>
<p>AUC % back extrapolation observed, for bolus IV administration only</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>AUCPBEP</code></td>
<td>
<p>AUC % back extrapolation predicted with AUCIFP, for bolus IV administration only</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>AUMCLST</code></td>
<td>
<p>AUMC to the TLST</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>AUMCIFO</code></td>
<td>
<p>AUMC infinity observed using CLST</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>AUMCIFP</code></td>
<td>
<p>AUMC infinity determined by CLSTP</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>AUMCPEO</code></td>
<td>
<p>AUMC % extrapolated observed</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>AUMCPEP</code></td>
<td>
<p>AUMC % extrapolated predicted</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>MRTIVLST</code></td>
<td>
<p>mean residence time (MRT) to TLST, for intravascular administration</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>MRTIVIFO</code></td>
<td>
<p>mean residence time (MRT) infinity using CLST, for intravascular administration</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>MRTIVIFP</code></td>
<td>
<p>mean residence time (MRT) infinity using CLSTP, for intravascular administration</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>MRTEVLST</code></td>
<td>
<p>mean residence time (MRT) to TLST, for extravascular administration</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>MRTEVIFO</code></td>
<td>
<p>mean residence time (MRT) infinity using CLST, for extravascular administration</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>MRTEVIFP</code></td>
<td>
<p>mean residence time (MRT) infinity using CLSTP, for extravascular administration</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>VZO</code></td>
<td>
<p>volume of distribution determined by LAMZ and AUCIFO, for intravascular administration</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>VZP</code></td>
<td>
<p>volume of distribution determined by LAMZ and AUCIFP, for intravascular administration</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>VZFO</code></td>
<td>
<p>VZO for extravascular administration, VZO/F, F is bioavailability</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>VZFP</code></td>
<td>
<p>VZP for extravascular administration, VZP/F, F is bioavailability</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>CLO</code></td>
<td>
<p>clearance using AUCIFO, for intravascular administration</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>CLP</code></td>
<td>
<p>clearance using AUCIFP, for intravascular administration</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>CLFO</code></td>
<td>
<p>CLO for extravascular administration, CLO/F, F is bioavailability</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>CLFP</code></td>
<td>
<p>CLP for extravascular administration, CLP/F, F is bioavailability</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>VSSO</code></td>
<td>
<p>volume of distribution at steady state using CLST, for intravascular administration only</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>VSSP</code></td>
<td>
<p>volume of distribution at stead state using CLSTP, for intravascular administration only</p>
</td>
</tr>
</table>
<h3>Author(s)</h3>

<p>Kyun-Seop Bae &lt;k@acr.kr&gt;</p>


<h3>References</h3>


<ol>
<li>
<p> Gabrielsson J, Weiner D. Pharmacokinetic and Pharmacodynamic Data Analysis - Concepts and Applications. 5th ed. 2016.
</p>
</li>
<li>
<p> Shargel L, Yu A. Applied Biopharmaceutics and Pharmacokinetics. 7th ed. 2015. 
</p>
</li>
<li>
<p> Rowland M, Tozer TN. Clinical Pharmacokinetics and Pharmacodynamics - Concepts and Applications. 4th ed. 2011.
</p>
</li>
<li>
<p> Gibaldi M, Perrier D. Pharmacokinetics. 2nd ed. revised and expanded. 1982.
</p>
</li>
</ol>
<h3>See Also</h3>

<p><code>sNCA</code></p>


<h3>Examples</h3>

<pre><code class="language-R"># Theoph and Indometh data: dose in mg, conc in mg/L, time in h
NCA(Theoph, "Subject", "Time", "conc", dose=320, uConc="mg/L")
NCA(Indometh, "Subject", "time", "conc", dose=25, adm="Bolus", uConc="mg/L")

iAUC = data.frame(Name=c("AUC[0-12h]","AUC[0-24h]"), Start=c(0,0), End=c(12,24)) ; iAUC
NCA(Theoph, "Subject", "Time", "conc", dose=320, iAUC=iAUC, uConc="mg/L")
NCA(Indometh, "Subject", "time", "conc", dose=25, adm="Bolus", iAUC=iAUC, uConc="mg/L")

# writeLines(NCA(Theoph, "Subject", "Time", "conc", dose=320, report="Text", uConc="mg/L"),
#            "Theoph_Linear_CoreOutput.txt")
# writeLines(NCA(Theoph, "Subject", "Time", "conc", dose=320, fit="Log", report="Text", 
#            uConc="mg/L"), "Theoph_Log_CoreOutput.txt")
# writeLines(NCA(Indometh, "Subject", "time", "conc", dose=25, adm="Bolus", report="Text", 
#            uConc="mg/L"), "Indometh_Bolus_Linear_CoreOutput.txt")
# writeLines(NCA(Indometh, "Subject", "time", "conc", dose=25, adm="Bolus", fit="Log",
#            report="Text", uConc="mg/L"), "Indometh_Bolus_Log_CoreOutput.txt")
# writeLines(NCA(Indometh, "Subject", "time", "conc", dose=25, adm="Infusion", dur=0.25,
#            report="Text", uConc="mg/L"), "Indometh_Infusion_Linear_CoreOutput.txt")
# writeLines(NCA(Indometh, "Subject", "time", "conc", dose=25, adm="Infusion", dur=0.25,
#            fit="Log", report="Text", uConc="mg/L"), "Indometh_Infusion_Log_CoreOutput.txt")
</code></pre>


</div>