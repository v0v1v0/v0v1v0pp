<div class="container">

<table style="width: 100%;"><tr>
<td>GPS</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>Gamma Poisson Shrinkage</h2>

<h3>Description</h3>

<p>Gamma Poisson Shrinkage model proposed by DuMouchel (1999) extended to the multiple comparison framework. 
</p>


<h3>Usage</h3>

<pre><code class="language-R">GPS(DATABASE,  RR0 = 1, MIN.n11 = 1, DECISION = 1, DECISION.THRES = 0.05, 
RANKSTAT = 1, TRONC = FALSE, TRONC.THRES = 1,   
PRIOR.INIT = c(alpha1 = 0.2, beta1 = 0.06, alpha2 = 1.4,
beta2 = 1.8, w = 0.1), PRIOR.PARAM = NULL)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>DATABASE</code></td>
<td>
<p>Object returned by the function <code>as.PhViD</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>RR0</code></td>
<td>
<p>Value of the tested risk. By default, <code>RR0=1</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>MIN.n11</code></td>
<td>
<p>Minimum number of notifications for a couple to be potentially considered as a signal. This option does not affect the calculation of the hyper parameters. By default, <code>MIN.n11 = 1</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>DECISION</code></td>
<td>
<p>Decision rule for the signal generation based on
</p>
<p>1 = FDR (Default value)
</p>
<p>2 = Number of signals
</p>
<p>3 = Ranking statistic. See <code>RANKSTAT</code></p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>DECISION.THRES</code></td>
<td>
<p>Threshold for <code>DECISION</code>. Ex 0.05 for FDR (<code>DECISION</code>=1). </p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>RANKSTAT</code></td>
<td>
<p>Statistic used for ranking the couples:
</p>
<p>1 = Posterior probability of the null hypothesis
</p>
<p>2 = 5% quantile of the posterior distribution of <code class="reqn">\lambda</code>
</p>
<p>3 = Posterior Expectation of <code class="reqn">\log_2(\lambda)</code></p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>TRONC</code></td>
<td>
<p>If TRUE, only the data with at least <code>TRONC.THRES</code> notifications are considered in the calculation of the hyper parameters and the likelihood is a product of mixture of two negative binomial truncated by <code>TRONC.THRES-1</code>. By default, <code>TRONC=F</code></p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>TRONC.THRES</code></td>
<td>
<p>See <code>TRONC</code> </p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>PRIOR.INIT</code></td>
<td>
<p>Vector of initialization of the prior parameters <code class="reqn">(\alpha_1, \beta_1, \alpha_2, \beta_2, w)</code>. By default, <code>PRIOR.INIT</code> <code class="reqn">= c(\alpha_1 = 0.2, \beta_1 = 0.06, \alpha_2 = 1.4, \beta_2 = 1.8, w = 0.1)</code>, ie the prior parameters found in DuMouchel (1999).</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>PRIOR.PARAM</code></td>
<td>
<p>Chosen hyper parameters. By default, <code>PRIOR.PARAM</code> = NULL which means that the hyperparameters are calculated by maximising the marginal likelihood.</p>
</td>
</tr>
</table>
<h3>Details</h3>

<p>Each observed count <code class="reqn">n_{11}</code> is assumed to be drawn from a Poisson distribution with parameters 
<code class="reqn">e_{11}</code> where <code class="reqn">e_{11}</code> is the expected count under the hypothesis of independence between the adverse events and the drugs (<code class="reqn">n1. \times n.1 / N</code>, see <code>as.PhViD</code>). <code class="reqn">\lambda</code> is a priori assumed to be distributed according to a mixture of two gamma distributions: <code class="reqn">\lambda \sim w \: \Gamma(\alpha_1,\beta_1) + (1-w) \: \Gamma(\alpha_2,\beta_2)</code>.</p>


<h3>Value</h3>

<table>
<tr style="vertical-align: top;">
<td><code>ALLSIGNALS</code></td>
<td>
<p>Data.frame summarizing the results of all couples with at least <code>MIN.n11</code> notifications ordered by <code>RANKSTAT</code>. It contains notably the labels, the cell counts, the expected counts, <code>RANKSTAT</code>, the ratios(count/expected count), the marginal counts and the estimations of FDR, FNR, Se et Sp. If <code>RANKSTAT!=1</code>, the last column is the posterior probability of the null hypothesis.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>SIGNALS</code></td>
<td>
<p>Same Data.frame as <code>ALLSIGNALS</code> but restricted to the list of generated signals.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>NB.SIGNALS</code></td>
<td>
<p>Number of generated signals.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>INPUT.PARAM</code></td>
<td>
<p>Parameters entered in the function.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>PARAM</code></td>
<td>
<p>A list that contains the prior hyper parameters (<code>PRIOR.PARAM</code>). Additionally if <code>PRIOR.PARAM=NULL</code>, it also contains the prior hyper parameters initialization (<code>PRIOR.INIT</code>) and the convergence code (see <code>nlm()</code>).</p>
</td>
</tr>
</table>
<h3>Author(s)</h3>

<p>Ismaïl Ahmed &amp; Antoine Poncet</p>


<h3>References</h3>

<p>Ahmed I, Haramburu F, Fourrier-Réglat A, Thiessard F, Kreft-Jais C, Miremont-Salamé G, Bégaud B, Tubert-Bitter P. Bayesian pharmacovigilance signal detection methods revisited in a multiple comparison setting. Stat Med. 2009 Jun 15;28(13):1774-1792. 
</p>
<p>DuMouchel W, Bayesian Data Mining in Large Frequency Tables, with an Application to the FDA Spontaneous Reporting System, The American Statistician, 1999, 53, 177-190.
</p>
<p>Szarfman A, Machado S, O'Neill R, Use of Screening Algorithms and Computer Systems to Efficiently Signal Higher-Than-Expected Combinations of Drugs and Events in the US FDA's Spontaneous Reports Database Drug Safety, 2002, 25, 381-392.
</p>


<h3>Examples</h3>

<pre><code class="language-R">## start
#data(PhViDdata.frame)


#PhViDdata &lt;- as.PhViD(PhViDdata.frame)
#res &lt;- GPS(PhViDdata)

#List of signals generated by the decision rule proposed 
#by Szarfman et al. (2002)
#res2 &lt;- GPS(PhViDdata, DECISION = 3, DECISION.THRES = 2, RANKSTAT = 2)
## end
</code></pre>


</div>