<div class="container">

<table style="width: 100%;"><tr>
<td>PoweREST_subset</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>Bootstrap resampling and power calculation for a subset of genes</h2>

<h3>Description</h3>

<p>This function performs bootstrap resampling upon a Seurat subject under each condition
to resemble the real dataset which allows the exact power calculation, and perform DE analysis.
Similar to 'PoweREST', users can specify the test they would like to perform for the DE analysis
in '...' (more test options can be refered to <a href="https://CRAN.R-project.org/package=Seurat">Seurat</a>.
Different to 'PoweREST', users can specify the values of 'min.pct' and 'logfc.threshold'
to pre-filter the genes based on their minimum detection rate 'min.pct' and at least X-fold difference (log-scale)
('logfc.threshold') across both groups. But this kind of filtering can miss weaker signals.
</p>


<h3>Usage</h3>

<pre><code class="language-R">PoweREST_subset(Seurat_obj,cond,replicates=1,spots_num,
iteration=100,random_seed=1,pvalue=0.05,logfc.threshold = 0.1,
min.pct = 0.01,...)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>Seurat_obj</code></td>
<td>
<p>A <a href="https://CRAN.R-project.org/package=Seurat">Seurat</a> object.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>cond</code></td>
<td>
<p>The name of the variable that indicates different conditions which is also stored in the
meta.data of the Seurat_obj and should be in character type.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>replicates</code></td>
<td>
<p>The number of sample replicates per group.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>spots_num</code></td>
<td>
<p>The number of spots per replicate.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>iteration</code></td>
<td>
<p>The number of iterations of the resampling.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>random_seed</code></td>
<td>
<p>To set a random seed.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>pvalue</code></td>
<td>
<p>The pvalue that will be considered significant.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>logfc.threshold</code></td>
<td>
<p>For every resampling, limit testing to genes which show, on average, at least X-fold difference (log-scale) between the two groups.
Default is 0.1 Increasing logfc.threshold speeds up the function, but can miss weaker signals.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>min.pct</code></td>
<td>
<p>For every resampling, only test genes that are detected in a minimum fraction of min.pct spots in either of the two populations.
Meant to speed up the function by not testing genes that are very infrequently expressed. Default is 0.01.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>...</code></td>
<td>
<p>DE test to use other than the default Wilcoxon test.</p>
</td>
</tr>
</table>
<h3>Value</h3>

<p>A list of values containing the power, average log2FC and percentage of spots detecting the gene among
the resampling data, the replicate value and the spots number per slice specified by the user and the filtered.
</p>


<h3>Author(s)</h3>

<p>Lan Shui <a href="mailto:lshui@mdanderson.org">lshui@mdanderson.org</a>
</p>


</div>