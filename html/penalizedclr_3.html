<div class="container">

<table style="width: 100%;"><tr>
<td>find.default.lambda</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>Default values for L1 penalty in conditional logistic regression</h2>

<h3>Description</h3>

<p>Performs cross validation to determine reasonable values for L1 penalty
in a conditional logistic regression.
</p>


<h3>Usage</h3>

<pre><code class="language-R">find.default.lambda(
  response,
  stratum,
  penalized,
  unpenalized = NULL,
  alpha = 1,
  p = NULL,
  standardize = TRUE,
  event,
  pf.list = NULL,
  nfolds = 10
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>response</code></td>
<td>
<p>The response variable, either a 0/1 vector or a factor with two levels.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>stratum</code></td>
<td>
<p>A numeric vector with stratum membership of each observation.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>penalized</code></td>
<td>
<p>A matrix of penalized covariates.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>unpenalized</code></td>
<td>
<p>A matrix of additional unpenalized covariates.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>alpha</code></td>
<td>
<p>The elastic net mixing parameter, a number between 0 and 1.
alpha=0 would give pure ridge; alpha=1 gives lasso. Pure ridge penalty is never obtained in this implementation since alpha must be positive.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>p</code></td>
<td>
<p>The sizes of blocks of covariates,
a numerical vector of the length equal to the number of blocks,
and with the sum equal to the number of penalized covariates.
If missing, all covariates are treated the same and a single penalty is applied.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>standardize</code></td>
<td>
<p>Should the covariates be standardized, a logical value.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>event</code></td>
<td>
<p>If response is a factor, the level that
should be considered a success in the logistic regression.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>pf.list</code></td>
<td>
<p>List of vectors of penalty factors.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>nfolds</code></td>
<td>
<p>The number of folds used in cross-validation. Default is 10.</p>
</td>
</tr>
</table>
<h3>Details</h3>

<p>The function is based on cross-validation implemented in the <code>clogitL1</code> package and returns
the value of <code>lambda</code> that minimizes cross validated deviance.
In the presence of blocks of covariates, a user specifies a list of
candidate vectors of penalty factors. For each candidate vector of penalty factors a
single <code>lambda</code> value is obtained.  Note that
cross-validation includes random data splitting, meaning
that obtained values can vary significantly between different runs.
</p>


<h3>Value</h3>

<p>A single numeric value if <code>p</code> and <code>pf.list</code> are missing, or a list of numeric values
with L1 penalties for each vector of penalty factors supplied.
</p>


<h3>See Also</h3>

<p>default.pf
</p>


<h3>Examples</h3>

<pre><code class="language-R">set.seed(123)
# simulate covariates (pure noise in two blocks of 20 and 80 variables)
X &lt;- cbind(matrix(rnorm(4000, 0, 1), ncol = 20), matrix(rnorm(16000, 2, 0.6), ncol = 80))
p &lt;- c(20,80)
pf.list &lt;- list(c(0.5, 1), c(2, 0.9))
# stratum membership
stratum &lt;- sort(rep(1:100, 2))

# the response
Y &lt;- rep(c(1, 0), 100)

# obtain a list with vectors of penalty factors

lambda.list &lt;- find.default.lambda(response = Y,
                                   penalized = X, stratum = stratum, p = p, pf.list = pf.list)

# when `p` and `pf.list` are not provided all covariates are treated as a single block

lambda &lt;- find.default.lambda(response = Y,
                                   penalized = X, stratum = stratum)
</code></pre>


</div>