<div class="container">

<table style="width: 100%;"><tr>
<td>npltree</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>Parametric Logisitic (n-PL) IRT Model Trees</h2>

<h3>Description</h3>

<p>Recursive partitioning (also known as trees) based on parametric logistic
(n-PL) item response theory (IRT) models for global testing of differential
item functioning (DIF).
</p>


<h3>Usage</h3>

<pre><code class="language-R">npltree(formula, data, type = c("Rasch", "1PL", "2PL", "3PL", "3PLu", "4PL"),
  start = NULL, weights = NULL, grouppars = FALSE,
  vcov = TRUE, method = "BFGS", maxit = 500L,
  reltol = 1e-10, deriv = "sum", hessian = TRUE,
  full = TRUE, minsize = NULL, ...)

## S3 method for class 'npltree'
plot(x, type = c("profile", "regions"), terminal_panel = NULL,
  tp_args = list(...), tnex = 2L, drop_terminal = TRUE, ...)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>formula</code></td>
<td>
<p>A symbolic description of the model to be fit. This should be of type <code>y ~ x1 + x2</code> where
<code>y</code> should be an item response matrix and <code>x1</code> and <code>x2</code> are used as partitioning variables.
For the models estimated using marginal maximum likelihood (MML), it is additionally poosible to allow for
impact of a group variable so that different ability distributions are estimated in each group.
This can be specified by extending the previous <code>formula</code> by a group factor <code>g</code> as <code>y ~ g | x1 + x2</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>data</code></td>
<td>
<p>a data frame containing the variables in the model.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>type</code></td>
<td>
<p>character, specifying either the type of IRT model in <code>npltree</code> (see also <code>nplmodel</code>)
or the type of visualization to be used in the <code>plot</code> method, respectively.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>start</code></td>
<td>
<p>an optional vector or list of starting values (see <code>raschmodel</code>
or <code>nplmodel</code>).</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>weights</code></td>
<td>
<p>an optional vector of weights (interpreted as case weights).</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>grouppars</code></td>
<td>
<p>logical. Should the estimated distributional group parameters of a multiple-group model
be included in the model parameters? (See <code>nplmodel</code>.)</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>vcov</code></td>
<td>
<p>logical or character specifying the type of variance-covariance matrix (if any) computed for
the final models when fitted using MML (see <code>nplmodel</code>).</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>method</code></td>
<td>
<p>control parameter for the optimizer used by <code>mirt</code> for the EM algorithm
when models are fitted using MML (see <code>nplmodel</code>).</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>maxit</code></td>
<td>
<p>control parameter for the optimizer used by <code>raschmodel</code> or
<code>nplmodel</code> (see <code>raschmodel</code>, <code>nplmodel</code>).</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>reltol</code></td>
<td>
<p>control parameter for the optimizer used by <code>raschmodel</code> or
<code>nplmodel</code> (see <code>raschmodel</code>, <code>nplmodel</code>).</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>deriv</code></td>
<td>
<p>character. Which type of derivatives should be used for computing gradient and Hessian matrix
when fitting Rasch models  with the conditional maximum likelihood (CML) method (see <code>raschmodel</code>)?</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>hessian</code></td>
<td>
<p>logical. Should the Hessian be computed for Rasch models fitted with the CML method
(see <code>raschmodel</code>)?</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>full</code></td>
<td>
<p>logical. Should a full model object be returned for Rasch models fitted with the CML method
(see <code>raschmodel</code>)?</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>minsize</code></td>
<td>
<p>The minimum number of observations in each node, which is passed to <code>mob_control</code>.
If not set, it is 300 for 2PL models and 500 for 3PL, 3PLu, and 4PL models.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>...</code></td>
<td>
<p>arguments passed to <code>mob_control</code> for <code>npltree</code>, and to the underlying
<code>plot</code> method.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>x</code></td>
<td>
<p>an object of class <code>npltree</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>terminal_panel, tp_args, tnex, drop_terminal</code></td>
<td>
<p>arguments passed to <code>mob</code>.</p>
</td>
</tr>
</table>
<h3>Details</h3>

<p>Parametric logistic (n-PL) model trees are an application of model-based recursive partitioning
(implemented in <code>mob</code>) to item response theory (IRT) models (implemented in
<code>raschmodel</code> and <code>nplmodel</code>). While the <code>"Rasch"</code>
model is estimated by conditional maximum likelihood (CML) all other n-PL models are estimated by
marginal maximum likelihood (MML) via the standard EM algorithm. The latter allow the specification
of multiple-group model to capture group impact on the ability distributions.
</p>
<p>Various methods are provided for <code>"npltree"</code> objects, most of them inherit their behavior from
<code>"modelparty"</code> objects (e.g., <code>print</code>, <code>summary</code>). Additionally, dedicated extractor
functions or provided for the different groups of model parameters in each node of the tree: 
<code>itempar</code> (item parameters),
<code>threshpar</code> (threshold parameters),
<code>guesspar</code> (guessing parameters),
<code>upperpar</code> (upper asymptote parameters).
</p>


<h3>Value</h3>

<p>An object of S3 class <code>"npltree"</code> inheriting from class <code>"modelparty"</code>.
</p>


<h3>See Also</h3>

<p><code>mob</code>, <code>nplmodel</code>,
<code>rstree</code>, <code>pctree</code>, <code>raschtree</code>, <code>gpcmtree</code></p>


<h3>Examples</h3>

<pre><code class="language-R">o &lt;- options(digits = 4)

# fit a Rasch (1PL) tree on the SPISA data set
library("psychotree")
data("SPISA", package = "psychotree")
nplt &lt;- npltree(spisa[, 1:9] ~ age + gender + semester + elite + spon, 
  data = SPISA, type = "Rasch")
nplt

# visualize
plot(nplt)

# compute summaries of the models fitted in nodes 1 and 2
summary(nplt, 1:2)

options(digits = o$digits)
</code></pre>


</div>