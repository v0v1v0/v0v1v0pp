<div class="container">

<table style="width: 100%;"><tr>
<td>PBNPA</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>Permutation Based Non-Parametric Analysis of CRISPR Screen Data</h2>

<h3>Description</h3>

<p>This function reads the raw read count data and conducts statistical
analysis for permutation based non-parametric analysis of CRISPR screen data.
</p>


<h3>Usage</h3>

<pre><code class="language-R">PBNPA(dat, sim.no = 10, alpha.threshold = 0.2, fdr = 0.05)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>dat</code></td>
<td>
<p>List type with each element being the raw read count data for one replicate.
Each element should be a dataframe with four columns. The first column is named
'sgRNA' which is the sgRNA index; the second column is named 'Gene' which is the
gene index; the third column should be the initial read count or control read
count and the fourth column should be the final read count or treatment read count.
Missing values in the read count are replaced with 0.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>sim.no</code></td>
<td>
<p>Number of permutations used to get the un-adjusted p-value.Set to 10 by default.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>alpha.threshold</code></td>
<td>
<p>Threshold to remove genes with significant p-values. Set to 0.2 by default.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>fdr</code></td>
<td>
<p>The FDR threshold to determine the selected genes. Set to 0.05 by default.</p>
</td>
</tr>
</table>
<h3>Details</h3>

<p>PBNPA implements permutation based non-parametric analysis of CRISPR screen data. Details
about this algorithm are published in the following paper published on BMC genomics, Jia et al. (2017) &lt;doi:10.1186/s12864-017-3938-5&gt;: A permutation-based non-parametric analysis of CRISPR screen data.
Please cite this paper if you use this algorithm for your paper.
</p>


<h3>Value</h3>

<p>A list of 5 elements will be returned. The first element is pos.gene, which is the index of
genes identified as hits for positive screen by controlling FDR at the selected level; the second
element is pos.number, which is the number of genes identified as hits for positive screen; The
third element is neg.gene, which is the index of genes identified as hits for negative screen by
controlling FDR at the selected level; the fourth element is neg.number, which is the number of genes
identified as hits for negative screen; the fifth element is a dataframe which contains unadjusted
p-values and FDR adjusted p-values for all the genes (for both negative selection and positive selection).
</p>


<h3>Examples</h3>

<pre><code class="language-R">dat11 = system.file('extdata','simdata_20per_off50.csv', package='PBNPA')
dat22 = system.file('extdata','simdata_20per_off49.csv', package='PBNPA')
dat33 = system.file('extdata','simdata_20per_off48.csv', package='PBNPA')
dat1 = read.csv(dat11, header = TRUE)
dat2 = read.csv(dat22, header = TRUE)
dat3 = read.csv(dat33, header = TRUE)
datlist = list(dat1, dat2, dat3)
result = PBNPA(datlist)
</code></pre>


</div>