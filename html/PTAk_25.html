<div class="container">

<table style="width: 100%;"><tr>
<td>PTA3</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>Principal Tensor Analysis on 3 modes</h2>

<h3>Description</h3>

<p>Performs a truncated SVD-<em>3</em>modes analysis with or
without specific metrics, penalised or not.
</p>


<h3>Usage</h3>

<pre><code class="language-R">PTA3(X,nbPT=2,nbPT2=1,
                smoothing=FALSE,
                smoo=list(function(u)ksmooth(1:length(u),u,kernel="normal",
                          bandwidth=4,x.points=(1:length(u)))$y,
                          function(u)smooth.spline(u,df=3)$y,
                          NA),
                minpct=0.1,verbose=getOption("verbose"),file=NULL,
                modesnam=NULL,addedcomment="", ...)</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>X</code></td>
<td>

<p>a tensor (as an array) of order <em>3</em>, if non-identity metrics are
used <code>X</code> is a list with <code>data</code>  as the array and
<code>met</code> a list of metrics</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>nbPT</code></td>
<td>
<p>a number specifying the number of <em>3</em>modes Principal Tensors requested</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>nbPT2</code></td>
<td>
<p>if 0 no <em>2</em>-modes solutions will be computed, 1 =all, &gt;1 otherwise</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>smoothing</code></td>
<td>
<p>logical to consider smoothing or not</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>smoo</code></td>
<td>
<p>a list of length 3 with lists of functions operating on
vectors component for the appropriate dimension (see details) </p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>minpct</code></td>
<td>

<p>numerical 0-100 to control of computation of future solutions at this
level and below</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>verbose</code></td>
<td>
<p>control printing</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>file</code></td>
<td>
<p>output printed at the prompt if <code>NULL</code>, or printed in the given  ‘<span class="file">file</span>’</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>modesnam</code></td>
<td>

<p>character vector of the names of the modes, if <code>NULL</code> "<code>mo 1</code>"
..."<code>mo k</code>"</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>addedcomment</code></td>
<td>
<p>character string printed after the title of the analysis</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>...</code></td>
<td>
<p>any other arguments passed to SVDGen or other functions</p>
</td>
</tr>
</table>
<h3>Details</h3>

<p>According to the decomposition described in Leibovici(1993) and
Leibovici and Sabatier(1998) the function gives a generalisation of
the SVD (2 modes) to <em>3</em> modes. It is the same algorithm used
for <code>PTAk</code> but simpler as the recursivity implied by the
<em>k</em> modes analysis is reduced only to one level <em>i.e</em> for
every <em>3</em>-modes  Principal Tensors, 3 SVD are performed for
every contracted product with one the three components of the
<em>3</em>-modes  Principal Tensors (see <code>APSOLU3</code>,
<code>PTAk</code>). <br></p>
<p>Recent work from Tamara G Kolda showed on an example that <em>orthogonal rank</em>
decompositions are not necesseraly nested. This makes PTA-<em>3</em>modes a model with
nested decompositions not giving the exact <em>orthogonal rank</em>.
So PTA-<em>3</em>modes will look for best approximation according to orthogonal tensors in a nested approximmation process. PTA3 decompositions is "a" generalisation of SVD but not the ...
<br>
With the <code>smoothing</code> option <code>smoo</code> contain a list of (lists) of functions to
apply on vectors of component (within the algorithm, see
<code>SVDgen</code>). For a given dimension (1,2,or 3) a list of
functions is given. If this list consists only of one function (no list
needed) this
function will be used at any level all the time : if one want to smooth
only for the first Principal Tensor, put <code>list(function,NA)</code>. Now
you start to understand this list will have a maximum length of
<code>nbPT</code> and the corresponding function will be used for the
corresponding <em>3</em>mode Principal Tensor. To smooth differently the
associated solutions one have to put another level of nested lists
otherwise the function given at the <em>3</em>mode level will be used for
all. These rules are te same for <code>PTAk</code>.
</p>


<h3>Value</h3>

<p>a <code>PTAk</code> object</p>


<h3>Note</h3>

<p>The use of metrics (diagonal or not) allows flexibility of analysis like in <em>2</em> modes
<em>e.g.</em> correspondence analysis, discriminant analysis, robust analysis.  Smoothing option
extends the analysis towards functional data analysis, and or outliers "protection" is
theoretically valid for tensors belonging to a tensor product of separable Hilbert spaces
(<em>e.g.</em> Sobolev spaces) (see references in <code>PTAk</code>, <code>SVDgen</code>).</p>


<h3>Author(s)</h3>

<p>Didier G. Leibovici</p>


<h3>References</h3>

<p>Leibovici D(1993) <em>Facteurs &lt;e0&gt; Mesures R&lt;e9&gt;p&lt;e9&gt;t&lt;e9&gt;es et Analyses Factorielles :
applications &lt;e0&gt; un suivi &lt;e9&gt;pid&lt;e9&gt;miologique</em>. Universit&lt;e9&gt; de Montpellier
II. PhD Thesis in Math&lt;e9&gt;matiques et Applications (Biostatistiques).
</p>
<p>Leibovici D and Sabatier R (1998) <em>A Singular Value
Decomposition of a k-ways array for a Principal Component Analysis of
multi-way data, the PTA-k</em>. Linear Algebra and its Applications,
269:307-329.
</p>
<p>Kolda T.G (2003)<em> A Counterexample to the Possibility of an Extension of the Eckart-Young Low-Rank Approximation Theorem for the Orthogonal Rank Tensor Decomposition</em>. SIAM J. Matrix Analysis, 24(2):763-767, Jan. 2003.
</p>
<p>Leibovici DG (2010) <em>Spatio-temporal Multiway Decomposition using Principal Tensor Analysis on k-modes:the R package <span class="pkg">PTAk</span></em>. Journal of Statistical Software, 34(10), 1-34. <a href="https://doi.org/10.18637/jss.v034.i10">doi:10.18637/jss.v034.i10</a>
</p>


<h3>See Also</h3>

<p><code>SVDgen</code>, <code>FCAk</code>, <code>PTAk</code>, <code>summary.PTAk</code></p>


<h3>Examples</h3>

<pre><code class="language-R"> # example using Zone_climTUN dataset
 #  
# library(maptools)
# library(RColorBrewer)
# Yl=brewer.pal(11,"PuOr")
# data(Zone_climTUN)
## in fact a modified version of plot.Map was used
# plot(Zone_climTUN,ol=NA,auxvar=Zone_climTUN$att.data$PREC_OCTO)
##indicators 84 +3 to repeat
# Zone_clim&lt;-Zone_climTUN$att.data[,c(2:13,15:26,28:39,42:53,57:80,83:95,55:56)]
# Zot &lt;-Zone_clim[,85:87] ;temp &lt;-colnames(Zot) 
# Zot &lt;- as.matrix(Zot)%x%t(as.matrix(rep(1,12)))
# colnames(Zot) &lt;-c(paste(rep(temp [1],12),1:12),paste(rep(temp [2],12),1:12),
#	 paste(rep(temp [3],12),1:12))
# Zone_clim &lt;-cbind(Zone_clim[,1:84],Zot)
 
# Zone3w &lt;- array(as.vector(as.matrix(Zone_clim)),c(2599,12,10))
## preprocessing
#Zone3w&lt;-Multcent(dat=Zone3w,bi=NULL,by=3,centre=mean, 
#	centrebyBA=c(TRUE,FALSE),scalebyBA=c(TRUE,FALSE))
# Zone3w.PTA3&lt;-PTA3(Zone3w,nbPT=3,nbPT2=3)
## summary and plot
# summary(Zone3w.PTA3)
#plot(Zone3w.PTA3,mod=c(2,3),nb1=1,nb2=11,lengthlabels=5,coefi=list(c(1,1,1),c(1,-1,-1)))
#plot(Zone_climTUN,ol=NA,auxvar=Zone3w.PTA3[[1]]$v[1,],nclass=30)
#plot(Zone_climTUN,ol=NA,auxvar=Zone3w.PTA3[[1]]$v[11,],nclass=30)
 
 ##############
 cat(" A little fun using iris3 and matching randomly 15 for each iris sample!","\n")
 cat("   then performing a PTA-3modes.  If many draws are done, plots")
 cat("   show the stability of the first and third Principal Tensors.","\n")
 cat("iris3 is centered and reduced beforehand for each original variables.","\n")
#  demo function 
# source(paste(R.home(),"/library/PTAk/demo/PTA3.R",sep=""))
# demo.PTA3(bootn=10,show=5,openX11s=FALSE)
 
</code></pre>


</div>