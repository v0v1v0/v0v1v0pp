<div class="container">

<table style="width: 100%;"><tr>
<td>megabot</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>Conditional tests for association.</h2>

<h3>Description</h3>

<p><code>megabot</code> tests for correlation between a variable, <var>X</var>, and another variable, <var>Y</var>,
conditional on other variables, <var>Z</var>.  The basic approach involves fitting an specified model of <var>X</var> on
<var>Z</var>, a specified model of <var>Y</var> on <var>Z</var>, and then determining whether there is any
remaining information between <var>X</var> and <var>Y</var>.  This is done by
computing residuals for both models, calculating their correlation, and 
testing the null of no residual correlation.  The test statistic output 
is the correlation between probability-scale residuals.  <var>X</var> and <var>Y</var> can
be continous or ordered discrete variables.  <code>megabot</code> replicates the functionality
of <code>cobot</code>, <code>cocobot</code>, and <code>countbot</code>
</p>


<h3>Usage</h3>

<pre><code class="language-R">megabot(
  formula,
  data,
  fit.x,
  fit.y,
  link.x = c("logit", "probit", "cloglog", "loglog", "cauchit", "logistic"),
  link.y = c("logit", "probit", "cloglog", "loglog", "cauchit", "logistic"),
  subset,
  na.action = getOption("na.action"),
  fisher = TRUE,
  conf.int = 0.95
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>formula</code></td>
<td>
<p>an object of class <code>Formula</code> (or one
that can be coerced to that class): a symbolic description of the
model to be fitted.  The details of model specification are given
under ‘Details’.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>data</code></td>
<td>
<p>an optional data frame, list or environment (or object
coercible by <code>as.data.frame</code> to a data frame)
containing the variables in the model.  If not found in
<code>data</code>, the variables are taken from
<code>environment(formula)</code>, typically the environment from which
<code>megabot</code> is called.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>fit.x, fit.y</code></td>
<td>
<p>The fitting function used for the model of <var>X</var> or <var>Y</var> on
<var>Z</var>.  Options are ‘<span class="samp">⁠ordinal⁠</span>’, ‘<span class="samp">⁠lm⁠</span>’, ‘<span class="samp">⁠lm.emp⁠</span>’,
‘<span class="samp">⁠poisson⁠</span>’, ‘<span class="samp">⁠nb⁠</span>’, and ‘<span class="samp">⁠orm⁠</span>’.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>link.x, link.y</code></td>
<td>
<p>The link family to be used for the ordinal model of 
<var>X</var> on <var>Z</var>.  Defaults to ‘<span class="samp">⁠logit⁠</span>’. Other options are
‘<span class="samp">⁠probit⁠</span>’, ‘<span class="samp">⁠cloglog⁠</span>’,‘<span class="samp">⁠loglog⁠</span>’, ‘<span class="samp">⁠cauchit⁠</span>’, and ‘<span class="samp">⁠logistic⁠</span>’(equivalent with ‘<span class="samp">⁠logit⁠</span>’). Used only when
‘<span class="samp">⁠fit.x⁠</span>’ is either ‘<span class="samp">⁠ordinal⁠</span>’ or ‘<span class="samp">⁠orm⁠</span>’.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>subset</code></td>
<td>
<p>an optional vector specifying a subset of
observations to be used in the fitting process.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>na.action</code></td>
<td>
<p>action to take when <code>NA</code> present in data.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>fisher</code></td>
<td>
<p>logical indicating whether to apply fisher transformation to compute confidence intervals and p-values for the correlation.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>conf.int</code></td>
<td>
<p>numeric specifying confidence interval coverage.</p>
</td>
</tr>
</table>
<h3>Details</h3>

<p>Formula is specified as <code><var>X</var> | <var>Y</var> ~ <var>Z</var></code>.
This indicates that models of <code><var>X</var> ~ <var>Z</var></code> and
<code><var>Y</var> ~ <var>Z</var></code> will be fit.  The null hypothesis to be
tested is <code class="reqn">H_0 : X</code> independent of <var>Y</var> conditional
on <var>Z</var>.
</p>


<h3>Value</h3>

<p>object of ‘<span class="samp">⁠cocobot⁠</span>’ class.
</p>


<h3>References</h3>

<p>Li C and Shepherd BE (2012) 
A new residual for ordinal outcomes.
<em>Biometrika</em>. <b>99</b>: 473–480.
</p>
<p>Shepherd BE, Li C, Liu Q (2016)
Probability-scale residuals for continuous, discrete, and censored data.
<em>The Canadian Journal of Statistics</em>. <b>44</b>: 463–479.
</p>


<h3>Examples</h3>

<pre><code class="language-R">data(PResidData)
megabot(y|w ~ z, fit.x="ordinal", fit.y="lm.emp", data=PResidData)
</code></pre>


</div>