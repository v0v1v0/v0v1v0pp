<div class="container">

<table style="width: 100%;"><tr>
<td>adjpin</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>Estimation of adjusted PIN model</h2>

<h3>Description</h3>

<p>Estimates the Adjusted Probability of Informed Trading
(<code>adjPIN</code>) as well as the Probability of Symmetric Order-flow Shock
(<code>PSOS</code>) from the <code>AdjPIN</code> model of Duarte and Young(2009).
</p>


<h3>Usage</h3>

<pre><code class="language-R">adjpin(data, method = "ECM", initialsets = "GE", num_init = 20,
              restricted = list(), ..., verbose = TRUE)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>data</code></td>
<td>
<p>A dataframe with 2 variables: the first
corresponds to buyer-initiated trades (buys), and the second corresponds
to seller-initiated trades (sells).</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>method</code></td>
<td>
<p>A character string referring to the method
used to estimate the model of Duarte and Young (2009).
It takes one of two values: <code>"ML"</code> refers to the standard maximum likelihood
estimation, and <code>"ECM"</code> refers to the expectation-conditional maximization
algorithm. The default value is <code>"ECM"</code>. Details of the ECM method,
and comparative results can be found in
Ghachem and Ersan (2022a), and in
Ghachem and Ersan (2022b).</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>initialsets</code></td>
<td>
<p>It can either be a character string referring to
prebuilt algorithms generating initial parameter sets or a dataframe
containing custom initial parameter sets.
If <code>initialsets</code> is a character string, it refers to the method of generation
of the initial parameter sets, and takes one of three values: <code>"GE"</code>, <code>"CL"</code>,
or <code>"RANDOM"</code>. <code>"GE"</code> refers to initial parameter sets generated by the
algorithm of Ersan and Ghachem (2022b), and implemented
in <code>initials_adjpin()</code>, <code>"CL"</code> refers to initial parameter sets generated by
the algorithm of Cheng and Lai (2021), and
implemented in <code>initials_adjpin_cl()</code>, while <code>"RANDOM"</code> generates random
initial parameter sets as implemented in <code>initials_adjpin_rnd()</code>.
The default value is <code>"GE"</code>. If <code>initialsets</code> is a dataframe, the function
<code>adjpin()</code> will estimate the AdjPIN model using the provided initial
parameter sets.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>num_init</code></td>
<td>
<p>An integer specifying the maximum number of
initial parameter sets to be used in the estimation.
If <code>initialsets="GE"</code>, the generation of initial parameter sets will stop
when the number of initial parameter sets reaches <code>num_init</code>. It can stop
earlier if the number of all possible generated initial parameter sets is
lower than <code>num_init</code>. If <code>initialsets="RANDOM"</code>, exactly <code>num_init</code>
initial parameter sets are returned. If <code>initialsets="CL"</code>: then <code>num_init</code>
is ignored, and all <code>256</code> initial parameter sets are used. The default
value is <code>20</code>. <code style="white-space: pre;">⁠[i]⁠</code> The argument <code>num_init</code> is ignored when the argument
<code>initialsets</code> is a dataframe.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>restricted</code></td>
<td>
<p>A binary list that allows estimating restricted
AdjPIN models by specifying which model parameters are assumed to be equal.
It contains one or multiple of the following four elements
<code style="white-space: pre;">⁠{theta, mu, eps, d}⁠</code>. For instance, If <code>theta</code> is set to <code>TRUE</code>,
then the probability of liquidity shock in no-information days, and in
information days is assumed to be the same (<code class="reqn">\theta</code><code>=</code><code class="reqn">\theta'</code>). If any of
the remaining rate elements <code style="white-space: pre;">⁠{mu, eps, d}⁠</code> is set to <code>TRUE</code>,
(say  <code>mu=TRUE</code>), then the rate is assumed to be the same on the buy side,
and on the sell side (<code class="reqn">\mu</code><sub>b</sub><code>=</code><code class="reqn">\mu</code><sub>s</sub>). If more than one element is set to
<code>TRUE</code>, then the restrictions are combined. For instance, if the argument
<code>restricted</code> is set to <code>list(theta=TRUE, eps=TRUE, d=TRUE)</code>, then the
restricted AdjPIN model is estimated, where <code class="reqn">\theta</code><code>=</code><code class="reqn">\theta'</code>, <code class="reqn">\epsilon</code><sub>b</sub><code>=</code><code class="reqn">\epsilon</code><sub>s</sub>,
and <code class="reqn">\Delta</code><sub>b</sub><code>=</code><code class="reqn">\Delta</code><sub>s</sub>. If the value of the argument <code>restricted</code> is the empty list
(<code>list()</code>), then all parameters of the model are assumed to be independent,
and the unrestricted model is estimated. The default value is the empty
list <code>list()</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>...</code></td>
<td>
<p>Additional arguments passed on to the function <code>adjpin()</code>. The
recognized arguments are <code>hyperparams</code>, and <code>fact</code>. The argument
<code>hyperparams</code> consists of a list containing the hyperparameters of the <code>ECM</code>
algorithm. When not empty, it contains one or more  of the following
elements: <code>maxeval</code>, and <code>tolerance</code>. It is used only when the <code>method</code>
argument is set to <code>"ECM"</code>. The argument <code>fact</code> is a binary value that
determines which likelihood functional form is used: A factorization of
the likelihood function by Ersan and Ghachem (2022b)
when it is set to <code>TRUE</code>, otherwise, the original likelihood function of
Duarte and Young (2009). The default value is <code>TRUE</code>.
More about these arguments are in the Details section.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>verbose</code></td>
<td>
<p>A binary variable that determines whether
detailed information about the steps of the estimation of the AdjPIN model
is displayed. No output is produced when <code>verbose</code> is set to
<code>FALSE</code>. The default value is <code>TRUE</code>.</p>
</td>
</tr>
</table>
<h3>Details</h3>

<p>The argument 'data' should be a numeric dataframe, and contain
at least two variables. Only the first two variables will be considered:
The first variable is assumed to correspond to the total number of
buyer-initiated trades, while the second variable is assumed to
correspond to the total number of seller-initiated trades. Each row or
observation correspond to a trading day. <code>NA</code> values will be ignored.
</p>
<p>If <code>initialsets</code> is neither a dataframe, nor a character string from the
set <code style="white-space: pre;">⁠{"GE",⁠</code> <code style="white-space: pre;">⁠"CL",⁠</code> <code style="white-space: pre;">⁠"RANDOM"}⁠</code>, the estimation of the <code>AdjPIN</code> model is
aborted. The default initial parameters (<code>"GE"</code>) for the estimation
method are generated using a modified hierarchical agglomerative
clustering. For more information, see <code>initials_adjpin()</code>.
</p>
<p>The argument <code>hyperparams</code>  contains the hyperparameters of the <code>ECM</code>
algorithm. It is either empty or contains one or two  of the following
elements:
</p>

<ul>
<li> <p><code>maxeval</code>: (<code>integer</code>) It stands for maximum number of iterations of
the <code>ECM</code>  algorithm for each initial parameter set. When missing, <code>maxeval</code>
takes the default value of <code>100</code>.
</p>
</li>
<li> <p><code>tolerance</code> (<code>numeric</code>) The <code>ECM</code> algorithm is stopped when the
(relative) change of log-likelihood is  smaller than tolerance. When
missing, <code>tolerance</code> takes the default value of <code>0.001</code>.
</p>
</li>
</ul>
<h3>Value</h3>

<p>Returns an object of class <code>estimate.adjpin</code>.
</p>


<h3>References</h3>

<p>Cheng T, Lai H (2021).
“Improvements in estimating the probability of informed trading models.”
<em>Quantitative Finance</em>, <b>21</b>(5), 771-796.<br><br> Duarte J, Young L (2009).
“Why is PIN priced?”
<em>Journal of Financial Economics</em>, <b>91</b>(2), 119–138.
ISSN 0304405X.<br><br> Ersan O, Ghachem M (2022b).
“A methodological approach to the computational problems in the estimation of adjusted PIN model.”
<em>Available at SSRN 4117954</em>.<br><br> Ghachem M, Ersan O (2022a).
“Estimation of the probability of informed trading models via an expectation-conditional maximization algorithm.”
<em>Available at SSRN 4117952</em>.<br><br> Ghachem M, Ersan O (2022b).
“PINstimation: An R package for estimating models of probability of informed trading.”
<em>Available at SSRN 4117946</em>.
</p>


<h3>Examples</h3>

<pre><code class="language-R"># We use 'generatedata_adjpin()' to generate a S4 object of type 'dataset'
# with 60 observations.

sim_data &lt;- generatedata_adjpin(days = 60)

# The actual dataset of 60 observations is stored in the slot 'data' of the
# S4 object 'sim_data'. Each observation corresponds to a day and contains
# the total number of buyer-initiated transactions ('B') and seller-
# initiated transactions ('S') on that day.

xdata &lt;- sim_data@data

# ------------------------------------------------------------------------ #
# Compare the unrestricted AdjPIN model with various restricted models     #
# ------------------------------------------------------------------------ #

# Estimate the unrestricted AdjPIN model using the ECM algorithm (default),
# and show the estimation output

estimate.adjpin.0 &lt;- adjpin(xdata, verbose = FALSE)

show(estimate.adjpin.0)

# Estimate the restricted AdjPIN model where mub=mus

estimate.adjpin.1 &lt;- adjpin(xdata, restricted = list(mu = TRUE),
                                  verbose = FALSE)

# Estimate the restricted AdjPIN model where eps.b=eps.s

estimate.adjpin.2 &lt;- adjpin(xdata, restricted = list(eps = TRUE),
                                  verbose = FALSE)

# Estimate the restricted AdjPIN model where d.b=d.s

estimate.adjpin.3 &lt;- adjpin(xdata, restricted = list(d = TRUE),
                                  verbose = FALSE)

# Compare the different values of adjusted PIN

estimates &lt;- list(estimate.adjpin.0, estimate.adjpin.1,
                  estimate.adjpin.2, estimate.adjpin.3)

adjpins &lt;- sapply(estimates, function(x) x@adjpin)

psos &lt;- sapply(estimates, function(x) x@psos)

summary &lt;- cbind(adjpins, psos)
rownames(summary) &lt;- c("unrestricted", "same.mu", "same.eps", "same.d")

show(round(summary, 5))

</code></pre>


</div>