<div class="container">

<table style="width: 100%;"><tr>
<td>phylog.gls.fit</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>Phylogenetically-Based GLS Model Fitting </h2>

<h3>Description</h3>

<p>Fits a GLS linear model, as in Garland and Ives (2000), using a
phylogenetic variance-covariance function</p>


<h3>Usage</h3>

<pre><code class="language-R">phylog.gls.fit(x, y, cov.matrix, intercept = TRUE, exclude.tips = NULL)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>x</code></td>
<td>
<p>The predictor or ”X” variables; they must be numeric
variables. If you are using a factor, you must recode it numerically,
with the appropriate type of contrasts —see function contrasts and
Venables &amp; Ripley (1999) ch. 6</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>y</code></td>
<td>
<p> The response</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>cov.matrix</code></td>
<td>
<p> The phylogenetic variance-covariance matrix, which
can be obtained from read.phylog.matrix.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>intercept</code></td>
<td>
<p> Include an intercept in the model? Defaults to TRUE </p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>exclude.tips</code></td>
<td>
<p> The tips to be excluded from the
analyses. Defaults to NULL</p>
</td>
</tr>
</table>
<h3>Value</h3>

<p>a fitted linear model</p>


<h3>WARNING</h3>

<p>This is one possible implementation of GLS that uses
the transformation of the Y and X as explained in Garland and Ives (2000). Ideally, we
would directly call gls from the NLME package, passing it the var-cov
matrix, but there are some printing problems of the fitted object in the R implementation when we use a
fixed correation structure. The advantage
of using gls from NLME is that the function is called using the
typical syntax for linear models, and we do not need to worry about making
categorical factors into numerical variables. Once the problem with
NLME is solved I'll add functions to incorporate GLS into the analysis
of data sets.
</p>
<p>In the meantime, when using this function, you should be aware
that:
</p>
<p>1) the overall F-test reported is wrong (it is like comparing to a
model without an intercept);
</p>
<p>2) you can apply the usual plot(fitted.model) to see diagnostic plots,
or other diagnostic functions such as lm.influence,
influence.measures, etc.  But most of these will be wrong and meaningless.</p>


<h3>Author(s)</h3>

<p>Ramon Diaz-Uriarte and Theodore Garland, Jr.</p>


<h3>References</h3>

<p>Diaz-Uriarte, R., and Garland, T., Jr., in prep. PHYLOGR:
an R package for the analysis of comparative data via Monte Carlo
simulations and generalized least squares approaches.
</p>
<p>Garland, T. Jr. and Ives, A. R. (2000) Using the past to predict the
present: confidence intervals for regression equations in phylogenetic
comparative methods. <em>The American Naturalist</em>, 155, 346-364.
</p>
<p>Venables, W. N. and Ripley, B. D. (1999) <em>Modern applied
statistics with S-Plus, 3rd ed.</em> Springer-Verlag.
</p>


<h3>See Also</h3>

<p><code>read.phylog.matrix</code>, <code>matrix.D</code></p>


<h3>Examples</h3>

<pre><code class="language-R">data(Lacertid.varcov)
data(Lacertid.Original)
ex.gls.phylog &lt;-
phylog.gls.fit(Lacertid.Original$svl,Lacertid.Original$clutch.size,Lacertid.varcov)
ex.gls.phylog
</code></pre>


</div>