<div class="container">

<table style="width: 100%;"><tr>
<td>VDJ_assemble_for_PnP</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>Ab sequence assembly for recombinant PnP expression</h2>

<h3>Description</h3>

<p>Assembles sequences from MIXCR output into inserts for expression in PnP cells. For detailes check https://doi.org/10.1038/ncomms12535 ! ALWAYS VALIDATE INDIVIDUAL SEQUENCE IN GENEIOUS OR OTHER SOFTWARE BEFORE ORDERING SEQUENCES FOR EXPRESSION ! Check notes on column content below ! Only cells with 1 VDJ and 1 VJ sequence are considered. Warnings are issued if sequences do not pass necessary checks
</p>


<h3>Usage</h3>

<pre><code class="language-R">VDJ_assemble_for_PnP(
  VDJ.mixcr.matrix,
  id.column,
  species,
  manual_IgKC,
  manual_2A,
  manual_VDJLeader,
  write.to.disk,
  filename,
  verbose
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>VDJ.mixcr.matrix</code></td>
<td>
<p>Output dataframe from the VDJ_call_MIXCR function or a dataframe generated using the VDJ_GEX_matrix function and supplemented with MIXCR information (Needed columns: All Framework and CDR sequences)</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>id.column</code></td>
<td>
<p>Character. Column name of VDJ.mixcr.matrix to use as ID for the assembled sequences. Defaults to "barcode"</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>species</code></td>
<td>
<p>Character. Which IgKC sequence to use. Can be "human" or "mouse". Defaults to "mouse"</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>manual_IgKC</code></td>
<td>
<p>Character. Manual overwrite for sequence used as IgKC.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>manual_2A</code></td>
<td>
<p>Character. Manual overwrite for sequence used as Furine 2A site.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>manual_VDJLeader</code></td>
<td>
<p>Character. Manual overwrite for sequence used as VDJ Leader and signal peptide.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>write.to.disk</code></td>
<td>
<p>Boolean. Defaults to TRUE. Whether to save assembled sequences to working directory</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>filename</code></td>
<td>
<p>Character. Output file name for .fasta and .csv files if write.to.disk == TRUE. Defaults to PnP_assembled_seqs.fasta/.csv</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>verbose</code></td>
<td>
<p>Print runtime message to console. Defaults to FALSE</p>
</td>
</tr>
</table>
<h3>Value</h3>

<p>Returns the input VGM matrix with one additional column containing the assembles sequences. If write.to.disk == TRUE writes a CSV containing key columns of the VGM as well as a .FASTA file to the current working director (getwd())
! Important notes on column content:
1. The column "seq_length_check" contains either "passed" or "FAILED". If FAILED, this means that at least one of the sequences (e.g. FRL1) was shorter than 9NTs and therefore considered invalid. Please check for missing sequences if you find any warnings
2. The column "seq_codon_check" is deemed "passed" if all CDR and FR input sequences of a cell contain only full codons (i.e. are divisible by 3)
3. The column "PnP_assembled_seqs" contains the assembled sequences / inserts for PnP expression. These should be validated manually in Geneious or other software and can then be ordered to be synthesized.
4. The column "PnP_assembled_annotations" contains a string of annotations for the respective assembled sequence. The structure is | [Sequence element] -&gt; [index (starting from 1) of last nucleotide of the sequence element] ...
5. The column "PnP_assembled_translations" contains the amino acid translation of the full contig that will result from the assembled insert in the backbone PnP vector. Please note: the sequences in the PnP_assembled_translation resulted from pasting the VJ leader sequence (contained in the PnP vector backbone), the PnP_assembled_seqs (The insert itself) and a surrogate stop codon ATAA. If correct, the translation should only contain one * (stop codon) at the very end. For reference: VJLeader sequence: ATGGATTTTCAGGTGCAGATTTTCAGCTTCCTGCTAATCAGCGCTTCAGTTATAATGTCCCGGGGG
6. The column "seq_VJCDR3_check" is deemed "passed" if the translated sequence of the input VJ CDR3 is found in the translated assembled sequence. If this test fails, there is likely an issue with the VJ segment
7. The column "seq_Fur2A_check" is deemed "passed" if correct AA sequence of the 2A site is found in the translated assembled sequence. If this test fails, and the seq_VJCDR3_test was passed, there is likely an issue at the border between VJ and IgKC/2A sequences
8. The column "seq_VDJCDR3_check" is deemed "passed" if the translated sequence of the input VDJ CDR3 is found in the translated assembled sequence.
9. The column "seq_splicesite_check" is deemed passed if the last 6 nucleotides of the assembled sequence are one of the following: "TCCTCA", "TCTTCA","TCGTCA","TCATCA".
</p>


<h3>Examples</h3>

<pre><code class="language-R">
try({
VGM_with_PnP_seq &lt;- VDJ_assemble_for_PnP(VDJ.mixcr.matrix = VDJ_call_MIXCR.output
, id.column = "barcode",species = "mouse", manual_IgKC = "none", manual_2A = "none"
, manual_VDJLeader = "none", write.to.disk = FALSE, filename = "PnP_seq_example")
})

</code></pre>


</div>