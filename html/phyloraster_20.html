<div class="container">

<table style="width: 100%;"><tr>
<td>rast.pd.ses</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>Phylogenetic diversity standardized for species richness</h2>

<h3>Description</h3>

<p>Calculates the standardized effect size for phylogenetic
diversity.
See Details for more information.
</p>


<h3>Usage</h3>

<pre><code class="language-R">rast.pd.ses(
  x,
  tree,
  edge.path,
  branch.length,
  spat_alg = "bootspat_str",
  spat_alg_args = list(rprob = NULL, rich = NULL, fr_prob = NULL),
  random = c("tip", "spat")[2],
  aleats = 10,
  filename = "",
  ...
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>x</code></td>
<td>
<p>SpatRaster. A SpatRaster containing presence-absence data (0 or 1)
for a set of species. The layers (species) will be sorted according to the
tree order. See the phylo.pres function.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>tree</code></td>
<td>
<p>phylo. A dated tree.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>edge.path</code></td>
<td>
<p>matrix representing the paths through the tree from root
to each tip. See <code>phylo.pres</code></p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>branch.length</code></td>
<td>
<p>numeric. A Named numeric vector of branch length for
each species. See <code>phylo.pres</code></p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>spat_alg</code></td>
<td>
<p>A function with the algorithm implementing the desired
randomization method. It must work with SpatRaster objects. See examples.
Example of functions that work are: <code>bootspat_naive</code>,
<code>bootspat_str</code>, <code>bootspat_ff</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>spat_alg_args</code></td>
<td>
<p>List of arguments passed to the randomization method
chosen in 'spat_alg'. See <code>bootspat_naive</code>, <code>bootspat_str</code>,
<code>bootspat_ff</code></p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>random</code></td>
<td>
<p>character. A character indicating the type of randomization.
The currently available randomization methods are "tip", "site", "species" or
"both" (site and species).</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>aleats</code></td>
<td>
<p>positive integer. A positive integer indicating how many times
the calculation should be repeated.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>filename</code></td>
<td>
<p>character. Output filename</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>...</code></td>
<td>
<p>additional arguments passed for terra::app</p>
</td>
</tr>
</table>
<h3>Details</h3>

<p>The spatial randomization (spat) keeps the richness exact and
samples
species presences proportionally to their observed frequency (i.e. number
of occupied pixels). The randomization will not assign values to cells with
nodata. The phylogenetic randomization shuffles taxa names across all taxa
included in phylogeny.
</p>
<p>The spatial randomization (spat) keeps the richness exact and
samples species presences proportionally to their observed frequency
(i.e. number of occupied pixels). The randomization will not assign values
to cells with nodata. The phylogenetic randomization shuffles taxa names
across all taxa included in phylogeny.
</p>


<h3>Value</h3>

<p>SpatRaster
</p>
<p>SpatRaster. The function returns the observed phylogenetic diversity,
the mean of the simulations calculated over n times, the standard deviation
of
the simulations, and the standardized effect size (SES) for the phylogenetic
diversity.
</p>


<h3>Author(s)</h3>

<p>Gabriela Alves-Ferreira and Neander Heming
</p>


<h3>References</h3>

<p>Faith, D. P. (1992). Conservation evaluation and phylogenetic
diversity. Biological conservation, 61(1), 1-10.
</p>


<h3>See Also</h3>

<p><code>phylo.pres</code>, <code>inv.range</code>,
<code>geo.phylo.ses</code>,
<code>rast.ed.ses</code>, <code>rast.pd.ses</code>,
<code>rast.we.ses</code>, <code>rast.pe.ses</code>,
<code>bootspat_str</code>,
<code>bootspat_naive</code>,
<code>bootspat_ff</code>,
<code>SESraster</code>
</p>


<h3>Examples</h3>

<pre><code class="language-R">
library(terra)
library(phyloraster)
library(SESraster)
x &lt;- rast(system.file("extdata", "rast.presab.tif",
package="phyloraster"))
tree &lt;- ape::read.tree(system.file("extdata", "tree.nex",
package="phyloraster"))
data &lt;- phylo.pres(x[[1:10]], tree)
t &lt;- rast.pd.ses(data$x, edge.path = data$edge.path,
                branch.length = data$branch.length, aleats = 3,
                random = "spat")
plot(t)

</code></pre>


</div>