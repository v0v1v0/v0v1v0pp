<div class="container">

<table style="width: 100%;"><tr>
<td>phyl.resid</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>Phylogenetic size-correction via GLS regression</h2>

<h3>Description</h3>

<p>Computes the residuals from the phylogenetic regression of multiple <em>y</em> variables (in a matrix) on a single <em>x</em>.
</p>


<h3>Usage</h3>

<pre><code class="language-R">phyl.resid(tree, x, Y, method="BM")
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>tree</code></td>
<td>
<p>a phylogenetic tree in <code>"phylo"</code> format.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>x</code></td>
<td>
<p>vector containing the single independent variable (e.g., size), or matrix with multiple independent variables in columns.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>Y</code></td>
<td>
<p>vector or matrix with one or multiple dependent variables in columns.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>method</code></td>
<td>
<p>method to obtain the correlation structure: can be <code>"BM"</code> or <code>"lambda"</code>.</p>
</td>
</tr>
</table>
<h3>Details</h3>

<p>This function fits one or multiple phylogenetic regressions (depending on the number of columns in <code>Y</code>) and computes the residuals.  Designed for phylogenetic size correction using GLS regression (e.g., Revell 2009).
</p>
<p>Optionally fits <code class="reqn">\lambda</code> for each regression model.  Likelihood optimization of <code class="reqn">\lambda</code> is performed for <code>method=</code> <code>"lambda"</code> using <code>optimize</code> on the interval (0,1).
</p>
<p>This function is theoretically redundant with <code>residuals</code> applied to a <code>"gls"</code> object class in which the correlation structure is based on <code>corBrownian</code> or <code>corPagel</code>; however some users may find this method simpler, and it provides a good way to cross-check your results &amp; make sure that you are using <code>gls</code> correctly.
</p>


<h3>Value</h3>

<p>A list with the following elements:
</p>
<table>
<tr style="vertical-align: top;">
<td><code>beta</code></td>
<td>
<p>a vector or matrix of regression coefficients.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>resid</code></td>
<td>
<p>a vector or matrix of residuals for species.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>lambda</code></td>
<td>
<p>a vector of <code class="reqn">\lambda</code> values (<code>method="lambda"</code> only).</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>logL</code></td>
<td>
<p>a vector of log-likelihoods (<code>method="lambda"</code> only).</p>
</td>
</tr>
</table>
<h3>Author(s)</h3>

<p>Liam Revell <a href="mailto:liam.revell@umb.edu">liam.revell@umb.edu</a></p>


<h3>References</h3>

<p>Revell, L. J. (2009) Size-correction and principal components for interspecific comparative studies. <em>Evolution</em>, <b>63</b>, 3258-3268.
</p>
<p>Revell, L. J. (2010) Phylogenetic signal and linear regression on species data. <em>Methods in Ecology and Evolution</em>, <b>1</b>, 319-329.
</p>
<p>Revell, L. J. (2024) phytools 2.0: an updated R ecosystem for phylogenetic comparative methods (and other things). <em>PeerJ</em>, <b>12</b>, e16505.
</p>


<h3>See Also</h3>

<p><code>phyl.pca</code>, <code>gls</code>
</p>


</div>