<div class="container">

<table style="width: 100%;"><tr>
<td>Cache T</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>Cache calculated Canonical Statistics for Potts Models.</h2>

<h3>Description</h3>

<p>Variety of functions to support caching of calculated canonical
statistics for Potts Models.  There is some attempt at being 'smart'
with when to regenerate the statistics.
</p>


<h3>Usage</h3>

<pre><code class="language-R">generate_t_cache(x, ncolor, t_stat, sizeA, npixel, f,
                 fapply=lapply, gridcache=NULL)

gengridcache(ncolor, sizeCA, ncol)

gensingleton(ncolor)

singleton(x, ncolor, a, idx, gridcache=NULL)

gentwopixel(ncolor)

twopixel(x, ncolor, a, idx, gridcache=NULL)

twopixel.nonoverlap(x, ncolor, a, idx, gridcache=NULL)

genfourpixel(ncolor)

fourpixel(x, ncolor, a, idx, gridcache=NULL)

fourpixel.nonoverlap(x, ncolor, a, idx, gridcache=NULL)

genthreebythree(ncolor)

ninepixel.nonoverlap(x, ncolor, a, idx, gridcache=NULL)

genfourbyfour(ncolor)

sixteenpixel.nonoverlap(x, ncolor, a, idx, gridcache=NULL)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>t_stat</code></td>
<td>
<p>numerical vector of length <code>ncolor</code>.  Contains the
canonical statistic for the whole image.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>sizeA</code></td>
<td>
<p>numerical.  The number of elements in <code class="reqn">\mathcal{A}</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>sizeCA</code></td>
<td>
<p>numerical.  The number of elements in <code class="reqn">C^A</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>npixel</code></td>
<td>
<p>numerical.  The number of pixels in one element of
<code class="reqn">\mathcal{A}</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>f</code></td>
<td>
<p>function.  Takes arguments <code>x</code>, <code>ncolor</code>, <code>a</code>,
<code>idx</code> and <code>ncolor</code>.  Returns value of
<code>t_calc_innergrid</code> with window <code class="reqn">A_a</code> replaced
by the <code class="reqn">\texttt{idx}^{th}</code>
element of <code class="reqn">C^A</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>fapply</code></td>
<td>
<p>function.  It should behave exactly as lapply does.
You can use this argument to enable parallel computing.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>gridcache</code></td>
<td>
<p>list.  Optional.  If non-null, it is a list of the
elements of <code class="reqn">C^A</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>x</code></td>
<td>
<p>numeric, 2 dimensional matrix, elements in 1, ..., <code>ncolor</code>,
representing a Potts model.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>ncolor</code></td>
<td>
<p>numeric.  Number of colors in this Potts Model.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>ncol</code></td>
<td>
<p>numeric.  Gives the number of columns in a rectangular
window.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>a</code></td>
<td>
<p>numeric.  Indicates which member of <code class="reqn">\mathcal{A}</code> is being
referenced.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>idx</code></td>
<td>
<p>numeric.  Indicates which element of <code class="reqn">C^A</code> is
being referenced.</p>
</td>
</tr>
</table>
<h3>Details</h3>

<p>For a description of notation and terminology, see
<code>composite.ll</code>.
</p>
<p>This set of functions is used to generate cached calculations of the
canonical statistic of a Potts model suitable for passing into
<code>composite.ll</code> or <code>gr.composite.ll</code>.
</p>
<p>All of the calculations using <code>composite.ll</code> and these
caching functions need one of the color components to be dropped for
the model to be identifiable.  For simplicity, the first color is
dropped by <code>generate_t_cache</code>.  In computing the composite log
likelihood for a Potts model with <code>ncolor</code> colors, we are
interested in many calculations across <code class="reqn">C^A</code>, the set of all
permutations of colors across a window.  These functions facilitate
those calculations.  <code>gridcache</code> is a list of <code class="reqn">C^A</code>.
</p>
<p><code>generate_t_cache</code> is the main function, and the others are
intended to be used in conjunction with it.  <code>generate_t_cache</code>
creates a list of arrays.  Each array represents one window in the
image, and each row of the array contains the value of
<code class="reqn">t(x)</code> (with one component dropped) found by replacing the
pixels in that window with one of the elements of <code class="reqn">C^A</code>.
</p>
<p><code>gengridcache</code> can generate the <code>gridcache</code> for any rectangular
window, give the number of colors, size of <code class="reqn">C^A</code>, and number
of columns in the window.  <code>gensingleton</code>, <code>gentwopixel</code>,
<code>genfourpixel</code>, <code>genthreebythree</code> and <code>genfourbyfour</code>
are all just simple wrappers for <code>gengridcache</code>.
</p>
<p><code>singleton</code>, <code>twopixel</code>, <code>twopixel.nonoverlap</code>,
<code>fourpixel</code>, <code>fourpixel.nonoverlap</code>,
<code>ninepixel.nonoverlap</code> and <code>sixteenpixel.nonoverlap</code> are
intended to be passed to <code>generate_t_cache</code> in the argument
<code>f</code>.  They are used to calculate <code class="reqn">t(ca_{idx} \cup X \setminus
  A_a)</code> for the
<code class="reqn">\texttt{idx}^{th}</code> element of <code class="reqn">C^{A_a}</code>.
</p>
<p>Functions that have <code>overlap</code> and <code>nonoverlap</code> versions
generate a overlapping and nonoverlapping set of windows respectively.
</p>
<p><code>singleton</code> is for a single pixel window (Besag or MPLE).
</p>
<p><code>twopixel</code> does a two horizontal pixel window.
</p>
<p><code>fourpixel</code> does a two by two pixel window.
</p>
<p><code>ninepixel</code> does a three by three pixel window.
</p>
<p><code>sixteenpixel</code> does a four by four pixel window.
</p>


<h3>Value</h3>

<p>Functions that start with <code>gen</code> return a <code>list</code> of the
elements of <code class="reqn">C^A</code>.  
</p>
<p>The other functions (e.g. <code>twopixel</code>, <code>fourpixel</code>, ...)
return the result of replacing the <code>a</code>-th window of <code>x</code> with
the <code>idx</code>-th element of <code class="reqn">C^A</code> and calculating
<code>calc_t_innergrid</code> for that window.
</p>


<h3>See Also</h3>

<p><code>composite.ll</code>, <code>calc_t</code>.
</p>


<h3>Examples</h3>

<pre><code class="language-R">
ncolor &lt;- 4
beta   &lt;- log(1+sqrt(ncolor))
theta  &lt;- c(rep(0,ncolor), beta)

nrow &lt;- 32
ncol &lt;- 32

x &lt;- matrix(sample(ncolor, nrow*ncol, replace=TRUE), nrow=nrow, ncol=ncol)
foo &lt;- packPotts(x, ncolor)
out &lt;- potts(foo, theta, nbatch=10)
x &lt;- unpackPotts(out$final)

t_stat &lt;- calc_t(x, ncolor)
t_cache_mple &lt;- generate_t_cache(x, ncolor, t_stat, nrow*ncol, 1,
                                 singleton)

## Not run: 
# use multicore to speed things up.
library(multicore)
t_cache_mple &lt;- generate_t_cache(x, ncolor, t_stat, nrow*ncol, 1,
                                 singleton, fapply=mclapply)

## End(Not run)

</code></pre>


</div>