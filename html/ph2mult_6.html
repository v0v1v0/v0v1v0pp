<div class="container">

<table style="width: 100%;"><tr>
<td>UIT.power</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>The power function for multinomial designs under union-intersection test (UIT)</h2>

<h3>Description</h3>

<p>Calculate the type I error or power of a multinomial (response and disease progression) single- or two-stage design under UIT:
<code class="reqn">H_0: p_1 \le p_{01} \  AND  \ p_2 \ge p_{02} \ versus \ H_1: p_1 \ge p_{11} &gt; p_{01} \ OR \ p_2 \le p_{12} &lt; p_{02}</code>
(Note: original Zee et al. (1999) set up the correct hypotheses, but did not make a match decision.)
</p>


<h3>Usage</h3>

<pre><code class="language-R">UIT.power(method, s1.rej, t1.rej, s1.acc, t1.acc, n1, s2.rej, t2.rej, n2, p.s, p.t,
output.all)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>method</code></td>
<td>
<p>design methods according to number of stage and stopping rule, "s1" represents single-stage design stopping for both efficacy and futility, "s2" represents two-stage design stopping for both efficacy and futility, "s2.f" represents two-stage design stopping for futility only.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>s1.rej</code></td>
<td>
<p>first stage responses threshold to stop the trial for efficacy. Applied for "s1" or "s2".</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>t1.rej</code></td>
<td>
<p>first stage disease progressions threshold to stop the trial for efficacy. Applied for "s1" or "s2".</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>s1.acc</code></td>
<td>
<p>first stage responses threshold to stop the trial for futility. Applied for "s2" or "s2.f".</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>t1.acc</code></td>
<td>
<p>first stage disease progressions threshold to stop the trial for futility. Applied for "s2" or "s2.f".</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>n1</code></td>
<td>
<p>first stage sample size. Applied for "s1", "s2" or "s2.f".</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>s2.rej</code></td>
<td>
<p>second stage responses threshold to stop the trial for efficacy. Applied for "s2" or "s2.f".</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>t2.rej</code></td>
<td>
<p>second stage disease progressions threshold to stop the trial for efficacy. Applied for "s2" or "s2.f".</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>n2</code></td>
<td>
<p>second stage sample size. Applied for "s2" or "s2.f".</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>p.s</code></td>
<td>
<p>pre-specified response rate, <code class="reqn">p.s=p_{01}</code> for calculating type I error , <code class="reqn">p=p_{11}</code> for calculating power.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>p.t</code></td>
<td>
<p>pre-specified disease progression rate,  <code class="reqn">p.s=p_{02}</code> for calculating type I error, <code class="reqn">p=p_{12}</code> for calculating power.
Note: type I error calculation needs to take maximum of the power function with <code class="reqn">(p.s,p.t)=(p_{01},0)</code> and <code class="reqn">(p.s,p.t)=(1-p_{02},p_{02})</code></p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>output.all</code></td>
<td>
<p>logical, if FALSE (default), only output the value of power or type I error, otherwise, also output the probability of early termination (PET) and expected sample size (EN). Applied for "s2" or "s2.f".</p>
</td>
</tr>
</table>
<h3>Value</h3>

<table><tr style="vertical-align: top;">
<td><code>prob</code></td>
<td>
<p>the power function <code class="reqn">g(...,p.s,p.t)</code>: <code class="reqn">\alpha = \max [g(...,p_{01},0), g(...,1-p_{02},p_{02}) ]</code> or <code class="reqn">g(...,p_{11},p_{12})</code></p>
</td>
</tr></table>
<h3>References</h3>

<p>Zee, B., Melnychuk, D., Dancey, J., &amp; Eisenhauer, E. (1999).
<em>Multinomial phase II cancer trials incorporating response and early progression.</em>
<em>Journal of biopharmaceutical statistics, </em> <strong>9(2),</strong> 351-363.
</p>


<h3>Examples</h3>

<pre><code class="language-R">p01=0.1; p02=0.9
## Calculate type I error for single-stage design
UIT.power(method="s1", s1.rej=6, t1.rej=19, n1=25, p.s=p01, p.t=p02)
## Calculate power for single-stage design
UIT.power(method="s1", s1.rej=6, t1.rej=19, n1=25, p.s=p01+0.2, p.t=p02-0.2)

## Calculate type I error for two-stage design, output PET and EN under null hypothesis
UIT.power(method="s2", s1.rej=4, t1.rej=9, s1.acc=0, t1.acc=13, n1=13,
s2.rej=6, t2.rej=18, n2=11, p.s=p01, p.t=p02, output.all=TRUE)
## Calculate power for two-stage design
UIT.power(method="s2", s1.rej=4, t1.rej=9, s1.acc=0, t1.acc=13, n1=13,
s2.rej=6, t2.rej=18, n2=11, p.s=p01+0.2, p.t=p02-0.2)

## Calculate type I error for two-stage design stopping for futility only,
## output PET and EN under null hypothesis
UIT.power(method="s2.f", s1.acc=0, t1.acc=13, n1=13,
s2.rej=6, t2.rej=18, n2=11, p.s=p01, p.t=p02, output.all=TRUE)
## Calculate power for two-stage design
UIT.power(method="s2.f", s1.acc=0, t1.acc=13, n1=13,
s2.rej=6, t2.rej=18, n2=11, p.s=p01+0.2, p.t=p02-0.2)
</code></pre>


</div>