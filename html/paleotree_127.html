<div class="container">

<table style="width: 100%;"><tr>
<td>perCapitaRates</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>Instantaneous <em>per-Capita</em> Rates of Origination and Extinction from the Fossil Record</h2>

<h3>Description</h3>

<p>Calculates and plots per-capita origination and extinction rates from
sequential discrete-time taxon ranges, following Foote (2000).
</p>


<h3>Usage</h3>

<pre><code class="language-R">perCapitaRates(
  timeList,
  plot = TRUE,
  logRates = FALSE,
  drop.extant = FALSE,
  isExtant = NULL,
  jitter = TRUE,
  legendPosition = "topleft"
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>timeList</code></td>
<td>
<p>A list composed of two matrices, giving interval start and end 
dates and taxon first and last occurrences within those intervals. See details.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>plot</code></td>
<td>
<p>If <code>TRUE</code>, the per-capita origination and extinctions rates are 
plotted for each interval. Rates which cannot be calculated for an interval
will not be plotted, thus appearing as a gap in the plotted graph. The
author takes no responsibility for the aesthetics of this plot.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>logRates</code></td>
<td>
<p>If <code>TRUE</code>, rates plotted on log scale.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>drop.extant</code></td>
<td>
<p>Drops all extant taxa from a dataset before
calculating per-capita origination and extinction rates.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>isExtant</code></td>
<td>
<p>A vector of <code>TRUE</code> and <code>FALSE</code> values, same length as the
number of taxa in the second matrix of <code>timeList</code>, where <code>TRUE</code> values indicate
taxa that are alive in the modern day (and thus are boundary crossers which
leave the most recent interval). By default, this argument is <code>NULL</code> and instead
which taxa are extant is inferred based on which taxa occur in an interval
with start and end times both equal to zero. See details.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>jitter</code></td>
<td>
<p>If <code>TRUE</code> (default) the extinction rate will be plotted slightly
ahead of the origination rate on the time axis, so the two can be differentiated.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>legendPosition</code></td>
<td>
<p>The position of a legend indicating which line is
origination rate and which is extinction rate on the resulting plot. This
is given as the possible positions for argument <code>x</code> of the function 
<code>legend</code>, and by default is <code>"topleft"</code>, which will be generally
useful if origination and extinction rates are initially low. If 
<code>legendPosition = NA</code>, then a legend will not be plotted.</p>
</td>
</tr>
</table>
<h3>Details</h3>

<p>This function calculates the per-capita rates of taxonomic origination
and extinction from paleontological range data, as described by Foote 
(2000). These values are the instantaneous rate of either type of event
occurring per lineage time-units. Although Foote (2001) also presents a
number of alternative rates collected from the prior literature such as
the 'Van Valen' rate metrics, these are not implemented here, but could be
estimated using the matrix invisibly output by this function (See Foote,
2000, for the relevant equations for calculating these).
</p>
<p>The <code>timeList</code> object should be a list composed of two matrices, the first
matrix giving by-interval start and end times (in absolute time), the second
matrix giving the by-taxon first and last appearances in the intervals
defined in the first matrix, numbered as the rows. Absolute time should be
decreasing, while the intervals should be numbered so that the number
increases with time. Taxa alive in the modern should be either 
(a) listed in <code>isExtant</code> or 
(b) listed as last occurring in a time interval
that begins at time 0 and ends at time 0. 
See the documentation for the time-scaling 
function <code>bin_timePaleoPhy</code> and the simulation function 
<code>binTimeData</code> for more information on formatting.
</p>
<p>Unlike some functions in <code>paleotree</code>, such as the diversity curve functions,
intervals must be both sequential and non-overlapping. The diversity curve
functions deal with such issues by assuming taxa occur from the base of the
interval they are first found in until the end of the last interval they
are occur in. This inflation of boundary crossers could badly bias estimates
of per-capita diversification rates.
</p>


<h3>Value</h3>

<p>This function will invisibly return a ten column matrix,
where the number of rows is equal to the number of intervals. The
first two columns are interval start and end times and the third
column is interval length. The fourth through eighth column is the
four fundamental classes of taxa from Foote (2001):
<code>Nbt</code>, <code>NbL</code>, <code>NFt</code>, <code>NFL</code> and their sum, <code>N</code>.
The final two columns are the per-capita rates estimated for
each interval in units per lineage time-units;
the ninth column is the origination rate (<code>pRate</code>) and the tenth
column is the extinction rate (<code>qRate</code>).
</p>


<h3>References</h3>

<p>Foote, M. 2000 Origination and extinction components of taxonomic diversity:
general problems. Pp. 74â€“102. In D. H. Erwin, and S. L. Wing, eds. Deep
Time: Paleobiology's Perspective. The Paleontological Society, Lawrence,
Kansas.
</p>


<h3>See Also</h3>

<p><code>DiversityCurves</code>, <code>SamplingConv</code>
</p>


<h3>Examples</h3>

<pre><code class="language-R">


#with the retiolinae dataset
data(retiolitinae)
perCapitaRates(retioRanges)

# Simulate some fossil ranges with simFossilRecord
set.seed(444)
record &lt;- simFossilRecord(
    p = 0.1, q = 0.1, nruns = 1, nTotalTaxa = c(80,100), nExtant = 0)
taxa &lt;- fossilRecord2fossilTaxa(record)

#simulate a fossil record with imperfect sampling with sampleRanges()
rangesCont &lt;- sampleRanges(taxa,r = 0.5)

#Now let's use binTimeData() to bin in intervals of 5 time units
rangesDisc &lt;- binTimeData(rangesCont,int.length = 5)

#and get the per-capita rates
perCapitaRates(rangesDisc)

#on a log scale
perCapitaRates(rangesDisc,logRates = TRUE)


#get mean and median per-capita rates
res &lt;- perCapitaRates(rangesDisc,plot = FALSE)

apply(res[,c("pRate","qRate")],2,mean,na.rm = TRUE)

apply(res[,c("pRate","qRate")],2,median,na.rm = TRUE)

##############################
#with modern taxa
set.seed(444)

record &lt;- simFossilRecord(
    p = 0.1, 
    q = 0.1, 
    nruns = 1,
    nExtant = c(10,50)
    )
    
taxa &lt;- fossilRecord2fossilTaxa(record)

#simulate a fossil record with imperfect sampling with sampleRanges()
rangesCont &lt;- sampleRanges(taxa,r = 0.5,,modern.samp.prob = 1)

#Now let's use binTimeData() to bin in intervals of 5 time units
rangesDisc &lt;- binTimeData(rangesCont,int.length = 5)

#and now get per-capita rates
perCapitaRates(rangesDisc)


</code></pre>


</div>