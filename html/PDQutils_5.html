<div class="container">

<table style="width: 100%;"><tr>
<td>dapx_gca</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>Approximate density and distribution via Gram-Charlier A expansion.</h2>

<h3>Description</h3>

<p>Approximate the probability density or cumulative distribution function of a distribution via its raw moments.
</p>


<h3>Usage</h3>

<pre><code class="language-R">dapx_gca(x, raw.moments, support=NULL, 
 basis=c('normal','gamma','beta','arcsine','wigner'), 
 basepar=NULL, log=FALSE)

papx_gca(q, raw.moments, support=NULL, 
 basis=c('normal','gamma','beta','arcsine','wigner'), 
 basepar=NULL, lower.tail=TRUE, log.p=FALSE)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>x</code></td>
<td>
<p>where to evaluate the approximate density.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>raw.moments</code></td>
<td>
<p>an atomic array of the 1st through kth raw moments
of the probability distribution.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>support</code></td>
<td>
<p>the support of the density function. It is assumed
that the density is zero on the complement of this open interval.
This defaults to <code>c(-Inf,Inf)</code> for the normal basis,
<code>c(0,Inf)</code> for the gamma basis, and
<code>c(0,1)</code> for the Beta, and 
<code>c(-1,1)</code> for the arcsine and wigner.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>basis</code></td>
<td>
<p>the basis under which to perform the approximation. <code>'normal'</code>
gives the classical 'A' series expansion around the PDF and CDF of the normal
distribution via Hermite polynomials. <code>'gamma'</code> expands around a
gamma distribution with parameters <code>basepar$shape</code> and
<code>basepar$scale</code>. 
<code>'beta'</code> expands around a beta distribution with parameters
<code>basepar$shape1</code> and <code>basepar$shape2</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>basepar</code></td>
<td>
<p>the parameters for the base distribution approximation. 
If <code>NULL</code>, the shape and rate are inferred from the first two moments
and/or from the <code>support</code> as appropriate.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>log</code></td>
<td>
<p>logical; if TRUE, densities <code class="reqn">f</code> are given 
as <code class="reqn">\mbox{log}(f)</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>q</code></td>
<td>
<p>where to evaluate the approximate distribution.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>log.p</code></td>
<td>
<p>logical; if TRUE, probabilities p are given 
as <code class="reqn">\mbox{log}(p)</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>lower.tail</code></td>
<td>
<p>whether to compute the lower tail. If false, we approximate the survival function.</p>
</td>
</tr>
</table>
<h3>Details</h3>

<p>Given the raw moments of a probability distribution, we can approximate the probability 
density function, or the cumulative distribution function, via a Gram-Charlier 
expansion on the standardized distribution. This expansion uses
some weighting function, <code class="reqn">w</code>, typically the density of some 'parent'
probability distribution, and polynomials, <code class="reqn">p_n</code> which are
orthogonal with respect to that weighting:
</p>
<p style="text-align: center;"><code class="reqn">\int_{-\infty}^{\infty} p_n(x) p_m(x) w(x) \mathrm{d}x = h_n \delta_{mn}.</code>
</p>

<p>Let <code class="reqn">f(x)</code> be the probability density of some random variable,
with cumulative distribution function <code class="reqn">F(x)</code>. We express
</p>
<p style="text-align: center;"><code class="reqn">f(x) = \sum_{n \ge 0} c_n p_n(x) w(x)</code>
</p>

<p>The constants <code class="reqn">c_n</code> can be computed from the known moments
of the distribution.
</p>
<p>For the Gram Charlier 'A' series, the weighting function is the PDF of the
normal distribution, and the polynomials are the (probabilist's) Hermite
polynomials. As a weighting function, one can also use the PDF of the gamma
distribution (resulting in generalized Laguerre polynomials), or the
PDF of the Beta distribution (resulting in Jacobi polynomials).
</p>


<h3>Value</h3>

<p>The approximate density at <code>x</code>, or the approximate CDF at
</p>


<h3>Note</h3>

<p>Monotonicity of the CDF is not guaranteed.
</p>


<h3>Author(s)</h3>

<p>Steven E. Pav <a href="mailto:shabbychef@gmail.com">shabbychef@gmail.com</a>
</p>


<h3>References</h3>

<p>Jaschke, Stefan R. "The Cornish-Fisher-expansion in the context of 
Delta-Gamma-normal approximations." No. 2001, 54. Discussion Papers, 
Interdisciplinary Research Project 373: Quantification and Simulation of 
Economic Processes, 2001. 
<a href="http://www.jaschke-net.de/papers/CoFi.pdf">http://www.jaschke-net.de/papers/CoFi.pdf</a>
</p>
<p>S. Blinnikov and R. Moessner. "Expansions for nearly Gaussian
distributions." Astronomy and Astrophysics Supplement 130 (1998): 193-205.
<a href="http://arxiv.org/abs/astro-ph/9711239">http://arxiv.org/abs/astro-ph/9711239</a>
</p>


<h3>See Also</h3>

<p><code>qapx_cf</code>
</p>


<h3>Examples</h3>

<pre><code class="language-R"># normal distribution:
xvals &lt;- seq(-2,2,length.out=501)
d1 &lt;- dapx_gca(xvals, c(0,1,0,3,0), basis='normal')
d2 &lt;- dnorm(xvals)
# they should match:
d1 - d2

qvals &lt;- seq(-2,2,length.out=501)
p1 &lt;- papx_gca(qvals, c(0,1,0,3,0))
p2 &lt;- pnorm(qvals)
p1 - p2

xvals &lt;- seq(-6,6,length.out=501)
mu &lt;- 2
sigma &lt;- 3
raw.moments &lt;- c(2,13,62,475,3182)
d1 &lt;- dapx_gca(xvals, raw.moments, basis='normal')
d2 &lt;- dnorm(xvals,mean=mu,sd=sigma)
## Not run: 
plot(xvals,d1)
lines(xvals,d2,col='red')

## End(Not run)
p1 &lt;- papx_gca(xvals, raw.moments, basis='normal')
p2 &lt;- pnorm(xvals,mean=mu,sd=sigma)
## Not run: 
plot(xvals,p1)
lines(xvals,p2,col='red')

## End(Not run)

# for a one-sided distribution, like the chi-square
chidf &lt;- 30
ords &lt;- seq(1,9)
raw.moments &lt;- exp(ords * log(2) + lgamma((chidf/2) + ords) - lgamma(chidf/2))
xvals &lt;- seq(0.3,10,length.out=501)
d1g &lt;- dapx_gca(xvals, raw.moments, support=c(0,Inf), basis='gamma')
d2 &lt;- dchisq(xvals,df=chidf)
## Not run: 
plot(xvals,d1g)
lines(xvals,d2,col='red')

## End(Not run)

p1g &lt;- papx_gca(xvals, raw.moments, support=c(0,Inf), basis='gamma')
p2 &lt;- pchisq(xvals,df=chidf)
## Not run: 
plot(xvals,p1g)
lines(xvals,p2,col='red')

## End(Not run)

# for a one-sided distribution, like the log-normal
mu &lt;- 2
sigma &lt;- 1
ords &lt;- seq(1,8)
raw.moments &lt;- exp(ords * mu + 0.5 * (sigma*ords)^2)
xvals &lt;- seq(0.5,10,length.out=501)
d1g &lt;- dapx_gca(xvals, raw.moments, support=c(0,Inf), basis='gamma')
d2 &lt;- dnorm(log(xvals),mean=mu,sd=sigma) / xvals
## Not run: 
	plot(xvals,d1g)
	lines(xvals,d2,col='red')

## End(Not run)
</code></pre>


</div>