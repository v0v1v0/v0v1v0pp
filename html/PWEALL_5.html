<div class="container">

<table style="width: 100%;"><tr>
<td>fourhr</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>A utility functon</h2>

<h3>Description</h3>

<p>This will calculate the more complex integration</p>


<h3>Usage</h3>

<pre><code class="language-R">fourhr(t=seq(0,5,by=0.5),rate1=c(0,5,0.8),rate2=rate1,
                   rate3=c(0.1,0.2),rate4=rate2,tchange=c(0,3),eps=1.0e-2)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>t</code></td>
<td>
<p>A vector of time points</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>rate1</code></td>
<td>
<p>piecewise constant event rate</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>rate2</code></td>
<td>
<p>piecewise constant event rate</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>rate3</code></td>
<td>
<p>piecewise constant event rate</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>rate4</code></td>
<td>
<p>additional piecewise constant</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>tchange</code></td>
<td>
<p>a strictly increasing sequence of time points starting from zero at which event rate changes. The first element of tchange must be zero. The above rates and tchange must have the same length.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>eps</code></td>
<td>
<p>tolerance</p>
</td>
</tr>
</table>
<h3>Details</h3>

<p>Let <code class="reqn">h_1,\ldots,h_4</code> correspond to <code>rate1</code>,...,<code>rate4</code>, and <code class="reqn">H_1,\ldots,H_4</code> be the corresponding survival functions. 
We calculate
</p>
<p style="text-align: center;"><code class="reqn">\int_0^t h_1(s)H_2(s)h_3(t-s)H_4(t-s)ds.</code>
</p>



<h3>Value</h3>

<table><tr style="vertical-align: top;">
<td><code>fx</code></td>
<td>
<p>values</p>
</td>
</tr></table>
<h3>Note</h3>

<p>This provides the result of the complex integration</p>


<h3>Author(s)</h3>

<p>Xiaodong Luo</p>


<h3>References</h3>

<p>Luo et al. (2018) Design and monitoring of survival trials in complex scenarios, Statistics in Medicine &lt;doi: https://doi.org/10.1002/sim.7975&gt;.
</p>


<h3>See Also</h3>

<p><code>rpwe</code></p>


<h3>Examples</h3>

<pre><code class="language-R">r1&lt;-c(0.6,0.3)
r2&lt;-c(0.6,0.6)
r3&lt;-c(0.1,0.2)
r4&lt;-c(0.5,0.4)
tchange&lt;-c(0,1.75)
fourhrfun&lt;-fourhr(t=seq(0,5,by=0.5),rate1=r1,rate2=r2,rate3=r3,
                 rate4=r4,tchange=c(0,3),eps=1.0e-2)
fourhrfun
</code></pre>


</div>