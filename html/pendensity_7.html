<div class="container">

<table style="width: 100%;"><tr>
<td>Derv1</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>Calculating the first derivative of the pendensity likelihood function w.r.t. parameter beta</h2>

<h3>Description</h3>

<p>Calculating the first derivative of the pendensity likelihood function w.r.t. parameter beta. 
</p>


<h3>Usage</h3>

<pre><code class="language-R">Derv1(penden.env)
</code></pre>


<h3>Arguments</h3>

<table><tr style="vertical-align: top;">
<td><code>penden.env</code></td>
<td>
<p>Containing all information, environment of pendensity()</p>
</td>
</tr></table>
<h3>Details</h3>

<p>We calculate the first derivative of the pendensity likelihood function w.r.t. the parameter beta. The calculation of the first derivative of the pendensity likelihood function w.r.t. parameter beta is done in four steps. The first derivative equals in the case of covariates
</p>
<p style="text-align: center;"><code class="reqn">s(\beta)= {\partial l(\beta)}/{\partial \beta}= \sum_{i=1}^n s_i(\beta)</code>
</p>

<p>where
</p>
<p style="text-align: center;"><code class="reqn">s_i(\beta) = {{\bf \mathcal{Z}}^T(x_i)} {{\bf \mathcal{C}}^T (x_i,\beta)} \frac{\tilde{\boldsymbol\phi}_i}{\hat{f}(y_i|x_i)}</code>
</p>
<p><br>
Without covariates, the matrix 'Z' doesn't appear. Starting density calculation, the groupings of the covariates are indexed in the main program. The groupings are saved in 'x.factor'. Creating an index that reports which response belongs to which covariate group, saving in 'Z.index'. Therefore, one can link to the rows in the object 'ck' to calculate the matrix 'C.bold', which depends only on the grouping of the covariate. Without any covariate, 'C.bold' is equal for every observation.<br>
The calculation of the first derivative of the pendensity likelihood function w.r.t. parameter beta is done in four steps. Firstly, we calculate the matrix 'C.bold', depending on the groups of 'x.factor'.<br>
Secondly, for calculating we need the fitted values of each observation, 'f.hat'. These values are calculated for the actual parameter set beta in the program 'f.hat'. Of course, we need the value of the base for each observation, <code class="reqn">\phi[i]</code>.<br>
Moreover, for the case of conditional density estimation, we need a Z-Matrix, due to the rules for derivations of the function 'exp()'. This Z-matrix doesn't appear directly in the calculations. We construct the multiplication with this Z-matrix with using an outer product between the corresponding grouping in 'x.factor' and the product of the corresponding values 'C.bold' and 'base.den', divided by the fitted value 'f.hat'. Finally, we add some penalty on the derivative, which is calculated in the fourth step. The penalty equals <code class="reqn">-\lambda D_m \beta </code>.<br>
For later use, we save the unpenalized first derivative as a matrix, in which the i-th column contains the first derivative of the pendensity likelihood function, evaluated for the i-th value of the response. The needed values are saved in the environment.</p>


<h3>Value</h3>

<table>
<tr style="vertical-align: top;">
<td><code>Derv1.cal</code></td>
<td>
<p>matrix, in which the i-th column contains the first derivative, evaluated for the i-th value of the response variable without penalty. Needed for calculating the second order derivative, called <code class="reqn">s(\beta)</code></p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>Derv1.pen</code></td>
<td>
<p>first order derivation of the penalized likelihood function w.r.t. parameter beta, called </p>
<p style="text-align: center;"><code class="reqn">s_p(\beta)</code>
</p>
 </td>
</tr>
<tr style="vertical-align: top;">
<td><code>f.hat.val</code></td>
<td>
<p>fitted values of the response for actual parameter beta, called <code class="reqn">\hat{f}</code></p>
</td>
</tr>
</table>
<h3>Author(s)</h3>

<p>Christian Schellhase &lt;cschellhase@wiwi.uni-bielefeld.de&gt;</p>


<h3>References</h3>

<p>Density Estimation with a Penalized Mixture Approach, Schellhase C. and Kauermann G. (2012), Computational Statistics 27 (4), p. 757-777.</p>


</div>