<div class="container">

<table style="width: 100%;"><tr>
<td>pcgen</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>Causal inference with genetic effects</h2>

<h3>Description</h3>

<p>Reconstruction of directed networks with random genetic effects, based on phenotypic observations. The pcgen algorithm is a modification of the pc-stable algorithm of Colombo &amp; Maathuis (2014) . It is assumed that there are replicates, and independent genetic effects.
</p>


<h3>Usage</h3>

<pre><code class="language-R">pcgen(suffStat, covariates = NULL, QTLs = integer(), alpha = 0.01, m.max = Inf,
fixedEdges = NULL, fixedGaps = NULL, verbose = FALSE, use.res = FALSE, 
res.cor = NULL, max.iter = 50, stop.if.significant = TRUE, return.pvalues = FALSE)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>suffStat</code></td>
<td>
<p>A data.frame, of which the first column is the factor G (genotype),  and subsequent columns contain the traits, and optionally some QTLs. The name of the first column should be G. Should not contain covariates.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>covariates</code></td>
<td>
<p>A data.frame containing covariates, that should always be used in each conditional independence test Should be either <code>NULL</code> (default) or a data.frame with the same number of rows as <code>suffStat</code>. An intercept is already included for each trait in suffStat; covariates should not contain a column of ones.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>QTLs</code></td>
<td>
<p>Column numbers in <code>suffStat</code> that correspond to QTLs.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>alpha</code></td>
<td>
<p>The significance level used in each conditional independence test. Default is 0.01</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>m.max</code></td>
<td>
<p>Maximum size of the conditioning sets</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>fixedEdges</code></td>
<td>
<p>A logical matrix of dimension <code class="reqn">(p+1) \times (p+1)</code>, where <code class="reqn">p</code> is the number of traits. The first row and column refer to the node G, and subsequent rows and columns to the traits. As in the pcalg package, the edge <code class="reqn">i - j</code> is never considered for removal if the entry <code class="reqn">[i, j]</code> or <code class="reqn">[j, i]</code> (or both) are <code>TRUE</code>. In that case, the edge is guaranteed to be present in the resulting graph.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>fixedGaps</code></td>
<td>
<p>A logical matrix of dimension <code class="reqn">(p+1) \times (p+1)</code>, where <code class="reqn">p</code> is the number of traits. The first row and column refer to the node G, and subsequent rows and columns to the traits. As in the pcalg package, the edge <code class="reqn">i - j</code> is removed before starting the algorithm if the entry <code class="reqn">[i, j]</code> or <code class="reqn">[j, i]</code> (or both) are <code>TRUE</code>. In that case, the edge is guaranteed to be absent in the resulting graph.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>verbose</code></td>
<td>
<p>If <code>TRUE</code>, p-values for the conditional independence tests are printed</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>use.res</code></td>
<td>
<p>If <code>TRUE</code>, the test for conditional independence of 2 traits given a set of other traits and <code class="reqn">G</code> is based on residuals from GBLUP. If <code>FALSE</code> (the default), it is based on bivariate mixed models.
</p>
</td>
</tr>
</table>
<table>
<tr style="vertical-align: top;">
<td><code>res.cor</code></td>
<td>
<p>If <code>use.res = TRUE</code>, res.cor should be the correlation matrix of the residuals from the GBLUP. These can be obtained with the getResiduals function. See the example below.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>max.iter</code></td>
<td>
<p>Maximum number of iterations in the EM-algorithm, used to fit the bivariate mixed model (when <code>use.res = FALSE)</code>. </p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>stop.if.significant</code></td>
<td>
<p>If <code>TRUE</code>, the EM-algorithm used in some of the conditional independence tests (when <code>use.res = FALSE</code>) will be stopped whenever the p-value becomes significant, i.e. below <code>alpha</code>. This will speed up calculations, and can be done because (1) the PC algorithm only needs an accept/reject decision (2) In EM the likelihood is nondecreasing. Should be put to <code>FALSE</code> if the precise p-values are of interest.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>return.pvalues</code></td>
<td>
<p>If <code>TRUE</code>, the maximal p-value for each edge is returned.</p>
</td>
</tr>
</table>
<h3>Details</h3>

<p>The <code>pcgen</code> function is based on the <code>pc</code> function from the pcalg package (Kalisch et al. (2012) and Hauser and Buhlmann (2012)). 
</p>


<h3>Value</h3>

<p>If <code>return.pvalues = FALSE</code>, the output is a graph (an object with S3 class <code>"pcgen"</code>). If <code>return.pvalues = TRUE</code>, the output is a list with elements <code>gr</code> (the graph) and <code>pMax</code> (a matrix with the p-values).
</p>


<h3>Author(s)</h3>

<p>Willem Kruijer and Pariya Behrouzi.
Maintainers: Willem Kruijer <a href="mailto:willem.kruijer@wur.nl">willem.kruijer@wur.nl</a> and
Pariya Behrouzi <a href="mailto:pariya.behrouzi@gmail.com">pariya.behrouzi@gmail.com</a>
</p>


<h3>References</h3>

<p>1. Kruijer, W., Behrouzi, P., Rodriguez-Alvarez, M. X., Wit, E. C., Mahmoudi, S. M., Yandell, B., Van Eeuwijk, F., (2018, in preparation), Reconstruction of networks with direct and indirect genetic effects. <br>
2. Colombo, D. and Maathuis, M.H., 2014. Order-independent constraint-based causal structure learning. <em>The Journal of Machine Learning Research</em>, 15(1), pp.3741-3782. <br>
3. Kalisch, M., Machler, M., Colombo, D., Maathuis, M.H. and Buhlmann, P., 2012. Causal inference using graphical models with the R package pcalg. <em>Journal of Statistical Software</em>, 47(11), pp.1-26. <br>
4. Hauser, A. and Buhlmann, P., 2012. Characterization and greedy learning of interventional Markov equivalence classes of directed acyclic graphs. Journal of Machine Learning Research, 13(Aug), pp.2409-2464.<br></p>


<h3>See Also</h3>

<p><code>getResiduals</code></p>


<h3>Examples</h3>

<pre><code class="language-R">
data(simdata)
out &lt;- pcgen(simdata) 

data(simdata)
rs &lt;- getResiduals(suffStat = simdata)
pc.fit1 &lt;- pcgen(suffStat = simdata, alpha = 0.01, verbose = TRUE, 
           use.res = TRUE, res.cor = cor(rs))
</code></pre>


</div>