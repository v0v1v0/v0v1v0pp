<div class="container">

<table style="width: 100%;"><tr>
<td>Kmatrix</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>
Matrix of Coefficients in a Linear Model
</h2>

<h3>Description</h3>

<p>This function obtains a matrix of coefficients for parametric models such as <code>aov</code>, <code>lm</code>, 
<code>glm</code>, <code>gls</code>, <code>lme</code>, and <code>lmer</code>.
</p>


<h3>Usage</h3>

<pre><code class="language-R">Kmatrix(model, modelterm, covariate=NULL, covariateV=NULL, data=NULL, prtnum=FALSE)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>model</code></td>
<td>

<p>Model object returned by <code>aov</code>, <code>lm</code>, <code>glm</code>, <code>gls</code>, <code>lme</code>, and <code>lmer</code>.
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>modelterm</code></td>
<td>

<p>Name (in "quotes") for indicating which model term's predicted mean to be calculated. 
The <code>modelterm</code> must be given exactly as it appears in the printed model, e.g. "A" or "A:B". 
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>covariate</code></td>
<td>

<p>A numerical vector to specify values of covariates for calculating predicted means, 
default values are the means of the associated covariates. It also can be the name of one covariate in the model.
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>covariateV</code></td>
<td>

<p>A numeric vector or list of numeric vector, then covariatemeans will produce the result for <code>covariate</code> at value of <code>covariateV</code>.
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>data</code></td>
<td>

<p>In some cases, you need to provide the data set used in model fitting, especially when you have applied some variable trnasformation in the model.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>prtnum</code></td>
<td>

<p>An option for printing covariate info on the screen or not. The default is FALSE.
</p>
</td>
</tr>
</table>
<h3>Value</h3>

<table>
<tr style="vertical-align: top;">
<td><code>K</code></td>
<td>
<p>Coefficients matrix</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>fctnames</code></td>
<td>
<p>A model frame contains factor(s) info in the model.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>response</code></td>
<td>
<p>The name of response variable in the model.</p>
</td>
</tr>
</table>
<h3>Author(s)</h3>

<p>This function heavily depends on the codes from package "lsmeans".
</p>


<h3>References</h3>

<p>Welham, S., Cullis, B., Gogel, B., Gilmour, A., &amp; Thompson, R. (2004),
<em>Prediction in linear mixed models</em>, Australian and New Zealand Journal of Statistics, 46(3), 325-347. 
</p>


<h3>Examples</h3>

<pre><code class="language-R">  library(predictmeans)
  data(Oats, package="nlme")
# fm &lt;- lmer(yield ~ nitro*Variety+(1|Block/Variety), data=Oats)
  fm &lt;- lme(yield ~ nitro*Variety, random=~1|Block/Variety, data=Oats)
  Kmatrix(fm, "Variety", prtnum=TRUE)$K
  Kmatrix(fm, "Variety", 0.5, prtnum=TRUE)$K
 # Kmatrix(fm, "Variety", "nitro")$K
  Kmatrix(fm, "Variety", "nitro", covariateV=seq(0, 0.6, 0.1))$K
</code></pre>


</div>