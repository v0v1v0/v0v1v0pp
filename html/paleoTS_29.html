<div class="container">

<table style="width: 100%;"><tr>
<td>opt.GRW.shift</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>Fit random walk model with shift(s) in generating parameters</h2>

<h3>Description</h3>

<p>Fit random walk model with shift(s) in generating parameters
</p>


<h3>Usage</h3>

<pre><code class="language-R">opt.GRW.shift(y, ng = 2, minb = 7, model = 1, pool = TRUE, silent = FALSE)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>y</code></td>
<td>
<p>a <code>paloeTS</code> object</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>ng</code></td>
<td>
<p>number of segments in the sequence</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>minb</code></td>
<td>
<p>minimum number of populations in each segment</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>model</code></td>
<td>
<p>numeric, specifies exact evolutionary model; see Details</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>pool</code></td>
<td>
<p>if TRUE, sample variances are substituted with their pooled estimate</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>silent</code></td>
<td>
<p>logical, if TRUE, progress updates are suppressed</p>
</td>
</tr>
</table>
<h3>Details</h3>

<p>Fits a model in which a sequence is divided into two or more segments and
trait evolution proceeds as a general random walk, with each segment (potentially)
getting its own generating parameters (<code>mstep</code>, <code>vstep</code>). <br><br></p>
<p>This function tests for shifts after each population, subject to the
constraint that the number of populations in each segment is always &gt;= <code>minb</code>. The
shiftpoint yielding the highest log-likelihood is returned as the solution, along with
the log-likelihoods (<code>all.logl</code> of all tested shift points (<code>GG</code>). <br><br></p>
<p>Different variants of the model can be specified by the <code>model</code> argument:
</p>

<ul>
<li> <p><code>model = 1:  </code> <code>mstep</code> is separate across segments; <code>vstep</code> is shared
</p>
</li>
<li> <p><code>model = 2:  </code> <code>mstep</code> is shared across segments; <code>vstep</code> is separate
</p>
</li>
<li> <p><code>model = 3:  </code> <code>mstep</code> is set to zero (unbiased random walk); <code>vstep</code>
is separate across segments
</p>
</li>
<li> <p><code>model = 4:  </code> <code>mstep</code> and <code>vstep</code> are both separate across segments
</p>
</li>
</ul>
<h3>Value</h3>

<p>a <code>paleoTSfit</code> object
</p>


<h3>See Also</h3>

<p><code>sim.GRW.shift</code>
</p>


<h3>Examples</h3>

<pre><code class="language-R">x &lt;- sim.GRW.shift(ns = c(15,15), ms = c(0, 1), vs = c(0.1,0.1))
w.sep &lt;- opt.GRW.shift(x, ng = 2, model = 4)
w.sameVs &lt;- opt.GRW.shift(x, ng = 2, model = 1)
compareModels(w.sep, w.sameVs)
plot(x)
abline(v = x$tt[16], lwd = 3)  # actual shift point
abline(v = x$tt[w.sameVs$par["shift1"]], lty = 3, col = "red", lwd = 2) # inferred shift point
</code></pre>


</div>