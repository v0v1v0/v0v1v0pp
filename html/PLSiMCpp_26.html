<div class="container">

<table style="width: 100%;"><tr>
<td>plsim.vs.soft</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>Penalized Profile Least Squares Estimator</h2>

<h3>Description</h3>

<p>PPLS along with introducing penalty terms so as to simultaneously
estimate parameters and select important variables in PLSiM 
</p>
<p style="text-align: center;"><code class="reqn">Y = \eta(Z^T\alpha) + X^T\beta + \epsilon</code>
</p>
<p>.
</p>


<h3>Usage</h3>

<pre><code class="language-R">plsim.vs.soft(...)

## S3 method for class 'formula'
plsim.vs.soft(formula, data, ...)

## Default S3 method:
plsim.vs.soft(xdat=NULL, zdat, ydat, h=NULL, zetaini=NULL, 
lambda=0.01, l1_ratio=NULL, MaxStep = 1L, penalty = "SCAD", verbose=TRUE, 
ParmaSelMethod="SimpleValidation", TestRatio=0.1, K = 3, seed=0, ...)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>...</code></td>
<td>
<p>additional arguments.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>formula</code></td>
<td>
<p>a symbolic description of the model to be fitted.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>data</code></td>
<td>
<p>an optional data frame, list or environment containing the variables in the model.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>xdat</code></td>
<td>
<p>input matrix (linear covariates). The model reduces to a single index model when <code>x</code> is NULL.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>zdat</code></td>
<td>
<p>input matrix (nonlinear covariates). <code>z</code> should not be NULL.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>ydat</code></td>
<td>
<p>input vector (response variable).</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>h</code></td>
<td>
<p>a value or a vector for bandwidth. If <code>h</code> is NULL, a default vector c(0.01,0.02,0.05,0.1,0.5)
will be set for it. plsim.bw is employed to select the optimal bandwidth when <code>h</code> is a vector or NULL.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>zetaini</code></td>
<td>
<p>initial coefficients, optional (default: NULL). It could be obtained by the function <code>plsim.ini</code>.
<code>zetaini[1:ncol(z)]</code> is the initial coefficient vector <code class="reqn">\alpha_0</code>,
and <code>zetaini[(ncol(z)+1):(ncol(z)+ncol(x))]</code> is the initial coefficient vector <code class="reqn">{\beta}_0</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>MaxStep</code></td>
<td>
<p>int, optional (default=1). Hard limit on iterations within solver.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>lambda</code></td>
<td>
<p>double. Constant that multiplies the penalty term.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>l1_ratio</code></td>
<td>
<p>double, default=NULL. It should be set with a value from the range <code class="reqn">[0,1]</code>
when you choose "ElasticNet" for the parameter <code>penalty</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>penalty</code></td>
<td>
<p>string, optional (default="SCAD"). It could be "SCAD", "LASSO" and "ElasticNet".</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>verbose</code></td>
<td>
<p>bool, default: TRUE. Enable verbose output.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>ParmaSelMethod</code></td>
<td>
<p>the parameter for the function plsim.bw.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>TestRatio</code></td>
<td>
<p>the parameter for the function plsim.bw.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>K</code></td>
<td>
<p>the parameter for the function plsim.vs.soft.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>seed</code></td>
<td>
<p>int, default: 0.</p>
</td>
</tr>
</table>
<h3>Value</h3>

<table>
<tr style="vertical-align: top;">
<td><code>eta</code></td>
<td>
<p>estimated non-parametric part <code class="reqn">\hat{\eta}(Z^T{\hat{\alpha} })</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>zeta</code></td>
<td>
<p>estimated coefficients. <code>zeta[1:ncol(z)]</code> is <code class="reqn">\hat{\alpha}</code>, 
and <code>zeta[(ncol(z)+1):(ncol(z)+ncol(x))]</code> is <code class="reqn">\hat{\beta}</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>y_hat</code></td>
<td>
 <p><code>y</code>'s estimates.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>mse</code></td>
<td>
<p>mean squared errors between y and <code>y_hat</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>data</code></td>
<td>
<p>data information including <code>x</code>, <code>z</code>, <code>y</code>, bandwidth <code>h</code>, 
initial coefficients <code>zetaini</code>, iteration step <code>MaxStep</code>, flag <code>SiMflag</code>, 
<code>penalty</code>, <code>lambda</code> and <code>l1_ratio</code>.
<code>SiMflag</code> is TRUE when <code>x</code> is NULL, otherwise <code>SiMflag</code> is FALSE.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>Z_alpha</code></td>
<td>
<p><code class="reqn">Z^T{\hat{\alpha}}</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>r_square</code></td>
<td>
<p>multiple correlation coefficient.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>variance</code></td>
<td>
<p>variance of <code>y_hat</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>stdzeta</code></td>
<td>
<p>standard error of <code>zeta</code>.</p>
</td>
</tr>
</table>
<h3>References</h3>

<p>H. Liang, X. Liu, R. Li, C. L. Tsai. <em>Estimation and testing for partially linear single-index models</em>.
Annals of statistics, 2010, 38(6): 3811.
</p>


<h3>Examples</h3>

<pre><code class="language-R"> 
# EXAMPLE 1 (INTERFACE=FORMULA)
# To estimate parameters of partially linear single-index model and select 
# variables using different penalization methods such as SCAD, LASSO, ElasticNet.

n = 50
sigma = 0.1

alpha = matrix(1,2,1)
alpha = alpha/norm(alpha,"2")

beta = matrix(4,1,1)

# Case 1: Matrix Input
x = matrix(1,n,1)
z = matrix(runif(n*2),n,2)
y = 4*((z%*%alpha-1/sqrt(2))^2) + x%*%beta + sigma*matrix(rnorm(n),n,1)

# Compute the penalized profile least-squares estimator with the SCAD penalty
fit_scad = plsim.vs.soft(y~x|z,lambda = 0.01)
summary(fit_scad)

# Compute the penalized profile least-squares estimator with the LASSO penalty
fit_lasso = plsim.vs.soft(y~x|z,lambda = 1e-3, penalty = "LASSO")
summary(fit_lasso)

# Compute the penalized profile least-squares estimator with the ElasticNet penalty
fit_enet = plsim.vs.soft(y~x|z,lambda = 1e-3, penalty = "ElasticNet")
summary(fit_enet)

# Case 2: Vector Input
x = rep(1,n)
z1 = runif(n)
z2 = runif(n) 
y = 4*((z%*%alpha-1/sqrt(2))^2) + x%*%beta + sigma*matrix(rnorm(n),n,1)

# Compute the penalized profile least-squares estimator with the SCAD penalty
fit_scad = plsim.vs.soft(y~x|z1+z2,lambda = 0.01)
summary(fit_scad)

# Compute the penalized profile least-squares estimator with the LASSO penalty
fit_lasso = plsim.vs.soft(y~x|z1+z2,lambda = 1e-3, penalty = "LASSO")
summary(fit_lasso)

# Compute the penalized profile least-squares estimator with the ElasticNet penalty
fit_enet = plsim.vs.soft(y~x|z1+z2,lambda = 1e-3, penalty = "ElasticNet")
summary(fit_enet)

# EXAMPLE 2 (INTERFACE=DATA FRAME)
# To estimate parameters of partially linear single-index model and select 
# variables using different penalization methods such as SCAD, LASSO, ElasticNet.

n = 50
sigma = 0.1

alpha = matrix(1,2,1)
alpha = alpha/norm(alpha,"2")

beta = matrix(4,1,1)

x = rep(1,n)
z1 = runif(n)
z2 = runif(n) 
X = data.frame(x)
Z = data.frame(z1,z2)

x = data.matrix(X)
z = data.matrix(Z)
y = 4*((z%*%alpha-1/sqrt(2))^2) + x%*%beta + sigma*matrix(rnorm(n),n,1)

# Compute the penalized profile least-squares estimator with the SCAD penalty
fit_scad = plsim.vs.soft(xdat=X,zdat=Z,ydat=y,lambda = 0.01)
summary(fit_scad)

# Compute the penalized profile least-squares estimator with the LASSO penalty
fit_lasso = plsim.vs.soft(xdat=X,zdat=Z,ydat=y,lambda = 1e-3, penalty = "LASSO")
summary(fit_lasso)

# Compute the penalized profile least-squares estimator with the ElasticNet penalty
fit_enet = plsim.vs.soft(xdat=X,zdat=Z,ydat=y,lambda = 1e-3, penalty = "ElasticNet")
summary(fit_enet)

</code></pre>


</div>