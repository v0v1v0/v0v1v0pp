<div class="container">

<table style="width: 100%;"><tr>
<td>prais_winsten</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>Prais-Winsten Estimator for AR(1) Serial Correlation</h2>

<h3>Description</h3>

<p>The Prais-Winsten estimator takes into account AR(1) serial correlation of the errors
in a linear regression model. The procedure recursively estimates the coefficients
and the error autocorrelation of the specified model until sufficient convergence of
the AR(1) coefficient is reached. All estimates are obtained by OLS.
</p>


<h3>Usage</h3>

<pre><code class="language-R">prais_winsten(
  formula,
  data,
  index,
  max_iter = 50L,
  tol = 1e-06,
  twostep = FALSE,
  panelwise = FALSE,
  rhoweight = c("none", "T", "T1"),
  ...
)

## S3 method for class 'prais'
print(x, digits = max(3L, getOption("digits") - 3L), ...)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>formula</code></td>
<td>
<p>an object of class <code>"formula"</code> (or one that can be coerced to that class):
a symbolic description of the model to be fitted.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>data</code></td>
<td>
<p>a data frame containing the variables in the model. If panel data is used,
it must also contain the ID and time variables.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>index</code></td>
<td>
<p>a character vector specifying the ID and time variables. If only one variable
is provided, it is assumed to be the time variable and the data will be reordered
accordingly.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>max_iter</code></td>
<td>
<p>integer specifying the maximum number of allowed iterations. Default is 50.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>tol</code></td>
<td>
<p>numeric specifying the maximum absolute difference between the estimator of <code class="reqn">rho</code>
in the current and the previous iteration that has to be attained to reach convergence.
Default is 1e-6.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>twostep</code></td>
<td>
<p>logical. If <code>TRUE</code>, the estimation will stop after the first iteration.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>panelwise</code></td>
<td>
<p>logical. If <code>TRUE</code>, <code class="reqn">\rho</code> will be calculated for each panel separately.
Default is <code>FALSE</code>. Only used for panel data. See 'Details'.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>rhoweight</code></td>
<td>
<p>character specifying how <code class="reqn">\rho</code> should be calculated if <code>panelwise = TRUE</code>.
See 'Details'.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>...</code></td>
<td>
<p>arguments passed to <code>lm</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>x</code></td>
<td>
<p>an object of class "prais", usually, a result of a call to <code>prais_winsten</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>digits</code></td>
<td>
<p>the number of significant digits to use when printing.</p>
</td>
</tr>
</table>
<h3>Details</h3>

<p>If <code class="reqn">\rho</code> takes a value above 1 during the estimation process,
the Prais-Winsten transformation cannot be applied to the first
observations, because <code class="reqn">(1 - \rho^2)^{(1 / 2)}</code> is not real. These observations
are dropped during the respective iteration and the estimator effectively becomes
the Cochrane-Orcutt estimator.
</p>
<p>If <code>panelwise = TRUE</code>, <code>twostep = FALSE</code> and <code>rhoweight = "none"</code>,
each individual estimate of <code class="reqn">rho</code> is re-estimated until convergence is achieved for all coefficients.
</p>
<p>If <code>panelwise = TRUE</code>, the calculation of <code class="reqn">\rho</code> can be further specified in argument
<code>rhoweight</code>. If <code>rhoweight = "none"</code>, <code class="reqn">\rho</code> is assumed to be panel-specific. If
<code>rhoweight = "T"</code>, <code class="reqn">\rho</code> is calculated as a weighted mean of panel-specific estimates, where
the number of available observations per panel, i.e. <code class="reqn">T_i</code>, is used as weight. If <code>rhoweight = "T1"</code>,
<code class="reqn">\rho</code> is calculated as a weighted mean of panel-specific estimates, where the number of available
observations per panel minus one, i.e. <code class="reqn">T_i - 1</code>, is used as weight.
</p>


<h3>Value</h3>

<p>A list of class <code>"prais"</code> containing the following components:
</p>
<table>
<tr style="vertical-align: top;">
<td><code>coefficients</code></td>
<td>
<p>a named vector of coefficients.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>rho</code></td>
<td>
<p>the values of the AR(1) coefficient <code class="reqn">\rho</code> from all iterations.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>residuals</code></td>
<td>
<p>the residuals, that is the response minus the fitted values.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>fitted.values</code></td>
<td>
<p>the fitted mean values.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>rank</code></td>
<td>
<p>the numeric rank of the fitted linear model.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>df.residual</code></td>
<td>
<p>the residual degrees of freedom.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>call</code></td>
<td>
<p>the matched call.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>terms</code></td>
<td>
<p>the terms object used.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>model</code></td>
<td>
<p>the original model frame, i.e., before the Prais-Winsten transformation.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>index</code></td>
<td>
<p>a character specifying the ID and time variables.</p>
</td>
</tr>
</table>
<h3>References</h3>

<p>Beck, N. L. and Katz, J. N. (1995): What to do (and not to do) with time-series cross-section data. American Political Science Review 89, 634-647.
</p>
<p>Prais, S. J. and Winsten, C. B. (1954): Trend Estimators and Serial Correlation. Cowles Commission Discussion Paper, 383 (Chicago).
</p>
<p>Wooldridge, J. M. (2013): Introductory Econometrics. A Modern Approach. 5th ed. Mason, OH: South-Western Cengage Learning Cengage.
</p>


<h3>Examples</h3>

<pre><code class="language-R"># Generate an artificial sample
set.seed(1234567)
n &lt;- 100
x &lt;- sample(20:40, n, replace = TRUE)
rho &lt;- .5

# AR(1) errors
u &lt;- rnorm(n, 0, 5)
for (i in 2:n) {
  u[i] &lt;- u[i] + rho * u[i - 1]
}
pw_sample &lt;- data.frame("x" = x, "y" = 10 + 1.5 * x + u, "time" = 1:n)

# Estimate
pw &lt;- prais_winsten(y ~ x, data = pw_sample, index = "time")
summary(pw)

</code></pre>


</div>