<div class="container">

<table style="width: 100%;"><tr>
<td>details_rule_fit_h2o</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>RuleFit models via h2o</h2>

<h3>Description</h3>

<p><code>h2o::h2o.rulefit()</code> fits a model that derives simple feature rules from a tree
ensemble and uses the rules as features to a regularized (LASSO) model. <code>agua::h2o_train_rule()</code>
is a wrapper around this function.
</p>


<h3>Details</h3>

<p>For this engine, there are multiple modes: classification and regression
</p>


<h4>Tuning Parameters</h4>

<p>This model has 3 tuning parameters:
</p>

<ul>
<li> <p><code>trees</code>: # Trees (type: integer, default: 50L)
</p>
</li>
<li> <p><code>tree_depth</code>: Tree Depth (type: integer, default: 3L)
</p>
</li>
<li> <p><code>penalty</code>: Amount of Regularization (type: double, default: 0) Note
that <code>penalty</code> for the h2o engine in 'rule_fit()“ corresponds to
the L1 penalty (LASSO).
</p>
</li>
</ul>
<p>Other engine arguments of interest:
</p>

<ul>
<li> <p><code>algorithm</code>: The algorithm to use to generate rules. should be one of
“AUTO”, “DRF”, “GBM”, defaults to “AUTO”.
</p>
</li>
<li> <p><code>min_rule_length</code>: Minimum length of tree depth, opposite of
<code>tree_dpeth</code>, defaults to 3.
</p>
</li>
<li> <p><code>max_num_rules</code>: The maximum number of rules to return. The default
value of -1 means the number of rules is selected by diminishing
returns in model deviance.
</p>
</li>
<li> <p><code>model_type</code>: The type of base learners in the ensemble, should be one
of: “rules_and_linear”, “rules”, “linear”, defaults to
“rules_and_linear”.
</p>
</li>
</ul>
<h4>Translation from parsnip to the underlying model call (regression)</h4>

<p><code>agua::h2o_train_rule()</code> is a wrapper around
<code>h2o::h2o.rulefit()</code>.
</p>
<p>The <strong>agua</strong> extension package is required to fit this model.
</p>
<div class="sourceCode r"><pre>library(rules)

rule_fit(
  trees = integer(1),
  tree_depth = integer(1),
  penalty = numeric(1)
) %&gt;%
  set_engine("h2o") %&gt;%
  set_mode("regression") %&gt;%
  translate()
</pre></div>
<div class="sourceCode"><pre>## RuleFit Model Specification (regression)
## 
## Main Arguments:
##   trees = integer(1)
##   tree_depth = integer(1)
##   penalty = numeric(1)
## 
## Computational engine: h2o 
## 
## Model fit template:
## agua::h2o_train_rule(x = missing_arg(), y = missing_arg(), weights = missing_arg(), 
##     validation_frame = missing_arg(), rule_generation_ntrees = integer(1), 
##     max_rule_length = integer(1), lambda = numeric(1))
</pre></div>



<h4>Translation from parsnip to the underlying model call (classification)</h4>

<p><code>agua::h2o_train_rule()</code> for <code>rule_fit()</code> is a
wrapper around <code>h2o::h2o.rulefit()</code>.
</p>
<p>The <strong>agua</strong> extension package is required to fit this model.
</p>
<div class="sourceCode r"><pre>rule_fit(
  trees = integer(1),
  tree_depth = integer(1),
  penalty = numeric(1)
) %&gt;%
  set_engine("h2o") %&gt;%
  set_mode("classification") %&gt;%
  translate()
</pre></div>
<div class="sourceCode"><pre>## RuleFit Model Specification (classification)
## 
## Main Arguments:
##   trees = integer(1)
##   tree_depth = integer(1)
##   penalty = numeric(1)
## 
## Computational engine: h2o 
## 
## Model fit template:
## agua::h2o_train_rule(x = missing_arg(), y = missing_arg(), weights = missing_arg(), 
##     validation_frame = missing_arg(), rule_generation_ntrees = integer(1), 
##     max_rule_length = integer(1), lambda = numeric(1))
</pre></div>



<h4>Preprocessing requirements</h4>

<p>Factor/categorical predictors need to be converted to numeric values
(e.g., dummy or indicator variables) for this engine. When using the
formula method via <code>fit()</code>, parsnip will
convert factor columns to indicators.
</p>



<h4>Other details</h4>

<p>To use the h2o engine with tidymodels, please run <code>h2o::h2o.init()</code>
first. By default, This connects R to the local h2o server. This needs
to be done in every new R session. You can also connect to a remote h2o
server with an IP address, for more details see
<code>h2o::h2o.init()</code>.
</p>
<p>You can control the number of threads in the thread pool used by h2o
with the <code>nthreads</code> argument. By default, it uses all CPUs on the host.
This is different from the usual parallel processing mechanism in
tidymodels for tuning, while tidymodels parallelizes over resamples, h2o
parallelizes over hyperparameter combinations for a given resample.
</p>
<p>h2o will automatically shut down the local h2o instance started by R
when R is terminated. To manually stop the h2o server, run
<code>h2o::h2o.shutdown()</code>.
</p>



<h4>Saving fitted model objects</h4>

<p>Models fitted with this engine may require native serialization methods
to be properly saved and/or passed between R sessions. To learn more
about preparing fitted models for serialization, see the bundle package.
</p>



</div>