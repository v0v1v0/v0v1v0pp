<div class="container">

<table style="width: 100%;"><tr>
<td>rk4, rk4sys</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>
Classical Runge-Kutta
</h2>

<h3>Description</h3>

<p>Classical Runge-Kutta of order 4.
</p>


<h3>Usage</h3>

<pre><code class="language-R">rk4(f, a, b, y0, n)

rk4sys(f, a, b, y0, n)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>f</code></td>
<td>
<p>function in the differential equation <code class="reqn">y' = f(x, y)</code>;<br>
defined as a function <code class="reqn">R \times R^m \rightarrow R^m</code>, where <code class="reqn">m</code>
is the number of equations.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>a, b</code></td>
<td>
<p>endpoints of the interval.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>y0</code></td>
<td>
<p>starting values; for <code class="reqn">m</code> equations <code>y0</code> needs to be
a vector of length <code>m</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>n</code></td>
<td>
<p>the number of steps from <code>a</code> to <code>b</code>.</p>
</td>
</tr>
</table>
<h3>Details</h3>

<p>Classical Runge-Kutta of order 4 for (systems of) ordinary differential
equations with fixed step size.
</p>


<h3>Value</h3>

<p>List with components <code>x</code> for grid points between <code>a</code> and <code>b</code>
and <code>y</code> an n-by-m matrix with solutions for variables in columns, i.e.
each row contains one time stamp.
</p>


<h3>Note</h3>

<p>This function serves demonstration purposes only.
</p>


<h3>References</h3>

<p>Fausett, L. V. (2007). Applied Numerical Analysis Using Matlab.
Second edition, Prentice Hall.
</p>


<h3>See Also</h3>

<p><code>ode23</code>, <code>deval</code>
</p>


<h3>Examples</h3>

<pre><code class="language-R">##  Example1: ODE
# y' = y*(-2*x + 1/x) for x != 0, 1 if x = 0
# solution is x*exp(-x^2)
f &lt;- function(x, y) {
	if (x != 0) dy &lt;- y * (- 2*x + 1/x)
	else        dy &lt;- rep(1, length(y))
	return(dy)
}
sol &lt;- rk4(f, 0, 2, 0, 50)
## Not run: 
x &lt;- seq(0, 2, length.out = 51)
plot(x, x*exp(-x^2), type = "l", col = "red")
points(sol$x, sol$y, pch = "*")
grid()
## End(Not run)

##  Example2: Chemical process
  f &lt;- function(t, u) {
    u1 &lt;- u[3] - 0.1 * (t+1) * u[1]
    u2 &lt;- 0.1 * (t+1) * u[1] - 2 * u[2]
    u3 &lt;- 2 * u[2] - u[3]
    return(c(u1, u2, u3))
  }
u0 &lt;- c(0.8696, 0.0435, 0.0870)
a &lt;- 0; b &lt;- 40
n &lt;- 40
sol &lt;- rk4sys(f, a, b, u0, n)
## Not run: 
matplot(sol$x, sol$y, type = "l", lty = 1, lwd = c(2, 1, 1),
        col = c("darkred", "darkblue", "darkgreen"),
        xlab = "Time [min]", ylab= "Concentration [Prozent]",
        main = "Chemical composition")
grid()
## End(Not run)
</code></pre>


</div>