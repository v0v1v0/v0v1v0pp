<div class="container">

<table style="width: 100%;"><tr>
<td>nlsPlot</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>Function to visualize common <code>stats::nls</code> growth models.</h2>

<h3>Description</h3>

<p>Models fit using growthSS inputs by fitGrowth
(and similar models made through other means) can be visualized easily using this function.
This will generally be called by <code>growthPlot</code>.
</p>


<h3>Usage</h3>

<pre><code class="language-R">nlsPlot(
  fit,
  form,
  df = NULL,
  groups = NULL,
  timeRange = NULL,
  facetGroups = TRUE,
  groupFill = FALSE,
  virMaps = c("plasma")
)

gamPlot(
  fit,
  form,
  df = NULL,
  groups = NULL,
  timeRange = NULL,
  facetGroups = TRUE,
  groupFill = FALSE,
  virMaps = c("plasma")
)

lmPlot(
  fit,
  form,
  df = NULL,
  groups = NULL,
  timeRange = NULL,
  facetGroups = TRUE,
  groupFill = FALSE,
  virMaps = c("plasma")
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>fit</code></td>
<td>
<p>A model fit returned by <code>fitGrowth</code> with type="nls".</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>form</code></td>
<td>
<p>A formula similar to that in <code>growthSS</code> inputs (or the <code>pcvrForm</code>
part of the output) specifying the outcome, predictor, and grouping structure of the data as
<code>outcome ~ predictor|individual/group</code>.
If the individual and group are specified then the observed growth lines are plotted.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>df</code></td>
<td>
<p>A dataframe to use in plotting observed growth curves on top of the model.
This must be supplied for nls models.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>groups</code></td>
<td>
<p>An optional set of groups to keep in the plot.
Defaults to NULL in which case all groups in the model are plotted.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>timeRange</code></td>
<td>
<p>An optional range of times to use. This can be used to view predictions for
future data if the avaiable data has not reached some point (such as asymptotic size).</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>facetGroups</code></td>
<td>
<p>logical, should groups be separated in facets? Defaults to TRUE.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>groupFill</code></td>
<td>
<p>logical, should groups have different colors? Defaults to FALSE.
If TRUE then viridis colormaps are used in the order of virMaps</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>virMaps</code></td>
<td>
<p>order of viridis maps to use. Will be recycled to necessary length.
Defaults to "plasma", but will generally be informed by growthPlot's default.</p>
</td>
</tr>
</table>
<h3>Value</h3>

<p>Returns a ggplot showing an nls model's predictions.
</p>


<h3>Examples</h3>

<pre><code class="language-R">

simdf &lt;- growthSim("logistic",
  n = 20, t = 25,
  params = list("A" = c(200, 160), "B" = c(13, 11), "C" = c(3, 3.5))
)
ss &lt;- growthSS(
  model = "logistic", form = y ~ time | id / group,
  df = simdf, start = NULL, type = "nls"
)
fit &lt;- fitGrowth(ss)
nlsPlot(fit, form = ss$pcvrForm, df = ss$df, groupFill = TRUE)
nlsPlot(fit, form = ss$pcvrForm, df = ss$df, groups = "a", timeRange = 1:10)

simdf &lt;- growthSim("logistic",
  n = 20, t = 25,
  params = list("A" = c(200, 160), "B" = c(13, 11), "C" = c(3, 3.5))
)
ss &lt;- growthSS(
  model = "gam", form = y ~ time | id / group,
  df = simdf, start = NULL, type = "nls"
)
fit &lt;- fitGrowth(ss)
gamPlot(fit, form = ss$pcvrForm, df = ss$df, groupFill = TRUE)
gamPlot(fit, form = ss$pcvrForm, df = ss$df, groups = "a", timeRange = 1:10)
ss &lt;- growthSS(
  model = "gam", form = y ~ time | group,
  df = simdf, start = NULL, type = "nls"
)
fit &lt;- fitGrowth(ss)
gamPlot(fit, form = ss$pcvrForm, df = ss$df, groupFill = TRUE)

simdf &lt;- growthSim("logistic",
  n = 20, t = 25,
  params = list("A" = c(200, 160), "B" = c(13, 11), "C" = c(3, 3.5))
)
ss &lt;- growthSS(
  model = "gam", form = y ~ time | id / group,
  df = simdf, start = NULL, type = "nls"
)
fit &lt;- fitGrowth(ss)
lmPlot(fit, form = ss$pcvrForm, df = ss$df)
</code></pre>


</div>