<div class="container">

<table style="width: 100%;"><tr>
<td>impute</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>Imputation of missing values</h2>

<h3>Description</h3>

<p><code>impute</code> is calculating imputation values for missing data depending on the selected
method.
</p>


<h3>Usage</h3>

<pre><code class="language-R">impute(
  data,
  sample,
  grouping,
  intensity_log2,
  condition,
  comparison = comparison,
  missingness = missingness,
  noise = NULL,
  method = "ludovic",
  skip_log2_transform_error = FALSE,
  retain_columns = NULL
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>data</code></td>
<td>
<p>a data frame that is ideally the output from the <code>assign_missingness</code> function.
It should containing at least the input variables. For each "reference_vs_treatment" comparison,
there should be the pair of the reference and treatment condition. That means the reference
condition should be doublicated once for every treatment.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>sample</code></td>
<td>
<p>a character column in the <code>data</code> data frame that contains the sample names.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>grouping</code></td>
<td>
<p>a character column in the <code>data</code> data frame that contains the precursor or
peptide identifiers.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>intensity_log2</code></td>
<td>
<p>a numeric column in the <code>data</code> data frame that contains the intensity
values.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>condition</code></td>
<td>
<p>a character or numeric column in the <code>data</code> data frame that contains the
the conditions.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>comparison</code></td>
<td>
<p>a character column in the <code>data</code> data frame that contains the the
comparisons of treatment/reference pairs. This is an output of the <code>assign_missingnes</code>
function.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>missingness</code></td>
<td>
<p>a character column in the <code>data</code> data frame that contains the
missingness type of the data determines how values for imputation are sampled. This should at
least contain <code>"MAR"</code> or <code>"MNAR"</code>. Missingness assigned as <code>NA</code> will not be imputed.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>noise</code></td>
<td>
<p>a numeric column in the <code>data</code> data frame that contains the noise value for
the precursor/peptide. Is only required if <code>method = "noise"</code>. Note: Noise values need to
be log2 transformed.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>method</code></td>
<td>
<p>a character value that specifies the method to be used for imputation. For
<code>method = "ludovic"</code>, MNAR missingness is sampled from a normal distribution around a
value that is three lower (log2) than the lowest intensity value recorded for the
precursor/peptide and that has a spread of the mean standard deviation for the
precursor/peptide. For <code>method = "noise"</code>, MNAR missingness is sampled from a normal
distribution around the mean noise for the precursor/peptide and that has a spread of the
mean standard deviation (from each condition) for the precursor/peptide. Both methods impute
MAR data using the mean and variance of the condition with the missing data.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>skip_log2_transform_error</code></td>
<td>
<p>a logical value that determines if a check is performed to
validate that input values are log2 transformed. If input values are &gt; 40 the test is failed
and an error is returned.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>retain_columns</code></td>
<td>
<p>a vector that indicates columns that should be retained from the input
data frame. Default is not retaining additional columns <code>retain_columns = NULL</code>. Specific
columns can be retained by providing their names (not in quotations marks, just like other
column names, but in a vector).</p>
</td>
</tr>
</table>
<h3>Value</h3>

<p>A data frame that contains an <code>imputed_intensity</code> and <code>imputed</code> column in
addition to the required input columns. The <code>imputed</code> column indicates if a value was
imputed. The <code>imputed_intensity</code> column contains imputed intensity values for previously
missing intensities.
</p>


<h3>Examples</h3>

<pre><code class="language-R">set.seed(123) # Makes example reproducible

# Create example data
data &lt;- create_synthetic_data(
  n_proteins = 10,
  frac_change = 0.5,
  n_replicates = 4,
  n_conditions = 2,
  method = "effect_random",
  additional_metadata = FALSE
)

head(data, n = 24)

# Assign missingness information
data_missing &lt;- assign_missingness(
  data,
  sample = sample,
  condition = condition,
  grouping = peptide,
  intensity = peptide_intensity_missing,
  ref_condition = "all",
  retain_columns = c(protein, peptide_intensity)
)

head(data_missing, n = 24)

# Perform imputation
data_imputed &lt;- impute(
  data_missing,
  sample = sample,
  grouping = peptide,
  intensity_log2 = peptide_intensity_missing,
  condition = condition,
  comparison = comparison,
  missingness = missingness,
  method = "ludovic",
  retain_columns = c(protein, peptide_intensity)
)

head(data_imputed, n = 24)
</code></pre>


</div>