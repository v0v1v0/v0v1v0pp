<div class="container">

<table style="width: 100%;"><tr>
<td>unmix_matrix</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>Estimate average within-group covariance matrices from a mixture covariance matrix</h2>

<h3>Description</h3>

<p>Estimate average within-group covariance matrices from a mixture covariance matrix
</p>


<h3>Usage</h3>

<pre><code class="language-R">unmix_matrix(
  sigma_mat,
  mu_mat,
  p_vec,
  N = Inf,
  group_names = NULL,
  var_names = NULL
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>sigma_mat</code></td>
<td>
<p>Mixture covariance matrix.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>mu_mat</code></td>
<td>
<p>Matrix of mean parameters, with groups on the rows and variables on the columns.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>p_vec</code></td>
<td>
<p>Vector of proportion of cases in each group.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>N</code></td>
<td>
<p>Optional total sample size across all groups (used to compute unbiased covariance estimates).</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>group_names</code></td>
<td>
<p>Optional vector of group names.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>var_names</code></td>
<td>
<p>Optional vector of variable names.</p>
</td>
</tr>
</table>
<h3>Value</h3>

<p>List of within-group covariances and means.
</p>


<h3>Examples</h3>

<pre><code class="language-R">out &lt;- unmix_matrix(sigma_mat = reshape_vec2mat(.5, order = 2),
                    mu_mat = rbind(c(0, 0), c(.5, 1)),
                    p_vec =  c(.3, .7), N = 100)

## Result of unmix_matrix:
out

## Simulated data reproduce the total parameter matrix:
dat &lt;- NULL
for(i in 1:2){
     dat &lt;- rbind(dat, cbind(group = i,
                             data.frame(MASS::mvrnorm(n = round(out$p_group[i] * out$N),
                                                      mu = out$means_raw[i,],
                                                      Sigma = out$cov_group_unbiased[[i]],
                                                      empirical = TRUE))))
}
cov(dat[,-1])
</code></pre>


</div>