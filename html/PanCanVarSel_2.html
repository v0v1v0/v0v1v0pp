<div class="container">

<table style="width: 100%;"><tr>
<td>hsaftallcorr</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>This function extends the main function <code>hsaft</code> to create correlation among covariates.</h2>

<h3>Description</h3>

<p>This function extends the main function <code>hsaft</code> to create correlation among covariates.
</p>


<h3>Usage</h3>

<pre><code class="language-R">hsaftallcorr(ct, X, method.tau = c("fixed", "truncatedCauchy",
  "halfCauchy"), tau = 1, method.sigma = c("fixed", "Jeffreys"),
  Sigma2 = 1, burn = 1000, nmc = 5000, thin = 1, alpha = 0.05, r,
  n.seq, pk)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>ct</code></td>
<td>
<p>Response, a <code class="reqn">n*2</code> matrix with first column as response and second column as right censored indicator,
1 is event time and 0 is right censored.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>X</code></td>
<td>
<p>Matrix of covariates, dimension <code class="reqn">n*p</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>method.tau</code></td>
<td>
<p>Method for handling <code class="reqn">\tau</code>. Select "truncatedCauchy" for full
Bayes with the Cauchy prior truncated to [1/p, 1], "halfCauchy" for full Bayes with
the half-Cauchy prior, or "fixed" to use a fixed value (an empirical Bayes estimate,
for example).</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>tau</code></td>
<td>
<p>Use this argument to pass the (estimated) value of <code class="reqn">\tau</code> in case "fixed"
is selected for method.tau. Not necessary when method.tau is equal to"halfCauchy" or
"truncatedCauchy". The default (tau = 1) is not suitable for most purposes and should be replaced.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>method.sigma</code></td>
<td>
<p>Select "Jeffreys" for full Bayes with Jeffrey's prior on the error
variance <code class="reqn">\sigma^2</code>, or "fixed" to use a fixed value (an empirical Bayes
estimate, for example).</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>Sigma2</code></td>
<td>
<p>A fixed value for the error variance <code class="reqn">\sigma^2</code>. Not necessary
when method.sigma is equal to "Jeffreys". Use this argument to pass the (estimated)
value of Sigma2 in case "fixed" is selected for method.sigma. The default (Sigma2 = 1)
is not suitable for most purposes and should be replaced.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>burn</code></td>
<td>
<p>Number of burn-in MCMC samples. Default is 1000.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>nmc</code></td>
<td>
<p>Number of posterior draws to be saved. Default is 5000.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>thin</code></td>
<td>
<p>Thinning parameter of the chain. Default is 1 (no thinning).</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>alpha</code></td>
<td>
<p>Level for the credible intervals. For example, alpha = 0.05 results in
95% credible intervals.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>r</code></td>
<td>
<p>number of groups.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>n.seq</code></td>
<td>
<p>a vector of sample sizes for all groups.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>pk</code></td>
<td>
<p>number of covariates in each group.</p>
</td>
</tr>
</table>
<h3>Value</h3>

<table>
<tr style="vertical-align: top;">
<td><code>SurvivalHat</code></td>
<td>
<p>Predictive survival probability.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>LogTimeHat</code></td>
<td>
<p>Predictive log time.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>BetaHat</code></td>
<td>
<p>Posterior mean of Beta, a <code class="reqn">p</code> by 1 vector.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>LeftCI</code></td>
<td>
<p>The left bounds of the credible intervals.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>RightCI</code></td>
<td>
<p>The right bounds of the credible intervals.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>BetaMedian</code></td>
<td>
<p>Posterior median of Beta, a <code class="reqn">p</code> by 1 vector.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>Sigma2Hat</code></td>
<td>
<p>Posterior mean of error variance <code class="reqn">\sigma^2</code>. If method.sigma =
"fixed" is used, this value will be equal to the user-selected value of Sigma2
passed to the function.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>TauHat</code></td>
<td>
<p>Posterior mean of global scale parameter tau, a positive scalar.
If method.tau = "fixed" is used, this value will be equal to the user-selected value
of tau passed to the function.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>BetaSamples</code></td>
<td>
<p>Posterior samples of Beta.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>TauSamples</code></td>
<td>
<p>Posterior samples of tau.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>Sigma2Samples</code></td>
<td>
<p>Posterior samples of Sigma2.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>BGHat</code></td>
<td>
<p>Posterior samples of b which is a part of the mean of <code class="reqn">\beta</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>BPHat</code></td>
<td>
<p>Posterior samples of b which is the other part of the mean of <code class="reqn">\beta</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>LikelihoodSamples</code></td>
<td>
<p>Posterior Samples of likelihood.</p>
</td>
</tr>
</table>
<h3>References</h3>

<p>Stephanie van der Pas, James Scott, Antik Chakraborty and Anirban Bhattacharya (2016). horseshoe:
Implementation of the Horseshoe Prior. R package version 0.1.0.
https://CRAN.R-project.org/package=horseshoe
</p>
<p>Arnab Kumar Maity, Anirban Bhattacharya, Bani K. Mallick, and Veerabhadran Baladandayuthapani (2017).
Joint Bayesian Estimation and Variable Selection for TCPA Protein Expression Data
</p>


<h3>Examples</h3>

<pre><code class="language-R"># Examples for hsaftallcorr function
burnin &lt;- 50   # number of burnin
nmc    &lt;- 100  # number of Markov Chain samples
y.sd   &lt;- 1     # standard deviation of the data
p      &lt;- 80    # number of covariates
r      &lt;- 5     # number of groups
p      &lt;- 80    # number of covariate in each group
n1     &lt;- 40    # sample size of 1st group
n2     &lt;- 50    # sample size of 2nd group
n3     &lt;- 70    # sample size of 3rd group
n4     &lt;- 100   # sample size of 4th group
n5     &lt;- 120   # sample size of 5th group
n      &lt;- sum(c(n1, n2, n3, n4, n5))  # total sample size
n.seq  &lt;- c(n1, n2, n3, n4, n5)
Beta   &lt;- matrix(smoothmest::rdoublex(p * r), nrow = r, ncol = p, byrow = TRUE)
# from double exponential distribution
beta   &lt;- as.vector(t(Beta))  # vectorize Beta
x1     &lt;- mvtnorm::rmvnorm(n1, mean = rep(0, p))
x2     &lt;- mvtnorm::rmvnorm(n2, mean = rep(0, p))
x3     &lt;- mvtnorm::rmvnorm(n3, mean = rep(0, p))
x4     &lt;- mvtnorm::rmvnorm(n4, mean = rep(0, p))
x5     &lt;- mvtnorm::rmvnorm(n5, mean = rep(0, p))  # from multivariate normal distribution
y.mu1  &lt;- x1 %*% Beta[1, ]
y.mu2  &lt;- x2 %*% Beta[2, ]
y.mu3  &lt;- x3 %*% Beta[3, ]
y.mu4  &lt;- x4 %*% Beta[4, ]
y.mu5  &lt;- x5 %*% Beta[5, ]
y1     &lt;- stats::rnorm(n1, mean = y.mu1, sd = y.sd)
y2     &lt;- stats::rnorm(n2, mean = y.mu2, sd = y.sd)
y3     &lt;- stats::rnorm(n3, mean = y.mu3, sd = y.sd)
y4     &lt;- stats::rnorm(n4, mean = y.mu4, sd = y.sd)
y5     &lt;- stats::rnorm(n5, mean = y.mu5, sd = y.sd)
y      &lt;- c(y1, y2, y3, y4, y5)
x      &lt;- Matrix::bdiag(x1, x2, x3, x4, x5)
X      &lt;- as.matrix(x)
y      &lt;- as.numeric(as.matrix(y))  # from normal distribution
T      &lt;- exp(y)   # AFT model
C      &lt;- rgamma(n, shape = 1.75, scale = 3)  # censoring time
time   &lt;- pmin(T, C)  # observed time is min of censored and true
status = time == T   # set to 1 if event is observed
ct     &lt;- as.matrix(cbind(time = time, status = status))  # censored time
posterior.fit &lt;- hsaftallcorr(ct, X, method.tau = "truncatedCauchy", method.sigma = "Jeffreys",
                              burn = burnin, nmc = nmc,
                              r = r, n.seq = n.seq, pk = p)
summary(posterior.fit$BetaHat)



</code></pre>


</div>