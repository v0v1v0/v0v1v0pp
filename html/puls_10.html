<div class="container">

<table style="width: 100%;"><tr>
<td>PULS</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>Partitioning Using Local Subregions (PULS)</h2>

<h3>Description</h3>

<p>PULS function for functional data (only used when you know that the data
shouldn't be converted into functional because it's already smooth, e.g.
your data are step function)
</p>


<h3>Usage</h3>

<pre><code class="language-R">PULS(
  toclust.fd,
  method = c("pam", "ward"),
  intervals = c(0, 1),
  spliton = NULL,
  distmethod = c("usc", "manual"),
  labels = toclust.fd$fdnames[2]$reps,
  nclusters = length(toclust.fd$fdnames[2]$reps),
  minbucket = 2,
  minsplit = 4
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>toclust.fd</code></td>
<td>
<p>A functional data object (i.e., having class <code>fd</code>) created
from <code>fda</code> package. See <code>fda::fd()</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>method</code></td>
<td>
<p>The clustering method you want to run in each subregion. Can be
chosen between <code>pam</code> and <code>ward</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>intervals</code></td>
<td>
<p>A data set (or matrix) with rows are intervals and columns
are the beginning and ending indexes of of the interval.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>spliton</code></td>
<td>
<p>Restrict the partitioning on a specific set of subregions.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>distmethod</code></td>
<td>
<p>The method for calculating the distance matrix. Choose
between <code>"usc"</code> and <code>"manual"</code>. <code>"usc"</code> uses <code>fda.usc::metric.lp()</code>
function while <code>"manual"</code> uses squared distance between functions. See
Details.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>labels</code></td>
<td>
<p>The name of entities.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>nclusters</code></td>
<td>
<p>The number of clusters.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>minbucket</code></td>
<td>
<p>The minimum number of data points in one cluster allowed.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>minsplit</code></td>
<td>
<p>The minimum size of a cluster that can still be considered to
be a split candidate.</p>
</td>
</tr>
</table>
<h3>Details</h3>

<p>If choosing <code>distmethod = "manual"</code>, the L2 distance between all pairs of
functions <code class="reqn">y_i(t)</code> and <code class="reqn">y_j(t)</code> is given by:
</p>
<p style="text-align: center;"><code class="reqn">d_R(y_i, y_j) = \sqrt{\int_{a_r}^{b_r} [y_i(t) - y_j(t)]^2 dt}.</code>
</p>



<h3>Value</h3>

<p>A <code>PULS</code> object. See PULS.object for details.
</p>


<h3>See Also</h3>

<p><code>fda::is.fd()</code>
</p>


<h3>Examples</h3>

<pre><code class="language-R">
library(fda)

# Build a simple fd object from already smoothed smoothed_arctic
data(smoothed_arctic)
NBASIS &lt;- 300
NORDER &lt;- 4
y &lt;- t(as.matrix(smoothed_arctic[, -1]))
splinebasis &lt;- create.bspline.basis(rangeval = c(1, 365),
                                    nbasis = NBASIS,
                                    norder = NORDER)
fdParobj &lt;- fdPar(fdobj = splinebasis,
                  Lfdobj = 2,
                  # No need for any more smoothing
                  lambda = .000001)
yfd &lt;- smooth.basis(argvals = 1:365, y = y, fdParobj = fdParobj)

Jan &lt;- c(1, 31); Feb &lt;- c(31, 59); Mar &lt;- c(59, 90)
Apr &lt;- c(90, 120); May &lt;- c(120, 151); Jun &lt;- c(151, 181)
Jul &lt;- c(181, 212); Aug &lt;- c(212, 243); Sep &lt;- c(243, 273)
Oct &lt;- c(273, 304); Nov &lt;- c(304, 334); Dec &lt;- c(334, 365)

intervals &lt;-
  rbind(Jan, Feb, Mar, Apr, May, Jun, Jul, Aug, Sep, Oct, Nov, Dec)

PULS4_pam &lt;- PULS(toclust.fd = yfd$fd, intervals = intervals,
                  nclusters = 4, method = "pam")
PULS4_pam

</code></pre>


</div>