<div class="container">

<table style="width: 100%;"><tr>
<td>SplineFit</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>
A function to fit a smoothed spline to Phenological Data
</h2>

<h3>Description</h3>

<p>A function to fit a smoothed spline to Phenological Data
</p>


<h3>Usage</h3>

<pre><code class="language-R">SplineFit(ts, uncert = FALSE, nrep = 100, df.factor = 0.05, 
ncores='all', sf=quantile(ts, probs=c(0.05, 0.95), na.rm=TRUE))
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>ts</code></td>
<td>

<p>A ts or zoo object with gcc data. index(ts) must be numeric days of
year (doys)
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>uncert</code></td>
<td>

<p>Should uncertainty be estimated?
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>nrep</code></td>
<td>

<p>Number of relications to estimate uncertainty, defaults to 100. 
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>df.factor</code></td>
<td>

<p>Defaults to 0.05, it is multiplied by length(ts) to generate degrees 
of freedom for the spline fitting. The higher the number of data, the 
higher should be df factor. For a complete year of data 
(i.e. length(ts)=365) the default value is optimum.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>ncores</code></td>
<td>

<p>Unused argument for compatibility

</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>sf</code></td>
<td>

<p>Scaling factors required to normalize the data prior to the fitting. If the function is called by e.g. <code>greenProcess</code> sf is automatically calculated.
</p>
</td>
</tr>
</table>
<h3>Details</h3>

<p>This function fits a smoothed spline to the data. Df for smoothing are set 
at 0.05*length(ts) by default and df.factor can be modified. 
Uncertainty is estimated by changing the degrees of freedom of the spline. 
In particular a sequence from 0.01 and df.factor, of length nrep is used as 
varying degrees of freedom for the spline fitting. 
</p>


<h3>Value</h3>

<p>A list containing the following items. 
</p>
<table>
<tr style="vertical-align: top;">
<td><code>fit</code></td>
<td>
<p>A list with fitted values and an object named 'params' set to 
NULL, for simmetry with other fittings</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>uncertainty</code></td>
<td>
<p>A list containing a zoo data.frame with the
uncertainty predicted values, and an object  named 'params' set to 
NULL, for simmetry with other fittings</p>
</td>
</tr>
</table>
<h3>Author(s)</h3>

<p>Gianluca Filippa &lt;gian.filippa@gmail.com&gt;

</p>


<h3>Examples</h3>

<pre><code class="language-R">## Not run: 
data(bartlett2009.filtered)
fitted &lt;- SplineFit(bartlett2009.filtered, uncert=TRUE, nrep=50)

## End(Not run)
</code></pre>


</div>