<div class="container">

<table style="width: 100%;"><tr>
<td>testEquality</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>Testing of the Null Hypothesis of Equal Marginal Causal Effect Predictiveness Curves for Two Biomarkers, Endpoints, or Baseline Covariate Subgroups</h2>

<h3>Description</h3>

<p>Computes a two-sided p-value either from the test of {<code class="reqn">H_0^3: mCEP_1(s_1)=mCEP_2(s_1)</code> for all <code class="reqn">s_1</code> in <code>limS1</code>}, where <code class="reqn">mCEP_1</code> and <code class="reqn">mCEP_2</code> are
each associated with either a different biomarker (measured in the same units) or a different endpoint or both, or from the test of {<code class="reqn">H_0^4: mCEP(s_1|X=0)=
mCEP(s_1|X=1)</code> for all <code class="reqn">s_1</code> in <code>limS1</code>}, where <code class="reqn">X</code> is a baseline dichotomous phase 1 covariate of interest, each against a general alternative
hypothesis. The testing procedures are described in Juraska, Huang, and Gilbert (2018) and are based on the simultaneous estimation method of Roy and Bose (1953).
</p>


<h3>Usage</h3>

<pre><code class="language-R">testEquality(
  object1,
  object2,
  boot1,
  boot2,
  contrast = c("te", "rr", "logrr", "rd"),
  null = c("H03", "H04"),
  limS1 = NULL
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>object1</code></td>
<td>
<p>an object returned by <code>riskCurve</code> pertaining to either <code class="reqn">mCEP_1(s_1)</code> in <code class="reqn">H_0^3</code> or <code class="reqn">mCEP(s1|X=0)</code> in <code class="reqn">H_0^4</code></p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>object2</code></td>
<td>
<p>an object returned by <code>riskCurve</code> pertaining to either <code class="reqn">mCEP_2(s_1)</code> in <code class="reqn">H_0^3</code> or <code class="reqn">mCEP(s1|X=1)</code> in <code class="reqn">H_0^4</code></p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>boot1</code></td>
<td>
<p>an object returned by <code>bootRiskCurve</code> pertaining to either <code class="reqn">mCEP_1(s_1)</code> in <code class="reqn">H_0^3</code> or <code class="reqn">mCEP(s1|X=0)</code> in <code class="reqn">H_0^4</code></p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>boot2</code></td>
<td>
<p>an object returned by <code>bootRiskCurve</code> pertaining to either <code class="reqn">mCEP_2(s_1)</code> in <code class="reqn">H_0^3</code> or <code class="reqn">mCEP(s1|X=1)</code> in <code class="reqn">H_0^4</code></p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>contrast</code></td>
<td>
<p>a character string specifying the mCEP curve. It must be one of <code>te</code> (treatment efficacy), <code>rr</code> (relative risk), <code>logrr</code>
(log relative risk), and <code>rd</code> (risk difference [placebo minus treatment]).</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>null</code></td>
<td>
<p>a character string specifying the null hypothesis to be tested; one of <code>H03</code> and <code>H04</code> as introduced above</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>limS1</code></td>
<td>
<p>a numeric vector of length 2 specifying an interval that is a subset of the support of <code class="reqn">S(1)</code>. If <code>NULL</code> (default), then the specified null
hypothesis is evaluated for all <code class="reqn">s_1</code>.</p>
</td>
</tr>
</table>
<h3>Value</h3>

<p>A numeric value representing the two-sided p-value from the test of either <code class="reqn">H_0^3</code> or <code class="reqn">H_0^4</code>.
</p>


<h3>References</h3>

<p>Juraska, M., Huang, Y., and Gilbert, P. B. (2020), Inference on treatment effect modification by biomarker response in a three-phase sampling design, Biostatistics, 21(3): 545-560, <a href="https://doi.org/10.1093/biostatistics/kxy074">https://doi.org/10.1093/biostatistics/kxy074</a>.
</p>
<p>Roy, S. N. and Bose, R. C. (1953), Simultaneous condence interval estimation, <em>The Annals of Mathematical Statistics</em>, 24, 513-536.
</p>


<h3>See Also</h3>

<p><code>riskCurve</code>, <code>bootRiskCurve</code> and <code>testConstancy</code>
</p>


<h3>Examples</h3>

<pre><code class="language-R">n &lt;- 500
Z &lt;- rep(0:1, each=n/2)
S &lt;- MASS::mvrnorm(n, mu=c(2,2,3), Sigma=matrix(c(1,0.9,0.7,0.9,1,0.7,0.7,0.7,1), nrow=3))
p &lt;- pnorm(drop(cbind(1,Z,(1-Z)*S[,2],Z*S[,3]) %*% c(-1.2,0.2,-0.02,-0.2)))
Y &lt;- sapply(p, function(risk){ rbinom(1,1,risk) })
X &lt;- rbinom(n,1,0.5)
# delete S(1) in placebo recipients
S[Z==0,3] &lt;- NA
# delete S(0) in treatment recipients
S[Z==1,2] &lt;- NA
# generate the indicator of being sampled into the phase 2 subset
phase2 &lt;- rbinom(n,1,0.4)
# delete Sb, S(0) and S(1) in controls not included in the phase 2 subset
S[Y==0 &amp; phase2==0,] &lt;- c(NA,NA,NA)
# delete Sb in cases not included in the phase 2 subset
S[Y==1 &amp; phase2==0,1] &lt;- NA
data &lt;- data.frame(X,Z,S[,1],ifelse(Z==0,S[,2],S[,3]),Y)
colnames(data) &lt;- c("X","Z","Sb","S","Y")
qS &lt;- quantile(data$S, probs=c(0.05,0.95), na.rm=TRUE)
grid &lt;- seq(qS[1], qS[2], length.out=3)
out0 &lt;- riskCurve(formula=Y ~ S, bsm="Sb", tx="Z", data=data[data$X==0,], psGrid=grid)
out1 &lt;- riskCurve(formula=Y ~ S, bsm="Sb", tx="Z", data=data[data$X==1,], psGrid=grid)
boot0 &lt;- bootRiskCurve(formula=Y ~ S, bsm="Sb", tx="Z", data=data[data$X==0,],
                       psGrid=grid, iter=2, seed=10)
boot1 &lt;- bootRiskCurve(formula=Y ~ S, bsm="Sb", tx="Z", data=data[data$X==1,],
                       psGrid=grid, iter=2, seed=15)

testEquality(out0, out1, boot0, boot1, contrast="te", null="H04")

</code></pre>


</div>