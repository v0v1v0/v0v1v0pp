<div class="container">

<table style="width: 100%;"><tr>
<td>predict.ProbitSpatial</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>Spatial probit model predictions.</h2>

<h3>Description</h3>

<p>Predicts of a <code>ProbitSpatial</code> model on a set <code>X</code> of covariates.
Works on both in-sample and out-of-sample using BLUP formula from Goulard et 
al. (2017)
</p>


<h3>Usage</h3>

<pre><code class="language-R">## S3 method for class 'ProbitSpatial'
predict(
  object,
  X,
  type = c("link", "response", "binary"),
  cut = 0.5,
  oos = FALSE,
  WSO = NULL,
  ...
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>object</code></td>
<td>
<p>an object of class <code>ProbitSpatial</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>X</code></td>
<td>
<p>a matrix of explanatory variables. If oos=TRUE, it may contain more 
observations than the dataset on which the model has been trained</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>type</code></td>
<td>
<p>the type of output: 
</p>

<dl>
<dt><code>"link"</code></dt>
<dd>
<p>the value of the latent variable. Default</p>
</dd>
<dt><code>"response"</code></dt>
<dd>
<p>probability.</p>
</dd>
<dt><code>"binary"</code></dt>
<dd>
<p>binary 0/1 output.</p>
</dd>
</dl>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>cut</code></td>
<td>
<p>the threshold probability for the <code>"binary"</code> type. 
Default is 0.5.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>oos</code></td>
<td>
<p>logical. If TRUE, out-of-sample predictions are returned.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>WSO</code></td>
<td>
<p>W matrix containing weights of in-sample and 
out-of-sample data. Observations must be ordered in such a way that
the first elements belong to the in-sample data and the remaining ones
to the out-of-sample data.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>...</code></td>
<td>
<p>ignored</p>
</td>
</tr>
</table>
<h3>Details</h3>

<p>If <code>oos=FALSE</code>, the function computes the predicted values for  #' the estimated model (same as <code>fitted</code>). Otherwise, it applies the BLUP #' formula of Goulard et al. (2017):
</p>
<p style="text-align: center;"><code class="reqn">\hat{y} = (\hat(y_S),\hat(y_O)),</code>
</p>

<p>where the sub-indexes S and O refer, respectively, to the in-sample and
out-of-sample data. <code class="reqn">\hat{y_S}</code> corresponds to fitted values, while
<code class="reqn">\hat{y_O}</code> is computed as follows:
</p>
<p style="text-align: center;"><code class="reqn">\hat{y_O} = (I-\rho W)^{-1}(X\beta)-Q_{OO}^{-1}Q_{OS}(y_S-\hat{y_S}),</code>
</p>

<p>where <code class="reqn">Q</code> is the precision matrix of 
<code class="reqn">\Sigma=\sigma^2((I-\rho W)'(I-\rho W))^{-1}.</code> and the sub-indexes OO and 
OS refer to the corresponding block matrices.
</p>


<h3>Value</h3>

<p>Returns a vector of predicted values for the set <code>X</code> of 
covariates if <code>oos=FALSE</code> or the best linear unbiased predictors of the #' set <code>XOS</code> if <code>oos=TRUE</code>.
</p>


<h3>References</h3>


<dl>
<dt>Goulard et al. (2017)</dt>
<dd>
<p>M. Goulard, T. Laurent and C. Thomas-Agnan. 
About predictions in spatial autoregressive models: optimal and almost
optimal strategies. <em>Spatial Economic Analysis</em> 12, 304-325, 2017.</p>
</dd>
</dl>
</div>