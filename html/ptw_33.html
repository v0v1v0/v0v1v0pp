<div class="container">

<table style="width: 100%;"><tr>
<td>RMS</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>Quality criteria for comparing patterns with shifts</h2>

<h3>Description</h3>

<p>Functions to compare patterns with shifted features. These
functions compare warped sample patterns to one or more reference
patterns. RMS returns the usual root-mean-squared difference measure;
WCC returns 1-wcc, where wcc indicates the weighted
cross-correlation. Perfect alignment leads to a value of 0 for both
criteria.
</p>
<p>Internal function, not meant to be called directly by the user. In
particular, note that the identity warping may lead to slightly
different estimates than a direct comparison of the reference and
sample signals - a warping even slightly outside the original range of
<code>1 : ncol(ref)</code> leads to NA values.</p>


<h3>Usage</h3>

<pre><code class="language-R">RMS(warp.coef, ref, samp, B, mode)
WCC(warp.coef, ref, samp, B, trwdth = 20, wghts, mode, ref.acors = NULL)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>warp.coef</code></td>
<td>
<p>a vector of warping coefficients</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>ref</code></td>
<td>
<p>reference signal; a matrix with one or more rows. If the
number of rows is greater than one, it should equal the number of
rows in <code>samp</code></p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>samp</code></td>
<td>
<p>sample signal; a matrix with one or more rows</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>B</code></td>
<td>
<p>basis for warping function</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>mode</code></td>
<td>
<p>either "forward" (new implementation, also used for
warping peak lists) or "backward" (classical implementation).</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>trwdth</code></td>
<td>
<p>triangle width for the WCC function, expressed in the number
of data points</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>wghts</code></td>
<td>
<p>optional weights vector, will be calculated from triangle
width if necessary. Sometimes it is more efficient to
pre-calculate it and give it as an argument</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>ref.acors</code></td>
<td>
<p>autocorrelation of the reference. Since the
reference is often unchanged over multiple evaluations (e.g., during
an optimization), it is useful to pre-calculate this number</p>
</td>
</tr>
</table>
<h3>Details</h3>

<p>All patterns in <code>samp</code> are warped using the same warping
function, and then compared to <code>ref</code>, either pair-wise (when
<code>ref</code> and <code>samp</code> are of the same size), or with the one
pattern in <code>ref</code>.
</p>


<h3>Value</h3>

<p>One number - either the WCC or RMS value
</p>


<h3>Author(s)</h3>

<p>Jan Gerretzen, Tom Bloemberg, Ron Wehrens</p>


<h3>References</h3>

<p>Eilers, P.H.C. (2004) "Parametric Time Warping", Analytical Chemistry, <b>76</b> (2), 404 – 411.
</p>
<p>de Gelder, R., Wehrens, R. and Hageman, J.A. (2001) "A generalized expression for the similarity of spectra: Application to powder diffraction pattern classification",  Journal of Computational Chemistry, <b>22</b>, 273 – 289.
</p>


<h3>See Also</h3>

<p><code>wcc</code></p>


</div>