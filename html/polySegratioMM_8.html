<div class="container">

<table style="width: 100%;"><tr>
<td>dosagesJagsMix</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>Compute dosages under specified Bayesian mixture model</h2>

<h3>Description</h3>

<p> Computes and returns estimated dosages under specified
model using posterior probabilities derived from mcmc chains by
the proportion of samples in each dosage class.
</p>


<h3>Usage</h3>

<pre><code class="language-R">dosagesJagsMix(mcmc.mixture, jags.control, seg.ratio, chain = 1,
max.post.prob = TRUE, thresholds = c(0.5, 0.6, 0.7, 0.8, 0.9, 0.95,
0.99), print = FALSE, print.warning = TRUE, index.sample = 20)

</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>mcmc.mixture</code></td>
<td>
<p>Object of type <code>segratioMCMC</code>
produced by <code>coda</code> usually by using <code>readJags</code></p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>jags.control</code></td>
<td>
<p>Object of class <code>jagsControl</code> for setting up
<code>JAGS</code> command file </p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>seg.ratio</code></td>
<td>
<p>Object of class <code>segRatio</code> contains the
segregation ratios for dominant markers and other information
such as the number of dominant markers per individual</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>chain</code></td>
<td>
<p>Which chain to use when compute dosages (Default: 1)</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>max.post.prob</code></td>
<td>
<p>Logical for producing dose allocations based on the
maximum posterior probability (Default: <code>TRUE</code>)</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>thresholds</code></td>
<td>
<p>Numeric vector of thresholds for  allocating
dosages when the posterior probabilty to a particular dosage class
is above the threshold </p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>print</code></td>
<td>
<p>Logical indicating whether or not to print intermediate
results (Default: <code>FALSE</code>) </p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>print.warning</code></td>
<td>
<p>Logical to print warnings if there is more than
one marker with the maximum posterior probability  </p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>index.sample</code></td>
<td>
<p>Numeric vector indicating which markers to print
if <code>print</code> is <code>TRUE</code>. If <code>index.sample</code> is of length
1 then a random sample of size <code>index.sample</code> is selected </p>
</td>
</tr>
</table>
<h3>Value</h3>

<p>An object of class <code>dosagesMCMC</code> is returned with components:
</p>
<table>
<tr style="vertical-align: top;">
<td><code>p.dosage </code></td>
<td>
<p>Matrix of posterior probabilities of dosages for each
marker dosage</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>dosage</code></td>
<td>
<p>Matrix of allocated dosages based on posterior probabilities.
The columns correspond to different 'thresholds' and if requested,
the last column is allocated on basis of <code>max.post</code></p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>thresholds</code></td>
<td>
<p>vector of cutoff probabilities for dosage class</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>chain</code></td>
<td>
<p>Chain used to compute dosages</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>max.post</code></td>
<td>
<p>maximum dosage posterior probabilties for each marker</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>index.sample</code></td>
<td>
<p>Numeric vector indicating which markers to print
if <code>print</code> is <code>TRUE</code>. If <code>index.sample</code> is of length
1 then a random sample of size <code>index.sample</code> is selected </p>
</td>
</tr>
</table>
<h3>Author(s)</h3>

<p>Peter Baker <a href="mailto:p.baker1@uq.edu.au">p.baker1@uq.edu.au</a></p>


<h3>See Also</h3>

 <p><code>dosagesMCMC</code>  <code>readJags</code></p>


<h3>Examples</h3>

<pre><code class="language-R">## simulate small autooctaploid data set
a1 &lt;- sim.autoMarkers(8,c(0.7,0.2,0.1),n.markers=100,n.individuals=50)

## compute segregation ratios
sr &lt;-  segregationRatios(a1$markers)

## set up model, priors, inits etc and write files for JAGS
x &lt;- setModel(3,8)
x2 &lt;- setPriors(x)
dumpData(sr, x)
inits &lt;- setInits(x,x2)
dumpInits(inits)
writeJagsFile(x, x2, stem="test")

## Not run: 
## run JAGS
small &lt;- setControl(x, burn.in=200, sample=500)
writeControlFile(small)
rj &lt;- runJags(small)  ## just run it
print(rj)

## read mcmc chains and produce dosage allocations
xj &lt;- readJags(rj)
dd &lt;- dosagesJagsMix(xj, small, sr)
print(dd)

## End(Not run)
</code></pre>


</div>