<div class="container">

<table style="width: 100%;"><tr>
<td>AddPCA</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>
Perform Principal Components Analysis on “RADdata” Object
</h2>

<h3>Description</h3>

<p>This function uses read depth ratios or posterior genotype probabilities
(the latter preferentially) as input data for principal components analysis.
The PCA scores are then stored in the <code>$PCA</code> slot of the
<code>"RADdata"</code> object.
</p>


<h3>Usage</h3>

<pre><code class="language-R">AddPCA(object, ...)
## S3 method for class 'RADdata'
AddPCA(object, nPcsInit = 10, maxR2changeratio = 0.05, 
                         minPcsOut = 1, ...)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>object</code></td>
<td>

<p>A <code>"RADdata"</code> object.
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>nPcsInit</code></td>
<td>

<p>The number of principal component axes to initially calculate.
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>maxR2changeratio</code></td>
<td>

<p>This number determines how many principal component axes are retained.  The 
difference in <code class="reqn">R^2</code> values between the first and second axes 
is multiplied by <code>maxR2changeratio</code>.  The last axis retained is the first
axis after which the <code class="reqn">R^2</code> value changes by less than this value.
Lower values of <code>maxR2changeratio</code> will result in more axes being retained.
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>minPcsOut</code></td>
<td>

<p>The minimum number of PC axes to output, which can override 
<code>maxR2changeratio</code>.
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>...</code></td>
<td>

<p>Additional arguments to be passed to the <code>pca</code> function from the
<span class="pkg">pcaMethods</span> BioConductor package.
</p>
</td>
</tr>
</table>
<h3>Details</h3>

<p>The PPCA (probabalistic PCA) method from <span class="pkg">pcaMethods</span> is used,
due to the high missing data rate that is typical of genotyping-by-sequencing
datasets.
</p>


<h3>Value</h3>

<p>A <code>"RADdata"</code> object identical to the one passed to the function, but with
a matrix added to the <code>$PCA</code> slot.  This matrix contains PCA scores, with
taxa in rows, and PC axes in columns.
</p>


<h3>Note</h3>

<p>If you see the error 
</p>
<p><code>Error in if (rel_ch &lt; threshold &amp; count &gt; 5) { : 
  missing value where TRUE/FALSE needed</code>
</p>
<p>try lowering <code>nPcsInit</code>.
</p>


<h3>Author(s)</h3>

<p>Lindsay V. Clark
</p>


<h3>See Also</h3>

<p><code>AddAlleleFreqByTaxa</code>
</p>


<h3>Examples</h3>

<pre><code class="language-R"># load data
data(exampleRAD)
# do PCA
exampleRAD &lt;- AddPCA(exampleRAD, nPcsInit = 3)

plot(exampleRAD$PCA[,1], exampleRAD$PCA[,2])
</code></pre>


</div>