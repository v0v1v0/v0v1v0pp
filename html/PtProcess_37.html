<div class="container">

<table style="width: 100%;"><tr>
<td>residuals</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>Residuals of a Point Process Model</h2>

<h3>Description</h3>

<p>Provides methods for the generic function <code>residuals</code>.
</p>


<h3>Usage</h3>

<pre><code class="language-R">## S3 method for class 'mpp'
residuals(object, ...)
## S3 method for class 'linksrm'
residuals(object, ...)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>object</code></td>
<td>
<p>an object with class <code>mpp</code> or <code>linksrm</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>...</code></td>
<td>
<p>other arguments.</p>
</td>
</tr>
</table>
<h3>Details</h3>

<p>Let <code class="reqn">t_i</code> be the times of the observed events. Then the transformed times are defined as
</p>
<p style="text-align: center;"><code class="reqn">
\tau_i = \int_0^{t_i} \lambda_g(t|{\cal H}_t) dt.
</code>
</p>

<p>If the proposed point process model is correct, then the transformed time points will form a stationary Poisson process with rate parameter one. A plot of transformed time points versus the cumulative number of events should then roughly follow the straight line <code class="reqn">y = x</code>. Significant departures from this line indicate a weakness in the model. Further details can be found in Ogata (1988) and Aalen &amp; Hoem (1978).
</p>
<p>See Baddeley et al (2005) and Zhuang (2006) for extensions of these methodologies.
</p>


<h3>Value</h3>

<p>Returns a time series object with class "<code>ts</code>" in the case of <code>mpp</code>. In the case of <code>linksrm</code> a list is returned with the number of components being equal to the number of regions, and with each component being a time series object.
</p>


<h3>References</h3>

<p>Cited references are listed on the PtProcess manual page.
</p>


<h3>Examples</h3>

<pre><code class="language-R">TT &lt;- c(0, 1000)
bvalue &lt;- 1
params &lt;- c(-2.5, 0.01, 0.8, bvalue*log(10))

x &lt;- mpp(data=NULL,
         gif=srm_gif,
         marks=list(NULL, rexp_mark),
         params=params,
         gmap=expression(params[1:3]),
         mmap=expression(params[4]),
         TT=TT)
x &lt;- simulate(x, seed=5)

tau &lt;- residuals(x)

plot(tau, ylab="Transformed Time", xlab="Event Number")
abline(a=0, b=1, lty=2, col="red")

#   represent as a cusum
plot(tau - 1:length(tau), ylab="Cusum of Transformed Time", xlab="Event Number")
abline(h=0, lty=2, col="red")
</code></pre>


</div>