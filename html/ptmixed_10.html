<div class="container">

<table style="width: 100%;"><tr>
<td>simulate_ptglmm</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>Simulate data from the Poisson-Tweedie generalized linear mixed model</h2>

<h3>Description</h3>

<p>Simulates a dataset comprising t repeated measurements for n subjects
from a Poisson-Tweedie GLMM. Subjects are assumed to belong to two
different groups. The linear predictor comprises an intercept,
main effects of group and of time, and the interaction between time and
group; a random intercept; and, optionally, a normally-distributed 
offset term.
</p>


<h3>Usage</h3>

<pre><code class="language-R">simulate_ptglmm(n = 20, t = 5, seed = 1, beta = c(3, 0, 0, 0.4),
  D = 1.5, a = -1, sigma2 = 0.8^2, offset = F)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>n</code></td>
<td>
<p>number of subjects</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>t</code></td>
<td>
<p>number of time points (0, 1, ..., t-1)</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>seed</code></td>
<td>
<p>seed for random number generation</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>beta</code></td>
<td>
<p>vector of regression coefficients, to be specified in
this order: intercept, group main effect, time main effect, group*time interaction</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>D</code></td>
<td>
<p>dispersion parameter of the Poisson-Tweedie distribution (D &gt; 1)</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>a</code></td>
<td>
<p>power parameter of the Poisson-Tweedie distribution (a &lt; 1)</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>sigma2</code></td>
<td>
<p>Variance of the subject-specific random intercept</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>offset</code></td>
<td>
<p>Logical value. If <code>TRUE</code>, a normally-distributed offset is added to the linear predictor.</p>
</td>
</tr>
</table>
<h3>Value</h3>

<p>A list containing the following elements: a dataframe (<code>data</code>)
containing the response y, the subject id, the group indicator and time; 
a vector with the true random intercept values (<code>true.randint</code>).
</p>


<h3>Author(s)</h3>

<p>Mirko Signorelli
</p>


<h3>References</h3>

<p>Signorelli, M., Spitali, P., Tsonaka, R. (2021). Poisson-Tweedie 
mixed-effects model: a flexible approach for the analysis of longitudinal RNA-seq
data. Statistical Modelling, 21 (6), 520-545. URL: https://doi.org/10.1177/1471082X20936017
</p>


<h3>Examples</h3>

<pre><code class="language-R"># simulate a simple, small dataset
example1 = simulate_ptglmm(n = 5, t = 2)
example1$data
# the function allows to set several different parameters
example2 = simulate_ptglmm(n = 20, t = 5, seed = 1,
beta = c(2.2, 1.2, 0.3, -0.5), D = 1.8, a = 0.5,
sigma2 = 0.7, offset = TRUE)
# view the distribution of the response variable:
pmf(example2$data$y)
# visualize the data with a trajectory plot:
make.spaghetti(x = time, y = y, id = id,
group = group, data = example2$data)
</code></pre>


</div>