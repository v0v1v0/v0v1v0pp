<div class="container">

<table style="width: 100%;"><tr>
<td>model.frame.pdata.frame</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>model.frame and model.matrix for panel data</h2>

<h3>Description</h3>

<p>Methods to create model frame and model matrix for panel data.
</p>


<h3>Usage</h3>

<pre><code class="language-R">## S3 method for class 'pdata.frame'
model.frame(
  formula,
  data = NULL,
  ...,
  lhs = NULL,
  rhs = NULL,
  dot = "previous"
)

## S3 method for class 'pdata.frame'
formula(x, ...)

## S3 method for class 'plm'
model.matrix(object, ...)

## S3 method for class 'pdata.frame'
model.matrix(
  object,
  model = c("pooling", "within", "Between", "Sum", "between", "mean", "random", "fd"),
  effect = c("individual", "time", "twoways", "nested"),
  rhs = 1,
  theta = NULL,
  cstcovar.rm = NULL,
  ...
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>data</code></td>
<td>
<p>a <code>formula</code>, see <strong>Details</strong>,</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>...</code></td>
<td>
<p>further arguments.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>lhs</code></td>
<td>
<p>inherited from package <code>Formula::Formula()</code> (see
there),</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>rhs</code></td>
<td>
<p>inherited from package <code>Formula::Formula()</code> (see
there),</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>dot</code></td>
<td>
<p>inherited from package <code>Formula::Formula()</code> (see
there),</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>x</code></td>
<td>
<p>a <code>model.frame</code></p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>object, formula</code></td>
<td>
<p>an object of class <code>"pdata.frame"</code> or an
estimated model object of class <code>"plm"</code>,</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>model</code></td>
<td>
<p>one of <code>"pooling"</code>, <code>"within"</code>, <code>"Sum"</code>, <code>"Between"</code>,
<code>"between"</code>, <code style="white-space: pre;">⁠"random",⁠</code> <code>"fd"</code> and <code>"ht"</code>,</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>effect</code></td>
<td>
<p>the effects introduced in the model, one of
<code>"individual"</code>, <code>"time"</code>, <code>"twoways"</code> or <code>"nested"</code>,</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>theta</code></td>
<td>
<p>the parameter for the transformation if <code>model = "random"</code>,</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>cstcovar.rm</code></td>
<td>
<p>remove the constant columns, one of <code style="white-space: pre;">⁠"none", "intercept", "covariates", "all")⁠</code>,</p>
</td>
</tr>
</table>
<h3>Details</h3>

<p>The <code>lhs</code> and <code>rhs</code> arguments are inherited from <code>Formula</code>, see
there for more details.<br> The <code>model.frame</code> methods return a
<code>pdata.frame</code> object suitable as an input to plm's
<code>model.matrix</code>.<br> The <code>model.matrix</code> methods builds a model matrix
with transformations performed as specified by the <code>model</code> and
<code>effect</code> arguments (and <code>theta</code> if <code>model = "random"</code> is
requested), in this case the supplied <code>data</code> argument should be a
model frame created by plm's <code>model.frame</code> method. If not, it is
tried to construct the model frame from the data. Constructing the
model frame first ensures proper <code>NA</code> handling, see <strong>Examples</strong>.
</p>


<h3>Value</h3>

<p>The <code>model.frame</code> methods return a <code>pdata.frame</code>.<br> The
<code>model.matrix</code> methods return a <code>matrix</code>.
</p>


<h3>Author(s)</h3>

<p>Yves Croissant
</p>


<h3>See Also</h3>

<p><code>pmodel.response()</code> for (transformed) response
variable.<br><code>Formula::Formula()</code> from package <code>Formula</code>,
especially for the <code>lhs</code> and <code>rhs</code> arguments.
</p>


<h3>Examples</h3>

<pre><code class="language-R">
# First, make a pdata.frame
data("Grunfeld", package = "plm")
pGrunfeld &lt;- pdata.frame(Grunfeld)

# then make a model frame from a formula and a pdata.frame
form &lt;- inv ~ value
mf &lt;- model.frame(pGrunfeld, form)

# then construct the (transformed) model matrix (design matrix)
# from model frame
modmat &lt;- model.matrix(mf, model = "within")

## retrieve model frame and model matrix from an estimated plm object
fe_model &lt;- plm(form, data = pGrunfeld, model = "within")
model.frame(fe_model)
model.matrix(fe_model)

# same as constructed before
all.equal(mf, model.frame(fe_model), check.attributes = FALSE) # TRUE
all.equal(modmat, model.matrix(fe_model), check.attributes = FALSE) # TRUE

</code></pre>


</div>