<div class="container">

<table style="width: 100%;"><tr>
<td>OUshifts</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>Detections of shifts in the OU process along a phylogeny.</h2>

<h3>Description</h3>

<p>Trait data is fitted to a phylogeny using an Ornstein-Uhlenbeck (OU) process, such that the mean (or selection optimum) of the process may change in one or more edges in the tree. The number and location of changes, or shifts, is estimated using an information criterion.
</p>


<h3>Usage</h3>

<pre><code class="language-R">OUshifts(y, phy, method = c("mbic", "aic", "bic", "saic", "sbic"),
         nmax, check.pruningwise = TRUE)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>y</code></td>
<td>
<p>values for the trait data.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>phy</code></td>
<td>
<p>a phylogenetic tree of type phylo with branch lengths.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>method</code></td>
<td>
<p>a method for model selection (see details below).</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>nmax</code></td>
<td>
<p>maximum allowed number of shifts.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>check.pruningwise</code></td>
<td>
<p>if TRUE, the algorithm checks if the ordering
of the edges in phy are in pruningwise order.</p>
</td>
</tr>
</table>
<h3>Details</h3>

<p>This function does not accept multivariate data (yet): <code>y</code> should be a vector named with species labels.  The data <code>y</code> and the tree <code>phy</code> need to contain the same species. The user can choose among various information criteria.  Each criterion seeks to minimize the value of <code class="reqn">-2 \log[</code>likelihood<code class="reqn">(y, M)] +</code> penalty<code class="reqn">(M)</code>, where <code class="reqn">M</code> is an OU model with <code class="reqn">m</code> shifts, placed on various edges along the phylogeny.  All models use <code class="reqn">3+m</code> parameters: <code class="reqn">\alpha</code>, <code class="reqn">\sigma^2</code>, and <code class="reqn">m+1</code> parameters to describe the expected trait values in each of the <code class="reqn"> m+1</code> regimes.  The AIC penalty is <code class="reqn">2*(3+m)</code>. The BIC penalty is  <code class="reqn">(3+m) \log(n)</code> where <code class="reqn">n</code> is the numer of species.  If one considers the position of the <code class="reqn">m</code> shifts in the phylogeny as parameters (even though they are discrete parameters), we get the sAIC penalty <code class="reqn">2*(3+2m</code>) (used in SURFACE), and the sBIC penalty <code class="reqn">(3+2*m)*\log(n)</code>.  The default penalty (model = 'mbic') is defined as <code class="reqn">3*\log(n)+(2m-1)\log(n)+\sum_{i=0}^{m}(\log(n_i))</code>. A lower value of <code>nmax</code> will make the search faster, but if the estimated number of shifts is found equal to nmax, then the output model is probably not optimal.  Re-running with a larger <code>nmax</code> would take longer, but would likely return a more complex model with a better score.
</p>


<h3>Value</h3>

<table>
<tr style="vertical-align: top;">
<td><code>y</code></td>
<td>
<p>the input trait.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>phy</code></td>
<td>
<p>the input tree.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>score</code></td>
<td>
<p>the information criterion value of the optimal model.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>nmax</code></td>
<td>
<p>maximum allowed number of shifts.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>nshift</code></td>
<td>
<p>estimated number of shifts.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>alpha</code></td>
<td>
<p>estimated selection strength of the optimal model.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>sigma2</code></td>
<td>
<p>estimated variance of the optimal model.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>mean</code></td>
<td>
<p>estimated the expected value of the trait in lineages without shift.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>pshift</code></td>
<td>
<p>positions of shifts, i.e. indicies of edges where the estimated shifts occurred. The same ordering of edges is used as in phy.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>shift</code></td>
<td>
<p>estimated shifts in the expected value of the trait.</p>
</td>
</tr>
</table>
<h3>Note</h3>

<p>The tip labels in the tree are matched to the data names. The default choice for the parameters are as follows:
<code>method = "mbic"</code>,
<code>check.pruningwise = TRUE</code>
</p>
<p>Due to unidentifiability, the parameters are the expected value of the trait and their shifts instead of the ancestral trait, the optimal values and shifts in optimal values.
</p>


<h3>Author(s)</h3>

<p>Lam Si Tung Ho</p>


<h3>References</h3>

<p>Ho, L. S. T. and Ane, C. 2014.  "Intrinsic inference difficulties for trait evolution with Ornstein-Uhlenbeck models". Methods in Ecology and Evolution. <b>5</b>(11):1133-1146.
</p>
<p>Ingram, T. and Mahler, D.L. 2013. "SURFACE: detecting convergent
evolution from comparative data by fitting Ornstein-Uhlenbeck models
with step-wise Akaike information criterion". Methods in Ecology and
Evolution <b>4</b>:416-425.
</p>
<p>Zhang, N.R. and Siegmund, D.O. 2007. "A modified Bayes information
criterion with applications to the analysis of comparative genomic
hybridization data". Biometrics <b>63</b>:22-32.
</p>


<h3>Examples</h3>

<pre><code class="language-R">data(flowerSize)
data(flowerTree)
result &lt;- OUshifts(flowerSize$log_transformed_size, flowerTree, 
                   method = "mbic", nmax = 1)
plot.OUshifts(result,show.tip.label=FALSE)
</code></pre>


</div>