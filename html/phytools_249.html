<div class="container">

<table style="width: 100%;"><tr>
<td>plotSimmap</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>Plot stochastic character mapped tree</h2>

<h3>Description</h3>

<p>Plots one or multiple stochastic character mapped trees.
</p>


<h3>Usage</h3>

<pre><code class="language-R">plotSimmap(tree, colors=NULL, fsize=1.0, ftype="reg", lwd=2, pts=FALSE, 
   node.numbers=FALSE, mar=NULL, add=FALSE, offset=NULL,
   direction="rightwards", type="phylogram", setEnv=TRUE, 
   part=if(type=="arc") 0.5 else 1.0, xlim=NULL, ylim=NULL, 
   nodes="intermediate", tips=NULL, maxY=NULL, hold=TRUE, 
   split.vertical=FALSE, lend=2, asp=NA, outline=FALSE, 
   plot=TRUE, underscore=FALSE, arc_height=2)
## S3 method for class 'simmap'
plot(x, ...)
## S3 method for class 'multiSimmap'
plot(x, ...)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>tree</code></td>
<td>
<p>an object of class <code>"simmap"</code> or <code>"multiSimmap"</code> containing a stochastic mapping or set of mappings (e.g., see <code>read.simmap</code> &amp; <code>make.simmap</code>).</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>colors</code></td>
<td>
<p>a vector with names translating the mapped states to colors - see <code>Examples</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>fsize</code></td>
<td>
<p>relative font size for tip labels.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>ftype</code></td>
<td>
<p>font type - options are <code>"reg"</code>, <code>"i"</code> (italics), <code>"b"</code> (bold), or <code>"bi"</code> (bold-italics).</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>lwd</code></td>
<td>
<p>line width for plotting.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>pts</code></td>
<td>
<p>logical value indicating whether or not to plot filled circles at each vertex of the tree, as well as at transition points between mapped states.  Default is <code>FALSE</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>node.numbers</code></td>
<td>
<p>a logical value indicating whether or not node numbers should be plotted.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>mar</code></td>
<td>
<p>vector containing the margins for the plot to be passed to <code>par</code>. If not specified, the default margins are [0.1,0.1,0.1,0.1].</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>add</code></td>
<td>
<p>a logical value indicating whether or not to add the plotted tree to the current plot (<code>TRUE</code>) or create a new plot (<code>FALSE</code>, the default).</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>offset</code></td>
<td>
<p>offset for the tip labels in character widths.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>direction</code></td>
<td>
<p>plotting direction. Options are <code>"rightwards"</code> (the default), <code>"leftwards"</code>, <code>"upwards"</code> or <code>"downwards"</code>. For <code>method="fan"</code> <code>direction</code> is ignored.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>type</code></td>
<td>
<p>plot type. Can be <code>"phylogram"</code>, <code>"fan"</code>, or <code>"cladogram"</code>. Only a subset of options are presently available for <code>type="fan"</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>setEnv</code></td>
<td>
<p>logical value indicating whether or not to set the environment <code>.PlotPhyloEnv</code>. Setting this to <code>TRUE</code> (the default) will allow compatibility with <span class="pkg">ape</span> labeling functions such as <code>nodelabels</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>part</code></td>
<td>
<p>value between 0 and 1 for <code>type="fan"</code> indicating what fraction of the full circular tree to use as plotting area. For instance, <code>part=0.5</code> will plot a half fan phylogeny. It also affects the axis scaling used.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>xlim</code></td>
<td>
<p>x-limits for the plot.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>ylim</code></td>
<td>
<p>y-limits for the plot.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>nodes</code></td>
<td>
<p>node placement following Felsenstein (2004; pp. 574-576). Can be <code>"intermediate"</code>, <code>"centered"</code>, <code>"weighted"</code>, or <code>"inner"</code>. So far only works for <code>type="phylogram"</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>tips</code></td>
<td>
<p>labeled vector containing the vertical position of tips. Normally this will be <code>1:N</code> for <code>N</code> tips in the tree.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>maxY</code></td>
<td>
<p>maximum value of y to use before rotating a tree into fan configuration. This will only make a difference if different from <code>Ntip(tree)</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>hold</code></td>
<td>
<p>logical argument indicating whether or not to hold the output to the graphical device before plotting. Defaults to <code>hold=TRUE</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>split.vertical</code></td>
<td>
<p>split the color of the vertically plotted edges by the state of the daughter edges. Only applies if the edge state changes exactly at a node.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>lend</code></td>
<td>
<p>line end style. See <code>par</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>asp</code></td>
<td>
<p>aspect ratio. See <code>plot.window</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>outline</code></td>
<td>
<p>logical value indicating whether or not to draw a black outline around the plotted edges of the tree.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>plot</code></td>
<td>
<p>logical value indicating whether or not to actually plot the tree. (See equivalent argument in <code>plot.phylo</code>.)</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>underscore</code></td>
<td>
<p>logical value indicating whether to plot the underscore character, <code>"_"</code> (if <code>underscore=TRUE</code>) or substitute for a space. Defaults to <code>underscore=FALSE</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>arc_height</code></td>
<td>
<p>for <code>type="arc"</code> trees, the height of the arc in units of total tree depth.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>x</code></td>
<td>
<p>for S3 plotting method, object of class <code>"simmap"</code> or <code>"multiSimmap"</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>...</code></td>
<td>
<p>for S3 plotting method, other arguments to be passed to <code>plotSimmap</code>.</p>
</td>
</tr>
</table>
<h3>Value</h3>

<p>Plots a tree.
</p>


<h3>Author(s)</h3>

<p>Liam Revell <a href="mailto:liam.revell@umb.edu">liam.revell@umb.edu</a></p>


<h3>References</h3>

<p>Bollback, J. P. (2006) Stochastic character mapping of discrete traits on phylogenies. <em>BMC Bioinformatics</em>, <b>7</b>, 88.
</p>
<p>Felsenstein, J. (2004) <em>Inferring Phylogenies</em>. Sinauer.
</p>
<p>Huelsenbeck, J. P., R. Neilsen, and J. P. Bollback (2003) Stochastic mapping of morphological characters. <em>Systematic Biology</em>, <b>52</b>, 131-138. 
</p>
<p>Revell, L. J. (2014) Graphical methods for visualizing comparative data on phylogenies. Chapter 4 in <em>Modern phylogenetic comparative methods and their application in evolutionary biology: Concepts and practice</em> (L. Z. Garamszegi ed.), pp. 77-103.
</p>
<p>Revell, L. J. (2024) phytools 2.0: an updated R ecosystem for phylogenetic comparative methods (and other things). <em>PeerJ</em>, <b>12</b>, e16505.
</p>


<h3>See Also</h3>

<p><code>densityMap</code>, <code>make.simmap</code>, <code>read.simmap</code> 
</p>


<h3>Examples</h3>

<pre><code class="language-R">data(anoletree)
cols&lt;-setNames(c("green","#E4D96F","darkgreen",
    "brown","black","darkgrey"),
    c("CG","GB","TC","TG","Tr","Tw"))
plot(anoletree,cols,fsize=0.5,ftype="i",outline=TRUE,
    lwd=3,ylim=c(0,Ntip(anoletree)),
    mar=c(0.1,0.1,1.1,0.1))
add.simmap.legend(colors=cols,prompt=FALSE,x=0,y=-0.5,
    vertical=FALSE)
title(main="Caribbean ecomorphs of anoles",font.main=3,
    line=0)
par(mar=c(5.1,4.1,4.1,2.1)) ## reset margins to default
</code></pre>


</div>