<div class="container">

<table style="width: 100%;"><tr>
<td>sampleN.scABEL.ad</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>
Sample size estimation for ABEL and iteratively adjusted alpha
</h2>

<h3>Description</h3>

<p>This function performs a sample size estimation for the BE decision
via Average Bioequivalenc with Expanding Limits (<abbr><span class="acronym">ABEL</span></abbr>) based
on simulations. Simultaneously alpha is iteratively adjusted in order
to maintain the consumer risk at the nominal level.
</p>


<h3>Usage</h3>

<pre><code class="language-R">sampleN.scABEL.ad(alpha = 0.05, targetpower = 0.8, theta0, theta1, theta2,
                  CV, design = c("2x3x3", "2x2x4", "2x2x3"), regulator,
                  nstart = NA, nsims = 1e+06, imax = 100, tol,
                  print = TRUE, details = FALSE, alpha.pre = 0.05,
                  setseed = TRUE, sdsims = FALSE, progress)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>alpha</code></td>
<td>

<p>Type I error (<abbr><span class="acronym">TIE</span></abbr>) probability (nominal level of the test). Per
convention commonly set to 0.05.
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>targetpower</code></td>
<td>

<p>Power to achieve at least. Must be &gt;0 and &lt;1. Typical values are 0.80
to 0.90 (<em>i.e.</em>, 80% to 90%). Defaults to 0.80 if not given explicitly.
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>theta0</code></td>
<td>

<p>‘True’ or assumed T/R ratio. Defaults to 0.90 according to the two Lászlós if not given explicitly.
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>theta1</code></td>
<td>

<p>Conventional lower <abbr><span class="acronym">ABE</span></abbr> limit to be applied in the mixed procedure
if <code>CVwR == CVswitch</code>. Also lower limit for the point estimate
constraint. Defaults to 0.80 if not given explicitly.
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>theta2</code></td>
<td>

<p>Conventional upper <abbr><span class="acronym">ABE</span></abbr> limit to be applied in the mixed procedure
if <code>CVwR == CVswitch</code>. Also upper limit for the point estimate
constraint. Defaults to 1.25 if not given explicitly.
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>CV</code></td>
<td>

<p>Intra-subject coefficient(s) of variation as ratio (not percent).
</p>

<ul>
<li>
<p> If given as a scalar (<code>length(CV) == 1</code>) the <em>same</em> <em>CV</em> of Test
and Reference is assumed (homoscedasticity: <em>CV</em><sub>wT</sub> = <em>CV</em><sub>wR</sub>).
</p>
</li>
<li>
<p> If given as a vector (<code>length(CV) == 2</code>) – assuming
heteroscedasticity –<br>
the <em>CV</em> of Test <strong>must</strong> be given in the <em>first</em> element
and the one of Reference in the <em>second</em>.
</p>
</li>
</ul>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>design</code></td>
<td>

<p>Design of the study to be planned.<br><code>"2x3x3"</code> is the partial replicate design.<br><code>"2x2x4"</code> is a full replicate design with 2 sequences and 4 periods.<br><code>"2x2x3"</code> is a full replicate design with 2 sequences and 3 periods.<br>
Defaults to <code>"2x3x3"</code>. Details are given the section about Designs.
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>regulator</code></td>
<td>

<p>Regulatory settings for the widening of the <abbr><span class="acronym">BE</span></abbr> acceptance limits.
Choose from <code>"EMA"</code> (default), <code>"HC"</code>, or <code>"GCC"</code>. This argument may be given also in lower case.
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>nstart</code></td>
<td>

<p>Best “guess” sample size. If not given (default), simulations
start with the sample size estimated for <code>alpha</code> (or <code>alpha.pre</code>,
if given), <code>theta0</code>, and <code>targetpower</code>.<br>
Can also be set to start the sample size search if a previous run
failed.<br>
According to regulatory requirements must be &gt;=12 for the <abbr><span class="acronym">EMA</span></abbr> and
&gt;=24 for <abbr><span class="acronym">ANVISA</span></abbr>.
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>nsims</code></td>
<td>

<p>Number of simulations to be performed to estimate the (empirical)
<abbr><span class="acronym">TIE</span></abbr> and in each iteration of adjusting alpha. The default value
1,000,000 = 1E+6 should not be lowered.
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>imax</code></td>
<td>

<p>Maximum number of steps in sample size search. Defaults to 100.
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>tol</code></td>
<td>

<p>Desired accuracy (convergence tolerance). Defaults to 1E-6.
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>print</code></td>
<td>

<p>If <code>TRUE</code> (default), the function sends its results to the console.
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>details</code></td>
<td>

<p>If <code>TRUE</code> (default), the steps during sample size search are
shown. Additionally information about the impact on power by
adjusting alpha and change of study costs due to the increased sample
size is given.
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>alpha.pre</code></td>
<td>

<p>Pre-specified alpha (optional). Must be <code>&lt;=alpha</code>. <abbr><span class="acronym">ABEL</span></abbr> will be
performed at level <code style="white-space: pre;">⁠alpha.pre⁠</code> and the <abbr><span class="acronym">TIE</span></abbr> assessed at level <code>alpha</code>.<br>
Less powerful than adjusting alpha but an alternative in the critical
region of maximum inflation of the <abbr><span class="acronym">TIE</span></abbr>. In certain scenarios
Bonferroni’s 0.025 is not sufficient to preserve the Type I Error.<br>
Not recommended if <em>CV</em><sub>wR</sub> ≥ 0.45 due to poor power characteristics.
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>setseed</code></td>
<td>

<p>Simulations are dependent on the starting point of the (pseudo)
random number generator. To avoid differences in power for different
runs <code>set.seed(123456)</code> is issued if <code>setseed = TRUE</code> (default).
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>sdsims</code></td>
<td>

<p>If <code>FALSE</code> (default) power is estimated by the respective ‘key’ statistics.
Recommended for speed reasons.<br>
Set to <code>TRUE</code> if results of <code>power.scABEL</code> are expected to
be inaccurate (partial replicate design with unbalanced sequences and/or heteroscedasticity
where <em>CV</em><sub>wT</sub> &gt; <em>CV</em><sub>wR</sub>) and subject data via <code>power.scABEL.sdsims</code> should
be simulated instead. Very time consuming (easily 100times slower)! Subject data simulations are only supported for <code>regulator = "EMA"</code> and <code>regulator = "GCC"</code>.
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>progress</code></td>
<td>

<p>Set to <code>TRUE</code> if a progress bar should be displayed. Defaults to <code>FALSE</code>.<br>
Ignored if <code>sdsims = FALSE</code>.
</p>
</td>
</tr>
</table>
<h3>Details</h3>

<p>The simulations are done via the distributional properties of the statistical
quantities necessary for assessing <abbr><span class="acronym">BE</span></abbr> based on <abbr><span class="acronym">ABEL</span></abbr>.
Simulations of the <abbr><span class="acronym">TIE</span></abbr> are performed at the upper (expanded) limit <em>U</em>
of the acceptance range. Due to the symmetry around 1 results are valid for the lower
(expanded) limit <em>L</em> as well.<br><em>U</em> at the <abbr><span class="acronym">EMA</span></abbr>’s and Health Canada’s <code>CVcap</code>, the <abbr><span class="acronym">GCC</span></abbr>’s for <em>any</em> <em>CV</em><sub>wR</sub> &gt; 0.30:</p>
<pre>
scABEL(CV = 0.5, reg = "EMA")[["upper"]]
[1] 1.43191
scABEL(CV = 0.57382, reg = "HC")[["upper"]]
[1] 1.5
scABEL(CV = 0.31, reg = "GCC")[["upper"]]
[1] 1.333333</pre>
<p>Simulated studies are evaluated by ANOVA (Method A) as recommended in the
<abbr><span class="acronym">EMA</span></abbr>’s Q&amp;A-document and by intra-subject contrasts if <code>regulator="HC"</code>.
Health Canada requires a mixed effects model which cannot be implemented in R. However,
intra-subjects contrasts are a sufficiently close approximation.<br></p>
<p>If an inflation of the <abbr><span class="acronym">TIE</span></abbr> is expected (<em>i.e.</em>, <code>&gt;alpha</code>), alpha is
iteratively adjusted until at least the target power is reached and the consumer
risk is maintained (<code>&lt;=alpha</code>). For details about the algorithm see the
respective section of <code>scABEL.ad</code>.<br><br>
The estimated sample size gives always the <em>total</em> number of subjects (not subject/sequence – like in some other software packages).
</p>


<h3>Value</h3>

<p>Returns a data.frame with the input and results for adjusted alpha,
type I error, sample size, and achieved power.<br>
The <code>Sample size</code> column contains the total sample size.
If no adjustment is necessary, <code>NA</code> will be returned in the
<code>alpha.adj</code> column and other results are identical to the ones
obtained by <code>sampleN.scABEL</code>.
</p>


<h3>Designs</h3>

<p>Although some designs are more ‘popular’ than others, sample size estimations are valid for <em>all</em> of the following designs:
</p>

<table>
<tr>
<td style="text-align: left;">
    <code>"2x2x4"</code> </td>
<td style="text-align: left;"> TRTR | RTRT</td>
</tr>
<tr>
<td style="text-align: left;">
    </td>
<td style="text-align: left;"> TRRT | RTTR</td>
</tr>
<tr>
<td style="text-align: left;">
    </td>
<td style="text-align: left;"> TTRR | RRTT</td>
</tr>
<tr>
<td style="text-align: left;">
    <code>"2x2x3"</code> </td>
<td style="text-align: left;"> TRT | RTR</td>
</tr>
<tr>
<td style="text-align: left;">
    </td>
<td style="text-align: left;"> TRR | RTT</td>
</tr>
<tr>
<td style="text-align: left;">
    <code>"2x3x3"</code> </td>
<td style="text-align: left;"> TRR | RTR | RRT
  </td>
</tr>
</table>
<h3>Warning</h3>

<p>The sample size estimation for extreme <code>theta0</code> (&lt;0.83 or &gt;1.21) may be time
consuming and will eventually also fail since the start values chosen are
not really reasonable in that ranges.<br>
If you really need sample sizes in that range be prepared to restart the sample
size estimation with <code>nstart</code> above the last one before failure.<br>
Since the dependence of power from <code>n</code> is very flat in the mentioned region you may
also consider to adapt the number of simulations not to tap in the simulation
error trap.<br><br>
See also the Warning section of the function <code>power.scABEL</code> concerning
the power value agreement to those obtained from simulations via subject data.<br><br>
For the <abbr><span class="acronym">GCC</span></abbr> and <em>CV</em><sub>wR</sub> ≤ 0.30 simulations will be time consuming and may result in large sample sizes.

</p>


<h3>Note</h3>

<p>We are doing the sample size estimation only for balanced designs
since the break down of the total subject number in case of unbalanced
sequences is not unique. Moreover the formulas used are only for
balanced designs.
</p>


<h3>Author(s)</h3>

<p>H. Schütz
</p>


<h3>References</h3>

<p>Tóthfalusi L, Endrényi L. <em>Sample Sizes for Designing Bioequivalence Studies for Highly Variable Drugs.</em> J Pharm Pharmaceut Sci. 2011;15(1):73–84. <a href="http://ejournals.library.ualberta.ca/index.php/JPPS/article/download/11612/9489">open access</a>
</p>
<p>Wonnemann M, Frömke C, Koch A. <em>Inflation of the Type I Error: Investigations on Regulatory Recommendations for Bioequivalence of Highly Variable Drugs.</em> Pharm Res. 2015;32(1):135–43. <a href="https://doi.org/10.1007/s11095-014-1450-z">doi:10.1007/s11095-014-1450-z</a>
</p>
<p>Muñoz J, Alcaide D, Ocaña J. <em>Consumer’s risk in the EMA and FDA regulatory approaches for bioequivalence in highly variable drugs.</em> Stat Med. 2015;35(12):1933–43. <a href="https://doi.org/10.1002/sim.6834">doi:10.1002/sim.6834</a>
</p>
<p>Labes D, Schütz H. <em>Inflation of Type I Error in the Evaluation of Scaled Average Bioequivalence,
and a Method for its Control.</em> Pharm Res. 2016;33(11):2805–14. <a href="https://doi.org/10.1007/s11095-016-2006-1">doi:10.1007/s11095-016-2006-1</a>
</p>


<h3>See Also</h3>

<p><code>scABEL.ad</code>, <code>sampleN.scABEL</code>, <code>power.scABEL</code>,
<code>scABEL</code>
</p>


<h3>Examples</h3>

<pre><code class="language-R"># --- Not run due to timing policy of CRAN for examples
# each may run some ten seconds or more
# using all the defaults:
# TRR|RTR|RRT, target power 80%, assumed ratio 0.90, 1E+6 simulated studies,
# EMA regulatory settings (ABE limits, PE constraint 0.8 - 1.25)

sampleN.scABEL.ad(CV = 0.3)
# should result in n 60, power 0.8022.
# Note: Without adjustment by sampleN.scABEL(): n 54, power 0.8159
# Easier to show the details:

sampleN.scABEL.ad(CV = 0.3, details = TRUE)
#
# TRTR|RTRT, target power 90%, pre-specified alpha 0.025

sampleN.scABEL.ad(CV = 0.3, targetpower = 0.9, design = "2x2x4", alpha.pre = 0.025)
# should result in n 60, power 0.9021; pre-specified alpha justified.
</code></pre>


</div>