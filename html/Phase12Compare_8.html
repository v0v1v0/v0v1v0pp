<div class="container">

<table style="width: 100%;"><tr>
<td>GetSpsoContour</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>Assigns next patient cohort based on the SPSOP model with a Utility based objective function.</h2>

<h3>Description</h3>

<p>Provides the optimal dose level as determined by the SPSO model, posterior mean toxicity probability, efficacy probability, and desirability of each dose level. Doses that are unacceptably toxic or inefficous have a desirability of 0.
</p>


<h3>Usage</h3>

<pre><code class="language-R">GetSpsoContour(
  YE,
  YT,
  Doses,
  Dosetried,
  cohort,
  Contour,
  CutE,
  CutT,
  AcceptE,
  AcceptT,
  HypermeansE,
  HypermeansT,
  Hypervars,
  B
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>YE</code></td>
<td>
<p>Length n binary indicator vector of efficacy status.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>YT</code></td>
<td>
<p>Length n binary indicator vector of toxicity status.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>Doses</code></td>
<td>
<p>Length n vector of integer Doses given to patients.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>Dosetried</code></td>
<td>
<p>Binary vector corresponding to which doses have been tried.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>cohort</code></td>
<td>
<p>Cohort size for the trial.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>Contour</code></td>
<td>
<p>Contour vector for desirability function. Contains in order: (pi_1,E,pi_2,T,pi_3,E,pi_4,T).</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>CutE</code></td>
<td>
<p>Cutoff for efficacy probability acceptability. Dose-efficacy probabilities must be larger than this for patient assignment.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>CutT</code></td>
<td>
<p>Cutoff for toxicity probability acceptability. Dose-toxicity probabilities must be smaller than this for patient assignment.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>AcceptE</code></td>
<td>
<p>Posterior probability threshold for efficacy acceptability.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>AcceptT</code></td>
<td>
<p>Posterior probability threshold for toxicity acceptability.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>HypermeansE</code></td>
<td>
<p>Hypermeans for dose-specific efficacy parameters.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>HypermeansT</code></td>
<td>
<p>Hypermeans for dose-specific toxcity parameters.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>Hypervars</code></td>
<td>
<p>Hypervariances needed for the SPSO model. Contains, in order (sigma_0^2, sigma_mu^2,tau).</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>B</code></td>
<td>
<p>Number of iterations to run for the MCMC.</p>
</td>
</tr>
</table>
<h3>Value</h3>

<p>A list containing the optimal dose level to assign the next patient cohort in the first entry and a matrix in the second entry, with rows corresponding to (1) the dose #, (2) mean posterior toxicity probability at each dose, mean posterior efficacy probability at each dose, and acceptable posterior desirability score of each dose level (0s indicate the dose is not acceptably efficous or toxic).
</p>


<h3>Examples</h3>

<pre><code class="language-R">##Get the Data
##True Tox Prob
PT = c(.1,.2,.25,.5,.7)
##True EFF Prob
PE = c(.3,.4,.7,.5,.5)
Doses=c(1,1,1,2,2,2,3,3,3,2,2,2,1,1,1,2,2,2,3,3,3)
YE=Doses
YT=Doses
Dosetried=rep(0,length(PE))
##Generate data
for(k in 1:length(PE)){
if(sum(Doses==k)){
##Dose level has been tried
Dosetried[k]=1
YE[Doses==k]=rbinom(sum(Doses==k),1,PE[k])
YT[Doses==k]=rbinom(sum(Doses==k),1,PT[k])
}
}
##Hyperparameters
HypermeansE=c(-1,-.5,0,.5,1,2)
HypermeansT=HypermeansE
Hypervars=c(1,16,1)
##Trial parameters
cohort=3
##Contour vector
Contour = c(.35, .75,.7,.4)
CutE=.3 ##Efficacy threshold
CutT=.4 ##Toxicity threshold
AcceptE=.3 ##Eff acceptability threshold
AcceptT= .3 ##Tox acceptability threshold
B=100##Number of iterations
GetSpsoContour(YE,YT,Doses,Dosetried,cohort,Contour,CutE, CutT, AcceptE, AcceptT,
HypermeansE,  HypermeansT,Hypervars,B )
</code></pre>


</div>