<div class="container">

<table style="width: 100%;"><tr>
<td>sw</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>Sliding Windows</h2>

<h3>Description</h3>

<p>Applies a function over a matrix or a vector using sliding
windows. <code>sw</code> is a generic function with a method for
<code>"DNAbin"</code> matrices.
</p>


<h3>Usage</h3>

<pre><code class="language-R">sw(x, width, step, ...)
## Default S3 method:
sw(x, width = 100, step = 50, POS = NULL,
   FUN = mean, out.of.pos = NA_real_, na.rm = TRUE, L = NULL, ...)
## S3 method for class 'DNAbin'
sw(x, width = 100, step = 50, FUN = GC.content,
   rowAverage = FALSE, quiet = TRUE, ...)
## S3 method for class 'sw'
plot(x, type = "l", xlab = "Position", x.scaling = 1,
     show.ranges = FALSE, col.ranges = "blue",
     lty.ranges = 1, lwd.ranges = 1, ...)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>x</code></td>
<td>
<p>a vector or a matrix.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>width</code></td>
<td>
<p>an integer giving the window width.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>step</code></td>
<td>
<p>an integer giving the step separating successive windows.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>POS</code></td>
<td>
<p>a numeric vector giving the positions of the sites.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>FUN</code></td>
<td>
<p>the function to be applied to the windows.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>rowAverage</code></td>
<td>
<p>a logical value: if <code>TRUE</code>, <code>FUN</code> is
applied over all rows of <code>x</code>; if <code>FALSE</code> (the default)
<code>FUN</code> is applied to each row of <code>x</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>out.of.pos</code></td>
<td>
<p>the values used for the sites which are not in
<code>POS</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>na.rm</code></td>
<td>
<p>option passed to <code>FUN</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>L</code></td>
<td>
<p>the length of the chromosome (or sequence). If not given,
this is largest value in <code>POS</code> or the length of <code>x</code> if
<code>POS</code> is not given.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>quiet</code></td>
<td>
<p>a logical value: if <code>FALSE</code>, the progress of the
calculations is printed.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>type</code></td>
<td>
<p>the type of plotting (see <code>plot.default</code>).</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>xlab</code></td>
<td>
<p>the label under the x-axis.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>x.scaling</code></td>
<td>
<p>the scaling of the x-axis.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>show.ranges</code></td>
<td>
<p>a logical value specifying whether to show the
ranges of the windows with horizontal segments (ignored with a
warning if <code>x</code> is a matrix).</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>col.ranges, lty.ranges, lwd.ranges</code></td>
<td>
<p>arguments to modify the
appearance of the above segments (see <code>segments</code>).</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>...</code></td>
<td>
<p>further arguments passed to and from methods.</p>
</td>
</tr>
</table>
<h3>Details</h3>

<p><code>FUN</code> should return a single value.
</p>
<p><code>x</code> should be a matrix for the <code>"DNAbin"</code> method, or a
vector for the default one.
</p>
<p>For the default method, the vector <code>x</code> is expanded into a vector
of length <code>L</code> (see above on how this value is found) and the
positions which are not in <code>POS</code> are filled with the value given
in <code>out.of.pos</code>. The resulting vector is then analysed with the
function <code>FUN</code> which must have an option <code>na.rm</code>. If the
function you want to use does not have this option, you can use
something like <code>FUN = function(x, na.rm = TRUE)
  foo(x[!is.na(x)])</code>, replacing ‘foo’ by the name of your function. You
may also include more control on the handling of missing data.
</p>


<h3>Value</h3>

<p>a matrix or a vector (if <code>rowAverage = TRUE</code>).
</p>


<h3>Author(s)</h3>

<p>Emmanuel Paradis</p>


<h3>Examples</h3>

<pre><code class="language-R">data(woodmouse)
sw(woodmouse)
sw(woodmouse, 200, 200)
sw(woodmouse, 200, 200, rowAverage = TRUE)

## to get the proportions of G:
foo &lt;- function(x) base.freq(x)["g"]
sw(woodmouse, 200, 200, FUN = foo, rowAverage = TRUE)

## a simulated example with the default method:
x &lt;- runif(100)
pos &lt;- sort(sample(1e6, 100))
resx &lt;- sw(x, w = 2e4, s = 5e3, POS = pos, L = 1e6)
plot(resx, show.ranges = TRUE, x.scaling = 1e6, xlab = "Position (Mb)")
</code></pre>


</div>