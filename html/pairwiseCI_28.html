<div class="container">

<table style="width: 100%;"><tr>
<td>pairwiseTest</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>Wrapper to calculate unadjusted p-values for pairwise comparisons</h2>

<h3>Description</h3>

<p>Calculation of raw p-values for pairwise comparisons of several groups.
The data can be split by additional factors. Any test function can be used,
that takes two samples x,y as input and returns a list containing the p.value in an element named <kbd>p.value</kbd>.
The output of this function might be further processed using <kbd>p.adjust</kbd> in order to adjust for multiple comparisons.
</p>


<h3>Usage</h3>

<pre><code class="language-R">pairwiseTest(formula, data, by = NULL,
 method = "t.test", control = NULL, ...)

</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>formula</code></td>
<td>
<p> a formula specifiying the response and the factor variable: <kbd>response ~ factor</kbd>  </p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>data</code></td>
<td>
<p> a data frame, containing the variables specified in <kbd>formula</kbd> </p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>by</code></td>
<td>
<p> optional vector of character strings, defining factors by which to split the data set.
Then, pairwise comparisons are performed separately for each level of the specified factors.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>method</code></td>
<td>
<p> character string, giving the name of the function, which shall be used to calculate local p-values. Any function,
taking two vectors x, and y as first arguments and returning a list with the p.value in a list element named <kbd>p.value</kbd> can be specified.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>control</code></td>
<td>
<p> optional character string, defining the name of a control group.
Must be one of the levels of the factor variable defined in <kbd>formula</kbd>.
By default control=NULL, then all pairwise comparisons between the levels of the factor variable are computed.  </p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>...</code></td>
<td>
<p> Arguments to be passed the function defined in <kbd>method</kbd>  </p>
</td>
</tr>
</table>
<h3>Details</h3>

<p>This function splits the response variable according to the factor(s) specified in <kbd>by</kbd>, and within each subset
according to the grouping variable specified in <kbd>formula</kbd>. The function specified in <kbd>method</kbd> is called
to calculate a p.value for all pairwise comparisons of between the subsets, within each level of <kbd>by</kbd>.
The p-values are NOT adjusted for multiple hypothesis testing.
</p>
<p>For binomial proportions, only <kbd>"Prop.test"</kbd> can be specified in the argument <kbd>method</kbd>;
For continous variables, any function can be specified, which takes <kbd>x</kbd> and <kbd>y</kbd> as first arguments,
and returns a list containing a list containing the appropriate p-value in the element named <kbd>p.value</kbd>
(as do the functions of class <kbd>"htest"</kbd>). See the examples for details. 
</p>


<h3>Value</h3>

<p>A named list with elements
</p>
<table>
<tr style="vertical-align: top;">
<td><code>byout</code></td>
<td>
<p>a list, containing the output of pairwiseTestint for each level of by,
i.e. a data.frame containing with columns <kbd>p.value</kbd>,<kbd>compnames</kbd> <kbd>groupx</kbd>, <kbd>groupy</kbd></p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>bynames</code></td>
<td>
<p>a character vector containing the names of the levels of the factors specified in <kbd>by</kbd> </p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>method</code></td>
<td>
<p>a character string, name of the function used</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>control</code></td>
<td>
<p>a character string</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>by</code></td>
<td>
<p>vector of character strings, same as  argument <kbd>by</kbd></p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>...</code></td>
<td>
<p>further arguments that were passed to <kbd>FUN</kbd></p>
</td>
</tr>
</table>
<h3>Author(s)</h3>

<p> Frank Schaarschmidt </p>


<h3>See Also</h3>

 
<p>You can use <code>summary.pairwiseTest</code> to calculate multiplicity adjusted p-values from the output of pairwiseTest.
</p>
<p>The following methods provide multiplicity adjusted p-values for various situations:
<code>pairwise.t.test</code>, <code>pairwise.prop.test</code>, <kbd>\link{p.adjust}</kbd>,
<kbd>summary.glht(multcomp)</kbd>, <kbd>simtest.ratio(mratios)</kbd>   </p>


<h3>Examples</h3>

<pre><code class="language-R">
#######################################################
# The rooting example:
# Calculate confidence intervals for the 
# difference of proportions between the 3 doses of IBA,
# separately for 4 combinations of "Age" and "Position".
# Note: we pool over Rep in that way. Whether this makes
# sense or not, is decision of the user.

data(rooting)

# Pairwise Chi-square tests:

aproots&lt;-pairwiseTest(cbind(root, noroot) ~ IBA,
 data=rooting, by=c("Age", "Position"), method="Prop.test")

aproots

# With Holm adjustment for multiple hypotheses testing:

summary(aproots, p.adjust.method="holm")


#########################################################

data(Oats)


apc &lt;- pairwiseTest(yield ~ nitro, data=Oats,
 by="Variety", method="wilcox.test")

apc

summary(apc)
summary(apc, p.adjust.method="holm")

  </code></pre>


</div>