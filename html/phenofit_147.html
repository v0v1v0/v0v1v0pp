<div class="container">

<table style="width: 100%;"><tr>
<td>smooth_wWHIT</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>Weigthed Whittaker Smoother</h2>

<h3>Description</h3>

<p>Weigthed Whittaker Smoother
</p>


<h3>Usage</h3>

<pre><code class="language-R">smooth_wWHIT(
  y,
  w,
  ylu,
  nptperyear,
  wFUN = wTSM,
  iters = 1,
  lambda = 15,
  second = FALSE,
  ...
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>y</code></td>
<td>
<p>Numeric vector, vegetation index time-series</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>w</code></td>
<td>
<p>(optional) Numeric vector, weights of <code>y</code>. If not specified,
weights of all <code>NA</code> values will be <code>wmin</code>, the others will be 1.0.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>ylu</code></td>
<td>
<p><code style="white-space: pre;">⁠[low, high]⁠</code> of time-series y (curve fitting values are constrained
in the range of <code>ylu</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>nptperyear</code></td>
<td>
<p>Integer, number of images per year.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>wFUN</code></td>
<td>
<p>weights updating function, can be one of 'wTSM', 'wChen' and
'wBisquare'.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>iters</code></td>
<td>
<p>How many times curve fitting is implemented.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>lambda</code></td>
<td>
<p>scaler or numeric vector, whittaker parameter.
</p>

<ul>
<li>
<p> If <code>lambda = NULL</code>, <code>V-curve</code> theory will be applied to retrieve the optimal <code>lambda</code>.
</p>
</li>
<li>
<p> If multiple <code>lambda</code> provided (numeric vector), a list of the smoothing results
with the same length of <code>lambda</code> will be returned.
</p>
</li>
</ul>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>second</code></td>
<td>
<p>If true, in every iteration, Whittaker will be implemented
twice to make sure curve fitting is smooth. If curve has been smoothed
enough, it will not care about the second smooth. If no, the second one is
just prepared for this situation. If lambda value has been optimized, second
smoothing is unnecessary.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>...</code></td>
<td>
<p>Additional parameters are passed to <code>wFUN</code>.</p>
</td>
</tr>
</table>
<h3>Value</h3>


<ul>
<li> <p><code>ws</code>: weights of every iteration
</p>
</li>
<li> <p><code>zs</code>: curve fittings of every iteration
</p>
</li>
</ul>
<h3>Note</h3>

<p>Whittaker smoother of the second order difference is used!
</p>


<h3>References</h3>


<ol>
<li>
<p> Eilers, P.H.C., 2003. A perfect smoother. Anal. Chem. <a href="https://doi.org/10.1021/ac034173t">doi:10.1021/ac034173t</a>
</p>
</li>
<li>
<p> Frasso, G., Eilers, P.H.C., 2015. L- and V-curves for optimal smoothing. Stat.
Modelling 15, 91-111. <a href="https://doi.org/10.1177/1471082X14549288">doi:10.1177/1471082X14549288</a>.
</p>
</li>
</ol>
<h3>See Also</h3>

<p><code>lambda_vcurve()</code>
</p>


<h3>Examples</h3>

<pre><code class="language-R">data("MOD13A1")
dt &lt;- tidy_MOD13(MOD13A1$dt)
d &lt;- dt[site == "AT-Neu", ]

l &lt;- check_input(d$t, d$y, d$w, nptperyear=23)
r_wWHIT &lt;- smooth_wWHIT(l$y, l$w, l$ylu, nptperyear = 23, iters = 2)

## Optimize `lambda` by V-curve theory
# (a) optimize manually
lambda_vcurve(l$y, l$w, plot = TRUE) 

# (b) optimize automatically by setting `lambda = NULL` in smooth_wWHIT
r_wWHIT2 &lt;- smooth_wWHIT(l$y, l$w, l$ylu, nptperyear = 23, iters = 2, lambda = NULL) # 
</code></pre>


</div>