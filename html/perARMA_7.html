<div class="container">

<table style="width: 100%;"><tr>
<td>Bcoeff, Bcoeffa</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>
Fourier representation of covariance function
</h2>

<h3>Description</h3>

<p>The procedure <code>Bcoeff</code> computes the complex estimators
<code class="reqn"> B_{k}(\tau) = \frac{1}{T} \sum_{t=0}^{T-1}R(t+\tau,t)\exp(-i 2 \pi t /T)</code>
as Fourier coefficients in covariance function representation.
The procedure first computes the periodic mean
(with missing values ignored) and subtracts it from the series.
For each specified lag <code class="reqn">\tau</code>, the values of
<code class="reqn">\hat{B}_{k}(\tau)</code> are computed only for
<code class="reqn"> k= 0, 1, \ldots,\left\lfloor T/2 \right\rfloor</code>,
because for real series
<code class="reqn"> \hat{B}_{k}(\tau)= \overline{\hat{B}_{T-k}(\tau)}</code>.
Also the p-values for the test <code class="reqn"> B_{k}(\tau)=0</code> are returned. <br>
The function <code>Bcoeffa</code> calculates the estimator of the real
coefficients <code class="reqn"> a_{k}(\tau)</code> which satisfy
<code class="reqn"> R(t+\tau,t) = B(t,\tau) = a_1(\tau) + \sum (a_{2k}(\tau) \cos(2 \pi k t/ T)+a_{2k+1}(\tau) \sin(2 \pi k t/ T)) </code>,
for all required lags <code class="reqn"> \tau</code> and  <code class="reqn">k</code>.
</p>


<h3>Usage</h3>

<pre><code class="language-R">Bcoeff(x, T_t, tau, missval, datastr,...)
Bcoeffa(x, T_t, tau, missval, datastr,...)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>x</code></td>
<td>

<p>input time series.
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>T_t</code></td>
<td>

<p>period length of PC-T structure.
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>tau</code></td>
<td>

<p>vector of lag values on which estimation of <code class="reqn">B_k(\tau)</code> is performed.
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>missval</code></td>
<td>

<p>notation for missing values.
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>datastr</code></td>
<td>

<p>string name of data for printing.
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>...</code></td>
<td>
<p>other arguments:<br><code>printflg</code> should be a positive parameter to print,<br><code>meth</code> is a parameter connected to the amount of frequencies used in estimation, if <code>meth=0</code> all possible frequencies are used in estimation else
if <code> meth &gt; 0</code> then <code class="reqn"> \left\lfloor n/2\right\rfloor</code> frequencies on either side of the Fourier frequencies <code class="reqn"> 2\pi k/T</code> are used.<br>
By default parameters are fixed to <code>printflg=1, meth=0</code>.
</p>
</td>
</tr>
</table>
<h3>Details</h3>

<p>This procedure can be applied to the original series to obtain estimators of <code class="reqn"> B_{k}(\tau)</code> in covariance function representation
or to the normalized series (series after  periodic mean removal and division by standard deviations) to obtain correlation coefficients.
The p-values for test of <code class="reqn">|B_k(\tau)|^2=0</code> are based on
the ratio of magnitude squares of amplitudes of a high
resolution Fourier decompositions. Magnitudes for the
frequency corresponding to index <code class="reqn">k</code> are compared to
the magnitudes of neighboring frequencies
(via the F distribution) (see Hurd, H. L., Miamee, A. G., 2007, Periodically Correlated Random Sequences, pp. 272-282, 288-292).
</p>


<h3>Value</h3>

<p>procedures (for positive <code>printflg</code> parameter) print a table containing the following columns:
</p>
<table>
<tr style="vertical-align: top;">
<td><code>k</code></td>
<td>
<p>index number of the coefficient <code class="reqn">B_k(\tau)</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>reB_k,imB_k/ahat_k</code></td>
<td>
<p>real and imaginary parts of estimated coefficient <code class="reqn">B_k(\tau)</code> (<code>Bcoeff</code> procedure) / real coefficients in representation of coefficient
<code class="reqn">B_k(\tau)</code> (<code>Bcoeffa</code> procedure).</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>n1</code></td>
<td>
<p>degrees of freedom associated to the estimator
<code class="reqn">SS1/n1</code> of the variance at frequency <code class="reqn">2\pi k /T</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>n2</code></td>
<td>
<p>degrees of freedom associated to the
"background" variance estimation <code class="reqn">SS2/n2</code> based on
frequencies in the neighborhood of the frequency <code class="reqn">2\pi k /T</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>Fratio</code></td>
<td>
<p> the statistic <code class="reqn">(SS1/n1)/(SS2/n2)</code>, which under
the null hypothesis has <code class="reqn">F(n1,n2)</code> distribution.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>pv</code></td>
<td>
<p>p-values for test of <code class="reqn">\left|B_k(\tau)\right|^2=0</code>, based on F distribution.</p>
</td>
</tr>
</table>
<p>If <code>printflg</code> is set to be equal to 0, above values are returned just as matrices.
</p>


<h3>Author(s)</h3>

<p>Harry Hurd
</p>


<h3>References</h3>

<p>Dehay, D., Hurd, H. L., (1994), Representation and Estimation for Periodically and Almost Periodically
Correlated Random Processes in W. A. Gardner (ed.), Cyclostationarity in Communications and Signal Processing, IEEE Press.
<br><br>
Hurd, H. L., Miamee, A. G., (2007), Periodically Correlated Random Sequences:
Spectral Theory and Practice, Wiley InterScience.<br></p>


<h3>Examples</h3>

<pre><code class="language-R">data(volumes)
Bcoeff(volumes,24,seq(0,12),NaN,'volumes')
Bcoeffa(volumes,24,seq(0,12),NaN,'volumes')
</code></pre>


</div>