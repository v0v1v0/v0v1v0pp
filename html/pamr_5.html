<div class="container">

<table style="width: 100%;"><tr>
<td>pamr.batchadjust</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>A function to mean-adjust microarray data by batches</h2>

<h3>Description</h3>

<p>A function to mean-adjust microarray data by batches
</p>


<h3>Usage</h3>

<pre><code class="language-R">pamr.batchadjust(data)
</code></pre>


<h3>Arguments</h3>

<table><tr style="vertical-align: top;">
<td><code>data</code></td>
<td>
<p>The input data. A list with components: x- an expression genes
in the rows, samples in the columns, and y- a vector of the class labels for
each sample, and batchlabels- a vector of batch labels for each sample.</p>
</td>
</tr></table>
<h3>Details</h3>

<p><code>pamr.batchadjust</code> does a genewise one-way ANOVA adjustment for
expression values.  Let <code class="reqn">x(i,j)</code> be the expression for gene <code class="reqn">i</code> in sample <code class="reqn">j</code>.
Suppose sample <code class="reqn">j</code> in in batch <code class="reqn">b</code>, and let <code class="reqn">B</code> be the set of all samples in batch
<code class="reqn">b</code>. Then <code>pamr.batchadjust</code> adjusts <code class="reqn">x(i,j)</code> to <code class="reqn">x(i,j) - mean[x(i,j)]</code>
where the mean is taken over all samples <code class="reqn">j</code> in <code class="reqn">B</code>.
</p>


<h3>Value</h3>

<p>A data object of the same form as the input data, with x replaced by
the adjusted x
</p>


<h3>Author(s)</h3>

<p>Trevor Hastie,Robert Tibshirani, Balasubramanian Narasimhan, and
Gilbert Chu
</p>


<h3>Examples</h3>

<pre><code class="language-R">
suppressWarnings(RNGversion("3.5.0"))
set.seed(120)
#generate some data
x &lt;- matrix(rnorm(1000*20),ncol=20)
y &lt;- sample(c(1:4),size=20,replace=TRUE)
batchlabels &lt;- sample(c(1:5),size=20,replace=TRUE)
mydata &lt;- list(x=x,y=factor(y),batchlabels=factor(batchlabels))

mydata2 &lt;- pamr.batchadjust(mydata)

</code></pre>


</div>