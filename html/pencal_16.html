<div class="container">

<table style="width: 100%;"><tr>
<td>simulate_prcmlpmm_data</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>Simulate data that can be used to fit the PRC-LMM model</h2>

<h3>Description</h3>

<p>This function allows to simulate a survival outcome
from longitudinal predictors following the PRC MLPMM model
presented in Signorelli et al. (2021). Specifically, the 
longitudinal predictors are simulated from multivariate 
latent process mixed models (MLPMMs), and 
the survival outcome from a Weibull model where the time
to event depends on the random effects from the MLPMMs.
</p>


<h3>Usage</h3>

<pre><code class="language-R">simulate_prcmlpmm_data(n = 100, p = 5, p.relev = 2, n.items = c(3, 2,
  3, 4, 1), type = "u", t.values = c(0, 0.5, 1, 2),
  landmark = max(t.values), seed = 1, lambda = 0.2, nu = 2,
  cens.range = c(landmark, 10), base.age.range = c(3, 5), tau.age = 0.2)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>n</code></td>
<td>
<p>sample size</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>p</code></td>
<td>
<p>number of longitudinal latent processes</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>p.relev</code></td>
<td>
<p>number of latent processes that
are associated with the survival outcome (min: 1, max: p)</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>n.items</code></td>
<td>
<p>number of items that are observed for each 
latent process of interest. It must be either a scalar, or
a vector of length <code>p</code></p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>type</code></td>
<td>
<p>the type of relation between the longitudinal
outcomes and survival time. Two values can be used: 'u' 
refers to the PRC-MLPMM(U) model, and 'u+b' to the PRC-MLPMM(U+B)
model presented in Section 2.3 of Signorelli et al. (2021).
See the article for the mathematical details</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>t.values</code></td>
<td>
<p>vector specifying the time points 
at which longitudinal measurements are collected
(NB: for simplicity, this function assumes a balanced 
designed; however, <code>pencal</code> is designed to work
both with balanced and with unbalanced designs!)</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>landmark</code></td>
<td>
<p>the landmark time up until which all individuals survived.
Default is equal to <code>max(t.values)</code></p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>seed</code></td>
<td>
<p>random seed (defaults to 1)</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>lambda</code></td>
<td>
<p>Weibull location parameter, positive</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>nu</code></td>
<td>
<p>Weibull scale parameter, positive</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>cens.range</code></td>
<td>
<p>range for censoring times. By default, the minimum
of this range is equal to the <code>landmark</code> time</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>base.age.range</code></td>
<td>
<p>range for age at baseline (set it
equal to c(0, 0) if you want all subjects to enter
the study at the same age)</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>tau.age</code></td>
<td>
<p>the coefficient that multiplies baseline age
in the linear predictor (like in formulas (7) and (8) from  
Signorelli et al. (2021))</p>
</td>
</tr>
</table>
<h3>Value</h3>

<p>A list containing the following elements:
</p>

<ul>
<li>
<p> a dataframe <code>long.data</code> with data on the longitudinal 
predictors, comprehensive of a subject id (<code>id</code>),
baseline age (<code>base.age</code>), time from baseline
(<code>t.from.base</code>) and the longitudinal biomarkers;
</p>
</li>
<li>
<p> a dataframe <code>surv.data</code> with the survival data: 
a subject id (<code>id</code>), baseline age (<code>baseline.age</code>),
the time to event outcome (<code>time</code>) and a binary vector
(<code>event</code>) that is 1 if the event
is observed, and 0 in case of right-censoring;
</p>
</li>
<li> <p><code>perc.cens</code> the proportion of censored individuals 
in the simulated dataset.
</p>
</li>
</ul>
<h3>Author(s)</h3>

<p>Mirko Signorelli
</p>


<h3>References</h3>

<p>Signorelli, M. (2024). pencal: an R Package for the Dynamic 
Prediction of Survival with Many Longitudinal Predictors. 
To appear in: The R Journal. Preprint: arXiv:2309.15600
</p>
<p>Signorelli, M., Spitali, P., Al-Khalili Szigyarto, C, 
The MARK-MD Consortium, Tsonaka, R. (2021). 
Penalized regression calibration: a method for the prediction 
of survival outcomes using complex longitudinal and 
high-dimensional data. Statistics in Medicine, 40 (27), 6178-6196.
DOI: 10.1002/sim.9178
</p>


<h3>Examples</h3>

<pre><code class="language-R"># generate example data
simdata = simulate_prcmlpmm_data(n = 40, p = 6,  
             p.relev = 3, n.items = c(3,4,2,5,4,2), 
             type = 'u+b', t.values = c(0, 0.5, 1, 2), 
             landmark = 2, seed = 19931101)

# names of the longitudinal outcomes:
names(simdata$long.data)
# markerx_y is the y-th item for latent process (LP) x
# we have 6 latent processes of interest, and for LP1 
# we measure 3 items, for LP2 4, for LP3 2 items, and so on

# visualize trajectories of marker1_1
if(requireNamespace("ptmixed")) {
  ptmixed::make.spaghetti(x = age, y = marker1_1, 
                 id = id, group = id,
                 data = simdata$long.data, 
                 legend.inset = - 1)
 }
# proportion of censored subjects
simdata$censoring.prop
# visualize KM estimate of survival
library(survival)
surv.obj = Surv(time = simdata$surv.data$time, 
                event = simdata$surv.data$event)
kaplan &lt;- survfit(surv.obj ~ 1,  
                 type="kaplan-meier")
plot(kaplan)
</code></pre>


</div>