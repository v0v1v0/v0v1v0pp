<div class="container">

<table style="width: 100%;"><tr>
<td>sampleN.NTID</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>
Sample size estimation for BE decision via the FDA's method for narrow therapeutic index drugs (NTIDs)
</h2>

<h3>Description</h3>

<p>This function performs the sample size estimation for the BE decision for
the FDA’s method for NTIDs based on simulations. The study design is the full
replicate design 2x2x4 (TRTR|RTRT) or the 3-period replicate design with sequences TRT|RTR.
</p>


<h3>Usage</h3>

<pre><code class="language-R">sampleN.NTID(alpha = 0.05, targetpower = 0.8, theta0, theta1, theta2, CV,
             design = c("2x2x4", "2x2x3"), nsims = 1e+05, nstart, imax = 100,
             print = TRUE, details = TRUE, setseed = TRUE)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>alpha</code></td>
<td>

<p>Type I error probability. Per convention mostly set to 0.05.
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>targetpower</code></td>
<td>

<p>Power to achieve at least. Must be &gt;0 and &lt;1.<br>
Typical values are 0.8 or 0.9.
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>theta0</code></td>
<td>

<p>‘True’ or assumed T/R ratio.<br>
Attention! Defaults here to 0.975 if not given explicitly. The value was chosen
closer to 1 because the potency (contents) settings for NTIDs are tightened
by the FDA.
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>theta1</code></td>
<td>

<p>Conventional lower ABE limit to be applied in the FDA procedure.<br>
Defaults to 0.8 if not given explicitly.
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>theta2</code></td>
<td>

<p>Conventional upper ABE limit to be applied in the FDA procedure.<br>
Defaults to 1.25 if not given explicitly.
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>CV</code></td>
<td>

<p>Intra-subject coefficient(s) of variation as ratio (not percent).
</p>

<ul>
<li>
<p> If given as a scalar (<code>length(CV) == 1</code>) the <em>same</em> CV of Test
and Reference is assumed (homoscedasticity, <code>CVwT == CVwR</code>).
</p>
</li>
<li>
<p> If given as a vector (<code>length(CV) == 2</code>), <em>i.e.</em>, assuming
heteroscedasticity, the CV of the Test <strong>must</strong> be given in <code>CV[1]</code> and the one of the Reference in the <code>CV[2]</code>.
</p>
</li>
</ul>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>design</code></td>
<td>

<p>Design of the study to be planned.<br><code>"2x2x4"</code> is the full replicate with 2 sequences and 4 periods (TRTR|RTRT).<br><code>"2x2x3"</code> is the full replicate with 2 sequences and 3 periods (TRT|RTR).<br>
Defaults to <code>design = "2x2x4"</code>.
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>nsims</code></td>
<td>

<p>Number of simulations to be performed to obtain the empirical power.
Defaults to 100,000 = 1e+5.
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>nstart</code></td>
<td>

<p>Set this to a start value for the sample size if a previous run failed.<br>
May be missing.
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>imax</code></td>
<td>

<p>Maximum number of steps in sample size search. Defaults to 100.
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>print</code></td>
<td>

<p>If <code>TRUE</code> (default) the function prints its results. If <code>FALSE</code> only the resulting dataframe will be returned.
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>details</code></td>
<td>

<p>If set to <code>TRUE</code>, the default, the steps during sample size search are shown.
Moreover the details of the method settings are printed.
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>setseed</code></td>
<td>

<p>Simulations are dependent on the starting point of the (pseudo) random number
generator. To avoid differences in power values for different runs a
<code>set.seed(123456)</code> is issued if <code>setseed = TRUE</code>, the default.
</p>
</td>
</tr>
</table>
<h3>Details</h3>

<p>The linearized scaled ABE criterion is calculated according to the SAS code
given in the FDA’s guidances. For deciding BE the study must pass that criterion,
the conventional ABE test, and that the upper confidence limit of
<em>σ</em><sub>wT</sub>/<em>σ</em><sub>wR</sub> &amp;leq; 2.5.<br><br>
The simulations are done via the distributional properties of the statistical
quantities necessary for deciding BE based on this method.<br>
Details can be found in a document <code style="white-space: pre;">⁠Implementation_scaledABE_sims⁠</code> located in
the <code>/doc</code> sub-directory of the package.<br><br>
The estimated sample size gives always the <em>total</em> number of subjects (not subject / sequence – like in some other software packages).
</p>


<h3>Value</h3>

<p>Returns a data frame with the input settings and sample size results.<br>
The <code>Sample size</code> column contains the total sample size.<br>
The <code>nlast</code> column contains the last <code>n</code> value. May be useful for re-starting.
</p>


<h3>Warning</h3>

<p>For some input combinations the sample size search may be very time
consuming and will eventually even fail since the start values chosen may
not really reasonable for them. This applies especially for <code>theta0</code> values
close to the implied scaled limits according to
exp(&amp;mnplus;1.053605 × <em>s</em><sub>wR</sub>).<br>
In case of a failed sample size search you may restart with setting the argument
<code style="white-space: pre;">⁠nstart⁠</code>.<br>
In case of <code>theta0</code> values outside the implied scaled (tightened/widened) ABE limits
no sample size estimation is possible and the function throws an error
(f.i. <code>CV = 0.04, theta0 = 0.95</code>).
</p>


<h3>Note</h3>

<p>The design recommended by the FDA is the full replicate design <code>"2x2x4"</code>.<br>
The sample size estimation is done only for balanced studies since the
break down of the total subject number in case of unbalanced sequence groups
is not unique. Moreover the formulas used are only valid for balanced designs.<br>
The FDA method is described for the ABE limits 0.8 ... 1.25 only. Setting <code>theta1</code>,
<code>theta2</code> to other values may not be reasonable and is not tested.<br>
The results for the design <code>"2x2x3"</code> are to be considered as experimental since
at present not thorougly tested.<br>
The minimum sample size is 6, even if the power is higher than the intended
targetpower.<br><br>
The method is also required by China’s Center of Drug Evaluation.
</p>


<h3>Author(s)</h3>

<p>D. Labes
</p>


<h3>References</h3>

<p>Food and Drug Administration, Office of Generic Drugs (OGD). <em>Draft Guidance on Warfarin Sodium.</em> Recommended Dec 2012. <a href="https://www.accessdata.fda.gov/drugsatfda_docs/psg/Warfarin_Sodium_tab_09218_RC12-12.pdf">download</a>
</p>
<p>Food and Drug Administration, Center for Drug Evaluation and Research (CDER). <em>Draft Guidance for Industry. Bioequivalence Studies with Pharmacokinetic Endpoints for Drugs Submitted Under an ANDA.</em> August 2021. <a href="https://www.fda.gov/media/87219/download">download</a>
</p>
<p>Yu LX, Jiang W, Zhang X, Lionberger R, Makhlouf F, Schuirmann DJ, Muldowney L, Chen ML, Davit B, Conner D, Woodcock J. <em>Novel bioequivalence approach for narrow therapeutic index drugs.</em> Clin Pharmacol Ther. 2015;97(3):286–91. <a href="https://doi.org/10.1002/cpt.28">doi:10.1002/cpt.28</a>
</p>
<p>Jiang W, Makhlouf F, Schuirmann DJ, Zhang X, Zheng N, Conner D, Yu LX, Lionberger R. <em>A Bioequivalence Approach for Generic Narrow Therapeutic Index Drugs: Evaluation of the Reference-Scaled Approach and Variability Comparison Criterion.</em> AAPS J. 2015;17(4):891–901. <a href="https://doi.org/10.1208/s12248-015-9753-5">doi:10.1208/s12248-015-9753-5</a>
</p>
<p>Endrényi L, Tóthfalusi L. <em>Determination of Bioequivalence for Drugs with Narrow Therapeutic Index: Reduction of the Regulatory Burden.</em> J Pharm Pharm Sci. 2013;16(5):676–82. <a href="https://journals.library.ualberta.ca/jpps/index.php/JPPS/article/download/20900/15927/0">open access</a>
</p>


<h3>See Also</h3>

<p><code>power.NTID</code>
and <code>power.HVNTID</code>, <code>sampleN.HVNTID</code> for NTIDs with
high variability
</p>


<h3>Examples</h3>

<pre><code class="language-R">sampleN.NTID(CV = 0.04,theta0 = 0.975)
# should give
# n=54 with an (empirical) power of 0.809590
#
# Test formulation with lower variability
sampleN.NTID(CV = c(0.04,0.06),theta0 = 0.975)
# should give
# n=20 with an (empirical) power of 0.0.814610
#
# alternative 3-period design
sampleN.NTID(CV = 0.04,theta0 = 0.975, design="2x2x3")
# should give
# n=86 with power = 0.80364
</code></pre>


</div>