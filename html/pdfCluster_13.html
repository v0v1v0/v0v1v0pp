<div class="container">

<table style="width: 100%;"><tr>
<td>kepdf</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>
Kernel estimate of a probability density function. 
</h2>

<h3>Description</h3>

<p>Estimates density of uni- and multivariate data by the kernel method. 
</p>


<h3>Usage</h3>

<pre><code class="language-R">kepdf(x, eval.points = x, kernel = "gaussian", 
      bwtype = "fixed", h = h.norm(x), hx = NULL, alpha = 1/2)</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>x</code></td>
<td>

<p>A vector, a matrix or data-frame of data whose density should be estimated.  
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>eval.points</code></td>
<td>

<p>A vector, a matrix or a data-frame of data points at which the density estimate should be evaluated.  
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>kernel</code></td>
<td>

<p>Either 'gaussian' or 't7', it defines the kernel function to be used. See details below.
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>bwtype</code></td>
<td>

<p>Either 'fixed' or 'adaptive', corresponding to a kernel estimator with fixed or adaptive bandwidths respectively. 
See details below.
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>h</code></td>
<td>

<p>A vector of length set to <code>NCOL(x)</code>, defining the smoothing parameters to be used either to estimate
the density in kernel estimation with fixed bandwidth or to estimate the pilot density in kernel estimation 
with adaptive bandwidths. Default value is the result of <code>h.norm</code> applied to <code>x</code>. 
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>hx</code></td>
<td>

<p>A matrix with the same number of rows and columns as <code>x</code>, where each row defines the vector of smoothing parameters 
specific for each sample point. To be used when <code>bwtype = "adaptive"</code>. Default value is the result of <code>hprop2f</code> 
applied to <code>x</code>. Set to NULL when <code>bwtype= "fixed"</code>. 
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>alpha</code></td>
<td>

<p>Sensitivity parameter to be given to <code>hprop2f</code> when <code>bwtype= "adaptive"</code> and the vectors of smoothing parameters are computed according to Silverman's (1986) approach.



</p>
</td>
</tr>
</table>
<h3>Details</h3>

<p>The current version of <code>pdfCluster-package</code> allows for computing estimates by a kernel product 
estimator of the form: 
</p>
<p style="text-align: center;"><code class="reqn">\hat{f}(y)= \sum_{i=1}^n \frac{1}{n h_{i,1} \cdots h_{i,d}} \prod_{j=1}^d K\left(\frac{y_{j} - x_{i,j}}{h_{i,j}}\right).
</code>
</p>

<p>The kernel function <code class="reqn">K</code> can either be a Gaussian density (if <code>kernel = "gaussian"</code>) or a <code class="reqn">t_\nu</code> density, with <code class="reqn">\nu = 7</code> degrees of freedom (when <code>kernel = "t7"</code>).
Although uncommon, the option of selecting a <code class="reqn">t</code> kernel is motivated by computational efficiency reasons. Hence, its use is suggested when either <code>x</code> or <code>eval.points</code> have a huge number of rows.
</p>
<p>The vectors of bandwidths <code class="reqn">h_{i} = (h_{i,1} \cdots h_{i,d})'</code> are defined as follows: 
</p>

<dl>
<dt>Fixed bandwidth</dt>
<dd>
<p> When <code>bwtype='fixed'</code>, <code class="reqn">h_{i} = h</code> that is, a constant smoothing 
vector is used for all the observations <code class="reqn">x_i</code>. Default values are set as asymptotically optimal for a multivariate Normal distribution (e.g., Bowman and Azzalini, 1997).
See <code>h.norm</code> for further details.</p>
</dd>
<dt>Adaptive bandwidth</dt>
<dd>
<p>When <code>bwtype='adaptive'</code>, a vector of bandwidths <code class="reqn">h_i</code> is  
specified for each observation <code class="reqn">x_i</code>. Default values are selected according to Silverman 
(1986, Section 5.3.1). See <code>hprop2f</code>.





</p>
</dd>
</dl>
<h3>Value</h3>

<p>An S4 object of <code>kepdf-class</code> with slots:
</p>
<table>
<tr style="vertical-align: top;">
<td><code>call </code></td>
<td>
<p>The matched call.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>x </code></td>
<td>
<p>The data input, coerced to be a matrix.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>eval.points </code></td>
<td>
<p>The data points at which the density is evaluated.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>estimate </code></td>
<td>
<p>The values of the density estimate at the evaluation points.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>kernel </code></td>
<td>
<p>The selected kernel.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>bwtype </code></td>
<td>
<p>The type of estimator.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>par </code></td>
<td>
<p>A list of parameters used to estimate the density, with elements:
</p>

<ul>
<li> <p><code>h</code> the smoothing parameters used to estimate either the density or the pilot density;
</p>
</li>
<li> <p><code>hx</code>  the matrix of sample smoothing parameters, when <code>bwtype='adaptive'</code>;
</p>
</li>
<li> <p><code>alpha</code>  sensitivity parameter used if <code>bwtype='adaptive'</code>.
</p>
</li>
</ul>
</td>
</tr>
</table>
<h3>References</h3>

<p>Bowman, A.W. and Azzalini, A. (1997). <em>Applied smoothing techniques for data analysis: the kernel approach with S-Plus illustrations</em>. Oxford University Press, Oxford.
</p>
<p>Silverman, B. (1986). <em>Density estimation for statistics and data analysis</em>. Chapman and Hall, London.
</p>


<h3>See Also</h3>

<p><code>h.norm</code>, <code>hprop2f</code>, <code>kepdf-class</code>.
</p>


<h3>Examples</h3>

<pre><code class="language-R">## A 1-dimensional example
data(wine)
x &lt;- wine[,3] 
pdf &lt;- kepdf(x, eval.points=seq(0,7,by=.1))
plot(pdf, n.grid= 100, main="wine data")

## A 2-dimensional example
x &lt;- wine[,c(2,8)] 
pdf &lt;- kepdf(x)
plot(pdf, main="wine data", props=c(5,50,90), ylim=c(0,4))
plot(pdf, main="wine data", method="perspective", phi=30, theta=60)

### A 3-dimensional example
x &lt;- wine[,c(2,3,8)] 
pdf &lt;- kepdf(x)
plot(pdf, main="wine data", props=c(10,50,70), gap=0.2)
plot(pdf, main="wine data", method="perspective", gap=0.2, phi=30, theta=10)

### A 6-dimensional example
### adaptive kernel density estimate is preferable in high-dimensions
x &lt;- wine[,c(2,3,5,7,8,10)]
pdf &lt;- kepdf(x, bwtype="adaptive")
plot(pdf, main="wine data", props=c(10,50,70), gap=0.2)
plot(pdf, main="wine data", method="perspective", gap=0.2, phi=30, theta=10)

</code></pre>


</div>