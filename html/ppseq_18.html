<div class="container">

<table style="width: 100%;"><tr>
<td>sim_single_trial</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>Simulate a single trial with posterior probability monitoring</h2>

<h3>Description</h3>

<p>This function is meant to be used in the context of a
clinical trial with a binary endpoint. The goal is to simulate event counts
from the binomial distribution based on the number of patients
accrued at each interim look, and calculate the posterior predictive
probability of success (or futility) at the end of a trial,
given the data available at each interim analysis.
</p>


<h3>Usage</h3>

<pre><code class="language-R">sim_single_trial(
  p,
  n,
  p0,
  N,
  direction = "greater",
  delta = NULL,
  prior = c(0.5, 0.5),
  S = 5000,
  theta = 0.95
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>p</code></td>
<td>
<p>vector of length two containing the probability of event in
the standard of care and experimental arm c(p0, p1) for the two-sample case;
integer of event probability for one-sample case</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>n</code></td>
<td>
<p>matrix containing the total number of patients accrued so far at
each interim look in the standard of care (column 1) and experimental
(column 2) arms for two-sample case; vector of sample size accrued so far
at each interim look for one-sample case. The last value should be equal to
the total sample size at the end of the trial.
If only a single look will be done
at the end of the trial, this can be a vector specifying the total sample
size c(N0, N1) for the two-sample case or an integer specifying the total
sample size N for the one-sample case.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>p0</code></td>
<td>
<p>The target value to compare to in the one-sample case</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>N</code></td>
<td>
<p>the total planned sample size at the end of the trial, c(N0, N1)
for two-sample case; integer of total planned sample size at end of trial N
for one-sample case</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>direction</code></td>
<td>
<p>"greater" (default) if interest is in P(p1 &gt; p0) and "less"
if interest is in P(p1 &lt; p0) for two-sample case. For one-sample case,
"greater" if interest is in P(p &gt; p0) and "less" if interest is in P(p &lt; p0).</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>delta</code></td>
<td>
<p>clinically meaningful difference between groups.
Typically 0 for the two-sample case. NULL for the one-sample case (default).</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>prior</code></td>
<td>
<p>hyperparameters of prior beta distribution.
Beta(0.5, 0.5) is default</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>S</code></td>
<td>
<p>number of samples, default is 5000</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>theta</code></td>
<td>
<p>The target posterior probability. e.g. Efficacy decision if
P(p1 &gt; p0) &gt; theta for the two-sample case with greater direction.
Default is 0.95. Can be a vector if interest is in selecting from among a
variety of thresholds.</p>
</td>
</tr>
</table>
<h3>Value</h3>

<p>Returns a tibble with pp_threshold (i.e. theta, the target posterior
probability), number of responses, sample size,
posterior probability, and posterior predictive probability at each
look
</p>


<h3>Examples</h3>

<pre><code class="language-R">
set.seed(123)

# Setting S = 100 for speed, in practice you would want a much larger sample

# One-sample case
sim_single_trial(
  p = 0.3, 
  n = c(5, 10),  
  p0 = 0.1, 
  N = 25, 
  S = 100
  )

# Two-sample case 
sim_single_trial(
  p = c(0.1, 0.3), 
  n = cbind(c(5, 10), c(5, 10)), 
  p0 = NULL, 
  N = c(50, 50), 
  delta = 0, 
  S = 100
  )
  
</code></pre>


</div>