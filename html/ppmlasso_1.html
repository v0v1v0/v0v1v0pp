<div class="container">

<table style="width: 100%;"><tr>
<td>ppmlasso-package</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>PPM-LASSO: Point process models with LASSO-type penalties</h2>

<h3>Description</h3>

<p>This package contains tools to fit point process models with sequences of LASSO penalties ("regularisation paths"). 
Regularisation paths of Poisson point process models or area-interaction models can be fitted with LASSO, 
adaptive LASSO or elastic net penalties. A number of criteria are available to judge the bias-variance tradeoff.</p>


<h3>Details</h3>

<p>The key functions in ppmlasso are as follows:
</p>
<p><b>Useful pre-analysis functions:</b>
</p>

<dl>
<dt><code>findRes</code></dt>
<dd>
<p>Determine the optimal spatial resolution at which to perform analysis</p>
</dd>
<dt><code>getEnvVar</code></dt>
<dd>
<p>Interpolate environmental data to species presence locations</p>
</dd>
<dt><code>griddify</code></dt>
<dd>
<p>Ensure a matrix of environmental data is on a rectangular grid</p>
</dd>
<dt><code>ppmdat</code></dt>
<dd>
<p>Calculate observation weights and set up design matrix for fitting</p>
</dd>
<dt><code>pointInteractions</code></dt>
<dd>
<p>Calculate interpoint interactions for fitting area-interaction models</p>
</dd>
<dt><code>sampleQuad</code></dt>
<dd>
<p>Set up a regular grid of quadrature points</p>
</dd>
</dl>
<p><b>Creating regularisation paths of point process models:</b>
</p>

<dl>
<dt><code>ppmlasso</code></dt>
<dd>
<p>Fit a regularisation path of point process models</p>
</dd>
<dt><code>plotFit</code></dt>
<dd>
<p>Plot the fitted intensity of a <code>ppmlasso</code> object</p>
</dd>
<dt><code>plotPath</code></dt>
<dd>
<p>Plot the regularisation path of a <code>ppmlasso</code> object</p>
</dd>
<dt><code>print.ppmlasso</code></dt>
<dd>
<p>Print output from a <code>ppmlasso</code> object</p>
</dd>
<dt><code>predict.ppmlasso</code></dt>
<dd>
<p>Make predictions from a fitted point process model to new data</p>
</dd>
</dl>
<p><b>Checking assumptions:</b>
</p>

<dl>
<dt><code>diagnose.ppmlasso</code></dt>
<dd>
<p>Create diagnostic residual plots of <code>ppmlasso</code> object</p>
</dd>
<dt><code>envelope.ppmlasso</code></dt>
<dd>
<p>Create simulation envelope for goodness-of-fit checks on a <code>ppmlasso</code> object</p>
</dd>
</dl>
<h3>Author(s)</h3>

<p>Ian W. Renner
</p>
<p>Maintainer: Ian W. Renner &lt;Ian.Renner@newcastle.edu.au&gt;
</p>


<h3>References</h3>

<p>Renner, I.W. &amp; Warton, D.I. (2013). Equivalence of MAXENT and Poisson point process models for 
species distribution modeling in ecology <em>Biometrics</em> <b>69</b>, 274-281.
</p>
<p>Renner, I.W. et al (2015). Point process models for presence-only analysis. <em>Methods in Ecology and Evolution</em> <b>6</b>, 366-379.
</p>
<p>Renner, I.W., Warton, D.I., &amp; Hui, F.K.C. (2021). What is the effective sample size of a spatial point process? <em>Australian &amp; New Zealand Journal of Statistics</em> <b>63</b>, 144-158.
</p>


<h3>Examples</h3>

<pre><code class="language-R"># Fit a regularisation path of Poisson point process models
data(BlueMountains)
sub.env = BlueMountains$env[BlueMountains$env$Y &gt; 6270 &amp; BlueMountains$env$X &gt; 300,]
sub.euc = BlueMountains$eucalypt[BlueMountains$eucalypt$Y &gt; 6270 &amp; BlueMountains$eucalypt$X &gt; 300,]
ppm.form = ~ poly(FC, TMP_MIN, TMP_MAX, RAIN_ANN, degree = 2, raw = TRUE)
ppm.fit  = ppmlasso(ppm.form, sp.xy = sub.euc, env.grid = sub.env, sp.scale = 1, n.fits = 20,
writefile = FALSE)

# Fit a regularisation path of area-interaction models
data(BlueMountains)
ai.form  = ~ poly(FC, TMP_MIN, TMP_MAX, RAIN_ANN, degree = 2, raw = TRUE)
ai.fit   = ppmlasso(ai.form, sp.xy = sub.euc, env.grid = sub.env, sp.scale = 1, 
family = "area.inter", r = 2, availability = BlueMountains$availability, n.fits = 20,
writefile = FALSE)

# Print a ppmlasso object
print(ppm.fit, out = "model")

# Residual plot of a ppmlasso object
diagnose(ppm.fit, which = "smooth", type = "Pearson")

# Make predictions
pred.mu = predict(ppm.fit, newdata = sub.env)

# Plot the intensity from a fitted ppmlasso object
plotFit(ppm.fit)

# Plot the regularisation path from a fitted ppmlasso object
plotPath(ppm.fit)

</code></pre>


</div>