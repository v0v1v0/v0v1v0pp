<div class="container">

<table style="width: 100%;"><tr>
<td>Import Nexus and Newick files</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>Create a <code>phylo4</code>, <code>phylo4d</code> or <code>data.frame</code> object
from a NEXUS or a Newick file</h2>

<h3>Description</h3>

<p><code>readNexus</code> reads a NEXUS file and outputs a <code>phylo4</code>,
<code>phylo4d</code> or <code>data.frame</code> object.
</p>


<h3>Usage</h3>

<pre><code class="language-R">readNCL(
  file,
  simplify = FALSE,
  type = c("all", "tree", "data"),
  spacesAsUnderscores = TRUE,
  char.all = FALSE,
  polymorphic.convert = TRUE,
  levels.uniform = FALSE,
  quiet = TRUE,
  check.node.labels = c("keep", "drop", "asdata"),
  return.labels = TRUE,
  file.format = c("nexus", "newick"),
  check.names = TRUE,
  convert.edge.length = FALSE,
  ...
)

readNexus(
  file,
  simplify = FALSE,
  type = c("all", "tree", "data"),
  char.all = FALSE,
  polymorphic.convert = TRUE,
  levels.uniform = FALSE,
  quiet = TRUE,
  check.node.labels = c("keep", "drop", "asdata"),
  return.labels = TRUE,
  check.names = TRUE,
  convert.edge.length = FALSE,
  ...
)

readNewick(
  file,
  simplify = FALSE,
  quiet = TRUE,
  check.node.labels = c("keep", "drop", "asdata"),
  convert.edge.length = FALSE,
  ...
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>file</code></td>
<td>
<p>a NEXUS file for <code>readNexus</code> or a file that
contains Newick formatted trees for <code>readNewick</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>simplify</code></td>
<td>
<p>If TRUE, if there are multiple trees in the file,
only the first one is returned; otherwise a list of
<code>phylo4(d)</code> objects is returned if the file contains multiple
trees.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>type</code></td>
<td>
<p>Determines which type of objects to return, if present
in the file (see Details).</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>spacesAsUnderscores</code></td>
<td>
<p>In the NEXUS file format white spaces
are not allowed in taxa labels and are represented by
underscores. Therefore, NCL converts underscores found in taxa
labels in the NEXUS file into white spaces
(e.g. <code>species_1</code> will become <code>"species 1"</code>. If you
want to preserve the underscores, set as TRUE, the default).</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>char.all</code></td>
<td>
<p>If <code>TRUE</code>, returns all characters, even those
excluded in the NEXUS file</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>polymorphic.convert</code></td>
<td>
<p>If <code>TRUE</code>, converts polymorphic
characters to missing data</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>levels.uniform</code></td>
<td>
<p>If <code>TRUE</code>, uses the same levels for all
characters</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>quiet</code></td>
<td>
<p>If <code>FALSE</code> the output of the NCL interface is
printed. This is mainly for debugging purposes. This option
can considerably slow down the process if the tree is big or
there are many trees in the file.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>check.node.labels</code></td>
<td>
<p>Determines how the node labels in the
NEXUS or Newick files should be treated in the phylo4 object,
see Details for more information.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>return.labels</code></td>
<td>
<p>Determines whether state names (if
<code>TRUE</code>) or state codes should be returned.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>file.format</code></td>
<td>
<p>character indicating the format of the
specified file (either “<code>newick</code>” or
“<code>nexus</code>”). It's more convenient to just use
<code>readNexus</code>  or <code>readNewick</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>check.names</code></td>
<td>
<p>logical. If ‘TRUE’ then the names of the
characters from the NEXUS file are checked to ensure that they
are syntactically valid variable names and are not duplicated.
If necessary they are adjusted using ‘make.names’.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>convert.edge.length</code></td>
<td>
<p>logical. If <code>TRUE</code> negative edge
lengths are replaced with 0. At this time <code>phylobase</code>
does not accept objects with negative branch lengths, this
workaround allows to import trees with negative branch
lengths.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>...</code></td>
<td>
<p>Additional arguments to be passed to phylo4 or
phylo4d constructor (see Details)</p>
</td>
</tr>
</table>
<h3>Details</h3>

<p><code>readNewick</code> reads a Newick file and outputs a <code>phylo4</code>
or <code>phylo4d</code> object.
</p>
<p><code>readNexus</code> is used internally by both <code>readNexus</code> and
<code>readNewick</code> to extract data held in a tree files,
specifically in NEXUS files from DATA, CHARACTER or TREES
blocks.
</p>
<p>The <code>type</code> argument specifies which of these is returned:
</p>

<dl>
<dt>data</dt>
<dd>
<p>will only return a <code>data.frame</code> of the contents
of all DATA and CHARACTER blocks.</p>
</dd>
<dt>tree</dt>
<dd>
<p>will only return a <code>phylo4</code> object of the
contents of the TREES block.</p>
</dd>
<dt>all</dt>
<dd>
<p>if only data or a tree are present in the file, this
option will act as the options above, returning either a
<code>data.frame</code> or a <code>phylo4</code> object respectively. If both
are present then a <code>phylo4d</code> object is returned containing
both.</p>
</dd>
</dl>
<p>The function returns <code>NULL</code> if the <code>type</code> of
data requested is not present in the file, or if neither data nor
tree blocks are present.
</p>
<p>Depending on the context <code>readNexus</code> will call either the
<code>phylo4</code> or <code>phylo4d</code> constructor. The <code>phylo4d</code>
constructor will be used with <code>type="all"</code>, or if the option
<code>check.node.labels="asdata"</code> is invoked.
</p>
<p><code>readNewick</code> imports Newick formatted tree files and will
return a <code>phylo4</code> or a <code>phylo4d</code> object if the option
<code>check.node.labels="asdata"</code> is invoked.
</p>
<p>For both <code>readNexus</code> and <code>readNewick</code>, the options for
<code>check.node.labels</code> can take the values:
</p>

<dl>
<dt>keep</dt>
<dd>
<p>the node labels of the trees will be passed as node
labels in the <code>phylo4</code> object</p>
</dd>
<dt>drop</dt>
<dd>
<p>the node labels of the trees will be ignored in the
<code>phylo4</code> object</p>
</dd>
<dt>asdata</dt>
<dd>
<p>the node labels will be passed as data and a
<code>phylo4d</code> object will be returned.</p>
</dd>
</dl>
<p>If you use the option <code>asdata</code> on a file with no node labels,
a warning message is issued, and is thus equivalent to the value
<code>drop</code>.
</p>
<p>For both <code>readNexus</code> and <code>readNewick</code>, additional
arguments can be passed to the constructors such as <code>annote</code>,
<code>missing.data</code> or <code>extra.data</code>. See the ‘Details’
section of <code>phylo4d-methods</code> for the complete list of
options.
</p>


<h3>Value</h3>

<p>Depending on the value of <code>type</code> and the contents of
the file, one of: a <code>data.frame</code>, a phylo4
object, a phylo4d object or <code>NULL</code>.  If
several trees are included in the NEXUS file and the option
<code>simplify=FALSE</code> a list of phylo4 or
phylo4d objects is returned.
</p>


<h3>Note</h3>

<p>Underscores in state labels (i.e. trait or taxon names) will
be translated to spaces. Unless <code>check.names=FALSE</code>, trait
names will be converted to valid R names (see
<code>make.names</code>) on input to R, so spaces will be
translated to periods.
</p>


<h3>Author(s)</h3>

<p>Brian O'Meara, Francois Michonneau, Derrick Zwickl
</p>


<h3>See Also</h3>

<p>the phylo4d class, the phylo4
class
</p>


</div>