<div class="container">

<table style="width: 100%;"><tr>
<td>PAS.binmod</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>
binmod
</h2>

<h3>Description</h3>

<p>This is the main function for bin model analysis.
</p>


<h3>Usage</h3>

<pre><code class="language-R">binmod(x, y, map, beta0=NA, binsizelist=-1, full.search=FALSE, foldid=NA, ...)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>x</code></td>
<td>

<p>input matrix, of dimensions nobs*nvars; each row is a observation vector of an individual and each column is a genotypic indicator vector for a molecular marker.
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>y</code></td>
<td>
<p>a matrix of response variable (phenotypic observations), of dimensions nobs*1.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>map</code></td>
<td>
<p>A data frame for linkage map or physical map.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>beta0</code></td>
<td>
<p>Estimated SNP effects obtained by univariate analysis. By default, the glm function in R will be called by the binmod to calculate the estimates of effects.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>binsizelist</code></td>
<td>
<p>A list of binsizes to be considered in the analysis. A default list will be generated if the option was ignored or an invalid list has been specified.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>full.search</code></td>
<td>

<p>A logic indicator selecting search strategies. If FALSE was assigned, the binmod will complete the running as soon as the optimal binsize was found. Otherwise, analysis will be conducted for all binsizes on the list. 
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>foldid</code></td>
<td>

<p>An optional vector of values between 1 and nfold identifying what fold each observation is in. If not supplied, a random vector is generated under nfold=10.
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>...</code></td>
<td>

<p>Other parameters need to be passed to glmnet/r and glm/r. 
</p>
</td>
</tr>
</table>
<h3>Details</h3>

<p>The function invokes binmod analysis for genomic value prediction. The default settings are strongly suggested for new users.
</p>


<h3>Value</h3>

<table>
<tr style="vertical-align: top;">
<td><code>grid</code></td>
<td>
<p>information of all searched binsizes</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>grid$mselist</code></td>
<td>
<p>a 'data.frame': nbinsizes of 4 variables # A list of mean square errors</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>grid$mselist$binsize</code></td>
<td>
<p>size settings of the bins, eight in bp or cM.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>grid$mselist$mse</code></td>
<td>
<p>mean square error</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>grid$mselist$mse_std</code></td>
<td>
<p>the standard deviation of MSEs</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>grid$mselist$nbin</code></td>
<td>
<p>number of bins under the binsize setting</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>grid$optbinsize</code></td>
<td>
<p>optimal binsize</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>grid$optid</code></td>
<td>
<p>order of the optimal binsize in the grid</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>optimal</code></td>
<td>
<p>result obtained under the optimal binsize</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>optimal$predict</code></td>
<td>
<p>phentypic values and its' predicted values under the optimal model.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>optimal$predict$y</code></td>
<td>
<p>original phenotypic observations</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>optimal$predict$yp_cv</code></td>
<td>
<p>predictions by 10-fold cross-validation.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>optimal$beta</code></td>
<td>
<p>estimated bin parameters</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>optimal$beta$beta</code></td>
<td>
<p>bin effect</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>optimal$beta$SSx</code></td>
<td>
<p>sum of square of bin indicator</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>optimal$beta$Se</code></td>
<td>
<p>residual error</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>optimal$beta$Sb</code></td>
<td>
<p>estimating error of bin effect</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>optimal$beta$Wald</code></td>
<td>
<p>Wald-test statistics</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>optimal$beta$LOD</code></td>
<td>
<p>LOD-test statistics</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>optimal$xbin</code></td>
<td>
<p>indicator matrix of the bins under the optimal binsize</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>optimal$map</code></td>
<td>
<p>'data.frame':	of  5 variables: #bin map</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>optimal$map$chr</code></td>
<td>
<p>chromosome id</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>optimal$map$pos</code></td>
<td>
<p>bin position</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>optimal$map$pos_id</code></td>
<td>
<p>mean of the orders of markers in the bin</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>optimal$map$start_id</code></td>
<td>
<p>the order the first maker in a bin</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>optimal$map$end_id</code></td>
<td>
<p>the order the last maker in a bin</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>optimal$binsize</code></td>
<td>
<p>optimal binsize</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>optimal$cv</code></td>
<td>
<p>cross-validation results</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>optimal$cv$binsize</code></td>
<td>
<p>binsize</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>optimal$cv$nbin</code></td>
<td>
<p>number of bins under the binsize setting</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>optimal$cv$mse</code></td>
<td>
<p>mean squared error obtained from cross-validation</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>optimal$cv$r</code></td>
<td>
<p>Pearson's correlation coefficient obtained from cross-validation</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>snp</code></td>
<td>
<p>SNP information</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>snp$map</code></td>
<td>
<p>linkage map or physical map</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>snp$map$chr</code></td>
<td>
<p>chromosome id</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>snp$map$pos</code></td>
<td>
<p>marker position</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>snp$map$pos_id</code></td>
<td>
<p>marker order</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>snp$effect</code></td>
<td>
<p>single marker analysis result</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>snp$effect$beta</code></td>
<td>
<p>SNP effect</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>snp$effect$SSx</code></td>
<td>
<p>sum of square of genotypic indicator</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>snp$effect$Se</code></td>
<td>
<p>residual variance</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>snp$effect$Sb</code></td>
<td>
<p>estimating error of marker effect</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>snp$effect$Wald</code></td>
<td>
<p>Wald-test statistics</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>snp$effect$LOD</code></td>
<td>
<p>LOD test statistics</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>snp$mapinfo</code></td>
<td>
<p>a brief summary of the map</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>snp$mapinfo$chr</code></td>
<td>
<p>chromosome id</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>snp$mapinfo$start</code></td>
<td>
<p>the position of the first marker on the chromosome</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>snp$mapinfo$end</code></td>
<td>
<p>the position of the last marker on the chromosome</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>snp$mapinfo$length</code></td>
<td>
<p>length of the chromosome</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>snp$mapinfo$nmark</code></td>
<td>
<p>number of markers on the chromosome</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>snp$mapinfo$aver</code></td>
<td>
<p>average interval of the chromosome</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>snp$mapinfo$min.interval</code></td>
<td>
<p>the smallest interval size on the chromosome</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>cvfit</code></td>
<td>
<p>A cv.glmnet project. See manual of glmnet for details.</p>
</td>
</tr>
</table>
<h3>References</h3>

<p>Zhiqiu Hu, Zhiquan Wang, and Shizhong Xu (2012) An infinitesimal model for quantitative trait genomic value prediction. PloS ONE
</p>


<h3>Examples</h3>

<pre><code class="language-R">#load PAS library
library (PAS)
#load the demo data
data (beef)
#perform binmod analysis under the default settings.
binmod.result=binmod (x , y , map)
#plot binmod result
plot(binmod.result)
str(binmod.result)
#Output the predicted phenotypic values that was obtained
#by 10-fold cross validation .
predict(binmod.result)
#predict the phenotypic values for new individuals
x1=x[sample(1:NROW(x) , 20), ]
bin.pred.x1=predict(binmod.result, newx=x1)
str(bin.pred.x1)
</code></pre>


</div>