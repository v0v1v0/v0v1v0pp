<div class="container">

<table style="width: 100%;"><tr>
<td>SimulationModel</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>R6 class representing a simulation model</h2>

<h3>Description</h3>

<p><code>R6</code> class representing a spatially-explicit simulation
model. It extends the <code>SpatialModel</code> class with a range of common
simulation parameters and functionality for creating a nested model, whereby a nested
template model with fixed parameters is maintained when a model is cloned for various
sampled parameters. Also provided are methods for checking the consistency and
completeness of model parameters.
</p>


<h3>Super classes</h3>

<p><code>poems::GenericClass</code> -&gt; <code>poems::GenericModel</code> -&gt; <code>poems::SpatialModel</code> -&gt; <code>SimulationModel</code>
</p>


<h3>Public fields</h3>

<div class="r6-fields">

<dl>
<dt><code>attached</code></dt>
<dd>
<p>A list of dynamically attached attributes (name-value pairs).</p>
</dd>
</dl>
</div>


<h3>Active bindings</h3>

<div class="r6-active-bindings">

<dl>
<dt><code>simulation_function</code></dt>
<dd>
<p>Name (character string) or source path of the default simulation function, which takes a model as an input and returns the simulation results.</p>
</dd>
<dt><code>model_attributes</code></dt>
<dd>
<p>A vector of model attribute names.</p>
</dd>
<dt><code>region</code></dt>
<dd>
<p>A <code>Region</code> (or inherited class) object specifying the study region.</p>
</dd>
<dt><code>coordinates</code></dt>
<dd>
<p>Data frame (or matrix) of X-Y population (WGS84) coordinates in longitude (degrees West) and latitude (degrees North) (get and set), or distance-based coordinates dynamically returned by region raster (get only).</p>
</dd>
<dt><code>random_seed</code></dt>
<dd>
<p>Number to seed the random number generation for stochasticity.</p>
</dd>
<dt><code>replicates</code></dt>
<dd>
<p>Number of replicate simulation runs.</p>
</dd>
<dt><code>time_steps</code></dt>
<dd>
<p>Number of simulation time steps.</p>
</dd>
<dt><code>years_per_step</code></dt>
<dd>
<p>Number of years per time step.</p>
</dd>
<dt><code>results_selection</code></dt>
<dd>
<p>List of simulator-dependent attributes to be included in the returned results of each simulation run.</p>
</dd>
<dt><code>attribute_aliases</code></dt>
<dd>
<p>A list of alternative alias names for model attributes (form: <code>alias = "attribute"</code>) to be used with the set and get attributes methods.</p>
</dd>
<dt><code>template_model</code></dt>
<dd>
<p>Nested template model for fixed (non-sampled) attributes for shallow cloning.</p>
</dd>
<dt><code>sample_attributes</code></dt>
<dd>
<p>Vector of sample attribute names (only).</p>
</dd>
<dt><code>required_attributes</code></dt>
<dd>
<p>Vector of required attribute names (only), i.e. those needed to run a simulation.</p>
</dd>
<dt><code>error_messages</code></dt>
<dd>
<p>A vector of error messages encountered when setting model attributes.</p>
</dd>
<dt><code>warning_messages</code></dt>
<dd>
<p>A vector of warning messages encountered when setting model attributes.</p>
</dd>
</dl>
</div>


<h3>Methods</h3>



<h4>Public methods</h4>


<ul>
<li> <p><a href="#method-SimulationModel-new"><code>SimulationModel$new()</code></a>
</p>
</li>
<li> <p><a href="#method-SimulationModel-new_clone"><code>SimulationModel$new_clone()</code></a>
</p>
</li>
<li> <p><a href="#method-SimulationModel-get_attribute_names"><code>SimulationModel$get_attribute_names()</code></a>
</p>
</li>
<li> <p><a href="#method-SimulationModel-get_attributes"><code>SimulationModel$get_attributes()</code></a>
</p>
</li>
<li> <p><a href="#method-SimulationModel-set_attributes"><code>SimulationModel$set_attributes()</code></a>
</p>
</li>
<li> <p><a href="#method-SimulationModel-set_sample_attributes"><code>SimulationModel$set_sample_attributes()</code></a>
</p>
</li>
<li> <p><a href="#method-SimulationModel-is_consistent"><code>SimulationModel$is_consistent()</code></a>
</p>
</li>
<li> <p><a href="#method-SimulationModel-list_consistency"><code>SimulationModel$list_consistency()</code></a>
</p>
</li>
<li> <p><a href="#method-SimulationModel-inconsistent_attributes"><code>SimulationModel$inconsistent_attributes()</code></a>
</p>
</li>
<li> <p><a href="#method-SimulationModel-is_complete"><code>SimulationModel$is_complete()</code></a>
</p>
</li>
<li> <p><a href="#method-SimulationModel-list_completeness"><code>SimulationModel$list_completeness()</code></a>
</p>
</li>
<li> <p><a href="#method-SimulationModel-incomplete_attributes"><code>SimulationModel$incomplete_attributes()</code></a>
</p>
</li>
<li> <p><a href="#method-SimulationModel-clone"><code>SimulationModel$clone()</code></a>
</p>
</li>
</ul>
<details open><summary>Inherited methods</summary><ul>
<li><span class="pkg-link" data-pkg="poems" data-topic="GenericModel" data-id="get_attribute"><a href="../../poems/html/GenericModel.html#method-GenericModel-get_attribute"><code>poems::GenericModel$get_attribute()</code></a></span></li>
<li><span class="pkg-link" data-pkg="poems" data-topic="GenericModel" data-id="get_attribute_aliases"><a href="../../poems/html/GenericModel.html#method-GenericModel-get_attribute_aliases"><code>poems::GenericModel$get_attribute_aliases()</code></a></span></li>
</ul></details><hr>
<a id="method-SimulationModel-new"></a>



<h4>Method <code>new()</code>
</h4>

<p>Initialization method sets template model and sets given attributes individually and/or from a list.
</p>


<h5>Usage</h5>

<div class="r"><pre>SimulationModel$new(template = NULL, required_attributes = NULL, ...)</pre></div>



<h5>Arguments</h5>

<div class="arguments">

<dl>
<dt><code>template</code></dt>
<dd>
<p>Template simulation model (nested) containing fixed (non-sampled) attributes.</p>
</dd>
<dt><code>required_attributes</code></dt>
<dd>
<p>Vector of required attribute names (only), i.e. those needed to run a simulation.</p>
</dd>
<dt><code>...</code></dt>
<dd>
<p>Parameters passed via a <em>params</em> list or individually.</p>
</dd>
</dl>
</div>


<hr>
<a id="method-SimulationModel-new_clone"></a>



<h4>Method <code>new_clone()</code>
</h4>

<p>Creates a new (re-initialized) object of the current (inherited) object class with optionally passed parameters.
</p>


<h5>Usage</h5>

<div class="r"><pre>SimulationModel$new_clone(...)</pre></div>



<h5>Arguments</h5>

<div class="arguments">

<dl>
<dt><code>...</code></dt>
<dd>
<p>Parameters passed via the inherited class constructor (defined in initialize and run via new).</p>
</dd>
</dl>
</div>



<h5>Returns</h5>

<p>New object of the current (inherited) class.
</p>


<hr>
<a id="method-SimulationModel-get_attribute_names"></a>



<h4>Method <code>get_attribute_names()</code>
</h4>

<p>Returns a list of all attribute names including public and private model attributes, as well as attached attributes (including those from the template model).
</p>


<h5>Usage</h5>

<div class="r"><pre>SimulationModel$get_attribute_names()</pre></div>



<h5>Returns</h5>

<p>List of all attribute names.
</p>


<hr>
<a id="method-SimulationModel-get_attributes"></a>



<h4>Method <code>get_attributes()</code>
</h4>

<p>Returns a list of values for selected attributes or attribute aliases (when array of parameter names provided) or all attributes (when no params).
</p>


<h5>Usage</h5>

<div class="r"><pre>SimulationModel$get_attributes(params = NULL)</pre></div>



<h5>Arguments</h5>

<div class="arguments">

<dl>
<dt><code>params</code></dt>
<dd>
<p>Array of attribute names to return (all when NULL).</p>
</dd>
</dl>
</div>



<h5>Returns</h5>

<p>List of selected or all attributes values.
</p>


<hr>
<a id="method-SimulationModel-set_attributes"></a>



<h4>Method <code>set_attributes()</code>
</h4>

<p>Sets given attributes (optionally via alias names) individually and/or from a list.
</p>


<h5>Usage</h5>

<div class="r"><pre>SimulationModel$set_attributes(params = list(), ...)</pre></div>



<h5>Arguments</h5>

<div class="arguments">

<dl>
<dt><code>params</code></dt>
<dd>
<p>List of parameters/attributes.</p>
</dd>
<dt><code>...</code></dt>
<dd>
<p>Parameters/attributes passed individually.</p>
</dd>
</dl>
</div>


<hr>
<a id="method-SimulationModel-set_sample_attributes"></a>



<h4>Method <code>set_sample_attributes()</code>
</h4>

<p>Sets the names (only - when <em>params</em> is a vector) and values (when <em>params</em> is a list and/or when name-value pairs are provided) of the sample attributes for the model.
</p>


<h5>Usage</h5>

<div class="r"><pre>SimulationModel$set_sample_attributes(params = list(), ...)</pre></div>



<h5>Arguments</h5>

<div class="arguments">

<dl>
<dt><code>params</code></dt>
<dd>
<p>List of parameters/attributes (names and values) or array of names only.</p>
</dd>
<dt><code>...</code></dt>
<dd>
<p>Parameters/attributes passed individually.</p>
</dd>
</dl>
</div>


<hr>
<a id="method-SimulationModel-is_consistent"></a>



<h4>Method <code>is_consistent()</code>
</h4>

<p>Returns a boolean to indicate if (optionally selected or all) model attributes (such as dimensions) are consistent/valid.
</p>


<h5>Usage</h5>

<div class="r"><pre>SimulationModel$is_consistent(params = NULL)</pre></div>



<h5>Arguments</h5>

<div class="arguments">

<dl>
<dt><code>params</code></dt>
<dd>
<p>Optional array of parameter/attribute names.</p>
</dd>
</dl>
</div>



<h5>Returns</h5>

<p>Boolean to indicate consistency of selected/all attributes.
</p>


<hr>
<a id="method-SimulationModel-list_consistency"></a>



<h4>Method <code>list_consistency()</code>
</h4>

<p>Returns a boolean to indicate if (optionally selected or all) model attributes (such as dimensions) are consistent/valid.
</p>


<h5>Usage</h5>

<div class="r"><pre>SimulationModel$list_consistency(params = NULL)</pre></div>



<h5>Arguments</h5>

<div class="arguments">

<dl>
<dt><code>params</code></dt>
<dd>
<p>Optional array of parameter/attribute names.</p>
</dd>
</dl>
</div>



<h5>Returns</h5>

<p>List of booleans (or NAs) to indicate consistency of selected/all attributes.
</p>


<hr>
<a id="method-SimulationModel-inconsistent_attributes"></a>



<h4>Method <code>inconsistent_attributes()</code>
</h4>

<p>Returns a list of attributes necessary to simulate the model that are inconsistent/invalid.
</p>


<h5>Usage</h5>

<div class="r"><pre>SimulationModel$inconsistent_attributes(include_nas = FALSE)</pre></div>



<h5>Arguments</h5>

<div class="arguments">

<dl>
<dt><code>include_nas</code></dt>
<dd>
<p>Optional boolean indicating whether of not to include attributes with unknown consistency (NA).</p>
</dd>
</dl>
</div>



<h5>Returns</h5>

<p>List of inconsistent attributes which prevent the model simulation (and optionally those where consistency is not available).
</p>


<hr>
<a id="method-SimulationModel-is_complete"></a>



<h4>Method <code>is_complete()</code>
</h4>

<p>Returns a boolean to indicate if all attributes necessary to simulate the model have been set and are consistent/valid.
</p>


<h5>Usage</h5>

<div class="r"><pre>SimulationModel$is_complete()</pre></div>



<h5>Returns</h5>

<p>Boolean to indicate model completeness (and consistency).
</p>


<hr>
<a id="method-SimulationModel-list_completeness"></a>



<h4>Method <code>list_completeness()</code>
</h4>

<p>Returns a list of booleans (or NAs) for each parameter to indicate attributes that are necessary to simulate the model have been set and are consistent/valid.
</p>


<h5>Usage</h5>

<div class="r"><pre>SimulationModel$list_completeness()</pre></div>



<h5>Returns</h5>

<p>List of booleans (or NAs) for each parameter to indicate to indicate completeness (and consistency).
</p>


<hr>
<a id="method-SimulationModel-incomplete_attributes"></a>



<h4>Method <code>incomplete_attributes()</code>
</h4>

<p>Returns a list of attributes necessary to simulate the model that are incomplete/inconsistent/invalid.
</p>


<h5>Usage</h5>

<div class="r"><pre>SimulationModel$incomplete_attributes(include_nas = FALSE)</pre></div>



<h5>Arguments</h5>

<div class="arguments">

<dl>
<dt><code>include_nas</code></dt>
<dd>
<p>Optional boolean indicating whether of not to include attributes with unknown completeness (NA).</p>
</dd>
</dl>
</div>



<h5>Returns</h5>

<p>List of incomplete attributes which prevent the model simulation (and optionally those where completeness is not available).
</p>


<hr>
<a id="method-SimulationModel-clone"></a>



<h4>Method <code>clone()</code>
</h4>

<p>The objects of this class are cloneable with this method.
</p>


<h5>Usage</h5>

<div class="r"><pre>SimulationModel$clone(deep = FALSE)</pre></div>



<h5>Arguments</h5>

<div class="arguments">

<dl>
<dt><code>deep</code></dt>
<dd>
<p>Whether to make a deep clone.</p>
</dd>
</dl>
</div>




<h3>Examples</h3>

<pre><code class="language-R"># U Island example region
coordinates &lt;- data.frame(
  x = rep(seq(177.01, 177.05, 0.01), 5),
  y = rep(seq(-18.01, -18.05, -0.01), each = 5)
)
template_raster &lt;- Region$new(coordinates = coordinates)$region_raster # full extent
template_raster[][-c(7, 9, 12, 14, 17:19)] &lt;- NA # make U Island
region &lt;- Region$new(template_raster = template_raster)
# Model template
template_model &lt;- SimulationModel$new(
  simulation_function = "test_simulator",
  region = region, time_steps = 10
)
template_model$model_attributes &lt;- c(
  template_model$model_attributes,
  "a", "b", "c", "d"
)
template_model$model_attributes
template_model$required_attributes &lt;- c(
  template_model$required_attributes[1:2],
  "a", "b", "c", "d"
)
template_model$required_attributes
template_model$get_attributes(template_model$required_attributes)
template_model$simulation_function
# Nested model
nested_model &lt;- SimulationModel$new(template_model = template_model)
nested_model$region$region_cells
nested_model$set_sample_attributes(a = 1:7, b = 1:10, c = 1:15)
nested_model$sample_attributes
nested_model$get_attributes(c("a", "b", "c", "d"))
# Completeness and consistency
nested_model$is_complete()
nested_model$incomplete_attributes()
nested_model$is_consistent()
nested_model$inconsistent_attributes()
nested_model$set_attributes(c = array(1:70, c(7, 10)), d = 15)
nested_model$is_complete()
nested_model$is_consistent()
# Attached attributes
nested_model$attached
template_model$attached

</code></pre>


</div>