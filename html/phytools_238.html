<div class="container">

<table style="width: 100%;"><tr>
<td>densityMap</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>Plot posterior density of stochastic mapping on a tree</h2>

<h3>Description</h3>

<p>Visualize posterior probability density from stochastic mapping using a color gradient on the tree.
</p>


<h3>Usage</h3>

<pre><code class="language-R">densityMap(trees, res=100, fsize=NULL, ftype=NULL, lwd=3, check=FALSE,
   legend=NULL, outline=FALSE, type="phylogram", direction="rightwards",
   plot=TRUE, ...)
## S3 method for class 'densityMap'
plot(x, ...)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>trees</code></td>
<td>
<p>set of phylogenetic trees in a modified <code>"multiPhylo"</code> object. Values for a two-state discrete character are mapped on the tree. See <code>make.simmap</code> and <code>read.simmap</code> for details.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>res</code></td>
<td>
<p>resolution for gradient plotting. Larger numbers indicate a finer (smoother) gradient.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>fsize</code></td>
<td>
<p>relative font size - can be a vector with the second element giving the font size for the legend.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>ftype</code></td>
<td>
<p>font type - see options in <code>plotSimmap</code>. As with <code>fsize</code>, can be a vector with the second element giving font type for the legend.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>lwd</code></td>
<td>
<p>line width for branches. If a vector of two elements is supplied, the second element will be taken to be the desired width of the legend bar.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>check</code></td>
<td>
<p>check to make sure that the topology and branch lengths of all phylogenies in <code>trees</code> are equal.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>legend</code></td>
<td>
<p>if <code>FALSE</code> no legend is plotted; if a numeric value, it gives the length of the legend in units of branch length. Default is 0.5 times the total tree length.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>outline</code></td>
<td>
<p>logical value indicating whether or not to outline the branches of the tree in black.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>type</code></td>
<td>
<p>type of plot desired. Options are <code>"phylogram"</code> for a rightward square phylogram; and <code>"fan"</code> for a circular phylogram.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>plot</code></td>
<td>
<p>logical value indicating whether or not to plot the tree. If <code>plot=FALSE</code> then an object of class <code>"densityMap"</code> will be returned without plotting.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>direction</code></td>
<td>
<p>plotting direction for <code>type="phylogram"</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>x</code></td>
<td>
<p>for <code>plot.densityMap</code>, an object of class <code>"densityMap"</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>...</code></td>
<td>
<p>optional arguments for <code>plot.densityMap</code>. These include all the arguments of <code>densityMap</code> except <code>trees</code> and <code>res</code>. Additional optional arguments include <code>mar</code> (margins), <code>offset</code> (tip label offset: in units of the edge length or character widths, as in <code>plotSimmap</code>), and <code>hold</code> (whether or not to use <code>dev.hold</code> to hold output to graphical device before plotting; defaults to <code>hold=TRUE</code>). Also, the argument <code>states</code> can be used to 'order' the states on the probability axis (that is, which state should correspond to a posterior probability of 0 or 1). Some other plotting arguments, such as <code>xlim</code> and <code>ylim</code>, may also work.</p>
</td>
</tr>
</table>
<h3>Details</h3>

<p>Function plots a tree with the posterior density for a mapped character from stochastic character mapping on the tree. Since the mapped value is the probability of being in state "1", only binary [0,1] characters are allowed.
</p>


<h3>Value</h3>

<p>Plots a tree and returns an object of class <code>"densityMap"</code> invisibly.
</p>


<h3>Author(s)</h3>

<p>Liam Revell <a href="mailto:liam.revell@umb.edu">liam.revell@umb.edu</a></p>


<h3>References</h3>

<p>Bollback, J. P. (2006) Stochastic character mapping of discrete traits on phylogenies. <em>BMC Bioinformatics</em>, <b>7</b>, 88.
</p>
<p>Huelsenbeck, J. P., R. Neilsen, and J. P. Bollback (2003) Stochastic mapping of morphological characters. <em>Systematic Biology</em>, <b>52</b>, 131-138. 
</p>
<p>Revell, L. J. (2013) Two new graphical methods for mapping trait evolution on phylogenies. <em>Methods in Ecology and Evolution</em>, <b>4</b>, 754-759.
</p>
<p>Revell, L. J. (2024) phytools 2.0: an updated R ecosystem for phylogenetic comparative methods (and other things). <em>PeerJ</em>, <b>12</b>, e16505.
</p>


<h3>See Also</h3>

<p><code>make.simmap</code>, <code>plotSimmap</code>, <code>read.simmap</code>
</p>


<h3>Examples</h3>

<pre><code class="language-R">## Not run: 
## load tree and data from Revell &amp; Collar (2009)
data(sunfish.tree)
data(sunfish.data)
## extract discrete character (feeding mode)
fmode&lt;-setNames(sunfish.data$feeding.mode,
     rownames(sunfish.data))
## do stochastic mapping
smap.trees&lt;-make.simmap(sunfish.tree,fmode,model="ER",
     nsim=100)
## compute "densityMap" object
sunfish.dmap&lt;-densityMap(smap.trees,plot=FALSE,
	res=50) ## res should be higher
## plot density map
plot(sunfish.dmap,lwd=5,outline=TRUE)
par(mar=c(5.1,4.1,4.1,2.1)) ## reset margins to default
## End(Not run)
</code></pre>


</div>