<div class="container">

<table style="width: 100%;"><tr>
<td>powerLogisticBin</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>
Calculating power for simple logistic regression with binary predictor
</h2>

<h3>Description</h3>

<p>Calculating power for simple logistic regression with binary predictor.
</p>


<h3>Usage</h3>

<pre><code class="language-R">powerLogisticBin(n, 
                 p1, 
                 p2, 
                 B, 
                 alpha = 0.05)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>n</code></td>
<td>

<p>total number of sample size.
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>p1</code></td>
<td>

<p><code class="reqn">pr(diseased|X=0)</code>, i.e. the event rate at <code class="reqn">X=0</code> in logistic regression
<code class="reqn">logit(p) = a + b X</code>, where <code class="reqn">X</code> is the binary predictor.
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>p2</code></td>
<td>

<p><code class="reqn">pr(diseased|X=1)</code>, the event rate at <code class="reqn">X=1</code> in logistic regression
<code class="reqn">logit(p) = a + b X</code>, where <code class="reqn">X</code> is the binary predictor.
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>B</code></td>
<td>

<p><code class="reqn">pr(X=1)</code>, i.e. proportion of the sample with <code class="reqn">X=1</code>
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>alpha</code></td>
<td>

<p>Type I error rate.
</p>
</td>
</tr>
</table>
<h3>Details</h3>

<p>The logistic regression mode is
</p>
<p style="text-align: center;"><code class="reqn">
\log(p/(1-p)) = \beta_0 + \beta_1 X
</code>
</p>

<p>where <code class="reqn">p=prob(Y=1)</code>, <code class="reqn">X</code> is the binary predictor, <code class="reqn">p_1=pr(diseased | X=0)</code>,
<code class="reqn">p_2=pr(diseased| X = 1)</code>, <code class="reqn">B=pr(X=1)</code>, and <code class="reqn">p = (1 - B) p_1+B p_2</code>.
The sample size formula we used for testing if <code class="reqn">\beta_1=0</code>, is Formula (2) in Hsieh et al. (1998):
</p>
<p style="text-align: center;"><code class="reqn">
n=(Z_{1-\alpha/2}[p(1-p)/B]^{1/2} + Z_{power}[p_1(1-p_1)+p_2(1-p_2)(1-B)/B]^{1/2})^2/[ (p_1-p_2)^2 (1-B) ]
</code>
</p>

<p>where <code class="reqn">n</code> is the required total sample size and <code class="reqn">Z_u</code> is the <code class="reqn">u</code>-th
percentile of the standard normal distribution.
</p>


<h3>Value</h3>

<p>Estimated power.
</p>


<h3>Note</h3>

<p>The test is a two-sided test. For one-sided tests, please double the 
significance level. For example, you can set <code>alpha=0.10</code>
to obtain one-sided test at 5% significance level.
</p>


<h3>Author(s)</h3>

<p>Weiliang Qiu <a href="mailto:stwxq@channing.harvard.edu">stwxq@channing.harvard.edu</a>
</p>


<h3>References</h3>

<p>Hsieh, FY, Bloch, DA, and Larsen, MD.
A SIMPLE METHOD OF SAMPLE SIZE CALCULATION FOR LINEAR AND LOGISTIC REGRESSION.
<em>Statistics in Medicine</em>. 1998; 17:1623-1634.
</p>


<h3>See Also</h3>

<p><code>powerLogisticBin</code>
</p>


<h3>Examples</h3>

<pre><code class="language-R">    ## Example in Table I Design (Balanced design with high event rates) 
    ## of Hsieh et al. (1998 )
    ## the power = 0.95
    powerLogisticBin(n = 1281, p1 = 0.4, p2 = 0.5, B = 0.5, alpha = 0.05)
</code></pre>


</div>