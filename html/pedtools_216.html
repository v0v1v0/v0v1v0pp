<div class="container">

<table style="width: 100%;"><tr>
<td>setMutmod</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>Set a mutation model</h2>

<h3>Description</h3>

<p>This function offers a convenient way to set or modify mutation models to
markers attached to a pedigree. It wraps <code>pedmut::mutationModel()</code>, which
does the main work of creating the models, but relieves the user from having
to loop through the markers in order to supply the correct alleles and
frequencies for each marker.
</p>


<h3>Usage</h3>

<pre><code class="language-R">setMutmod(x, markers = NULL, ..., update = FALSE)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>x</code></td>
<td>
<p>A <code>ped</code> object or a list of such.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>markers</code></td>
<td>
<p>A vector of names or indices referring to markers attached to
<code>x</code>. (Default: All markers.)</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>...</code></td>
<td>
<p>Arguments forwarded to <code>pedmut::mutationModel()</code>, e.g., <code>model</code>,
<code>rate</code>, etc.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>update</code></td>
<td>
<p>A logical. If TRUE, existing mutation models (if present) are
updated with the parameters specified in <code>...</code>. If FALSE (default), any
previous models are ignored, and new mutation models are created from the
parameters in <code>...</code>.</p>
</td>
</tr>
</table>
<h3>Details</h3>

<p>Currently, the following models are supported:
</p>

<ul>
<li> <p><code>equal</code>:  All mutations equally likely; probability <code>1 - rate</code> of no
mutation
</p>
</li>
<li> <p><code>proportional</code>: Mutation probabilities are proportional to the target
allele frequencies
</p>
</li>
<li> <p><code>onestep</code>: A simple model for microsatellite markers, in which mutations
are only allowed to the nearest neighbours in the allelic ladder. For
example, '10' may mutate to either '9' or '11' (unless '10' is the lowest
allele, in which case '11' is the only option). Not applicable to loci with
non-integral microvariants.
</p>
</li>
<li> <p><code>stepwise</code>: A common model for microsatellite markers. Mutation rates
depend on the step size in the allelic ladder, and also the allelic classes:
integral repeats like '16', versus non-integer microvariants like '16.3'.
</p>
</li>
<li> <p><code>custom</code>: Allows any mutation matrix to be provided by the user, in the
<code>matrix</code> parameter
</p>
</li>
<li> <p><code>random</code>: This produces a matrix of random numbers, where each row is
normalised so that it sums to 1
</p>
</li>
<li> <p><code>trivial</code>: The identity matrix; no mutations are possible
</p>
</li>
</ul>
<h3>Value</h3>

<p>An object similar to <code>x</code>.
</p>


<h3>Examples</h3>

<pre><code class="language-R">
### Example requires the pedmut package ###

if (requireNamespace("pedmut", quietly = TRUE)){

# A pedigree with 1 empty marker; attach 'equal' mutation model
x = nuclearPed(1) |&gt;
  addMarker() |&gt;
  setMutmod(model = "equal", rate = 0.01)

mutmod(x, 1)

# Update rate (but still "equal" model)
y = setMutmod(x, rate = 0.05, update = TRUE)
mutmod(y, 1)

# Change to stepwise model
z = setMutmod(x, model = "stepwise",
              rate = list(female = 0.01, male = 0.02),
              range = 0.1, rate2 = 1e-6)
mutmod(z, 1)

# Remove mutation model
w = setMutmod(x, model = NULL)
mutmod(w, 1)

}

</code></pre>


</div>