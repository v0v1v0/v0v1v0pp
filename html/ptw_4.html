<div class="container">

<table style="width: 100%;"><tr>
<td>bestref</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>Identification of optimal reference</h2>

<h3>Description</h3>

<p>This function calculates a similarity matrix and returns
the sample number that is most similar to all other samples. This is
possibly preferable as a reference sample since warping then may be
kept to a minimum. Either RMS or WCC may be used as similarity
functions.</p>


<h3>Usage</h3>

<pre><code class="language-R">bestref(x, optim.crit = c("WCC", "RMS"),
               trwdth=20, wghts = NULL, smooth.param = 0)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>x</code></td>
<td>
<p>data matrix or array of signals, specified row-wise. In case of an array, the third dimension should differentiate between the different samples</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>optim.crit</code></td>
<td>
<p>either <code>"WCC"</code> or <code>"RMS"</code></p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>trwdth</code></td>
<td>
<p>the width of the triangle in the WCC criterion, given as
a number of data points. Default: 20</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>wghts</code></td>
<td>
<p>Optional weights vector in the WCC criterion; will be
calculated from the triangle width if necessary. Sometimes it is
more efficient to pre-calculate it and give it as an argument</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>smooth.param</code></td>
<td>
<p>smoothing parameter for smoothing the signal when
<code>optim.crit</code> equals <code>"RMS"</code>. If no smoothing is required,
set this to 0</p>
</td>
</tr>
</table>
<h3>Value</h3>

<p>A list containing two elements:
</p>
<table>
<tr style="vertical-align: top;">
<td><code>best.ref</code></td>
<td>
<p>the index of the best reference(s)</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>crit.values</code></td>
<td>
<p>the qualities as measured by either RMS or WCC</p>
</td>
</tr>
</table>
<h3>Author(s)</h3>

<p>Jan Gerretzen, Ron Wehrens</p>


<h3>Examples</h3>

<pre><code class="language-R">data(gaschrom)
bestref(gaschrom)
bestref(gaschrom, optim.crit = "WCC", trwdth = 50)
bestref(gaschrom, optim.crit = "RMS")
bestref(gaschrom, optim.crit = "RMS", smooth.param = 1e5)
</code></pre>


</div>