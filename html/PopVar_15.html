<div class="container">

<table style="width: 100%;"><tr>
<td>pop.predict2</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>Predict genetic variance and genetic correlations in bi-parental populations using a deterministic model</h2>

<h3>Description</h3>

<p>Generates predictions of the genetic variance and genetic correlation in bi-parental populations using a set of deterministic equations instead of simulations.
</p>


<h3>Usage</h3>

<pre><code class="language-R">pop.predict2(
  G.in,
  y.in,
  map.in,
  crossing.table,
  parents,
  tail.p = 0.1,
  self.gen = Inf,
  DH = FALSE,
  models = c("rrBLUP", "BayesA", "BayesB", "BayesC", "BL", "BRR"),
  ...
)

pop_predict2(
  M,
  y.in,
  marker.effects,
  map.in,
  crossing.table,
  parents,
  tail.p = 0.1,
  self.gen = Inf,
  DH = FALSE,
  models = c("rrBLUP", "BayesA", "BayesB", "BayesC", "BL", "BRR"),
  ...
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>G.in</code></td>
<td>
<p>See <code>G.in</code> in <code>pop.predict</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>y.in</code></td>
<td>
<p>See <code>y.in</code> in <code>pop.predict</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>map.in</code></td>
<td>
<p>See <code>map.in</code> in <code>pop.predict</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>crossing.table</code></td>
<td>
<p>See <code>crossing.table</code> in <code>pop.predict</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>parents</code></td>
<td>
<p>See <code>parents</code> in <code>pop.predict</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>tail.p</code></td>
<td>
<p>See <code>tail.p</code> in <code>pop.predict</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>self.gen</code></td>
<td>
<p>The number of selfing generations in the potential cross. Can be an integer or <code>Inf</code> for
recombinant inbreds. Note: <code>self.gen = 1</code> corresponds to an F2 population.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>DH</code></td>
<td>
<p>Indicator if doubled-haploids are to be induced after the number of selfing generations indicated by
<code>self.gen</code>. For example, if <code>self.gen = 0</code> and <code>DH = TRUE</code>, then doubled-haploids are assumed
to be induced using gametes from F1 plants.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>models</code></td>
<td>
<p>See <code>models</code> in <code>pop.predict</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>...</code></td>
<td>
<p>Additional arguments to pass depending on the choice of <code>model</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>M</code></td>
<td>
<p>A Matrix of marker genotypes of dimensions <code>nLine</code> x <code>nMarker</code>, coded as
-1, 0, and 1.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>marker.effects</code></td>
<td>
<p>A data frame of marker effects. The first column should include the marker name and
subsequent columns should include the marker effects. Supercedes <code>y.in</code> if passed.</p>
</td>
</tr>
</table>
<h3>Details</h3>

<p>Predictions are based on the deterministic equations specified by Zhong and Jannink (2007), Allier et al. (2019),
and Neyhart et al. (2019).
</p>
<p>If you select a <code>model</code> other than "rrBLUP", you must specify the following additional arguments:
</p>

<ul>
<li>
<p><code>nIter</code>: See <code>pop.predict</code>.
</p>
</li>
<li>
<p><code>burnIn</code>: See <code>pop.predict</code>.
</p>
</li>
</ul>
<h3>Value</h3>

<p>A <code>data.frame</code> containing predictions of <code class="reqn">\mu</code>, <code class="reqn">V_G</code>, and <code class="reqn">\mu_{sp}</code> for
each trait for each potential bi-parental cross. When multiple traits are provided, the correlated
responses and correlation between all pairs of traits is also returned.
</p>


<h3>Functions</h3>


<ul><li> <p><code>pop_predict2()</code>: 
</p>
</li></ul>
<h3>References</h3>

<p>Zhong, S., and J.-L. Jannink, 2007 Using quantitative trait loci results to discriminate among crosses on the basis of their
progeny mean and variance. Genetics 177: 567–576. https://doi.org/10.1534/ genetics.107.075358
</p>
<p>Allier, A., L. Moreau, A. Charcosset, S. Teyssèdre, and C. Lehermeier, 2019 Usefulness Criterion and Post-selection Parental
Contributions in Multi-parental Crosses: Application to Polygenic Trait Introgression. G3 9: 1469–1479.
doi: 10.1534/g3.119.400129
</p>
<p>Neyhart, J.L., A.J. Lorenz, and K.P. Smith, 2019 Multi-trait Improvement by Predicting Genetic Correlations in Breeding
Crosses. G3 9: 3153-3165. doi: 10.1534/g3.119.400406
</p>


<h3>Examples</h3>

<pre><code class="language-R">


# Load data
data("think_barley")

# Use example data to make predictions
out &lt;- pop.predict2(G.in = G.in_ex_imputed, y.in = y.in_ex, map.in = map.in_ex, 
                    crossing.table = cross.tab_ex)
                    
# Provide a vector of parents to predict all possible crosses (some parents
# have missing phenotypic data)
out &lt;- pop.predict2(G.in = G.in_ex_imputed, y.in = y.in_ex, map.in = map.in_ex, 
                    parents = y.in_ex$Entry[1:5])
                    
# Make predictions for 5 crosses with various levels of inbreeding
out_list &lt;- lapply(X = 1:10, FUN = function(self.gen) {
  out &lt;- pop.predict2(G.in = G.in_ex_imputed, y.in = y.in_ex, map.in = map.in_ex, 
                      crossing.table = cross.tab_ex[1:5,], self.gen = self.gen)
  out$self.gen &lt;- self.gen
  out })
               
# Plot predictions of grain yield genetic variance over levels of inbreeding
dat &lt;- do.call("rbind", lapply(out_list, subset, trait == "Yield"))
plot(pred_varG ~ self.gen, data = dat, type = "b", 
     subset = parent1 == parent1[1] &amp; parent2 == parent2[1])






# Load data
data("think_barley")

# Use example data to make predictions
out &lt;- pop_predict2(M = G.in_ex_mat, y.in = y.in_ex, map.in = map.in_ex, 
                    crossing.table = cross.tab_ex)
                    
# Provide a vector of parents to predict all possible crosses (some parents
# have missing phenotypic data)
out &lt;- pop_predict2(M = G.in_ex_mat, y.in = y.in_ex, map.in = map.in_ex, 
                    parents = y.in_ex$Entry[1:10])
                    

                    

</code></pre>


</div>