<div class="container">

<table style="width: 100%;"><tr>
<td>score_test_stnarpq_DV</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>
Bound p-value for testing for smooth transition effects on PNAR(p) model
</h2>

<h3>Description</h3>

<p>Computation of Davies bound p-value for the sup-type test for testing linearity
of Poisson Network Autoregressive model of order <code class="reqn">p</code> (PNAR(<code class="reqn">p</code>)) versus
the non-linear Smooth Transition alternative (ST-PNAR(<code class="reqn">p</code>)).
</p>


<h3>Usage</h3>

<pre><code class="language-R">score_test_stnarpq_DV(b, y, W, p, d, Z = NULL, gama_L = NULL,
gama_U = NULL, len = 100)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>b</code></td>
<td>

<p>The estimated parameters from the linear model, in the following order:
(intercept, network parameters, autoregressive parameters, covariates).
The dimension of the vector should be <code class="reqn">2p + 1 + q</code>, where <code class="reqn">q</code> denotes the number of covariates.
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>y</code></td>
<td>

<p>A <code class="reqn">TT \times N</code> time series object or a <code class="reqn">TT \times N</code> numerical matrix with the <code class="reqn">N</code> multivariate count time series over <code class="reqn">TT</code> time periods.
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>W</code></td>
<td>

<p>The <code class="reqn">N \times N</code> row-normalized non-negative adjacency matrix describing
the network. The main diagonal entries of the matrix should be zeros, all the
other entries should be non-negative and the maximum sum of elements over the
rows should equal one. The function row-normalizes the matrix if a non-normalized
adjacency matrix is provided.
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>p</code></td>
<td>

<p>The number of lags in the model.
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>d</code></td>
<td>

<p>The lag parameter of non-linear variable (should be between 1 and <code class="reqn">p</code>).
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>Z</code></td>
<td>

<p>An <code class="reqn">N \times q</code> matrix of covariates (one for each column),
where <code class="reqn">q</code> is the number of covariates in the model.
Note that they must be non-negative.
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>gama_L</code></td>
<td>

<p>The lower value of the nuisance parameter <code class="reqn">\gamma</code> to consider.
Use NULL if there is not information about its value.
See the details for default computation.
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>gama_U</code></td>
<td>

<p>The upper value of the nuisance parameter <code class="reqn">\gamma</code> to consider.
Use NULL if there is not information about its value.
See the details for default computation.
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>len</code></td>
<td>

<p>The length of the grid of values of <code class="reqn">\gamma</code> values to consider.
</p>
</td>
</tr>
</table>
<h3>Details</h3>

<p>The function computes an upper-bound for the p-value of the sup-type test for testing linearity of Poisson Network
Autoregressive model of order <code class="reqn">p</code> (PNAR(<code class="reqn">p</code>)) versus the following Smooth Transition alternative (ST-PNAR(<code class="reqn">p</code>)).
For each node of the network <code class="reqn">i=1,...,N</code> over the time sample <code class="reqn">t=1,...,TT</code>
</p>
<p style="text-align: center;"><code class="reqn">
\lambda_{i,t}=\beta_{0}+\sum_{h=1}^{p}(\beta_{1h}X_{i,t-h}+\beta_{2h}Y_{i,t-h}+\alpha_{h}e^{-\gamma X_{i,t-d}^{2}}X_{i,t-h})+\sum_{l=1}^{q}\delta_{l}Z_{i,l}
</code>
</p>

<p>where <code class="reqn">X_{i,t}=\sum_{j=1}^{N}W_{ij}Y_{j,t}</code> is the network effect, i.e. the weighted average impact of node <code class="reqn">i</code> connections, with the weights of the mean being <code class="reqn">W_{ij}</code>, the single element of the network matrix <code class="reqn">W</code>. The sequence <code class="reqn">\lambda_{i,t}</code> is the expectation of <code class="reqn">Y_{i,t}</code>, conditional to its past values.
</p>
<p>The null hypothesis of the test is defined as <code class="reqn">H_{0}: \alpha_{1}=...=\alpha_{p}=0</code>, versus the alternative that at least one among <code class="reqn">\alpha_{h}</code> is not 0. The test statistic has the form
</p>
<p style="text-align: center;"><code class="reqn">
LM(\gamma)=S^{'}(\hat{\theta},\gamma)\Sigma^{-1}(\hat{\theta},\gamma)S(\hat{\theta},\gamma),
</code>
</p>

<p>where
</p>
<p style="text-align: center;"><code class="reqn">
S(\hat{\theta},\gamma)=\sum_{t=1}^{TT}\sum_{i=1}^{N}\left(\frac{Y_{i,t}}{\lambda_{i,t}(\hat{\theta},\gamma)}-1\right)\frac{\partial\lambda_{i,t}(\hat{\theta},\gamma)}{\partial\alpha}
</code>
</p>

<p>is the partition of the quasi score related to the vector of non-linear parameters <code class="reqn">\alpha=(\alpha_{1},...,\alpha_{p})</code>, evaluated at the estimated parameters <code class="reqn">\hat{\theta}</code> under the null assumption <code class="reqn">H_{0}</code> (linear model), and <code class="reqn">\Sigma(\hat{\theta},\gamma)</code> is the variance of <code class="reqn">S(\hat{\theta},\gamma)</code>. Since the test statistic depends on an unknown nuisance parameter (<code class="reqn">\gamma</code>), the supremum of the statistic is considered in the test, <code class="reqn">\sup_{\gamma}LM(\gamma)</code>. The function computes the bound of the p-value, suggested by Davies (1987), for the test statistic <code class="reqn">\sup_{\gamma}LM(\gamma)</code>, with scalar nuisance parameter <code class="reqn">\gamma</code>, as follows.
</p>
<p style="text-align: center;"><code class="reqn">
P(\chi^{2}_{k} \geq M)+V M^{1/2(k-1)}\frac{e^{-M/2}2^{-k/2}}{\Gamma(k/2)}
</code>
</p>

<p>where <code class="reqn">M</code> is the maximum of the test statistic <code class="reqn">LM(\gamma)</code>, computed by the available sample, over a grid of values for the nuisance parameter <code class="reqn">\gamma_{F}=(\gamma_{L},\gamma_{1},...,\gamma_{l},\gamma_{U})</code>; <code class="reqn">k</code> is the number of non-linear parameters tested. So the first summand of the bound is just the p-value of a chi-square test with <code class="reqn">k</code> degrees of freedom. The second summand is a correction term depending on <code class="reqn">V</code>, which is the approximated total variation computed as
</p>
<p style="text-align: center;"><code class="reqn">
V=|LM^{1/2}(\gamma_{1})-LM^{1/2}(\gamma_{L})|+|LM^{1/2}(\gamma_{2})-LM^{1/2}(\gamma_{1})|+...+|LM^{1/2}(\gamma_{U})-LM^{1/2}(\gamma_{l})|.
</code>
</p>

<p>The feasible bound allows to approximate the p-values of the sup-type test in a straightforward way, by adding to the tail probability of a chi-square distribution a correction term which depends on the total variation of the process. For details see Armillotta and Fokianos (2023, Sec. 5).
</p>
<p>The values of <code>gama_L</code> and <code>gama_U</code> are computed internally as <code>gama_L</code> <code class="reqn">=-\log(0.9)/X^{2}</code> and <code>gama_U</code> <code class="reqn">=-\log(0.1)/X^{2}</code>, where <code class="reqn">X</code> is the overall mean of <code class="reqn">X_{i,t}</code> over the nodes <code class="reqn">i=1,...,N</code> and times <code class="reqn">t=1,...,TT</code>. Since the non-linear function <code class="reqn">e^{-\gamma X_{i,t-d}^{2}}</code> ranges between 0 and 1, by considering <code class="reqn">X</code> to be a representative value for the network mean, <code>gama_U</code> and <code>gama_L</code> would be the values of <code class="reqn">\gamma</code> leading the non-linear switching function to be 0.1 and 0.9, respectively, so that in the optimization procedure the extremes of the function domain are excluded. Alternatively, their values can be supplied by the user.
</p>


<h3>Value</h3>

<p>A list including:
</p>
<table>
<tr style="vertical-align: top;">
<td><code>DV</code></td>
<td>

<p>The Davies bound of p-values for sup test.
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>supLM</code></td>
<td>

<p>The value of the sup test statistic in the sample <code class="reqn">y</code>.
</p>
</td>
</tr>
</table>
<h3>Author(s)</h3>

<p>Mirko Armillotta, Michail Tsagris and Konstantinos Fokianos.
</p>


<h3>References</h3>

<p>Armillotta, M. and K. Fokianos (2023). Nonlinear network autoregression. <em>Annals of Statistics</em>, 51(6): 2526–2552.
</p>
<p>Armillotta, M. and K. Fokianos (2024). Count network autoregression. <em>Journal of Time Series Analysis</em>, 45(4): 584–612.
</p>
<p>Armillotta, M., Tsagris, M. and Fokianos, K. (2024). Inference for Network Count Time Series with the R Package PNAR. <em>The R Journal</em>, 15/4: 255–269.
</p>
<p>Davies, R. B. (1987). Hypothesis testing when a nuisance parameter is
present only under the alternative. <em>Biometrika</em> 74, 33–43.
</p>


<h3>See Also</h3>

<p><code>score_test_stnarpq_j, global_optimise_LM_stnarpq
</code>
</p>


<h3>Examples</h3>

<pre><code class="language-R">data(crime)
data(crime_W)
mod1 &lt;- lin_estimnarpq(crime, crime_W, p = 1)
ca &lt;- mod1$coefs[, 1]
score_test_stnarpq_DV(ca, crime, crime_W, p = 1, d = 1)
</code></pre>


</div>