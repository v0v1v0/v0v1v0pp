<div class="container">

<table style="width: 100%;"><tr>
<td>haplotype</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>Haplotype Extraction and Frequencies</h2>

<h3>Description</h3>

<p><code>haplotype</code> extracts the haplotypes from a set of DNA
sequences. The result can be plotted with the appropriate function.
</p>


<h3>Usage</h3>

<pre><code class="language-R">haplotype(x, ...)
## S3 method for class 'DNAbin'
haplotype(x, labels = NULL, strict = FALSE,
                  trailingGapsAsN = TRUE, ...)
## S3 method for class 'character'
haplotype(x, labels = NULL, ...)
## S3 method for class 'numeric'
haplotype(x, labels = NULL, ...)
## S3 method for class 'haplotype'
plot(x, xlab = "Haplotype", ylab = "Number", ...)
## S3 method for class 'haplotype'
print(x, ...)
## S3 method for class 'haplotype'
summary(object, ...)
## S3 method for class 'haplotype'
sort(x,
     decreasing = ifelse(what == "frequencies", TRUE, FALSE),
     what = "frequencies", ...)
## S3 method for class 'haplotype'
x[...]
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>x</code></td>
<td>
<p>a set of DNA sequences (as an object of class
<code>"DNAbin"</code>), or an object of class <code>"haplotype"</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>object</code></td>
<td>
<p>an object of class <code>"haplotype"</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>labels</code></td>
<td>
<p>a vector of character strings used as names for the rows
of the returned object. By default, Roman numerals are given.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>strict</code></td>
<td>
<p>a logical value; if <code>TRUE</code>, ambiguities and gaps in
the sequences are ignored and treated as separate characters.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>trailingGapsAsN</code></td>
<td>
<p>a logical value; if <code>TRUE</code> (the default),
the leading and trailing alignment gaps are considered as unknown
bases (i.e., N). This option has no effect if <code>strict = TRUE</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>xlab, ylab</code></td>
<td>
<p>labels for the x- and x-axes.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>...</code></td>
<td>
<p>further arguments passed to
<code>barplot</code> (unused in <code>print</code> and
<code>sort</code>).</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>decreasing</code></td>
<td>
<p>a logical value specifying in which order to sort
the haplotypes; by default this depends on the value of
<code>what</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>what</code></td>
<td>
<p>a character specifying on what feature the haplotypes
should be sorted: this must be <code>"frequencies"</code> or
<code>"labels"</code>, or an unambiguous abbreviation of these.</p>
</td>
</tr>
</table>
<h3>Details</h3>

<p>The way ambiguities in the sequences are taken into account is explained
in a post to r-sig-phylo (see the examples below):
</p>
<p><a href="https://www.mail-archive.com/r-sig-phylo@r-project.org/msg05541.html">https://www.mail-archive.com/r-sig-phylo@r-project.org/msg05541.html</a>
</p>
<p>The <code>sort</code> method sorts the haplotypes in decreasing frequencies
(the default) or in alphabetical order of their labels (if <code>what =
"labels"</code>). Note that if these labels are Roman numerals (as assigned by
<code>haplotype</code>), their alphabetical order may not be their numerical
one (e.g., IX is alphabetically before VIII).
</p>
<p>From <span class="pkg">pegas</span> 0.7, <code>haplotype</code> extracts haplotypes taking into
account base ambiguities (see Note below).
</p>


<h3>Value</h3>

<p><code>haplotype</code> returns an object of class <code>c("haplotype",
    "DNAbin")</code> which is an object of class <code>"DNAbin"</code> with two
additional attributes: <code>"index"</code> identifying the index of each
observation that share the same haplotype, and <code>"from"</code> giving
the name of the original data.
</p>
<p><code>sort</code> returns an object of the same class respecting its
attributes.
</p>


<h3>Note</h3>

<p>The presence of ambiguous bases and/or alignment gaps in DNA sequences
can make the interpretation of haplotypes difficult. It is recommended
to check their distributions with <code>image.DNAbin</code> and
<code>base.freq</code> (using the options in both functions).
</p>
<p>Comparing the results obtained playing with the options <code>strict</code>
and <code>trailingGapsAsN</code> of <code>haplotype.DNAbin</code> may be useful.
Note that the <span class="pkg">ape</span> function <code>seg.sites</code> has the
same two options (as from <span class="pkg">ape</span> 5.4) which may be useful to find the
relevant sites in the sequence alignment.
</p>


<h3>Note</h3>

<p>There are cases where the algorithm that pools the different sequences
into haplotypes has difficulties, although it seems to require a
specific configuration of missing/ambiguous data. The last example
below is one of them.
</p>


<h3>Author(s)</h3>

<p>Emmanuel Paradis</p>


<h3>See Also</h3>

<p><code>haploNet</code>,  <code>haploFreq</code>,
<code>subset.haplotype</code>,
<code>DNAbin</code> for manipulation of DNA sequences in R.
</p>
<p>The <code>haplotype</code> method for objects of class <code>"loci"</code> is
documented separately: <code>haplotype.loci</code>.
</p>


<h3>Examples</h3>

<pre><code class="language-R">## generate some artificial data from 'woodmouse':
data(woodmouse)
x &lt;- woodmouse[sample(15, size = 110, replace = TRUE), ]
(h &lt;- haplotype(x))
## the indices of the individuals belonging to the 1st haplotype:
attr(h, "index")[[1]]
plot(sort(h))
## get the frequencies in a named vector:
setNames(lengths(attr(h, "index")), labels(h))

## data posted by Hirra Farooq on r-sig-phylo (see link above):
cat("&gt;[A]\nCCCGATTTTATATCAACATTTATTT------",
    "&gt;[D]\nCCCGATTTT----------------------",
    "&gt;[B]\nCCCGATTTTATATCAACATTTATTT------",
    "&gt;[C]\nCCCGATTTTATATCACCATTTATTTTGATTT",
    file = "x.fas", sep = "\n")
x &lt;- read.dna("x.fas", "f")
unlink("x.fas")

## show the sequences and the distances:
alview(x)
dist.dna(x, "N", p = TRUE)

## by default there are 3 haplotypes with a warning about ambiguity:
haplotype(x)

## the same 3 haplotypes without warning:
haplotype(x, strict = TRUE)

## if we remove the last sequence there is, by default, a single haplotype:
haplotype(x[-4, ])

## to get two haplotypes separately as with the complete data:
haplotype(x[-4, ], strict = TRUE)

## a simpler example:
y &lt;- as.DNAbin(matrix(c("A", "A", "A", "A", "R", "-"), 3))
haplotype(y) # 1 haplotype
haplotype(y, strict = TRUE) # 3 haplotypes
haplotype(y, trailingGapsAsN = FALSE) # 2 haplotypes

## a tricky example with 4 sequences and 1 site:
z &lt;- as.DNAbin(matrix(c("Y", "A", "R", "N"), 4))
alview(z, showpos = FALSE)

## a single haplotype is identified:
haplotype(z)
## 'Y' has zero-distance with (and only with) 'N', so they are pooled
## together; at a later iteration of this pooling step, 'N' has
## zero-distance with 'R' (and ultimately with 'A') so they are pooled

## if the sequences are ordered differently, 'Y' and 'A' are separated:
haplotype(z[c(4, 1:3), ])
</code></pre>


</div>