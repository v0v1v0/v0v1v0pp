<div class="container">

<table style="width: 100%;"><tr>
<td>PivotCalculationGroup</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>R6 class that defines a group of calculations.</h2>

<h3>Description</h3>

<p>The 'PivotCalculationGroup' class is a container for multiple
'PivotCalculation' objects.  Every pivot table has at least
one pivot calculation group and this is sufficient for all
regular pivot tables.  Additional calculation groups are
typically only created for irregular/custom pivot tables.
See the "Irregular Layout" vignette for an example.
</p>


<h3>Format</h3>

<p><code>R6Class</code> object.
</p>


<h3>Active bindings</h3>

<div class="r6-active-bindings">

<dl>
<dt><code>calculationGroupName</code></dt>
<dd>
<p>The name of the calculation group.</p>
</dd>
<dt><code>defaultCalculationName</code></dt>
<dd>
<p>The name of the default calculation in this
calculation group.</p>
</dd>
<dt><code>count</code></dt>
<dd>
<p>The number of calculations in this calculation group.</p>
</dd>
<dt><code>calculations</code></dt>
<dd>
<p>A list containing the calculations in this group.</p>
</dd>
<dt><code>visibleCount</code></dt>
<dd>
<p>The number of visible calculations in this calculation
group.</p>
</dd>
<dt><code>visibleCalculations</code></dt>
<dd>
<p>A list containing the visible calculations in
this group.</p>
</dd>
</dl>
</div>


<h3>Methods</h3>



<h4>Public methods</h4>


<ul>
<li> <p><a href="#method-PivotCalculationGroup-new"><code>PivotCalculationGroup$new()</code></a>
</p>
</li>
<li> <p><a href="#method-PivotCalculationGroup-isExistingCalculation"><code>PivotCalculationGroup$isExistingCalculation()</code></a>
</p>
</li>
<li> <p><a href="#method-PivotCalculationGroup-item"><code>PivotCalculationGroup$item()</code></a>
</p>
</li>
<li> <p><a href="#method-PivotCalculationGroup-getCalculation"><code>PivotCalculationGroup$getCalculation()</code></a>
</p>
</li>
<li> <p><a href="#method-PivotCalculationGroup-defineCalculation"><code>PivotCalculationGroup$defineCalculation()</code></a>
</p>
</li>
<li> <p><a href="#method-PivotCalculationGroup-asList"><code>PivotCalculationGroup$asList()</code></a>
</p>
</li>
<li> <p><a href="#method-PivotCalculationGroup-asJSON"><code>PivotCalculationGroup$asJSON()</code></a>
</p>
</li>
<li> <p><a href="#method-PivotCalculationGroup-asString"><code>PivotCalculationGroup$asString()</code></a>
</p>
</li>
<li> <p><a href="#method-PivotCalculationGroup-clone"><code>PivotCalculationGroup$clone()</code></a>
</p>
</li>
</ul>
<hr>
<a id="method-PivotCalculationGroup-new"></a>



<h4>Method <code>new()</code>
</h4>

<p>Create a new 'PivotCalculationGroup' object.
</p>


<h5>Usage</h5>

<div class="r"><pre>PivotCalculationGroup$new(parentPivot, calculationGroupName = NULL)</pre></div>



<h5>Arguments</h5>

<div class="arguments">

<dl>
<dt><code>parentPivot</code></dt>
<dd>
<p>The pivot table that this 'PivotCalculationGroup'
instance belongs to.</p>
</dd>
<dt><code>calculationGroupName</code></dt>
<dd>
<p>Calculation group unique name.
Recommendation: Do not have spaces in this name.</p>
</dd>
</dl>
</div>



<h5>Returns</h5>

<p>A new 'PivotCalculationGroup' object.
</p>


<hr>
<a id="method-PivotCalculationGroup-isExistingCalculation"></a>



<h4>Method <code>isExistingCalculation()</code>
</h4>

<p>Check whether a calculation already exists in this calculation group.
</p>


<h5>Usage</h5>

<div class="r"><pre>PivotCalculationGroup$isExistingCalculation(calculationName = NULL)</pre></div>



<h5>Arguments</h5>

<div class="arguments">

<dl>
<dt><code>calculationName</code></dt>
<dd>
<p>group unique name.</p>
</dd>
</dl>
</div>



<h5>Returns</h5>

<p>'TRUE' if a calculation with the specified name exists in
this calculation group object, 'FALSE' otherwise.
</p>


<hr>
<a id="method-PivotCalculationGroup-item"></a>



<h4>Method <code>item()</code>
</h4>

<p>Retrieve a calculation by index.
</p>


<h5>Usage</h5>

<div class="r"><pre>PivotCalculationGroup$item(index)</pre></div>



<h5>Arguments</h5>

<div class="arguments">

<dl>
<dt><code>index</code></dt>
<dd>
<p>An integer specifying the calculation to retrieve.</p>
</dd>
</dl>
</div>



<h5>Returns</h5>

<p>The calculation that exists at the specified index.
</p>


<hr>
<a id="method-PivotCalculationGroup-getCalculation"></a>



<h4>Method <code>getCalculation()</code>
</h4>

<p>Retrieve a calculation by name.
</p>


<h5>Usage</h5>

<div class="r"><pre>PivotCalculationGroup$getCalculation(calculationName = NULL)</pre></div>



<h5>Arguments</h5>

<div class="arguments">

<dl>
<dt><code>calculationName</code></dt>
<dd>
<p>The name of the calculation to retrieve.</p>
</dd>
</dl>
</div>



<h5>Returns</h5>

<p>The calculation with the specified name.
</p>


<hr>
<a id="method-PivotCalculationGroup-defineCalculation"></a>



<h4>Method <code>defineCalculation()</code>
</h4>

<p>Create a new 'PivotCalculation' object.
</p>


<h5>Usage</h5>

<div class="r"><pre>PivotCalculationGroup$defineCalculation(
  calculationName = NULL,
  caption = NULL,
  visible = TRUE,
  displayOrder = NULL,
  filters = NULL,
  format = NULL,
  fmtFuncArgs = NULL,
  dataName = NULL,
  type = "summary",
  valueName = NULL,
  summariseExpression = NULL,
  calculationExpression = NULL,
  calculationFunction = NULL,
  calcFuncArgs = NULL,
  basedOn = NULL,
  noDataValue = NULL,
  noDataCaption = NULL,
  headingBaseStyleName = NULL,
  headingStyleDeclarations = NULL,
  cellBaseStyleName = NULL,
  cellStyleDeclarations = NULL
)</pre></div>



<h5>Arguments</h5>

<div class="arguments">

<dl>
<dt><code>calculationName</code></dt>
<dd>
<p>Calculation unique name.</p>
</dd>
<dt><code>caption</code></dt>
<dd>
<p>Calculation display name</p>
</dd>
<dt><code>visible</code></dt>
<dd>
<p>'TRUE' to show the calculation in the pivot table or 'FALSE'
to hide it.  Hidden calculations are typically used as base values for
other calculations.</p>
</dd>
<dt><code>displayOrder</code></dt>
<dd>
<p>The order the calculations are displayed in the
pivot table.</p>
</dd>
<dt><code>filters</code></dt>
<dd>
<p>Any additional data filters specific to this calculation.
This can be a 'PivotFilters' object that further restricts the data for the
calculation or a list of individual 'PivotFilter' objects that provide more
flexibility (and/or/replace).  See the Calculations vignette for details.</p>
</dd>
<dt><code>format</code></dt>
<dd>
<p>A character, list or custom function to format the calculation
result.</p>
</dd>
<dt><code>fmtFuncArgs</code></dt>
<dd>
<p>A list that specifies any additional arguments to pass to
a custom format function.</p>
</dd>
<dt><code>dataName</code></dt>
<dd>
<p>Specifies which data frame in the pivot table is used for
this calculation (as specified in 'pt$addData()').</p>
</dd>
<dt><code>type</code></dt>
<dd>
<p>The calculation type:  "summary", "calculation", "function" or
"value".</p>
</dd>
<dt><code>valueName</code></dt>
<dd>
<p>For type="value", the name of the column containing the
value to display in the pivot table.</p>
</dd>
<dt><code>summariseExpression</code></dt>
<dd>
<p>For type="summary", either the dplyr expression to
use with dplyr::summarise() or a data.table calculation expression.</p>
</dd>
<dt><code>calculationExpression</code></dt>
<dd>
<p>For type="calculation", an expression to combine
aggregate values.</p>
</dd>
<dt><code>calculationFunction</code></dt>
<dd>
<p>For type="function", a reference to a custom R
function that will carry out the calculation.</p>
</dd>
<dt><code>calcFuncArgs</code></dt>
<dd>
<p>For type="function", a list that specifies additional
arguments to pass to calculationFunction.</p>
</dd>
<dt><code>basedOn</code></dt>
<dd>
<p>A character vector specifying the names of one or more
calculations that this calculation depends on.</p>
</dd>
<dt><code>noDataValue</code></dt>
<dd>
<p>An integer or numeric value specifying the value to use if
no data exists for a particular cell.</p>
</dd>
<dt><code>noDataCaption</code></dt>
<dd>
<p>A character value that will be displayed by the pivot
table if no  data exists for a particular cell.</p>
</dd>
<dt><code>headingBaseStyleName</code></dt>
<dd>
<p>The name of a style defined in the pivot table
to use as the base styling for the data group heading.</p>
</dd>
<dt><code>headingStyleDeclarations</code></dt>
<dd>
<p>A list of CSS style declarations (e.g.
'list("font-weight"="bold")') to override the base style.</p>
</dd>
<dt><code>cellBaseStyleName</code></dt>
<dd>
<p>The name of a style defined in the pivot table to
use as the base styling for the cells related to this calculation.</p>
</dd>
<dt><code>cellStyleDeclarations</code></dt>
<dd>
<p>A list of CSS style declarations (e.g.
'list("font-weight"="bold")') to override the base style.</p>
</dd>
</dl>
</div>



<h5>Returns</h5>

<p>A new 'PivotCalculation' object.
</p>


<hr>
<a id="method-PivotCalculationGroup-asList"></a>



<h4>Method <code>asList()</code>
</h4>

<p>Return the contents of this object as a list for debugging.
</p>


<h5>Usage</h5>

<div class="r"><pre>PivotCalculationGroup$asList()</pre></div>



<h5>Returns</h5>

<p>A list of various object properties.
</p>


<hr>
<a id="method-PivotCalculationGroup-asJSON"></a>



<h4>Method <code>asJSON()</code>
</h4>

<p>Return the contents of this object as JSON for debugging.
</p>


<h5>Usage</h5>

<div class="r"><pre>PivotCalculationGroup$asJSON()</pre></div>



<h5>Returns</h5>

<p>A JSON representation of various object properties.
</p>


<hr>
<a id="method-PivotCalculationGroup-asString"></a>



<h4>Method <code>asString()</code>
</h4>

<p>Return a representation of this object as a character value.
</p>


<h5>Usage</h5>

<div class="r"><pre>PivotCalculationGroup$asString(seperator = ", ")</pre></div>



<h5>Arguments</h5>

<div class="arguments">

<dl>
<dt><code>seperator</code></dt>
<dd>
<p>A character value used when concatenating
the text representations of different calculations.</p>
</dd>
</dl>
</div>



<h5>Returns</h5>

<p>A character summary of various object properties.
</p>


<hr>
<a id="method-PivotCalculationGroup-clone"></a>



<h4>Method <code>clone()</code>
</h4>

<p>The objects of this class are cloneable with this method.
</p>


<h5>Usage</h5>

<div class="r"><pre>PivotCalculationGroup$clone(deep = FALSE)</pre></div>



<h5>Arguments</h5>

<div class="arguments">

<dl>
<dt><code>deep</code></dt>
<dd>
<p>Whether to make a deep clone.</p>
</dd>
</dl>
</div>




<h3>Examples</h3>

<pre><code class="language-R"># This class should only be created by the pivot table.
# It is not intended to be created outside of the pivot table.
</code></pre>


</div>