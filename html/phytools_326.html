<div class="container">

<table style="width: 100%;"><tr>
<td>sim.ratebystate</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>Conduct simulation of state dependent rate variation</h2>

<h3>Description</h3>

<p>Simulates two characters under a model in which the rate of one depends on the state of the other.
</p>


<h3>Usage</h3>

<pre><code class="language-R">sim.ratebystate(tree, sig2x=1, sig2y=1, beta=c(0,1), ...)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>tree</code></td>
<td>
<p>phylogenetic tree.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>sig2x</code></td>
<td>
<p>variance of the Brownian process of evolution for <em>x</em>, <code class="reqn">\sigma_x^2</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>sig2y</code></td>
<td>
<p>variance of the Brownian process of evolution for <em>y</em> when <code>x-min(x)==1</code> (for <code>logarithm=FALSE</code>) or <code>x==0</code> (for <code>logarithm=TRUE</code>).</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>beta</code></td>
<td>
<p>intercept and slope of the relationship between the value of <em>x</em> and the Brownian rate in <em>y</em>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>...</code></td>
<td>
<p>optional arguments which include <code>method</code> (<code>"by.node"</code> or <code>"by.branch"</code> indicating whether to assume the rate varies as a function of the node state or the mean branch state); <code>plot</code>, a logical value indicating whether or not to plot a traitgram ("phenogram") with the branches used for simulation of <code>y</code> after rescaling by the state of <code>x</code>; and <code>logarithm</code>, a logical value indicating whether or not simulate changes in the variance of Brownian evolution for <code>y</code> as an additive <code>logarithm=FALSE</code> or multiplicative function of <code>x</code>. The default is <code>logarithm=FALSE</code>.</p>
</td>
</tr>
</table>
<h3>Details</h3>

<p>This function attempts to simulate two characters under a model in which the rate of evolution for the second (<em>y</em>) depends on the states for the first (<em>x</em>). 
</p>
<p>See <code>ratebystate</code> for more details.
</p>


<h3>Value</h3>

<p>This function returns a matrix.
</p>


<h3>Author(s)</h3>

<p>Liam Revell <a href="mailto:liam.revell@umb.edu">liam.revell@umb.edu</a></p>


<h3>References</h3>

<p>Revell, L. J. (2024) phytools 2.0: an updated R ecosystem for phylogenetic comparative methods (and other things). <em>PeerJ</em>, <b>12</b>, e16505.
</p>


<h3>See Also</h3>

<p><code>fastBM</code>, <code>ratebystate</code>
</p>


</div>