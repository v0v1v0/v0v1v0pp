<div class="container">

<table style="width: 100%;"><tr>
<td>writeFam</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>Export <code>ped</code> objects to .fam</h2>

<h3>Description</h3>

<p>This function produces a <code>.fam</code> file readable by the Familias software (Egeland
et al., 2000), containing all input pedigrees, their marker data and mutation
models. The option <code>openFam = TRUE</code> calls <code>openFamilias()</code> to open a fresh
Familias session with the produced file loaded.
</p>


<h3>Usage</h3>

<pre><code class="language-R">writeFam(
  ...,
  famfile = "ped.fam",
  params = NULL,
  dbOnly = FALSE,
  openFam = FALSE,
  FamiliasPath = NULL,
  verbose = TRUE
)

openFamilias(famfile = NULL, FamiliasPath = NULL, verbose = TRUE)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>...</code></td>
<td>
<p>One or several pedigrees. Each argument should be either a single
<code>ped</code> object or a list of such. If the pedigrees are unnamed, they are
assigned names "Ped 1", "Ped 2", etc.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>famfile</code></td>
<td>
<p>The name or path to the output file to be written. The
extension ".fam" is added if missing.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>params</code></td>
<td>
<p>A list of further parameters; see <code>readFam()</code> for valid
entries. See also Details for default values.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>dbOnly</code></td>
<td>
<p>A logical. If TRUE, no pedigree information is included; only
the frequency database.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>openFam</code></td>
<td>
<p>A logical. If TRUE, an attempt is made to open the produced
<code>.fam</code> file in an external Familias session. Only available on Windows
systems with a working Familias installation.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>FamiliasPath</code></td>
<td>
<p>The path to the Familias executable. If empty, the
following are tried in order: "Familias3.exe", "C:/Program Files
(x86)/Familias3/Familias3.exe".</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>verbose</code></td>
<td>
<p>A logical, by default TRUE.</p>
</td>
</tr>
</table>
<h3>Details</h3>

<p>The following parameters are applied by default, but may be adjusted with the
<code>params</code> argument:
</p>

<ul>
<li> <p><code>version</code> = "3.2.8"
</p>
</li>
<li> <p><code>dvi</code> = <code>FALSE</code> (for now the only valid option)
</p>
</li>
<li> <p><code>dbName = "unknown"</code>
</p>
</li>
<li> <p><code>dbSize = 1000</code>
</p>
</li>
<li> <p><code>dropout = 0</code>
</p>
</li>
<li> <p><code>maf = 0</code>
</p>
</li>
<li> <p><code>theta = 0</code>
</p>
</li>
</ul>
<p>The <code>params</code> argument should be a list similar to the <code>params</code> slot produced
by <code>readFam()</code> with <code>includeParams = TRUE</code>. Single entries are recycled if
needed. If <code>params</code> contains a vector <code>dropout</code> with dropout probabilities
for certain pedigree members, it is converted into corresponding
<code>dropoutConsider</code> and <code>dropoutValue</code> vectors (see Examples).
</p>


<h3>Value</h3>

<p>The file name is returned invisibly.
</p>


<h3>References</h3>

<p>Egeland et al. (2000). <em>Beyond traditional paternity and
identification cases. Selecting the most probable pedigree.</em> Forensic Sci
Int 110(1): 47-59.
</p>


<h3>See Also</h3>

<p><code>readFam()</code>.
</p>


<h3>Examples</h3>

<pre><code class="language-R">
# Create pedigree with 2 markers
x = nuclearPed() |&gt;
  addMarker(geno = c("2/2", "1/3", "2/3"), alleles = 1:3,
            afreq = c(.3,.3,.4), name = "M1")

# Write to .fam
tmp = writeFam(x, famfile = tempfile())

# Read back in
y = readFam(tmp)

stopifnot(identical(x, y))


### With stepwise mutation model
x2 = setMutmod(x, model = "stepwise",
               rate = list(male = 0.001, female = 0.002),
               range = 0.1, rate2 = 0.0001)

# Write and read
y2 = x2 |&gt;
  writeFam(famfile = tempfile()) |&gt;
  readFam()

stopifnot(identical(x2, y2))


### Read/write including detailed parameters
params = list(theta = 0.1, dbName = "myDB", dropout = c("3" = 0.01))
fam = writeFam(x2, famfile = tempfile(), params = params)

dat = readFam(fam, includeParams = TRUE)

# Pedigree is now in the `main` slot
stopifnot(identical(x2, dat$main))

# The `dropout` parameter is converted to (and is equivalent to):
dat$params$dropoutConsider
dat$params$dropoutValue


### Read/write frequency database

# Write database as fam file
dbfam = writeFam(x2, famfile = tempfile(), dbOnly = TRUE)

# Read back in: The result is a list of marker attributes
a = readFam(dbfam)

# Attach to a pedigree and write to a new file
z = singleton(1) |&gt; setMarkers(locusAttributes = a)
dbfam2 = writeFam(z, famfile = tempfile(), dbOnly = TRUE)

stopifnot(identical(readLines(dbfam), readLines(dbfam2)))

</code></pre>


</div>