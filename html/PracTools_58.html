<div class="container">

<table style="width: 100%;"><tr>
<td>unitVar</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>
Compute the unit (population) variance for a variable
</h2>

<h3>Description</h3>

<p>Compute the unit (population) variance for a variable based on either a full population file or a sample from a finite population.
</p>


<h3>Usage</h3>

<pre><code class="language-R">unitVar(pop.sw = NULL, w = NULL, p = NULL, y = NULL)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>pop.sw</code></td>
<td>

<p>TRUE if the full population is input; FALSE if a sample is input
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>w</code></td>
<td>

<p>vector of sample weights if <code>y</code> is a sample; used only if <code>pop.sw = FALSE</code>
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>p</code></td>
<td>

<p>vector of 1-draw selection probabilities; optionally provided if <code>pop.sw = TRUE</code>
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>y</code></td>
<td>

<p>vector of values of an analysis variable; must be numeric
</p>
</td>
</tr>
</table>
<h3>Details</h3>

<p><code>unitVar</code> computes unit (population) variances of an analysis variable <code class="reqn">y</code> from either a population or a sample. <code>S2</code> is the unweighted population variance, <code class="reqn">S^2 = \sum_{i \in U}(y_i - \bar{y}_U)^2/(N-1)</code> where <code class="reqn">U</code> is the universe of elements, <code class="reqn">N</code> is the population size, and <code class="reqn">\bar{y}_U</code> is the population mean. If the input is a sample, <code>S2</code> is estimated as <code class="reqn">\hat{S}^2 = (n/(n-1))\sum_{i \in s} w_i(y_i - \bar{y}_w)^2/(\sum_{i \in s} w_i)</code> where <code class="reqn">s</code> is the set of sample elements, <code class="reqn">n</code> is the sample size, and <code class="reqn">\bar{y}_w</code> is the weighted sample mean.
</p>
<p><code>V1</code> is a weighted population variance used in calculations for samples where elements are selected with varying probabilities. If the <code class="reqn">y</code> is a population vector, <code class="reqn">V_1 = \sum_U p_i(y_i/p_i - t_U)^2</code> where <code class="reqn">p_i</code> is the 1-draw probability for element <code class="reqn">i</code> and <code class="reqn">t_U</code> is the population total of <code class="reqn">y</code>. If <code class="reqn">y</code> is for a sample, <code class="reqn">\hat{V}_1 = \sum_s (y_i/p_i - n^{-1}\sum_k y_k/p_k)^2 / (n-1)</code> with <code class="reqn">p_i</code> computed as <code class="reqn">1/(n w_i)</code>.
</p>


<h3>Value</h3>

<p>A list with three or four components:
</p>
<table>
<tr style="vertical-align: top;">
<td><code>Note</code></td>
<td>
<p>Describes whether output was computed from a full population or estimated from a sample.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>Pop size N</code></td>
<td>
<p>Size of the population; included if <code>y</code> is for the full population.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>S2</code></td>
<td>
<p>Unit variance of <code>y</code>; if <code>pop.sw = TRUE</code>, <code>S2</code> is computed from the full population; if <code>pop.sw = FALSE</code>, <code>S2</code> is estimated from the sample using the <code>w</code> weights.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>V1</code></td>
<td>
<p>Population variance of <code>y</code> appropriate for a sample selected with varying probabilities; see Valliant, Dever, and Kreuter (VDK; 2018, sec. 3.4). If <code>pop.sw = TRUE</code> and <code>p</code> is provided, <code>V1</code> is computed with equation (3.32) in VDK. If <code>pop.sw = FALSE</code>, <code>V1</code> is estimated with equation (3.41) in VDK.</p>
</td>
</tr>
</table>
<h3>Author(s)</h3>

<p>Richard Valliant
</p>


<h3>References</h3>

<p>Valliant, R., Dever, J., Kreuter, F. (2018, chap. 3). <em>Practical Tools for Designing and Weighting Survey Samples, 2nd edition</em>. New York: Springer.
</p>


<h3>See Also</h3>

<p><code>nCont</code>, <code>nContMoe</code>, <code>nContOpt</code>, <code>nPPS</code>
</p>


<h3>Examples</h3>

<pre><code class="language-R">library(PracTools)
data("smho.N874")
y &lt;- smho.N874[,"EXPTOTAL"]
x &lt;- smho.N874[, "BEDS"]
y &lt;- y[x&gt;0]
x &lt;- x[x&gt;0]
pik &lt;- x/sum(x)
require(sampling)
n &lt;- 50
sam &lt;- UPrandomsystematic(n * pik)
wts &lt;- 1/(n*pik[sam==1])
unitVar(pop.sw = TRUE, w = NULL, p = pik, y=y)
unitVar(pop.sw = FALSE, w = wts, p = NULL, y=y[sam==1])
</code></pre>


</div>