<div class="container">

<table style="width: 100%;"><tr>
<td>pqrBayes</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>fit a regularized Bayesian quantile varying coefficient model</h2>

<h3>Description</h3>

<p>fit a regularized Bayesian quantile varying coefficient model
</p>


<h3>Usage</h3>

<pre><code class="language-R">pqrBayes(
  g,
  y,
  u,
  e = NULL,
  quant = 0.5,
  iterations = 10000,
  kn = 2,
  degree = 2,
  sparse = TRUE,
  hyper = NULL,
  debugging = FALSE
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>g</code></td>
<td>
<p>the matrix of predictors (subject to selection) without intercept.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>y</code></td>
<td>
<p>the response variable. The current version only supports the continuous response.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>u</code></td>
<td>
<p>a vector of effect modifying variable of the quantile varying coefficient model.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>e</code></td>
<td>
<p>a matrix of clinical covariates not subject to selection.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>quant</code></td>
<td>
<p>the quantile level specified by users. The default value is 0.5.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>iterations</code></td>
<td>
<p>the number of MCMC iterations.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>kn</code></td>
<td>
<p>the number of interior knots for B-spline.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>degree</code></td>
<td>
<p>the degree of B-spline basis.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>sparse</code></td>
<td>
<p>logical flag. If TRUE, spike-and-slab priors will be used to shrink coefficients of irrelevant covariates to zero exactly.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>hyper</code></td>
<td>
<p>a named list of hyperparameters.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>debugging</code></td>
<td>
<p>logical flag. If TRUE, progress will be output to the console and extra information will be returned.</p>
</td>
</tr>
</table>
<h3>Details</h3>

<p>The model described in "<code>data</code>" is:
</p>
<p style="text-align: center;"><code class="reqn">Y_{i}=\sum_{k=1}^{q} E_{ik} \beta_k +\sum_{j=0}^{p}\gamma_j(V_i)X_{ij} +\epsilon_{i},</code>
</p>

<p>where <code class="reqn">\beta_k</code>'s are the regression coefficients for the clinical covariates and <code class="reqn">\gamma_j</code>'s are the varying coefficients for the intercept and predictors (e.g. genetic factors).
</p>
<p>When sparse=TRUE (default), spike–and–slab priors are adopted. Otherwise, Laplacian shrinkage will be used.
Users can modify the hyper-parameters by providing a named list of hyper-parameters via the argument ‘hyper’.
The list can have the following named components
</p>

<ul>
<li>
<p>a0, b0:  shape parameters of the Beta priors (<code class="reqn">\pi^{a_{0}-1}(1-\pi)^{b_{0}-1}</code>) on <code class="reqn">\pi_{0}</code>.
</p>
</li>
<li>
<p>c1, c2:  the shape parameter and the rate parameter of the Gamma prior on <code class="reqn">\nu</code>.
</p>
</li>
</ul>
<p>Please check the references for more details about the prior distributions.
</p>


<h3>Value</h3>

<p>an object of class "pqrBayes" is returned, which is a list with components:
</p>
<table>
<tr style="vertical-align: top;">
<td><code>posterior</code></td>
<td>
<p>posterior samples from the MCMC</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>coefficients</code></td>
<td>
<p>a list of posterior estimates of coefficients</p>
</td>
</tr>
</table>
<h3>References</h3>

<p>Zhou, F., Ren, J., Ma, S. and Wu, C. (2023). The Bayesian regularized quantile varying coefficient model.
<em>Computational Statistics &amp; Data Analysis</em>, 107808 <a href="https://doi.org/10.1016/j.csda.2023.107808">doi:10.1016/j.csda.2023.107808</a>
</p>
<p>Ren, J., Zhou, F., Li, X., Ma, S., Jiang, Y. and Wu, C. (2023). Robust Bayesian variable selection for gene-environment interactions. 
<em>Biometrics</em>, 79(2), 684-694 <a href="https://doi.org/10.1111/biom.13670">doi:10.1111/biom.13670</a>
</p>
<p>Ren, J., Zhou, F., Li, X., Chen, Q., Zhang, H., Ma, S., Jiang, Y. and Wu, C. (2020) Semi-parametric Bayesian variable selection for gene-environment interactions.
<em>Statistics in Medicine</em>, 39: 617– 638 <a href="https://doi.org/10.1002/sim.8434">doi:10.1002/sim.8434</a>
</p>


<h3>Examples</h3>

<pre><code class="language-R">data(data)
g=data$g
y=data$y
u=data$u
e=data$e

## default method
fit1=pqrBayes(g,y,u,e,quant=0.5)
fit1



## non-sparse
sparse=FALSE
fit2=pqrBayes(g,y,u,e,quant=0.5,sparse = sparse)
fit2

</code></pre>


</div>