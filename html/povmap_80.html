<div class="container">

<table style="width: 100%;"><tr>
<td>step</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>Step Function</h2>

<h3>Description</h3>

<p>This generic function selects a model by different criteria in a stepwise
algorithm.
</p>


<h3>Usage</h3>

<pre><code class="language-R">step(object, scope, criteria, direction, trace, steps, ...)

## Default S3 method:
step(object, ...)

## S3 method for class 'fh'
step(
  object,
  scope = NULL,
  criteria = "AIC",
  direction = "both",
  trace = TRUE,
  steps = 1000,
  ...
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>object</code></td>
<td>
<p>an object of type "fh" that contains the chosen
information criterion or of type "lm" for the default method.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>scope</code></td>
<td>
<p>formula or a list including two formulas (<code>lower</code> and
<code>upper</code>) specifying the models considered in the step function.
Defaults to <code>NULL</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>criteria</code></td>
<td>
<p>a character string describing the model selection criterion.
Criteria that can be chosen are "<code>AIC</code>", "<code>AICc</code>", "<code>AICb1</code>",
"<code>AICb2</code>", "<code>BIC</code>", "<code>KIC</code>", "<code>KICc</code>", "<code>KICb1</code>",
or "<code>KICb2</code>". Defaults to "<code>AIC</code>".</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>direction</code></td>
<td>
<p>a character string describing the direction of stepwise
algorithm. Directions that can be chosen are "<code>both</code>",
"<code>backward</code>" or "<code>forward</code>". Defaults to "<code>both</code>". If no
<code>scope</code> argument is provided, the default is "<code>backward</code>".</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>trace</code></td>
<td>
<p>if <code>TRUE</code>, information about the single steps is
provided during the stepwise procedure. Defaults to <code>TRUE</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>steps</code></td>
<td>
<p>a number determining the maximum number of steps. Defaults to
1000.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>...</code></td>
<td>
<p>additional arguments that are not used in this method.</p>
</td>
</tr>
</table>
<h3>Details</h3>

<p>The default method of the generic function <code>step</code>
applies the <code>step</code> function for <code>lm</code> models of the
stats package. Please refer to the documentation of the <code>step</code> function
of the stats package for details.
</p>
<p>The information criteria "<code>AICc</code>", "<code>AICb1</code>",
"<code>AICb2</code>", "<code>KIC</code>", "<code>KICc</code>", "<code>KICb1</code>" and
"<code>KICb2</code>" are especially developed for Fay-Herriot models by
<cite>Marhuenda et al. (2014)</cite>. They are based on a bootstrap
algorithm. If one of the criteria is chosen, make sure that the
bootstrap iterations (<code>B</code>) of the "fh" object are set to a positive
number. For some model extensions of the Fay-Herriot model only the
"<code>AIC</code>" and the "<code>BIC</code>" information criteria are provided and for
some none of the information criteria are defined. Check the model_select
component of the "fh" object (objectname$model$model_select). If no
criteria are provided, it is not possible to apply the stepwise
variable selection algorithm.
</p>


<h3>Value</h3>

<p>The return of <code>step</code> depends on the class of its argument.
Please refer to the documentation of the <code>step</code> function
of the stats package for details of the default method.
</p>
<p>For the fh method information about the resulting "best" model due
to the chosen information criterion is provided:
</p>
<table>
<tr style="vertical-align: top;">
<td><code>call</code></td>
<td>
<p>the function call that produced the object.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>coefficients</code></td>
<td>
<p>data frame containing the estimated regression
coefficients, the standard errors and the <code>t</code>- and <code>p</code>-values of
the explanatory variables.</p>
</td>
</tr>
</table>
<h3>References</h3>

<p>Marhuenda, Y., Morales, D. and Pardo, M.C. (2014). Information criteria for
Fay-Herriot model selection. Computational Statistics and Data Analysis 70,
268-280.
</p>


<h3>See Also</h3>

<p><code>step</code>
</p>
<p><code>emdiObject</code>, <code>fh</code>
</p>


<h3>Examples</h3>

<pre><code class="language-R">
# Loading data - population and sample data
data("eusilcA_popAgg")
data("eusilcA_smpAgg")

# Combine sample and population data
combined_data &lt;- combine_data(
  pop_data = eusilcA_popAgg,
  pop_domains = "Domain",
  smp_data = eusilcA_smpAgg,
  smp_domains = "Domain"
)

# Estimate FH model that contains all variables that should be considered
fh_std &lt;- fh(
  fixed = Mean ~ cash + self_empl + unempl_ben,
  vardir = "Var_Mean", combined_data = combined_data,
  domains = "Domain", method = "ml", B = c(0, 50)
)

# Example 1: Use default settings
step(fh_std)

# Example 2: Choose "KICb2" information criterion
step(fh_std, criteria = "KICb2")

</code></pre>


</div>