<div class="container">

<table style="width: 100%;"><tr>
<td>ancestor</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>Tree traversal and utility functions</h2>

<h3>Description</h3>

<p>Functions for describing relationships among phylogenetic nodes (i.e.
internal nodes or tips).
</p>


<h3>Usage</h3>

<pre><code class="language-R">ancestor(phy, node)

children(phy, node)

descendants(phy, node, type = c("tips", "children", "all", "ALL"))

siblings(phy, node, include.self = FALSE)

ancestors(phy, node, type = c("all", "parent", "ALL"))
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>phy</code></td>
<td>
<p>a phylo4 object (or one inheriting from
phylo4, e.g. a phylo4d object)</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>node</code></td>
<td>
<p>either an integer corresponding to a node ID number, or a
character corresponding to a node label; for <code>ancestors</code> and
<code>descendants</code>, this may be a vector of multiple node numbers or names</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>type</code></td>
<td>
<p>(<code>ancestors</code>) specify whether to return just direct
ancestor ("parent"), all ancestor nodes ("all"), or all ancestor nodes
including self ("ALL"); (<code>descendants</code>) specify whether to return just
direct descendants ("children"), all extant descendants ("tips"), or all
descendant nodes ("all") or all descendant nodes including self ("ALL").</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>include.self</code></td>
<td>
<p>whether to include self in list of siblings</p>
</td>
</tr>
</table>
<h3>Details</h3>

<p><code>ancestors</code> and <code>descendants</code> can take <code>node</code> vectors of
arbitrary length, returning a list of output vectors if the number of valid
input nodes is greater than one. List element names are taken directly from
the input node vector.
</p>
<p>If any supplied nodes are not found in the tree, the behavior currently
varies across functions.
</p>

<ul>
<li>
<p> Invalid nodes are automatically omitted by <code>ancestors</code>
and <code>descendants</code>, with a warning.
</p>
</li>
<li> <p><code>ancestor</code>
will return <code>NA</code> for any invalid nodes, with a warning.
</p>
</li>
<li>
<p> Both <code>children</code> and <code>siblings</code> will return an empty
vector, again with a warning.
</p>
</li>
</ul>
<h3>Value</h3>


<dl>
<dt><code>ancestors</code></dt>
<dd>
<p> return a named vector (or a list
of such vectors in the case of multiple input nodes) of the
ancestors and descendants of a node</p>
</dd>
<dt><code>descendants</code></dt>
<dd>
<p> return a named vector (or a list of
such vectors in the case of multiple input nodes) of the ancestors
and descendants of a node</p>
</dd>
<dt><code>ancestor</code></dt>
<dd> <p><code>ancestor</code> is analogous to
<code>ancestors(...{}, type="parent")</code> (i.e. direct ancestor
only), but returns a single concatenated vector in the case of
multiple input nodes</p>
</dd>
<dt><code>children</code></dt>
<dd>
<p>is analogous to <code>descendants(...{},
type="children")</code> (i.e. direct descendants only), but is not
currently intended to be used with multiple input nodes </p>
</dd>
<dt><code>siblings</code></dt>
<dd>
<p> returns sibling nodes (children of the same
parent)</p>
</dd>
</dl>
<h3>See Also</h3>

<p><code>mrca</code>, in the ape package, gives a list of all
subtrees
</p>


<h3>Examples</h3>

<pre><code class="language-R">
  data(geospiza)
  nodeLabels(geospiza) &lt;- LETTERS[1:nNodes(geospiza)]
  plot(as(geospiza, "phylo4"), show.node.label=TRUE)
  ancestor(geospiza, "E")
  children(geospiza, "C")
  descendants(geospiza, "D", type="tips")
  descendants(geospiza, "D", type="all")
  ancestors(geospiza, "D")
  MRCA(geospiza, "conirostris", "difficilis", "fuliginosa")
  MRCA(geospiza, "olivacea", "conirostris")

  ## shortest path between 2 nodes
  shortestPath(geospiza, "fortis", "fuliginosa")
  shortestPath(geospiza, "F", "L")

  ## branch length from a tip to the root
  sumEdgeLength(geospiza, ancestors(geospiza, "fortis", type="ALL"))
</code></pre>


</div>