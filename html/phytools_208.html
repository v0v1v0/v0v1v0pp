<div class="container">

<table style="width: 100%;"><tr>
<td>pbtree</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>Simulate pure-birth or birth-death stochastic tree or trees</h2>

<h3>Description</h3>

<p>This function simulates stochastic birth-death trees. 
</p>
<p>Simulation can be performed conditioning on <code>n</code>, on <code>t</code>, or on both simultaneously. If both, then (for optional argument <code>method="rejection"</code>) rejection sampling is performed whereby trees are simulated given <code>b</code> and <code>t</code> until a tree containing <code>n</code> taxa is found. The giving-up point can be set using the optional argument <code>max.count</code>. 
</p>
<p>Simulations can also be performed in continuous time (the default) or discrete time; the difference being that wait times in the continuous-time simulation come from the exponential distribution; whereas waiting times in discrete-time simulations come from the geometric distribution. In addition, discrete-time simulations allow for the possibility that multiple speciation events can occur at (exactly) the same time, so long as they are on separate branches. Finally, sometimes for stopping criterion <code>n</code> in discrete-time there will be a number of tips different from <code>n</code>. This indicates that the last event contained more than one speciation event, and a warning is printed.
</p>
<p><code>method="direct"</code> is presently experimental. It does not really perform direct sampling; however waiting times &amp; birth or death events are sampled first - with only wait-times consistent with <code>n</code> and <code>t</code> being retained. This rejection sampling occurs one layer earlier than for <code>method="rejection"</code>. This results in a significant (several-fold) speed-up of the code and enables sampling conditioned on <code>n</code> and <code>t</code> simultaneously for much higher <code>b</code> and <code>d</code>. At the present time, <code>extant.only=TRUE</code> does not work for this mode, nor does <code>type="discrete"</code>.
</p>
<p>Note that if <code>ape=FALSE</code>, then the function will run faster, and the tree is theoretically compatible with the ape <code>"phylo"</code> standard; however some downstream errors with functions such as <code>bind.tree</code> have been observed.
</p>
<p>Lastly, under the taxon number stopping criterion (<code>n</code>) for a non-zero extinction rate (<code>d&gt;0</code>) sometimes a tree containing fewer than <code>n</code> extant tips is returned because it has gone completely extinct before the end of the simulation.
</p>


<h3>Usage</h3>

<pre><code class="language-R">pbtree(b=1, d=0, n=NULL, t=NULL, scale=NULL, nsim=1, type=c("continuous",
   "discrete"), ...)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>b</code></td>
<td>
<p>birth rate or speciation rate for <code>type="continuous"</code>; the probability of speciating per time-step for <code>type="discrete"</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>d</code></td>
<td>
<p>death rate or extinction rate for <code>type="continuous"</code>; the probability of going extinct per time-step for <code>type="discrete"</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>n</code></td>
<td>
<p>desired number of species (i.e., taxa-stop criterion).</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>t</code></td>
<td>
<p>total time for simulation (i.e., time-stop criterion).</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>scale</code></td>
<td>
<p>if set, rescales tree to have total length <code>scale</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>nsim</code></td>
<td>
<p>number of simulated trees to return.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>type</code></td>
<td>
<p>string to indicate whether to simulate trees in continuous or discrete time. If the former, then wait times between speciation events are drawn from an exponential distribution; whereas if the latter then wait times comes from a geometric distribution.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>...</code></td>
<td>
<p>optional arguments including <code>ape</code>, a logical value indicating whether to return nodes in a 'ape' compatible ordering (default is <code>TRUE</code>); <code>extant.only</code> a logical value indicating whether or not to return only extant species (defaults to <code>FALSE</code>); <code>max.count</code> a numeric value indicating the maximum number of iterations to run is sampling conditioned on both <code>n</code> and <code>t</code> (defaults to <code>1e5</code>); <code>method</code> gives the method used for simultaneously conditioning on <code>n</code> and <code>t</code> - options are <code>"rejection"</code> and <code>"direct"</code>; <code>tip.label</code>, a vector of tip labels (only works for <code>n!=NULL</code>); and, finally, <code>quiet</code>, a logical value indicating whether or not to suppress certain message (defaults to <code>FALSE</code>).</p>
</td>
</tr>
</table>
<h3>Details</h3>

<p>Simulate stochastic birth-death trees.
</p>


<h3>Value</h3>

<p>A tree or set of trees as an object of class <code>"phylo"</code> or <code>"multiPhylo"</code>, respectively.
</p>


<h3>Author(s)</h3>

<p>Liam Revell <a href="mailto:liam.revell@umb.edu">liam.revell@umb.edu</a></p>


<h3>References</h3>

<p>Revell, L. J. (2024) phytools 2.0: an updated R ecosystem for phylogenetic comparative methods (and other things). <em>PeerJ</em>, <b>12</b>, e16505.
</p>


<h3>Examples</h3>

<pre><code class="language-R">## simulate a pure-birth tree with 400 tips
## scaled to a length of 1.0
tree&lt;-pbtree(n=400,scale=1)
## simulate a pure-birth tree conditioning on n &amp; t
tt&lt;-log(50)-log(2)
tree&lt;-pbtree(n=50,t=tt)
</code></pre>


</div>