<div class="container">

<table style="width: 100%;"><tr>
<td>popRecon.sampler</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>
MCMC Sampler for the popReconstruct Package
</h2>

<h3>Description</h3>

<p>Draws an <abbr><span class="acronym">MCMC</span></abbr> sample from the joint posterior distribution of
age-specific fertility rates, survival and migration proportions and
baseline population counts.
</p>


<h3>Usage</h3>

<pre><code class="language-R">popRecon.sampler(n.iter, burn.in = 0, thin.by = 1, al.f = 1, be.f = 0.0109,
al.s = 1, be.s = 0.0109, al.g = 1, be.g = 0.0436, al.n = 1, be.n = 0.0109,
mean.f, mean.s, mean.g, mean.b, start.f = mean.f, start.s = mean.s,
start.g = mean.g, start.b = mean.b, start.sigmasq.f = 5, start.sigmasq.s = 5,
start.sigmasq.g = 5, start.sigmasq.n = 5, pop.data, prop.vars,
ccmp.function = popRecon.ccmp.female, proj.periods = ncol(mean.f),
age.size = 5, verb = FALSE, s.tol = 10^(-10))
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>n.iter</code></td>
<td>

<p>Number of iterations to save.
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>burn.in</code></td>
<td>

<p>Number of burn-in iterations; not saved.
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>thin.by</code></td>
<td>

<p>Thinning parameter; save every 'thin'th iteration.
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>al.f</code></td>
<td>

<p>Shape parameter of the distribution of the variance of the
age-specific ferility rate initial estimates.
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>be.f</code></td>
<td>

<p>Scale parameter of the distribution of the variance of the
age-specific ferility rate initial estimates.
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>al.s</code></td>
<td>

<p>Shape parameter of the distribution of the variance of the
age-specific survival proportion initial estimates.
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>be.s</code></td>
<td>

<p>Scale parameter of the distribution of the variance of the
age-specific survival proportion initial estimates.
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>al.g</code></td>
<td>

<p>Shape parameter of the distribution of the variance of the
age-specific migration proportion initial estimates.
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>be.g</code></td>
<td>

<p>Scale parameter of the distribution of the variance of the
age-specific migration proportion initial estimates.
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>al.n</code></td>
<td>

<p>Shape parameter of the distribution of the variance of the
age-specific population count initial estimates and census counts.
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>be.n</code></td>
<td>

<p>Scale parameter of the distribution of the variance of the
age-specific population count initial estimates and census counts.
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>mean.f</code></td>
<td>

<p>Matrix of initial estimates of age-specific fertility rates with age
groups as rows, time periods as columns.
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>mean.s</code></td>
<td>

<p>Matrix of initial estimates of age-specific survival proportions with age
groups as rows, time periods as columns.
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>mean.g</code></td>
<td>

<p>Matrix of initial estimates of age-specific migration proportions with age
groups as rows, time periods as columns.
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>mean.b</code></td>
<td>

<p>Matrix of initial estimates of age-specific baseline population counts
with age groups as rows, time periods as columns.
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>start.f</code></td>
<td>

<p>Matrix of MCMC start values of age-specific fertility rates with age
groups as rows, time periods as columns.
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>start.s</code></td>
<td>

<p>Matrix of MCMC start values of age-specific survival proportions with age
groups as rows, time periods as columns.
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>start.g</code></td>
<td>

<p>Matrix of MCMC start values of age-specific migration proportions with age
groups as rows, time periods as columns.
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>start.b</code></td>
<td>

<p>Matrix of MCMC start values of age-specific baseline population counts with age
groups as rows, time periods as columns.
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>start.sigmasq.f</code></td>
<td>

<p>MCMC start value for variance of the age-specific fertility rate initial
estimates.
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>start.sigmasq.s</code></td>
<td>

<p>MCMC start value for variance of the age-specific survival proportions initial
estimates.
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>start.sigmasq.g</code></td>
<td>

<p>MCMC start value for variance of the age-specific migration proportions
initial estimates.
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>start.sigmasq.n</code></td>
<td>

<p>MCMC start value for variance of the age-specific baseline count
initial estimates.
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>pop.data</code></td>
<td>

<p>Matrix fo census counts, with age groups as rows, time periods as columns.
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>prop.vars</code></td>
<td>

<p>List of matrices of variances for Gaussian Metropolis random walk
proposals. Components are
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>ccmp.function</code></td>
<td>

<p>Function to do cohort component projection.
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>proj.periods</code></td>
<td>

<p>Number of age.size-year periods to over which to do the
reconstruction, beginning at the baseline year.
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>age.size</code></td>
<td>

<p>Width of the age groups and time periods in years.
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>verb</code></td>
<td>

<p>Logical; should progress messages be printed.
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>s.tol</code></td>
<td>

<p>A tolerance parameter to stop over-/under-flow when taking logits of
survival proportions.
</p>
</td>
</tr>
</table>
<h3>Details</h3>

<p>This is the main function of the <span class="pkg">popReconstruct</span> package.  It takes
initial estimates of age-specific vital rates, migration proportions
and population counts in the baseline year and draws an MCMC sample
from the joint posterior distribution defined in Wheldon et
al. (2011).  See the vignette <span class="pkg">burkina-faso-females</span> for an
extended illustration of its use.
</p>


<h3>Value</h3>

<p>A list with components;
</p>
<table>
<tr style="vertical-align: top;">
<td><code>fert.rate.mcmc</code></td>
<td>
<p>mcmc object containing MCMC chains for
age-specific fertility rates.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>surv.prop.mcmc</code></td>
<td>
<p>mcmc object containing MCMC chains for
age-specific survival proportions.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>mig.prop.mcmc</code></td>
<td>
<p>mcmc object containing MCMC chains for
age-specific migration proportions.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>baseline.count.mcmc</code></td>
<td>
<p>mcmc object containing MCMC chains for
age-specific baseline counts.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>lx.mcmc</code></td>
<td>
<p>mcmc object containing MCMC chains for
age-specific population counts at years subsequent to baseline.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>variances.mcmc</code></td>
<td>
<p>mcmc object containing MCMC chains for
the vital rate variance parameters.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>alg.stats</code></td>
<td>
<p>“algorithm statistics”; a list with components
<code>acceptance.proportions</code> giving Metropolis acceptance
proportions for each vital rate parameter,
<code>pop.went.negative</code> giving the number of times Metropolis
proposals resulted in negative poplation counts, <code>run.time</code>
giving the time taken to run the sampler and some other, as yet
undocumented, components.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>fixed.params</code></td>
<td>
<p>A list containing the initial estimates and
hyperparmaters of the variance distributions.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>start.vals</code></td>
<td>
<p>A list containing Metropolis start values for the
vital rates, migration proportions, baseline counts and variance
parameters.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>alg.params</code></td>
<td>
<p>“algorithm parameters”; a list returning some
of the arguments supplied for this run, saved for later
reference. For example, Metropolis proposal variances
(<code>prop.vars</code>) and the number
of iterations (<code>iters</code>) are stored here.
</p>
</td>
</tr>
</table>
<h3>Vignettes</h3>

<p>burkina-faso-females</p>


<h3>Author(s)</h3>

<p>Mark C. Wheldon
</p>


<h3>References</h3>

<p>Wheldon, M. C., Raftery, A. E., Clark, S. J. and Gerland, P. (2011)
<em>Estimating Demographic Parameters with Uncertainty</em>. Working Paper
No. 108, Center for Statistics and the Social Sciences, University of
Washington, Seattle. <a href="http://www.csss.washington.edu/Papers/wp108.pdf">http://www.csss.washington.edu/Papers/wp108.pdf</a>.
</p>


</div>