<div class="container">

<table style="width: 100%;"><tr>
<td>spectral_properties</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>Calculate properties of multitaper power spectral density estimates</h2>

<h3>Description</h3>

<p>Various spectral properties may be computed from the vector of tapers, and
if necessary the sampling frequency.
</p>


<h3>Usage</h3>

<pre><code class="language-R">spectral_properties(x, ...)

## S3 method for class 'spec'
spectral_properties(x, ...)

## S3 method for class 'tapers'
spectral_properties(x, ...)

## Default S3 method:
spectral_properties(x, f.samp = 1, n.freq = NULL, p = 0.95, db.ci = FALSE, ...)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>x</code></td>
<td>
<p>object to calculate spectral properties for; or a vector of number of tapers</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>...</code></td>
<td>
<p>additional arguments</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>f.samp</code></td>
<td>
<p>numeric; the sampling frequency (e.g. Hz) of the series the tapers are for</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>n.freq</code></td>
<td>
<p>integer; the number of frequencies of the original spectrum 
(if <code>NULL</code> the length of the tapers object is assumed to be the number)</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>p</code></td>
<td>
<p>numeric; the coverage probability, bound within <code class="reqn">[0,1)</code></p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>db.ci</code></td>
<td>
<p>logical; should the uncertainty confidence intervals be returned as decibels?</p>
</td>
</tr>
</table>
<h3>Details</h3>

<p>Parameter Details:
</p>


<h4>Uncertainty</h4>

<p>See <code>spec_confint</code> for details.
</p>



<h4>Resolution</h4>

<p>The frequency resolution depends on the number of tapers (<code class="reqn">K</code>), and
is found from 
</p>
<p style="text-align: center;"><code class="reqn">\frac{K \cdot f_N}{N_f}</code>
</p>
 
<p>where <code class="reqn">f_N</code> is the Nyquist
frequency and <code class="reqn">N_f</code> is the 
number of frequencies estimated.
</p>



<h4>Degrees of Freedom</h4>

<p>There are two degrees of freedom for each taper <code class="reqn">K</code>:
</p>
<p style="text-align: center;"><code class="reqn">\nu = 2 K</code>
</p>




<h4>Bandwidth</h4>

<p>The bandwidth of a multitaper estimate depends on the number of
tapers.
Following Walden et al (1995) the effective bandwidth is <code class="reqn">\approx 2W</code>
where
</p>
<p style="text-align: center;"><code class="reqn">W = \frac{K + 1}{2 N}</code>
</p>
 
<p>and <code class="reqn">N</code> is the number of terms in the series, which makes <code class="reqn">N \cdot W</code> the
approximate time-bandwidth product.
</p>



<h3>Value</h3>

<p>A list with the following properties (and names):
</p>

<ul>
<li>
<p><code>taper</code>: the number of tapers
</p>
</li>
<li>
<p><code>stderr.chi .upper, .lower, .median</code>: results returned from <code>spec_confint</code>
</p>
</li>
<li>
<p><code>resolution</code>: effective spectral resolution
</p>
</li>
<li>
<p><code>dof</code>: degrees of freedom; will be slightly inaccurate for single-taper periodograms
</p>
</li>
<li>
<p><code>bw</code>: effective bandwidth of the spectrum
</p>
</li>
</ul>
<h3>Author(s)</h3>

<p>A.J. Barbour
</p>


<h3>See Also</h3>

<p><code>spec_confint</code>, <code>psd-package</code>
</p>


<h3>Examples</h3>

<pre><code class="language-R">## Not run: #REX
library(psd)

##
## Spectral properties from the number of tapers used
## (portions extracted from overview vignette)
##

#
# Theoretical uncertainties from Chi^2 distribution
#
sp &lt;- spectral_properties(as.tapers(1:50), p=0.95, db.ci=TRUE)
par(las=1)
plot(stderr.chi.upper ~ taper, sp, type="s",
       ylim=c(-10,20), yaxs="i", xaxs="i",
       xlab=expression("number of tapers ("* nu/2 *")"), ylab="dB",
       main="Spectral uncertainties")
lines(stderr.chi.lower ~ taper, sp, type="s")
lines(stderr.chi.median ~ taper, sp, type="s", lwd=2)
lines(stderr.chi.approx ~ taper, sp, type="s", col="red",lwd=2)

#
# An example using the Project MAGNET dataset
#
data(magnet)
tapinit &lt;- 15 # tapers
dt &lt;- 1 # 1/km

# remove mean/trend (not really necessary but good practice; also, done internally)
ats &lt;- prewhiten(ts(magnet$clean, deltat=dt), plot=FALSE)$prew_lm

# normal and adaptive multitaper spectra
Pspec &lt;- psdcore(ats, dt, tapinit)
Aspec &lt;- pspectrum(ats, dt, tapinit, niter=3, plot=FALSE)

# calculate spectral properties
spp &lt;- spectral_properties(Pspec$taper, db.ci=TRUE)
spa &lt;- spectral_properties(Aspec$taper, db.ci=TRUE)

# function to create polygon data, and create them
pspp &lt;- create_poly(Pspec$freq, dB(Pspec$spec), spp$stderr.chi.approx)
psppu &lt;- create_poly(Pspec$freq, dB(Pspec$spec), spp$stderr.chi.upper)
pspa &lt;- create_poly(Aspec$freq, dB(Aspec$spec), spa$stderr.chi.approx)
pspau &lt;- create_poly(Aspec$freq, dB(Aspec$spec), spa$stderr.chi.upper)

##
## Project MAGNET uncertainties
##
plot(c(0,0.5),c(-8,35),col="white",
       main="Project MAGNET Spectral Uncertainty (p &gt; 0.95)",
       ylab="", xlab="spatial frequency, 1/km", yaxt="n", frame.plot=FALSE)
lines(c(2,1,1,2)*0.01,c(5,5,8.01,8.01)-8)
text(.05, -1.4, "3.01 dB")
polygon(psppu$xx, (psppu$yy), col="light grey", border="black", lwd=0.5)
polygon(pspp$xx, (pspp$yy), col="dark grey", border=NA)
text(0.15, 6, "With adaptive\ntaper refinement", cex=1.2)
polygon(pspau$xx, (pspau$yy)-10, col="light grey", border="black", lwd=0.5)
polygon(pspa$xx, (pspa$yy)-10, col="dark grey", border=NA)
text(0.35, 22, "Uniform tapering", cex=1.2)

##
## Project MAGNET resolution
##
frq &lt;- Aspec$freq
relp &lt;- dB(1/spa$resolution)
par(las=1)
plot(frq, relp,
     col="light grey",
     ylim=dB(c(1,5)),
     type="h", xaxs="i", yaxs="i",
     ylab="dB", xlab="frequency, 1/km",
     main="Project MAGNET Spectral Resolution and Uncertainty")
lines(frq, relp)
lines(frq, spp$stderr.chi.upper+relp, lwd=1.5, lty=3)
lines(frq, spa$stderr.chi.upper+relp, lwd=3, lty=2)
abline(h=dB(sqrt(vardiff(Aspec$spec))), lwd=1.5, lty=2, col="red")

##

## End(Not run)#REX
</code></pre>


</div>