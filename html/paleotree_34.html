<div class="container">

<table style="width: 100%;"><tr>
<td>dateNodes</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>Absolute Dates for Nodes of a Time-Scaled Phylogeny</h2>

<h3>Description</h3>

<p>This function returns the ages of nodes (both internal and terminal tips)
for a given phylogeny of class <code>phylo</code>.
Its use is specialized for application to dated trees from <code>paleotree</code>,
see Details below.
</p>


<h3>Usage</h3>

<pre><code class="language-R">dateNodes(
  tree,
  rootAge = tree$root.time,
  labelDates = FALSE,
  tolerance = 0.001
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>tree</code></td>
<td>
<p>A phylogeny object of class <code>phylo</code>. Must have edge lengths!</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>rootAge</code></td>
<td>
<p>The root age of the tree, assumed by default to be equal to the element at
<code>tree$root.time</code>, which is a standard element for trees dated by the <code>paleotree</code>
package. If not given by the user and if the <code>$root.time</code> element does not exist, then
the maximum depth of the tree will be taken as the root age, which implicitly assumes
the latest most terminal tip is an extant taxon at the modern day (time = 0). If <code>rootAge</code>
is so defined that some nodes may occur later than time = 0, this function may return
negative dates.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>labelDates</code></td>
<td>
<p>If <code>FALSE</code> (the default), the dates returned are labeled with the
tip/node numbers as given in <code>tree$edge</code>. If <code>TRUE</code>, they are labeled with the tip labels
of every descendant tip, which for terminal tips means a single taxon label, and for
internal tips a label that might be very long, composed of multiple tip labels pasted
together. Thus, by default, this argument is <code>FALSE</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>tolerance</code></td>
<td>
<p>The tolerance within which a node date has to be removed from zero-time 
(i.e. the modern) to issue a warning that there are 'negative' node dates.</p>
</td>
</tr>
</table>
<h3>Details</h3>

<p>This function is specialized for dated phylogenies, either estimated from empirical data or simulated with functions from
<code>paleotree</code>, and thus have a <code>$root.time</code> element. This function will still work without such,
but users should see the details for the <code>rootAge</code> argument.
</p>


<h3>Value</h3>

<p>Returns a vector of length <code>Ntip(tree) + Nnode(tree)</code> which contains the dates for
all terminal tip nodes and internal nodes for the tree, in that order,
as numbered in the <code>tree$edge</code> matrix.
These dates are always on a descending scale (i.e. time before present);
see help for argument <code>rootAge</code> for how the present time is determined.
If <code>rootAge</code> is so defined that some nodes may occur later than
time = 0 units before present, this function may (confusingly)
return negative dates and a warning message will be issued.
</p>


<h3>Author(s)</h3>

<p>David W. Bapst, based on a function originally written by Graeme Lloyd.
</p>


<h3>See Also</h3>

<p><code>compareTimescaling</code>, <code>nodeDates2branchLengths</code>
</p>


<h3>Examples</h3>

<pre><code class="language-R">#let's simulate some example data
set.seed(444)
record &lt;- simFossilRecord(p = 0.1, q = 0.1, nruns = 1,
	nTotalTaxa = c(30,40), nExtant = 0)
taxa &lt;- fossilRecord2fossilTaxa(record)
#get the true time-sclaed tree
tree1 &lt;- taxa2phylo(taxa)

#now let's try dateNodes
dateNodes(tree1)

#let's ignore $root.time
dateNodes(tree1,rootAge = NULL)

#with the lengthy tip-label based labels
   #some of these will be hideously long
dateNodes(tree1,labelDates = TRUE)
</code></pre>


</div>