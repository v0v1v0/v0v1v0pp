<div class="container">

<table style="width: 100%;"><tr>
<td>CI</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>Consistency Index and Retention Index</h2>

<h3>Description</h3>

<p><code>CI</code> and <code>RI</code> compute the Consistency Index (CI) and Retention
Index (RI).
</p>


<h3>Usage</h3>

<pre><code class="language-R">CI(tree, data, cost = NULL, sitewise = FALSE)

RI(tree, data, cost = NULL, sitewise = FALSE)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>tree</code></td>
<td>
<p>a phylogenetic tree, i.e. an object of class <code>phylo</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>data</code></td>
<td>
<p>A object of class phyDat containing sequences.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>cost</code></td>
<td>
<p>A cost matrix for the transitions between two states.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>sitewise</code></td>
<td>
<p>return CI/RI for alignment or sitewise</p>
</td>
</tr>
</table>
<h3>Details</h3>

<p>The Consistency Index is defined as minimum number of changes
divided by the number of changes required on the tree (parsimony score). The
Consistency Index is equal to one if there is no homoplasy.
And the Retention Index is defined as
</p>
<p style="text-align: center;"><code class="reqn">RI = \frac{MaxChanges - ObsChanges}{MaxChanges - MinChanges}</code>
</p>



<h3>Value</h3>

<p>a scalar or vector with the CI/RI vector.
</p>


<h3>See Also</h3>

<p><code>parsimony</code>, <code>pratchet</code>,
<code>fitch</code>, <code>sankoff</code>, <code>bab</code>,
<code>ancestral.pars</code>
</p>


<h3>Examples</h3>

<pre><code class="language-R">example(as.phylo.formula)
lab &lt;- tr$tip.label
lab[79] &lt;- "Herpestes fuscus"
tr$tip.label &lt;- abbreviateGenus(lab)
X &lt;- matrix(0, 112, 3, dimnames = list(tr$tip.label, c("Canis", "Panthera",
            "Canis_Panthera")))
desc_canis &lt;- Descendants(tr, "Canis")[[1]]
desc_panthera &lt;- Descendants(tr, "Panthera")[[1]]
X[desc_canis, c(1,3)] &lt;- 1
X[desc_panthera, c(2,3)] &lt;- 1
col &lt;- rep("black", 112)
col[desc_panthera] &lt;- "red"
col[desc_canis] &lt;- "blue"
X &lt;- phyDat(X, "USER", levels=c(0,1))
plot(tr, "f", tip.color=col)
# The first two sites are homoplase free!
CI(tr, X, sitewise=TRUE)
RI(tr, X, sitewise=TRUE)

</code></pre>


</div>