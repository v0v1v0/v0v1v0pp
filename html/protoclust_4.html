<div class="container">

<table style="width: 100%;"><tr>
<td>plotwithprototypes</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>Plot Dendrogram with Prototype Labels Added</h2>

<h3>Description</h3>

<p>Makes a plot of the dendrogram (using <code>plot.hclust</code>) and adds labels of
prototypes on the interior nodes of a dendrogram.
</p>


<h3>Usage</h3>

<pre><code class="language-R">plotwithprototypes(
  hc,
  imerge = -seq(n),
  labels = NULL,
  bgcol = "white",
  font = 1,
  col = 1,
  cex = 1,
  ...
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>hc</code></td>
<td>
<p>an object of class <code>protoclust</code> (as returned by the function
<code>protoclust</code>)</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>imerge</code></td>
<td>
<p>a vector of the nodes whose prototype labels should be added.
Interior nodes are numbered from 1 (lowest merge) to n - 1 (highest merge,
i.e. the root) and leaf-nodes are negative (so if element i is a prototype
for a singleton cluster, then -i is included in imerge).  Example:
<code>seq(1, n - 1)</code> means every interior node is labeled with a prototype.
For larger trees, showing only the prototypes at a given cut may be easier
(described more below). Default: <code>-seq(n)</code>, meaning all leaf labels and
no interior-node labels are shown.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>labels</code></td>
<td>
<p>an optional character vector of length n giving the labels of
the elements clustered.  If not provided, hc$labels is used (if not NULL) or
else labels are taken to be <code>seq(n)</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>bgcol</code></td>
<td>
<p>background color for prototype labels</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>col, font</code></td>
<td>
<p>color and font of prototype labels</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>cex</code></td>
<td>
<p>size of prototype label</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>...</code></td>
<td>
<p>additional arguments to be passed to <code>plot.hclust</code>, such as
<code>hang</code></p>
</td>
</tr>
</table>
<h3>Details</h3>

<p>This function lets one put prototype labels on a dendrogram.  The argument
<code>imerge</code> controls which interior nodes and leaves are labeled.  A
convenient choice for the argument <code>imerge</code> is the <code>imerge</code>-output
of <code>protocut</code>.  This allows one to label a dendrogram with the
prototypes of a particular cut.  See examples below.  This function is
called when one writes <code>plot(hc)</code>, where <code>hc</code> is an object of
class <code>protoclust</code>.
</p>


<h3>Author(s)</h3>

<p>Jacob Bien and Rob Tibshirani
</p>


<h3>References</h3>

<p>Bien, J., and Tibshirani, R. (2011), "Hierarchical Clustering
with Prototypes via Minimax Linkage," <em>The Journal of the American 
Statistical Association</em>, 106(495), 1075-1084.
</p>


<h3>See Also</h3>

<p><code>protoclust</code>, <code>protocut</code>
</p>


<h3>Examples</h3>

<pre><code class="language-R">
# generate some data:
set.seed(1)
n &lt;- 100
p &lt;- 2
x &lt;- matrix(rnorm(n * p), n, p)
rownames(x) &lt;- paste("A", 1:n, sep="")
d &lt;- dist(x)

# perform minimax linkage clustering:
hc &lt;- protoclust(d)

# cut the tree to yield a 10-cluster clustering:
k &lt;- 10 # number of clusters
cut &lt;- protocut(hc, k=k)
h &lt;- hc$height[n - k]

# plot dendrogram (and show cut):
plotwithprototypes(hc, imerge=cut$imerge)
# or more simply: plot(hc, imerge=cut$imerge)
abline(h=h, lty=2)

# negative values of imerge specify which leaves to label
k2 &lt;- 20 # more clusters... with two singletons
cut2 &lt;- protocut(hc, k=k2)
h2 &lt;- hc$height[n - k2]
plot(hc, hang=-1, imerge=cut2$imerge)
abline(h=h2, lty=2)

</code></pre>


</div>