<div class="container">

<table style="width: 100%;"><tr>
<td>get_peaks</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>Get peaks and valleys in a spectrum</h2>

<h3>Description</h3>

<p>These functions find peaks (local maxima) or valleys (local minima) in a
spectrum, using a user selectable size threshold relative to the tallest peak
(global maximum). This a wrapper built on top of function peaks from package
splus2R.
</p>


<h3>Usage</h3>

<pre><code class="language-R">get_peaks(
  x,
  y,
  ignore_threshold = 0,
  span = 5,
  strict = TRUE,
  x_unit = "",
  x_digits = 3,
  na.rm = FALSE
)

get_valleys(
  x,
  y,
  ignore_threshold = 0,
  span = 5,
  strict = TRUE,
  x_unit = "",
  x_digits = 3,
  na.rm = FALSE
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>x</code></td>
<td>
<p>numeric</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>y</code></td>
<td>
<p>numeric</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>ignore_threshold</code></td>
<td>
<p>numeric Value between 0.0 and 1.0 indicating the
relative size compared to tallest peak threshold below which peaks will be
ignored. Negative values set a threshold so that the tallest peaks are
ignored, instead of the shortest.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>span</code></td>
<td>
<p>integer A peak is defined as an element in a sequence which is
greater than all other elements within a window of width <code>span</code>
centered at that element. Use <code>NULL</code> for the global peak.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>strict</code></td>
<td>
<p>logical If <code>TRUE</code>, an element must be strictly greater
than all other values in its window to be considered a peak.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>x_unit</code></td>
<td>
<p>character Vector of texts to be pasted at end of labels built
from x value at peaks.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>x_digits</code></td>
<td>
<p>numeric Number of significant digits in wavelength label.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>na.rm</code></td>
<td>
<p>logical indicating whether <code>NA</code> values should be stripped
before searching for peaks.</p>
</td>
</tr>
</table>
<h3>Value</h3>

<p>A data frame with variables w.length and s.irrad with their values at
the peaks or valleys plus a character variable of labels.
</p>


<h3>See Also</h3>

<p>Other peaks and valleys functions: 
<code>find_peaks()</code>,
<code>find_spikes()</code>,
<code>peaks()</code>,
<code>replace_bad_pixs()</code>,
<code>spikes()</code>,
<code>valleys()</code>,
<code>wls_at_target()</code>
</p>


<h3>Examples</h3>

<pre><code class="language-R">with(sun.spct, get_peaks(w.length, s.e.irrad))
with(sun.spct, get_valleys(w.length, s.e.irrad))

</code></pre>


</div>