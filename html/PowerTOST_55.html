<div class="container">

<table style="width: 100%;"><tr>
<td>power.scABEL.sds</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>
(Empirical) Power of BE decision via scaled (widened) BE acceptance limits
</h2>

<h3>Description</h3>

<p>These function performs the power calculation of the BE decision via 
scaled (widened) BE acceptance limits based on <b>subject data</b> simulations.<br>
This function has an alias power.scABEL.sds().
</p>


<h3>Usage</h3>

<pre><code class="language-R">power.scABEL.sdsims(alpha = 0.05, theta1, theta2, theta0, CV, n, 
                    design = c("2x3x3", "2x2x4", "2x2x3"), design_dta=NULL,
                    regulator, nsims = 1e+05, details = FALSE, setseed = TRUE, 
                    progress)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>alpha</code></td>
<td>

<p>Type I error probability, significance level. Conventionally mostly set to 0.05.
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>theta1</code></td>
<td>

<p>Conventional lower ABE limit to be applied in the mixed procedure if 
<code>CVsWR &lt;= CVswitch</code>. Also lower limit for the point estimate constraint.<br>
Defaults to 0.8 if not given explicitly.
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>theta2</code></td>
<td>

<p>Conventional upper ABE limit to be applied in the mixed procedure if 
<code>CVsWR &lt;= CVswitch</code>. Also upper limit for the point estimate constraint.<br>
Defaults to 1.25 if not given explicitly.
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>theta0</code></td>
<td>

<p>‘True’ or assumed T/R ratio. <br>
Defaults to 0.90 according to the two Lászlós if not given explicitly.
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>CV</code></td>
<td>

<p>Intra-subject coefficient(s) of variation as ratio (not percent).
</p>

<ul>
<li>
<p> If given as a scalar (<code>length(CV)==1</code>) the <em>same</em> CV of Test
and Reference is assumed (homoscedasticity, <code>CVwT==CVwR</code>).
</p>
</li>
<li>
<p> If given as a vector (<code>length(CV)==2</code>), <em>i.e.</em>, assuming
heteroscedasticity, the CV of the Test <strong>must</strong> be given in 
<code>CV[1]</code> and the one of the Reference in the <code>CV[2]</code>.
</p>
</li>
</ul>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>n</code></td>
<td>

<p>Number of subjects under study.<br>
May be given as vector. In that case it is assumed that <code>n</code> contains the number
of subjects in the sequence groups.<br>
If <code>n</code> is given as single number (total sample size) and this number is not 
divisible by the number of sequences of the design an unbalanced design is 
assumed. A corresponding message is thrown showing the numbers of subjects 
in sequence groups.<br>
Attention! In case of the <code>"2x2x3"</code> (TRT|RTR) design the order of sample sizes is important 
if given as vector. <code>n[1]</code> is for sequence group 'TRT' and <code>n[2]</code> is for 
sequence group 'RTR'. 
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>design</code></td>
<td>

<p>Design of the study to be planned.<br><code>"2x3x3"</code> is the partial replicate design (TRR|RTR|RRT).<br><code>"2x2x4"</code> is the full replicate design with 2 sequences and 4 periods.<br><code>"2x2x3"</code> is the 3-period design with sequences TRT|RTR.<br>
Defaults to <code>design="2x3x3"</code>.
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>design_dta</code></td>
<td>

<p>Alternatively to using the arguments <code>design</code> and <code>n</code> the design may 
be defined via a data.frame with columns <code>subject, sequence, period</code> and
<code>tmt</code>. This feature is experimental in the sense that the data.frame is
not checked for complying with the assumed structure.<br>
If you use the argument <code>design_dta</code> you don't need to specify the arguments
<code>design</code> and <code>n</code>.<br>
The default <code>design_dta = NULL</code> means that <code>design</code> and <code>n</code> are used
for the internal construction of the design data.frame.
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>regulator</code></td>
<td>

<p>Regulatory settings for the widening of the BE acceptance limits.<br>
May be given as <code>"EMA"</code> or as an object of
class 'regSet' (see <code>reg_const</code>).<br>
Defaults to <code>regulator="EMA"</code> if missing.<br>
This argument may be given also in lower case if given as character.<br><br>
If given as object of class 'regSet' the component <code>est_method</code> must not be <code>"ISC"</code>. 
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>nsims</code></td>
<td>

<p>Number of simulations to be performed to obtain the empirical power.
Defaults to 100,000 = 1e+05.<br>
If simulations are aimed for empirical alpha <code>nsims=1e+06</code> is recommended.
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>details</code></td>
<td>

<p>If set to <code>TRUE</code> the computational time is shown as well as the components
for the BE decision.<br>
p(BE-wABEL) is the probability that the CI is within (widened) limits.<br>
p(BE-PE) is the probability that the point estimate is within theta1 ... theta2.<br>
p(BE-ABE) is the simulated probability for the conventional ABE test.
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>setseed</code></td>
<td>

<p>Simulations are dependent on the starting point of the (pseudo) random number 
generator. To avoid differences in power for different runs a <code>set.seed()</code> 
is issued if <code>setseed=TRUE</code>, the default. 
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>progress</code></td>
<td>

<p>Should a progressbar be shown? Defaults to <code>TRUE</code> if missing and nsims &gt;5E5.
</p>
</td>
</tr>
</table>
<h3>Details</h3>

<p>The methods rely on the analysis of log-transformed data, <em>i.e.</em>, assume a 
log-normal distribution on the original scale.<br><br>
The widened BE acceptance limits will be calculated by the formula<br><code style="white-space: pre;">⁠  [L, U] = exp(± r_const * sWR)⁠</code><br>
with <code>r_const</code> the regulatory constant and <code>sWR</code> the standard deviation of the within
subjects variability of the Reference. <code>r_const = 0.76</code> (~log(1.25)/0.29356) is used 
in case of <code>regulator="EMA"</code>.
If the CVwR of the Reference is &lt; CVswitch=0.3 the conventional ABE limits 
apply (mixed procedure).<br> 
In case of <code>regulator="EMA"</code> a cap is placed on the widened limits if 
CVwr&gt;0.5, <em>i.e.</em>, the widened limits are held at value calculated for CVwR=0.5.<br><br>
The simulations are done by simulating subject data (all effects fixed except the
residuals) and evaluating these data via ANOVA of all data to get the point estimate
of T vs. R along with its 90% CI and an ANOVA of the data under R(eference) only
to get an estimate of s2wR.<br>
The data.frame with columns  <code>subject, sequence, period</code> and <code>tmt</code> 
necessary for evalution of simulated subject data is constructed internally from 
the arguments <code>design</code> and <code>n</code> or may be given user defined via the argument 
<code>design_dta</code>. The last option is usefull if missing data have to be considered
or if designs have to be evaluated which are not in the list of argument 
<code>design</code>.<br>
This feature is experimental in the sense that the data.frame is not checked 
for complying with the assumed structure.
</p>


<h3>Value</h3>

<p>Returns the value of the (empirical) power if argument <code>details=FALSE</code>.<br><br>
Returns a named vector if argument <code>details=TRUE</code>.<br>
p(BE) is the power, p(BE-wABEL) is the power of the widened ABEL criterion alone 
and p(BE-pe) is the power of the criterion 'point estimat within acceptance 
range' alone. p(BE-ABE) is the power of the conventional ABE test given for 
comparative purposes.
</p>


<h3>Note</h3>

<p>The function is mainly intended for crosscheck of <code>power.scABEL()</code> results.<br>
But may be mandatory for cases where <code>power.scABEL()</code> results are inaccurate
(low sample sizes and/or heteroscedasticity).<br>
It is relatively slow. The run-time of this function doing 1 Mio sims is between 
~ 7-8 sec for n=12 and ~ 3-4 min for n=120 on a machine with an Intel core i7 processor.<br>
Thus be patient and go for a cup of coffee if you use this function with high 
sample sizes!
</p>


<h3>Author(s)</h3>

<p>D. Labes, B. Lang
</p>


<h3>References</h3>

<p>Tóthfalusi L, Endrényi L. <em>Sample Sizes for Designing Bioequivalence Studies for Highly Variable Drugs.</em> J Pharm Pharmaceut Sci. 2011;15(1):73–84. <a href="http://ejournals.library.ualberta.ca/index.php/JPPS/article/download/11612/9489">open source</a>
</p>


<h3>See Also</h3>

<p><code>power.scABEL, reg_const</code>
</p>


<h3>Examples</h3>

<pre><code class="language-R"># using all the defaults:
# design="2x3x3", EMA regulatory settings
# PE constraint 0.8-1.25, cap on widening if CV&gt;0.5
# true ratio=0.90, 1E+5 simulations
power.scABEL.sdsims(CV = 0.4, n = 36)
# should give:
# [1] 0.74321
</code></pre>


</div>