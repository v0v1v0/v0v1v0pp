<div class="container">

<table style="width: 100%;"><tr>
<td>knit_ex</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>Knitr Extensions</h2>

<h3>Description</h3>

<p><code>knit_ex</code> is a utility function for running small knitr examples,
e.g., to illustrate functionalities or issues.
</p>
<p><code>hook_backspace</code> is a chunk hook that enables the use of backspace
characters in the output (e.g., as used in progress bars), and still
obtain a final output as in the console.
</p>


<h3>Usage</h3>

<pre><code class="language-R">knit_ex(x, ..., quiet = TRUE, open = FALSE)

hook_try(before, options, envir)

hook_backspace()

hook_toggle()
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>x</code></td>
<td>
<p>text to knit as a character vector</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>...</code></td>
<td>
<p>arguments passed to <code>knit2html</code> or <code>knit</code></p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>quiet</code></td>
<td>
<p>logical that indicates if knitting should be quiet (no progress bars etc..).</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>open</code></td>
<td>
<p>logical, only used when <code>x</code> is in .Rmd format, that indicates
if the generated document result should be open in a browse, instead of
being printed on screen.
Not that a browser will not open in non-interactive sessions, and the result will
be returned invisibly.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>before</code></td>
<td>
<p>logical that indicates when the hook is being called:
before or after the chunk is processed.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>options</code></td>
<td>
<p>list of current knitr chunk options</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>envir</code></td>
<td>
<p>environment where the chunk is evaluated</p>
</td>
</tr>
</table>
<h3>Value</h3>

<p><code>knit_ex</code> returns the generated code, although invisibly when <code>open=TRUE</code>.
</p>

<ul><li> <p><code>hook_try</code> returns a function.
</p>
</li></ul>
<ul><li> <p><code>hook_backspace</code> returns a function.
</p>
</li></ul>
<ul><li> <p><code>hook_toggle</code>: returns a hook function.
</p>
</li></ul>
<h3>Functions</h3>


<ul>
<li> <p><code>hook_try()</code>: is a knitr hook to enable showing error
messages thrown by <code>try</code>.
The function is not meant to be called directly, but only registered
using knitr::knit_hooks (see details on this dedicated man page).
</p>
<p>This simply defines a function <code>try</code> in <code>envir</code> that prints
the error message if any, and is called instead of base <code>try</code>.
</p>
</li>
<li> <p><code>hook_toggle()</code>: a chunk hook that adds clickable elements to toggle <em>indvidual</em>
code chunks in HTML documents generated from .Rmd files.
</p>
</li>
</ul>
<h3>Examples</h3>

<pre><code class="language-R">
library(knitr)
knit_ex("1 + 1")


library(knitr)

# standard error message is caught
knit_ex("stop('ah ah')")

# with try the error is output on stderr but not caughted by knitr
knit_ex("try( stop('ah ah') )")


# no message caught
knit_ex("
^^^{r, include = FALSE}
knit_hooks$set(try = pkgmaker::hook_try)
^^^

^^^{r, try=TRUE}
try( stop('ah ah') )
^^^")




# Correctly formatting backspaces in chunk outputs
tmp &lt;- tempfile(fileext = '.Rmd')
cat(file = tmp, "
^^^{r, include = FALSE}
library(knitr)
knit_hooks$set(backspace = pkgmaker::hook_backspace())
^^^
Default knitr does not handle backspace and adds a special character:
^^^{r}
cat('abc\bd')
^^^

Using the hook backspace solves the issue:
^^^{r, backspace=TRUE}
cat('abc\bd')
^^^
")

# knit
out &lt;- knitr::knit2html(tmp, template = FALSE)



# look at output
## Not run: 
  browseURL(out)
  edit( file = out)

## End(Not run)

    
# cleanup
out_files &lt;- list.files(dirname(out), full.names = TRUE,
                         pattern = paste0("^", tools::file_path_sans_ext(out))) 
unlink(c(tmp, out_files))






knit_ex("

Declare chunk hook:
^^^{r, setup}
library(knitr)
knit_hooks$set(toggle = hook_toggle())
^^^

The R code of this chunk can be toggled on/off, and starts visible:
^^^{r, toggle=TRUE}
print(1:10)
^^^
The R code of this chunk can be toggled on/off, and starts hidden:
^^^{r, toggle=FALSE}
print(1:10)
^^^

This is a plain chunk that cannot be toggled on/off:
^^^{r}
print(1:10)
^^^

Now all chunks can be toggled and start visible:
^^^{r, toggle_all}
opts_chunk$set(toggle = TRUE)
^^^

^^^{r}
sample(5)
^^^

To disable the toggle link, one can pass anything except TRUE/FALSE:
^^^{r, toggle = NA}
sample(5)
^^^

", open = FALSE)



</code></pre>


</div>