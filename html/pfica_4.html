<div class="container">

<table style="width: 100%;"><tr>
<td>whiten.fd</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>Whitening (or sphering) functional data</h2>

<h3>Description</h3>

<p>This function whitens functional data in terms of basis functions expansions.
</p>
<p><strong>Functional whitening procedures available:</strong>
</p>

<ul>
<li> <p><code>PCA</code>: uses a projection that combines the covariance function eigenfactors and an arbitrary orthonormal basis
</p>
</li>
<li> <p><code>PCA-cor</code>: PCA whitening based on the correlation  function
</p>
</li>
<li> <p><code>ZCA</code>: or Mahalanobis whitening, is a symmetric solution based on the spectral decomposition of the inverse square root of the covariance function
</p>
</li>
<li> <p><code>ZCA-cor</code>: Mahalanobis whitening based on the correlation function
</p>
</li>
<li> <p><code>Varimax</code>: combines the covariance function eigenfactors and its varimax rotation
</p>
</li>
<li> <p><code>Varimax-cor</code>: Varimax whitening based on the correlation function
</p>
</li>
<li> <p><code>Cholesky</code>: uses the Cholesky factorization of the inverse covariance function.
</p>
</li>
</ul>
<p><strong>Which functional whitening procedure to use?</strong> <code>PCA</code> and <code>PCA-cor</code> allow for maximum compression of the functional observations and therefore the new data representations might be rather noisy. <code>ZCA</code> and <code>ZCA-cor</code> maximize the similarity with the original data, providing most robust whitening. The <code>Varimax</code>/<code>Varimax-cor</code> procedures, which are analogous to <code>ZCA</code>/<code>ZCA-cor</code>, can be used when the first component of the functional PCA accounts for a high percentage of the total variance. <code>Cholesky</code> takes an intermediate position in scoring for maximum compression and similarity indices. To explore low dimensional structures in the data, <code>kffobi</code> and <code>pspline.kffobi</code> allows to compute these functional whitening representations using a few principal components.
</p>
<p>For further details, see Vidal and Aguilera (2022).
</p>


<h3>Usage</h3>

<pre><code class="language-R">whiten.fd(fdx, w = c("PCA", "PCA-cor","ZCA", "ZCA-cor",
                     "Varimax", "Varimax-cor", "Cholesky"),
          pre.center = TRUE, post.center = FALSE)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>fdx</code></td>
<td>
<p>a functional data object obtained from the <strong>fda</strong> package.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>w</code></td>
<td>
<p>the whitening procedure. By default <code>ZCA</code> (Mahalanobis whitening) is used.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>pre.center</code></td>
<td>
<p>centering the functional observations before performing the transformation.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>post.center</code></td>
<td>
<p>centering the functional observations after performing the transformation.</p>
</td>
</tr>
</table>
<h3>Details</h3>

<p>As in the <strong>whitening</strong> package (see Kessy et al. (2018)), to solve the sign ambiguity in  <code>PCA</code>, <code>PCA-cor</code> we use eigenvector matrices with a positive diagonal. The <code>pre.centrer</code>/<code>post.centrer</code> options can be used interchangeably.</p>


<h3>Value</h3>

<table><tr style="vertical-align: top;">
<td><code>wfdx</code></td>
<td>
<p>a functional data object with whitened coefficients.</p>
</td>
</tr></table>
<h3>Author(s)</h3>

<p>Marc Vidal, Ana MÂª Aguilera</p>


<h3>References</h3>

<p>Acal, C., A.M. Aguilera and M. Escabias (2020). <em>New Modeling Approaches Based on Varimax Rotation of Functional Principal Components</em>. Mathematics, 8(11), 1-15. &lt;doi:10.3390/math8112085&gt;
</p>
<p>Kessy, A., A. Lewin and K. Strimmer (2018). <em>Optimal Whitening and Decorrelation</em>. The American Statistician, 72(4), 309-314, &lt;doi:10.1080/00031305.2016.1277159&gt;.
</p>
<p>Vidal, M. and and A.M. Aguilera (2022). <em>Novel whitening approaches in functional settings</em>.  Stat, e516,
&lt;doi:10.1002/sta4.516&gt;.
</p>


<h3>See Also</h3>

<p><code>ffobi</code></p>


<h3>Examples</h3>

<pre><code class="language-R">## Canadian Weather data
library(fda)
arg &lt;- 1:365
Temp &lt;- CanadianWeather$dailyAv[,,1]
B &lt;- create.bspline.basis(rangeval=c(min(arg),max(arg)), nbasis=16)
x &lt;- Data2fd(Temp, argvals = arg, B)
wx &lt;- whiten.fd(x)
</code></pre>


</div>