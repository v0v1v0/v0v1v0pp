<div class="container">

<table style="width: 100%;"><tr>
<td>band.chol</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>
Computes the banded covariance estimator by banding the covariance Cholesky factor 
</h2>

<h3>Description</h3>

<p>Computes the <code class="reqn">k</code>-banded covariance estimator by <code class="reqn">k</code>-banding the covariance Cholesky factor
as described by Rothman, Levina, and Zhu (2010).
</p>


<h3>Usage</h3>

<pre><code class="language-R">band.chol(x, k, centered = FALSE, method = c("fast", "safe"))
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>x</code></td>
<td>

<p>A data matrix with <code class="reqn">n</code> rows and <code class="reqn">p</code> columns. The rows are assumed to be a realization of <code class="reqn">n</code>
independent copies of a <code class="reqn">p</code>-variate random vector. 
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>k</code></td>
<td>

<p>The banding parameter (the number of sub-diagonals to keep as non-zero).  Should be a non-negative integer.
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>centered</code></td>
<td>

<p>Logical: <code>centered=TRUE</code> should be used if the columns of <code>x</code> have already been centered.
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>method</code></td>
<td>

<p>The method to use. The default is
<code>method="fast"</code>, which uses the Grahm-Schmidt style algorithm and must have <code class="reqn">k \leq \min(n-2, p-1)</code>.
Alternatively, <code>method="safe"</code> uses an inverse or generalized inverse to compute estimates
of the regression coefficients and is more numerically stable (and capable of handling <code class="reqn">k \in \{0,\ldots,p-1\}</code> regardless of <code class="reqn">n</code>).
</p>
</td>
</tr>
</table>
<h3>Details</h3>

<p><code>method="fast"</code> is much faster than <code>method="safe"</code>. 
See Rothman, Levina, and Zhu (2010). 
</p>


<h3>Value</h3>

<p>The banded covariance estimate (a <code class="reqn">p</code> by <code class="reqn">p</code> matrix).
</p>


<h3>Author(s)</h3>

<p>Adam J. Rothman
</p>


<h3>References</h3>

<p>Rothman, A. J., Levina, E., and Zhu, J. (2010).  A new approach to Cholesky-based covariance 
regularization in high dimensions. Biometrika 97(3): 539-550.
</p>


<h3>See Also</h3>

<p><code>band.chol.cv</code>
</p>


<h3>Examples</h3>

<pre><code class="language-R">set.seed(1)
n=50
p=20
true.cov=diag(p)
true.cov[cbind(1:(p-1), 2:p)]=0.4
true.cov[cbind(2:p, 1:(p-1))]=0.4
eo=eigen(true.cov, symmetric=TRUE)
z=matrix(rnorm(n*p), nrow=n, ncol=p)
x=z%*% tcrossprod(eo$vec*rep(eo$val^(0.5), each=p),eo$vec)
sigma=band.chol(x=x, k=1)
sigma 
</code></pre>


</div>