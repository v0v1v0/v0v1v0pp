<div class="container">

<table style="width: 100%;"><tr>
<td>diversity_stats</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>Produce a table of diversity statistics</h2>

<h3>Description</h3>

<p>Calculate diversity statistics on a matrix containing counts of multilocus
genotypes per population.
</p>


<h3>Usage</h3>

<pre><code class="language-R">diversity_stats(z, H = TRUE, G = TRUE, lambda = TRUE, E5 = TRUE, ...)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>z</code></td>
<td>
<p>a table of integers representing counts of MLGs (columns) per
population (rows)</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>H</code></td>
<td>
<p>logical whether or not to calculate Shannon's index</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>G</code></td>
<td>
<p>logical whether or not to calculate Stoddart and Taylor's index (aka
inverse Simpson's index).</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>lambda</code></td>
<td>
<p>logical whether or not to calculate Simpson's index</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>E5</code></td>
<td>
<p>logical whether or not to calculate Evenness</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>...</code></td>
<td>
<p>any functions that can be calculated on a vector or matrix of
genotype counts.</p>
</td>
</tr>
</table>
<h3>Details</h3>

<p>This function will calculate any diversity statistic for counts of
multilocus genotypes per population. This does not count allelic diversity.
The calculations of H, G, and lambda are all performed by
<code>vegan::diversity()</code>. E5 is calculated as </p>
<p style="text-align: center;"><code class="reqn">E_{5} = 
  \frac{(1/\lambda) - 1}{e^{H} - 1}</code>
</p>
<p>.
</p>


<h3>Value</h3>

<p>a numeric matrix giving statistics (columns) for each population
(rows).
</p>


<h3>Author(s)</h3>

<p>Zhian N. Kamvar
</p>


<h3>See Also</h3>

<p><code>diversity_boot()</code> <code>diversity_ci()</code>
<code>poppr()</code>
</p>


<h3>Examples</h3>

<pre><code class="language-R">library(poppr)
data(Pinf)
tab &lt;- mlg.table(Pinf, plot = FALSE)
diversity_stats(tab)
## Not run: 
# Example using the poweRlaw package to calculate the negative slope of the
# Pareto distribution.

library("poweRlaw")
power_law_beta &lt;- function(x){
  xpow &lt;- displ(x[x &gt; 0])                 # Generate the distribution
  xpow$setPars(estimate_pars(xpow))       # Estimate the parameters
  xdat &lt;- plot(xpow, draw = FALSE)        # Extract the data
  xlm &lt;- lm(log(y) ~ log(x), data = xdat) # Run log-log linear model for slope
  return(-coef(xlm)[2])
}

Beta &lt;- function(x){
  x &lt;- drop(as.matrix(x))
  if (length(dim(x)) &gt; 1){
    res &lt;- apply(x, 1, power_law_beta)
  } else {
    res &lt;- power_law_beta(x)
  }
  return(res)
}

diversity_stats(tab, B = Beta)

## End(Not run)
</code></pre>


</div>