<div class="container">

<table style="width: 100%;"><tr>
<td>peakIdentifier</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>Phase identifier for activity data</h2>

<h3>Description</h3>

<p>This function generates a list of outputs. The first element is a plot of raw activity along with the smoothed data and objectively estimated phases of peak of activity data. Smoothing of activity is done using a Savitzky-Golay filter. The input of this function must be the output of the trimData function. This function requires the packages "plotly", "pracma" and "signal". As of now, this function works only for 24-hour T-cycles.
</p>


<h3>Usage</h3>

<pre><code class="language-R">peakIdentifier(
  data,
  filt.order = 3,
  filt.length = 51,
  min.peak.dist = 100,
  peak.ht.scal = 0.5,
  ZT = c(0, 12),
  rm.channels = c()
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>data</code></td>
<td>
<p>Input data file. The input for this function must be the output of the function trimData(). See ??trimData(). This assumes that the output from trimData has data binned in 1-min intervals.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>filt.order</code></td>
<td>
<p>The filter order. This defaults to 3.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>filt.length</code></td>
<td>
<p>The length of filter in indices. This defaults to 51.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>min.peak.dist</code></td>
<td>
<p>The minimum distance between peaks to be picked (in indices). This defaults to 100.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>peak.ht.scal</code></td>
<td>
<p>A scaling factor to identify peaks. This defaults to 0.5. A value of 0.5 will only find peaks that are at least half as tall as that of the tallest peak.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>ZT</code></td>
<td>
<p>A vector defining the regions around which the algorithm must looks for peaks. This defaults to c(0,12). The first value in this vector is always assumed to be the morning peak.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>rm.channels</code></td>
<td>
<p>All the channels that users want to remove from their averaging. This must be a vector, i.e., channels must be separated by commas. For instance, if users choose to remove channels 1 to 5, 25 and 32, then the input should be either c(1,2,3,4,5,25,32) or c(1:5,25,32). This defaults to an empty vector, meaning no individuals are removed from analysis.</p>
</td>
</tr>
</table>
<h3>Value</h3>

<p>A <code>list</code> with two items:
</p>

<dl>
<dt>Plots</dt>
<dd>
<p>A <code>plotly</code> <code>htmlwidget</code> with all the averaged activity overlayed with the smoothed data and markers to point out identified peaks in a 4-by-8 array.</p>
</dd>
<dt>Data</dt>
<dd>
<p>A <code>matrix</code> <code>array</code> with 32 rows (one for each fly) and 9 columns (Channel/Fly identity, Phases of morning peak onset, maxima and offset, Morning peak height, Phases of evening peak onset, maxima and offset, and Evening peak height (all phases are measured in ZT)).</p>
</dd>
</dl>
<h3>Examples</h3>

<pre><code class="language-R">td &lt;- trimData(data = df, start.date = "19 Dec 20", start.time = "21:00",
n.days = 3, bin = 1, t.cycle = 24)
pks &lt;- peakIdentifier(data = td)
</code></pre>


</div>