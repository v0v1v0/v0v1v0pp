<div class="container">

<table style="width: 100%;"><tr>
<td>polyCub.exact.Gauss</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>Quasi-Exact Cubature of the Bivariate Normal Density (DEFUNCT)</h2>

<h3>Description</h3>

<p>This cubature method is <strong>defunct</strong> as of <span class="pkg">polyCub</span> version 0.9.0.
It relied on <code>tristrip()</code> from package <a href="https://CRAN.R-project.org/package=gpclib"><span class="pkg">gpclib</span></a> for polygon
triangulation, but that package did not have a <abbr><span class="acronym">FOSS</span></abbr> license and
was no longer maintained on a mainstream repository.<br>
Contributions to resurrect this cubature method are welcome: an alternative
implementation for constrained polygon triangulation is needed, see
<a href="https://github.com/bastistician/polyCub/issues/2">https://github.com/bastistician/polyCub/issues/2</a>.
</p>


<h3>Usage</h3>

<pre><code class="language-R">polyCub.exact.Gauss(polyregion, mean = c(0, 0), Sigma = diag(2),
  plot = FALSE)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>polyregion</code></td>
<td>
<p>a <code>"gpc.poly"</code> polygon or
something that can be coerced to this class, e.g., an <code>"owin"</code> polygon
(via <code>owin2gpc</code>), or an <code>"sfg"</code> polygon (via
<code>sfg2gpc</code>).</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>mean, Sigma</code></td>
<td>
<p>mean and covariance matrix of the bivariate normal density
to be integrated.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>plot</code></td>
<td>
<p>logical indicating if an illustrative plot of the numerical
integration should be produced. Note that the <code>polyregion</code> will be
transformed (shifted and scaled).</p>
</td>
</tr>
</table>
<h3>Details</h3>

<p>The bivariate Gaussian density can be integrated based on a triangulation of
the (transformed) polygonal domain, using formulae from the
Abramowitz and Stegun (1972) handbook (Section 26.9, Example 9, pp. 956f.).
This method is quite cumbersome because the A&amp;S formula is only for triangles
where one vertex is the origin (0,0). For each triangle
we have to check in which of the 6 outer
regions of the triangle the origin (0,0) lies and adapt the signs in the
formula appropriately: <code class="reqn">(AOB+BOC-AOC)</code> or <code class="reqn">(AOB-AOC-BOC)</code> or
<code class="reqn">(AOB+AOC-BOC)</code> or <code class="reqn">(AOC+BOC-AOB)</code> or ....
However, the most time consuming step is the
evaluation of <code>pmvnorm</code>.
</p>


<h3>Value</h3>

<p>The integral of the bivariate normal density over <code>polyregion</code>.
Two attributes are appended to the integral value:
</p>
<table>
<tr style="vertical-align: top;">
<td><code>nEval</code></td>
<td>

<p>number of triangles over which the standard bivariate normal density had to
be integrated, i.e. number of calls to <code>pmvnorm</code> and
<code>pnorm</code>, the former of which being the most time-consuming
operation.
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>error</code></td>
<td>

<p>Approximate absolute integration error stemming from the error introduced by
the <code>nEval</code> <code>pmvnorm</code> evaluations.
For this reason, the cubature method is in fact only
quasi-exact (as is the <code>pmvnorm</code> function).
</p>
</td>
</tr>
</table>
<h3>References</h3>

<p>Abramowitz, M. and Stegun, I. A. (1972).
Handbook of Mathematical Functions with Formulas, Graphs, and Mathematical
Tables. New York: Dover Publications.
</p>


<h3>See Also</h3>

<p><code>circleCub.Gauss</code> for quasi-exact cubature of the
isotropic Gaussian density over a circular domain.
</p>
<p>Other polyCub-methods: 
<code>polyCub()</code>,
<code>polyCub.SV()</code>,
<code>polyCub.iso()</code>,
<code>polyCub.midpoint()</code>
</p>


<h3>Examples</h3>

<pre><code class="language-R">## a function to integrate (here: isotropic zero-mean Gaussian density)
f &lt;- function (s, sigma = 5)
    exp(-rowSums(s^2)/2/sigma^2) / (2*pi*sigma^2)

## a simple polygon as integration domain
hexagon &lt;- list(
    list(x = c(7.33, 7.33, 3, -1.33, -1.33, 3),
         y = c(-0.5, 4.5, 7, 4.5, -0.5, -3))
)

## quasi-exact integration based on gpclib::tristrip() and mvtnorm::pmvnorm()
## Not run: ## (this example requires gpclib)
hexagon.gpc &lt;- new("gpc.poly", pts = lapply(hexagon, c, list(hole = FALSE)))
plotpolyf(hexagon.gpc, f, xlim = c(-8,8), ylim = c(-8,8))
print(polyCub.exact.Gauss(hexagon.gpc, mean = c(0,0), Sigma = 5^2*diag(2),
                          plot = TRUE), digits = 16)

## End(Not run)
</code></pre>


</div>