<div class="container">

<table style="width: 100%;"><tr>
<td>pcts-package</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>






Periodically Correlated and Periodically Integrated Time Series
</h2>

<h3>Description</h3>

<p>Classes and methods for modelling and simulation of
    periodically correlated (PC) and periodically integrated time
    series.  Compute theoretical periodic autocovariances and related
    properties of PC autoregressive moving average models. Some original
    methods including Boshnakov &amp; Iqelan (2009)
    &lt;doi:10.1111/j.1467-9892.2009.00617.x&gt;, Boshnakov (1996)
    &lt;doi:10.1111/j.1467-9892.1996.tb00281.x&gt;.
</p>


<h3>Details</h3>























































































































































































<p>The underlying assumption is that the observations are made at regular
intervals, such as quarter, month, week, day — or represent data for
such intervals — and these intervals are nested into larger periods.
In pcts we call the larger period a cycle and its parts seasons. Typical
examples of season-cycle timing are months in a year, quarters in a
year, days in a week (or business week). The number of seasons in a
cycle is called frequency in class <code>"ts"</code> in base <span style="font-family: Courier New, Courier; color: #666666;"><b>R</b></span>.
</p>
<p>Cycles in pcts keep not only the number of seasons (frequency) but other
information, such as the names of the seasons and units of seasons.  In
pcts there are a number of builtin cycle classes for typical cases, as
well as provision for creation of custom cycles on the fly.  See
<code>pcCycle</code> and <code>BuiltinCycle</code> for ways to create
cycle objects, and <code>allSeasons</code> for further examples.
</p>
<p>Periodic time series can be created with <code>pcts</code>, which
accepts as input vectors, matrices and time series objects from base R
and some other packages, including zoo and xts.  When importing data,
the time information is taken from the data and an attempt is made to
guess the periodicity from the frequency (for time series objects that
have it set) and an analysis of the datetime stamps, if present.
<code>pcts</code> also has arguments for specifying the number of seasons or
the cycle, as well as the start datetime.
</p>
<p>The main periodic time series classes in <span class="pkg">pcts</span> are
<code>PeriodicTS</code> and <code>PeriodicMTS</code>,
for univariate and multivariate time series, respectively.  Standard
base-R time series functions can be used with them directly, see for
example
<code>window</code>,
<code>frequency</code>,
<code>cycle</code>,
<code>time</code>,
<code>deltat</code>,
<code>start</code>,
<code>end</code>,  
<code>boxplot</code>,
<code>monthplot</code>,
<code>na.trim</code> (<code>na.trim</code> is from package <span class="pkg">zoo</span>).
</p>
<p>Methods for
<code>plot</code>,
<code>summary</code>,
<code>print</code>,
<code>show</code>,
<code>head</code>,
<code>tail</code>,
and other base-R functions are defined where suitable.  Examples can be
found in section Examples and in help pages for the corresponding
functions, classes and methods.
</p>
<p>The naming conventions are as follows. Names of classes generally
consists of one or more words. The first letter of each word, is
capitalised.  Only the first letter of abbreviations for models, such as
ARMA, is capitalised. Similarly for generic functions but for them the
first word is not capitalised. In a few names PM stands for 'periodic
model' and TS for 'time series'.
</p>
<p>Significant portion of the code was written in 2005–2007. Many of the
functions and classes have been renamed under the above
conventions and most of those that are not are not exported but a few
still are and they should be considered subject to change.
</p>
<p><code>autocovariances</code>, <code>autocorrelations</code>, <code>partialAutocorrelations</code>
and others are one-stop generic functions for computation of properties
of time series and models. What to compute is deduced from the type of
the object. For models they compute theoretical quantities — periodic
or non-periodic, scalar or multivariate. For time series they compute
the corresponding sample counterparts.
</p>


<h3>Author(s)</h3>

<p>Georgi N. Boshnakov [aut, cre]
</p>
<p>Maintainer: Georgi N. Boshnakov &lt;georgi.boshnakov@manchester.ac.uk&gt;
</p>


<h3>References</h3>



<p>Boshnakov GN (1994).
“Periodically Correlated Sequences: Some Properties and Recursions.”
Research Report 1, Division of Quality Technology and Statistics, Luleo University, Sweden.<br><br> Boshnakov GN (1996).
“The asymptotic covariance matrix of the multivariate serial correlations.”
<em>Stochastic Process. Appl.</em>, <b>65</b>(2), 251–258.
ISSN 0304-4149, <a href="https://doi.org/10.1016/S0304-4149%2896%2900104-4">doi:10.1016/S0304-4149(96)00104-4</a>.<br><br> Boshnakov GN (1996).
“Recursive computation of the parameters of periodic autoregressive moving-average processes.”
<em>J. Time Ser. Anal.</em>, <b>17</b>(4), 333–349.
ISSN 0143-9782, <a href="https://doi.org/10.1111/j.1467-9892.1996.tb00281.x">doi:10.1111/j.1467-9892.1996.tb00281.x</a>.<br><br> Boshnakov GN (1997).
“Periodically correlated solutions to a class of stochastic difference equations.”
In Csiszar I, Michaletzky G (eds.), <em>Stochastic differential and difference equations (Gyor, 1996)</em>, volume 23 of <em>Progr. Systems Control Theory</em>, 1–9.
Birkhauser Boston, Boston, MA.<br><br> Boshnakov GN (2002).
“Multi-companion matrices.”
<em>Linear Algebra Appl.</em>, <b>354</b>, 53–83.
ISSN 0024-3795, <a href="https://doi.org/10.1016/S0024-3795%2801%2900475-X">doi:10.1016/S0024-3795(01)00475-X</a>.<br><br> Boshnakov GN, Boteva A (1992).
“An algorithm for the computation of the theoretical autocovariances of a periodic autoregression process.”
Varna.<br><br> Boshnakov GN, Iqelan BM (2009).
“Generation of time series models with given spectral properties.”
<em>J. Time Series Anal.</em>, <b>30</b>(3), 349–368.
ISSN 0143-9782, <a href="https://doi.org/10.1111/j.1467-9892.2009.00617.x">doi:10.1111/j.1467-9892.2009.00617.x</a>.<br><br> Boshnakov GN, Iqelan BM (2012).
“Maximum entropy models for general lag patterns.”
<em>Journal of Time Series Analysis</em>, <b>33</b>(1), 112–120.
ISSN 1467-9892, <a href="https://doi.org/10.1111/j.1467-9892.2011.00744.x">doi:10.1111/j.1467-9892.2011.00744.x</a>.<br><br> Boshnakov GN, Lambert-Lacroix S (2009).
“Maximum entropy for periodically correlated processes from nonconsecutive autocovariance coefficients.”
<em>J. Time Series Anal.</em>, <b>30</b>(5), 467–486.
<a href="https://doi.org/10.1111/j.1467-9892.2009.00619.x">doi:10.1111/j.1467-9892.2009.00619.x</a>.<br><br> Boshnakov GN, Lambert-Lacroix S (2011).
<em>pcme: Maximum entropy estimation of periodically correlated time series</em>.
R package version 0.55, <a href="https://personalpages.manchester.ac.uk/staff/georgi.boshnakov/Rpackages/">https://personalpages.manchester.ac.uk/staff/georgi.boshnakov/Rpackages/</a>.<br><br> Boshnakov GN, Lambert-Lacroix S (2012).
“A periodic Levinson-Durbin algorithm for entropy maximization.”
<em>Computational Statistics &amp; Data Analysis</em>, <b>56</b>, 15–24.
ISSN 0167-9473, <a href="https://doi.org/10.1016/j.csda.2011.07.001">doi:10.1016/j.csda.2011.07.001</a>, <a href="https://www.sciencedirect.com/science/article/pii/S0167947311002556">https://www.sciencedirect.com/science/article/pii/S0167947311002556</a>.<br><br> Boswijk HP, Franses PH (1996).
“Unit roots in periodic autoregressions.”
<em>Journal of Time Series Analysis</em>, <b>17</b>(3), 221–245.<br><br> Francq C, Roy R, Saidi A (2011).
“Asymptotic properties of weighted least squares estimation in weak parma models.”
<em>Journal of Time Series Analysis</em>, <b>32</b>(6), 699–723.<br><br> Franses PH (1996).
<em>Periodicity and Stochastic Trends In Economic Time Series</em>.
Oxford University Press Inc., New York.<br><br> Franses PH, Paap R (2004).
<em>Periodic Time Series Models</em>.
Oxford University Press Inc., New York.<br><br> Grolemund G, Wickham H (2011).
“Dates and Times Made Easy with lubridate.”
<em>Journal of Statistical Software</em>, <b>40</b>(3), 1–25.
<a href="https://doi.org/10.18637/jss.v040.i03">doi:10.18637/jss.v040.i03</a>.<br><br> Hipel KW, McLeod AI (1994).
<em>Time series modelling of water resources and environmental systems</em>,  Developments in water science; 45.
London; Amsterdam: Elsevier.<br><br> Lambert-Lacroix S (2000).
“On periodic autoregressive process estimation .”
<em> IEEE Transactions on Signal Processing</em>, <b>48</b>( 6 ), 1800-1803.<br><br> Lambert-Lacroix S (2005).
“ Extension of autocovariance coefficients sequence for periodically correlated processes.”
<em>Journal of Time Series Analysis</em>, <b>26</b>(3), 423-435.<br><br> Lancaster P, Tismenetsky M (1985).
<em>The theory of matrices</em>, Second edition.
Academic Press, New York.<br><br> McLeod AI (1993).
“Parsimony, model adequacy and periodic correlation in time series forecasting.”
<em>Internat. Statist. Rev.</em>, <b>61</b>(3), 387-393.<br><br> McLeod AI (1993).
“Parsimony, model adequacy and periodic correlation in time series forecasting.”
<em>Internat. Statist. Rev.</em>, <b>61</b>(3), 387-393.<br><br> McLeod AI (1994).
“Diagnostic checking of periodic autoregression models with application.”
<em>Journal of Time Series Analysis</em>, <b>15</b>(2), 221–233.<br><br> McLeod AI (1995).
“Diagnostic checking of periodic autoregression models with application.”
<em>Journal of Time Series Analysis</em>, <b>16</b>(6), 647-648.
<a href="https://doi.org/10.1111/j.1467-9892.1995.tb00260.x">doi:10.1111/j.1467-9892.1995.tb00260.x</a>, This corrects some typos in the eponimous article  McLeod (1994).<br><br> Pagano M (1978).
“On periodic and multiple autoregression.”
<em>Ann. Statist.</em>, <b>6</b>, 1310-1317.

</p>


<h3>See Also</h3>

<p><code>pcts</code>,
</p>
<p><code>fitPM</code>,
<code>pclsdf</code>,
<code>pclspiar</code>
</p>
<p><code>autocorrelations</code>
</p>
<p><code>dataFranses1996</code>, <code>Fraser2017</code>,
<code>four_stocks_since2016_01_01</code>,
</p>
<p><code>mcompanion</code>
</p>


<h3>Examples</h3>

<pre><code class="language-R">data(dataFranses1996) 
class(dataFranses1996) # [1] "mts"    "ts"     "matrix"

pcfr &lt;- pcts(dataFranses1996)

class(pcfr)        # "PeriodicMTS"
nSeasons(pcfr) # 4
allSeasons(pcfr)
allSeasons(pcfr, abb = TRUE)

## subsetting
## one index, x[i], is analogous to lists
pcfr2to4 &lt;- pcfr[2:4]; class(pcfr2to4) # "PeriodicMTS"
pcfr2to2 &lt;- pcfr[2];   class(pcfr2to2) # "PeriodicMTS"
pcfr2    &lt;- pcfr[[2]]; class(pcfr2)    # note '[[', "PeriodicTS"

## data for 1990 quarter 3
pcfr2to4[as_date("1990-07-01")] # note: not "1990-03-01"!
pct1990_Q3 &lt;- Pctime(c(1990, 3), pcCycle(pcfr2to4))
pcfr2to4[pct1990_Q3]

## with empty index, returns the underlying data
dim(pcfr[]) # [1] 148  19
dim(pcfr2to2[]) # 148 1
length(pcfr2[]) # 148 (this is numeric)

summary(pcfr2)
summary(pcfr2to4)
## make the output width shorter
summary(pcfr2to4, row.names = FALSE)
summary(pcfr2to4, row.names = 5) # trim row names to 5 characters

head(pcfr2to4)  # starts with NA's
tail(pcfr2to4)  # some NA's at the end too

## time of first and last data, may be NA's
start(pcfr2to4) # 1955 Q1
end(pcfr2to4)   # 1991 Q4

## time of first nonNA:
availStart(pcfr2)    # 1955 Q1
availStart(pcfr2to4) # 1955 Q1

## time of last nonNA:
availEnd(pcfr[[2]])   # 1991 Q4
availEnd(pcfr[[3]])   # 1987 Q4
availEnd(pcfr[[4]])   # 1990 Q4
## but at least one of them is  available for 1991 Q4, so:
availEnd(pcfr2to4)   # 1991 Q4

## use window() to pick part of the ts by time:
window(pcfr2to4, start = c(1990, 1), end = c(1991, 4))
## drop NA's at the start and end:
window(pcfr2to4, start = availStart(pcfr2to4), end = availEnd(pcfr2to4))

plot(pcfr2) # the points mark the first season in each cycle
boxplot(pcfr2)
monthplot(pcfr2)
</code></pre>


</div>