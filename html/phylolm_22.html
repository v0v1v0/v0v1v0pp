<div class="container">

<table style="width: 100%;"><tr>
<td>phylostep</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>Stepwise model selection for Phylogenetic Linear Model</h2>

<h3>Description</h3>

<p>Performs stepwise model selection for phylogenetic linear
models, using the criterion -2*log-likelihood + k*npar, where npar is
the number of estimated parameters and k=2 for the usual AIC.</p>


<h3>Usage</h3>

<pre><code class="language-R">phylostep(formula, starting.formula = NULL, keeping.formula = NULL, data = list(), 
       phy, model = c("BM", "OUrandomRoot","OUfixedRoot", 
       "lambda", "kappa", "delta", "EB", "trend"),
       direction = c("both", "backward", "forward"), trace = 2,
       lower.bound = NULL, upper.bound = NULL, 
       starting.value = NULL, k=2, ...)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>formula</code></td>
<td>
<p>formula of the full model.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>starting.formula</code></td>
<td>
<p>optional formula of the starting model.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>keeping.formula</code></td>
<td>
<p>optional formula of the keeping model. Covariates of the keeping model are always included in the model.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>data</code></td>
<td>
<p>a data frame containing variables in the model. If not
found in <code>data</code>, the variables are taken from current environment.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>phy</code></td>
<td>
<p>a phylogenetic tree of type phylo with branch lengths.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>model</code></td>
<td>
<p>a model for the phylogenetic covariance of residuals.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>direction</code></td>
<td>
<p>direction for stepwise search, can be <code>both</code>, <code>forward</code>, and <code>backward</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>trace</code></td>
<td>
<p>if positive, information on each searching step is
printed. Larger values may give more detailed information.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>lower.bound</code></td>
<td>
<p>optional lower bound for the optimization of the phylogenetic model parameter.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>upper.bound</code></td>
<td>
<p>optional upper bound for the optimization of the phylogenetic model parameter.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>starting.value</code></td>
<td>
<p>optional starting value for the optimization of
the phylogenetic model parameter.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>k</code></td>
<td>
<p>optional weight for the penalty.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>...</code></td>
<td>
<p>further arguments to be passed to the function <code>optim</code>.</p>
</td>
</tr>
</table>
<h3>Details</h3>

<p>The default <code class="reqn">k=2</code> corresponds to the usual AIC penalty.
Use <code class="reqn">k=\log(n)</code> for the usual BIC, although it is
unclear how BIC should be defined for phylogenetic regression.
</p>
<p>See <code>phylolm</code> for details on the possible
phylogenetic models for the error term, for default bounds on the
phylogenetic signal parameters, or for matching tip labels between the
tree and the data.
</p>


<h3>Value</h3>

<p>A phylolm object correponding to the best model is returned.
</p>


<h3>Author(s)</h3>

<p>Lam Si Tung Ho and Cecile Ane</p>


<h3>See Also</h3>

<p><code>phylolm</code>.
</p>


<h3>Examples</h3>

<pre><code class="language-R">set.seed(123456)
tre = rcoal(60)
taxa = sort(tre$tip.label)
b0=0; b1=1;
x1 = rTrait(phy=tre,model="BM",
           parameters=list(ancestral.state=0,sigma2=10))
x2 = rTrait(phy=tre,model="BM",
            parameters=list(ancestral.state=0,sigma2=10))
x3 = rTrait(phy=tre,model="BM",
            parameters=list(ancestral.state=0,sigma2=10))
y &lt;- b0 + b1*x1 + 
     rTrait(n=1,phy=tre,model="BM",parameters=list(
              ancestral.state=0,sigma2=1))
dat = data.frame(trait=y[taxa],pred1=x1[taxa],pred2=x2[taxa],pred3=x3[taxa])
fit = phylostep(trait~pred1+pred2+pred3,data=dat,phy=tre,model="BM",direction="both")
summary(fit)
</code></pre>


</div>