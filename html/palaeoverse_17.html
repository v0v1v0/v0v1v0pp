<div class="container">

<table style="width: 100%;"><tr>
<td>phylo_check</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>Check phylogeny tip names</h2>

<h3>Description</h3>

<p>A function to check the list of tip names in a phylogeny against a vector of
taxon names, and if desired, to trim the phylogeny to only include taxon
names within the vector.
</p>


<h3>Usage</h3>

<pre><code class="language-R">phylo_check(tree = NULL, list = NULL, out = "full_table", sort = "presence")
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>tree</code></td>
<td>
<p><code>phylo</code>. A phylo object containing the phylogeny.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>list</code></td>
<td>
<p><code>character</code>. A vector of taxon names. Binomials can be
separated with either a space or an underscore. The names should not contain
any other punctuation.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>out</code></td>
<td>
<p><code>character</code>. Determine whether to return either a
<code>dataframe</code> describing which taxa are included or not included in the
tree ("full_table", the default), the same table but with taxa included in
both the tree and the list removed ("diff_table"), the counts of taxa
included and not included in the tree ("counts"), or the phylogeny trimmed to
only include taxa in the provided list ("tree").</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>sort</code></td>
<td>
<p><code>character</code>. If out = "full_table" or out = "diff_table",
sort the names by presence in the tree ("presence", the default), or
alphabetically ("az").</p>
</td>
</tr>
</table>
<h3>Details</h3>

<p>Phylogenies can be read into R from .txt or .tree files containing
the Newick formatted tree using <code>ape::read.tree()</code>, and can be saved as
files using <code>ape::write.tree()</code>. When out = "tree", tips are trimmed using
<code>ape::drop.tip()</code>; if your tree is not ultrametric (i.e. the tip dates are
not all the same), we recommend using <code>paleotree::fixRootTime()</code> to readjust
your branch lengths following pruning.
</p>


<h3>Value</h3>

<p>If out = "full_table", a <code>dataframe</code> describing whether taxon
names are present in the list and/or the tree. If out = "diff_table", a
<code>dataframe</code> describing which taxon names are present in the list or the
tree, but not both. If out = "counts", a summary table containing the number
of taxa in the list but not the tree, in the tree but not the list, and in
both. If out = "tree", a phylo object consisting of the input phylogeny
trimmed to only include the tips present in the list.
</p>


<h3>Developer(s)</h3>

<p>Bethany Allen
</p>


<h3>Reviewer(s)</h3>

<p>William Gearty &amp; Pedro Godoy
</p>


<h3>Examples</h3>

<pre><code class="language-R"># track user par
oldpar &lt;- par(no.readonly = TRUE)
#Read in example tree of ceratopsians from paleotree
library(paleotree)
data(RaiaCopesRule)
#Set smaller margins for plotting
par(mar = rep(0.5, 4))
plot(ceratopsianTreeRaia)

#Specify list of names
dinosaurs &lt;- c("Nasutoceratops_titusi", "Diabloceratops_eatoni",
"Zuniceratops_christopheri", "Psittacosaurus_major",
"Psittacosaurus_sinensis", "Avaceratops_lammersi",
"Xenoceratops_foremostensis", "Leptoceratops_gracilis",
"Triceratops_horridus", "Triceratops_prorsus")

#Table of taxon names in list, tree or both
ex1 &lt;- phylo_check(tree = ceratopsianTreeRaia, list = dinosaurs)

#Counts of taxa in list, tree or both
ex2 &lt;- phylo_check(tree = ceratopsianTreeRaia, list = dinosaurs,
                   out = "counts")

#Trim tree to tips in the list
my_ceratopsians &lt;- phylo_check(tree = ceratopsianTreeRaia, list = dinosaurs,
out = "tree")
plot(my_ceratopsians)
# reset user par
par(oldpar)
</code></pre>


</div>