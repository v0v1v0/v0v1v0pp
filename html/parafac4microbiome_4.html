<div class="container">

<table style="width: 100%;"><tr>
<td>assessModelStability</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>Bootstrapping procedure to determine PARAFAC model stability for a given number of components.</h2>

<h3>Description</h3>

<p>Bootstrapping procedure to determine PARAFAC model stability for a given number of components.
</p>


<h3>Usage</h3>

<pre><code class="language-R">assessModelStability(
  dataset,
  minNumComponents = 1,
  maxNumComponents = 5,
  numFolds = dim(dataset$data)[1],
  considerGroups = FALSE,
  groupVariable = "",
  colourCols = NULL,
  legendTitles = NULL,
  xLabels = NULL,
  legendColNums = NULL,
  arrangeModes = NULL,
  method = "als",
  ctol = 1e-06,
  maxit = 2500,
  max_fn = 10000,
  rel_tol = 1e-08,
  abs_tol = 1e-08,
  grad_tol = 1e-08,
  numCores = 1
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>dataset</code></td>
<td>
<p>See Fujita2023, Shao2019 or vanderPloeg2024.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>minNumComponents</code></td>
<td>
<p>Minimum number of components (default 1).</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>maxNumComponents</code></td>
<td>
<p>Maximum number of components (default 5).</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>numFolds</code></td>
<td>
<p>Number of bootstrapped models to create.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>considerGroups</code></td>
<td>
<p>Consider subject groups in calculating sparsity (default FALSE)</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>groupVariable</code></td>
<td>
<p>Column name in dataset$mode1 that should be used to consider groups (default "")</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>colourCols</code></td>
<td>
<p>Vector of strings stating which column names should be factorized for colours per mode.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>legendTitles</code></td>
<td>
<p>Vector of strings stating the legend title per mode.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>xLabels</code></td>
<td>
<p>Vector of strings stating the x-axis labels per mode.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>legendColNums</code></td>
<td>
<p>Vector of integers stating the desired number of columns for the legends per mode.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>arrangeModes</code></td>
<td>
<p>Vector of boolean values per mode, stating if the loadings should be arranged according to colourCols (TRUE) or not (FALSE).</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>method</code></td>
<td>
<p>Use ALS algorithm ("als", default) or use all-at-once optimization ("opt"). The all-at-once optimization is based on a nonlinear conjugate gradient method with Hestenes-Stiefel updates and the More-Thuente line search algorithm.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>ctol</code></td>
<td>
<p>Relative change in loss tolerated to call the algorithm converged in the ALS case (default 1e-4).</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>maxit</code></td>
<td>
<p>Maximum number of iterations allowed without convergence in the ALS case (default 500).</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>max_fn</code></td>
<td>
<p>Maximum number of function evaluations allowed without convergence in the OPT case (default 10000).</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>rel_tol</code></td>
<td>
<p>Relative change in loss tolerated to call the algorithm converged in the OPT case (default 1e-8).</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>abs_tol</code></td>
<td>
<p>Absolute loss tolerated to call the algorithm converged in the OPT case (default 1e-8).</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>grad_tol</code></td>
<td>
<p>Tolerance on the two-norm of the gradient divided over the number of elements in the gradient in the OPT case (default 1e-8).</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>numCores</code></td>
<td>
<p>Number of cores to use. If set larger than 1, it will run the job in parallel (default 1)</p>
</td>
</tr>
</table>
<h3>Value</h3>

<p>A list containing the following:
</p>

<ul>
<li>
<p> models: All stabilized sign-flipped bootstrapped PARAFAC models.
</p>
</li>
<li>
<p> modelPlots: A list of plots of the median model with error bars for each number of components.
</p>
</li>
<li>
<p> FMSplot: A bar plot showing the Factor Match Scores per number of components (see Li et al., 2024).
</p>
</li>
<li>
<p> FMS: FMS values that the FMS plot is based on.
</p>
</li>
</ul>
<h3>Examples</h3>

<pre><code class="language-R">processedFujita = processDataCube(Fujita2023, sparsityThreshold=0.99, centerMode=1, scaleMode=2)
modelStability = assessModelStability(processedFujita,
                                      minNumComponents=1,
                                      maxNumComponents=2,
                                      ctol=1e-4,
                                      maxit=250)
</code></pre>


</div>