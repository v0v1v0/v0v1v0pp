<div class="container">

<table style="width: 100%;"><tr>
<td>getKinship</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>Get genetic kinship.</h2>

<h3>Description</h3>

<p>Estimate kinship from standardised genotypes or read pre-computed kinship
file. Standardised genotypes can be obtained via
<code>standardiseGenotypes</code>.
</p>


<h3>Usage</h3>

<pre><code class="language-R">getKinship(
  N,
  sampleID = "ID_",
  X = NULL,
  kinshipfile = NULL,
  id_samples = NULL,
  standardise = FALSE,
  sep = ",",
  header = TRUE,
  verbose = TRUE
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>N</code></td>
<td>
<p>Number [integer] of samples to simulate.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>sampleID</code></td>
<td>
<p>Prefix [string] for naming samples (will be followed by
sample number from 1 to N when constructing id_samples).</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>X</code></td>
<td>
<p>[NrSamples x totalNrSNPs] Matrix of (standardised) genotypes.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>kinshipfile</code></td>
<td>
<p>path/to/kinshipfile [string] to be read; either X or
kinshipfile must be provided.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>id_samples</code></td>
<td>
<p>Vector of [NrSamples] sample IDs [string]; if not provided
constructed by paste(sampleID, 1:N, sep="").</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>standardise</code></td>
<td>
<p>[boolean] If TRUE genotypes will be standardised before
kinship estimation.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>sep</code></td>
<td>
<p>Field separator [string] of kinship file.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>header</code></td>
<td>
<p>[boolean], If TRUE kinship file has header information.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>verbose</code></td>
<td>
<p>[boolean]; If TRUE, progress info is printed to standard out</p>
</td>
</tr>
</table>
<h3>Details</h3>

<p>The kinship is estimated as <code class="reqn">K = XX_T</code>, with X the standardised
genotypes of the samples. When estimating the kinship from the provided
genotypes, the kinship is normalised by the mean of its diagonal
elements and 1e-4 added to the diagonal for numerical stability.
</p>


<h3>Value</h3>

<p>[NrSamples x NrSamples] Matrix of kinship estimate.
</p>


<h3>Examples</h3>

<pre><code class="language-R">geno &lt;- simulateGenotypes(N=10, NrSNP=50)
K_fromGenotypesNormalised &lt;- getKinship(N=10, X=geno$genotypes,
standardise=TRUE)

kinshipfile &lt;- system.file("extdata/kinship",
"kinship.csv",
package = "PhenotypeSimulator")
K_fromFile &lt;- getKinship(N=50, kinshipfile=kinshipfile)
</code></pre>


</div>