<div class="container">

<table style="width: 100%;"><tr>
<td>grad</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>
Numerical Gradient
</h2>

<h3>Description</h3>

<p>Numerical function gradient.
</p>


<h3>Usage</h3>

<pre><code class="language-R">grad(f, x0, heps = .Machine$double.eps^(1/3), ...)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>f</code></td>
<td>
<p>function of several variables.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>x0</code></td>
<td>
<p>point where the gradient is to build.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>heps</code></td>
<td>
<p>step size.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>...</code></td>
<td>
<p>more variables to be passed to function <code>f</code>.</p>
</td>
</tr>
</table>
<h3>Details</h3>

<p>Computes the gradient
</p>
<p style="text-align: center;"><code class="reqn">(\frac{\partial f}{\partial x_1}, \ldots, \frac{\partial f}{\partial x_n})</code>
</p>

<p>numerically using the “central difference formula”.
</p>


<h3>Value</h3>

<p>Vector of the same length as <code>x0</code>.
</p>


<h3>References</h3>

<p>Mathews, J. H., and K. D. Fink (1999). Numerical Methods Using Matlab.
Third Edition, Prentice Hall.
</p>


<h3>See Also</h3>

<p><code>fderiv</code>
</p>


<h3>Examples</h3>

<pre><code class="language-R">f &lt;- function(u) {
    x &lt;- u[1]; y &lt;- u[2]; z &lt;- u[3]
    return(x^3 + y^2 + z^2 +12*x*y + 2*z)
 }
x0 &lt;- c(1,1,1)
grad(f, x0)     # 15 14  4        # direction of steepest descent

sum(grad(f, x0) * c(1, -1, 0))    # 1 , directional derivative

f &lt;- function(x) x[1]^2 + x[2]^2
grad(f, c(0,0))                   # 0 0 , i.e. a local optimum
</code></pre>


</div>