<div class="container">

<table style="width: 100%;"><tr>
<td>PRSim-package</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>
Stochastic Simulation of Streamflow Time Series using Phase Randomization
</h2>

<h3>Description</h3>

<p>Provides a simulation framework to simulate streamflow time series with similar main characteristics as observed data. These characteristics include the distribution of daily streamflow values and their temporal correlation as expressed by short- and long-range dependence. The approach is based on the randomization of the phases of the Fourier transform or the phases of the wavelet transform. The function prsim() is applicable to single site simulation and uses the Fourier transform. The function prsim.wave() extends the approach to multiple sites and is based on the complex wavelet transform. The function prsim.weather() extends the approach to multiple variables for weather generation. We further use the flexible four-parameter Kappa distribution, which allows for the extrapolation to yet unobserved low and high flows. Alternatively, the empirical or any other distribution can be used. 
  A detailed description of the simulation approach for single sites and an application example can be found in Brunner et al. (2019) &lt;doi:10.5194/hess-23-3175-2019&gt;.
  A detailed description and evaluation of the wavelet-based multi-site approach can be found in Brunner and Gilleland (2020) &lt;doi:10.5194/hess-24-3967-2020&gt;.
  A detailed description and evaluation of the multi-variable and multi-site weather generator can be found in Brunner et al. (2021) &lt;doi:10.5194/esd-12-621-2021&gt;.
  A detailed description and evaluation of the non-stationary streamflow generator can be found in Brunner and Gilleland (2024) &lt;doi:10.1029/2023EF004238&gt;.
</p>


<h3>Details</h3>

<p>The DESCRIPTION file:
</p>

<table>
<tr>
<td style="text-align: left;">
Package: </td>
<td style="text-align: left;"> PRSim</td>
</tr>
<tr>
<td style="text-align: left;">
Type: </td>
<td style="text-align: left;"> Package</td>
</tr>
<tr>
<td style="text-align: left;">
Title: </td>
<td style="text-align: left;"> Stochastic Simulation of Streamflow Time Series using Phase
Randomization</td>
</tr>
<tr>
<td style="text-align: left;">
Version: </td>
<td style="text-align: left;"> 1.5</td>
</tr>
<tr>
<td style="text-align: left;">
Date: </td>
<td style="text-align: left;"> 2024-03-14</td>
</tr>
<tr>
<td style="text-align: left;">
Authors@R: </td>
<td style="text-align: left;"> c(person("Manuela", "Brunner", role = c("aut", "cre"),
             email = "manuela.brunner@env.ethz.ch", 
             comment = c(ORCID = "0000-0001-8824-877X")),
             person("Reinhard", "Furrer", role = c("aut"),  
             email = "reinhard.furrer@math.uzh.ch", 
             comment = c(ORCID = "0000-0002-6319-2332")),
             person("R Core Teamn", role = c("ctb", "cph"), comment="ks_test.c")) </td>
</tr>
<tr>
<td style="text-align: left;">
Author: </td>
<td style="text-align: left;"> Manuela Brunner [aut, cre]  (&lt;https://orcid.org/0000-0001-8824-877X&gt;), Reinhard Furrer [aut] (&lt;https://orcid.org/0000-0002-6319-2332&gt;), R Core Teamn [ctb, cph] (ks_test.c)</td>
</tr>
<tr>
<td style="text-align: left;">
Maintainer: </td>
<td style="text-align: left;"> Manuela Brunner &lt;manuela.brunner@env.ethz.ch&gt;</td>
</tr>
<tr>
<td style="text-align: left;">
Description: </td>
<td style="text-align: left;"> Provides a simulation framework to simulate streamflow time series with similar main characteristics as observed data. These characteristics include the distribution of daily streamflow values and their temporal correlation as expressed by short- and long-range dependence. The approach is based on the randomization of the phases of the Fourier transform or the phases of the wavelet transform. The function prsim() is applicable to single site simulation and uses the Fourier transform. The function prsim.wave() extends the approach to multiple sites and is based on the complex wavelet transform. The function prsim.weather() extends the approach to multiple variables for weather generation. We further use the flexible four-parameter Kappa distribution, which allows for the extrapolation to yet unobserved low and high flows. Alternatively, the empirical or any other distribution can be used. 
  A detailed description of the simulation approach for single sites and an application example can be found in Brunner et al. (2019) &lt;doi:10.5194/hess-23-3175-2019&gt;.
  A detailed description and evaluation of the wavelet-based multi-site approach can be found in Brunner and Gilleland (2020) &lt;doi:10.5194/hess-24-3967-2020&gt;.
  A detailed description and evaluation of the multi-variable and multi-site weather generator can be found in Brunner et al. (2021) &lt;doi:10.5194/esd-12-621-2021&gt;.
  A detailed description and evaluation of the non-stationary streamflow generator can be found in Brunner and Gilleland (2024) &lt;doi:10.1029/2023EF004238&gt;.</td>
</tr>
<tr>
<td style="text-align: left;">
URL: </td>
<td style="text-align: left;"> https://git.math.uzh.ch/reinhard.furrer/PRSim-devel</td>
</tr>
<tr>
<td style="text-align: left;">
BugReports: </td>
<td style="text-align: left;"> https://git.math.uzh.ch/reinhard.furrer/PRSim-devel/-/issues</td>
</tr>
<tr>
<td style="text-align: left;">
License: </td>
<td style="text-align: left;"> GPL-3</td>
</tr>
<tr>
<td style="text-align: left;">
Encoding: </td>
<td style="text-align: left;"> UTF-8</td>
</tr>
<tr>
<td style="text-align: left;">
LazyData: </td>
<td style="text-align: left;"> true</td>
</tr>
<tr>
<td style="text-align: left;">
Depends: </td>
<td style="text-align: left;"> R (&gt;= 3.5.0)</td>
</tr>
<tr>
<td style="text-align: left;">
Suggests: </td>
<td style="text-align: left;"> lattice, ismev, evd, GB2, boot, MASS</td>
</tr>
<tr>
<td style="text-align: left;">
Imports: </td>
<td style="text-align: left;"> stats, methods, lmomco, mev, goftest, wavScalogram, splus2R</td>
</tr>
<tr>
<td style="text-align: left;">
RoxygenNote: </td>
<td style="text-align: left;"> 7.2.3</td>
</tr>
<tr>
<td style="text-align: left;">
Archs: </td>
<td style="text-align: left;"> x64</td>
</tr>
<tr>
<td style="text-align: left;">
</td>
</tr>
</table>
<p>Index of help topics:
</p>
<pre>
PRSim-package           Stochastic Simulation of Streamflow Time Series
                        using Phase Randomization
PRsim                   Simulate for one station
PRsim.wave              Simulate for multiple stations
PRsim.wave.nonstat      Simulate for multiple stations under
                        non-stationary conditions
PRsim.weather           Weather simulation (temperature and
                        precipitation) for multiple stations
runoff                  Sample runoff of a catchment
runoff_multi_site_T     Sample runoff and temperature data of two
                        catchments with a similar discharge regime
runoff_multi_sites      Sample runoff of four catchments with a similar
                        discharge regime
simulations             Simulated runoff
simulations_multi_sites
                        Simulated runoff for four catchments
weather_multi_sites     Sample temperature and precipitation of four
                        catchments derived from the ERA5-Land gridded
                        dataset
weather_sim_multi_sites
                        Simulated temperature and precipitation for two
                        grid cells
</pre>
<p>Contains two functions for the stochastic simulation of continuous discharge time series: prsim and prsim.wave both using phase randomization. prsim is based on the Fourier transform while prsim.wave uses the wavelet transform.
</p>
<p>prsim: Simulation in the frequency domain is based on the randomization of the phases of the Fourier transform. We here combine phase randomization simulation with the flexible, four-parameter kappa distribution, which allows for the extrapolation to yet unobserved low and high flows. Alternative distributions or the empirical distribution can be used instead. The
simulation approach consists of eight steps: (1) fitting of theoretical Kappa distribution, (2) normalization and deseasonalization, (3) Fourier transformation, (4) Fourier phases computation, (5) random phase generation, (6) inverse Fourier transformation, (7) back transformation, and (8) simulation.
</p>
<p>prsim.wave: Simulation for multiple sites in the frequency domain based on the randomization of the phases of the continuous wavelet transform. We combine phase randomization with the flexible, four-parameter kappa distribution. Alternative theoretical distributions or the empirical distribution can be used instead. The simulation procedure consists of five steps: (1) Derivation of random phases from a white noise time series, (2) Fitting of kappa distribution, (3) Wavelet transform, (4) Inverse wavelet transform, and (5) Transformation to the kappa distribution (or the distribution of choice).
</p>
<p>prsim.weather: Simulation of two variables (temperature and precipitation) for multiple sites in the frequency domain based on the randomization of the phases of the continuous wavelet transform. We combine phase randomization with the flexible, skewed exponential power (sep) and extended generalized pareto distributions (egpd). Alternative theoretical distributions can be used instead. The simulation procedure consists of five steps: (1) Derivation of random phases from a randomly sampled time series, (2) Fitting of temperature and precipitation disstributions, (3) Wavelet transform, (4) Inverse wavelet transform, and (5) Transformation to the desired distributions.
</p>


<h3>Author(s)</h3>

<p>Manuela Brunner [aut, cre]  (&lt;https://orcid.org/0000-0001-8824-877X&gt;), Reinhard Furrer [aut] (&lt;https://orcid.org/0000-0002-6319-2332&gt;), R Core Teamn [ctb, cph] (ks_test.c)
</p>
<p>Maintainer: Manuela Brunner &lt;manuela.brunner@env.ethz.ch&gt;
</p>


<h3>References</h3>

<p>Brunner, M. I., A. Bárdossy, and R. Furrer (2019). Technical note: Stochastic simulation of streamflow time series using phase randomization. Hydrology and Earth System Sciences, 23, 3175-3187, https://doi.org/10.5194/hess-23-3175-2019.
</p>
<p>Brunner, M. I., and E. Gilleland (2020). Stochastic simulation of streamflow and spatial extremes: a continuous, wavelet-based approach, Hydrology and Earth System Sciences, https://doi.org/10.5194/hess-24-3967-2020.
</p>
<p>Brunner, M. I., and E. Gilleland (2021). Spatial compound hot-dry events in the United States: assessment using a multi-site multi-variable weather generator, in preparation.
</p>


<h3>Examples</h3>

<pre><code class="language-R">
demo("PRSim")
demo("PRSim-validate")
demo("PRSim_wave")
demo("PRSim_wave-validate")
demo("PRSim_weather")
demo("PRSim_weather-validate")

</code></pre>


</div>