<div class="container">

<table style="width: 100%;"><tr>
<td>pbsytest</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>Bera, Sosa-Escudero and Yoon Locally–Robust Lagrange Multiplier
Tests for Panel Models and Joint Test by Baltagi and Li</h2>

<h3>Description</h3>

<p>Test for residual serial correlation (or individual random effects)
locally robust vs. individual random effects (serial correlation)
for panel models and joint test of serial correlation and the
random effect specification by Baltagi and Li.
</p>


<h3>Usage</h3>

<pre><code class="language-R">pbsytest(x, ...)

## S3 method for class 'formula'
pbsytest(
  x,
  data,
  ...,
  test = c("ar", "re", "j"),
  re.normal = if (test == "re") TRUE else NULL
)

## S3 method for class 'panelmodel'
pbsytest(
  x,
  test = c("ar", "re", "j"),
  re.normal = if (test == "re") TRUE else NULL,
  ...
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>x</code></td>
<td>
<p>an object of class <code>formula</code> or of class <code>panelmodel</code>,</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>...</code></td>
<td>
<p>further arguments.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>data</code></td>
<td>
<p>a <code>data.frame</code>,</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>test</code></td>
<td>
<p>a character string indicating which test to perform:
first–order serial correlation (<code>"ar"</code>), random effects (<code>"re"</code>)
or joint test for either of them (<code>"j"</code>),</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>re.normal</code></td>
<td>
<p>logical, only relevant for <code>test = "re"</code>: <code>TRUE</code>
(default) computes the one-sided <code>"re"</code> test, <code>FALSE</code> the
two-sided test (see also Details); not relevant for other values of
<code>test</code> and, thus, should be <code>NULL</code>,</p>
</td>
</tr>
</table>
<h3>Details</h3>

<p>These Lagrange multiplier tests are robust vs. local
misspecification of the alternative hypothesis, i.e., they test the
null of serially uncorrelated residuals against AR(1) residuals in
a pooling model, allowing for local departures from the assumption
of no random effects; or they test the null of no random effects
allowing for local departures from the assumption of no serial
correlation in residuals.  They use only the residuals of the
pooled OLS model and correct for local misspecification as outlined
in Bera et al. (2001).
</p>
<p>For <code>test = "re"</code>, the default (<code>re.normal = TRUE</code>) is to compute
a one-sided test which is expected to lead to a more powerful test
(asymptotically N(0,1) distributed).  Setting <code>re.normal = FALSE</code> gives
the two-sided test (asymptotically chi-squared(2) distributed). Argument
<code>re.normal</code> is irrelevant for all other values of <code>test</code>.
</p>
<p>The joint test of serial correlation and the random effect
specification (<code>test = "j"</code>) is due to
Baltagi and Li (1991) (also mentioned in
Baltagi and Li (1995), pp. 135–136) and is added
for convenience under this same function.
</p>
<p>The unbalanced version of all tests are derived in
Sosa-Escudero and Bera (2008). The functions implemented
are suitable for balanced as well as unbalanced panel data sets.
</p>
<p>A concise treatment of the statistics for only balanced panels is
given in Baltagi (2013), p. 108.
</p>
<p>Here is an overview of how the various values of the <code>test</code>
argument relate to the literature:
</p>
 <ul>
<li> <p><code>test = "ar"</code>: </p>
 <ul>
<li> <p><code class="reqn">RS*_{\rho}</code> in Bera
et al. (2001), p. 9 (balanced) </p>
</li>
<li> <p><code class="reqn">LM*_{\rho}</code> in Baltagi (2013), p.
108 (balanced) </p>
</li>
<li> <p><code class="reqn">RS*_{\lambda}</code> in Sosa-Escudero/Bera (2008), p. 73
(unbalanced) </p>
</li>
</ul>
</li>
<li> <p><code style="white-space: pre;">⁠test = "re", re.normal = TRUE⁠</code> (default) (one-sided test,
asymptotically N(0,1) distributed): </p>
 <ul>
<li> <p><code class="reqn">RSO*_{\mu}</code> in Bera
et al. (2001), p. 11 (balanced) </p>
</li>
<li> <p><code class="reqn">RSO*_{\mu}</code> in Sosa-Escudero/Bera
(2008), p. 75 (unbalanced) </p>
</li>
</ul>
</li>
<li> <p><code style="white-space: pre;">⁠test = "re", re.normal = FALSE⁠</code> (two-sided test, asymptotically
chi-squared(2) distributed): </p>
 <ul>
<li> <p><code class="reqn">RS*_{\mu}</code> in Bera et al.
(2001), p. 7 (balanced) </p>
</li>
<li> <p><code class="reqn">LM*_{\mu}</code> in Baltagi (2013), p. 108
(balanced) </p>
</li>
<li> <p><code class="reqn">RS*_{\mu}</code> in Sosa-Escudero/Bera (2008), p. 73
(unbalanced) </p>
</li>
</ul>
</li>
<li> <p><code>test = "j"</code>: </p>
 <ul>
<li> <p><code class="reqn">RS_{\mu\rho}</code> in Bera et al.
(2001), p. 10 (balanced) </p>
</li>
<li> <p><code class="reqn">LM</code> in Baltagi/Li (2001), p. 279
(balanced) </p>
</li>
<li> <p><code class="reqn">LM_{1}</code> in Baltagi and Li (1995), pp. 135–136
(balanced) </p>
</li>
<li> <p><code class="reqn">LM1</code> in Baltagi (2013), p. 108 (balanced) </p>
</li>
<li>
<p><code class="reqn">RS_{\lambda\rho}</code> in Sosa-Escudero/Bera (2008), p. 74 (unbalanced) </p>
</li>
</ul>
</li>
</ul>
<h3>Value</h3>

<p>An object of class <code>"htest"</code>.
</p>


<h3>Author(s)</h3>

<p>Giovanni Millo (initial implementation) &amp; Kevin Tappe (extension to
unbalanced panels)
</p>


<h3>References</h3>

<p>Bera AK, Sosa–Escudero W, Yoon M (2001).
“Tests for the Error Component Model in the Presence of Local Misspecification.”
<em>Journal of Econometrics</em>, <b>101</b>, 1–23.
</p>
<p>Baltagi BH (2013).
<em>Econometric Analysis of Panel Data</em>, 5th edition.
John Wiley and Sons ltd.
</p>
<p>Baltagi B, Li Q (1991).
“A Joint Test for Serial Correlation and Random Individual Effects.”
<em>Statistics and Probability Letters</em>, <b>11</b>, 277–280.
</p>
<p>Baltagi B, Li Q (1995).
“Testing AR(1) Against MA(1) Disturbances in an Error Component Model.”
<em>Journal of Econometrics</em>, <b>68</b>, 133–151.
</p>
<p>Sosa-Escudero W, Bera AK (2008).
“Tests for Unbalanced Error-Components Models under Local Misspecification.”
<em>The Stata Journal</em>, <b>8</b>(1), 68-78.
<a href="https://doi.org/10.1177/1536867X0800800105">doi:10.1177/1536867X0800800105</a>, https://doi.org/10.1177/1536867X0800800105.
</p>


<h3>See Also</h3>

<p><code>plmtest()</code> for individual and/or time random effects
tests based on a correctly specified model; <code>pbltest()</code>,
<code>pbgtest()</code> and <code>pdwtest()</code> for serial correlation tests
in random effects models.
</p>


<h3>Examples</h3>

<pre><code class="language-R">
## Bera et. al (2001), p. 13, table 1 use
## a subset of the original Grunfeld
## data which contains three errors -&gt; construct this subset:
data("Grunfeld", package = "plm")
Grunsubset &lt;- rbind(Grunfeld[1:80, ], Grunfeld[141:160, ])
Grunsubset[Grunsubset$firm == 2 &amp; Grunsubset$year %in% c(1940, 1952), ][["inv"]] &lt;- c(261.6, 645.2)
Grunsubset[Grunsubset$firm == 2 &amp; Grunsubset$year == 1946, ][["capital"]] &lt;- 232.6

## default is AR testing (formula interface)
pbsytest(inv ~ value + capital, data = Grunsubset, index = c("firm", "year"))
pbsytest(inv ~ value + capital, data = Grunsubset, index = c("firm", "year"), test = "re")
pbsytest(inv ~ value + capital, data = Grunsubset, index = c("firm", "year"), 
  test = "re", re.normal = FALSE)
pbsytest(inv ~ value + capital, data = Grunsubset, index = c("firm", "year"), test = "j")

## plm interface
mod &lt;- plm(inv ~ value + capital, data = Grunsubset, model = "pooling")
pbsytest(mod)

</code></pre>


</div>