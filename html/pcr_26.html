<div class="container">

<table style="width: 100%;"><tr>
<td>pcr_test</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>Statistical testing of PCR data</h2>

<h3>Description</h3>

<p>A unified interface to different statistical significance tests for qPCR
data
</p>


<h3>Usage</h3>

<pre><code class="language-R">pcr_test(df, test = "t.test", ...)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>df</code></td>
<td>
<p>A data.frame of <code class="reqn">C_T</code> values with genes in the columns and
samples in rows rows</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>test</code></td>
<td>
<p>A character string; 't.test' default, 'wilcox.test' or 'lm'</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>...</code></td>
<td>
<p>Other arguments for the testing methods</p>
</td>
</tr>
</table>
<h3>Details</h3>

<p>The simple t-test can be used to test the significance of the
difference between two conditions <code class="reqn">\Delta C_T</code>. t-test assumes in
addition, that the input <code class="reqn">C_T</code> values are normally distributed and the
variance between conditions are comparable. Wilcoxon test can be used when
sample size is small and those two last assumptions are hard to achieve.
</p>
<p>Two use the linear regression here. A null hypothesis is formulated as
following,
</p>
<p style="text-align: center;"><code class="reqn">
  C_{T, target, treatment} - C_{T, control, treatment} =
  C_{T, target, control} - C_{T, control, control}
  \quad \textrm{or} \quad  \Delta\Delta C_T
</code>
</p>

<p>This is exactly the <code class="reqn">\Delta\Delta C_T</code> as explained earlier. So the
<code class="reqn">\Delta\Delta C_T</code> is estimated and the null is rejected when
<code class="reqn">\Delta\Delta C_T \ne 0</code>.
</p>


<h3>Value</h3>

<p>A data.frame of 5 columns in addition to term when test == 'lm'
</p>

<ul>
<li>
<p> term The linear regression comparison terms
</p>
</li>
<li>
<p> gene The column names of df. reference_gene is dropped
</p>
</li>
<li>
<p> estimate The estimate for each term
</p>
</li>
<li>
<p> p_value The p-value for each term
</p>
</li>
<li>
<p> lower The low 95% confidence interval
</p>
</li>
<li>
<p> upper The high 95% confidence interval
</p>
</li>
</ul>
<p>For details about the test methods themselves and different parameters,
consult <code>t.test</code>, <code>wilcox.test</code>
and <code>lm</code>
</p>


<h3>References</h3>

<p>Yuan, Joshua S, Ann Reed, Feng Chen, and Neal Stewart. 2006.
“Statistical Analysis of Real-Time PCR Data.” BMC Bioinformatics 7 (85).
BioMed Central. doi:10.1186/1471-2105-7-85.
</p>


<h3>Examples</h3>

<pre><code class="language-R"># locate and read data
fl &lt;- system.file('extdata', 'ct4.csv', package = 'pcr')
ct4 &lt;- read.csv(fl)

# make group variable
group &lt;- rep(c('control', 'treatment'), each = 12)

# test using t-test
pcr_test(ct4,
         group_var = group,
         reference_gene = 'ref',
         reference_group = 'control',
         test = 't.test')

# test using wilcox.test
pcr_test(ct4,
         group_var = group,
         reference_gene = 'ref',
         reference_group = 'control',
         test = 'wilcox.test')

# testing using lm
pcr_test(ct4,
         group_var = group,
         reference_gene = 'ref',
         reference_group = 'control',
         test = 'lm')

# testing advanced designs using a model matrix
# make a model matrix
group &lt;- relevel(factor(group), ref = 'control')
dose &lt;- rep(c(100, 80, 60, 40), each = 3, times = 2)
mm &lt;- model.matrix(~group:dose, data = data.frame(group, dose))

# test using lm
pcr_test(ct4,
         reference_gene = 'ref',
         model_matrix = mm,
         test = 'lm')

# using linear models to check the effect of RNA quality
# make a model matrix
group &lt;- relevel(factor(group), ref = 'control')
set.seed(1234)
quality &lt;- scale(rnorm(n = 24, mean = 1.9, sd = .1))
mm &lt;- model.matrix(~group + group:quality, data = data.frame(group, quality))

# testing using lm
pcr_test(ct4,
         reference_gene = 'ref',
         model_matrix = mm,
         test = 'lm')

# using linear model to check the effects of mixing separate runs
# make a model matrix
group &lt;- relevel(factor(group), ref = 'control')
run &lt;- factor(rep(c(1:3), 8))
mm &lt;- model.matrix(~group + group:run, data = data.frame(group, run))

# test using lm
pcr_test(ct4,
         reference_gene = 'ref',
         model_matrix = mm,
         test = 'lm')

</code></pre>


</div>