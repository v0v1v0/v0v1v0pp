<div class="container">

<table style="width: 100%;"><tr>
<td>relR_samplesize</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>Calculate sample size needed to detect differential transmission</h2>

<h3>Description</h3>

<p>Function for calculating sample size given a set of assumptions. This is the
high level wrapper function that users should call directly.
</p>


<h3>Usage</h3>

<pre><code class="language-R">relR_samplesize(
  R_a,
  R_b,
  p_a,
  N,
  alpha = 0.05,
  alternative = c("two_sided", "less", "greater"),
  power = 0.8,
  sensitivity = 1,
  specificity = 1,
  overdispersion = NULL,
  correct_for_imbalance = FALSE
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>R_a</code></td>
<td>
<p>Numeric (Positive). The assumed R among the group in the
denominator of the ratio. Input value must be greater than 0.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>R_b</code></td>
<td>
<p>Numeric (Positive). The assumed R among the group in the
numerator of the ratio. Input value must be greater than 0.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>p_a</code></td>
<td>
<p>Numeric. The proportion of the population in group <code>a</code>. Must be
between 0 and 1.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>N</code></td>
<td>
<p>Numeric (Positive). The size of the infected pool. Only one of
<code>rho</code> or <code>N</code> should be specified.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>alpha</code></td>
<td>
<p>Numeric. The desired alpha level. Default: 0.05</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>alternative</code></td>
<td>
<p>Character. Specifies the alternative hypothesis.
Must be: <code>two_sided</code> (Default), <code>less</code>, or <code>greater</code></p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>power</code></td>
<td>
<p>Numeric. The desired power. Must be a value between 0 and 1.
Default: 0.8.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>sensitivity</code></td>
<td>
<p>Numeric. The sensitivity of the linkage criteria.
Must be between 0 and 1. Default: 1.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>specificity</code></td>
<td>
<p>Numeric. The specificity of the linkage criteria.
Must be between 0 and 1. Default: 1.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>overdispersion</code></td>
<td>
<p>Numeric (Positive). An overdispersion parameter, set
if the assumed distribution of the number of edges is negative binomial.
If <code>NULL</code> the assumed distribution is Poisson (equivalent to an
overdispersion parameter of infinity) Default: <code>NULL</code> Note that this is
equivalent to setting the overdispersion parameter to <code>Inf</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>correct_for_imbalance</code></td>
<td>
<p>Logical. Should we use simulation to correct
for being over/under powered due to large differences in group sizes?
Default: <code>FALSE</code>.</p>
</td>
</tr>
</table>
<h3>Value</h3>

<p>Sample size needed achieve desired type I and II error rates
under assumptions. Will return <code>NA</code> and throw a warning if impossible.
</p>


<h3>Examples</h3>

<pre><code class="language-R">
## Calculate sample size needed to detect a difference between groups where 
## group A has a reproductive value of 2, group B has a reproductive 
## value of 2.5, the groups are balanced, and the total outbreak size is 
## 1,000

relR_samplesize(R_a = 2, 
                R_b = 2.5, 
                p_a = 0.5,
                N = 1000)

## Update the above calculation to account for imperfect sensitivity = 0.7
relR_samplesize(R_a = 2, 
                R_b = 2.5, 
                p_a = 0.5,
                N = 1000,
                sensitivity = 0.7)

## Update the above calculation to allow for overdispersion
relR_samplesize(R_a = 2, 
                R_b = 2.5, 
                p_a = 0.5,
                N = 1000,
                sensitivity = 0.7,
                overdispersion = 2000)

</code></pre>


</div>