<div class="container">

<table style="width: 100%;"><tr>
<td>ip_op</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>Opportunity of purging</h2>

<h3>Description</h3>

<p>The potential reduction in individual inbreeding load can be
estimated by means of the opportunity of purging (<em>O</em>) and expressed
opportunity of purging (<em>Oe</em>) parameters described by Gulisija
and Crow (2007). Whereas <em>O</em> relates to the total potential reduction
of the inbreeding load in an individual, as a consequence of it having
inbred ancestors, <em>Oe</em> relates to the expressed potential reduction of the
inbreeding load. Only <em>Oe</em> is computed by default. Estimates of <em>O</em>
and <em>Oe</em> need to be corrected in complex pedigrees (see Details below).
Both corrected (named "O" and "Oe" by default), and non-corrected (suffixed
with "_raw") are returned.
</p>


<h3>Usage</h3>

<pre><code class="language-R">ip_op(
  ped,
  name_Oe = "Oe",
  compute_O = FALSE,
  name_O = "O",
  Fcol = NULL,
  ncores = 1L,
  genedrop = 0,
  seed = NULL,
  complex = NULL
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>ped</code></td>
<td>
<p>A dataframe containing the pedigree. Individual (id), maternal (dam), and paternal (sire) identities are mandatory columns.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>name_Oe</code></td>
<td>
<p>A string naming the new output column for the expressed opportunity of purging (defaults to "Oe")</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>compute_O</code></td>
<td>
<p>Enable computation of total opportunity of purging (disabled by default)</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>name_O</code></td>
<td>
<p>A string naming the new output column for total opportunity of purging (defaults to "O")</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>Fcol</code></td>
<td>
<p>Name of column with inbreeding coefficient values. If none is used, inbreeding will be computed.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>ncores</code></td>
<td>
<p>Number of cores to use for parallel computing (default = 1)</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>genedrop</code></td>
<td>
<p>Number of genedrop iterations run to compute partial inbreedng. If set to zero (as default), exact coefficients are computed.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>seed</code></td>
<td>
<p>Sets a seed for the random number generator (only if genedrop is enabled).</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>complex</code></td>
<td>
<p>Enable correction for complex pedigrees (deprecated in v1.3, both raw and corrected measures of "Oe" are returned now).</p>
</td>
</tr>
</table>
<h3>Details</h3>

<p>Model used here assume fully recessive, high effect size alleles (Gulisija and Crow, 2007).
</p>
<p>In simple pedigrees, the opportunity of purging (<em>O</em>) and the expressed
opportunity of purging (<em>Oe</em>) are estimated as in Gulisija and Crow (2007).
For complex pedigrees involving more than one autozygous individual per
path from an individual to an ancestor, <em>O</em> and <em>Oe</em> in the closer ancestors
need to be discounted for what was already accounted for in their predecessors.
To solve this problem, Gulisija and Crow (2007) provide expression to 
correct <em>O</em> and <em>Oe</em> (see equations 21 and 22 in the manuscript). 
</p>
<p>Here, an heuristic approach is used to prevent the inflation of <em>O</em> and <em>Oe</em>,
and avoid the use of additional looped expressions that may result in an
excessive computational cost. To do so, only the contribution of the most recent
ancestors in a path will be considered. Specifically, the method skips contributions
from "far" ancestors <em>k</em>, such that <em>Fj(k) &gt; 0</em>, where <em>j</em> is an intermediate ancestor,
both referred to an individual <em>i</em> of interest. <em>Fj(k)</em> refers to the partial
inbreeding of <em>j</em> for alleles derived from <em>k</em> (see <code>ip_Fij</code>).
This may not provide exact values of <em>O</em> and <em>Oe</em>, but we expect little bias, since
more distant ancestors also contribute lesser to <em>O</em> and <em>Oe</em>.
</p>
<p>Both types of estimates (corrected and non-corrected) are returned (non-corrected
estimates, prefixed with "_raw").
</p>


<h3>Value</h3>

<p>The input dataframe, plus an additional column containing <em>Oe</em> and <em>Oe_raw</em> estimates (additional columns for <em>O</em> can appended by enabling <code>compute_O = TRUE</code>).
</p>


<h3>References</h3>


<ul><li>
<p>Gulisija D, Crow JF. 2007. Inferring purging from pedigree data. Evolution 61(5): 1043-1051.
</p>
</li></ul>
<h3>See Also</h3>

<p><code>ip_Fij</code>
</p>


<h3>Examples</h3>

<pre><code class="language-R"># Original pedigree file in Gulisija &amp; Crow (2007)
pedigree &lt;- tibble::tibble(
  id = c("M", "K", "J", "a", "c", "b", "e", "d", "I"),
  dam = c("0", "0", "0", "K", "M", "a", "c", "c", "e"),
  sire = c("0", "0", "0", "J", "a", "J", "b", "b", "d")
)
pedigree &lt;- purgeR::ped_rename(pedigree, keep_names = TRUE)
ip_op(pedigree, compute_O = TRUE)
</code></pre>


</div>