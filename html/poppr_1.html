<div class="container">

<table style="width: 100%;"><tr>
<td>poppr-package</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>The <span class="pkg">poppr</span> R package</h2>

<h3>Description</h3>

<p><span class="pkg">Poppr</span> provides tools for population genetic analysis that
include genotypic diversity measures, genetic distances with bootstrap
support, native organization and handling of population hierarchies, and
clone correction.
</p>
<p>To cite <span class="pkg">poppr</span>, please use <code>citation("poppr")</code>. When referring to
<span class="pkg">poppr</span> in your manuscript, please use lower case unless it occurs at the
beginning of a sentence.
</p>


<h3>Details</h3>

<p>This package relies on the <span class="pkg">adegenet</span> package.
It is built around the genind and
genlight object. Genind objects store genetic
information in a table of allele frequencies while genlight objects store
SNP data efficiently by packing binary allele calls into single bits.
<span class="pkg">Poppr</span> has extended these object into new objects called
genclone and snpclone,
respectively. These objects are designed for analysis of clonal organisms
as they add the <strong>@mlg</strong> slot for keeping track of multilocus
genotypes and multilocus lineages.
</p>


<h4>Documentation</h4>

<p> Documentation is available for any function by
typing <code>?function_name</code> in the R console. Detailed topic explanations
live in the package vignettes:
</p>

<table>
<tr>
<td style="text-align: left;">
<strong>Vignette</strong>              </td>
<td style="text-align: left;"> <strong>command</strong>
</td>
</tr>
<tr>
<td style="text-align: left;">
Data import and manipulation   </td>
<td style="text-align: left;"> <code>vignette("poppr_manual", "poppr")</code>
</td>
</tr>
<tr>
<td style="text-align: left;">
Algorithms and Equations       </td>
<td style="text-align: left;"> <code>vignette("algo", "poppr")</code>
</td>
</tr>
<tr>
<td style="text-align: left;">
Multilocus Genotype Analysis   </td>
<td style="text-align: left;"> <code>vignette("mlg", "poppr")</code>
</td>
</tr>
</table>
<p>Essential functions for importing and manipulating data are detailed within
the <em>Data import and manipulation</em> vignette, details on algorithms
used in <span class="pkg">poppr</span> are within the <em>Algorithms and equations</em>
vignette, and details for working with multilocus genotypes are in
<em>Multilocus Genotype Analysis</em>.
</p>
<p>Examples of analyses are available in a primer written by Niklaus J.
Grünwald, Zhian N. Kamvar, and Sydney E.  Everhart at
<a href="https://grunwaldlab.github.io/Population_Genetics_in_R/">https://grunwaldlab.github.io/Population_Genetics_in_R/</a>.</p>



<h4>Getting help</h4>

<p> If you have a specific question or issue with
<span class="pkg">poppr</span>, feel free to contribute to the google group at
<a href="https://groups.google.com/d/forum/poppr">https://groups.google.com/d/forum/poppr</a>. If you find a bug and
are a github user, you can submit bug reports at
<a href="https://github.com/grunwaldlab/poppr/issues">https://github.com/grunwaldlab/poppr/issues</a>. Otherwise, leave a
message on the groups. Personal emails are highly discouraged as they do
not allow others to learn.</p>



<h3>Functions in <span class="pkg">poppr</span>
</h3>

<p>Below are descriptions and links to functions found in <span class="pkg">poppr</span>. Be
aware that all functions in <span class="pkg">adegenet</span> are also
available. The functions are documented as:
</p>

<ul><li> <p><code>function_name()</code> (data type) - Description
</p>
</li></ul>
<p>Where ‘data type’ refers to the type of data that can be used:
</p>

<table>
<tr>
<td style="text-align: left;">
<strong>m</strong> </td>
<td style="text-align: left;"> a genclone or genind object </td>
</tr>
<tr>
<td style="text-align: left;">
<strong>s</strong> </td>
<td style="text-align: left;"> a snpclone or genlight object </td>
</tr>
<tr>
<td style="text-align: left;">
<strong>x</strong> </td>
<td style="text-align: left;"> a different data type (e.g. a matrix from <code>mlg.table()</code>)
</td>
</tr>
</table>
<h3>Data import/export</h3>


<ul>
<li> <p><code>getfile()</code> (x) - Provides a quick GUI to grab files for import
</p>
</li>
<li> <p><code>read.genalex()</code> (x) - Reads GenAlEx formatted csv files to a genind object
</p>
</li>
<li> <p><code>genind2genalex()</code> (m) - Converts genind objects to GenAlEx formatted csv files
</p>
</li>
<li> <p><code>genclone2genind()</code> (m) - Removes the @mlg slot from genclone objects
</p>
</li>
<li> <p><code>as.genambig()</code> (m) - Converts genind data to <span class="pkg">polysat</span>'s genambig data structure.
</p>
</li>
<li> <p><code>bootgen2genind()</code> (x) - see <code>aboot()</code> for details)
</p>
</li>
</ul>
<h3>Data Structures</h3>

<p>Data structures "genclone" (based off of adegenet's genind) and
"snpclone" (based off of adegenet's genlight for large SNP data sets).
Both of these data structures are defined by the presence of an extra
MLG slot representing multilocus genotype assignments, which can be a numeric
vector or a MLG class object.
</p>

<ul>
<li> <p>genclone - Handles microsatellite, presence/absence, and small SNP data sets
</p>
</li>
<li> <p>snpclone - Designed to handle larger binary SNP data sets.
</p>
</li>
<li> <p>MLG - An internal class holding a data frame of multilocus genotype
assignments that acts like a vector, allowing the user to easily switch
between different MLG definitions.
</p>
</li>
<li> <p>bootgen - An internal class used explicitly for <code>aboot()</code> that
inherits the gen-class virtual object. It is
designed to allow for sampling loci with replacement.
</p>
</li>
<li> <p>bruvomat - An internal class designed to handle bootstrapping for
Bruvo's distance where blocks of integer loci can be shuffled.
</p>
</li>
</ul>
<h3>Data manipulation</h3>


<ul>
<li> <p><code>as.genclone()</code> (m) - Converts genind objects to genclone objects
</p>
</li>
<li> <p><code>missingno()</code> (m) - Handles missing data
</p>
</li>
<li> <p><code>clonecorrect()</code> (m | s) - Clone-censors at a specified population hierarchy
</p>
</li>
<li> <p><code>informloci()</code> (m) - Detects and removes phylogenetically uninformative loci
</p>
</li>
<li> <p><code>popsub()</code> (m | s) - Subsets genind objects by population
</p>
</li>
<li> <p><code>shufflepop()</code> (m) - Shuffles genotypes at each locus using four different shuffling algorithms
</p>
</li>
<li> <p><code>recode_polyploids()</code> (m | x) - Recodes polyploid data sets with missing alleles imported as "0"
</p>
</li>
<li> <p><code>make_haplotypes()</code> (m | s) - Splits data into pseudo-haplotypes. This is mainly used in AMOVA.
</p>
</li>
<li> <p><code>test_replen()</code> (m) - Tests for inconsistent repeat lengths in microsatellite data. For use in <code>bruvo.dist()</code> functions.
</p>
</li>
<li> <p><code>fix_replen()</code> (m) - Fixes inconsistent repeat lengths. For use in <code>bruvo.dist()</code> functions.
</p>
</li>
</ul>
<h3>Genetic distances</h3>


<ul>
<li> <p><code>bruvo.dist()</code> (m) - Bruvo's distance (see also: <code>fix_replen()</code>)
</p>
</li>
<li> <p><code>diss.dist()</code> (m) - Absolute genetic distance (see <code>prevosti.dist()</code>)
</p>
</li>
<li> <p><code>nei.dist()</code> (m | x) - Nei's 1978 genetic distance
</p>
</li>
<li> <p><code>rogers.dist()</code> (m | x) - Rogers' euclidean distance
</p>
</li>
<li> <p><code>reynolds.dist()</code> (m | x) - Reynolds' coancestry distance
</p>
</li>
<li> <p><code>edwards.dist()</code> (m | x) - Edwards' angular distance
</p>
</li>
<li> <p><code>prevosti.dist()</code> (m | x) - Prevosti's absolute genetic distance
</p>
</li>
<li> <p><code>bitwise.dist()</code> (s) - Calculates fast pairwise distances for genlight objects.
</p>
</li>
</ul>
<h3>Bootstrapping</h3>


<ul>
<li> <p><code>aboot()</code> (m | s | x) - Creates a bootstrapped dendrogram for any distance measure
</p>
</li>
<li> <p><code>bruvo.boot()</code> (m) - Produces dendrograms with bootstrap support based on Bruvo's distance
</p>
</li>
<li> <p><code>diversity_boot()</code> (x) - Generates boostrap distributions of diversity statistics for multilocus genotypes
</p>
</li>
<li> <p><code>diversity_ci()</code> (m | s | x) - Generates confidence intervals for multilocus genotype diversity.
</p>
</li>
<li> <p><code>resample.ia()</code> (m) - Calculates the index of association over subsets of data.
</p>
</li>
</ul>
<h3>Multilocus Genotypes</h3>


<ul>
<li> <p><code>mlg()</code> (m | s) - Calculates the number of multilocus genotypes
</p>
</li>
<li> <p><code>mll()</code> (m | s) - Displays the current multilocus lineages (genotypes) defined.
</p>
</li>
<li> <p><code>nmll()</code> (m | s) - Same as <code>mlg()</code>.
</p>
</li>
<li> <p><code>mlg.crosspop()</code> (m | s) - Finds all multilocus genotypes that cross populations
</p>
</li>
<li> <p><code>mlg.table()</code> (m | s) - Returns a table of populations by multilocus genotypes
</p>
</li>
<li> <p><code>mlg.vector()</code> (m | s) - Returns a vector of a numeric multilocus genotype assignment for each individual
</p>
</li>
<li> <p><code>mlg.id()</code> (m | s) - Finds all individuals associated with a single multilocus genotype
</p>
</li>
<li> <p><code>mlg.filter()</code> (m | s) - Collapses MLGs by genetic distance
</p>
</li>
<li> <p><code>filter_stats()</code> (m | s) - Calculates mlg.filter for all algorithms and plots
</p>
</li>
<li> <p><code>cutoff_predictor()</code> (x) - Predicts cutoff threshold from mlg.filter.
</p>
</li>
<li> <p><code>mll.custom()</code> (m | s) - Allows for the custom definition of multilocus lineages
</p>
</li>
<li> <p><code>mll.levels()</code> (m | s) - Allows the user to change levels of custom MLLs.
</p>
</li>
<li> <p><code>mll.reset()</code> (m | s) - Reset multilocus lineages.
</p>
</li>
<li> <p><code>diversity_stats()</code> (x) - Creates a table of diversity indices for multilocus genotypes.
</p>
</li>
</ul>
<h3>Index of Association Analysis</h3>

<p>Analysis of multilocus linkage disequilibrium.
</p>

<ul>
<li> <p><code>ia()</code> (m) - Calculates the index of association
</p>
</li>
<li> <p><code>pair.ia()</code> (m) - Calculates the index of association for all loci pairs.
</p>
</li>
<li> <p><code>win.ia()</code> (s) - Index of association windows for genlight objects.
</p>
</li>
<li> <p><code>samp.ia()</code> (s) - Index of association on random subsets of loci for genlight objects.
</p>
</li>
</ul>
<h3>Population Genetic Analysis</h3>


<ul>
<li> <p><code>poppr.amova()</code> (m | s) - Analysis of Molecular Variance (as implemented in ade4)
</p>
</li>
<li> <p><code>poppr()</code> (m | x) - Returns a diversity table by population
</p>
</li>
<li> <p><code>poppr.all()</code> (m | x) - Returns a diversity table by population for all compatible files specified
</p>
</li>
<li> <p><code>private_alleles()</code> (m) - Tabulates the occurrences of alleles that only occur in one population.
</p>
</li>
<li> <p><code>locus_table()</code> (m) - Creates a table of summary statistics per locus.
</p>
</li>
<li> <p><code>rrmlg()</code> (m | x) - Round-robin multilocus genotype estimates.
</p>
</li>
<li> <p><code>rraf()</code> (m) - Round-robin allele frequency estimates.
</p>
</li>
<li> <p><code>pgen()</code> (m) - Probability of genotypes.
</p>
</li>
<li> <p><code>psex()</code> (m) - Probability of observing a genotype more than once.
</p>
</li>
<li> <p>rare_allele_correction (m) - rules for correcting rare alleles for round-robin estimates.
</p>
</li>
<li> <p><code>incomp()</code> (m) - Check data for incomparable samples.
</p>
</li>
</ul>
<h3>Visualization</h3>


<ul>
<li> <p><code>imsn()</code> (m | s) - Interactive construction and visualization of minimum spanning networks
</p>
</li>
<li> <p><code>plot_poppr_msn()</code> (m | s | x) - Plots minimum spanning networks produced in poppr with scale bar and legend
</p>
</li>
<li> <p><code>greycurve()</code> (x) - Helper to determine the appropriate parameters for adjusting the grey level for msn functions
</p>
</li>
<li> <p><code>bruvo.msn()</code> (m) - Produces minimum spanning networks based off Bruvo's distance colored by population
</p>
</li>
<li> <p><code>poppr.msn()</code> (m | s | x) - Produces a minimum spanning network for any pairwise distance matrix related to the data
</p>
</li>
<li> <p><code>info_table()</code> (m) - Creates a heatmap representing missing data or observed ploidy
</p>
</li>
<li> <p><code>genotype_curve()</code> (m | x) - Creates a series of boxplots to demonstrate how many markers are needed to represent the diversity of your data.
</p>
</li>
</ul>
<h3>Datasets</h3>


<ul>
<li> <p><code>Aeut()</code> - (AFLP) Oomycete root rot pathogen <em>Aphanomyces euteiches</em> (Grünwald and Hoheisel, 2006)
</p>
</li>
<li> <p><code>monpop()</code> - (SSR) Peach brown rot pathogen <em>Monilinia fructicola</em> (Everhart and Scherm, 2015)
</p>
</li>
<li> <p><code>partial_clone()</code> - (SSR) partially-clonal data simulated via simuPOP (Peng and Amos, 2008)
</p>
</li>
<li> <p><code>Pinf()</code> - (SSR) Potato late blight pathogen <em>Phytophthora infestans</em> (Goss et. al., 2014)
</p>
</li>
<li> <p><code>Pram()</code> - (SSR) Sudden Oak Death pathogen <em>Phytophthora ramorum</em> (Kamvar et. al., 2015; Goss et. al., 2009)
</p>
</li>
</ul>
<h3>Author(s)</h3>

<p>Zhian N. Kamvar, Jonah C. Brooks, Sydney E. Everhart, Javier F.
Tabima, Stacy Krueger-Hadfield, Erik Sotka, Niklaus J. Grünwald
</p>
<p>Maintainer: Zhian N. Kamvar
</p>


<h3>References</h3>

<p>——— Papers announcing poppr ———
</p>
<p>Kamvar ZN, Tabima JF, Grünwald NJ. (2014) Poppr: an R package for genetic
analysis of populations with clonal, partially clonal, and/or sexual
reproduction. PeerJ 2:e281 <a href="https://doi.org/10.7717/peerj.281">doi:10.7717/peerj.281</a>
</p>
<p>Kamvar ZN, Brooks JC and Grünwald NJ (2015) Novel R tools for analysis of
genome-wide population genetic data with emphasis on clonality. Front. Genet.
6:208. <a href="https://doi.org/10.3389/fgene.2015.00208">doi:10.3389/fgene.2015.00208</a>
</p>
<p>——— Papers referencing data sets ———
</p>
<p>Grünwald, NJ and Hoheisel, G.A. 2006. Hierarchical Analysis of Diversity,
Selfing, and Genetic Differentiation in Populations of the Oomycete
<em>Aphanomyces euteiches</em>. Phytopathology 96:1134-1141 doi:
<a href="https://doi.org/10.1094/PHYTO-96-1134">doi:10.1094/PHYTO-96-1134</a>
</p>
<p>SE Everhart, H Scherm, (2015) Fine-scale genetic structure of <em>Monilinia
fructicola</em> during brown rot epidemics within individual peach tree canopies.
Phytopathology 105:542-549 doi:
<a href="https://doi.org/10.1094/PHYTO-03-14-0088-R">doi:10.1094/PHYTO-03-14-0088-R</a>
</p>
<p>Bo Peng and Christopher Amos (2008) Forward-time simulations of nonrandom
mating populations using simuPOP. <em>bioinformatics</em>, 24 (11): 1408-1409.
</p>
<p>Goss, Erica M., Javier F. Tabima, David EL Cooke, Silvia Restrepo, William E.
Fry, Gregory A. Forbes, Valerie J. Fieland, Martha Cardenas, and Niklaus J.
Grünwald. (2014) "The Irish potato famine pathogen <em>Phytophthora
infestans</em> originated in central Mexico rather than the Andes." Proceedings
of the National Academy of Sciences 111:8791-8796. doi:
<a href="https://doi.org/10.1073/pnas.1401884111">doi:10.1073/pnas.1401884111</a>
</p>
<p>Kamvar, Z. N., Larsen, M. M., Kanaskie, A. M., Hansen, E. M., &amp; Grünwald, N.
J. (2015). Spatial and temporal analysis of populations of the sudden oak
death pathogen in Oregon forests. Phytopathology 105:982-989. doi:
<a href="https://doi.org/10.1094/PHYTO-12-14-0350-FI">doi:10.1094/PHYTO-12-14-0350-FI</a>
</p>
<p>Goss, E. M., Larsen, M., Chastagner, G. A., Givens, D. R., and Grünwald, N.
J. 2009. Population genetic analysis infers migration pathways of
<em>Phytophthora ramorum</em> in US nurseries. PLoS Pathog. 5:e1000583. doi:
<a href="https://doi.org/10.1371/journal.ppat.1000583">doi:10.1371/journal.ppat.1000583</a>
</p>


</div>