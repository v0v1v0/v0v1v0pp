<div class="container">

<table style="width: 100%;"><tr>
<td>bmPlot</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>Simulates and visualizes discrete-time Brownian evolution on a phylogeny</h2>

<h3>Description</h3>

<p>Conducts a discrete-time Brownian motion simulation on an input tree, plots the outcome, and returns the tip and internal node states to the user as a named vector. 
</p>


<h3>Usage</h3>

<pre><code class="language-R">bmPlot(tree, type="BM", anc=0, sig2=1/1000, ngen=1000, ...)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>tree</code></td>
<td>
<p>a phylogenetic tree in <code>"phylo"</code> format.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>type</code></td>
<td>
<p>the type of plot to create. See Description.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>anc</code></td>
<td>
<p>the ancestral value for the root node.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>sig2</code></td>
<td>
<p>the BM rate (variance of the Brownian evolution process), <code class="reqn">\sigma^2</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>ngen</code></td>
<td>
<p>number of generations for the simulation: will rescale the tree to this total length.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>...</code></td>
<td>
<p>arguments to be passed to different methods.</p>
</td>
</tr>
</table>
<h3>Details</h3>

<p>The function will first rescale and round the branch lengths to integer length, if they are not already in integer values. If integer branch lengths are provided, the user should also set <code>ngen</code> to be equal to the total height of the tree in generations (and thus avoid rescaling). 
</p>
<p>For <code>type="threshold"</code> the visualization is of the threshold model (Felsenstein 2012), in which the evolving character is liability and the segments of evolution are colored by their value for the threshold trait. If <code>type="threshold"</code> is used, the function requires at least one addition input: <code>thresholds</code>, a vector containing the ordered thresholds between states. The user can also provide the colors for plotting in <code>colors</code>. Note that one more color than threshold should be provided as one threshold implies two states; two thresholds, three states; etc. If no value for <code>colors</code> is provided, the function will recycle a set of four colors up to the number of times required by <code>thresholds</code>. Finally, the optional argument <code>return.tree=TRUE</code> will tell the function to return a list with the tip and note states and an object of class <code>"phylo"</code> with (for <code>type="threshold"</code>), the state for the threshold model through time mapped on the branches of the tree in discrete time.
</p>


<h3>Value</h3>

<p>This function conducts and plots discrete time Brownian simulation and returns a vector containing the simulated states at internal nodes and tips of the tree. 
</p>
<p>It also returns, by default (although this can be turned off) a tree with the branch lengths in discrete time and with a mapped discrete character (for <code>type="threshold"</code>).
</p>


<h3>Author(s)</h3>

<p>Liam Revell <a href="mailto:liam.revell@umb.edu">liam.revell@umb.edu</a></p>


<h3>References</h3>

<p>Felsenstein, J. (2012) A comparative method for both discrete and continuous characters using the threshold model. <em>American Naturalist</em>, <b>179</b>, 145-156.
</p>
<p>Revell, L. J. (2014) Ancestral character estimation under the threshold model from quantitative genetics. <em>Evolution</em>, <b>68</b>, 743-759.
</p>
<p>Revell, L. J. (2024) phytools 2.0: an updated R ecosystem for phylogenetic comparative methods (and other things). <em>PeerJ</em>, <b>12</b>, e16505.
</p>


<h3>See Also</h3>

<p><code>fastBM</code>, <code>pbtree</code>, <code>phenogram</code>, <code>threshBayes</code>
</p>


<h3>Examples</h3>

<pre><code class="language-R">set.seed(999)
## plot BM simulation on 12 taxon tree
tree&lt;-pbtree(n=12)
par(mfrow=c(1,2),mar=c(5.1,4.1,4.1,0.1))
x&lt;-bmPlot(tree,bty="l")
plotTree(tree,direction="upwards",
    mar=c(5.1,0.1,4.1,1.1),ftype="off")
## reset par to default values
par(mfrow=c(1,1),mar=c(5.1,4.1,4.1,2.1))
## plot simulation of a threshold character
par(mfrow=c(1,2),mar=c(5.1,4.1,4.1,0.1))
tt&lt;-bmPlot(tree,type="threshold",thresholds=c(0,1,2),
    bty="l")
plot(tt$tree,direction="upwards",
    mar=c(5.1,0.1,4.1,1.1),ftype="off",
    colors=setNames(c("black","red","blue"),
    letters[1:3]),lwd=3)
## reset par to default values
par(mfrow=c(1,1),mar=c(5.1,4.1,4.1,2.1))
</code></pre>


</div>