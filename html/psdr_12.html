<div class="container">

<table style="width: 100%;"><tr>
<td>MakePowerSpectralDensity</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>Create a power spectral density (PSD) plot using time series data</h2>

<h3>Description</h3>

<p>Dividing the results of fft() by the frequency bin width, the PSD of a time
series data set can be calculated.
</p>


<h3>Usage</h3>

<pre><code class="language-R">MakePowerSpectralDensity(sampling_frequency, data_vector)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>sampling_frequency</code></td>
<td>
<p>Numeric value specifying sampling frequency in hertz. If data is sampled once every second, then sampling frequency is 1 Hz. If data is sampled once every 2 seconds, then sampling frequency is 0.5 Hz.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>data_vector</code></td>
<td>
<p>Vector of numeric values. Time series vector of data.</p>
</td>
</tr>
</table>
<h3>Details</h3>

<p>If time series is a vector of accelerometer data, then the outputted y-axis will
have units of (acceleration^2)/Hz.
</p>
<p>Explanations of some of the math:
https://www.mathworks.com/help/signal/ug/power-spectral-density-estimates-using-fft.html
</p>
<p>https://blog.endaq.com/why-the-power-spectral-density-psd-is-the-gold-standard-of-vibration-analysis
</p>
<p>https://endaq.com/pages/power-spectral-density
</p>
<p>https://medium.com/analytics-vidhya/breaking-down-confusions-over-fast-fourier-transform-fft-1561a029b1ab
</p>


<h3>Value</h3>

<p>A List with two objects:
</p>

<ol>
<li>
<p> Vector of frequencies in Hz. The maximum frequency should be half the sampling frequency. Called Nyquist Frequency.
</p>
</li>
<li>
<p> Vector of PSD values corresponding with each frequency. Units should be in the original units of the data vector squared and divided by frequency.
</p>
</li>
</ol>
<p>The vector of frequencies can be used as the x-axis values of a single sided spectrum amplitude plot.
The vector of PSD values can be used as the y-axis values of the PSD plot.
</p>


<h3>Examples</h3>

<pre><code class="language-R">#Create a vector of time that represent times where data are sampled.
Fs = 100; #sampling frequency in Hz
T = 1/Fs; #sampling period
L = 1000; #length of time vector
t = (0:(L-1))*T; #time vector

#Form a signal (time series) that contains two frequencies:
#1. 10 Hz with amplitude of 1
#2. 25 Hz with amplitude of 2
S &lt;- 1*sin(2*pi*10*t) + 2*sin(2*pi*25*t);

results &lt;- MakePowerSpectralDensity(Fs, S)

frequencies &lt;- results[[1]]

PSD &lt;- results[[2]]

#dev.new()
plot(frequencies, PSD, type = "l")


</code></pre>


</div>