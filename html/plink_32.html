<div class="container">

<table style="width: 100%;"><tr>
<td>gpcm-methods</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>Generalized Partial Credit Model Response Probabilities</h2>

<h3>Description</h3>

<p>This function computes the probability of responding in a specific category for one or 
more items for a given set of theta values using the partial credit model, generalized 
partial credit model, or multidimensional extension of these models, depending 
on the included item parameters and the specified number of dimensions.
</p>


<h3>Usage</h3>

<pre><code class="language-R">gpcm(x, cat, theta, dimensions = 1, D = 1, location = FALSE, 
  print.mod = FALSE, items, information = FALSE, angle, ...)

## S4 method for signature 'matrix', 'numeric'
gpcm(x, cat, theta, dimensions, D, location, print.mod, items, information, angle, ...)

## S4 method for signature 'data.frame', 'numeric'
gpcm(x, cat, theta, dimensions, D, location, print.mod, items, information, angle, ...)

## S4 method for signature 'list', 'numeric'
gpcm(x, cat, theta, dimensions, D, location, print.mod, items, information, angle, ...)

## S4 method for signature 'irt.pars', 'ANY'
gpcm(x, cat, theta, dimensions, D, location, print.mod, items, information, angle, ...)

## S4 method for signature 'sep.pars', 'ANY'
gpcm(x, cat, theta, dimensions, D, location, print.mod, items, information, angle, ...)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>x</code></td>
<td>
<p>an <code>R</code> object containing item parameters </p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>cat</code></td>
<td>
<p>vector identifying the number of response categories (not the number of step
parameters) for each item. </p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>theta</code></td>
<td>
<p>vector, matrix, or list of theta values for which probabilities will be computed. 
If <code>theta</code> is not specified, an equal interval range of values from -4 to 4 is used 
with an increment of 0.5. See details below for more information. </p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>dimensions</code></td>
<td>
<p>number of modeled dimensions </p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>D</code></td>
<td>
<p>scaling constant. The default value assumes that the parameters are already in the 
desired metric. If the parameters are in the logistic metric, they can be transformed to a 
normal metric by setting D = 1.7</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>location</code></td>
<td>
<p>if <code>TRUE</code>, the step parameters are deviations from a difficulty
parameter </p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>print.mod</code></td>
<td>
<p>if <code>TRUE</code>, print the model that was used (i.e., Partial Credit
Model, Generalized Partial Credit Model, Multidimensional Partial Credit
Model or Multidimensional Generalized Partial Credit Model) </p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>items</code></td>
<td>
<p>numeric vector identifying the items for which probabilities should be computed</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>information</code></td>
<td>
<p>logical value. If <code>TRUE</code> compute item information. In the multidimensional
case, information will be computed in the directions specified by <code>angle</code> or default angles
of 0 - 90 in increments of 10 degrees.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>angle</code></td>
<td>
<p>vector or matrix of angles between the dimension 1 axis and the corresponding axes for each 
of the other dimensions for which information will be computed. When there are more than two dimensions 
and <code>angle</code> is a vector, the same set of angles will be used relative to each of the corresponding axes.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>...</code></td>
<td>
<p>further arguments passed to or from other methods </p>
</td>
</tr>
</table>
<h3>Details</h3>

<p><code>theta</code> can be specified as a vector, matrix, or list.  For the unidimensional case, <code>theta</code>
should be a vector. If a matrix or list of values is supplied, they will be converted to a single vector
of theta values.  For the multidimensional case, if a vector of values is supplied it will be assumed
that this same set of values should be used for each dimension.  Probabilities will be computed for each
combination of theta values.  Similarly, if a list is supplied, probabilities will be computed for each
combination of theta values.  In instances where probabilities are desired for specific combinations of 
theta values, a j x m matrix should be specified for j ability points and m dimensions where the columns 
are ordered from dimension 1 to m.
</p>


<h3>Value</h3>

<p>Returns an object of class <code>irt.prob</code>
</p>


<h3>Methods</h3>

<p>In the following description, references to the partial credit model and generalized
partial credit model should be thought of as encompassing both the unidimensional and 
multidimensional models.
</p>

<dl>
<dt>x = "matrix", cat = "numeric"</dt>
<dd>
<p>This method allows one to specify an n x k 
matrix for n items.  The number of columns can vary depending on the model 
(partial credit or generalized partial credit model), number of dimensions, and 
whether a location parameter is included.  Generally, the first m columns, for m
dimensions, are for item slopes and the remaining columns are for step parameters.
</p>

<dl>
<dt>Slope Parameters:</dt>
<dd>
<p>The partial credit model is typically specified with 
all slopes equal to 1.  For this model it is unnecessary (although optional) to 
include ones in the first m columns.  For slope values other than one (equal for 
all items) or for the generalized partial credit model, slope parameters should 
be included in the first m columns.</p>
</dd>
<dt>Step/Step Deviation Parameters:</dt>
<dd>
<p>Step parameters can be characterized in
two ways: as the actual steps or deviations from an overall item difficulty
(location).  In the deviation scenario the <code>location</code> argument should be 
equal to <code>TRUE</code>.  If column(s) are included for the slope parameters, 
the location parameters should be in the m+1 column; otherwise, they should be 
in the first column.  The columns for the step/step deviation parameters will always
follow the slope and/or location columns (or they may potentially 
start in the first column for the partial credit model with no location parameter).
</p>
<p>The number of step/step deviation parameters can vary for each item.  In these
instances, all cells with missing values should be filled with <code>NA</code>s.  For
example, for a unidimensional generalized partial credit model with no location 
parameter, if one item has five categories (four step parameters) and another item 
has three categories (two step parameters), there should be five columns.  The first 
column includes the slope parameters and columns 2-5 include the step parameters.
The values in the last two columns for the item with three categories should be <code>NA</code>.</p>
</dd>
</dl>
</dd>
<dt>x = "data.frame", cat = "numeric"</dt>
<dd>
<p>See the method for x = "matrix" </p>
</dd>
<dt>x = "list", cat = "numeric"</dt>
<dd>
<p>This method can include a list with one or two
elements. Generally, the first element is for item slopes and the second is
for step/step deviation parameters. 
</p>

<dl>
<dt>Slope Parameters:</dt>
<dd>
<p>For the partial credit model with all slopes equal to 1 it is 
unnecessary (although optional) to include a list element for the item slopes.  If no 
slope values are included, the first element would contain the step/deviation step 
parameters.  For slopes other than 1 (equal for all items) or for the generalized partial 
credit model, slope values should be included in the first list element.  For the 
unidimensional case, these values should be a vector of length n or an n x 1 matrix for 
n items. For the multidimensional case, an n x m matrix of values for m dimensions 
should be supplied</p>
</dd>
<dt>Step/Step Deviation Parameters:</dt>
<dd>
<p>The step/step deviation parameters should be 
formatted as an n x k matrix for n items.  If the steps are deviations from a location 
parameter, the argument <code>location</code> should equal <code>TRUE</code> and the location 
parameters should be in the first column.  The number of step/step deviation parameters 
can vary for each item.  In these instances, all cells with missing values should be 
filled with <code>NA</code>s (See the example in the method for x = "matrix"). </p>
</dd>
</dl>
</dd>
<dt>x = "irt.pars", cat = "ANY"</dt>
<dd>
<p>This method can be used to compute probabilities 
for the gpcm items in an object of class <code>"irt.pars"</code>.  If <code>x</code> contains 
dichotomous items or items associated with another polytomous model, a warning 
will be displayed stating that probabilities will be computed for the gpcm items only. 
If <code>x</code> contains parameters for multiple groups, a list of <code>"irt.prob"</code> objects 
will be returned. The argument <code>dimensions</code> does not need to be included for this method.</p>
</dd>
<dt>x = "sep.pars", cat = "ANY"</dt>
<dd>
<p>This method can be used to compute probabilities 
for the gpcm items in an object of class <code>sep.pars</code>.  If <code>x</code> contains 
dichotomous items or items associated with another polytomous model, a warning will be 
displayed stating that probabilities will be computed for the gpcm items only. The argument 
<code>dimensions</code> does not need to be included for this method.</p>
</dd>
</dl>
<h3>Note</h3>

 
<p>The determination of the model (partial credit or generalized partial credit) is based on
the number of non-NA columns for each item in <code>x</code> and the corresponding values in
<code>cat</code>.
</p>


<h3>Author(s)</h3>

<p> Jonathan P. Weeks <a href="mailto:weeksjp@gmail.com">weeksjp@gmail.com</a> </p>


<h3>References</h3>

 
<p>Adams, R. J., Wilson, M., &amp; Wang, W. (1997).
The multidimensional random coefficients multinomial logit model.
<em>Applied Psychological Measurement</em>, <em>21</em>(1), 1-23.
</p>
<p>Embretson, S. E., &amp; Reise, S. P. (2000).
<em>Item Response Theory for Psychologists.</em>
Mahwah, New Jersey: Lawrence Erlbaum Associates.
</p>
<p>Masters, G. N. (1982).
A rasch model for partial credit scoring.
<em>Psychometrika</em>, <em>47</em>(2), 149-174.
</p>
<p>Masters, G. N. &amp; Wright, B. D. (1996)
The partial credit model.
In W. J. van der Linden &amp; Hambleton, R. K. (Eds.) 
<em>Handbook of Modern Item Response Theory</em> (pp. 101-121). 
New York: Springer-Verlag.
</p>
<p>Muraki, E. (1992)
A generalized partial credit model: Application of an EM algorithm.
<em>Applied Psychological Measurement</em>, <em>16</em>(2), 159-176.
</p>
<p>Muraki, E. (1996)
A generalized partial credit model.
In W. J. van der Linden &amp; Hambleton, R. K. (Eds.) 
<em>Handbook of Modern Item Response Theory</em> (pp. 153-164). 
New York: Springer-Verlag.
</p>
<p>Weeks, J. P. (2010) 
<b>plink</b>: An R package for linking mixed-format tests using IRT-based methods. 
<em>Journal of Statistical Software</em>, <b>35(12)</b>, 1–33. 
URL <a href="http://www.jstatsoft.org/v35/i12/">http://www.jstatsoft.org/v35/i12/</a>
</p>
<p>Yao, L. (2003). 
BMIRT: Bayesian multivariate item response theory [Computer Program]. 
Monterey, CA: CTB/McGraw-Hill.	
</p>
<p>Yao, L., &amp; Schwarz, R. D. (2006). 
A multidimensional partial credit model with associated item and test statistics: 
An application to mixed-format tests. 
<em>Applied Psychological Measurement</em>, <em>30</em>(6), 469-492.
</p>


<h3>See Also</h3>

 
<p><code>mixed:</code> compute probabilities for mixed-format items<br><code>plot:</code> plot item characteristic/category curves<br><code>irt.prob</code>, <code>irt.pars</code>, <code>sep.pars:</code> classes
</p>


<h3>Examples</h3>

<pre><code class="language-R">###### Unidimensional Examples ######
## Partial Credit Model
## Item parameters from Embretson &amp; Reise (2000, p. 108) item 5
b &lt;- t(c(-2.519,-.063,.17,2.055))
x &lt;- gpcm(b,5)
plot(x) 

## Generalized Partial Credit Model
## Item parameters from Embretson &amp; Reise (2000, p. 112) items 5-7
a &lt;- c(.683,1.073,.583)
b &lt;- matrix(c(-3.513,-.041,.182,NA,-.873,.358,-.226,
  1.547,-4.493,-.004,NA,NA),3,4,byrow=TRUE)
pars &lt;- cbind(a,b) # Does not include a location parameter
rownames(pars) &lt;- paste("Item",5:7,sep="") 
colnames(pars) &lt;- c("a",paste("b",1:4,sep=""))
cat &lt;- c(4,5,3)
x &lt;- gpcm(pars,cat,seq(-3,3,.05))
plot(x)

## Item parameters from Muraki (1996, p. 154)
a &lt;- c(1,.5)
b &lt;- matrix(c(.25,-1.75,1.75,.75,-1.25,1.25),2,3,byrow=TRUE)
pars &lt;- cbind(a,b) # Include a location parameter
rownames(pars) &lt;- paste("Item",1:2,sep="")
colnames(pars) &lt;- c("a","b",paste("d",1:2,sep=""))
cat &lt;- c(3,3)
x &lt;- gpcm(pars,cat,location=TRUE,print.mod=TRUE, D=1.7)
# Plot category curves for two items
matplot(x@prob$theta,x@prob[,2:4],xlab="Theta",ylab="Probability",
  ylim=c(0,1),lty=1,type="l",col="black") 
par(new=TRUE)
matplot(x@prob$theta,x@prob[,5:7],xlab="Theta",ylab="Probability",
  ylim=c(0,1),lty=3,type="l",col="black") 


###### Multidimensional Examples ######
## Multidimensional Partial Credit Model
pars &lt;- matrix(c(2.4207,0.245,-1.1041,NA,
2.173,-0.4576,NA,NA,
2.1103,-0.8227,.4504,NA,
3.2023,1.0251,-.7837,-1.3062),4,4,byrow=TRUE)
cat &lt;- c(4,3,4,5)
x &lt;- gpcm(pars,cat,dimensions=2,print.mod=TRUE)
# plot combined item category surfaces
# The screen argument adjusts the orientation of the axes
plot(x,screen=list(z=-60,x=-70))

## Multidimensional Generalized Partial Credit Model
a &lt;- matrix(c(.873, .226, .516, .380, .613, .286 ),3,2,byrow=TRUE)
b &lt;- matrix(c(2.255, 1.334, -.503, -2.051, -3.082,
1.917, 1.074, -.497, -1.521, -2.589,
1.624, .994, -.656, -1.978, NA),3,5,byrow=TRUE)
pars &lt;- cbind(a,b)
cat &lt;- c(6,6,5)
x &lt;- gpcm(pars,cat,dimensions=2,print.mod=TRUE)

# plot combined item category surfaces
plot(x,screen=list(z=-40,x=-60), auto.key=list(space="right"))

# plot separated item category surfaces for item two
plot(x,items=2,separate=TRUE,drape=TRUE,panels=1)

# Compute response probabilities for a single three-category item with
# three dimensions. Plot the response surfaces for the first two 
# dimensions conditional on each theta value on the third dimension
pars &lt;- matrix(c(1.1999,0.5997,0.8087,2.1730,-1.4576),1,5)
x &lt;- gpcm(pars,3,dimensions=3,theta=-4:4)
plot(x, screen=list(z=-30,x=-60))
</code></pre>


</div>