<div class="container">

<table style="width: 100%;"><tr>
<td>phyEstimate</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2> Phylogenetic estimation of traits for unobserved taxa </h2>

<h3>Description</h3>

<p>Uses phylogenetic ancestral state reconstruction to estimate trait values for unobserved taxa.
</p>


<h3>Usage</h3>

<pre><code class="language-R">phyEstimate(phy, trait, method="pic", ...)
phyEstimateDisc(phy, trait, best.state=TRUE, cutoff=0.5, ...)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>phy </code></td>
<td>
<p> phylo object </p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>trait </code></td>
<td>
<p> vector or data.frame containing trait values </p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>method </code></td>
<td>
<p> ancestral state estimation method used by <code>ace</code> (default="pic")</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>best.state </code></td>
<td>
<p> estimate best-supported trait state for discrete variables? (default=TRUE)</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>cutoff </code></td>
<td>
<p> support cutoff required to declare a best.state </p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>...</code></td>
<td>
<p> Additional arguments passed to <code>ace</code> </p>
</td>
</tr>
</table>
<h3>Details</h3>

<p>These functions use phylogenetic ancestral state estimation to infer trait values for novel taxa on a phylogenetic tree, for continuous (<code>phyEstimate</code>) and discrete (<code>phyEstimateDisc</code>) traits.
</p>
<p>The required input is a phylogenetic tree object plus a vector or data.frame containing estimated trait values for a subset of the taxa in the phylogenetic tree. Trait values for taxa that are present in the tree but not the trait data will be estimated using ancestral state estimation (Garland and Ives 2000). Briefly, for each taxon present in the tree but not the trait data, the phylogeny is rerooted at the most recent common ancestor of the novel taxon and the rest of the phylogeny, and the trait value of the novel taxon is estimated from the reconstructed trait value at the root of the rerooted phylogeny.
</p>
<p>For <code>phyEstimateDisc</code>, the state with the highest support will be reported if argument <code>best.state=TRUE</code>. If the best-supported state's support is less than the specified <code>cutoff</code>, no best state is reported and a <code>NA</code> value will be returned.
</p>


<h3>Value</h3>

<p>phyEstimate produces a data frame with columns:
</p>
<table>
<tr style="vertical-align: top;">
<td><code>est</code></td>
<td>
<p> Estimated trait value </p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>se</code></td>
<td>
<p> Standard error of estimated trait value </p>
</td>
</tr>
</table>
<p>phyEstimateDisc produces a data frame with columns:
</p>
<table>
<tr style="vertical-align: top;">
<td><code>states 1..N</code></td>
<td>
<p> A column with statistical support is produced for each discrete trait state </p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>estimated.state</code></td>
<td>
<p> If best.state=TRUE, a column with the state with the highest support </p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>estimated.state.support</code></td>
<td>
<p> Statistical support for the state with the highest support </p>
</td>
</tr>
</table>
<h3>Author(s)</h3>

<p> Steven Kembel &lt;steve.kembel@gmail.com&gt; </p>


<h3>References</h3>

 
<p>T. Garland Jr., and A.R. Ives. 2000. Using the past to predict the present: confidence intervals for regression equations in phylogenetic comparative methods. American Naturalist 155:346364.
</p>
<p>S.W. Kembel, M. Wu, J.A. Eisen, and J.L. Green. 2012. Incorporating 16S gene copy number information improves estimates of microbial diversity and abundance. PLoS Computational Biology 8(10):e1002743.
</p>


<h3>Examples</h3>

<pre><code class="language-R">#generate random phylogeny
randtree &lt;- rcoal(50)
#simulate trait evolution for a subset of taxa on phylogeny
randtraits &lt;- sample(rTraitCont(randtree, sigma=10, root.value=100), 40)
#estimate trait values for "missing" taxa using PIC method
phyEstimate(randtree, randtraits, method="pic")
</code></pre>


</div>