<div class="container">

<table style="width: 100%;"><tr>
<td>setRootAge</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>Place a Non-Ultrametric Tree of Fossil Taxa on Absolute Time</h2>

<h3>Description</h3>

<p>This function uses a table of fixed dates for operational-taxon-units (tip taxa) to calculate the absolute
age of the root divergence for a tree with branch lengths, and then appends this root age to the tree
as a <code>$root.time</code> element, and then outputs the tree. Function <code>setRootAges</code> is a wrapper for
<code>setRootAge</code> for use with multiple trees in a object of class <code>multiPhylo</code>. 
This function was mainly written for dealing with trees of extinct taxa dated in units of 
absolute time from Bayesian analyses, such as with MrBayes, 
with trees scaled to time units by functions such as <code>obtainDatedPosteriorTreesMrB</code>.
</p>


<h3>Usage</h3>

<pre><code class="language-R">setRootAge(tree, fixedAges = NULL)

setRootAges(trees, fixedAges = NULL)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>tree</code></td>
<td>
<p>A phylogeny with branch lengths of class <code>phylo</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>fixedAges</code></td>
<td>
<p>A table of fixed ages for tip taxa, generally as a dataframe where the
first column is of type character, and the second column is of type <code>numeric</code>.  
Such a table is automatically
generated as an attribute of the output from <code>obtainDatedPosteriorTreesMrB</code>, 
when argument <code>getFixedTimes = TRUE</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>trees</code></td>
<td>
<p>A list of class <code>multiPhylo</code> consisting of multiple phylogenetic trees with branch lengths.</p>
</td>
</tr>
</table>
<h3>Details</h3>

<p>Trees of fossil taxa come with one issue rarely encountered by those dealing with molecular
phylogenies: the absolute timing of when tips and divergences is not certain. With the vast
majority of molecular phylogenies, it can be assumed the youngest tips occur at time 0 
â€“ in other words , the modern. 
This knowledge gives the tree an <em>'anchor'</em> for fixing the absolute timing of events.
Many programs and other software designed for depicting and analyzing phylogenetic hypotheses
assumes such an apparent absolute time-scale (in R and elsewhere). 
A phylogenetic analysis of Paleozoic brachiopods that include no
extant members has no such anchor at time = 0, and such a default assumption in available
software can be misleading. The <code>$root.time</code> protocol is intended to grant this
absolute time-scale to a dated tree of fossil taxa, and is appended by most of the
dating functions in package paleotree. However, trees dated by other approaches, such as via tip-dating in
programs such as MrBayes and BEAST, will not have <code>$root.time</code> elements when read into R.
</p>


<h3>Value</h3>

<p>The input tree is output, with a new <code>$root.time</code> element.
</p>


<h3>Author(s)</h3>

<p>David W. Bapst
</p>


<h3>See Also</h3>

<p><code>setRootAges</code> is designed to work by default with trees on relative
time-scales dated by <code>obtainDatedPosteriorTreesMrB</code>, particularly
when the argument with <code>getFixedTimes = TRUE</code>, which is used to obtain fixed tip
ages for anchoring the tree against an absolute time-scale. The functions described here
will be applied automatically with <code>obtainDatedPosteriorTreesMrB</code>
if argument <code>getRootAges = TRUE</code>.
</p>


<h3>Examples</h3>

<pre><code class="language-R">
set.seed(444)
tree &lt;- rtree(10)
tipAges &lt;- cbind(c("t1","t2"), c(15,10))

absTimeTree &lt;- setRootAge(tree = tree,tipAges)

plot(absTimeTree)
axisPhylo()

</code></pre>


</div>