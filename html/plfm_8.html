<div class="container">

<table style="width: 100%;"><tr>
<td>gendatLCplfm</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>Data generation</h2>

<h3>Description</h3>

<p>Data generation for disjunctive, conjunctive and additive latent class probabilistic latent feature models.</p>


<h3>Usage</h3>

<pre><code class="language-R">gendatLCplfm(N,objpar,attpar,sizepar,maprule="disj",model=1)</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>N</code></td>
<td>
<p>Number of replications (e.g. persons) for which binary object-attribute associations are generated.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>objpar</code></td>
<td>
<p>True objectparameters. If <code>model</code>=1, <code>model</code>=3, <code>model</code>=4, or <code>model</code>=6 <code>objpar</code> is a <em>J X F X T</em> array, 
if  <code>model</code>=2 or <code>model</code>=5 <code>objpar</code> is a <em>J X F</em> matrix. As object parameters are probabilities they should be between 0 and 1.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>attpar</code></td>
<td>
<p>True attributeparameters. If <code>model</code>=2, <code>model</code>=3, <code>model</code>=5, or <code>model</code>=6 <code>attpar</code> is a <em>K X F X T</em> array, 
if  <code>model</code>=1 or <code>model</code>=4 <code>attpar</code> is a <em>K X F</em> matrix. As attribute parameters are probabilities they should be between 0 and 1.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>sizepar</code></td>
<td>
<p>A <em>T</em>-vector of true class size parameters.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>maprule</code></td>
<td>
<p>Disjunctive (<code>maprule="disj"</code>), conjunctive (<code>maprule="conj"</code>) or additive  (<code>maprule="add"</code>) 
mapping rule of the latent class probabilistic latent feature model.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>model</code></td>
<td>
<p>The type of dependency and heterogeneity assumption included in the model. <code>model</code>=1, <code>model</code>=2, <code>model</code>=3 represent models with a constant 
object-feature classification per person and with, respectively, class-specific object parameters, class-specific attribute parameters, 
and class-specific object- and attribute parameters. <code>model</code>=4, <code>model</code>=5, <code>model</code>=6 represent models with a constant 
attribute-feature classification per person and with, respectively, class-specific object parameters, class-specific attribute parameters, 
and class-specific object- and attribute parameters.</p>
</td>
</tr>
</table>
<h3>Details</h3>

<p>The function <code>gendatLCplfm</code> generates binary object-attribute associations for <em>N</em> replications 
according to a disjunctive, conjunctive or additive latent class probabilistic latent feature model of a specific model type. 
In addition, the function computes the <em>J X K</em> matrix of marginal object-attribute association probabilities and
a  <em>J X K X T</em> array of class-specific object-attribute association probabilities.                      
To compute association probabilities the function <em>gendatLCplfm</em> uses a vector of class size parameters (<code>sizepar</code>) a matrix or array of 
object parameters (<code>objpar</code>) and a matrix or array of true  attribute parameters (<code>attpar</code>) as input. 
</p>
<p>According to the <em>disjunctive</em> probabilistic latent feature model, object <em>j</em> is associated
to attribute <em>k</em> if the object and the attribute have at least one feature in common. 
More specifically, for <code>model=1</code> the class-specific object-attribute association probability in cell <em>(j,k)</em> for the disjunctive model 
can be computed as: 
</p>
<p style="text-align: center;"><code class="reqn">p(j,k|t)=1-\prod_f(1-objpar[j,f,t]*attpar[k,f]).</code>
</p>

<p>According to the <em>conjunctive</em> probabilistic latent feature model, object <em>j</em> and attribute <em>k</em> 
are associated if object <em>j</em> has all the features that are linked to attribute <em>k</em>. 
</p>
<p>In particular, for <code>model=1</code>,the class-specific object-attribute association probability in cell <em>(j,k)</em> for the conjunctive model can be computed as:
</p>
<p style="text-align: center;"><code class="reqn">p(j,k|t)=\prod_f(1-(1-objpar[j,f,t])*attpar[k,f]).</code>
</p>

<p>According to the <em>additive</em> probabilistic latent feature model, an object and an attribute are more likely to be associated if they have more features in common. 
</p>
<p>In particular, for <code>model=1</code>,the class-specific object-attribute association probability in cell <em>(j,k)</em> for the additive model can be computed as:
</p>
<p style="text-align: center;"><code class="reqn">p(j,k|t)= \frac{1}{F} * \sum_f(objpar[j,f,t])*attpar[k,f]).</code>
</p>

<p>The marginal object-attribute association probability can be computed as follows:
</p>
<p style="text-align: center;"><code class="reqn">p(j,k)=\sum_t sizepar[t]*p(j,k|t).</code>
</p>



<h3>Value</h3>

<table>
<tr style="vertical-align: top;">
<td><code>call</code></td>
<td>
<p>Parameters used to call the function.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>data</code></td>
<td>
<p><em>I X J X K</em> matrix of association probabilities.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>class</code></td>
<td>
<p><em>I</em>-vector that contains latent class membership of each replication.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>condprob.JKT</code></td>
<td>
<p><em>J X K X T</em> array of class-specific conditional object-attribute association probabilities.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>margprob.JK</code></td>
<td>
<p><em>J X K</em> matrix  of marginal object-attribute association probabilities.</p>
</td>
</tr>
</table>
<h3>Author(s)</h3>

<p>Michel Meulders</p>


<h3>References</h3>

<p>Meulders, M., Tuerlinckx, F., and Vanpaemel, W. (2013). Constrained multilevel latent class models for the analysis of three-way three-mode binary data. 
<em>Journal of Classification, 30 (3)</em>, 306-337.
</p>


<h3>See Also</h3>

<p><code>LCplfm</code></p>


<h3>Examples</h3>

<pre><code class="language-R">## Not run: 
# define constants
I&lt;-500
J&lt;-10
K&lt;-8
F&lt;-2
T&lt;-2

# model 1

# generate true parameters
objpar&lt;-array(runif(J*F*T),c(J,F,T))
attpar&lt;-matrix(runif(K*F),c(K,F))
sizepar&lt;-rep(1/T,T)
# generate data
d&lt;-gendatLCplfm(N=I,objpar=objpar,attpar=attpar,sizepar=sizepar,maprule="conj",model=1)
# estimate parameters of true model
res&lt;-LCplfm(data=d$data,F=2,T=2,model=1,maprule="conj")


# model 2

# generate true parameters
objpar&lt;-matrix(runif(J*F),nrow=J)
attpar&lt;-array(runif(K*F*T),c(K,F,T))
sizepar&lt;-rep(1/T,T)
# generate data
d&lt;-gendatLCplfm(N=I,objpar=objpar,attpar=attpar,sizepar=sizepar,maprule="conj",model=2)
# estimate parameters of true model
res&lt;-LCplfm(data=d$data,F=2,T=2,model=2,maprule="conj")

# model 3

# generate true parameters
objpar&lt;-array(runif(J*F*T),c(J,F,T))
attpar&lt;-array(runif(K*F*T),c(K,F,T))
sizepar&lt;-rep(1/T,T)
# generate data
d&lt;-gendatLCplfm(N=I,objpar=objpar,attpar=attpar,sizepar=sizepar,maprule="conj",model=3)
# estimate parameters of true model
res&lt;-LCplfm(data=d$data,F=2,T=2,model=3,maprule="conj")

# model 4

# generate true parameters
objpar&lt;-array(runif(J*F*T),c(J,F,T))
attpar&lt;-matrix(runif(K*F),c(K,F))
sizepar&lt;-rep(1/T,T)
# generate data
d&lt;-gendatLCplfm(N=I,objpar=objpar,attpar=attpar,sizepar=sizepar,maprule="conj",model=4)
# estimate parameters of true model
res&lt;-LCplfm(data=d$data,F=2,T=2,model=4,maprule="conj")

# model 5

# generate true parameters
objpar&lt;-matrix(runif(J*F),nrow=J)
attpar&lt;-array(runif(K*F*T),c(K,F,T))
sizepar&lt;-rep(1/T,T)
# generate data
d&lt;-gendatLCplfm(N=I,objpar=objpar,attpar=attpar,sizepar=sizepar,maprule="conj",model=5)
# estimate parameters of true model
res&lt;-LCplfm(data=d$data,F=2,T=2,model=5,maprule="conj")


# model 6
# generate true parameters
objpar&lt;-array(runif(J*F*T),c(J,F,T))
attpar&lt;-array(runif(K*F*T),c(K,F,T))
sizepar&lt;-rep(1/T,T)
# generate data
d&lt;-gendatLCplfm(N=I,objpar=objpar,attpar=attpar,sizepar=sizepar,maprule="conj",model=6)
# estimate parameters of true model
res&lt;-LCplfm(data=d$data,F=2,T=2,model=6,maprule="conj")

## End(Not run)
</code></pre>


</div>