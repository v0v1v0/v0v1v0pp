<div class="container">

<table style="width: 100%;"><tr>
<td>fit_aci_response</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>Fitting ACi curves</h2>

<h3>Description</h3>

<p>Fitting ACi curves
</p>


<h3>Usage</h3>

<pre><code class="language-R">fit_aci_response(
  data,
  varnames = list(A_net = "A_net", T_leaf = "T_leaf", C_i = "C_i", PPFD = "PPFD", g_mc =
    "g_mc"),
  P = 100,
  fitTPU = TRUE,
  alpha_g = 0,
  R_d_meas = NULL,
  useR_d = FALSE,
  useg_mc = FALSE,
  useg_mct = FALSE,
  usegamma_star = FALSE,
  useK_M = FALSE,
  useK_C_K_O = FALSE,
  alpha = 0.24,
  theta_J = 0.85,
  gamma_star25 = 42.75,
  Ea_gamma_star = 37830,
  K_M25 = 718.4,
  Ea_K_M = 65508.28,
  g_mc25 = 0.08701,
  Ea_g_mc = 0,
  K_C25 = NULL,
  Ea_K_C = NULL,
  K_O25 = NULL,
  Ea_K_O = NULL,
  Oconc = 21,
  gamma_star_set = NULL,
  K_M_set = NULL,
  ...
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>data</code></td>
<td>
<p>Dataframe for A-Ci curve fitting</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>varnames</code></td>
<td>
<p>List of variable names. varnames = list(A_net = "A_net",
T_leaf = "T_leaf", C_i = "C_i", PPFD = "PPFD", g_mc = "g_mc"), where A_net
is net CO2 assimilation, T_leaf is leaf temperature in Celsius, C_i is
intercellular CO2 concentration in umol/mol, PPFD is incident irradiance
in umol m-2 s-1 (note that it is ASSUMED to be absorbed irradiance, so be
sure to adjust according to light absorbance and PSI/PSII partitioning
accordingly OR interpret the resultant values of J and J_max with caution),
g_mc is mesophyll conductance to CO2 in mol m-2 s-1 Pa-1.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>P</code></td>
<td>
<p>Atmospheric pressure in kPa</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>fitTPU</code></td>
<td>
<p>Should triose phosphate utilization (V_TPU) be fit?</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>alpha_g</code></td>
<td>
<p>Fraction of respiratory glycolate carbon that is not returned
to the chloroplast (von Caemmerer, 2000). If ACi curves show high-CO2
decline, then this value should be &gt; 0.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>R_d_meas</code></td>
<td>
<p>Measured value of respiratory CO2 efflux in umol m-2 s-1.
Input value should be positive to work as expected with the equations.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>useR_d</code></td>
<td>
<p>Use a measured value of R_d? Set to TRUE if using R_d_meas.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>useg_mc</code></td>
<td>
<p>Use mesophyll conductance? Set to TRUE if specifying g_mc
in varnames above.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>useg_mct</code></td>
<td>
<p>Use mesophyll conductance temperature response? Set to TRUE
if using a temperature response of mesophyll conductance.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>usegamma_star</code></td>
<td>
<p>Specify gamma_star value? If FALSE, uses a temperature
response function with Nicotiana tabacum defaults from Bernacchi et al.
2001.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>useK_M</code></td>
<td>
<p>Specify K_M? If FALSE, uses an Arrhenius temperature response
function with Nicotiana tabacum defaults from Bernacchi et al. 2001.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>useK_C_K_O</code></td>
<td>
<p>Use individual carboxylation/oxygenation constants for
rubisco? If TRUE, need to specify values at 25C and activation energy for
the Arrhenius temperature response function.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>alpha</code></td>
<td>
<p>Quantum yield of CO2 assimilation</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>theta_J</code></td>
<td>
<p>Curvature of the photosynthetic light response curve</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>gamma_star25</code></td>
<td>
<p>gamma_star at 25C in umol mol-1</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>Ea_gamma_star</code></td>
<td>
<p>Activation energy of gamma_star in J mol-1</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>K_M25</code></td>
<td>
<p>Michaelis-Menten constant for rubisco at 25C</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>Ea_K_M</code></td>
<td>
<p>Activation energy for K_M in J mol-1</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>g_mc25</code></td>
<td>
<p>Mesophyll conductance at 25C in mol m-2 s-1</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>Ea_g_mc</code></td>
<td>
<p>Activation energy of g_mc in J mol-1</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>K_C25</code></td>
<td>
<p>Michaelis-Menten constant for rubisco carboxylation at 25C</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>Ea_K_C</code></td>
<td>
<p>Activation energy for K_C in J mol-1</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>K_O25</code></td>
<td>
<p>Michaelis-Menten constant for rubisco oxygenation at 25C</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>Ea_K_O</code></td>
<td>
<p>Activation energy for K_O in J mol-2</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>Oconc</code></td>
<td>
<p>O2 concentration in %. Used with P to calculate
intracellular O2 when using K_C_K_O</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>gamma_star_set</code></td>
<td>
<p>Value of gamma_star to use (in ppm) if
usegamma_star = TRUE</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>K_M_set</code></td>
<td>
<p>Value of K_M to use if useK_M = TRUE</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>...</code></td>
<td>
<p>Other arguments to pass on</p>
</td>
</tr>
</table>
<h3>Value</h3>

<p>fit_aci_response fits ACi curves using an approach similar to
Gu et al. 2010. Iterates all possible C_i transition points and checks for
inadmissible curve fits. If no curves are admissible (either due to poor data
or poor assumed parameters), the output will include a dataframe of NA values.
Default parameters are all from Bernacchi et al. 2001, 2002.
</p>


<h3>References</h3>

<p>Bernacchi CJ, Singsaas EL, Pimentel C, Portis AR, Long SP. 2001. Improved
temperature response functions for models of rubisco-limited photosynthesis.
Plant Cell Environment 24:253-259.
</p>
<p>Bernacchi CJ, Portis AR, Nakano H, von Caemmerer S, Long SP. 2002. Temperature
response of mesophyll conductance. Implications for the determination of rubisco
enzyme kinetics and for limitations to photosynthesis in vivo. Plant Physiology
130:1992-1998.
</p>
<p>Gu L, Pallardy SG, Tu K, Law BE, Wullschleger SD. 2010. Reliable estimation
of biochemical parameters from C3 leaf photosynthesis-intercellular carbon
dioxide response curves. Plant Cell Environment 33:1852-1874.
</p>
<p>von Caemmerer S. 2000. Biochemical models of leaf photosynthesis. CSIRO
Publishing, Collingwood.
</p>


<h3>Examples</h3>

<pre><code class="language-R">
# Read in your data
# Note that this data is coming from data supplied by the package
# hence the complicated argument in read.csv()
# This dataset is a CO2 by light response curve for a single sunflower
data &lt;- read.csv(system.file("extdata", "A_Ci_Q_data_1.csv",
  package = "photosynthesis"
))

# Define a grouping factor based on light intensity to split the ACi
# curves
data$Q_2 &lt;- as.factor((round(data$Qin, digits = 0)))

# Convert leaf temperature to K
data$T_leaf &lt;- data$Tleaf + 273.15

# Fit ACi curve. Note that we are subsetting the dataframe
# here to fit for a single value of Q_2
fit &lt;- fit_aci_response(data[data$Q_2 == 1500, ],
  varnames = list(
    A_net = "A",
    T_leaf = "T_leaf",
    C_i = "Ci",
    PPFD = "Qin"
  )
)

# View fitted parameters
fit[[1]]

# View graph
fit[[2]]

# View data with modelled parameters attached
fit[[3]]

# Fit many curves
fits &lt;- fit_many(
  data = data,
  varnames = list(
    A_net = "A",
    T_leaf = "T_leaf",
    C_i = "Ci",
    PPFD = "Qin"
  ),
  funct = fit_aci_response,
  group = "Q_2"
)

# Print the parameters
# First set of double parentheses selects an individual group value
# Second set selects an element of the sublist
fits[[3]][[1]]

# Print the graph
fits[[3]][[2]]

# Compile graphs into a list for plotting
fits_graphs &lt;- compile_data(fits,
  list_element = 2
)

# Compile parameters into dataframe for analysis
fits_pars &lt;- compile_data(fits,
  output_type = "dataframe",
  list_element = 1
)

</code></pre>


</div>