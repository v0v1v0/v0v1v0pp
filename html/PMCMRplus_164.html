<div class="container">

<table style="width: 100%;"><tr>
<td>mrrTest</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>Madhava Rao-Raghunath Test for Testing Treatment vs. Control</h2>

<h3>Description</h3>

<p>The function has implemented the nonparametric test of
Madhava Rao and Raghunath (2016) for testing paired two-samples
for symmetry. The null hypothesis <code class="reqn">H: F(x,y) = F(y,x)</code>
is tested against the alternative <code class="reqn">A: F(x,y) \ne F(y,x)</code>.
</p>


<h3>Usage</h3>

<pre><code class="language-R">mrrTest(x, ...)

## Default S3 method:
mrrTest(x, y = NULL, m = NULL, ...)

## S3 method for class 'formula'
mrrTest(formula, data, subset, na.action, ...)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>x</code></td>
<td>
<p>numeric vector of data values. Non-finite (e.g., infinite or missing) values will be omitted.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>...</code></td>
<td>
<p>further arguments to be passed to or from methods.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>y</code></td>
<td>
<p>an optional numeric vector of data values:
as with x non-finite values will be omitted.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>m</code></td>
<td>
<p>numeric, optional integer number, whereas <code class="reqn">n = k m</code> needs to be
full filled.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>formula</code></td>
<td>
<p>a formula of the form <code>response ~ group</code> where
<code>response</code> gives the data values and <code>group</code> a vector or
factor of the corresponding groups.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>data</code></td>
<td>
<p>an optional matrix or data frame (or similar: see
<code>model.frame</code>) containing the variables in the
formula <code>formula</code>.  By default the variables are taken from
<code>environment(formula)</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>subset</code></td>
<td>
<p>an optional vector specifying a
subset of observations to be used.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>na.action</code></td>
<td>
<p>a function which indicates what should happen when
the data contain <code>NA</code>s.  Defaults to <code>getOption("na.action")</code>.</p>
</td>
</tr>
</table>
<h3>Details</h3>

<p>Let <code class="reqn">X_i</code> and <code class="reqn">Y_i, ~ i \le n</code> denote
continuous variables that were observed
on the same <code class="reqn">i</code>th test item (e.g. patient)
with <code class="reqn">i = 1, \ldots n</code>. Let
</p>
<p style="text-align: center;"><code class="reqn">
  U_i = X_i + Y_i \qquad V_i = X_i - Y_i
</code>
</p>

<p>Let <code class="reqn">U_{(i)}</code> be the <code class="reqn">i</code>th order statistic,
<code class="reqn">U_{(1)} \le U_{(2)} \le \ldots U_{(n)}</code> and <code class="reqn">k</code> the
number of clusters, with the condition:
</p>
<p style="text-align: center;"><code class="reqn">
 n = k ~ m.
</code>
</p>

<p>Further, let the divider denote <code class="reqn">d_0 = -\infty</code>, <code class="reqn">d_k = \infty</code>, and else
</p>
<p style="text-align: center;"><code class="reqn">
 d_j = \frac{ U_{(jm)} +  U_{(jm+1)} }{2}, ~ 1 \le j \le k -1
</code>
</p>

<p>The two counts are
</p>
<p style="text-align: center;"><code class="reqn">
 n_j^{+} = \left\{
           \begin{array}{lr}
           1 &amp; \mathrm{if}~ d_{j-1} &lt; u_i &lt; d_j, v_i &gt; 0 \\
           0 &amp;
           \end{array}
           \right.
</code>
</p>

<p>and
</p>
<p style="text-align: center;"><code class="reqn">
 n_j^{-} = \left\{
           \begin{array}{lr}
           1 &amp; \mathrm{if}~ d_{j-1} &lt; u_i &lt; d_j, v_i \le 0 \\
           0 &amp;
           \end{array}
           \right.
</code>
</p>

<p>The test statistic is
</p>
<p style="text-align: center;"><code class="reqn">
 M = \sum_{j = 1}^k \frac{\left(n_j^{+} - n_j^{-}\right)^2}
                         {m}
</code>
</p>

<p>The exact p-values for <code class="reqn">5 \le n \le 30</code> are taken from an
internal look-up table. The exact p-values were taken
from Table 7, Appendix B  of Madhava Rao and Raghunath (2016).
</p>
<p>If <code>m = NULL</code> the function uses <code class="reqn">n = m</code> for
all prime numbers, otherwise it tries to find an value for
m in such a way, that for <code class="reqn">k = n / m</code> all variables
are integer.
</p>


<h3>Value</h3>

<p>A list with class <code>"htest"</code> containing the following components:
</p>

<dl>
<dt>method</dt>
<dd>
<p>a character string indicating what type of test was performed.</p>
</dd>
<dt>data.name</dt>
<dd>
<p>a character string giving the name(s) of the data.</p>
</dd>
<dt>statistic</dt>
<dd>
<p>the estimated quantile of the test statistic.</p>
</dd>
<dt>p.value</dt>
<dd>
<p>the p-value for the test.</p>
</dd>
<dt>parameter</dt>
<dd>
<p>the parameters of the test statistic, if any.</p>
</dd>
<dt>alternative</dt>
<dd>
<p>a character string describing the alternative hypothesis.</p>
</dd>
<dt>estimates</dt>
<dd>
<p>the estimates, if any.</p>
</dd>
<dt>null.value</dt>
<dd>
<p>the estimate under the null hypothesis, if any.</p>
</dd>
</dl>
<h3>Note</h3>

<p>The function returns an error code if a value for <code>m</code>
is provided  that does not lead to an integer of the ratio
<code class="reqn">k = n /m</code>.
</p>
<p>The function also returns an error code, if a tabulated
value for given <code class="reqn">n</code>, <code class="reqn">m</code> and calculated <code class="reqn">M</code>
can not be found in the look-up table.
</p>


<h3>References</h3>

<p>Madhava Rao, K.S., Ragunath, M. (2016) A Simple Nonparametric Test
for Testing Treatment Versus Control. <em>J Stat Adv Theory Appl</em> <b>16</b>,
133â€“162. <a href="https://doi.org/10.18642/jsata_7100121717">doi:10.18642/jsata_7100121717</a>
</p>


<h3>Examples</h3>

<pre><code class="language-R">## Madhava Rao and Raghunath (2016), p. 151
## Inulin clearance of living donors
## and recipients of their kidneys
x &lt;- c(61.4, 63.3, 63.7, 80.0, 77.3, 84.0, 105.0)
y &lt;- c(70.8, 89.2, 65.8, 67.1, 87.3, 85.1, 88.1)
mrrTest(x, y)

## formula method
## Student's Sleep Data
mrrTest(extra ~ group, data = sleep)

</code></pre>


</div>