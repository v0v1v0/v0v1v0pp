<div class="container">

<table style="width: 100%;"><tr>
<td>degradeTree</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>Randomly Collapse a Portion of Nodes on a Phylogeny</h2>

<h3>Description</h3>

<p><code>degradeTree</code> removes a proportion of the total nodes in a tree, chosen
randomly, collapsing the nodes to produce a less-resolved tree. The related function <code>collapseNodes</code> 
given a tree and a vector of nodes to collapse, removes those nodes from a tree, creating a polytomy.
</p>


<h3>Usage</h3>

<pre><code class="language-R">degradeTree(
  tree,
  prop_collapse = NULL,
  nCollapse = NULL,
  node.depth = NA,
  leave.zlb = FALSE
)

collapseNodes(tree, nodeID, collapseType, leave.zlb = FALSE)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>tree</code></td>
<td>
<p>A phylogeny of class <code>phylo</code></p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>prop_collapse</code></td>
<td>
<p>Proportion of nodes to collapse</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>nCollapse</code></td>
<td>
<p>Number of nodes to collapse, can be supplied as an
alternative to <code>prop_collapse</code></p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>node.depth</code></td>
<td>
<p>A number between 0 to 1, which conditions the depth of
nodes removed. If <code>NA</code>, no conditioning (this is the default).</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>leave.zlb</code></td>
<td>
<p>If <code>FALSE</code>, the default option, the original branch length
distribution is destroyed and branches set to zero by this function will
return polytomies. If <code>TRUE</code>, then the original edge lengths are kept for
unmodified edges, and modified edges are changed to zero length, and are not
collapsed into polytomies. The removed branch length is not shifted to other
edges.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>nodeID</code></td>
<td>
<p>The node ID number(s) to be collapsed into a polytomy, as identified in
the <code>$edge</code> matrix of the <code>phylo</code> object. Must be a vector of one or more ID numbers.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>collapseType</code></td>
<td>
<p>Whether to collapse the edge leading the listed node
(if <code>collapseType = "forward"</code>), or to collapse the child edges leading
away from the node (if <code>collapseType = "backward"</code>). Collapsing a node
' 'into' a polytomy conceptually could be either and users should heed this
option carefully. A third option, if <code>"collapseType = clade"</code> is to
collapse the entire clade that is descended from a node (i.e. forward).</p>
</td>
</tr>
</table>
<h3>Details</h3>

<p>In the function <code>degradeTree</code>, the nodes are removed at random
using the basic R function <code>sample</code>. <code>degradeTree</code>
can be conditioned to remove nodes of a particular depth with greater
probability/frequency by setting node.depth to a value between zero
(favoring the removal of deep nodes close to the root) or one (shallow nodes
far from the root). Depth is evaluated based on the number of descendant
tips. If node.depth is not NA, the relative proportion of descendants from
each node is calculated, summed to 1 and the node.depth value subtracted
from this proportion. These values are then squared, normalized again to
equal to 1 and then used as the probabilities for sampling nodes for
removal.
</p>
<p>By default, branch lengths are removed from the input tree prior to
degradation and entirely absent from the output tree. This is changed if
argument <code>leave.zlb</code> is TRUE.
</p>


<h3>Value</h3>

<p>Returns the modified tree as an object of class <code>phylo</code>, with no edge
lengths by default.
</p>


<h3>Author(s)</h3>

<p>David W. Bapst
</p>


<h3>See Also</h3>

<p><code>di2multi</code>,<code>timeLadderTree</code>
</p>


<h3>Examples</h3>

<pre><code class="language-R">
set.seed(444)
tree &lt;- rtree(100)
tree1 &lt;- degradeTree(tree,prop_collapse = 0.5) 
tree3 &lt;- degradeTree(tree,nCollapse = 50) 

#let's compare the input and output
layout(matrix(1:2,,2))
plot(tree,show.tip.label = FALSE,use.edge.length = FALSE)
plot(tree1,show.tip.label = FALSE,use.edge.length = FALSE)

#now with collapseNodes
tree &lt;- rtree(10)
#collapse nodes backwards
   #let's collapse lucky node number 13!
tree1 &lt;- collapseNodes(nodeID = 13,tree = tree,collapseType = "backward")  
#collapse nodes forwards 
tree2 &lt;- collapseNodes(nodeID = 13,tree = tree,collapseType = "forward")
#collapse entire clade
tree3 &lt;- collapseNodes(nodeID = 13,tree = tree,collapseType = "clade")

#let's compare
layout(1:4)
plot(tree,use.edge.length = FALSE,main = "original")
plot(tree1,use.edge.length = FALSE,main = "backward collapse")
plot(tree2,use.edge.length = FALSE,main = "forward collapse")
plot(tree3,use.edge.length = FALSE,main = "entire clade")

layout(1)

</code></pre>


</div>