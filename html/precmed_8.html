<div class="container">

<table style="width: 100%;"><tr>
<td>atefitmean</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>Doubly robust estimator of and inference for the average treatment effect for
continuous data</h2>

<h3>Description</h3>

<p>Doubly robust estimator of the average treatment effect between two
treatments, which is the rate ratio of treatment 1 over treatment 0 for
count outcomes. Bootstrap is used for inference.
</p>


<h3>Usage</h3>

<pre><code class="language-R">atefitmean(
  data,
  cate.model,
  ps.model,
  ps.method = "glm",
  minPS = 0.01,
  maxPS = 0.99,
  interactions = TRUE,
  n.boot = 500,
  plot.boot = FALSE,
  seed = NULL,
  verbose = 0
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>data</code></td>
<td>
<p>A data frame containing the variables in the outcome and
propensity score models; a data frame with <code>n</code> rows (1 row per
observation).</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>cate.model</code></td>
<td>
<p>A formula describing the outcome model to be fitted.
The outcome must appear on the left-hand side.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>ps.model</code></td>
<td>
<p>A formula describing the propensity score model to be fitted.
The treatment must appear on the left-hand side. The treatment must be a
numeric vector coded as 0/1. If data are from a RCT, specify <code>ps.model</code>
as an intercept-only model.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>ps.method</code></td>
<td>
<p>A character value for the method to estimate the propensity
score. Allowed values include one of: <code>'glm'</code> for logistic regression
with main effects only (default), or <code>'lasso'</code> for a logistic regression
with main effects and LASSO penalization on two-way interactions (added to
the model if interactions are not specified in <code>ps.model</code>). Relevant
only when <code>ps.model</code> has more than one variable.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>minPS</code></td>
<td>
<p>A numerical value between 0 and 1 below which estimated
propensity scores should be truncated. Default is <code>0.01</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>maxPS</code></td>
<td>
<p>A numerical value between 0 and 1 above which estimated
propensity scores should be truncated. Must be strictly greater than
<code>minPS</code>. Default is <code>0.99</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>interactions</code></td>
<td>
<p>A logical value indicating whether the outcome model
should be fitted separately by treatment arm with the variables in
<code>cate.model</code>, which is equivalent to assuming treatment-covariate
interaction by all of the variables in <code>cate.model</code>. If <code>TRUE</code>, the
outcome model will be fitted separately by treatment arms only if at least
10 patients received each treatment option. Default is <code>TRUE</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>n.boot</code></td>
<td>
<p>A numeric value indicating the number of bootstrap samples
used. Default is <code>500</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>plot.boot</code></td>
<td>
<p>A logical value indicating whether histograms of the
bootstrapped treatment effect estimates should be produced at every
<code>n.boot/10</code>-th iteration and whether the final histogram should be
outputted. Default is <code>FALSE</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>seed</code></td>
<td>
<p>An optional integer specifying an initial randomization seed for
reproducibility. Default is <code>NULL</code>, corresponding to no seed.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>verbose</code></td>
<td>
<p>An integer value indicating whether intermediate progress
messages and histograms should be printed. <code>1</code> indicates messages are
printed and <code>0</code> otherwise. Default is <code>0</code>.</p>
</td>
</tr>
</table>
<h3>Details</h3>

<p>This helper function estimates the average treatment effect (ATE) between two
treatment groups in a given dataset specified by <code>y, trt, x.cate, x.ps, time</code>. The ATE is
estimated with a doubly robust estimator that accounts for imbalances in covariate distributions
between the two treatment groups with inverse probability treatment weighting.
For count outcomes, the estimated ATE is the estimated
rate ratio between treatment 1 versus treatment 0. Both original and log-transformed ATEs are
returned, as well as the rate in either treatment group.
If <code>inference = TRUE</code>, the variability of the estimated rate ratio is also calculated
using bootstrap. Additional variability outputs include standard error of the log rate ratio,
95% confidence interval of the rate ratio, p-value, and a histogram of the log rate ratio.
</p>


<h3>Value</h3>

<p>Return a list of 8 elements:
</p>

<ul>
<li>
<p><code>log.rate.ratio</code>:  A numeric value of the estimated log rate ratio.
</p>
</li>
<li>
<p><code>se.boot.log.rate.ratio</code>:  A numeric value of the bootstrap standard error of log rate ratio.
</p>
</li>
<li>
<p><code>rate.ratio</code>:  A numeric value of the estimated rate ratio.
</p>
</li>
<li>
<p><code>rate.ratio0</code>:  A numeric value of the estimated rate in the group trt=0.
</p>
</li>
<li>
<p><code>rate.ratio1</code>:  A numeric value of the estimated rate in the group trt=1.
</p>
</li>
<li>
<p><code>rate.ratio.CIl</code>:  A numeric value of the lower limit 95% bootstrap confidence interval
for estimated rate ratio.
</p>
</li>
<li>
<p><code>rate.ratio.CIu</code>:  A numeric value of the upper limit 95% bootstrap confidence interval
for estimated rate ratio.
</p>
</li>
<li>
<p><code>pvalue</code>:  A numeric value of the p-value derived from the bootstrapped values
based on a Chi-squared distribution.
</p>
</li>
<li>
<p><code>warning</code>:  A warning message produced if the treatment variable was not coded as 0/1. The key
to map the original coding of the variable to a 0/1 key is displayed in the warning to facilitate the
interpretation of the remaining of the output.
</p>
</li>
<li>
<p><code>plot</code>:  If <code>plot.boot</code> is <code>TRUE</code>, a histogram displaying the distribution of the bootstrapped log rate ratios.
The red vertical reference line in the histogram represents the estimated log rate ratio.
</p>
</li>
</ul>
<h3>Examples</h3>

<pre><code class="language-R"># This module is not implemented yet!

</code></pre>


</div>