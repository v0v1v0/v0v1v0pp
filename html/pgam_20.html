<div class="container">

<table style="width: 100%;"><tr>
<td>pgam</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>Poisson-Gamma Additive Models</h2>

<h3>Description</h3>

<p>Fit Poisson-Gamma Additive Models using the roughness penalty approach
</p>


<h3>Usage</h3>

<pre><code class="language-R">pgam(formula, dataset, omega = 0.8, beta = 0.1, offset = 1, digits = getOption("digits"),
na.action="na.exclude", maxit = 100, eps = 1e-06, lfn.scale=1, control = list(), 
optim.method = "L-BFGS-B", bkf.eps = 0.001, bkf.maxit = 100, se.estimation = "numerical", 
verbose = TRUE)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>formula</code></td>
<td>
<p>a model formula. See <code>formparser</code> for details</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>dataset</code></td>
<td>
<p>a data set in the environment search path. Missing data is temporarily not handled</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>omega</code></td>
<td>
<p>initial value for the discount factor</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>beta</code></td>
<td>
<p>vector of initial values for covariates coefficients. If a sigle value is supplied it is replicated to fill in the whole vector</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>offset</code></td>
<td>
<p>default is <code class="reqn">1</code>. Other value can be supplied here</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>digits</code></td>
<td>
<p>number of decimal places for printing information out</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>na.action</code></td>
<td>
<p>action to be taken if missing values are found. Default is <code>"na.exclude"</code> and residuals and predictions are padded to fit the length of the data. If <code>"na.fail"</code> then the process will stop if missing values are found. If <code>"na.omit"</code> the process will continue without padding though. If <code>"na.pass"</code> the process will stop due to errors</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>maxit</code></td>
<td>
<p>convergence control iterations</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>eps</code></td>
<td>
<p>convergence control criterion</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>lfn.scale</code></td>
<td>
<p>scales the likelihood function and is passed to <code>control</code> in <code>optim</code>. Value must be positive to ensure maximization</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>control</code></td>
<td>
<p>convergence control of <code>optim</code>. See its help for details</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>optim.method</code></td>
<td>
<p>optimization method passed to <code>optim</code>. Different methods can lead to different results, so the user must attempt to the trade off between speed and robustness. For example, <code>BFGS</code> is faster but sensitive to starting values and <code>L-BFGS-B</code> is more robust but slower. See its help for details.</p>
</td>
</tr>
</table>
<table>
<tr style="vertical-align: top;">
<td><code>bkf.eps</code></td>
<td>
<p>convergence control criterion for the backfitting algorithm</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>bkf.maxit</code></td>
<td>
<p>convergence control iterations for the backfitting algorithm</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>se.estimation</code></td>
<td>
<p>if <code>numerical</code> numerical standard error of parameters are returned. If <code>analytical</code> then analytical extraction of the standard errors is performed. By setting it to <code>none</code> standard error estimation is avoided</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>verbose</code></td>
<td>
<p>if <code>TRUE</code> information during estimation process is printed out</p>
</td>
</tr>
</table>
<h3>Details</h3>

<p>The formula is parsed by <code>formparser</code> in order to extract all the information necessary for model fit. Split the model into two parts regarding the parametric nature of the model.
A model can be specified as following:
</p>
<p style="text-align: center;"><code class="reqn">Y~f\left(sf_{r}\right)+V1+V2+V3+g\left(V4,df_{4}\right)+g\left(V5,df_{5}\right)</code>
</p>

<p>where <code class="reqn">sf_{r}</code> is a seasonal factor with period <code class="reqn">r</code> and <code class="reqn">df_{i}</code> is the degree of freedom of the smoother of the <em>i</em>-th covariate. Actually, two new formulae will be created:
</p>
<p style="text-align: center;"><code class="reqn">~sf_{1}+\dots+sf_{r}+V1+V2+V3</code>
</p>

<p>and
</p>
<p style="text-align: center;"><code class="reqn">~V4+V5</code>
</p>

<p>These two formulae will be used to build the necessary datasets for model estimation. <em>Dummy</em> variables reproducing the seasonal factors will be created also.
</p>
<p>Models without explanatory variables must be specified as in the following formula
</p>
<p style="text-align: center;"><code class="reqn">Y~NULL</code>
</p>

<p>There are a lot of details to be written. It will be very soon.
</p>
<p>Specific information can be obtained on functions help.
</p>
<p>This algorithm fits fully parametric Poisson-Gamma model also.
</p>


<h3>Value</h3>

<p>List containing an object of class <code>pgam</code>.
</p>


<h3>Author(s)</h3>

<p>Washington Leite Junger <a href="mailto:wjunger@ims.uerj.br">wjunger@ims.uerj.br</a> and Antonio Ponce de Leon <a href="mailto:ponce@ims.uerj.br">ponce@ims.uerj.br</a>
</p>


<h3>References</h3>

<p>Junger, W. L. (2004) Semiparametric Poisson-Gamma models: a roughness penalty approach. MSc Dissertation. Rio de Janeiro, PUC-Rio, Department of Electrical Engineering. 
</p>
<p>Harvey, A. C., Fernandes, C. (1989) Time series models for count data or qualitative observations. Journal of Business and Economic Statistics, 7(4):407â€“417
</p>
<p>Green, P. J., Silverman, B. W. (1994) Nonparametric Regression and Generalized Linear Models: a roughness penalty approach. Chapman and Hall, London
</p>


<h3>See Also</h3>

<p><code>predict.pgam</code>, <code>formparser</code>, <code>residuals.pgam</code>, <code>backfitting</code></p>


<h3>Examples</h3>

<pre><code class="language-R">library(pgam)
data(aihrio)
attach(aihrio)
form &lt;- ITRESP5~f(WEEK)+HOLIDAYS+rain+PM+g(tmpmax,7)+g(wet,3)
m &lt;- pgam(form,aihrio,omega=.8,beta=.01,maxit=1e2,eps=1e-4,optim.method="BFGS")

summary(m)

</code></pre>


</div>