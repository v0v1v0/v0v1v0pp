<div class="container">

<table style="width: 100%;"><tr>
<td>data_filtering</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>Filtering a data set for further price index calculations</h2>

<h3>Description</h3>

<p>This function returns a filtered data set, i.e. a reduced user's data frame with the same columns and rows limited by a criterion defined by <code>filters</code>.
</p>


<h3>Usage</h3>

<pre><code class="language-R">data_filtering(
  data,
  start,
  end,
  filters = c(),
  plimits = c(),
  pquantiles = c(),
  dplimits = c(),
  lambda = 1.25,
  interval = FALSE,
  retailers = FALSE
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>data</code></td>
<td>
<p>The user's data frame with information about products to be filtered. It must contain columns: <code>time</code> (as Date in format: year-month-day, e.g. '2020-12-01'), <code>prices</code> (as positive numeric) and <code>quantities</code>  (as positive numeric).</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>start</code></td>
<td>
<p>The base period (as character) limited to the year and month, e.g. "2020-03".</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>end</code></td>
<td>
<p>The research period (as character) limited to the year and month, e.g. "2020-04".</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>filters</code></td>
<td>
<p>A vector of filter names (options are: <code>extremeprices</code>, <code>dumpprices</code> and/or <code>lowsales</code>).</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>plimits</code></td>
<td>
<p>A two-dimensional vector of thresholds  for minimum and maximum price change (it works if one of the chosen filters is <code>extremeprices</code> filter).</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>pquantiles</code></td>
<td>
<p>A two-dimensional vector of quantile levels for minimum and maximum price change (it works if one of the chosen filters is <code>extremeprices</code> filter).</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>dplimits</code></td>
<td>
<p>A two-dimensional vector of thresholds for maximum price drop and maximum drop in sales value (it works if one of the chosen filters is <code>dumpprices</code> filter).</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>lambda</code></td>
<td>
<p>The lambda parameter for <code>lowsales</code> filter (see <code>References</code> below).</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>interval</code></td>
<td>
<p>A logical value indicating whether the filtering process concerns only two periods defined by <code>start</code> and <code>end</code> parameters (then the <code>interval</code> is set to FALSE) or whether that function is to filter products sold during the whole time interval &lt;start, end&gt;, i.e. any subsequent months are compared.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>retailers</code></td>
<td>
<p>A logical parameter indicating whether filtering should be done for each outlet (<code>retID</code>) separately. If it is set to FALSE, then there is no need to consider the <code>retID</code> column.</p>
</td>
</tr>
</table>
<h3>Value</h3>

<p>This function returns a filtered data set (a reduced user's data frame). If the set of <code>filters</code> is empty, then the function returns the original data frame (defined by the <code>data</code> parameter) limited to considered months. On the other hand, if all filters are chosen, i.e. <code>filters=c(extremeprices,dumpprices,lowsales)</code>, then these filters work independently and a summary result is returned. Please note that both variants of <code>extremeprices</code> filter can be chosen at the same time, i.e. <code>plimits</code> and <code>pquantiles</code>, and they work also independently.
</p>


<h3>References</h3>

<p>Van Loon, K., Roels, D. (2018) <em>Integrating big data in Belgian CPI</em>. Meeting of the Group of Experts on Consumer Price Indices, Geneva.
</p>


<h3>Examples</h3>

<pre><code class="language-R">data_filtering(milk,start="2018-12",end="2019-03",
filters=c("extremeprices"),pquantiles=c(0.01,0.99),interval=TRUE)
data_filtering(milk,start="2018-12",end="2019-03",
filters=c("extremeprices","lowsales"), plimits=c(0.25,2))
</code></pre>


</div>