<div class="container">

<table style="width: 100%;"><tr>
<td>e_test</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>Poisson E-test</h2>

<h3>Description</h3>

<p>Tests differences in two Poisson means or rates.
</p>


<h3>Usage</h3>

<pre><code class="language-R">e_test(k1, k2, n1 = 1, n2 = 1, d = 0, eps = 1e-20, silent = FALSE)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>k1</code></td>
<td>
<p>scaler Poisson count</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>k2</code></td>
<td>
<p>scaler Poisson count</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>n1</code></td>
<td>
<p>scaler divisor for k1 (e.g. rate per unit time or per area), default 1</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>n2</code></td>
<td>
<p>scaler divisor for k2 (e.g. rate per unit time or per area), default 1</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>d</code></td>
<td>
<p>scaler amends the null test by a constant amount, default 0</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>eps</code></td>
<td>
<p>scaler where to terminate sum in testing larger deviations, default 1e-20</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>silent</code></td>
<td>
<p>boolean if TRUE, does not print error messages</p>
</td>
</tr>
</table>
<h3>Details</h3>

<p>This e-test tests the differences in two Poisson counts or rates. The null is more formally:
</p>
<p style="text-align: center;"><code class="reqn">k_1/n_1 = k_2/n_2 + d</code>
</p>

<p>Note, I would be wary using the test for Poisson counts over 100 (the tail approximation in the sums will have issues, as the PMF is so spread out). (It is also the case with <em>very</em> large k's, e.g. <code>e_test(4000,4000)</code> my function could run out of memory.) In that case may use the n arguments to make it a rate per some unit time (which can change the p-value, although for smaller counts/rates should be very close).
</p>


<h3>Value</h3>

<p>A scaler p-value. Will return -1 if inputs don't make sense and print an error message, e.g. <code>e_test(0,0)</code> is undefined and will return a -1.
</p>


<h3>References</h3>

<p>Krishnamoorthy, K., &amp; Thomson, J. (2004). A more powerful test for comparing two Poisson means. <em>Journal of Statistical Planning and Inference</em>, 119(1), 23-35.
</p>


<h3>See Also</h3>

<p><code>wdd()</code>, can use that function for a normal based approximation to the difference in Poisson means as well as pre/post designs
</p>


<h3>Examples</h3>

<pre><code class="language-R"># For small N, changes in rates should result in same p-value minus floating point differences
e_test(3,0)
e_test(3,0,2,2)

# Not defined
e_test(0,0) #returns -1 and prints warning

# The same rates
e_test(20,10,4,2)
e_test(10,5,2,1) #not quite the same

# Order of counts/rates should not matter
e_test(6,2) #second example from Krishnamoorthy article
e_test(2,6) #when d=0, can switch arguments and get the same p-value

# These are not the same however, due to how the variance estimates work
e_test(3,2)
e_test(3,1,d=1)
</code></pre>


</div>