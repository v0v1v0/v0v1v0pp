<div class="container">

<table style="width: 100%;"><tr>
<td>GEX_cluster_genes_heatmap</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>Heatmap of cluster defining genes</h2>

<h3>Description</h3>

<p>Produces a heatmap displaying the expression of the top genes that define each cluster in the Seurat object. The output heatmap is derived from DoHeatmap from Seurat and thereby can be edited using typical ggplot interactions. The number of genes per cluster and the nunber of cells to display can be specified by the user. Either the log fold change or the p value can be used to select the top n genes.
</p>


<h3>Usage</h3>

<pre><code class="language-R">GEX_cluster_genes_heatmap(
  GEX,
  GEX_cluster_genes.output,
  n.genes.per.cluster,
  metric,
  max.cell,
  group.colors,
  slot,
  platypus.version
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>GEX</code></td>
<td>
<p>Output Seurat object of either automate_GEX for platypus.version v2 or of VDJ_GEX_matrix for platypus.version v3 (usually VDJ_GEX_matrix.output[[2]])</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>GEX_cluster_genes.output</code></td>
<td>
<p>The output from the GEX_cluster_genes function - this should be a list with each list element corresponding to the genes, p values, logFC, pct expression for the genes deferentially regulated for each cluster.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>n.genes.per.cluster</code></td>
<td>
<p>An integer value determining how many genes per cluster to display in the output heatmap. This number should be adjusted based on the number of clusters. Too many genes per cluster and clusters may cause a problem with the heatmap function in Seurat.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>metric</code></td>
<td>
<p>The metric that dictates which are the top n genes returned. Possible options are "p.value" (default), "avg_logFC", "top_logFC", "bottom_logFC". "top_logFC" returns the top expressed genes for each cluster, whereas "bottom_logFC" returns the least expressed genes per cluster-both by log fold change.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>max.cell</code></td>
<td>
<p>The max number of cells to display in the heatmap for each cluster, which corresponds to the number of columns. Default is set to 100 cells per cluster.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>group.colors</code></td>
<td>
<p>Optional character vector. Array of colors with the same length as GEX_cluster_genes.output to color bars above the heatmap. Defaults to rainbow palette</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>slot</code></td>
<td>
<p>Seurat object slot from which to plot gene expression data.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>platypus.version</code></td>
<td>
<p>is set automatically</p>
</td>
</tr>
</table>
<h3>Value</h3>

<p>Returns a heatmap from the function DoHeatmap from the package Seurat, which is a ggplot object that can be modified or plotted. The number of genes is determined by the n.genes parameter and the number of cells per cluster is determined by the max.cell argument. This function gives a visual description of the top genes differentially expressed in each cluster.
</p>


<h3>Examples</h3>

<pre><code class="language-R">
try({
GEX_cluster_genes_output &lt;- GEX_cluster_genes(GEX =
subset(Platypus::small_vgm[[2]],
seurat_clusters %in% c(0,1)), min.pct = .25
, filter = c("MT-", "RPL", "RPS"))

cluster_defining_gene_heatmap &lt;- GEX_cluster_genes_heatmap(GEX =
Platypus::small_vgm[[2]]
,GEX_cluster_genes.output=GEX_cluster_genes_output
,n.genes.per.cluster=5,metric="p.value",max.cell=5)
})

</code></pre>


</div>