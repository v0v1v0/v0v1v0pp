<div class="container">

<table style="width: 100%;"><tr>
<td>Pmat</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>Create a set of permutations/signflips.</h2>

<h3>Description</h3>

<p>Compute a permutation matrix used as argument in aovperm, lmperm, clusterlm functions. The first column represents the identity permutation. Generally not suited for the "huh_jhun" method, as the dimension of this matrix does not correspond to the number of observations and may vary for different factors.
</p>


<h3>Usage</h3>

<pre><code class="language-R">Pmat(np = 5000, n, type = "permutation", counting = "random")
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>np</code></td>
<td>
<p>A numeric value for the number of permutations. Default is 5000.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>n</code></td>
<td>
<p>A numeric value for the number of observations.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>type</code></td>
<td>
<p>A character string to specify the type of transformations: "permutation" and "signflip" are available. See details.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>counting</code></td>
<td>
<p>A character string to specify the selection of the transformations. "all" and "random" are available. See details.</p>
</td>
</tr>
</table>
<h3>Details</h3>

<p><code>couting</code> can set to :<br><code>"random"</code> : <code>np</code> random with replacement permutations/signflips among the <code>n!</code>/<code>2^n</code>  permutations/signflips.<br><code>"all"</code> : all <code>n!</code>/<code>2^n</code> possible permutations/signflips.<br></p>


<h3>Value</h3>

<p>A matrix n x np containing the permutations/signflips. First permutation is the identity.
</p>


<h3>See Also</h3>

<p>Other pmat: 
<code>Pmat_product()</code>,
<code>as.Pmat()</code>
</p>


<h3>Examples</h3>

<pre><code class="language-R">## data
data("emergencycost")

## Create a set of 2000 permutations
set.seed(42)
pmat = Pmat(np = 2000, n = nrow(emergencycost))
sfmat = Pmat(np = 2000, n = nrow(emergencycost), type = "signflip")

## centrering the covariate to the mean
emergencycost$LOSc &lt;- scale(emergencycost$LOS, scale = FALSE)

## ANCOVA
mod_cost_0 &lt;- aovperm(cost ~ LOSc*sex*insurance, data = emergencycost, np = 2000)
mod_cost_1 &lt;- aovperm(cost ~ LOSc*sex*insurance, data = emergencycost, P = pmat)
mod_cost_2 &lt;- aovperm(cost ~ LOSc*sex*insurance, data = emergencycost, P = pmat)
mod_cost_3 &lt;- aovperm(cost ~ LOSc*sex*insurance, data = emergencycost, P = sfmat)
mod_cost_4 &lt;- aovperm(cost ~ LOSc*sex*insurance, data = emergencycost,type="signflip")

## Same p-values for both models 1 and 2 but different of model 0
mod_cost_0
mod_cost_1
mod_cost_2
mod_cost_3
mod_cost_4

</code></pre>


</div>