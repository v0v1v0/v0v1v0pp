<div class="container">

<table style="width: 100%;"><tr>
<td>plot_admix</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>Make a structure/admixture plot</h2>

<h3>Description</h3>

<p>This function facilitates structure plots with options that resemble those of <code>plot_popkin()</code> in name and results.
The biggest difference is this function plots single panels (technically 2 panels including the legend, unless it is omitted), whereas <code>plot_popkin()</code> can plot multiple kinship matrices with a shared legend.
</p>


<h3>Usage</h3>

<pre><code class="language-R">plot_admix(
  Q,
  col = RColorBrewer::brewer.pal(max(ncol(Q), 3), "Paired"),
  mar_pad = 0.2,
  panel_letters = NA,
  panel_letters_cex = 1.5,
  panel_letters_adj = -0.1,
  axis_lab_cex = 1,
  xlab = "Individuals",
  xlab_line = 1,
  xlab_cex = axis_lab_cex,
  ylab = "Ancestry",
  ylab_line = 2,
  ylab_side = 2,
  ylab_cex = axis_lab_cex,
  leg_title = "Ancestries",
  leg_title_cex = axis_lab_cex,
  leg_title_line = 2,
  leg_cex = 1,
  leg_mar = leg_title_line + 1,
  leg_width = 0.2,
  leg_las = 0,
  leg_omit = FALSE,
  layout_add = !leg_omit,
  names = FALSE,
  names_cex = 1,
  names_line = NA,
  names_las = 2,
  labs = NULL,
  labs_cex = 1,
  labs_las = 0,
  labs_line = 0,
  labs_sep = TRUE,
  labs_lwd = 1,
  labs_col = "black",
  labs_ticks = FALSE,
  labs_text = TRUE,
  labs_even = FALSE,
  ...
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>Q</code></td>
<td>
<p>The admixture proportions matrix, with <code>n</code> individuals along rows and <code>K</code> ancestries along columns.
Rows should sum to 1, but this is not enforced.
There must be at least 2 ancestries.
The ancestry labels used by the legend must be the column names, which are unlabeled if the column names are missing.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>col</code></td>
<td>
<p>A vector of at least <code>K</code> colors for the ancestries (extra colors are ignored).
By default uses the "Paired" palette of <code>RColorBrewer</code>, which has at most 12 colors, so please provide colors if <code>K &gt; 12</code>.
Since the minimum number of colors for "Paired" is 3, when <code>K = 2</code> we ask for 3 colors, then remove the middle color internally.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>mar_pad</code></td>
<td>
<p>Margin padding used for legend panel only (margins for first/main panel are not altered by this function).</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>panel_letters</code></td>
<td>
<p>Panel letter to include in first/main panel (default <code>NA</code> is no letter).
Despite name (matches <code>plot_popkin()</code>), must be scalar.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>panel_letters_cex</code></td>
<td>
<p>Scaling factor of panel letter (default 1.5).</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>panel_letters_adj</code></td>
<td>
<p>X-axis adjustment for panel letter (default -0.1).
Negative values place the letter into the left margin area.
Might need adjustment depending on the size of the left margin.
</p>
<p>AXIS LABEL OPTIONS</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>axis_lab_cex</code></td>
<td>
<p>Scaling factor for x-axis, y-axis, and legend title labels (which can also be set individually, see below).</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>xlab</code></td>
<td>
<p>X-axis label (default "Individuals").
Set to <code>NA</code> to omit.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>xlab_line</code></td>
<td>
<p>The value of <code>line</code> for <code>xlab</code> passed to <code>graphics::mtext()</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>xlab_cex</code></td>
<td>
<p>Scaling factor for x-axis label.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>ylab</code></td>
<td>
<p>Y-axis label (default "Ancestry").
Set to <code>NA</code> to omit.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>ylab_line</code></td>
<td>
<p>The value of <code>line</code> for <code>ylab</code> passed to <code>graphics::mtext()</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>ylab_side</code></td>
<td>
<p>The value of <code>side</code> for <code>ylab</code> passed to <code>graphics::mtext()</code> (2 is y-axis, 1 is x-axis, can also place on top (3) or right (4)).</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>ylab_cex</code></td>
<td>
<p>Scaling factor for y-axis label.
</p>
<p>LEGEND (COLOR KEY) OPTIONS</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>leg_title</code></td>
<td>
<p>The name of the categorical ancestry variable (default "Ancestries").</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>leg_title_cex</code></td>
<td>
<p>Scaling factor for legend title label.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>leg_title_line</code></td>
<td>
<p>The value of <code>line</code> for <code>leg_title</code> passed to <code>graphics::mtext()</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>leg_cex</code></td>
<td>
<p>Scaling factor for ancestry labels.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>leg_mar</code></td>
<td>
<p>Margin values for the kinship legend panel only.
A length-4 vector (in <code>c( bottom, left, top, right )</code> format that <code>graphics::par()</code> 'mar' expects) specifies the full margins, to which <code>mar_pad</code> is added.
Otherwise, the margins used in the last panel are preserved with the exception that the left margin is set to <code>mar_pad</code>, and if <code>leg_mar</code> is length-1 (default), it is added to <code>mar_pad</code> to specify the right margin.
By default the right margin is large enough to accommodate <code>leg_title</code> for the given value of <code>leg_title_line</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>leg_width</code></td>
<td>
<p>The width of the legend panel, relative to the width of the main panel.
This value is passed to <code>graphics::layout()</code> (ignored if <code>layout_add = FALSE</code>).</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>leg_las</code></td>
<td>
<p>The ancestry label orientations (in format that <code>graphics::mtext()</code> expects).</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>leg_omit</code></td>
<td>
<p>If <code>TRUE</code>, no legend (second panel) is produced (default <code>FALSE</code> is to include legend).</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>layout_add</code></td>
<td>
<p>If <code>TRUE</code> (default) then <code>graphics::layout()</code> is called internally to create two panels: the main panel and the color key legend.
The original layout is reset when plotting is complete and if <code>layout_add = TRUE</code>.
If a non-standard layout or additional panels (beyond those provided by this function) are desired, set to <code>FALSE</code> and call <code>graphics::layout()</code> yourself beforehand.
</p>
<p>INDIVIDUAL LABEL OPTIONS</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>names</code></td>
<td>
<p>If <code>TRUE</code>, the row (individual) names are plotted in the structure barplot.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>names_cex</code></td>
<td>
<p>Scaling factor for the individual names.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>names_line</code></td>
<td>
<p>Line where individual names are placed.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>names_las</code></td>
<td>
<p>Orientation of labels relative to axis.
Default (2) makes labels perpendicular to axis.
</p>
<p>SUBPOPULATION LABEL OPTIONS</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>labs</code></td>
<td>
<p>Subpopulation labels for individuals in the admixture matrix.
Use a matrix of labels to show groupings at more than one level (for a hierarchy or otherwise).</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>labs_cex</code></td>
<td>
<p>A vector of label scaling factors for each level of labs.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>labs_las</code></td>
<td>
<p>A vector of label orientations (in format that <code>graphics::mtext()</code> expects) for each level of labs.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>labs_line</code></td>
<td>
<p>A vector of lines where labels are placed (in format that <code>graphics::mtext()</code> expects) for each level of labs.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>labs_sep</code></td>
<td>
<p>A vector of logicals that specify whether lines separating the subpopulations are drawn for each level of labs.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>labs_lwd</code></td>
<td>
<p>A vector of line widths for the lines that divide subpopulations (if <code>labs_sep = TRUE</code>) for each level of labs.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>labs_col</code></td>
<td>
<p>A vector of colors for the lines that divide subpopulations (if <code>labs_sep = TRUE</code>) for each level of labs.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>labs_ticks</code></td>
<td>
<p>A vector of logicals that specify whether ticks separating the subpopulations are drawn for each level of labs.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>labs_text</code></td>
<td>
<p>A vector of logicals that specify whether the subpopulation labels are shown for each level of labs.
Useful for including separating lines or ticks without text.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>labs_even</code></td>
<td>
<p>A vector of logicals that specify whether the subpopulations labels are drawn with equal spacing for each level of labs.
When <code>TRUE</code>, lines mapping the equally-spaced labels to the unequally-spaced subsections of the heatmap are also drawn.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>...</code></td>
<td>
<p>Additional options passed to <code>graphics::barplot()</code>.</p>
</td>
</tr>
</table>
<h3>See Also</h3>

<p><code>admix_order_cols()</code> to automatically order ancestries given ordered individuals.
</p>
<p><code>admix_label_cols()</code> to automatically assign labels to ancestries given labels to individuals.
</p>


<h3>Examples</h3>

<pre><code class="language-R"># create random proportions for two ancestries
Q &lt;- runif( 10 )
Q &lt;- cbind( Q, 1 - Q )
# add ancestry names
colnames( Q ) &lt;- c('A1', 'A2')

# plot this data!
plot_admix( Q )

# See vignette for more elaborate examples!

</code></pre>


</div>