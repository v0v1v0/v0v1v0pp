<div class="container">

<table style="width: 100%;"><tr>
<td>ph_comstruct</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>comstruct</h2>

<h3>Description</h3>

<p>Calculates mean phylogenetic distance (MPD) and mean nearest
phylogenetic taxon distance (MNTD; aka MNND) for each sample, and
compares them to MPD/MNTD values for randomly generated samples
(null communities) or phylogenies.
</p>


<h3>Usage</h3>

<pre><code class="language-R">ph_comstruct(
  sample,
  phylo,
  null_model = 0,
  randomizations = 999,
  swaps = 1000,
  abundance = TRUE
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>sample</code></td>
<td>
<p>(data.frame/character) sample data.frame or path to a
sample file</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>phylo</code></td>
<td>
<p>(character/phylo) One of: phylogeny as a newick string (will be
written to a temp file) - OR path to file with a newick
string - OR a an <span class="pkg">ape</span> <code>phylo</code> object. required.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>null_model</code></td>
<td>
<p>(integer) which null model to use. See Details.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>randomizations</code></td>
<td>
<p>(numeric) number of randomizations. Default: 999</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>swaps</code></td>
<td>
<p>(numeric) number of swaps. Default: 1000</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>abundance</code></td>
<td>
<p>(logical) If <code>TRUE</code> (default) computed accounting
for abundance. Otherwise, uses presence-absence.</p>
</td>
</tr>
</table>
<h3>Details</h3>

<p>See phylocomr-inputs for expected input formats
</p>


<h3>Value</h3>

<p>data.frame
</p>


<h3>Null models</h3>


<ul>
<li>
<p> 0 - Phylogeny shuffle: This null model shuffles species labels across
the entire phylogeny. This randomizes phylogenetic relationships among
species.
</p>
</li>
<li>
<p> 1 - Species in each sample become random draws from sample pool:
This null model maintains the species richness of each sample, but the
identities of the species occurring in each sample are randomized. For
each sample, species are drawn without replacement from the list of all
species actually occurring in at least one sample. Thus, species in the
phylogeny that are not actually observed to occur in a sample will not
be included in the null communities
</p>
</li>
<li>
<p> 2 - Species in each sample become random draws from phylogeny pool:
This null model maintains the species richness of each sample, but the
identities of the species occurring in each sample are randomized. For
each sample, species are drawn without replacement from the list of all
species in the phylogeny pool. All species in the phylogeny will have
equal probability of being included in the null communities. By changing
the phylogeny, different species pools can be simulated. For example, the
phylogeny could include the species present in some larger region.
</p>
</li>
<li>
<p> 3 - Independent swap: The independent swap algorithm (Gotelli and
Entsminger, 2003); also known as ‘SIM9’ (Gotelli, 2000) creates swapped
versions of the sample/species matrix.
</p>
</li>
</ul>
<h3>Taxon name case</h3>

<p>In the <code>sample</code> table, if you're passing in a file, the names in the
third column must be all lowercase; if not, we'll lowercase them for you.
If you pass in a data.frame, we'll lowercase them for your. All phylo
tip/node labels are also lowercased to avoid any casing problems
</p>


<h3>Examples</h3>

<pre><code class="language-R">sfile &lt;- system.file("examples/sample_comstruct", package = "phylocomr")
pfile &lt;- system.file("examples/phylo_comstruct", package = "phylocomr")

# from data.frame
sampledf &lt;- read.table(sfile, header = FALSE,
  stringsAsFactors = FALSE)
phylo_str &lt;- readLines(pfile)
(res &lt;- ph_comstruct(sample = sampledf, phylo = phylo_str))

# from files
sample_str &lt;- paste0(readLines(sfile), collapse = "\n")
sfile2 &lt;- tempfile()
cat(sample_str, file = sfile2, sep = '\n')
pfile2 &lt;- tempfile()
cat(phylo_str, file = pfile2, sep = '\n')
(res &lt;- ph_comstruct(sample = sfile2, phylo = pfile2))

# different null models
ph_comstruct(sample = sfile2, phylo = pfile2, null_model = 0)
ph_comstruct(sample = sfile2, phylo = pfile2, null_model = 1)
ph_comstruct(sample = sfile2, phylo = pfile2, null_model = 2)
# ph_comstruct(sample = sfile2, phylo = pfile2, null_model = 3)
</code></pre>


</div>