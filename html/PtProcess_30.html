<div class="container">

<table style="width: 100%;"><tr>
<td>dpareto</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>Pareto and Tapered Pareto Distributions</h2>

<h3>Description</h3>

<p>Density, cumulative probability, quantiles and random number generation for the Pareto and tapered Pareto distributions with shape parameter <code class="reqn">\lambda</code>, tapering parameter <code class="reqn">\theta</code> and range <code class="reqn">a \le x &lt; \infty</code>; and log-likelihood of the tapered Pareto distribution.
</p>


<h3>Usage</h3>

<pre><code class="language-R">dpareto(x, lambda, a, log=FALSE)
ppareto(q, lambda, a, lower.tail=TRUE, log.p=FALSE)
qpareto(p, lambda, a, lower.tail=TRUE, log.p=FALSE)
rpareto(n, lambda, a)

dtappareto(x, lambda, theta, a, log=FALSE)
ltappareto(data, lambda, theta, a)
ptappareto(q, lambda, theta, a, lower.tail=TRUE, log.p=FALSE)
qtappareto(p, lambda, theta, a, lower.tail=TRUE, log.p=FALSE,
           tol=1e-8)
rtappareto(n, lambda, theta, a)

ltappareto(data, lambda, theta, a)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>x, q</code></td>
<td>
<p>vector of quantiles.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>p</code></td>
<td>
<p>vector of probabilities.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>data</code></td>
<td>
<p>vector of sample data.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>n</code></td>
<td>
<p>number of observations to simulate.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>lambda</code></td>
<td>
<p>shape parameter, see Details below.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>theta</code></td>
<td>
<p>tapering parameter, see Details below..</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>a</code></td>
<td>
<p>the random variable takes values on the interval <code class="reqn">a \le x &lt; \infty</code>. This is a scalar and is assumed to be a constant for all values in a given function call.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>log, log.p</code></td>
<td>
<p>logical; if <code>TRUE</code>, probabilities <code>p</code> are given as <code>log(p)</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>lower.tail</code></td>
<td>
<p>logical; if <code>TRUE</code> (default), probabilities are <code class="reqn">\Pr\{X \le x\}</code>, otherwise, <code class="reqn">\Pr\{X &gt; x\}</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>tol</code></td>
<td>
<p>convergence criteria for the Newton Raphson algorithm for solving the quantiles of the tapered Pareto distribution.</p>
</td>
</tr>
</table>
<h3>Details</h3>

<p>For all functions except <code>ltappareto</code>, arguments <code>lambda</code> and <code>theta</code> can either be scalars or vectors of the same length as <code>x</code>, <code>p</code>, or <code>q</code>. If a scalar, then this value is assumed to hold over all cases. If a vector, then the values are assumed to have a one to one relationship with the values in <code>x</code>, <code>p</code>, or <code>q</code>. The argument <code>a</code> is a scalar.
</p>
<p>In the case of <code>ltappareto</code>, all <code>data</code> are assumed to be drawn from the same distribution and hence <code>lambda</code>, <code>theta</code> and <code>a</code> are all scalars.
</p>
<p>Let <code class="reqn">Y</code> be an exponential random variable with parameter <code class="reqn">\lambda &gt; 0</code>. Then the distribution function of <code class="reqn">Y</code> is
</p>
<p style="text-align: center;"><code class="reqn">
F_Y(y) = \Pr\{Y &lt; y \} = 1 - \exp(-\lambda y),
</code>
</p>

<p>and the density function is
</p>
<p style="text-align: center;"><code class="reqn">
f_Y(y) = \lambda \exp(-\lambda y).
</code>
</p>

<p>Further, the mean and variance of the distribution of <code class="reqn">Y</code> is <code class="reqn">1/\lambda</code> and <code class="reqn">1/\lambda^2</code>, respectively.
</p>
<p>Now transform <code class="reqn">Y</code> as
</p>
<p style="text-align: center;"><code class="reqn">
X = a \exp(Y),
</code>
</p>

<p>where <code class="reqn">a&gt;0</code>. Then <code class="reqn">X</code> is a Pareto random variable with shape parameter <code class="reqn">\lambda</code> and distribution function
</p>
<p style="text-align: center;"><code class="reqn">
F_X(x) = \Pr\{X &lt; x \} = 1 - \left( \frac{a}{x} \right)^\lambda,
</code>
</p>

<p>where <code class="reqn">a \le x &lt; \infty</code>, and density function
</p>
<p style="text-align: center;"><code class="reqn">
f_X(x) = \frac{\lambda}{a} \left( \frac{a}{x} \right)^{\lambda+1}.
</code>
</p>

<p>We simulate the Pareto deviates by generating exponential deviates, and then transforming as described above.
</p>
<p>As above, let <code class="reqn">X</code> be Pareto with shape parameter <code class="reqn">\lambda</code>, and define <code class="reqn">W - a</code> to be exponential with parameter <code class="reqn">1/\theta</code>, i.e.
</p>
<p style="text-align: center;"><code class="reqn">
\Pr\{X &gt; x\} = \left( \frac{a}{x} \right)^\lambda
</code>
</p>

<p>and
</p>
<p style="text-align: center;"><code class="reqn">
\Pr\{W &gt; w\} = \exp\left( \frac{a - w}{\theta} \right),
</code>
</p>

<p>where <code class="reqn">a \le w &lt; \infty</code>. Say we sample one independent value from each of the distributions <code class="reqn">X</code> and <code class="reqn">W</code>, then
</p>
<p style="text-align: center;"><code class="reqn">
\Pr\{X &gt; z\ \&amp;\ W &gt; z\} = \Pr\{X &gt; z\} \Pr\{ W &gt; z\} = \left( \frac{a}{z} \right)^\lambda \exp\left( \frac{a - z}{\theta} \right).
</code>
</p>

<p>We say that <code class="reqn">Z</code> has a tapered Pareto distribution if it has the above distribution, i.e.
</p>
<p style="text-align: center;"><code class="reqn">
F_Z(z) = \Pr\{Z &lt; z\} = 1- \left( \frac{a}{z} \right)^\lambda \exp\left( \frac{a - z}{\theta} \right).
</code>
</p>

<p>The above relationship shows that a tapered Pareto deviate can be simulated by generating independent values of <code class="reqn">X</code> and <code class="reqn">W</code>, and then letting <code class="reqn">Z = \min(X, W)</code>. This minimum has the effect of “tapering” the tail of the Pareto distribution.
</p>
<p>The tapered Pareto variable <code class="reqn">Z</code> has density
</p>
<p style="text-align: center;"><code class="reqn">
f_Z(z) = \left( \frac{\lambda}{z} + \frac{1}{\theta} \right) \left( \frac{a}{z} \right)^\lambda \exp\left( \frac{a - z}{\theta} \right).
</code>
</p>

<p>Given a sample of data <code class="reqn">z_1, z_2, \cdots, z_n</code>, we write the log-likelihood as
</p>
<p style="text-align: center;"><code class="reqn">
\log L = \sum_{i=1}^n \log f_Z(z_i).
</code>
</p>

<p>Hence the gradients are calculated as
</p>
<p style="text-align: center;"><code class="reqn">
\frac{\partial \log L}{\partial \lambda} = \theta \sum_{i=1}^n \frac{1}{\lambda \theta + z_i} - \sum_{i=1}^n \log(z_i/a)
</code>
</p>

<p>and
</p>
<p style="text-align: center;"><code class="reqn">
\frac{\partial \log L}{\partial \theta} = \frac{-1}{\theta} \sum_{i=1}^n \frac{z_i}{\lambda \theta + z_i} - \frac{1}{\theta^2} \sum_{i=1}^n (a - z_i).
</code>
</p>

<p>Further, the Hessian is calculated using
</p>
<p style="text-align: center;"><code class="reqn">
\frac{\partial^2 \log L}{\partial \lambda^2} = -\theta^2 \sum_{i=1}^n \frac{1}{(\lambda \theta + z_i)^2},
</code>
</p>

<p style="text-align: center;"><code class="reqn">
\frac{\partial^2 \log L}{\partial \theta^2} = \frac{1}{\theta^2} \sum_{i=1}^n \frac{z_i(2\lambda\theta + z_i)}{(\lambda \theta + z_i)^2} - \frac{2}{\theta^3} \sum_{i=1}^n (a - z_i),
</code>
</p>

<p>and
</p>
<p style="text-align: center;"><code class="reqn">
\frac{\partial^2 \log L}{\partial \theta \, \partial \lambda} = \frac{\partial^2 \log L}{\partial \lambda \, \partial \theta} = \sum_{i=1}^n \frac{z_i}{(\lambda \theta + z_i)^2}.
</code>
</p>

<p>See the section “Seismological Context” (below), which outlines its application in Seismology.
</p>


<h3>Value</h3>

<p><code>dpareto</code> and <code>dtappareto</code> give the densities; <code>ppareto</code> and <code>ptappareto</code> give the distribution functions; <code>qpareto</code> and <code>qtappareto</code> give the quantile functions; and <code>rpareto</code> and <code>rtappareto</code> generate random deviates.
</p>
<p><code>ltappareto</code> returns the log-likelihood of a sample using the tapered Pareto distribution. It also calculates, using analytic expressions (see “Details”), the derivatives and Hessian which are attached to the log-likelihood value as the attributes <code>"gradient"</code> and <code>"hessian"</code>, respectively.
</p>


<h3>Seismological Context</h3>

<p>The Gutenberg-Richter (GR) Law says that if we plot the base 10 logarithm of the number of events with magnitude greater than <code class="reqn">M</code> (vertical axis) against <code class="reqn">M</code> (horizontal axis), there should be a straight line. This is equivalent to magnitudes having an exponential distribution.
</p>
<p>Assume that the magnitude cutoff is <code class="reqn">M_0</code>, and let <code class="reqn">Y = M - M_0</code>. Given that <code class="reqn">Y</code> has an exponential distribution with parameter <code class="reqn">\lambda</code>, it follows that
</p>
<p style="text-align: center;"><code class="reqn">
\log_{10} \left( 1 - F_Y(y) \right) = \frac{-\lambda y}{\log_e 10}.
</code>
</p>

<p>The coefficient <code class="reqn">\lambda/(\log_e 10)</code> is often referred to as the <code class="reqn">b</code>-value, and its negative value is the slope of the line in the GR plot.
</p>
<p>Now define <code class="reqn">S</code> as
</p>
<p style="text-align: center;"><code class="reqn">
S = 10^{\gamma (M - M_0)} = 10^{\gamma Y}.
</code>
</p>

<p>When <code class="reqn">\gamma = 0.75</code>, <code class="reqn">S</code> is the “stress”; and when <code class="reqn">\gamma = 1.5</code>, <code class="reqn">S</code> is the “seismic moment”. Still assuming that <code class="reqn">Y</code> is exponential with parameter <code class="reqn">\lambda</code>, then <code class="reqn">Y \gamma \log_e 10</code> is also exponential with parameter <code class="reqn">\lambda/(\gamma \log_e 10)</code>. Hence, by noting that <code class="reqn">S</code> can be rewritten as
</p>
<p style="text-align: center;"><code class="reqn">
S = \exp\{ Y \gamma \log_e 10 \},
</code>
</p>

<p>it is seen that <code class="reqn">S</code> is Pareto with parameter <code class="reqn">\lambda/(\gamma \log_e 10)</code>, and <code class="reqn">1 \le S &lt; \infty</code>.
</p>
<p>While the empirical distribution of magnitudes appears to follow an exponential distribution for smaller events, it provides a poor approximation for larger events. This is because it is not physically possible to have events with magnitudes much greater than about 9.5. Consequently, the tail of the Pareto distribution will also be too long. Hence the tapered Pareto distribution provides a more realistic description.
</p>


<h3>See Also</h3>

<p>See <code>dexp</code> for the exponential distribution. Generalisations of the exponential distribution are the gamma distribution <code>dgamma</code> and the Weibull distribution <code>dweibull</code>.
</p>
<p>See the topic <code>distribution</code> for examples of estimating parameters.
</p>


<h3>Examples</h3>

<pre><code class="language-R">#    Simulate and plot histogram with density for Pareto Distribution

a0 &lt;- 2
lambda0 &lt;- 2
x &lt;- rpareto(1000, lambda=lambda0, a=a0)
x0 &lt;- seq(a0, max(x)+0.1, length=100)
hist(x, freq=FALSE, breaks=x0, xlim=range(x0),
     main="Pareto Distribution")
points(x0, dpareto(x0, lambda0, a0), type="l", col="red")

#-----------------------------------------------
#    Calculate probabilities and quantiles for Pareto Distribution

a0 &lt;- 2
lambda0 &lt;- 2
prob &lt;- ppareto(seq(a0, 8), lambda0, a0)
quan &lt;- qpareto(prob, lambda0, a0)
print(quan)

#-----------------------------------------------
#    Simulate and plot histogram with density for tapered Pareto Distribution

a0 &lt;- 2
lambda0 &lt;- 2
theta0 &lt;- 3
x &lt;- rtappareto(1000, lambda=lambda0, theta=theta0, a=a0)
x0 &lt;- seq(a0, max(x)+0.1, length=100)
hist(x, freq=FALSE, breaks=x0, xlim=range(x0),
     main="Tapered Pareto Distribution")
points(x0, dtappareto(x0, lambda0, theta0, a0), type="l", col="red")

#-----------------------------------------------
#    Calculate probabilities and quantiles for tapered Pareto Distribution

a0 &lt;- 2
lambda0 &lt;- 2
theta0 &lt;- 3
prob &lt;- ptappareto(seq(a0, 8), lambda0, theta0, a0)
quan &lt;- qtappareto(prob, lambda0, theta0, a0)
print(quan)

#-----------------------------------------------
#    Calculate log-likelihood for tapered Pareto Distribution
#    note the Hessian and gradient attributes

a0 &lt;- 2
lambda0 &lt;- 2
theta0 &lt;- 3
x &lt;- rtappareto(1000, lambda=lambda0, theta=theta0, a=a0)
LL &lt;- ltappareto(x, lambda=lambda0, theta=theta0, a=a0)
print(LL)

</code></pre>


</div>