<div class="container">

<table style="width: 100%;"><tr>
<td>pag2mag</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>Transform a PAG into a MAG in the Corresponding Markov Equivalence Class</h2>

<h3>Description</h3>

<p>Transform a Partial Ancestral Graph (PAG) into a valid
Maximal Ancestral Graph (MAG) that belongs to the Markov equivalence class
represented by the given PAG, with no additional edges into node <code>x</code>.
</p>


<h3>Usage</h3>

<pre><code class="language-R">pag2magAM(amat.pag, x, max.chordal = 10, verbose = FALSE)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>amat.pag</code></td>
<td>
<p>Adjacency matrix of type amat.pag</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>x</code></td>
<td>
<p>(integer) position in adjacency matrix of node in the PAG into which no additional edges are oriented.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>max.chordal</code></td>
<td>
<p>Positive integer: graph paths larger than
<code>max.chordal</code> are considered to be too large to be checked for
chordality.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>verbose</code></td>
<td>
<p>Logical; if true, some output is produced during
computation.</p>
</td>
</tr>
</table>
<h3>Details</h3>

<p>This function converts a PAG (adjacency matrix) to a valid MAG
(adjacency matrix) that belongs to the Markov equivalence class
represented by the given PAG.  Note that we assume that there are no
selection variables, meaning that the edges in the PAG can be of the
following types: -&gt;, &lt;-&gt;, o-&gt;, and o-o.  In a first step, it uses the
Arrowhead Augmentation of Zhang (2006), i.e., any o-&gt; edge is oriented
into -&gt;.  Afterwards, it orients each chordal component into a valid DAG
without orienting any additional edges into x.
</p>
<p>This function is used in the Generalized Backdoor Criterion
<code>backdoor</code> with <code>type="pag"</code>, see Maathuis and Colombo
(2015) for details.
</p>


<h3>Value</h3>

<p>The output is an adjacency matrix of type amat.pag representing
a valid MAG that belongs to the Markov equivalence class
represented by the given PAG.
</p>


<h3>Author(s)</h3>

<p>Diego Colombo, Markus Kalisch and Martin Maechler.
</p>


<h3>References</h3>

<p>M.H. Maathuis and D. Colombo (2015). A generalized back-door
criterion. <em>Annals of Statistics</em> <b>43</b> 1060-1088.
</p>
<p>Zhang, J. (2006). Causal Inference and Reasoning in Causally
Insufficient Systems. Ph. D. thesis, Carnegie Mellon University.
</p>


<h3>See Also</h3>

<p><code>fci</code>, <code>dag2pag</code>, <code>backdoor</code></p>


<h3>Examples</h3>

<pre><code class="language-R">## create the graph
set.seed(78)
p &lt;- 12
g &lt;- randomDAG(p, prob = 0.4)
## Compute the true covariance and then correlation matrix of g:
true.corr &lt;- cov2cor(trueCov(g))

## define nodes 2 and 6 to be latent variables
L &lt;- c(2,6)

## Find PAG
## As dependence "oracle", we use the true correlation matrix in
## gaussCItest() with a large "virtual sample size" and a large alpha:
true.pag &lt;- dag2pag(suffStat = list(C= true.corr, n= 10^9),
                    indepTest= gaussCItest, graph=g, L=L, alpha= 0.9999)

## find a valid MAG such that no additional edges are directed into
(amat.mag &lt;- pag2magAM(true.pag@amat, 4)) # -&gt; the adj.matrix of the MAG
</code></pre>


</div>