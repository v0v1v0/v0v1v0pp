<div class="container">

<table style="width: 100%;"><tr>
<td>paran</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>Horn's Parallel Analysis of Principal Components/Factors</h2>

<h3>Description</h3>

<p>Performs Horn's parallel analysis for a principal component or common factor analysis, so as to adjust for finite sample bias in the retention of components.
</p>


<h3>Usage</h3>

<pre><code class="language-R">paran(x, iterations=0, centile=0, quietly=FALSE, 
      status=TRUE, all=FALSE, cfa=FALSE, graph=FALSE, 
      color=TRUE, col=c("black","red","blue"), 
      lty=c(1,2,3), lwd=1, legend=TRUE, file="", 
      width=640, height=640, grdevice="png", seed=0, mat=NA, n=NA)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>x</code></td>
<td>
<p>a numeric matrix or data frame for principal component analysis, or common factor analysis.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>iterations</code></td>
<td>
<p>sets the number of iterations with a user specified whole number representing the number of random data sets to be produced in the analysis. The default, indicated by <code>iterations=0</code>, is 30<em>P</em>, where <em>P</em> is the number of variables or columns in <code>x</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>centile</code></td>
<td>
<p>employs Monte Carlo estimates according to the user specified whole number between 1 and 99 indicating the centile used in estimating bias. The default is to use the mean. By selecting a conservative number, such as 95 or 99, and a large number of iterations, <code>paran</code> can be used to perform the modified version of parallel analysis suggested by Glorfeld (1995).</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>quietly</code></td>
<td>
<p>suppresses tabled output of the analysis, and only returns the vector of estimated biases.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>status</code></td>
<td>
<p>indicates progress in the computation. Parallel analysis can take some time to complete given a large data set and/or a large number of iterations. The <code>cfa</code> option may noticably increase the computational requirements of <code>paran</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>all</code></td>
<td>
<p>report all eigenvalues (default reports only those components or factors that are retained).</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>cfa</code></td>
<td>
<p>performs a common factor analysis instead of a principal component analysis. This provides only the unrotated eigenvalues from the common factor model. As of version 1.4.0 <code>paran</code> performs parallel analysis for common factor analysis using a modified method. See Remarks for details.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>graph</code></td>
<td>
<p>requests that a plot of the unadjusted, adjusted, and random eigenvalues in a format similar to that presented by Horn in his 1965 paper. Retained components or factors are indicated by the solid circular markers on the adjusted eigenvaue plot, and non-retained components or factors are indicated with hollow circular markers.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>color</code></td>
<td>
<p>renders the graph in color with unadjusted eigenvalues drawn in red, adjusted eigenvalues drawn in black, and random eigenvalues drawn in blue if <code>color=TRUE</code>, and all lines drawn solid. If <code>color=FALSE</code>, the graph is rendered in black and white, and the line connecting the unadjusted eigenvalues is dashed, the line connecting the random eigenvalues is dotted, and the line connecting the adjusted eigenvalues is solid.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>col</code></td>
<td>
<p>sets the colors using a character vector with the color names of adjusted eigenvalues, unadjusted eigenvalues, and estimated random eigenvalues on the plot. These settings are used, only if <code>color=TRUE</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>lty</code></td>
<td>
<p>sets the line type using an integer vector of the line type codes for adjusted eigenvalues, unadjusted eigenvalues, and estimated random eigenvalues on the plot. These settings are used only if <code>color=FALSE</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>lwd</code></td>
<td>
<p>sets the line width. The default is <code>lwd=1</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>legend</code></td>
<td>
<p>draws a legend in the upper right corner of the plot. The default is <code>legend=TRUE</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>file</code></td>
<td>
<p>the png file in which to save the graph output if the analysis is graphed and <code>file</code> is given a character string representing a valid path. The default is not to save the graph.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>width</code></td>
<td>
<p>the width in pixels of the png file. The default is <code>width=640</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>height</code></td>
<td>
<p>the height in pixels of the png file. The default is <code>height=640</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>grdevice</code></td>
<td>
<p>specifies which graphic <code>device</code> to format the graph as, if the user has used the <code>file</code> option. The default is <code>grdevice=png</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>seed</code></td>
<td>
<p>specifies that the random number is to be seeded with the supplied integer. Each random data set is seeded with the supplied value times the number of the iteration, so that entire parallel analyses may be exactly replicated, while each simulated data set maintains a pseudorandom distinction from each of the others. The default value of <code>seed=0</code> tells <code>paran</code> to use R's default timer based seed (see RNG).</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>mat</code></td>
<td>
<p>specifies that <code>paran</code> use the provided <em>correlation matrix</em> rather than supplying a data matrix through <code>x</code>. The <code>n</code> argument must also be supplied when <code>mat</code> is used.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>n</code></td>
<td>
<p>the number of observations. Required when the correlation matrix is supplied with the <code>mat</code> option, rather than when the data matrix <code>x</code> is provided.</p>
</td>
</tr>
</table>
<h3>Details</h3>

<p><code>paran</code> is an implementation of Horn's (1965) technique for evaluating the components or factors retained in a principle component analysis (<abbr><span class="acronym">PCA</span></abbr>) or common factor analysis (<abbr><span class="acronym">FA</span></abbr>). According to Horn, a common interpretation of non-correlated data is that they are perfectly non-colinear, and one would expect therefore to see eigenvalues equal to 1 in a <abbr><span class="acronym">PCA</span></abbr> (or 0 in an <abbr><span class="acronym">FA</span></abbr>) of such random data. However, Horn notes that multi-colinearity occurs due to “sampling error and least-squares bias,” even in uncorrelated data, and therefore actual <abbr><span class="acronym">PCA</span></abbr>s of random data will reveal eigenvalues of components greater than and less than 1, and <abbr><span class="acronym">FA</span></abbr>s will reveal common factors greater than and less than 0. Horn's strategy is to contrast eigenvalues produced through a parallel <abbr><span class="acronym">PCA</span></abbr> or <abbr><span class="acronym">FA</span></abbr> on a number of random data sets (i.e. uncorrelated variables) with the same number of variables and observations as the experimental or observational dataset to produce eigenvalues for components or factors that are adjusted for the sample error-induced inflation. For <abbr><span class="acronym">PCA</span></abbr>, values greater than 1 are retained in the adjustment given by:
</p>
<p style="text-align: center;"><code class="reqn">\lambda_{p} - (\bar{\lambda}^{r}_{p} - 1)</code>
</p>

<p>and for <abbr><span class="acronym">FA</span></abbr>, values greater than 0 are retained in the adjustment given by:
</p>
<p style="text-align: center;"><code class="reqn">\lambda_{p} - \bar{\lambda}^{r}_{p}</code>
</p>

<p>where <code class="reqn">\lambda_{p}</code> is the <code class="reqn">p^{\mathrm{th}}</code> eigenvalue of the observed data (for <code class="reqn">p=1</code> to <code class="reqn">P</code>), and <code class="reqn">\bar{\lambda}^{r}_{p}</code> is the corresponding mean eigenvalue of the <code>iterations</code> number of simulated random data sets.
</p>
<p><code>paran</code> performs a <abbr><span class="acronym">PCA</span></abbr> or <abbr><span class="acronym">FA</span></abbr> with no rotation and performs Horn's adjustment. The user may also specify how many times to make the contrast with a random dataset (default is 30 per variable). Values less than 1 will be ignored, and the default value assumed. Random datasets are generated using the <code>rnorm()</code> function. The program returns a vector of length <em>P</em> of the estimated bias for each eigenvector, where <em>P</em> = the number of variables in the analysis. By specifying a high <code>centile</code> users may employ <code>paran</code> to conduct parallel analysis following Glorfeld's suggestions to reduce the likelihood of over-retention. (Glorfeld, 1995)
</p>


<h3>Value</h3>

<p>a list of objects relating to the parallel analysis:
</p>
<table>
<tr style="vertical-align: top;">
<td><code>Retained components/factors</code></td>
<td>
<p>a scalar integer representing the number of components/factors retained</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>Adjusted eigenvalues</code></td>
<td>
<p>a vector of the estimated eigenvalues adjusted for a finite sample size</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>Unadjusted eigenvalues</code></td>
<td>
<p>a vector of the eigenvalues of the observed data from either an unrotated principal component analysis or an unrotated common factor analysis</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>Random eigenvalues</code></td>
<td>
<p>a vector of the estimated (mean or centile) eigenvalues from <code>iterations</code> number of <em>N</em> by <em>P</em> random data sets</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>Bias</code></td>
<td>
<p>a vector of the estimated bias of the unadjusted eigenvalues (i.e. the difference between the adjusted and unadjusted eigenvalues)</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>Simulated eigenvalues</code></td>
<td>
<p>an <code>iterations</code> by <em>P</em> matrix with each row containing the eigenvalues from an equivalent principal component or common factor analysis on an <em>N</em> by <em>P</em> data set of uncorrelated random data</p>
</td>
</tr>
</table>
<h3>Remarks</h3>

<p>Hayton, et al. (2004) urge a parameterization of the random data to approximate the distribution of the observed data with respect to the middle (“mid-point”) and the observed min and max. However, <abbr><span class="acronym">PCA</span></abbr> as I understand it is insensitive to standardizing transformations of each variable, and any linear transformation of all variables, and produces the same eigenvalues used in component or factor retention decisions. This is born by the notable lack of difference between analyses conducted using the a variety of simulated distributional assumptions (Dinno, 2009). The central limit theorem would seem to make the selection of a distributional form for the random data moot with any sizeable number of iterations. Former functionality implementing the recommendation by Hayton et al. (2004) has been removed, since parallel analysis is insensitive to it, and it only adds to the computation time required to conduct parallel analysis.
</p>
<p>As of <code>paran</code> version 1.4.0 application of parallel analysis to common factor analysis has been revised. See the accompanying document <a href="http://alexisdinno.com/Software/files/PA_for_PCA_vs_FA.pdf">Gently Clarifying the Application of Horn's Parallel Analysis to Principal Component Analysis Versus Factor Analysis</a>.
</p>


<h3>Acknowledgement</h3>

<p>A big thank you to Ulrich Keller of the University of Luxembourg for his thoughtful suggestions improving the interface for <code>paran</code>, especially the legend, and the <code>invisibly()</code> method for returning data, and <code>seed</code> option.
</p>


<h3>Author(s)</h3>

<p>Alexis Dinno (alexis.dinno@pdx.edu)
</p>


<h3>References</h3>

<p>Dinno A. (2009) <a href="http://alexisdinno.com/personal/files/Dinno2009b.pdf">Exploring the Sensitivity of Horn's Parallel Analysis to the Distributional Form of Simulated Data.</a> <em>Multivariate Behavioral Research</em>. <b>44(3)</b>, 362–388.
</p>
<p>Glorfeld, L. W. (1995) An Improvement on Horn's Parallel Analysis Methodology for Selecting the Correct Number of Factors to Retain. <em>Educational and Psychological Measurement</em>. <b>55(3)</b>, 377–393. &lt;<a href="https://doi.org/10.1177/0013164495055003002">doi:10.1177/0013164495055003002</a>&gt;.
</p>
<p>Hayton J. C., Allen D. G., and Scarpello V. (2004) Factor Retention Decisions in Exploratory Factor Analysis: A Tutorial on Parallel Analysis. <em>Organizational Research Methods</em>. <b>7(2)</b>, 191–205. &lt;<a href="https://doi.org/10.1177/1094428104263675">doi:10.1177/1094428104263675</a>&gt;.
</p>
<p>Horn J. L. (1965) A rationale and a test for the number of factors in factor analysis. <em>Psychometrika</em>. <b>30</b>, 179–185. &lt;<a href="https://doi.org/10.1007/bf02289447">doi:10.1007/bf02289447</a>&gt;.
</p>
<p>Zwick W. R., Velicer WF. (1986) Comparison of Five Rules for Determining the Number of Components to Retain. <em>Psychological Bulletin</em>. <b>99</b>, 432–442. &lt;<a href="https://doi.org/10.1037/0033-2909.99.3.432">doi:10.1037/0033-2909.99.3.432</a>&gt;.
</p>


<h3>Examples</h3>

<pre><code class="language-R">## perform a standard parallel analysis on the US Arrest data
paran(USArrests, iterations=5000)

## a conservative analysis with different result!
paran(USArrests, iterations=5000, centile=95)
</code></pre>


</div>