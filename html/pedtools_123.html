<div class="container">

<table style="width: 100%;"><tr>
<td>locusAttributes</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>Get or set locus attributes</h2>

<h3>Description</h3>

<p>Retrieve or modify the attributes of attached markers
</p>


<h3>Usage</h3>

<pre><code class="language-R">getLocusAttributes(
  x,
  markers = NULL,
  checkComps = FALSE,
  attribs = c("alleles", "afreq", "name", "chrom", "posMb", "mutmod")
)

setLocusAttributes(
  x,
  markers = NULL,
  locusAttributes,
  matchNames = NA,
  erase = FALSE
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>x</code></td>
<td>
<p>A <code>ped</code> object, or a list of such.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>markers</code></td>
<td>
<p>A character vector (with marker names) or a numeric vector
(with marker indices). If NULL (default), the behaviour depends on
<code>matchNames</code>, see Details.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>checkComps</code></td>
<td>
<p>A logical. If TRUE, and <code>x</code> is a list of pedigrees, an
error is raised if marker attributes differ between components.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>attribs</code></td>
<td>
<p>A subset of the character vector <code>c("alleles", "afreq", "name" ,"chrom" ,"posMb", "mutmod", "rate")</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>locusAttributes</code></td>
<td>
<p>A list of lists, with attributes for each marker.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>matchNames</code></td>
<td>
<p>A logical, only relevant if <code>markers = NULL</code>. If TRUE, then
the markers to be modified are identified by the 'name' component of each
<code>locusAttributes</code> entry. If FALSE, all markers attached to <code>x</code> are selected
in order.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>erase</code></td>
<td>
<p>A logical. If TRUE, all previous attributes of the selected
markers are erased. If FALSE, attributes not affected by the submitted
<code>locusAttributes</code> remain untouched.</p>
</td>
</tr>
</table>
<h3>Details</h3>

<p>The default setting <code>markers = NULL</code> select markers automatically, depending
on the <code>matchNames</code> argument. If <code>matchNames = FALSE</code>, all markers are chosen
If <code>matchNames = TRUE</code>, markers will be matched against the <code>name</code> entries in
<code>locusAttributes</code> (and an error issued if these are missing).
</p>
<p>Note that the default value <code>NA</code> of <code>matchNames</code> is changed to TRUE if all
entries of <code>locusAttributes</code> have a <code>name</code> component which matches the name a
an attached marker.
</p>
<p>Possible attributes given in <code>locusAttributes</code> are as follows (default values
in parenthesis):
</p>

<ul>
<li> <p><code>alleles</code> : a character vector with allele labels
</p>
</li>
<li> <p><code>afreq</code> :  a numeric vector with allele frequencies (<code>rep.int(1/L, L)</code>,
where <code>L = length(alleles)</code>)
</p>
</li>
<li> <p><code>name</code> : marker name (NA)
</p>
</li>
<li> <p><code>chrom</code> : chromosome number (NA)
</p>
</li>
<li> <p><code>posMb</code> : physical location in megabases (NA)
</p>
</li>
<li> <p><code>mutmod</code> : mutation model, or model name (NULL)
</p>
</li>
<li> <p><code>rate</code> : mutation model parameter (NULL)
</p>
</li>
</ul>
<h3>Value</h3>


<ul>
<li> <p><code>getLocusAttributes</code> : a list of lists
</p>
</li>
<li> <p><code>setLocusAttributes</code> : a modified version of <code>x</code>.
</p>
</li>
</ul>
<h3>Examples</h3>

<pre><code class="language-R">x = singleton(1)
x = addMarkers(x, marker(x, name = "m1", alleles = 1:2))
x = addMarkers(x, marker(x, name = "m2", alleles = letters[1:2], chrom = "X"))

# Change frequencies at both loci
y = setLocusAttributes(x, markers = 1:2, loc = list(afreq = c(.1, .9)))
getMarkers(y, 1)

# Set the same mutation model at both loci
z = setLocusAttributes(x, markers = 1:2, loc = list(mutmod = "proportional", rate = .1))
mutmod(z, 1)

# By default, the markers to be modified are identified by name
locs = list(list(name = "m1", alleles = 1:10),
            list(name = "m2", alleles = letters[1:10]))
w = setLocusAttributes(x, loc = locs)
getMarkers(w, 1:2)

# If `erase = TRUE` attributes not explicitly given are erased
w2 = setLocusAttributes(x, loc = locs, erase = TRUE)
chrom(w2, 2) # not "X" anymore

# The getter and setter are inverses
newx = setLocusAttributes(x, loc = getLocusAttributes(x))
stopifnot(identical(x, newx))

</code></pre>


</div>