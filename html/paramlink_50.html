<div class="container">

<table style="width: 100%;"><tr>
<td>likelihood</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>Pedigree likelihood</h2>

<h3>Description</h3>

<p>Calculates various forms of pedigree likelihoods.
</p>


<h3>Usage</h3>

<pre><code class="language-R">likelihood(x, ...)

## S3 method for class 'linkdat'
likelihood(
  x,
  locus1,
  locus2 = NULL,
  theta = NULL,
  startdata = NULL,
  eliminate = 0,
  logbase = NULL,
  loop_breakers = NULL,
  ...
)

## S3 method for class 'singleton'
likelihood(x, locus1, logbase = NULL, ...)

## S3 method for class 'list'
likelihood(x, locus1, locus2 = NULL, ..., returnprod = TRUE)

likelihood_LINKAGE(
  x,
  marker,
  theta = NULL,
  afreq = NULL,
  logbase = NULL,
  TR.MATR = NULL,
  initialCalc = NULL,
  singleNum.geno = NULL,
  loop_breakers = NULL
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>x</code></td>
<td>
<p>a <code>linkdat</code> object, a <code>singleton</code> object, or
a list of such objects. In <code>likelihood_LINKAGE</code>, <code>x</code> must be a
<code>linkdat</code> object, with <code>x$model</code> different from NULL.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>...</code></td>
<td>
<p>further arguments.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>locus1</code></td>
<td>
<p>a <code>marker</code> object compatible with <code>x</code>. If
<code>x</code> is a list, then <code>locus1</code> must be a list of corresponding
<code>marker</code> objects.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>locus2</code></td>
<td>
<p>either NULL, the character 'disease', or a <code>marker</code>
object compatible with <code>x</code>. See Details.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>theta</code></td>
<td>
<p>the recombination rate between locus1 and locus2 (in
<code>likelihood_LINKAGE</code>: between the marker and the disease locus).  To
make biological sense theta should be between 0 and 0.5.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>startdata</code></td>
<td>
<p>for internal use.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>eliminate</code></td>
<td>
<p>mostly for internal use: a non-negative integer indicating
the number of iterations in the internal genotype-compatibility algorithm.
Positive values can save time if <code>partialmarker</code> is non-empty and the
number of alleles is large.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>logbase</code></td>
<td>
<p>a numeric, or NULL. If numeric the log-likelihood is returned,
with <code>logbase</code> as basis for the logarithm.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>loop_breakers</code></td>
<td>
<p>a numeric containing IDs of individuals to be used as
loop breakers. If NULL, automatic selection of loop breakers will be
performed. See <code>breakLoops</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>returnprod</code></td>
<td>
<p>a logical; if TRUE, the product of the likelihoods is
returned, otherwise a vector with the likelihoods for each pedigree in the
list.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>marker</code></td>
<td>
<p>an integer between 0 and <code>x$nMark</code>, indicating which
marker to use in the calculation.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>afreq</code></td>
<td>
<p>a numeric containing the marker allele frequencies.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>TR.MATR, initialCalc, singleNum.geno</code></td>
<td>
<p>for internal use, speeding up
linkage computations with few-allelic markers.</p>
</td>
</tr>
</table>
<h3>Details</h3>

<p>All likelihoods are calculated using the Elston-Stewart algorithm.
</p>
<p>If <code>locus2 = NULL</code>, the result is simply the likelihood of the genotypes
observed at the marker in locus1.
</p>
<p>If <code>locus2 = 'disease'</code>, the result is the likelihood of the marker
genotypes in locus1, given the affection statuses of the pedigree members,
the disease model and the recombination rate <code>theta</code> between the marker
and disease loci.  The main use of this is for computation of LOD scores in
parametric linkage analysis.
</p>
<p>If <code>locus2</code> is a marker object, the result is the likelihood of the
genotypes at the two markers, given the recombination rate theta between
them.
</p>
<p>The function <code>likelihood_LINKAGE</code> is a fast version of
<code>likelihood.linkdat</code> in the case where <code>locus2 = 'disease'</code> and the
marker in locus1 has less than 5 alleles.
</p>


<h3>Value</h3>

<p>The likelihood of the data. If the parameter <code>logbase</code> is a
positive number, the output is <code>log(likelihood, logbase)</code>.
</p>


<h3>See Also</h3>

<p><code>lod</code>
</p>


<h3>Examples</h3>

<pre><code class="language-R">
x = linkdat(toyped, model=1) #dominant model

lod1 = likelihood_LINKAGE(x, marker=1, theta=0, logbase=10) -
       likelihood_LINKAGE(x, marker=1, theta=0.5, logbase=10)
lod2 = lod(x, markers=1, theta=0)

# these should be the same:
stopifnot(identical(lod1, as.numeric(lod2)), round(lod1, 2)==0.3)

# likelihood of inbred pedigree (grandfather/granddaughter incest)
y = addOffspring(addDaughter(nuclearPed(1, sex=2), 3), father=1, mother=5, 1)
m = marker(y, 1, 1, 6, 1:2)
l1 = likelihood(y, m)
l2 = likelihood(y, m, loop_breaker=5) # manual specification of loop_breaker
stopifnot(l1==0.09375, l2==l1)

</code></pre>


</div>