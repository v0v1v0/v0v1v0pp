<div class="container">

<table style="width: 100%;"><tr>
<td>PP_gpcm</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>Estimate Person Parameters for the GPCM</h2>

<h3>Description</h3>

<p>Compute person parameters for the GPCM and choose between five common estimation techniques: ML, WL, MAP, EAP and a robust estimation. All item parameters are treated as fixed.
</p>


<h3>Usage</h3>

<pre><code class="language-R">PP_gpcm(
  respm,
  thres,
  slopes,
  theta_start = NULL,
  mu = NULL,
  sigma2 = NULL,
  type = "wle",
  maxsteps = 100,
  exac = 0.001,
  H = 1,
  ctrl = list()
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>respm</code></td>
<td>
<p>An integer matrix, which contains the examinees responses. A persons x items matrix is expected.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>thres</code></td>
<td>
<p>A numeric matrix which contains the threshold parameter for each item. If the first row of the matrix is not set to zero (only zeroes in the first row) - then a row-vector with zeroes is added by default.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>slopes</code></td>
<td>
<p>A numeric vector, which contains the slope parameters for each item - one parameter per item is expected.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>theta_start</code></td>
<td>
<p>A vector which contains a starting value for each person. If NULL is submitted, the starting values are set automatically. If a scalar is submitted, this start value is used for each person.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>mu</code></td>
<td>
<p>A numeric vector of location parameters for each person in case of MAP or EAP estimation. If nothing is submitted this is set to 0 for each person for MAP estimation.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>sigma2</code></td>
<td>
<p>A numeric vector of variance parameters for each person in case of MAP  or EAP estimation. If nothing is submitted this is set to 1 for each person for MAP estimation.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>type</code></td>
<td>
<p>Which maximization should be applied? There are five valid entries possible: "mle", "wle", "map", "eap" and "robust". To choose between the methods, or just to get a deeper understanding the papers mentioned below are quite helpful. The default is <code>"wle"</code> which is a good choice in many cases.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>maxsteps</code></td>
<td>
<p>The maximum number of steps the NR Algorithm will take. Default = 100.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>exac</code></td>
<td>
<p>How accurate are the estimates supposed to be? Default is 0.001.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>H</code></td>
<td>
<p>In case <code>type = "robust"</code> a Huber ability estimate is performed, and <code>H</code> modulates how fast the downweighting takes place (for more Details read Schuster &amp; Yuan 2011).</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>ctrl</code></td>
<td>
<p>more controls
</p>

<ul>
<li> <p><code>killdupli</code>: Should duplicated response pattern be removed for estimation (estimation is faster)? This is especially resonable in case of a large number of examinees and a small number of items.  Use this option with caution (for map and eap), because persons with different <code>mu</code> and <code>sigma2</code> will have different ability estimates despite they responded identically. Default value is <code>FALSE</code>.
</p>
</li>
<li> <p><code>skipcheck</code>: Default = FALSE. If TRUE data matrix and arguments are not checked - this saves time e.g. when you use this function for simulations.
</p>
</li>
</ul>
</td>
</tr>
</table>
<h3>Details</h3>

<p>Please note, that <code>robust</code> estimation with (Huber ability estimate) polytomous items is still experimental!
</p>
<p>The probability choosing the k-th category is as follows:
</p>
<p style="text-align: center;"><code class="reqn">P(x_{ij} = k | \hat \alpha_i, \hat\beta_{iv}, \theta_j) = \frac{exp(\sum_{v=0}^{(k-1)}\hat \alpha_{i}(\theta_j - \hat \beta_{iv}))}{\,\sum_{c=0}^{m_i - 1}exp(\sum_{v=0}^{c}\hat \alpha_{i}(\theta_j - \hat \beta_{iv})))}</code>
</p>

<p>In our case <code class="reqn">\theta</code> is to be estimated. The item parameters are assumed as fixed (usually these are estimates of a former scaling procedure).
</p>
<p>The model simplifies to the Partial Credit Model by setting <code class="reqn">\alpha_{i} = 1, \forall i</code>.
</p>


<h3>Value</h3>

<p>The function returns a list with the estimation results and pretty much everything which has been submitted to fit the model. The estimation results can be found in <code>OBJ$resPP</code>. The core result is a number_of_persons x 2 matrix, which contains the ability estimate and the SE for each submitted person.
</p>


<h3>Author(s)</h3>

<p>Manuel Reif
</p>


<h3>References</h3>

<p>Baker, Frank B., and Kim, Seock-Ho (2004). Item Response Theory - Parameter Estimation Techniques. CRC-Press.
</p>
<p>Masters, G. N. (1982). A Rasch model for partial credit scoring. Psychometrika, 47(2), 149-174.
</p>
<p>Muraki, Eiji (1992). A Generalized Partial Credit Model: Application of an EM Algorithm. Applied Psychological Measurement, 16, 159-176.
</p>
<p>Muraki, Eiji (1993). Information Functions of the Generalized Partial Credit Model. Applied Psychological Measurement, 17, 351-363.
</p>
<p>Samejima, Fumiko (1993). The bias function of the maximum likelihood estimate of ability for the dichotomous response level. Psychometrika,  58, 195-209.
</p>
<p>Samejima, Fumiko (1993). An approximation of the bias function of the maximum likelihood estimate of a latent variable for the general case where the item responses are discrete. Psychometrika,  58, 119-138.
</p>
<p>Schuster, C., &amp; Yuan, K. H. (2011). Robust estimation of latent ability in item response models. Journal of Educational and Behavioral Statistics, 36(6), 720-735.
</p>
<p>Wang, S. and Wang, T. (2001). Precision of Warm's Weighted Likelihood Estimates for a Polytomous Model in Computerized Adaptive Testing. Applied Psychological Measurement, 25, 317-331.
</p>
<p>Warm, Thomas A. (1989). Weighted Likelihood Estimation Of Ability In Item Response Theory. Psychometrika, 54, 427-450.
</p>


<h3>See Also</h3>

<p>PPass, PPall, PP_4pl, JKpp, PV
</p>


<h3>Examples</h3>

<pre><code class="language-R">################# GPCM ###########################################################################

# some threshold parameters
THRES  &lt;- matrix(c(-2,-1.23,1.11,3.48,1
                   ,2,-1,-0.2,0.5,1.3,-0.8,1.5),nrow=2)
# slopes
sl     &lt;- c(0.5,1,1.5,1.1,1,0.98)
awmatrix &lt;- matrix(c(1,0,2,0,1,1,1,0,0,1
                     ,2,0,0,0,0,0,0,0,0,1,1,2,2,1,1,1,1,0,0,1),byrow=TRUE,nrow=5)

## GPCM model ##### 

# MLE
resgpcmlmle &lt;- PP_gpcm(respm = awmatrix,thres = THRES, slopes = sl,type = "mle")
# WLE
resgpcmwle &lt;- PP_gpcm(respm = awmatrix,thres = THRES, slopes = sl,type = "wle")
# MAP estimation
resgpcmmap &lt;- PP_gpcm(respm = awmatrix,thres = THRES, slopes = sl,type = "map")
# EAP estimation
resgpcmeap &lt;- PP_gpcm(respm = awmatrix,thres = THRES, slopes = sl,type = "eap")
# robust estimation
resgpcmrob &lt;- PP_gpcm(respm = awmatrix,thres = THRES, slopes = sl,type = "robust")

## PCM model ##### 

# MLE
respcmlmle &lt;- PP_gpcm(respm = awmatrix,thres = THRES, slopes = rep(1,ncol(THRES)),type = "mle")
# WLE
respcmwle &lt;- PP_gpcm(respm = awmatrix,thres = THRES, slopes = rep(1,ncol(THRES)),type = "wle")
# MAP estimation
respcmmap &lt;- PP_gpcm(respm = awmatrix,thres = THRES, slopes = rep(1,ncol(THRES)),
                     type = "map")
# EAP estimation
respcmeap &lt;- PP_gpcm(respm = awmatrix,thres = THRES, slopes = rep(1,ncol(THRES)),
                     type = "eap")

#### with different number of categories ##

THRES  &lt;- matrix(c(-2,-1.23,1.11,3.48,1,2,-1,-0.2,0.5,1.3,-0.8,1.5),nrow=2)
THRES1 &lt;- rbind(THRES,c(NA,NA,NA,NA,1.7,1))

awmatrix1 &lt;- matrix(c(1,0,2,0,1,3,1,0,0,1,3,1,0,0
                      ,0,0,0,0,0,1,1,2,2,1,1,1,1,0,0,1), byrow=TRUE, nrow=5)

# MLE estimation
respcmlmle1 &lt;- PP_gpcm(respm = awmatrix1,thres = THRES1, slopes = sl,type = "mle")
# WLE estimation
respcmwle1 &lt;- PP_gpcm(respm = awmatrix1,thres = THRES1, slopes = sl,type = "wle")
# MAP estimation
respcmmap1 &lt;- PP_gpcm(respm = awmatrix1,thres = THRES1, slopes = sl,type = "map")
# EAP estimation
respcmeap1 &lt;- PP_gpcm(respm = awmatrix1, thres = THRES1, slopes = sl,type = "eap")
</code></pre>


</div>