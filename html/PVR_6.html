<div class="container">

<table style="width: 100%;"><tr>
<td>PVR</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>
Phylogenetic eigenvectors regression.
</h2>

<h3>Description</h3>

<p>The phylogenetic eigenvector regression (PVR) starts by performing an eigendecomposition of a pairwise double-centered phylogenetic distance matrix between species. The eigenvectors (representing the traits under analysis) estimated values express phylogenetic trends in data and residuals express independent evolution of each species.
</p>


<h3>Usage</h3>

<pre><code class="language-R">PVR(x,phy,trait,envVar,method="moran",weights,
scaled=FALSE,sig=TRUE,sig.t=0.05,MI.t=0.05,psr.t=0.01,
accvalue.t=0.9,...)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>x</code></td>
<td>

<p>An object of class PVR (created by the PVRdecomp function) or class PSR (requiered by the "PSR" method).
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>phy</code></td>
<td>

<p>An object of class phylo that contains an ultrametric phylogeny.
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>trait</code></td>
<td>

<p>A vector, data frame or matrix that contains traits sets (for data frames and matrices, each column must represent a trait set).
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>envVar</code></td>
<td>

<p>A vector, data frame or matrix that contains environmental variables. Used to estimates the variation of a trait set that is explained by phylogeny and by environment.
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>method</code></td>
<td>

<p>Character string. A name for the eigenvectors selection method. It can be "moran", "stepwise", "psr" or "sequential".
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>weights</code></td>
<td>

<p>Weighting matrix based on Phylogenetic distances used in the "moran" method. If no weights matrix is provided, weights will be set to max(D) - Dij, where D is the phylogenetic distance matrix. 
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>scaled</code></td>
<td>

<p>Logical. Should the phylogenetic distances be scaled into the range of 0 to 1. Default is FALSE.
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>sig</code></td>
<td>

<p>Logical. Should the eigenvectors selected by the "moran" method be selected by the significance of residuals autocorrelation. If FALSE the eigenvectors will be selected by Moran's I values.
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>MI.t</code></td>
<td>

<p>Minimum residuals Moran's I value used to select eigenvectors when significance is FALSE.
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>sig.t</code></td>
<td>

<p>The significance treshold used to select eigenvectors by the "moran" method.
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>psr.t</code></td>
<td>

<p>The minimum acumulate R2 gain treshold used to select eigenvectors by the "PSR" method.
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>accvalue.t</code></td>
<td>

<p>Relative accumulated eigenvalue treshold use to select the eigenvectors by the "sequential" method.
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>...</code></td>
<td>

<p>Parameters passed to the stepwise regression used in the "AIC" method
</p>
</td>
</tr>
</table>
<h3>Value</h3>

<p>A PVR class object.
</p>


<h3>Author(s)</h3>

<p>Santos, T; Diniz-Filho, J.A.F.; Rangel, T.F.; Bini, L.M.
</p>


<h3>References</h3>

<p>Diniz-Filho, J.A.F., Sant'Ana, C.E.R. and Bini, L.M. (1998). An eigenvector method for estimating phylogenetic inertia. Evolution, 52:1247-1262.
</p>
<p>Legendre, P. and Legendre, L. (1998). Numerical ecology, 2nd Englished. Elsevier.
</p>
<p>Desdevises, Y., Legendre, P., Azouzi, L. and Morand, S. (2003). Quantifying phylogenetic structured environmental variation, Evolution, 57(11):2647-2652
</p>
<p>Diniz-filho, J.A.F., Rangel, T.F., Santos, T. and Bini, L.M. (2012). Exploring patterns of interespecific variation in quantitative traits using sequential phylogenetic eigenvector regressions. Evolution, 66(4):1079-1090.
</p>
<p>Diniz-filho, J.A.F., Bini, L.M., Rangel, T.F., Morales-Castilla, I., Olalla-Tarraga, M.A., Rodriguez, M.A. and Hawkins, B.A. (2012). On the selection of phylogenetic eigenvectors for ecological analyses. Ecography, 35:239-249.
</p>


<h3>See Also</h3>

<p><code>PSR</code>,  <code>PVRdecomp</code>,  <code>PSRplot</code>,  <code>VarPartplot</code>
</p>


<h3>Examples</h3>

<pre><code class="language-R">
library(ape)
tree &lt;- rcoal(10)
#Decomposing phylogenetic distance matrix derived from tree into a set of orthogonal vectors
x &lt;- PVRdecomp(tree)
trait &lt;- runif(10)
y &lt;- PVR(x, trait = trait, method = "moran")
str(y)
</code></pre>


</div>