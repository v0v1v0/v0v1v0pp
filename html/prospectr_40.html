<div class="container">

<table style="width: 100%;"><tr>
<td>shenkWest</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>SELECT algorithm for calibration sampling</h2>

<h3>Description</h3>

<p>Select calibration samples from a large multivariate data using the SELECT
algorithm as described in Shenk and Westerhaus (1991).
</p>


<h3>Usage</h3>

<pre><code class="language-R">shenkWest(X,
          d.min = 0.6,
          pc = 0.95,
          rm.outlier = FALSE,
          .center = TRUE,
          .scale = FALSE)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>X</code></td>
<td>
<p>a numeric matrix (optionally a data frame that can
be coerced to a numerical matrix).</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>d.min</code></td>
<td>
<p>a minimum distance (default = 0.6).</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>pc</code></td>
<td>
<p>the number of principal components retained in the computation
distance in the standardized Principal Component space (Mahalanobis distance).
If <code>pc &lt; 1</code>, the number of principal components kept corresponds to the
number of components explaining at least (<code>pc * 100</code>) percent of the total
variance (default = 0.95).</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>rm.outlier</code></td>
<td>
<p>logical. If <code>TRUE</code>, remove observations with a standardized
mahalanobis distance to the center of the data greater than 3
(default = <code>FALSE</code>).</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>.center</code></td>
<td>
<p>logical. Indicates whether the input matrix should be centered
before Principal Component Analysis. Default set to <code>TRUE</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>.scale</code></td>
<td>
<p>logical. Indicates whether the input matrix should be scaled
before Principal Component Analysis. Default set to <code>FALSE</code>.</p>
</td>
</tr>
</table>
<h3>Details</h3>

<p>The SELECT algorithm is an iterative procedure based on the standardized
Mahalanobis distance between observations.
First, the observation having the highest number of neighbours within a given
minimum distance is selected and its neighbours are discarded. The procedure
is repeated until there is no observation left.
</p>
<p>If the <code>rm.outlier</code> argument is set to <code>TRUE</code>, outliers will be removed
before running the SELECT algorithm, using the CENTER algorithm of
Shenk and Westerhaus (1991), i.e. samples with a standardized Mahalanobis
distance <code style="white-space: pre;">⁠&gt;3⁠</code> are removed.
</p>


<h3>Value</h3>

<p>a <code>list</code> with components:
</p>

<ul>
<li>
<p>'<code>model</code>': numeric vector giving the row indices of the input data
selected for calibration
</p>
</li>
<li>
<p>'<code>test</code>': numeric vector giving the row indices of the remaining
observations
</p>
</li>
<li>
<p>'<code>pc</code>': a numeric matrix of the scaled pc scores
</p>
</li>
</ul>
<h3>Author(s)</h3>

<p>Antoine Stevens
</p>


<h3>References</h3>

<p>Shenk, J.S., and Westerhaus, M.O., 1991. Population Definition,
Sample Selection, and Calibration Procedures for Near Infrared Reflectance
Spectroscopy. Crop Science 31, 469-474.
</p>


<h3>See Also</h3>

<p><code>kenStone</code>, <code>duplex</code>, <code>puchwein</code>
</p>


<h3>Examples</h3>

<pre><code class="language-R">data(NIRsoil)
# reduce data size
NIRsoil$spc &lt;- binning(X = NIRsoil$spc, bin.size = 5)
sel &lt;- shenkWest(NIRsoil$spc, pc = .99, d.min = .3, rm.outlier = FALSE)
plot(sel$pc[, 1:2], xlab = "PC1", ylab = "PC2")
# points selected for calibration
points(sel$pc[sel$model, 1:2], pch = 19, col = 2)
# without outliers
sel &lt;- shenkWest(NIRsoil$spc, pc = .99, d.min = .3, rm.outlier = TRUE)
plot(sel$pc[, 1:2], xlab = "PC1", ylab = "PC2")
# points selected for calibration
points(sel$pc[sel$model, 1:2], pch = 15, col = 3)
</code></pre>


</div>