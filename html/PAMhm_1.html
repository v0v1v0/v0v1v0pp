<div class="container">

<table style="width: 100%;"><tr>
<td>PAM.hm</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>Main function to produce a heatmap using PAM clustering.</h2>

<h3>Description</h3>

<p>This is the main wrapper function to be called by end users. It accepts a numeric matrix
(or an object that can be coerced to a numeric matrix) or a number of data file formats and produces one or
more PDFs with the plots.
</p>


<h3>Usage</h3>

<pre><code class="language-R">PAM.hm(
  x,
  project.folder = ".",
  nsheets = 1,
  dec = ".",
  header = TRUE,
  symbolcol = 1,
  sample.names = NULL,
  cluster.number = 4,
  trim = NULL,
  winsorize.mat = TRUE,
  cols = "BlueWhiteRed",
  dendrograms = "Both",
  autoadj = TRUE,
  pdf.height = 10,
  pdf.width = 10,
  labelheight = 0.25,
  labelwidth = 0.2,
  r.cex = 0.5,
  c.cex = 1,
  medianCenter = NULL,
  log = FALSE,
  do.log = FALSE,
  log.base = 2,
  metric = "manhattan",
  na.strings = "NA",
  makeFolder = TRUE,
  do.pdf = FALSE,
  do.png = FALSE,
  save.objects = FALSE
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>x</code></td>
<td>
<p>(<code>character</code>, <code>data.frame</code>, <code>numeric</code>). The name(s) of the input files(s) (character vector)
or a data object such as a <code>data.frame</code> or <code>numeric matrix</code>. See 'Details'.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>project.folder</code></td>
<td>
<p>(<code>character</code>). Name of the root folder inside which the results will be created if any files are to be saved. See 'Details'.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>nsheets</code></td>
<td>
<p>(<code>integer</code>). Number of sheets to be read if file is of type ".xls" or ".xlsx". All sheets starting from 1 up to the
given number in the respective data file will be read. If more than one file is read this must be be an integer vector with the
numbers of sheets in exactly the same order as the files.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>dec</code></td>
<td>
<p>(<code>character</code>). The decimal separator for numbers.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>header</code></td>
<td>
<p>(<code>logical</code>). Does the input file have a header row?</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>symbolcol</code></td>
<td>
<p>(<code>character</code>). The name of the column with identifiers used as labels.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>sample.names</code></td>
<td>
<p>(<code>character</code>). A vector of names used for plot titles and output files.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>cluster.number</code></td>
<td>
<p>(<code>character</code> or <code>integer</code>). A vector of numbers used for PAM clustering (corresponds to argument
<code>k</code> in <code>pam</code>). If a character vector, this is broken down to a numeric vector accepting
comma-separated strings in the form of, e.g, "4" and "2-5". The clustering algorithm then iterates through all given numbers.
See 'Details'.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>trim</code></td>
<td>
<p>(<code>numeric</code>). Value to "cut off" data distribution. Values at both ends of the distribution,
larger or smaller, respectively, will be made equal to <code>+/-trim</code>, i.e., data will be symmetrical around 0.
<code>NULL</code> means no trimming which is the default. If <code>trim</code> is <code>-1</code> (or any negative value) and
<code>winsorize.mat</code> is <code>TRUE</code> the matrix will be <em>winsorized</em> and then the smaller of the two largest
absolute values at both ends of the distribution rounded to three digits will be used. If <code>winsorize.mat</code>
is <code>FALSE</code> the largest possible absolute integer, i.e., the smaller of the to extreme integers is used.
Trimming is disabled for only positive or only negative values.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>winsorize.mat</code></td>
<td>
<p>(<code>logical</code>). Should the matrix be <em>winsorized</em> (cleaned of outliers) before plotting?
Defaults to <code>TRUE</code>. See 'Details'.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>cols</code></td>
<td>
<p>(<code>character</code>). Name of the colour palette.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>dendrograms</code></td>
<td>
<p>(<code>character</code>). Which dendrograms are to be plotted? One of "Vertical", "Horizontal",
"None" or "Both". Defaults to "Both".</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>autoadj</code></td>
<td>
<p>(<code>logical</code>). Should label sizes and pdf dimensions be adjusted automatically? See 'Details'.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>pdf.height</code></td>
<td>
<p>(<code>numeric</code>). Heigth of the PDF device.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>pdf.width</code></td>
<td>
<p>(<code>numeric</code>). Width of the PDF device.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>labelheight</code></td>
<td>
<p>(<code>numeric</code> or <code>lcm(numeric)</code>). Relative or absolute height (using <code>lcm</code>, see <code>layout</code>) of the labels.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>labelwidth</code></td>
<td>
<p>(<code>numeric</code> or <code>lcm(numeric)</code>). Relative or absolute width (using <code>lcm</code>, see <code>layout</code>) of the labels.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>r.cex</code></td>
<td>
<p>(<code>numeric</code>). Font size for row labels.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>c.cex</code></td>
<td>
<p>(<code>numeric</code>). Font size for column labels.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>medianCenter</code></td>
<td>
<p>(<code>character</code>). If not <code>NULL</code>, how should data be median-centered? One of "grand",
"row" or "column". Defaults to <code>NULL</code>, no median-centering.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>log</code></td>
<td>
<p>(<code>logical</code>). Is the data on log-scale. (The log-base is given in argument <code>log.base</code>).</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>do.log</code></td>
<td>
<p>(<code>logical</code>). Should data be log-transformed? (The log-base is given in argument <code>log.base</code>).</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>log.base</code></td>
<td>
<p>(<code>numeric</code>). The log-base used for <code>log</code> and <code>do.log</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>metric</code></td>
<td>
<p>(<code>character</code>). The metric metric to be used for calculating dissimilarities between observations.
The currently available options are "euclidean" and "manhattan". Euclidean distances are root sum-of-squares of differences,
and manhattan distances are the sum of absolute differences. Defaults to "manhattan".</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>na.strings</code></td>
<td>
<p>(<code>character</code>). Character vector of strings to interpret as missing values when reading data files
with <code>read.table</code> or <code>readxlread_excel</code>. By default, <code>readxl</code> treats blank cells as missing data.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>makeFolder</code></td>
<td>
<p>(<code>logical</code>). Should the results folder be created?</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>do.pdf</code></td>
<td>
<p>(<code>logical</code>). Should images be saved to PDFs?</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>do.png</code></td>
<td>
<p>(<code>logical</code>). Should images be saved to PNGs?</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>save.objects</code></td>
<td>
<p>(<code>logical</code>). Should R objects be save to disk?</p>
</td>
</tr>
</table>
<h3>Details</h3>

<p>Argument <code>x</code> can be a <code>data.frame</code> or numeric matrix to be used directly for plotting the heatmap.
If it is a <code>data.frame</code> argument <code>symbolcol</code> sets the respective columns for symbols to be used as
labels and the column where the numeric data starts.
</p>
<p>Matrices will be coerced to data frames.
</p>
<p>The read function accepts txt, tsv, csv and xls files.
</p>
<p>If PDF, PNG or R object files are to be saved, i.e., if the corresponding arguments are <code>TRUE</code>, a results
folder will be created using time and date to create a unique name. The folder will be created in the directory
set by argument <code>project.folder</code>. The reasoning behind that behaviour is that during development the
heatmap was used as data analysis tool testing various <code>cluster.number</code> values with numerous files and
comparing the results.
</p>
<p>The <code>cluster.number</code> argument defines the numbers of clusters when doing PAM. After processing it is passed
one-by-one to argument <code>k</code> in <code>pam</code>. The numbers can be defined in the form
<code>c("2","4-7", "9")</code>, for example, depending on the experimental setup. An integer vector is coerced to
character.
</p>
<p>If <code>autoadj</code> is <code>TRUE</code> character expansion (cex) for rows annd columns, pdf width and height and
label width and height are adjusted automatically based on the dimensions of the data matrix and length
(number of characters) of the labels.
</p>
<p>The default behavior regarding outliers is to <em>winsorize</em> the matrix before plotting, i.e., shrink outliers
to the unscattered part of the data by replacing extreme values at both ends of the distribution with less
extreme values. This is done for the same reason as trimming but the data will not be symmetrical around 0.
</p>


<h3>Value</h3>

<p>A list: Invisibly returns the results object from the PAM clustering.
</p>


<h3>References</h3>

<p>Kaufman, L., &amp; Rousseeuw, P. J. (Eds.). (1990). <em>Finding Groups in Data: An Introduction to Cluster Analysis.</em>
John Wiley &amp; Sons, Inc. doi: <a href="https://doi.org/10.1002/9780470316801">10.1002/9780470316801</a>
</p>


<h3>See Also</h3>

<p><code>read.delim</code>
</p>
<p><code>read_excel</code>
</p>
<p><code>pam</code>
</p>


<h3>Examples</h3>

<pre><code class="language-R"># Generate a random 10x10 matrix and plot it using default values
set.seed(1234)                                  # for reproducibility
mat &lt;- matrix(rnorm(120), nrow = 20)            # standard normal
PAM.hm(mat, cluster.number = 3)

## Plot with more than one cluster number
PAM.hm(mat, cluster.number = 2:4)               # integer vector
PAM.hm(mat, cluster.number = c("2", "4-5"))     # character vector

# Using the 'trim' argument
## Introduce outlier to the matrix and plot w/o trimming or winsorization
mat[1] &lt;- mat[1] * 10
PAM.hm(mat, cluster.number = 3, trim = NULL, winsorize = FALSE)

## calculate a trim value by getting the largest possible absolute integer and
## plot again
tr &lt;- min(abs(ceiling(c(min(mat, na.rm = TRUE), max(mat, na.rm = TRUE)))),
    na.rm = TRUE)
PAM.hm(mat, cluster.number = 3, trim = tr, winsorize = FALSE)
## Note that the outlier is still visible but since it is less extreme
## it does not distort the colour scheme.

# An example reading data from an Excel file
# The function readxl::read_excel is used internally to read Excel files.
# The example uses their example data.
readxl_datasets &lt;- readxl::readxl_example("datasets.xlsx")
PAM.hm(readxl_datasets, cluster.number = 4, symbolcol = 5)

</code></pre>


</div>