<div class="container">

<table style="width: 100%;"><tr>
<td>Bivariate Poisson lognormal</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2> Bivariate Poisson Lognormal Distribution </h2>

<h3>Description</h3>

<p>Density and random generation for the for the bivariate Poisson 
lognormal distribution with parameters <code>mu1</code>, <code>mu2</code>, 
<code>sig1</code>, <code>sig2</code> and <code>rho</code>.
</p>


<h3>Usage</h3>

<pre><code class="language-R">dbipoilog(n1, n2, mu1, mu2, sig1, sig2, rho)
rbipoilog(S, mu1, mu2, sig1, sig2, rho, nu1=1, nu2=1, 
          condS=FALSE, keep0=FALSE)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>n1</code></td>
<td>
<p> vector of observed individuals for each species in sample 1</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>n2</code></td>
<td>
<p> vector of observed individuals for each species in sample 2 <br>(in the same order as in sample 1) </p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>mu1</code></td>
<td>
<p> mean of lognormal distribution in sample 1 </p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>mu2</code></td>
<td>
<p> mean of lognormal distribution in sample 1 </p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>sig1</code></td>
<td>
<p> standard deviation of lognormal distribution in sample 1 </p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>sig2</code></td>
<td>
<p> standard deviation of lognormal distribution in sample 2 </p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>rho</code></td>
<td>
<p> correlation among samples </p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>S</code></td>
<td>
<p> Total number of species in both communities </p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>nu1</code></td>
<td>
<p> sampling intensity sample 1 </p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>nu2</code></td>
<td>
<p> sampling intensity sample 2 </p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>condS</code></td>
<td>
<p> logical; if TRUE random deviates are conditional on S </p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>keep0</code></td>
<td>
<p> logical; if TRUE species with count 0 in both communities are included in the random deviates </p>
</td>
</tr>
</table>
<h3>Details</h3>

<p>The following is written from the perspective of using the Poisson lognormal distribution 
to describe community structure (the distribution of species when sampling individuals 
from a community of several species).
</p>
<p>The following assumes knowledge of the <b>Details</b> section of <code>dpoilog</code>.
</p>
<p>Consider two communities jointly and assume that the log abundances among species have the binormal distribution
with parameters (<code>mu1</code>,<code>sig1</code>,<code>mu2</code>,<code>sig2</code>,<code>rho</code>). If sampling intensities are 
<code>nu1</code> = <code>nu2</code> = 1, samples from the communities will have the bivariate Poisson lognormal distribution
</p>
<p style="text-align: center;"><code class="reqn"> P(N_1 = \code{n1}, N_2 = \code{n2}; \;\code{mu1},\code{sig1},\code{mu2},\code{sig2},\code{rho}) = </code>
</p>

<p style="text-align: center;"><code class="reqn"> q(\code{n1},\code{n2};\;\code{mu1},\code{sig1},\code{mu2},\code{sig2},\code{rho}) = </code>
</p>

<p style="text-align: center;"><code class="reqn">\int\limits_{-\infty}^{\infty}\int\limits_{-\infty}^{\infty} g_{\code{n1}}(\code{mu1,sig1},u) g_{\code{n2}}(\code{mu2,sig2},v)\,\phi(u,v;\code{rho})\,du dv,</code>
</p>

<p>where <code class="reqn">\phi(u,v; \code{rho})</code> here denotes the binormal distribution with zero means, unit variances and correlation <code>rho</code>.
In the general case with sampling intensities <code>nu1</code> and <code>nu2</code>, <code>mu1</code> and <code>mu2</code> should be replaced by 
<code>mu1</code> + ln <code>nu1</code> and <code>mu2</code> + ln <code>nu2</code> respectively. In this case, some species will be missing from both samples.
The number of individuals for observed species will then have the truncated distribution
</p>
<p style="text-align: center;"><code class="reqn">\frac{q(\code{n1},\code{n2};\;\code{mu1},\code{sig1},\code{mu2},\code{sig2},\code{rho})}{1-q(0,0;\;\code{mu1},\code{sig1},\code{mu2},\code{sig2},\code{rho})}</code>
</p>



<h3>Value</h3>

<p><code>dbipoilog</code> returns the density<br><code>rbipoilog</code> returns random deviates
</p>


<h3>Author(s)</h3>

<p> Vidar Grotan <a href="mailto:vidar.grotan@ntnu.no">vidar.grotan@ntnu.no</a> and Steinar Engen   </p>


<h3>References</h3>

<p> Engen, S., R. Lande, T. Walla and P. J. DeVries. 2002. Analyzing spatial structure of communities using the two-dimensional 
Poisson lognormal species abundance model. American Naturalist <b>160</b>, 60-73. </p>


<h3>See Also</h3>

 <p><code>bipoilogMLE</code> for maximum likelihood estimation </p>


<h3>Examples</h3>

<pre><code class="language-R">
### change in density of n2 for two different values of rho (given n1=10)   
barplot(rbind(dbipoilog(n1=rep(10,21),n2=0:20,mu1=0,mu2=0,sig=1,sig2=1,rho=0.0),
              dbipoilog(n1=rep(10,21),n2=0:20,mu1=0,mu2=0,sig=1,sig2=1,rho=0.8)),
              beside=TRUE,space=c(0,0.2),names.arg=0:20,xlab="n2",col=1:2)
legend(35,0.0012,c("rho=0","rho=0.8"),fill=1:2)


### draw random deviates from a community of 50 species 
rbipoilog(S=50,mu1=0,mu2=0,sig1=1,sig2=2,rho=0.7)

### draw random deviates including zeros
rbipoilog(S=50,mu1=0,mu2=0,sig1=1,sig2=2,rho=0.7,keep0=TRUE)

### draw random deviates with sampling intensities nu1=0.5 and nu2=0.7 
rbipoilog(S=50,mu1=0,mu2=0,sig1=1,sig2=2,rho=0.7,nu1=0.5,nu2=0.7)

### draw random deviates conditioned on a certain number of species 
rbipoilog(S=50,mu1=0,mu2=0,sig1=1,sig2=2,rho=0.7,nu1=0.5,nu2=0.7,condS=TRUE)


### how many species are likely to be observed in at least one of the samples
### (given S,mu1,mu2,sig1,sig2,rho)? 
hist(replicate(1000,nrow(rbipoilog(S=50,mu1=0,mu2=0,sig1=1,sig2=2,rho=0.7))),
     main="", xlab = "Number of species observed in at least one of the samples")

### how many individuals are likely to be observed 
### (given S,mu1,mu2,sig1,sig2,rho)? 
hist(replicate(1000,sum(rbipoilog(S=50,mu1=0,mu2=0,sig1=1,sig2=2,rho=0.7))),
     main="", xlab="sum nr of individuals in both samples")
</code></pre>


</div>