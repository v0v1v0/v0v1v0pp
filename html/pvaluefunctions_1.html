<div class="container">

<table style="width: 100%;"><tr>
<td>conf_dist</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>Create and Plot <em>P</em>-Value Functions, S-Value Functions, Confidence Distributions and Confidence Densities</h2>

<h3>Description</h3>

<p>The function <code>conf_dist</code> generates confidence distributions (cdf), confidence densities (pdf), Shannon suprisal (s-value) functions and <em>p</em>-value functions for several commonly used estimates. In addition, counternulls (see Rosenthal et al. 1994), point estimates and the area under the confidence curve (AUCC) are calculated.
</p>


<h3>Usage</h3>

<pre><code class="language-R">conf_dist(
  estimate = NULL,
  n = NULL,
  df = NULL,
  stderr = NULL,
  tstat = NULL,
  type = NULL,
  plot_type = c("p_val", "s_val", "cdf", "pdf"),
  n_values = 10000L,
  est_names = NULL,
  conf_level = NULL,
  null_values = NULL,
  trans = "identity",
  alternative = c("two_sided", "one_sided"),
  log_yaxis = FALSE,
  cut_logyaxis = 0.05,
  xlab = NULL,
  xlim = NULL,
  together = FALSE,
  plot_legend = TRUE,
  same_color = FALSE,
  col = "black",
  nrow = NULL,
  ncol = NULL,
  plot_p_limit = (1 - 0.999),
  plot_counternull = FALSE,
  title = NULL,
  ylab = NULL,
  ylab_sec = NULL,
  inverted = FALSE,
  x_scale = c("default", "linear", "logarithm"),
  plot = TRUE
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>estimate</code></td>
<td>
<p>Numerical vector containing the estimate(s).</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>n</code></td>
<td>
<p>Numerical vector containing the sample size(s). Required for correlations, variances, proportions and differences between proportions. Must be equal the number of estimates.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>df</code></td>
<td>
<p>Numerical vector containing the degrees of freedom. Required for statistics based on the <em>t</em>-distribution (e.g. linear regression) and <em>t</em>-tests. Must be equal the number of estimates.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>stderr</code></td>
<td>
<p>Numerical vector containing the standard error(s) of the estimate(s). Required for statistics based on the <em>t</em>-distribution (e.g. linear regression) and the normal distribution (e.g. logistic regression). Must be equal the number of estimate(s).</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>tstat</code></td>
<td>
<p>Numerical vector contaiqning the <em>t</em>-statistic(s). Required for <em>t</em>-tests (means and mean differences). Must be equal the number of estimates.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>type</code></td>
<td>
<p>String indicating the type of the estimate. Must be one of the following: <code>ttest</code>, <code>linreg</code>, <code>gammareg</code>, <code>general_t</code>, <code>logreg</code>, <code>poisreg</code>, <code>coxreg</code>, <code>general_z</code>, <code>pearson</code>, <code>spearman</code>, <code>kendall</code>, <code>var</code>, <code>prop</code>, <code>propdiff</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>plot_type</code></td>
<td>
<p>String indicating the type of plot. Must be one of the following: <code>cdf</code> (confidence distribution), <code>pdf</code> (confidence density), <code>p_val</code> (<em>p</em>-value function, the default), <code>s_val</code> (Surprisal value functions). For differences between independent proportions, only <em>p</em>-value functions and Surprisal values are available.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>n_values</code></td>
<td>
<p>(optional) Integer indicating the number of points that are used to generate the graphics. The higher this number, the higher the computation time and resolution.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>est_names</code></td>
<td>
<p>(optional) String vector indicating the names of the estimate(s). Must be equal the number of estimates.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>conf_level</code></td>
<td>
<p>(optional) Numerical vector indicating the confidence level(s). Bust be between 0 and 1.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>null_values</code></td>
<td>
<p>(optional) Numerical vector indicating the null value(s) in the plot on the <em>untransformed (original)</em> scale. For example: The null values for an odds ratio of 1 is 0 on the log-odds scale. If x limits are specified with <code>xlim</code>, all null values outside of the specified x limits are ignored for plotting and a message is printed.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>trans</code></td>
<td>
<p>(optional) String indicating the transformation function that will be applied to the estimates and confidence curves. For example: <code>"exp"</code> for an exponential transformation of the log-odds in logistic regression. Can be a custom function.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>alternative</code></td>
<td>
<p>String indicating if the confidence level(s) are two-sided or one-sided. Must be one of the following: <code>two_sided</code>, <code>one_sided</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>log_yaxis</code></td>
<td>
<p>Logical. Indicating if a portion of the y-axis should be displayed on the logarithmic scale.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>cut_logyaxis</code></td>
<td>
<p>Numerical value indicating the threshold below which the y-axis will be displayed logarithmically. Must lie between 0 and 1.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>xlab</code></td>
<td>
<p>(optional) String indicating the label of the x-axis.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>xlim</code></td>
<td>
<p>(optional) Optional numerical vector of length 2 (x1, x2) indicating the limits of the x-axis on the <em>untransformed</em> scale if <code>trans</code> is not <code>identity</code>. The scale of the x-axis set by <code>x_scale</code> does not affect the x limits. For example: If you want to plot <em>p</em>-value functions for odds ratios from logistic regressions, the limits have to be given on the log-odds scale if <code>trans = "exp"</code>. Note that x1 &gt; x2 is allowed but then x2 will be the left limit and x1 the right limit (i.e. the limits are sorted before plotting). Null values (specified in <code>null_values</code>) that are outside of the specified limits are ignored and a message is printed.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>together</code></td>
<td>
<p>Logical. Indicating if graphics for multiple estimates should be displayed together or on separate plots.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>plot_legend</code></td>
<td>
<p>Logical. Indicating if a legend should be plotted if multiple curves are plotted together with different colors (i.e. <code>together = TRUE)</code> and <code>same_color = FALSE</code>).</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>same_color</code></td>
<td>
<p>Logical. Indicating if curves should be distinguished using colors if they are plotted together (i.e. <code>together = TRUE</code>). Setting this to FALSE also disables the default behavior that the two halves of the curves are plotted in different colors for a one-sided alternative.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>col</code></td>
<td>
<p>String indicating the colour of the curves. Only relevant for single curves, multiple curves not plotted together (i.e. <code>together = FALSE</code>) and multiple curves plotted together but with the option <code>same_color</code> set to <code>TRUE</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>nrow</code></td>
<td>
<p>(optional) Integer greater than 0 indicating the number of rows when <code>together = FALSE</code> is specified for multiple estimates. Used in <code>facet_wrap</code> in ggplot2.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>ncol</code></td>
<td>
<p>(optional) Integer greater than 0 indicating the number of columns when <code>together = FALSE</code> is specified for multiple estimates. Used in <code>facet_wrap</code> in ggplot2.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>plot_p_limit</code></td>
<td>
<p>Numerical value indicating the lower limit of the y-axis. Must be greater than 0 for a logarithmic scale (i.e. <code>log_yaxis = TRUE</code>). The default is to omit plotting <em>p</em>-values smaller than 1 - 0.999 = 0.001.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>plot_counternull</code></td>
<td>
<p>Logical. Indicating if the counternull should be plotted as a point. Only available for <em>p</em>-value functions and s-value functions. Counternull values that are outside of the plotted functions are not shown.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>title</code></td>
<td>
<p>(optional) String containing a title of the plot.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>ylab</code></td>
<td>
<p>(optional) String indicating the title for the primary (left) y-axis.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>ylab_sec</code></td>
<td>
<p>(optional) String indicating the title for the secondary (right) y-axis.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>inverted</code></td>
<td>
<p>Logical. Indicating the orientation of the y-axis for the <em>P</em>-value function (<code>p_val</code>), S-value function (<code>s_val</code>) and the confidence distribution (<code>cdf</code>). By default (i.e. <code>inverted = FALSE</code>) small <em>P</em>-values are plotted at the bottom and large ones at the top so that the cusp of the <em>P</em>-value function is a the top. By setting <code>inverted = TRUE</code>, the y-axis is inverted. Ignored for confidence densities.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>x_scale</code></td>
<td>
<p>String indicating the scaling of the x-axis. The default is to scale the x-axis logarithmically if the transformation specified in <code>trans</code> is "exp" (exponential) and linearly otherwise. The option <code>linear</code> (can be abbreviated) forces a linear scaling and the option <code>logarithm</code> (can be abbreviated) forces a logarithmic scaling, regardless what has been specified in <code>trans</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>plot</code></td>
<td>
<p>Logical. Should a plot be created (<code>TRUE</code>, the default) or not (<code>FALSE</code>). <code>FALSE</code> can be useful if users want to create their own plots using the returned data from the function. If <code>FALSE</code>, no ggplot2 object is returned.</p>
</td>
</tr>
</table>
<h3>Details</h3>

<p><em>P</em>-value functions and confidence intervals are calculated based on the <em>t</em>-distribution for <em>t</em>-tests, linear regression coefficients, and gamma regression models (GLM). The normal distribution is used for logistic regression, poisson regression and cox regression models. For correlation coefficients, Fisher's transform is used using the corresponding variances (see Bonett et al. 2000). <em>P</em>-value functions and confidence intervals for variances are constructed using the Chi2 distribution. Finally, Wilson's score intervals are used for one proportion. For differences of proportions, the Wilson score interval with continuity correction is used (Newcombe 1998).
</p>


<h3>Value</h3>

<p><code>conf_dist</code> returns four data frames and if <code>plot = TRUE</code> was specified, a ggplot2-plot object: <code>res_frame</code> (contains parameter values (e.g. mean differences, odds ratios etc.), <em>p</em>-values (one- and two-sided), s-values, confidence distributions and densities, variable names and type of hypothesis), <code>conf_frame</code> (contains the specified confidence level(s) and the corresponding lower and upper limits as well as the corresponding variable name), <code>counternull_frame</code> (contains the counternull and the corresponding null values), <code>point_est</code> (contains the mean, median and mode point estimates) and if <code>plot = TRUE</code> was specified, <code>aucc_frame</code> contains the estimated AUCC (area under the confidence curve, see Berrar 2017) calculated by trapezoidal integration on the untransformed scale. Also provides the proportion of the aucc that lies above the null value(s) if they are provided. <code>plot</code> (a ggplot2 object).
</p>


<h3>References</h3>

<p>Bender R, Berg G, Zeeb H. Tutorial: using confidence curves in medical research. <em>Biom J.</em> 2005;47(2):237-247.
</p>
<p>Berrar D. Confidence curves: an alternative to null hypothesis significance testing for the comparison of classifiers. <em>Mach Learn.</em> 2017;106:911-949.
</p>
<p>Bonett DG, Wright TA. Sample size requirements for estimating Pearson, Kendall and Spearman correlations. <em>Psychometrika.</em> 2000;65(1):23-28.
</p>
<p>Cole SR, Edwards JK, Greenland S. Surprise! <em>Am J Epidemiol.</em> 2021:190(2):191-193.
</p>
<p>Infanger D, Schmidt-Trucksäss A. <em>P</em> value functions: An underused method to present research results and to promote quantitative reasoning. <em>Stat Med.</em> 2019;38:4189-4197.
</p>
<p>Newcombe RG. Interval estimation for the difference between independent proportions: comparison of eleven methods. <em>Stat Med.</em> 1998;17:873-890.
</p>
<p>Poole C. Confidence intervals exclude nothing. <em>Am J Public Health.</em> 1987;77(4):492-493.
</p>
<p>Poole C. Beyond the confidence interval. <em>Am J Public Health.</em> 1987;77(2):195-199.
</p>
<p>Rafi Z, Greenland S. Semantic and cognitive tools to aid statistical science: replace confidence and significance by compatibility and surprise. <em>BMC Med Res Methodol</em> 2020;20:244.
</p>
<p>Rosenthal R, Rubin D. The counternull value of an effect size: a new statistic. <em>Psychological Science.</em> 1994;5(6):329-334.
</p>
<p>Rothman KJ, Greenland S, Lash TL. Modern epidemiology. 3rd ed. Philadelphia, PA: Wolters Kluwer; 2008.
</p>
<p>Schweder T, Hjort NL. Confidence, likelihood, probability: statistical inference with confidence distributions. New York, NY: Cambridge University Press; 2016.
</p>
<p>Sullivan KM, Foster DA. Use of the confidence interval function. <em>Epidemiology.</em> 1990;1(1):39-42.
</p>
<p>Xie Mg, Singh K. Confidence distribution, the frequentist distribution estimator of a parameter: A review. <em>Internat Statist Rev.</em> 2013;81(1):3-39.
</p>


<h3>Examples</h3>

<pre><code class="language-R">
#======================================================================================
# Create a p-value function for an estimate using the normal distribution
#======================================================================================

res &lt;- conf_dist(
  estimate = c(-0.13)
  , stderr = c(0.224494)
  , type = "general_z"
  , plot_type = "p_val"
  , n_values = 1e4L
  , est_names = c("Parameter value")
  , log_yaxis = FALSE
  , cut_logyaxis = 0.05
  , conf_level = c(0.95)
  , null_values = c(0)
  , trans = "identity"
  , alternative = "two_sided"
  , xlab = "Var"
  , xlim = c(-1, 1)
  , together = TRUE
  , plot_p_limit = 1 - 0.9999
  , plot_counternull = TRUE
  , title = NULL
  , ylab = NULL
  , ylab_sec = NULL
  , inverted = FALSE
  , x_scale = "default"
  , plot = TRUE
)

#======================================================================================
# P-value function for a single regression coefficient (Agriculture in the model below)
#======================================================================================

mod &lt;- lm(Infant.Mortality~Agriculture + Fertility + Examination, data = swiss)
summary(mod)

res &lt;- conf_dist(
  estimate = c(-0.02143)
  , df = c(43)
  , stderr = (0.02394)
  , type = "linreg"
  , plot_type = "p_val"
  , n_values = 1e4L
  , conf_level = c(0.95, 0.90, 0.80)
  , null_values = c(0)
  , trans = "identity"
  , alternative = "two_sided"
  , log_yaxis = TRUE
  , cut_logyaxis = 0.05
  , xlab = "Coefficient Agriculture"
  , together = FALSE
  , plot_p_limit = 1 - 0.999
  , plot_counternull = FALSE
  , title = NULL
  , ylab = NULL
  , ylab_sec = NULL
  , inverted = FALSE
  , x_scale = "default"
  , plot = TRUE
)

#=======================================================================================
# P-value function for an odds ratio (logistic regression), plotted with inverted y-axis
#=======================================================================================

res &lt;- conf_dist(
  estimate = c(0.804037549)
  , stderr = c(0.331819298)
  , type = "logreg"
  , plot_type = "p_val"
  , n_values = 1e4L
  , est_names = c("GPA")
  , conf_level = c(0.95, 0.90, 0.80)
  , null_values = c(log(1)) # null value on the log-odds scale
  , trans = "exp"
  , alternative = "two_sided"
  , log_yaxis = FALSE
  , cut_logyaxis = 0.05
  , xlab = "Odds Ratio (GPA)"
  , xlim = log(c(0.7, 5.2)) # axis limits on the log-odds scale
  , together = FALSE
  , plot_p_limit = 1 - 0.999
  , plot_counternull = TRUE
  , title = NULL
  , ylab = NULL
  , ylab_sec = NULL
  , inverted = TRUE
  , x_scale = "default"
  , plot = TRUE
)

#======================================================================================
# Difference between two independent proportions: Newcombe with continuity correction
#======================================================================================

res &lt;- conf_dist(
  estimate = c(68/100, 98/150)
  , n = c(100, 150)
  , type = "propdiff"
  , plot_type = "p_val"
  , n_values = 1e4L
  , conf_level = c(0.95, 0.90, 0.80)
  , null_values = c(0)
  , trans = "identity"
  , alternative = "two_sided"
  , log_yaxis = FALSE
  , cut_logyaxis = 0.05
  , xlab = "Difference between proportions"
  , together = FALSE
  , col = "#A52A2A" # Color curve in auburn
  , plot_p_limit = 1 - 0.9999
  , plot_counternull = FALSE
  , title = NULL
  , ylab = NULL
  , ylab_sec = NULL
  , inverted = FALSE
  , x_scale = "default"
  , plot = TRUE
)

#======================================================================================
# Difference between two independent proportions: Agresti &amp; Caffo
#======================================================================================

# First proportion
x1 &lt;- 8
n1 &lt;- 40

# Second proportion
x2 &lt;- 11
n2 &lt;- 30

# Apply the correction
p1hat &lt;- (x1 + 1)/(n1 + 2)
p2hat &lt;- (x2 + 1)/(n2 + 2)

# The original estimator
est0 &lt;- (x1/n1) - (x2/n2)

# The unmodified estimator and its standard error using the correction

est &lt;- p1hat - p2hat
se &lt;- sqrt(((p1hat*(1 - p1hat))/(n1 + 2)) + ((p2hat*(1 - p2hat))/(n2 + 2)))

res &lt;- conf_dist(
  estimate = c(est)
  , stderr = c(se)
  , type = "general_z"
  , plot_type = "p_val"
  , n_values = 1e4L
  , log_yaxis = FALSE
  , cut_logyaxis = 0.05
  , conf_level = c(0.95, 0.99)
  , null_values = c(0, 0.3)
  , trans = "identity"
  , alternative = "two_sided"
  , xlab = "Difference of proportions"
  , together = FALSE
  , plot_p_limit = 1 - 0.9999
  , plot_counternull = FALSE
  , title = "P-value function for the difference of two independent proportions"
  , ylab = NULL
  , ylab_sec = NULL
  , inverted = FALSE
  , x_scale = "default"
  , plot = TRUE
)

#========================================================================================
# P-value function and confidence distribution for the relative survival effect (1 - HR%)
# Replicating Figure 1 in Bender et al. (2005)
#========================================================================================

# Define the transformation function and its inverse for the relative survival effect

rse_fun &lt;- function(x){ # x is the log-hazard ratio
  100*(1 - exp(x))
}

rse_fun_inv &lt;- function(x){
  log(1 - (x/100))
}

res &lt;- conf_dist(
  estimate = log(0.72)
  , stderr = 0.187618
  , type = "coxreg"
  , plot_type = "p_val"
  , n_values = 1e4L
  , est_names = c("RSE")
  , conf_level = c(0.95, 0.8, 0.5)
  , null_values = rse_fun_inv(0)
  , trans = "rse_fun"
  , alternative = "two_sided"
  , log_yaxis = FALSE
  , cut_logyaxis = 0.05
  , xlab = "Relative survival effect (1 - HR%)"
  , xlim = rse_fun_inv(c(-30, 60))
  , together = FALSE
  , plot_p_limit = 1 - 0.999
  , plot_counternull = TRUE
  , inverted = TRUE
  , title = "Figure 1 in Bender et al. (2005)"
  , x_scale = "default"
  , plot = TRUE
)

</code></pre>


</div>