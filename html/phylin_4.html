<div class="container">

<table style="width: 100%;"><tr>
<td>gen.variogram</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>
Semi-variogram with the genetic distance matrix
</h2>

<h3>Description</h3>

<p>Computes the semi-variance with the real and genetic distances, and
with user defined lag parameters.
</p>


<h3>Usage</h3>

<pre><code class="language-R">gen.variogram(x, y, lag = quantile(as.matrix(x), 0.05), tol=lag/2, lmax = NA,
              bootstraps = 999, verbose = FALSE)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>x</code></td>
<td>

<p>Real distances matrix.
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>y</code></td>
<td>

<p>Single genetic distances matrix or list of genetic distances
matrices.
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>lag</code></td>
<td>

<p>Real distance corresponding to the desired 'lag' interval. This is
used to calculate lag centers from 0 to 'lmax'.
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>tol</code></td>
<td>

<p>Tolerance for the lag center to search for pairs ('lag'-'tol',
'lag'+'tol').
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>lmax</code></td>
<td>

<p>Maximum distance for lag centers. Pairs with distances higher than
'lmax' are not included in the calcualtion of the semi-variance. If
'lmax' is NA (default) then is used the maximum distance between
samples.
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>bootstraps</code></td>
<td>

<p>This is the number of bootstraps used to calculate 95% confidence
interval for the median, when multiple genetic distances are given.
With a single genetic distance, this parameter is ignored.
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>verbose</code></td>
<td>

<p>Boolean for verbosity. When TRUE and with multiple genetic distance
matrices, a log of error evolution is printed.
</p>
</td>
</tr>
</table>
<h3>Details</h3>

<p>This function produces a table with real lag centers and
semi-variance. The formula to calculate semi-variance,
<code class="reqn">\gamma(h)</code>, is:
</p>
<p style="text-align: center;"><code class="reqn">\gamma(h) = {\frac{1}{2 n(h)}} \sum_{i=1}^{n}[z(x_i + h) -
        z(x_i)]^2</code>
</p>

<p>where <code class="reqn">n(h)</code> is the number of pairs with the lag distance <code class="reqn">h</code>
between them, and <code class="reqn">z</code> is the value of the sample <code class="reqn">x</code> at the
the location <code class="reqn">i</code>. The difference between sample
<code class="reqn">z(x_i+h)</code> and sample <code class="reqn">z(x_i)</code> is assumed to
correspond to their genetic distance.
</p>
<p>Multiple genetic distance matrices can be used. In this case, a
variogram is computed for each genetic distance and the results
summarised by the median and a 95% confidence interval calculated
with bootstraps.
</p>


<h3>Value</h3>

<p>Returns a 'gv' object with the input data, lag centers and semi-variance.
</p>


<h3>Note</h3>

<p>It is assumed that the order of samples in x corresponds to the same in y.
</p>


<h3>Author(s)</h3>

<p>Pedro Tarroso &lt;ptarroso@cibio.up.pt&gt;
</p>


<h3>References</h3>

<p>Fortin, M. -J. and Dale, M. (2006) <em>Spatial Analysis: A guide for Ecologists</em>. Cambridge: Cambridge University Press.
</p>
<p>Isaaks, E. H. and Srivastava, R. M. (1989) <em>An Introduction to applied geostatistics</em>. New York: Oxford University Press.
</p>
<p>Legendre, P. and Legendre, L. (1998) <em>Numerical ecology</em>. 2nd english edition. Amesterdam: Elsevier
</p>


<h3>See Also</h3>

<p><code>plot.gv</code>
<code>predict.gv</code>
<code>gv.model</code>
</p>


<h3>Examples</h3>

<pre><code class="language-R">
    data(vipers)
    data(d.gen)

    # create a distance matrix between samples
    r.dist &lt;- dist(vipers[,1:2])

    # variogram table with semi-variance and lag centers
    gv &lt;- gen.variogram(r.dist, d.gen)

    # plot variogram
    plot(gv)

    # fit a new variogram with different lag
    gv2 &lt;- gen.variogram(r.dist, d.gen, lag=0.2)
    plot(gv2)

</code></pre>


</div>