<div class="container">

<table style="width: 100%;"><tr>
<td>triquad</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>
Gaussian Triangle Quadrature
</h2>

<h3>Description</h3>

<p>Numerically integrates a function over an arbitrary triangular domain by
computing the Gauss nodes and weights.
</p>


<h3>Usage</h3>

<pre><code class="language-R">triquad(f, x, y, n = 10, tol = 1e-10, ...)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>f</code></td>
<td>
<p>the integrand as function of two variables.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>x</code></td>
<td>
<p>x-coordinates of the three vertices of the triangle.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>y</code></td>
<td>
<p>y-coordinates of the three vertices of the triangle.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>n</code></td>
<td>
<p>number of nodes.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>tol</code></td>
<td>
<p>relative tolerance to be achieved.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>...</code></td>
<td>
<p>additional parameters to be passed to the function.</p>
</td>
</tr>
</table>
<h3>Details</h3>

<p>Computes the <code>N^2</code> nodes and weights for a triangle with vertices
given by 3x2 vector. The nodes are produced by collapsing the square
to a triangle.
</p>
<p>Then <code>f</code> will be applied to the nodes and the result multiplied
left and right with the weights (i.e., Gaussian quadrature).
</p>
<p>By default, the function applies Gaussian quadrature with number of
nodes <code>n=10,21,43,87,175</code> until the relative error is smaller than
the tolerance.
</p>


<h3>Value</h3>

<p>The integral as a scalar.
</p>


<h3>Note</h3>

<p>A small relative tolerance is <em>not</em> really indicating a small
absolute tolerance.
</p>


<h3>Author(s)</h3>

<p>Copyright (c) 2005 Greg von Winckel Matlab code based on the publication
mentioned and available from MatlabCentral (calculates nodes and weights).
Translated to R (with permission) by Hans W Borchers.
</p>


<h3>References</h3>

<p>Lyness, J. N., and R. Cools (1994). A Survey of Numerical Cubature
over Triangles. Proceedings of the AMS Conference “Mathematics of
Computation 1943–1993”, Vancouver, CA.
</p>


<h3>See Also</h3>

<p><code>quad2d</code>, <code>simpson2d</code>
</p>


<h3>Examples</h3>

<pre><code class="language-R">x &lt;- c(-1, 1, 0); y &lt;- c(0, 0, 1)
f1 &lt;- function(x, y) x^2 + y^2
(I &lt;- triquad(f1, x, y))                        # 0.3333333333333333

# split the unit square
x1 &lt;- c(0, 1, 1); y1 &lt;- c(0, 0, 1)
x2 &lt;- c(0, 1, 0); y2 &lt;- c(0, 1, 1)
f2 &lt;- function(x, y) exp(x + y)
I &lt;- triquad(f2, x1, y1) + triquad(f2, x2, y2)  # 2.952492442012557
quad2d(f2, 0, 1, 0, 1)                          # 2.952492442012561
simpson2d(f2, 0, 1, 0, 1)                       # 2.952492442134769
dblquad(f2,  0, 1, 0, 1)                        # 2.95249244201256
</code></pre>


</div>