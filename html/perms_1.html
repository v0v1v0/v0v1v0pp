<div class="container">

<table style="width: 100%;"><tr>
<td>get_log_ML</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>get_log_ML</h2>

<h3>Description</h3>

<p>Computes the log marginal likelihood of the data from the log permanents.
Given the computed log permanents log_perms, this function computes the log marginal 
likelihood using the formula (2.3) in [1]. It is assumed that there are no repeated trials.
If the data contain repeated trials, then the appropriate log binomial factor must be added 
to the output of this function.
</p>


<h3>Usage</h3>

<pre><code class="language-R">get_log_ML(log_perms, n, debug = FALSE)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>log_perms</code></td>
<td>
<p>A vector length n containing the computed log permanents, where a zero permanent
is indicated by a NA value.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>n</code></td>
<td>
<p>Sample size.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>debug</code></td>
<td>
<p>If <code>TRUE</code>, debug information is printed.</p>
</td>
</tr>
</table>
<h3>Value</h3>

<p>The estimated log marginal likelihood. A NA value is returned if there are no non-zero
numbers.
</p>


<h3>References</h3>

<p>[1] Christensen, D (2024). Inference for Bayesian nonparametric models with binary response data via permutation counting. Bayesian Analysis, DOI: 10.1214/22-BA1353.
</p>


<h3>Examples</h3>

<pre><code class="language-R">library(perms)
set.seed(1996)
n = 100
t = seq(0, 1, length.out=n)
y = c(rep(0, n/2), rep(1, n/2))
S = 200
X = matrix(runif(n*S),nrow = S, ncol = n)

log_perms = get_log_perms(X, t, y, debug = FALSE, parallel = FALSE, num_cores = NULL)

num_nonzero_perms = sum(!is.na(log_perms))
num_nonzero_perms

log_ML = get_log_ML(log_perms, n, FALSE)
log_ML
</code></pre>


</div>