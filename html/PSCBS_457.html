<div class="container">

<table style="width: 100%;"><tr>
<td>estimateDeltaABBySmallDH.PairedPSCBS</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>Estimate a threshold for calling allelic balance from DH</h2>

<h3>Description</h3>

<p>Estimate a threshold for calling allelic balance from DH.
</p>


<h3>Usage</h3>

<pre><code class="language-R">## S3 method for class 'PairedPSCBS'
estimateDeltaABBySmallDH(fit, q1=0.05, q2=0.9, ..., verbose=FALSE)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>q1</code></td>
<td>
<p>A <code>numeric</code> value specifying the weighted quantile of the
segment-level DHs used to identify segments with small DH means.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>q2</code></td>
<td>
<p>A <code>numeric</code> value specifying the quantile of the locus-level
DH signals for those segments with small DH mean levels.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>...</code></td>
<td>
<p>Not used.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>verbose</code></td>
<td>
<p>See <code>Verbose</code>.</p>
</td>
</tr>
</table>
<h3>Value</h3>

<p>Returns the threshold estimate as a <code>numeric</code> scalar.
</p>


<h3>Algorithm</h3>


<ul>
<li>
<p> Grabs the segment-level DH estimates.
</p>
</li>
<li>
<p> Calculate segment weights proportional to the number
of heterozygous SNPs.
</p>
</li>
<li>
<p> Calculate <code class="reqn">\Delta</code> as the 5% quantile of the weighted DH means.
</p>
</li>
<li>
<p> Choose the segments with means less than <code class="reqn">\Delta</code>.
</p>
</li>
<li>
<p> Calculate threshold <code class="reqn">\Delta_{AB}</code> as the 90% "symmetric" quantile
of the observed locus-level DHs from the selected segments
in Step 4.
The q:th "symmetric" quantile is estimated by estimating
the ((1-q), 50%) quantiles, calculating their distance as
"50%-(1-q)" and add to the median (50%), i.e.
"median + (median-(1-q))" = "2*median-1 + q", which should
equal q if the distribution is symmetric.
</p>
</li>
</ul>
<h3>Author(s)</h3>

<p>Henrik Bengtsson</p>


<h3>See Also</h3>

<p>Instead of calling this method explicitly, it is recommended
to use the <code>*estimateDeltaAB()</code> method.
</p>


</div>