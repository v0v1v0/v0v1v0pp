<div class="container">

<table style="width: 100%;"><tr>
<td>cv_fast</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>Evaluate Trait Predictability via the HAT Method</h2>

<h3>Description</h3>

<p>The HAT method is a fast algorithm for the ordinary cross validation. It is highly recommended for large dataset (Xu et al. 2017).
</p>


<h3>Usage</h3>

<pre><code class="language-R">cv_fast(fix = NULL, y, kk, nfold = 5, seed = 123)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>fix</code></td>
<td>
<p>a design matrix of the fixed effects. If not passed, a vector of ones is added for the intercept.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>y</code></td>
<td>
<p>a vector of the phenotypic values.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>kk</code></td>
<td>
<p>a list of one or multiple kinship matrices.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>nfold</code></td>
<td>
<p>the number of folds, default is 5. For the HAT Method, nfold can be set as the sample size (leave-one-out CV) to avoid
variation caused by random partitioning of the samples, but it is not recommended for <code>cv</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>seed</code></td>
<td>
<p>the random number, default is 123.</p>
</td>
</tr>
</table>
<h3>Value</h3>

<p>Trait predictability
</p>


<h3>References</h3>

<p>Xu S. (2017) Predicted residual error sum of squares of mixed models: an application for genomic prediction. G3 (Bethesda) 7, 895-909.
</p>


<h3>Examples</h3>

<pre><code class="language-R">
## load example data from hypred package
data(hybrid_phe)
data(input_geno)

## convert original genotype
inbred_gen &lt;- convertgen(input_geno, type = "hmp2")

## infer the additive and dominance genotypes of hybrids
gena &lt;- infergen(inbred_gen, hybrid_phe)$add
gend &lt;- infergen(inbred_gen, hybrid_phe)$dom

## calculate the additive and dominance kinship matrix
ka &lt;- kin(gena)
kd &lt;- kin(gend)

##for the additive model
predictability &lt;- cv_fast(y = hybrid_phe[,3], kk = list(ka))

##for the additive-dominance model
predictability &lt;- cv_fast(y = hybrid_phe[,3], kk = list(ka,kd))


</code></pre>


</div>