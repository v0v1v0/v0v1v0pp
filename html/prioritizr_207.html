<div class="container">

<table style="width: 100%;"><tr>
<td>eval_rare_richness_importance</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>Evaluate solution importance using rarity weighted richness scores</h2>

<h3>Description</h3>

<p>Calculate importance scores for planning units selected in a solution
using rarity weighted richness scores (based on Williams <em>et al.</em> 1996).
This method is only recommended for large-scaled conservation
planning exercises (i.e., more than 100,000 planning units) where
importance scores cannot be calculated using other methods in a feasible
period of time. This is because rarity weighted richness scores cannot (i)
account for the cost of different planning units, (ii) account for multiple
management zones, and (iii) identify truly irreplaceable planning units —
unlike the replacement cost metric which does not suffer any of these
limitations.
</p>


<h3>Usage</h3>

<pre><code class="language-R">eval_rare_richness_importance(x, solution, ...)

## S4 method for signature 'ConservationProblem,numeric'
eval_rare_richness_importance(x, solution, rescale, ...)

## S4 method for signature 'ConservationProblem,matrix'
eval_rare_richness_importance(x, solution, rescale, ...)

## S4 method for signature 'ConservationProblem,data.frame'
eval_rare_richness_importance(x, solution, rescale, ...)

## S4 method for signature 'ConservationProblem,Spatial'
eval_rare_richness_importance(x, solution, rescale, ...)

## S4 method for signature 'ConservationProblem,sf'
eval_rare_richness_importance(x, solution, rescale, ...)

## S4 method for signature 'ConservationProblem,Raster'
eval_rare_richness_importance(x, solution, rescale, ...)

## S4 method for signature 'ConservationProblem,SpatRaster'
eval_rare_richness_importance(x, solution, rescale, ...)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>x</code></td>
<td>
<p><code>problem()</code> object.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>solution</code></td>
<td>
<p><code>numeric</code>, <code>matrix</code>, <code>data.frame</code>,
<code>terra::rast()</code>, or <code>sf::sf()</code> object.
The argument should be in the same format as the planning unit cost
data in the argument to <code>x</code>.
See the Solution format section for more information.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>...</code></td>
<td>
<p>not used.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>rescale</code></td>
<td>
<p><code>logical</code> flag indicating if replacement cost
values – excepting infinite (<code>Inf</code>) and zero values – should be
rescaled to range between 0.01 and 1. Defaults to <code>TRUE</code>.</p>
</td>
</tr>
</table>
<h3>Details</h3>

<p>Rarity weighted richness scores are calculated using the following
terms. Let <code class="reqn">I</code> denote the set of planning units (indexed by
<code class="reqn">i</code>), let <code class="reqn">J</code> denote the set of conservation features (indexed by
<code class="reqn">j</code>), let <code class="reqn">r_{ij}</code> denote the amount of feature <code class="reqn">j</code>
associated with planning unit <code class="reqn">i</code>, and let <code class="reqn">m_j</code> denote the
maximum value of feature <code class="reqn">j</code> in <code class="reqn">r_{ij}</code> in all planning units
<code class="reqn">i \in I</code>. To calculate the rarity weighted richness (<em>RWR</em>) for
planning unit <code class="reqn">k</code>:
</p>
<p style="text-align: center;"><code class="reqn">
  \mathit{RWR}_{k} = \sum_{j}^{J} \frac{ \frac{r_{ik}}{m_j} }{
                                          \sum_{i}^{I}r_{ij}}
  </code>
</p>



<h3>Value</h3>

<p>A <code>numeric</code>, <code>matrix</code>, <code>data.frame</code>,
<code>terra::rast()</code>, or <code>sf::sf()</code> object
containing the importance scores for each planning
unit in the solution. Specifically, the returned object is in the
same format as the planning unit data in the argument to <code>x</code>.
</p>


<h3>Solution format</h3>

<p>Broadly speaking, the argument to <code>solution</code> must be in the same format as
the planning unit data in the argument to <code>x</code>.
Further details on the correct format are listed separately
for each of the different planning unit data formats:
</p>

<dl>
<dt>
<code>x</code> has <code>numeric</code> planning units</dt>
<dd>
<p>The argument to <code>solution</code> must be a
<code>numeric</code> vector with each element corresponding to a different planning
unit. It should have the same number of planning units as those
in the argument to <code>x</code>. Additionally, any planning units missing
cost (<code>NA</code>) values should also have missing (<code>NA</code>) values in the
argument to <code>solution</code>.
</p>
</dd>
<dt>
<code>x</code> has <code>matrix</code> planning units</dt>
<dd>
<p>The argument to <code>solution</code> must be a
<code>matrix</code> vector with each row corresponding to a different planning
unit, and each column correspond to a different management zone.
It should have the same number of planning units and zones
as those in the argument to <code>x</code>. Additionally, any planning units
missing cost (<code>NA</code>) values for a particular zone should also have a
missing (<code>NA</code>) values in the argument to <code>solution</code>.
</p>
</dd>
<dt>
<code>x</code> has <code>terra::rast()</code> planning units</dt>
<dd>
<p>The argument to <code>solution</code>
be a <code>terra::rast()</code> object where different grid cells (pixels) correspond
to different planning units and layers correspond to
a different management zones. It should have the same dimensionality
(rows, columns, layers), resolution, extent, and coordinate reference
system as the planning units in the argument to <code>x</code>. Additionally,
any planning units missing cost (<code>NA</code>) values for a particular zone
should also have missing (<code>NA</code>)  values in the argument to <code>solution</code>.
</p>
</dd>
<dt>
<code>x</code> has <code>data.frame</code> planning units</dt>
<dd>
<p>The argument to <code>solution</code> must
be a <code>data.frame</code> with each column corresponding to a different zone,
each row corresponding to a different planning unit, and cell values
corresponding to the solution value. This means that if a <code>data.frame</code>
object containing the solution also contains additional columns, then
these columns will need to be subsetted prior to using this function
(see below for example with <code>sf::sf()</code> data).
Additionally, any planning units missing cost
(<code>NA</code>) values for a particular zone should also have missing (<code>NA</code>)
values in the argument to <code>solution</code>.
</p>
</dd>
<dt>
<code>x</code> has <code>sf::sf()</code> planning units</dt>
<dd>
<p>The argument to <code>solution</code> must be
a <code>sf::sf()</code> object with each column corresponding to a different
zone, each row corresponding to a different planning unit, and cell values
corresponding to the solution value. This means that if the
<code>sf::sf()</code> object containing the solution also contains additional
columns, then these columns will need to be subsetted prior to using this
function (see below for example).
Additionally, the argument to <code>solution</code> must also have the same
coordinate reference system as the planning unit data.
Furthermore, any planning units missing cost
(<code>NA</code>) values for a particular zone should also have missing (<code>NA</code>)
values in the argument to <code>solution</code>.
</p>
</dd>
</dl>
<h3>References</h3>

<p>Williams P, Gibbons D, Margules C, Rebelo A, Humphries C, and Pressey RL
(1996) A comparison of richness hotspots, rarity hotspots and complementary
areas for conserving diversity using British birds.
<em>Conservation Biology</em>, 10: 155–174.
</p>


<h3>See Also</h3>

<p>See importance for an overview of all functions for evaluating
the importance of planning units selected in a solution.
</p>
<p>Other importances: 
<code>eval_ferrier_importance()</code>,
<code>eval_replacement_importance()</code>
</p>


<h3>Examples</h3>

<pre><code class="language-R">## Not run: 
# seed seed for reproducibility
set.seed(600)

# load data
sim_pu_raster &lt;- get_sim_pu_raster()
sim_pu_polygons &lt;- get_sim_pu_polygons()
sim_features &lt;- get_sim_features()

# create minimal problem with raster planning units
p1 &lt;-
  problem(sim_pu_raster, sim_features) %&gt;%
  add_min_set_objective() %&gt;%
  add_relative_targets(0.1) %&gt;%
  add_binary_decisions() %&gt;%
  add_default_solver(gap = 0, verbose = FALSE)

# solve problem
s1 &lt;- solve(p1)

# print solution
print(s1)

# plot solution
plot(s1, main = "solution", axes = FALSE)

# calculate importance scores
rwr1 &lt;- eval_rare_richness_importance(p1, s1)

# print importance scores
print(rwr1)

# plot importance scores
plot(rwr1, main = "rarity weighted richness", axes = FALSE)

# create minimal problem with polygon planning units
p2 &lt;-
  problem(sim_pu_polygons, sim_features, cost_column = "cost") %&gt;%
  add_min_set_objective() %&gt;%
  add_relative_targets(0.05) %&gt;%
  add_binary_decisions() %&gt;%
  add_default_solver(gap = 0, verbose = FALSE)

# solve problem
s2 &lt;- solve(p2)

# print solution
print(s2)

# plot solution
plot(s2[, "solution_1"], main = "solution")

# calculate importance scores
rwr2 &lt;- eval_rare_richness_importance(p2, s2[, "solution_1"])

# plot importance scores
plot(rwr2, main = "rarity weighted richness")

## End(Not run)

</code></pre>


</div>