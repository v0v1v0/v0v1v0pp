<div class="container">

<table style="width: 100%;"><tr>
<td>qtuv_s.e.irrad</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>Spectral irradiance from the Quick TUV calculator</h2>

<h3>Description</h3>

<p>Call the Quick TUV calculator web server and return a <code>source_spct</code>
object with the simulated spectral energy irradiance data.
</p>


<h3>Usage</h3>

<pre><code class="language-R">qtuv_s.e.irrad(
  w.length = list(wStart = 280, wStop = 420, wIntervals = 140),
  sun.elevation = NULL,
  geocode = data.frame(lon = 0, lat = 51.5, address = "Greenwich"),
  time = lubridate::now(),
  tz = NULL,
  locale = readr::default_locale(),
  ozone.du = 300,
  albedo = 0.1,
  ground.altitude = 0,
  measurement.altitude = 0,
  clouds = data.frame(optical.depth = 0, base = 4, top = 5),
  aerosols = data.frame(optical.depth = 0.235, ssaaer = 0.99, alpha = 1),
  num.streams = 2,
  spectra = list(direct = 1, diffuse.down = 1, diffuse.up = 0),
  added.vars = NULL,
  label = "",
  server.url = "https://www.acom.ucar.edu/cgi-bin/acom/TUV/V5.3/tuv",
  file = NULL
)

qtuv_m_s.e.irrad(
  w.length = list(wStart = 280, wStop = 420, wIntervals = 140),
  sun.elevation = NULL,
  geocode = data.frame(lon = 0, lat = 51.5, address = "Greenwich"),
  time = lubridate::now(),
  tz = NULL,
  locale = readr::default_locale(),
  ozone.du = 300,
  albedo = 0.1,
  ground.altitude = 0,
  measurement.altitude = 0,
  clouds = data.frame(optical.depth = 0, base = 4, top = 5),
  aerosols = data.frame(optical.depth = 0.235, ssaaer = 0.99, alpha = 1),
  num.streams = 2,
  spectra = list(direct = 1, diffuse.down = 1, diffuse.up = 0),
  added.vars = NULL,
  label = "",
  server.url = "https://www.acom.ucar.edu/cgi-bin/acom/TUV/V5.3/tuv",
  file = NULL
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>w.length</code></td>
<td>
<p>list of parameters describing the wavelengths, or a numeric
vector from which the parameters will be constructed.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>sun.elevation</code></td>
<td>
<p>numeric Angle in degrees above the horizon. If NULL its
value is computed from <code>geocode</code> and <code>time</code>, otherwise 
arguments passed to these two parameters are ignored.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>geocode</code></td>
<td>
<p>data.frame with variables <code>lon</code> and <code>lat</code> as numeric values
(degrees), and character variable <code>address</code>; nrow &gt; 1, allowed for collections.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>time</code></td>
<td>
<p>A "vector" of POSIXct time, with any valid time zone (TZ) is
allowed, default is current time.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>tz</code></td>
<td>
<p>character Time zone is by default read from the file.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>locale</code></td>
<td>
<p>The locale controls defaults that vary from place to place. The
default locale is US-centric (like R), but you can use
<code>locale</code> to create your own locale that controls things
like the default time zone, encoding, decimal mark, big mark, and day/month
names.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>ozone.du</code></td>
<td>
<p>numeric Ozone column in Dobson units.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>albedo</code></td>
<td>
<p>numeric Surface albedo (= reflectance) as a fraction of one.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>measurement.altitude, ground.altitude</code></td>
<td>
<p>numeric Altitudes above sea level
expressed in km.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>clouds</code></td>
<td>
<p>data.frame Parameters <code>optical.depth</code> (vertical), <code>top</code> and 
<code>base</code> expressed in km; nrow &gt; 1, allowed for collections.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>aerosols</code></td>
<td>
<p>data.frame Parameters <code>optical.depth</code> (total extinction), <code>ssaaer</code> 
(cloud single scattering albedo) and <code>alpha</code> (wavelength dependence of 
optical depth); nrow &gt; 1, allowed for collections.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>num.streams</code></td>
<td>
<p>integer Number of streams used in computations, 2 or 4.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>spectra</code></td>
<td>
<p>named list with weights for the different components of the 
spectrum.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>added.vars</code></td>
<td>
<p>character vector Accepted member values are <code>"sun.elevation"</code>,
<code>zenith.angle</code>, <code>"date"</code> and <code>"ozone.du"</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>label</code></td>
<td>
<p>character string, but if <code>NULL</code> the value of <code>file</code> is
used, and if <code>NA</code> the "what.measured" attribute is not set.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>server.url</code></td>
<td>
<p>character The URL used to access the Quick TUV calculator
server.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>file</code></td>
<td>
<p>character The name under which the file returned by the server is
locally saved. If <code>NULL</code> a temporary file is used and discarded
immediately. File paths are supported when valid.</p>
</td>
</tr>
</table>
<h3>Details</h3>

<p>The Quick TUV calculator, is an on-line freely accessible server
running the TUV atmospheric chemistry and radiation transfer model with a
simplified user interface. In this case, version 5.3 is called passing the
parameter values passed as arguments in the call to
<code>qtuv_s.e.irrad()</code>. The response is saved in a text file that is
subsequently read with function <code>read_qtuv_txt()</code> into a
<code>source_spct</code> object.
</p>
<p>Function <code>qtuv_m_s.e.irrad()</code> calls <code>qtuv_s.e.irrad()</code> repeatedly 
accepting a numeric vector longer than one as argument, for parameters: 
<code>sun.elevation</code>, <code>time</code> or <code>ozone.du</code>, and data frames with
nrow &gt;= 1. In a given call, only one parameter at a time can obey multiple 
values, with others currently truncated to the first value.
</p>
<p>The formal parameter names are informative and consistent with other 
functions in the R for Photobiology Suite and differ from the short names
used for the parameters in the FORTRAN code of the TUV model. In the case
of <code>w.length</code> two ways of specifying wavelengths are supported. Some
defaults also differ from those of the Quick TUV calculator.
</p>


<h3>Value</h3>

<p>In the case of <code>qtuv_s.e.irrad()</code>, a source_spct object obtained
by finding the center of each wavelength interval in the Quick TUV output
file, and adding the variables listed in <code>added.vars</code>. In the case of
<code>qtuv_m_s.e.irrad()</code>, a source_mspct object containing a collection of
spectra.
</p>


<h3>Side effect</h3>

<p>If a file name is passed as argument, the data as
downloaded are saved into persistent files, one file per spectrum. The
names of the saved files always end in '.txt'.
</p>


<h3>Warning!</h3>

<p>This function connects to a server managed by UCAR, the
University Corporation for Atmospheric Research located in the U.S.A. to
obtain simulated spectral data. UCAR manages the U.S. National Science
Foundation National Center for Atmospheric Research (NSF NCAR) on behalf of
NSF. As any download with the HTTPS protocol, using this function entails
some risk. To minimize the risk, the returned page is saved as plain text,
checked for conformity with the expected content, and if valid decoded into
an R data object. When using the default argument <code>file = NULL</code>, the
file used is a temporary one and is deleted before the function returns the
call, irrespective of it being conformant or not.
</p>
<p>The administrators of the Quick TUV Calculator at UCAR suggest a maximum
load of approximately 100 spectral simulations per day and user. For larger
workloads they encourage the local installation of the TUV model which is
open-source and freely available. A local installation, also allows access
to the full set of input parameters and outputs. Currently a local instance
of the TUV model can be called from R with package 'foqat'.
</p>


<h3>Note</h3>

<p>The Quick TUV calculator has multiple output modes that return
different types of computed values. The use of output mode 5 is hard-coded
in this function as other modes return summary values rather than spectral
data. Package 'foqat' provides a more flexible alternative supporting other
output modes in addition to mode 5.
</p>
<p>If the argument passed to <code>w.length</code> is a numeric vector, the range
and length are used to reconstruct the accepted parameters. The returned
spectrum has always a uniformly spaced wavelengths.
</p>
<p>When using this function, more detailed metadata are available than when
reading an output file, as not all the simulation input parameters are
listed in the output text.
</p>
<p>In interactive use of the Quick TUV Calculator, the same parameters as
accepted by <code>qtuv_s.e.irradiance()</code> as arguments are
entered through the web interface at 
<a href="https://www.acom.ucar.edu/Models/TUV/Interactive_TUV/">https://www.acom.ucar.edu/Models/TUV/Interactive_TUV/</a>. This page 
together with its documentation, can be consulted for additional
information on the parameters and the model.
</p>


<h3>References</h3>

<p><a href="https://www.acom.ucar.edu/Models/TUV/Interactive_TUV/">https://www.acom.ucar.edu/Models/TUV/Interactive_TUV/</a>. This
URL could change in the future as well as the server URL. The formal
parameter <code>server.url</code> was included only for use in such a case.
</p>
<p>Sasha Madronich (2017-2021) Tropospheric Ultraviolet and Visible radiation (TUV) 
model. <a href="https://www2.acom.ucar.edu/modeling/tropospheric-ultraviolet-and-visible-tuv-radiation-model">https://www2.acom.ucar.edu/modeling/tropospheric-ultraviolet-and-visible-tuv-radiation-model</a>.
Visited on 2024-08-29.
</p>


</div>