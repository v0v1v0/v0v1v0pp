<div class="container">

<table style="width: 100%;"><tr>
<td>Insol_l1l2</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>Time-integrated insolation</h2>

<h3>Description</h3>

<p>Computes time-integrated incoming solar radiation (Insol) either between
given true solar longitudes (<code>Insol_l1l2</code>) or days of year
(<code>Insol_d1d2</code>) for a given orbit and latitude
</p>


<h3>Usage</h3>

<pre><code class="language-R">Insol_l1l2(
  orbit,
  l1 = 0,
  l2 = 2 * pi,
  lat = 65 * pi/180,
  avg = FALSE,
  ell = TRUE,
  ...
)

Insol_d1d2(orbit, d1, d2, lat = 65 * pi/180, avg = FALSE, ...)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>orbit</code></td>
<td>
<p>Output from a solution, such as <code>ber78</code>, <code>ber90</code> or
<code>la04</code></p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>l1</code></td>
<td>
<p>lower true solar longitude bound of the time-integral</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>l2</code></td>
<td>
<p>upper true solar longitude bound of the time-integral</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>lat</code></td>
<td>
<p>latitude</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>avg</code></td>
<td>
<p>performs a time-average.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>ell</code></td>
<td>
<p>uses elliptic integrals for the calculation (much faster)</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>...</code></td>
<td>
<p>other arguments to be passed to <code>Insol</code></p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>d1</code></td>
<td>
<p>lower calendar day (360-day year) of the time-integral</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>d2</code></td>
<td>
<p>upper calendar day (360-day year) of the time-integral</p>
</td>
</tr>
</table>
<h3>Details</h3>

<p>All angles input measured in radians.
</p>
<p>Note that in contrast to Berger (2010) we consider the tropic year as the
reference, rather than the sideral year, which partly explains some of the
small differences with the original publication
</p>


<h3>Value</h3>

<p>Time-integrated insolation in kJ/m2 if <code>avg=TRUE</code>, else
time-average in W/m2
</p>


<h3>Functions</h3>


<ul><li> <p><code>Insol_d1d2()</code>: Mean and integrated insolation over an interval bounded by calendar days
</p>
</li></ul>
<h3>Author(s)</h3>

<p>Michel Crucifix, U. catholique de Louvain, Belgium.
</p>


<h3>References</h3>

<p>Berger, A., Loutre, M.F. and Yin Q. (2010), Total irradiation
during any time interval of the year using elliptic integrals, Quaternary
Science Reviews, 29, 1968 - 1982, doi:10.1016/j.quascirev.2010.05.007
</p>


<h3>Examples</h3>

<pre><code class="language-R">
## reproduces Table 1a of Berger et al. 2010:
lat &lt;- seq(85, -85, -10) * pi/180. ## angles in radians. 
orbit=c(eps=  23.446 * pi/180., ecc= 0.016724, varpi= (102.04 - 180)* pi/180. )
T &lt;-  sapply(lat, function(x) c(lat = x * 180/pi, 
        m1 =  Insol_l1l2(orbit, 0, 70 * pi/180, lat=x, ell= TRUE, S0=1368) / 1e3,
        m2 =  Insol_l1l2(orbit, 0, 70 * pi/180, lat=x, ell=FALSE, S0=1368) / 1e3) ) 
data.frame(t(T))
 ## reproduces Table 1b of Berger et al. 2010:
lat &lt;- c(85, 55, 0, -55, -85) * pi/180. ## angles in radians. 
T &lt;-  sapply(lat, function(x) c(lat = x * 180/pi, 
         m1 =  Insol_l1l2(orbit, 30 * pi/180. , 75 * pi/180, 
               lat=x, ell= TRUE, S0=1368) / 1e3,
         m2 =  Insol_l1l2(orbit, 30 * pi/180. , 75 * pi/180, 
               lat=x, ell=FALSE, S0=1368) / 1e3) ) 
 ## reproduces Table 2a of Berger et al. 2010:
lat &lt;- seq(85, -85, -10) * pi/180. ## angles in radians. 

## 21 march in a 360-d year. By definition : day 80 = 21 march at 12u
d1 = 79.5 
d2 = 79.5 + (10 + 30 + 30 ) * 360/365.2425 ## 30th May in a 360-d year

T &lt;-  sapply(lat, function(x) c(lat = x * 180/pi, 
        m1 =  Insol_d1d2(orbit, d1,d2, lat=x, ell= TRUE, S0=1368) / 1e3,
        m2 =  Insol_d1d2(orbit, d1,d2, lat=x, ell= FALSE, S0=1368) / 1e3))
                          
## I did not quite get the same results as on the table 
## on this one; probably a matter of calendar
## note : the authors in fact used S0=1368 (pers. comm.) 
## 1366 in the paper is a misprint

data.frame(t(T))

## annual mean insolation at 65N North, as a function of the longitude of the perihelion
## (expected to be invariant)

varpis &lt;- seq(0,360,10)*pi/180.  
sapply(varpis, function(varpi)
   {   orbit=c(eps=  23.446 * pi/180., ecc= 0.016724, varpi= varpi )
       amean &lt;- Insol_l1l2 (orbit, lat=65*pi/180., avg=TRUE)
       return(amean)
   })
</code></pre>


</div>