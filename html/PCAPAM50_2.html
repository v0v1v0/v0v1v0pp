<div class="container">

<table style="width: 100%;"><tr>
<td>makeCalls.PC1ihc</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>Make intermediate intrinsic subtype calls</h2>

<h3>Description</h3>

<p>This function processes clinical IHC subtyping data and preprocessed PAM50 gene expression data
to form a gene expression-guided ER-balanced set.This set is created by combining IHC classification
information and using principal component 1 (PC1) to guide the separation.The function computes
the median for each gene in this ER-balanced set, updates a calibration file, and runs subtype
prediction algorithms to generate intermediate intrinsic subtype calls based on the PAM50 method.
Various diagnostics and subtyping results are returned.
</p>


<h3>Usage</h3>

<pre><code class="language-R">makeCalls.PC1ihc(df.cln, seed = 118, mat, inputDir=NULL)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>df.cln</code></td>
<td>
<p>Data frame of clinical data; It should include the columns 'PatientID' and 'IHC'.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>seed</code></td>
<td>
<p>Seed for random number generation to ensure reproducibility. Default is 118.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>mat</code></td>
<td>
<p>Matrix of preprocessed PAM50 expression data.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>inputDir</code></td>
<td>
<p>Directory for output files.If <code>NULL</code>, a subdirectory named "Calls.PC1ihc" within the temporary directory will be used.</p>
</td>
</tr>
</table>
<h3>Value</h3>

<p>Returns a list containing:
</p>
<table>
<tr style="vertical-align: top;">
<td><code>Int.sbs</code></td>
<td>
<p>Data frame with integrated subtype and clinical data.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>score.fl</code></td>
<td>
<p>Data frame with scores from subtype predictions.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>mdns.fl</code></td>
<td>
<p>Data frame with median values for each gene in the ER-balanced set.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>SBS.colr</code></td>
<td>
<p>Colors associated with each subtype from the prediction results.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>outList</code></td>
<td>
<p>Detailed results from subtype prediction functions.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>PC1cutoff</code></td>
<td>
<p>Cutoff values for PC1 used in subsetting.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>DF.PC1</code></td>
<td>
<p>Data frame of initial PCA results merged with clinical data.</p>
</td>
</tr>
</table>
<h3>See Also</h3>

<p><code>prcomp</code>, <code>merge</code>, <code>set.seed</code>
</p>


<h3>Examples</h3>

<pre><code class="language-R">
  data_path &lt;- system.file("extdata", "Sample_IHC_PAM_Mat.Rdat", package = "PCAPAM50")
  load(data_path) # Loads Test.ihc and Test.matrix


  # Prepare the data
  Test.ihc$ER_status &lt;- rep("NA", length(Test.ihc$PatientID))
  Test.ihc$ER_status[grep("^L",Test.ihc$IHC)] = "pos"
  Test.ihc$ER_status[-grep("^L",Test.ihc$IHC)] = "neg"
  Test.ihc &lt;- Test.ihc[order(Test.ihc$ER_status, decreasing = TRUE),]
  Test.matrix &lt;- Test.matrix[, Test.ihc$PatientID]


  df.cln &lt;- data.frame(PatientID = Test.ihc$PatientID, IHC = Test.ihc$IHC, stringsAsFactors = FALSE)


  

  # Call the function
  result &lt;- makeCalls.PC1ihc(df.cln=df.cln, seed = 118, mat = Test.matrix, inputDir=NULL)

</code></pre>


</div>