<div class="container">

<table style="width: 100%;"><tr>
<td>find_peaks</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>Find peaks in a spectrum</h2>

<h3>Description</h3>

<p>This function finds all peaks (local maxima) in a spectrum, using a user
provided size threshold relative to the tallest peak (global maximum) bellow
which found peaks are ignoredâ€”i.e., not included in the returned value. This
is a wrapper built on top of function <code>peaks()</code> from package 'splus2R'.
</p>


<h3>Usage</h3>

<pre><code class="language-R">find_peaks(x, ignore_threshold = 0, span = 3, strict = TRUE, na.rm = FALSE)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>x</code></td>
<td>
<p>numeric vector</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>ignore_threshold</code></td>
<td>
<p>numeric Value between 0.0 and 1.0 indicating the
relative size compared to tallest peak threshold below which peaks will be
ignored. Negative values set a threshold so that the tallest peaks are
ignored, instead of the shortest.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>span</code></td>
<td>
<p>integer A peak is defined as an element in a sequence which is
greater than all other elements within a window of width <code>span</code>
centered at that element. Use <code>NULL</code> for the global peak.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>strict</code></td>
<td>
<p>logical If <code>TRUE</code>, an element must be strictly greater
than all other values in its window to be considered a peak.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>na.rm</code></td>
<td>
<p>logical indicating whether <code>NA</code> values should be stripped
before searching for peaks.</p>
</td>
</tr>
</table>
<h3>Value</h3>

<p>A logical vector of the same length as <code>x</code>. Values that are
<code>TRUE</code> correspond to local peaks in the data.
</p>


<h3>Note</h3>

<p>This function is a wrapper built on function
<code>peaks</code> from <span class="pkg">splus2R</span> and handles non-finite
(including <code>NA</code>) values differently than <code>splus2R::peaks</code>,
instead of giving an error they are replaced with the smallest finite value
in <code>x</code>.
</p>


<h3>See Also</h3>

<p><code>peaks</code>
</p>
<p>Other peaks and valleys functions: 
<code>find_spikes()</code>,
<code>get_peaks()</code>,
<code>peaks()</code>,
<code>replace_bad_pixs()</code>,
<code>spikes()</code>,
<code>valleys()</code>,
<code>wls_at_target()</code>
</p>


<h3>Examples</h3>

<pre><code class="language-R">with(sun.data, w.length[find_peaks(s.e.irrad)])

</code></pre>


</div>