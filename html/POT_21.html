<div class="container">

<table style="width: 100%;"><tr>
<td>Fit the GP Distribution</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>Fitting a GPD to Peaks Over a Threshold</h2>

<h3>Description</h3>

<p>Maximum (Penalized) Likelihood, Unbiased Probability
Weighted Moments,Biased Probability Weighted Moments, Moments,
Pickands', Minimum Density Power Divergence, Medians, Likelihood
Moment and Maximum Goodness-of-Fit Estimators to fit Peaks Over a
Threshold to a GP distribution.</p>


<h3>Usage</h3>

<pre><code class="language-R">fitgpd(data, threshold, est = "mle", ...)</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>data</code></td>
<td>
<p>A numeric vector.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>threshold</code></td>
<td>
<p>A numeric value giving the threshold for the
GPD. The <code>'mle'</code> estimator allows varying threshold; so that threshold
could be for this case a numeric vector. Be careful, varying
thresholds are used cyclically if length doesn't match with
<code>data</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>est</code></td>
<td>
<p>A string giving the names of the estimator. It can be
<code>'mle'</code> (the default), <code>'mple'</code>, <code>'moments'</code>, <code>'pwmu'</code>,
<code>'pwmb'</code>, <code>'mdpd'</code>, <code>'med'</code>, <code>'pickands'</code>,
<code>'lme'</code> and <code>'mgf'</code> for the maximum likelihood, maximum
penalized likelihood, moments, unbiased
probability weighted moments, biased probability weigthed moments,
minimum density power divergence, medians, Pickands', likelihood
moment and maximum goodness-of-fit estimators respectively.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>...</code></td>
<td>
<p>Other optional arguments to be passed to the
<code>optim</code> function, allow hand fixed parameters (only
for the <code>mle</code>, <code>mple</code> and <code>mgf</code> estimators) or passed
several options to specific estimators - see the Note section.</p>
</td>
</tr>
</table>
<h3>Value</h3>

<p>This function returns an object of class <code>"uvpot"</code> with components:
</p>
<table>
<tr style="vertical-align: top;">
<td><code>fitted.values</code></td>
<td>
<p>A vector containing the estimated parameters.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>std.err</code></td>
<td>
<p>A vector containing the standard errors.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>fixed</code></td>
<td>
<p>A vector containing the parameters of the model that
have been held fixed.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>param</code></td>
<td>
<p>A vector containing all parameters (optimized and fixed).</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>deviance</code></td>
<td>
<p>The deviance at the maximum likelihood estimates.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>corr</code></td>
<td>
<p>The correlation matrix.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>convergence, counts, message</code></td>
<td>
<p>Components taken from the
list returned by <code>optim</code> - for the <code>mle</code> method.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>threshold</code></td>
<td>
<p>The threshold passed to argument <code>threshold</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>nat, pat</code></td>
<td>
<p>The number and proportion of exceedances.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>data</code></td>
<td>
<p>The data passed to the argument <code>data</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>exceed</code></td>
<td>
<p>The exceedances, or the maxima of the clusters of
exceedances.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>scale</code></td>
<td>
<p>The scale parameter for the fitted generalized Pareto
distribution.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>std.err.type</code></td>
<td>
<p>The standard error type - for <code>'mle'</code>
only. That is <code>Observed</code> or <code>Expected</code> Information matrix
of Fisher.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>var.thresh</code></td>
<td>
<p>Logical. Specify if the threshold is a varying one -
<code>'mle'</code> only. For other methods, threshold is always constant
i.e. <code>var.thresh = FALSE</code>.</p>
</td>
</tr>
</table>
<h3>Note</h3>

<p>The Maximum Likelihood estimator is obtained through a slightly
modified version of Alec Stephenson's <code>fpot.norm</code> function in the
<code>evd</code> package.
</p>
<p>For the <code>'mple'</code> estimator, the likelihood function is penalized
using the following function :
</p>
<p style="text-align: center;"><code class="reqn">P(\xi) = \left\{
    \begin{array}{ll}
    1, &amp; \xi \leq 0\\
    \exp\left[-\lambda \left(\frac{1}{1-\xi} - 1\right)^\alpha \right], &amp;
    0 &lt; \xi &lt;1\\
    0, &amp; \xi \geq 1
    \end{array}
  \right.</code>
</p>

<p>where <code class="reqn">\alpha</code> and <code class="reqn">\lambda</code> are the penalizing
constants. Coles and Dixon (1999) suggest the use of
<code class="reqn">\alpha=\lambda=1</code>.
</p>
<p>The <code>'lme'</code> estimator has a special parameter <code>'r'</code>. Zhang
(2007) shows that a value of -0.5 should be accurate in most of the
cases. However, other values such as <code>r &lt; 0.5</code> can be
explored. In particular, if <code>r</code> is approximatively equal to the
opposite of the true shape parameter value, then the <code>lme</code>
estimate is equivalent to the <code>mle</code> estimate.
</p>
<p>The <code>'pwmb'</code> estimator has special parameters <code>'a'</code> and
<code>'b'</code>. These parameters are called the "plotting-position"
values. Hosking and Wallis (1987) recommend the use of <code>a = 0.35</code>
and <code>b = 0</code> (the default). However, different values can be
tested.
</p>
<p>For the <code>'pwmu'</code> and <code>'pwmb'</code> approaches, one can pass the
option <code>'hybrid = TRUE'</code> to use hybrid estimators as proposed by
Dupuis and Tsao (1998). Hybrid estimators avoid to have no feasible
points.
</p>
<p>The <code>mdpd</code> estimator has a special parameter <code>'a'</code>. This is
a parameter of the "density power divergence". Juarez and Schucany
(2004) recommend the use of <code>a = 0.1</code>, but any value of
<code>a</code> such as <code>a &gt; 0</code> can be used (small values are recommend
yet).
</p>
<p>The <code>med</code> estimator admits two extra arguments <code>tol</code> and
<code>maxit</code> to control the "stopping-rule" of the optimization
process.
</p>
<p>The <code>mgf</code> approach uses goodness-of-fit statistics to estimate
the GPD parameters. There are currently 8 different statitics: the
Kolmogorov-Smirnov <code>"KS"</code>, Cramer von Mises <code>"CM"</code>, Anderson
Darling <code>"AD"</code>, right tail Anderson Darling <code>"ADR"</code>, left
tail Anderson Darling <code>"ADL"</code>, right tail Anderson Darling
(second degree) <code>"AD2R"</code>, left tail Anderson Darling (second
degree) <code>"AD2L"</code> and the Anderson Darling (second degree)
<code>"AD2"</code> statistics.
</p>


<h3>Author(s)</h3>

<p>Mathieu Ribatet</p>


<h3>References</h3>

<p>Coles, S. (2001) <em>An Introduction to Statistical
Modelling of Extreme Values</em>. Springer Series in Statistics. London.
</p>
<p>Coles, S. and Dixon, M. (1999) Likelihood-Based Inference for Extreme
Value Models. Extremes <b>2</b>(1):5–23.
</p>
<p>Dupuis, D. and Tsao (1998) M. A hybrid estimator for generalized
Pareto and extreme-value distributions. Communications in
Statistics-Theory and Methods <b>27</b>:925–941.
</p>
<p>Hosking, J. and Wallis, J. (1987) Parameters and Quantile Estimation
for the Generalized Pareto Distribution. Technometrics
<b>29</b>:339–349.
</p>
<p>Juarez, S. and Schucany, W. (2004) Robust and Efficient Estimation for
the Generalized Pareto Distribution. Extremes <b>7</b>:237–251.
</p>
<p>Luceno, A. (2006) Fitting the generalized Pareto distribution to data
using maximum goodness-of-fit estimators. Computational Statistics and
Data Analysis <b>51</b>:904–917.
</p>
<p>Peng, L. and Welsh, A. (2001) Robust Estimation of the Generalized
Pareto Distribution. Extremes <b>4</b>:53–65.
</p>
<p>Embrechts, P and Kluppelberg, C. and Mikosch, T (1997) <em>Modelling
Extremal Events for Insurance and Finance.</em> Springers.
</p>
<p>Pickands, J. (1975) Statistical Inference Using Extreme Order
Statistics. Annals of Statistics. <b>3</b>:119–131.
</p>
<p>Zhang, J. (2007) Likelihood Moment Estimation for the Generalized
Pareto Distribution. Australian and New Zealand Journal of
Statistics. <b>49</b>(1):69–77.
</p>


<h3>See Also</h3>

<p>The following usual generic functions are available 
<code>print</code>, 
<code>plot</code>, 
<code>confint</code> and
<code>anova</code>
as well as new generic functions 
<code>retlev</code>, 
<code>qq</code>, 
<code>pp</code>, 
<code>dens</code> and
<code>convassess</code>.
</p>


<h3>Examples</h3>

<pre><code class="language-R">x &lt;- rgpd(200, 1, 2, 0.25)
mle &lt;- fitgpd(x, 1, "mle")$param
pwmu &lt;- fitgpd(x, 1, "pwmu")$param
pwmb &lt;- fitgpd(x, 1, "pwmb")$param
pickands &lt;- fitgpd(x, 1, "pickands")$param    ##Check if Pickands estimates
                                              ##are valid or not !!!
med &lt;- fitgpd(x, 1, "med",                    ##Sometimes the fitting algo is not
start = list(scale = 2, shape = 0.25))$param  ##accurate. So specify
                                              ##good starting values is
                                              ##a good idea.  
mdpd &lt;- fitgpd(x, 1, "mdpd")$param
lme &lt;- fitgpd(x, 1, "lme")$param
mple &lt;- fitgpd(x, 1, "mple")$param
ad2r &lt;- fitgpd(x, 1, "mgf", stat = "AD2R")$param

print(rbind(mle, pwmu, pwmb, pickands, med, mdpd, lme,
 mple, ad2r))

##Use PWM hybrid estimators
fitgpd(x, 1, "pwmu", hybrid = FALSE)

##Now fix one of the GPD parameters
##Only the MLE, MPLE and MGF estimators are allowed !
fitgpd(x, 1, "mle", scale = 2)
fitgpd(x, 1, "mple", shape = 0.25) 
</code></pre>


</div>