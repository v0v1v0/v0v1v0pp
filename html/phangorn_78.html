<div class="container">

<table style="width: 100%;"><tr>
<td>codonTest</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>codonTest</h2>

<h3>Description</h3>

<p>Models for detecting positive selection
</p>


<h3>Usage</h3>

<pre><code class="language-R">codonTest(tree, object, model = c("M0", "M1a", "M2a"),
  frequencies = "F3x4", opt_freq = FALSE, codonstart = 1,
  control = pml.control(maxit = 20), ...)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>tree</code></td>
<td>
<p>a phylogenetic tree.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>object</code></td>
<td>
<p>an object of class phyDat.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>model</code></td>
<td>
<p>a vector containing the substitution models to compare with
each other or "all" to test all available models.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>frequencies</code></td>
<td>
<p>a character string or vector defining how to compute
the codon frequencies</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>opt_freq</code></td>
<td>
<p>optimize frequencies (so far ignored)</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>codonstart</code></td>
<td>
<p>an integer giving where to start the translation. This
should be 1, 2, or 3, but larger values are accepted and have for effect to
start the translation further within the sequence.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>control</code></td>
<td>
<p>a list of parameters for controlling the fitting process.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>...</code></td>
<td>
<p>further arguments passed to or from other methods.</p>
</td>
</tr>
</table>
<h3>Details</h3>

<p><code>codonTest</code> allows to test for positive selection similar to programs
like PAML (Yang ) or HyPhy (Kosakovsky Pond et al. 2005).
</p>
<p>There are several options for deriving the codon frequencies.
Frequencies can be "equal" (1/61), derived from nucleotide frequencies "F1x4"
and "F3x4" or "empirical" codon frequencies. The frequencies taken using
the empirical frequencies or estimated via maximum likelihood.
</p>
<p>So far the M0 model (Goldman and Yang 2002), M1a and M2a are
implemented. The M0 model is always computed the other are optional.
The convergence may be very slow and sometimes fails.
</p>


<h3>Value</h3>

<p>A list with an element called summary containing a data.frame with
the log-likelihood, number of estimated parameters, etc. of all tested
models. An object called posterior which contains the posterior probability
for the rate class for each sites and the estimates of the defined models.
</p>


<h3>Author(s)</h3>

<p>Klaus Schliep <a href="mailto:klaus.schliep@gmail.com">klaus.schliep@gmail.com</a>
</p>


<h3>References</h3>

<p>Ziheng Yang (2014). <em>Molecular Evolution: A Statistical
Approach</em>. Oxford University Press, Oxford
</p>
<p>Sergei L. Kosakovsky Pond, Simon D. W. Frost, Spencer V. Muse (2005) HyPhy:
hypothesis testing using phylogenies, <em>Bioinformatics</em>, <b>21(5)</b>:
676–679, doi:10.1093/bioinformatics/bti079
</p>
<p>Nielsen, R., and Z. Yang. (1998) Likelihood models for detecting positively
selected amino acid sites and applications to the HIV-1 envelope gene.
<em>Genetics</em>, <b>148</b>: 929–936
</p>


<h3>See Also</h3>

<p><code>pml</code>, <code>pmlMix</code>, <code>modelTest</code>,
<code>AIC</code>
</p>


<h3>Examples</h3>

<pre><code class="language-R">
## Not run: 
# load woodmouse data from ape
data(woodmouse)
dat_codon &lt;- dna2codon(as.phyDat(woodmouse))
tree &lt;- NJ(dist.ml(dat_codon))
# optimize the model the old way
fit &lt;- pml(tree, dat_codon, bf="F3x4")
M0 &lt;- optim.pml(fit, model="codon1")
# Now using the codonTest function
fit_codon &lt;- codonTest(tree, dat_codon)
fit_codon
plot(fit_codon, "M1a")

## End(Not run)

</code></pre>


</div>