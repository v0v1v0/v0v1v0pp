<div class="container">

<table style="width: 100%;"><tr>
<td>exhaustionFunctions</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>Analyses of the exhaustion of Character States Over Evolutionary History</h2>

<h3>Description</h3>

<p>The following functions are for measuring and fitting various
distributions to the gradual exhaustion of unexpressed
character states, as originally described by Wagner (2000,
Evolution).
</p>


<h3>Usage</h3>

<pre><code class="language-R">accioExhaustionCurve(
  phyloTree,
  charData,
  charTypes = "unordered",
  outgroup = NULL,
  firstAppearances = NULL,
  missingCharValue = "?",
  inapplicableValue = "-"
)

accioBestAcquisitionModel(
  exhaustion_info,
  changesType,
  models = c("exponential", "gamma", "lognormal", "zipf")
)

charExhaustPlot(
  exhaustion_info,
  changesType,
  xlab = "Total Characters",
  ylab = NULL,
  main = NULL,
  xsize = 3
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>phyloTree</code></td>
<td>
<p>A phylogenetic tree of class <code>phylo</code>
as used by package <code>ape</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>charData</code></td>
<td>
<p>A <code>data.frame</code> of morphological character
codings (a morphological 'matrix'), with taxon units
as rows and characters as columns.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>charTypes</code></td>
<td>
<p>A vector of length equal to
the number of characters in <code>charData</code>, with elements indicating
whether the corresponding character in <code>charData</code>
is <code>"unordered"</code> or <code>"ordered"</code>. However,
if <code>length(charTypes) = 1</code>, then it is repeated for all taxa.
The default value for this argument is <code>"unordered"</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>outgroup</code></td>
<td>
<p>A string matching to one
of the tip labels as given by <code>tip.label</code>,</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>firstAppearances</code></td>
<td>
<p>A vector, with length equal to the
same number of taxa (rows) as in
<code>charData</code>, in the same corresponding order.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>missingCharValue</code></td>
<td>
<p>The string value indicating a missing
character coding value, by default <code>"?"</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>inapplicableValue</code></td>
<td>
<p>The string value indicating an
inapplicable character coding value, by default <code>"-"</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>exhaustion_info</code></td>
<td>
<p>The list of results output
from function <code>accioExhaustionCurve</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>changesType</code></td>
<td>
<p>A single character value,
indicating the character change data
to be assessed from the result of the character
exhaustion analysis, must be one of either
<code>'totalAcc'</code> (to the total number of
accumulated character changes, ideal for
modeling the size and distribution of
<em>state</em> space) or <code>'charAlt'</code>
(to plot the total number of character alterations,
ideal for modeling the size and
distribution of <em>character</em> space).</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>models</code></td>
<td>
<p>A vector of type <code>character</code>
naming various models to be fit.
The default fits the models <code>"exponential"</code>, <code>"gamma"</code>,
<code>"lognormal"</code>, and  <code>"zipf"</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>xlab</code></td>
<td>
<p>Label for the X axis;
<code>"Total Characters"</code> by default.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>ylab</code></td>
<td>
<p>Label for the Y axis. If not provided by the user,
a label based on the <code>changesType</code> argument will be used.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>main</code></td>
<td>
<p>Main title label for the plot. If not provided by
the user, a label based on the <code>changesType</code> argument will be used.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>xsize</code></td>
<td>
<p>Parameter controlling size of the axes,
which are forced to be symmetric.</p>
</td>
</tr>
</table>
<h3>Details</h3>

<p><code>accioExhaustionCurve</code> uses a Sankoff parsimony ancestral-reconstruction
algorithm (written by P.J. Wagner, <em>not</em> the one from <code>phangorn</code> used
elsewhere in <code>paleotree</code>) to calculate character changes across each branch
(internode edge) of a tree, and then reports the counts of character state
</p>
<p><code>accioBestAcquisitionModel</code> takes output from <code>accioExhaustionCurve</code>,
calculates one of two character change indices, and then fits a series of user-selected
models to the dataset, returning details pertaining to the best-fit model.
</p>
<p><code>charExhaustPlot</code> is a wrapper for <code>accioBestAcquisitionModel</code> that
produces a plot of the observed character change data against the
expectation under the best-fit model.
</p>
<p>The functions <code>accioBestAcquisitionModel</code> 
and <code>charExhaustPlot</code> offer
users two different options for examining character change: <code>totalAcc</code>
fits models to the total accumulated number of state changes over the phylogeny,
thus using exhaustion to explore the size and distribution of character space. The
other option <code>charAlt</code> fits models to the number of character that alter from
primitive to derived over phylogeny, thus reflecting the size and distribution of state space.
</p>
<p><code>accioExhaustionCurve</code> can order its reconstruction
of change by stratigraphic order of first appearances. It is unclear what this means.
</p>


<h3>Value</h3>

<p><code>accioExhaustionCurve</code> outputs a list containing two objects: first,
a matrix named <code>exhaustion</code> consisting of three columns: <code>"Steps"</code>,
<code>"Novel_States"</code>, and <code>"Novel_Characters"</code>, respectively giving
the counts of these respective values for each branch (internode edge).
The second element of this list is named <code>State_Derivations</code> and is
a count of how often each state, across all characters, was derived relative
to the primitive position along each internode edge.
</p>
<p>The output of <code>accioBestAcquisitionModel</code>
is a list object containing
information on the best-fit model, the
parameters of that model, and the calculated
probability distribution function for that model
at the same intervals (for use in quantile plots).	
</p>
<p><code>charExhaustPlot</code> produces a plot, and outputs no data.
</p>


<h3>Note</h3>

<p>This family of functions presented here were originally written 
by Peter J. Wagner, and then modified and adapted by David W.
Bapst for wider release  in a CRAN-distributed
package: <code>paleotree</code>. This makes the code presented here
a very different beast than typical <code>paleotree</code> code, for
example, there are fewer tests of correct input type, length, etc.
</p>


<h3>Author(s)</h3>

<p>Initially written by Peter J. Wagner, with modification
and documentation by David W. Bapst.
</p>


<h3>References</h3>

<p>Wagner, P. J. 2000. Exhaustion of morphologic character
states among fossil taxa. <em>Evolution</em> 54(2):365-386.
</p>


<h3>See Also</h3>

<p>Also see <code>paleotree</code> functions <code>minCharChange</code> and
<code>ancPropStateMat</code>, the latter of which is a wrapper
for <code>phangorn</code>'s function
<code>ancestral.pars</code>.
</p>


<h3>Examples</h3>

<pre><code class="language-R">

# get data
data(SongZhangDicrano)

dicranoTree &lt;- cladogramDicranoX13

# modify char data
charMat &lt;- data.matrix(charMatDicrano)
charMat[is.na(charMatDicrano)] &lt;- 0
charMat &lt;- (charMat-1)
colnames(charMat) &lt;- NULL
# replace missing values
charMat[is.na(charMatDicrano)] &lt;- "?"

# the 'outgroup' is Exigraptus
   # also the first taxon listed in the matrix
exhaustionResults &lt;- accioExhaustionCurve(
   phyloTree = dicranoTree,
   charData = charMat, charTypes = "unordered",
   outgroup = "Exigraptus_uniformis")

# fits models to exhaustion for total accumulation
accioBestAcquisitionModel(
   exhaustion_info = exhaustionResults,
   changesType = "totalAcc", 	
   models = c("exponential","gamma","lognormal","zipf")) 

# plot of exhaustion of total accumulation of character states
charExhaustPlot(exhaustion_info = exhaustionResults,
	   changesType = "totalAcc")

# plot of exhaustion of character alterations
charExhaustPlot(exhaustion_info = exhaustionResults,
	   changesType = "charAlt")

	
</code></pre>


</div>