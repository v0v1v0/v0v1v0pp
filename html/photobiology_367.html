<div class="container">

<table style="width: 100%;"><tr>
<td>fit_peaks</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>Refine position and value of extremes by fitting</h2>

<h3>Description</h3>

<p>Functions implementing fitting of peaks in a class-agnostic way. The fitting
refines the location of peaks and value of peaks based on the location of
maxima and minima supplied. This function is to be used together with
<code>find_peaks()</code> or <code>find_valleys()</code>.
</p>


<h3>Usage</h3>

<pre><code class="language-R">fit_peaks(
  x,
  peaks.idx,
  span,
  x.col.name = NULL,
  y.col.name,
  method,
  max.span = 5L,
  maximum = TRUE,
  keep.cols = NULL
)

fit_valleys(
  x,
  valleys.idx,
  span,
  x.col.name = NULL,
  y.col.name,
  method,
  max.span = 5L,
  maximum = FALSE,
  keep.cols = NULL
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>x</code></td>
<td>
<p>generic_spct or data.frame object.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>peaks.idx, valleys.idx</code></td>
<td>
<p>logical or integer Indexes into <code>x</code>
selecting global or local extremes.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>span</code></td>
<td>
<p>odd integer The span used when refining the location of maxima or
minima of <code>x</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>x.col.name, y.col.name</code></td>
<td>
<p>character Name of the column of <code>x</code> on
which to operate.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>method</code></td>
<td>
<p>character The method to use for the fit.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>max.span</code></td>
<td>
<p>odd integer The maximum number of data points used when
when refining the location of maxima and minima.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>maximum</code></td>
<td>
<p>logical A flag indicating whether to search for maxima or
minima.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>keep.cols</code></td>
<td>
<p>logical Keep unrecognized columns in data frames</p>
</td>
</tr>
</table>
<h3>Value</h3>

<p>An R object of the same class as <code>x</code> containing the fitted
values for the peaks, and optionally the values for at <code>peaks.idx</code> or
<code>valleys.idx</code> for other retained columns.
</p>


<h3>Note</h3>

<p>These functions are not meant for everyday use. Use option
<code>refine.wl = TRUE</code> of methods <code>peaks()</code> and <code>valleys()</code> instead.
</p>


<h3>Examples</h3>

<pre><code class="language-R">
peaks &lt;- find_peaks(sun.spct[["s.e.irrad"]], span = 31)
fit_peaks(sun.spct, peaks, span = 31,
          y.col.name = "s.e.irrad", method = "spline")

</code></pre>


</div>