<div class="container">

<table style="width: 100%;"><tr>
<td>binSum</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>binSum</h2>

<h3>Description</h3>

<p>Compute sum of <code>compressed</code> coverage profile in bins, using fast C
code.</p>


<h3>Usage</h3>

<pre><code class="language-R">binSum(compressed, bin.chromStart = 0L, 
    bin.size = 1L, n.bins = 2000L, 
    empty.as.zero = FALSE)</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>compressed</code></td>
<td>
<p>data.frame with integer columns chromStart, chromEnd, count.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>bin.chromStart</code></td>
<td>
<p>Base before first bin.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>bin.size</code></td>
<td>
<p>Bin size.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>n.bins</code></td>
<td>
<p>Number of bins.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>empty.as.zero</code></td>
<td>
<p>Sometimes the last few bins do not have any overlapping data in
<code>compressed</code>. If TRUE, set these counts to 0. If FALSE, ignore these
bins (returning a data.frame with fewer than <code>n.bins</code> rows).</p>
</td>
</tr>
</table>
<h3>Value</h3>

<p>data.frame with <code>n.bins</code> rows and columns chromStart, chromEnd,
count, mean.</p>


<h3>Author(s)</h3>

<p>Toby Dylan Hocking &lt;toby.hocking@r-project.org&gt; [aut, cre]</p>


<h3>Examples</h3>

<pre><code class="language-R">## bins of size 3bp.
## -1-   -3-   -5-
##    -2-   -4-
## 123456789012345 base index.
## --2---
##       --1-
##           --0-------
## Coverage profile.
profile &lt;- data.frame(chromStart=as.integer(c(0, 6, 10)),
                      chromEnd=as.integer(c(6, 10, 10000)),
                      count=as.integer(c(2, 1, 0)))
library(PeakSegJoint)
bins &lt;- binSum(profile,
               bin.chromStart=0L,
               bin.size=3L,
               n.bins=2000L)
library(ggplot2)
bases &lt;- data.frame(position=1:15, base="N")
ggplot()+
  ylab("")+
  geom_text(aes(position, 0, label=base),
            data=bases)+
  geom_step(aes(chromStart+0.5, count, color=what),
            data=data.frame(profile, what="profile"),
            size=2)+
  geom_step(aes(chromStart+0.5, count, color=what),
            data=data.frame(bins, what="bin total"))+
  geom_step(aes(chromStart+0.5, mean, color=what),
            data=data.frame(bins, what="bin mean"))+
  coord_cartesian(xlim=c(0, max(bases$position)))
</code></pre>


</div>