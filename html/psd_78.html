<div class="container">

<table style="width: 100%;"><tr>
<td>psdcore</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>Multitaper power spectral density estimates of a series</h2>

<h3>Description</h3>

<p>Compute power spectral density (PSD) estimates
for the input series using sine multitapers.
This is used by <code>pspectrum</code> for the adaptive
estimation procedure.
</p>


<h3>Usage</h3>

<pre><code class="language-R">psdcore(X.d, ...)

## S3 method for class 'ts'
psdcore(X.d, ...)

## S3 method for class 'matrix'
psdcore(X.d, X.frq, ...)

## Default S3 method:
psdcore(
  X.d,
  X.frq = NULL,
  ntaper = as.tapers(5),
  preproc = TRUE,
  na.action = stats::na.fail,
  plot = FALSE,
  refresh = FALSE,
  verbose = FALSE,
  fast = FALSE,
  ndecimate,
  ...
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>X.d</code></td>
<td>
<p>the series to estimate a spectrum for</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>...</code></td>
<td>
<p>additional parameters</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>X.frq</code></td>
<td>
<p>scalar; the sampling information (see section Sampling)</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>ntaper</code></td>
<td>
<p>scalar, vector, or <code>tapers</code>; the number of sine tapers to apply at each frequency</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>preproc</code></td>
<td>
<p>logical; should <code>X.d</code> have a linear trend removed?</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>na.action</code></td>
<td>
<p>function to deal with <code>NA</code> values</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>plot</code></td>
<td>
<p>logical; should the estimates be shown compared to the <code>spectrum</code>-based estimates?
Note that this will add some computation time, since the cosine-tapered periodogram is calculated inside
<code>pgram_compare</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>refresh</code></td>
<td>
<p>logical; ensure a free environment prior to execution</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>verbose</code></td>
<td>
<p>logical; should warnings and messages be given?</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>fast</code></td>
<td>
<p>logical; use the faster method?</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>ndecimate</code></td>
<td>
<p>now ignored</p>
</td>
</tr>
</table>
<h3>Details</h3>



<h4>Tapering</h4>

<p>The parameter <code>ntaper</code> specifies the number of sine tapers to be used 
at each frequency: equal tapers at each frequency for a scalar; 
otherwise, use <code>ntaper[j]</code> sine tapers at <code>frequency[j]</code>.
</p>



<h4>Truncation</h4>

<p>The series, with length <code class="reqn">N</code>, is necessarily truncated so that <code class="reqn">1+N/2</code> evenly 
spaced frequencies are returned. This truncation makes the series length â€œhighly composite",
which the discrete Fourier transform (DFT) is most efficient.
The "fftw" vignette (accessed with <code>vignette("fftw",package="psd")</code>) shows
how the performance of a DFT can be affected by series length.
</p>



<h4>Decimation</h4>

<p>No longer supported. Setting <code>ndecimate</code> will not affect the results
</p>



<h4>Sampling</h4>

<p>If <code>X.frq</code> is NULL, the value is assumed to be 1, unless <code>X.d</code> is a  <code>'ts'</code> object.
If <code>X.frq &gt; 0</code> it's assumed the value represents <em>frequency</em> (e.g. Hz).
If <code>X.frq &lt; 0</code> it's assumed the value represents <em>interval</em> (e.g. seconds).
</p>



<h3>Value</h3>

<p>An on object of class <code>'amt','spec'</code>, which has a structure similar to a regular <code>'spec'</code> object, 
but with a few additional fields, invisibly.
</p>


<h3>Author(s)</h3>

<p>A.J. Barbour; original algorithm by R.L. Parker.
</p>


<h3>See Also</h3>

<p><code>pspectrum</code>, <code>riedsid</code>, <code>parabolic_weights</code>, <code>pgram_compare</code>
</p>


<h3>Examples</h3>

<pre><code class="language-R">## Not run: #REX
library(psd)

##
## Multitaper PSD estimation
##

set.seed(1234)
X &lt;- rnorm(1e3)

# use the defaults, and appeal to plot.spec
# sampling assumed to be 1
plot(psdcore(X))

# use more tapers, compare to stats::spectrum, and clear 
# env data from the previous calculation
psdcore(X, ntaper=10, plot=TRUE, refresh=TRUE)

# change the sampling frequency to 20
psdcore(X, X.frq=20, ntaper=10, plot=TRUE, refresh=TRUE)


## End(Not run)#REX
</code></pre>


</div>