<div class="container">

<table style="width: 100%;"><tr>
<td>permu.test</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>Permutation tests for time series data, based on classic linear regression or ANOVA
This is a legacy function that is primarily provided for backward compatibility. You should probably use <code>perm.lm</code> or <code>perm.lmer</code> instead.
<code>permu.test</code> is the only function to support multivariate responses, although multivariate data can trivially be recoded into a univariate model.
<code>permu.test</code> does not support random effects or corrected p-values (e.g. the cluster mass test), which are supported by <code>permutelm</code>.</h2>

<h3>Description</h3>

<p>Permutation tests for time series data, based on classic linear regression or ANOVA
This is a legacy function that is primarily provided for backward compatibility. You should probably use <code>perm.lm</code> or <code>perm.lmer</code> instead.
<code>permu.test</code> is the only function to support multivariate responses, although multivariate data can trivially be recoded into a univariate model.
<code>permu.test</code> does not support random effects or corrected p-values (e.g. the cluster mass test), which are supported by <code>permutelm</code>.
</p>


<h3>Usage</h3>

<pre><code class="language-R">permu.test(
  formula,
  data,
  subset = NULL,
  type = "anova",
  parallel = FALSE,
  progress = "text",
  ...
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>formula</code></td>
<td>
<p>A formula of the following form: <code>outcome ~ predictors | series variable</code>. Multivariate outcomes (e.g. 32 EEG electrodes) are supported; use <code>cbind(Fp1,Fp2,etc) ~ predictors | series</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>data</code></td>
<td>
<p>The dataset referencing these predictors.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>subset</code></td>
<td>
<p>If specified, will only analyze the specified subset of the data.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>type</code></td>
<td>
<p>A character string of either <code>'anova'</code> or <code>'regression'</code>. The former runs an analysis of variance and returns F-values and p-values based on the explained variance of each factor in the design. The latter runs a linear-regression analysis and returns t-values and p-values based on individual effects. When running ANOVA, it is advised to use orthogonal predictors, as type III sums of squares are used.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>parallel</code></td>
<td>
<p>Whether to parallelize the permutation testing using plyr's <code>parallel</code> option. Needs some additional set-up; see the plyr documentation.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>progress</code></td>
<td>
<p>A plyr <code>.progress</code> bar name, see the plyr documentation. Ignored if parallel=TRUE.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>...</code></td>
<td>
<p>Other arguments to be passed to <code>lmp</code>/<code>aovp</code></p>
</td>
</tr>
</table>
<h3>Value</h3>

<p>A data frame.
</p>


<h3>See Also</h3>

<p><code>clusterperm.lm</code>, <code>clusterperm.lmer</code>
</p>


<h3>Examples</h3>

<pre><code class="language-R">
# EEG data example using the MMN dataset

# Run permutation tests on all electrodes and timepoints, reporting p-values for the three
# manipulated factors
perms &lt;- permu.test(cbind(Fp1,AF3,F7,F3,FC1,FC5,C3,CP1,CP5,P7,P3,Pz,PO3,O1,Oz,O2,PO4,P4,
	P8,CP6,CP2,C4,FC6,FC2,F4,F8,AF4,Fp2,Fz,Cz) ~ Deviant * Session | Time,data=MMN)

# Run the tests in parallel on two CPU threads
# first, set up the parallel backend
library(doParallel)
cl &lt;- makeCluster(2)
registerDoParallel(cl)
perms &lt;- permu.test(cbind(Fp1,AF3,F7,F3,FC1,FC5,C3,CP1,CP5,P7,P3,Pz,PO3,O1,Oz,O2,PO4,P4,
	P8,CP6,CP2,C4,FC6,FC2,F4,F8,AF4,Fp2,Fz,Cz) ~ Deviant * Session | Time,data=MMN,
	parallel=TRUE)
stopCluster(cl)

# Plot the results by F-value, removing points that were not significant in the
# permutation tests
plot(perms,sig='p')

# t-values instead of F-values
perms &lt;- permu.test(cbind(Fp1,AF3,F7,F3,FC1,FC5,C3,CP1,CP5,P7,P3,Pz,PO3,O1,Oz,O2,PO4,P4,
	P8,CP6,CP2,C4,FC6,FC2,F4,F8,AF4,Fp2,Fz,Cz) ~ Deviant * Session | Time,data=MMN,
	type='regression')


</code></pre>


</div>