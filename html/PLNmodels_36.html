<div class="container">

<table style="width: 100%;"><tr>
<td>PLNLDA</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>Poisson lognormal model towards Linear Discriminant Analysis</h2>

<h3>Description</h3>

<p>Fit the Poisson lognormal for LDA with a variational algorithm. Use the (g)lm syntax for model specification (covariates, offsets).
</p>


<h3>Usage</h3>

<pre><code class="language-R">PLNLDA(formula, data, subset, weights, grouping, control = PLN_param())
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>formula</code></td>
<td>
<p>an object of class "formula": a symbolic description of the model to be fitted.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>data</code></td>
<td>
<p>an optional data frame, list or environment (or object coercible by as.data.frame to a data frame) containing the variables in the model. If not found in data, the variables are taken from environment(formula), typically the environment from which lm is called.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>subset</code></td>
<td>
<p>an optional vector specifying a subset of observations to be used in the fitting process.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>weights</code></td>
<td>
<p>an optional vector of observation weights to be used in the fitting process.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>grouping</code></td>
<td>
<p>a factor specifying the class of each observation used for discriminant analysis.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>control</code></td>
<td>
<p>a list-like structure for controlling the optimization, with default generated by <code>PLN_param()</code>.  See the associated documentation</p>
</td>
</tr>
</table>
<h3>Details</h3>

<p>The parameter <code>control</code> is a list controlling the optimization with the following entries:
</p>

<ul>
<li>
<p> "covariance" character setting the model for the covariance matrix. Either "full" or "spherical". Default is "full".
</p>
</li>
<li>
<p> "trace" integer for verbosity.
</p>
</li>
<li>
<p> "inception" Set up the initialization. By default, the model is initialized with a multivariate linear model applied on log-transformed data. However, the user can provide a PLNfit (typically obtained from a previous fit), which often speed up the inference.
</p>
</li>
<li>
<p> "ftol_rel" stop when an optimization step changes the objective function by less than ftol multiplied by the absolute value of the parameter. Default is 1e-8
</p>
</li>
<li>
<p> "ftol_abs" stop when an optimization step changes the objective function by less than ftol multiplied by the absolute value of the parameter. Default is 0
</p>
</li>
<li>
<p> "xtol_rel" stop when an optimization step changes every parameters by less than xtol multiplied by the absolute value of the parameter. Default is 1e-6
</p>
</li>
<li>
<p> "xtol_abs" stop when an optimization step changes every parameters by less than xtol multiplied by the absolute value of the parameter. Default is 0
</p>
</li>
<li>
<p> "maxeval" stop when the number of iteration exceeds maxeval. Default is 10000
</p>
</li>
<li>
<p> "maxtime" stop when the optimization time (in seconds) exceeds maxtime. Default is -1 (no restriction)
</p>
</li>
<li>
<p> "algorithm" the optimization method used by NLOPT among LD type, i.e. "CCSAQ", "MMA", "LBFGS", "VAR1", "VAR2". See NLOPT documentation for further details. Default is "CCSAQ".
</p>
</li>
</ul>
<h3>Value</h3>

<p>an R6 object with class <code>PLNLDAfit()</code>
</p>


<h3>See Also</h3>

<p>The class <code>PLNLDAfit</code>
</p>


<h3>Examples</h3>

<pre><code class="language-R">data(trichoptera)
trichoptera &lt;- prepare_data(trichoptera$Abundance, trichoptera$Covariate)
myPLNLDA &lt;- PLNLDA(Abundance ~ 1, grouping = Group, data = trichoptera)
</code></pre>


</div>