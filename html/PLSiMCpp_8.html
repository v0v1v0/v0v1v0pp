<div class="container">

<table style="width: 100%;"><tr>
<td>plsim.bw</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>select bandwidth</h2>

<h3>Description</h3>

<p>Select bandwidth for methods, including MAVE, Profile Least Squares Estimator and 
Penalized Profile Least Squares Estimator by cross validation or simple validation.
</p>


<h3>Usage</h3>

<pre><code class="language-R">plsim.bw(...)

## S3 method for class 'formula'
plsim.bw(formula, data, ...)

## Default S3 method:
plsim.bw(xdat, zdat, ydat, zeta_i=NULL, bandwidthList=NULL, 
ParmaSelMethod="CrossValidation", K=5, TestRatio=0.1, TargetMethod='plsimest',
lambda=NULL, l1_ratio=NULL, VarSelMethod = "SCAD", MaxStep = 1L, 
verbose=FALSE, seed=0, ...)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>...</code></td>
<td>
<p>additional arguments.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>formula</code></td>
<td>
<p>a symbolic description of the model to be fitted.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>data</code></td>
<td>
<p>an optional data frame, list or environment containing the variables in the model.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>xdat</code></td>
<td>
<p>input matrix (linear covariates). The model reduces to a single index model when <code>x</code> is NULL.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>zdat</code></td>
<td>
<p>input matrix (nonlinear covariates). <code>z</code> should not be NULL.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>ydat</code></td>
<td>
<p>input vector (response variable).</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>bandwidthList</code></td>
<td>
<p>vector, candidate bandwidths.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>TargetMethod</code></td>
<td>
<p>string, optional (default: "plsimest"). 
target method to be selected bandwidth for, which could be "MAVE", "plsimest" and "plsim".</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>ParmaSelMethod</code></td>
<td>
<p>string, optional (default: "CrossValidation"). 
Method to select bandwidth, which could be Cross Validation ("CrossValidation") 
and Simple Validation ("SimpleValidation").</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>K</code></td>
<td>
<p>int, optional (default: 5). The number of folds for Cross Validation.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>TestRatio</code></td>
<td>
<p>double, optional (default: 0.1). The ratio of test data for Simple Validation.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>zeta_i</code></td>
<td>
<p>initial coefficients. It could be obtained by the function <code>plsim.ini</code>.
<code>zeta_i[1:ncol(z)]</code> is the initial coefficient vector <code class="reqn">\alpha_0</code>, 
and <code>zeta_i[(ncol(z)+1):(ncol(z)+ncol(x))]</code> is the initial coefficient vector <code class="reqn">\beta_0</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>lambda</code></td>
<td>
<p>the parameter for the function plsim.vs.soft, default: NULL.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>l1_ratio</code></td>
<td>
<p>the parameter for the function plsim.vs.soft, default: NULL.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>VarSelMethod</code></td>
<td>
<p>the parameter for the function plsim.vs.soft, default : "SCAD".</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>MaxStep</code></td>
<td>
<p>the parameter for the function plsim.vs.soft, default: 1.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>verbose</code></td>
<td>
<p>the parameter for the function plsim.vs.soft, default: FALSE.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>seed</code></td>
<td>
<p>int, default: 0.</p>
</td>
</tr>
</table>
<h3>Value</h3>

<table>
<tr style="vertical-align: top;">
<td><code>bandwidthBest</code></td>
<td>
<p>selected bandwidth</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>mse</code></td>
<td>
<p>mean square errors corresponding to the <code>bandwidthList</code> </p>
</td>
</tr>
</table>
<h3>Examples</h3>

<pre><code class="language-R">
# EXAMPLE 1 (INTERFACE=FORMULA)
# To select bandwidth by cross validation and simple validation. 

n = 50
sigma = 0.1

alpha = matrix(1,2,1)
alpha = alpha/norm(alpha,"2")

beta = matrix(4,1,1)

x = matrix(1,n,1)
z = matrix(runif(n*2),n,2)
y = 4*((z%*%alpha-1/sqrt(2))^2) + x%*%beta + sigma*matrix(rnorm(n),n,1)

# Select bandwidth for profile least squares estimator by cross validation
res_plsimest_cross = plsim.bw(y~x|z,bandwidthList=c(0.02,0.04,0.06,0.08,0.10))

# Select bandwidth for profile least squares estimator by simple validation
res_plsimest_simple = plsim.bw(y~x|z,bandwidthList=c(0.02,0.04,0.06,0.08,0.10),
                            ParmaSelMethod="SimpleValidation")

# Select bandwidth for penalized profile least squares estimator by simple validation
res_plsim_simple = plsim.bw(y~x|z,bandwidthList=c(0.02,0.04,0.06,0.08,0.10),
                         ParmaSelMethod="SimpleValidation",TargetMethod="plsim",lambda=0.01)


# EXAMPLE 2 (INTERFACE=DATA FRAME)
# To select bandwidth by cross validation and simple validation. 

n = 50
sigma = 0.1

alpha = matrix(1,2,1)
alpha = alpha/norm(alpha,"2")

beta = matrix(4,1,1)

x = rep(1,n)
z1 = runif(n)
z2 = runif(n) 
X = data.frame(x)
Z = data.frame(z1,z2)

x = data.matrix(X)
z = data.matrix(Z)
y = 4*((z%*%alpha-1/sqrt(2))^2) + x%*%beta + sigma*matrix(rnorm(n),n,1)

# Select bandwidth for profile least squares estimator by cross validation
res_plsimest_cross = plsim.bw(xdat=X,zdat=Z,ydat=y,bandwidthList=c(0.02,0.04,0.06,0.08,0.10))

# Select bandwidth for profile least squares estimator by simple validation
res_plsimest_simple = plsim.bw(xdat=X,zdat=Z,ydat=y,bandwidthList=c(0.02,0.04,0.06,0.08,0.10),
                            ParmaSelMethod="SimpleValidation")

# Select bandwidth for penalized profile least squares estimator by simple validation
res_plsim_simple = plsim.bw(xdat=X,zdat=Z,ydat=y,bandwidthList=c(0.02,0.04,0.06,0.08,0.10),
                         ParmaSelMethod="SimpleValidation",TargetMethod="plsim",lambda=0.01)
                                 
</code></pre>


</div>