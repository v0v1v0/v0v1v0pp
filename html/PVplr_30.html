<div class="container">

<table style="width: 100%;"><tr>
<td>plr_seg_extract</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>Segmented linear PLR extraction function</h2>

<h3>Description</h3>

<p>Segmented linear PLR extraction function
</p>


<h3>Usage</h3>

<pre><code class="language-R">plr_seg_extract(
  df,
  per_year,
  psi = NA,
  n_breakpoints,
  power_var,
  time_var,
  return_model = FALSE
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>df</code></td>
<td>
<p>data frame of corrected power measurements, typically the output of a weather correction model</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>per_year</code></td>
<td>
<p>number of data point defining one seasonal year (365 for days, 52 for weeks etc.)</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>psi</code></td>
<td>
<p>vector of 1 or more breakpoint estimates for the model. If not given will evenly space breakpoints across time series</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>n_breakpoints</code></td>
<td>
<p>number of desired breakpoints. Determines number of linear models</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>power_var</code></td>
<td>
<p>character name of the power variable</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>time_var</code></td>
<td>
<p>character name of the time variable</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>return_model</code></td>
<td>
<p>logical to return model object. If FALSE returns PLR results from model</p>
</td>
</tr>
</table>
<h3>Value</h3>

<p>if return_model is FALSE it returns PLR results from model, otherwise returns segmented linear model object
</p>


<h3>Examples</h3>

<pre><code class="language-R"># build var_list
var_list &lt;- plr_build_var_list(time_var = "timestamp",
                               power_var = "power",
                               irrad_var = "g_poa",
                               temp_var = "mod_temp",
                               wind_var = NA)
# Clean Data
test_dfc &lt;- plr_cleaning(test_df, var_list, irrad_thresh = 100,
                         low_power_thresh = 0.01, high_power_cutoff = NA)
                         
#' # Perform power modeling step
test_xbx_wbw_res &lt;- plr_xbx_model(test_dfc, var_list, by = "week",
                                  data_cutoff = 30, predict_data = NULL)
                                  
decomp &lt;- plr_decomposition(test_xbx_wbw_res, freq = 4,
                                         power_var = 'power_var', time_var = 'time_var',
                                         plot = FALSE, plot_file = NULL, title = NULL, 
                                         data_file = NULL)

# evaluate segmented PLR results
seg_plr_result &lt;- PVplr::plr_seg_extract(df = decomp, per_year = 365,
                                         n_breakpoints = 1, power_var = "trend",
                                         time_var = "age")

# return segmented model instead of PLR result
model &lt;- PVplr::plr_seg_extract(df = decomp, per_year = 365, n_breakpoints = 1,
                                power_var = "trend", time_var = "age", return_model = TRUE)

# predict data along time-series with piecewise model for plotting
pred &lt;- data.frame(age = seq(1, max(decomp$age, na.rm = TRUE), length.out = 10000))
pred$seg &lt;- predict(model, newdata = pred)

</code></pre>


</div>