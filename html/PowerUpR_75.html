<div class="container">

<table style="width: 100%;"><tr>
<td>cra2</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>Two-level Cluster-randomized Trials to Detect Main, Moderation and Mediation Effects</h2>

<h3>Description</h3>

<p>For main treatment effects, use <code>mdes.cra2()</code> to calculate the minimum detectable effect size, <code>power.cra2()</code> to calculate the statistical power, <code>mrss.cra2()</code> to calculate the minimum required sample size (number of clusters).
</p>
<p>For moderator at level 1, use <code>mdesd.mod221()</code> to calculate the minimum detectable effect size, <code>power.mod221()</code> to calculate the statistical power, <code>mrss.mod221()</code> to calculate the minimum required sample size (number of clusters).
</p>
<p>For moderator at level 2, use <code>mdesd.mod222()</code> to calculate the minimum detectable effect size, <code>power.mod222()</code> to calculate the statistical power, <code>mrss.mod222()</code> to calculate the minimum required sample size (number of clusters).
</p>
<p>For mediator at level 1 and level 2, use <code>power.med211()</code> to calculate the statistical power for the 2-1-1 mediation, and <code>power.med221()</code> for the 2-2-1 mediation.
</p>
<p>For cluster-randomized block designs (treatment at level 2, with fixed effects across level 3 blocks), use <code>mdes.bcra3f2()</code> to calculate the minimum detectable effect size, <code>power.bcra3f2()</code> to calculate the statistical power, and <code>mrss.bcra3f2()</code> to calculate the minimum required sample size (number of clusters per block).
</p>
<p>For partially nested cluster randomized trials (interventions clusters in treatment groups) use <code>mdes.cra2_pn()</code> to calculate the minimum detectable effect size, <code>power.cra2_pn()</code> to calculate the statistical power, and <code>mrss.cra2_pn()</code> to calculate the minimum required sample size (number of schools).
</p>


<h3>Usage</h3>

<pre><code class="language-R">mdes.cra2(power=.80, alpha=.05, two.tailed=TRUE,
          rel1 = 1, rho2, p=.50, g2=0, r21=0, r22=0,
          n, J)

mdesd.mod221(power=.80, alpha=.05, two.tailed=TRUE,
            rho2, omegam2, r21=0, r2m2=0,
            p=.50, q=NULL, n, J)

mdesd.mod222(power=.80, alpha=.05, two.tailed=TRUE,
            rho2, r22=0,
            p=.50, q=NULL, n, J)

power.cra2(es=.25, alpha=.05, two.tailed=TRUE,
           rel1 = 1, rho2, g2=0, p=.50, r21=0, r22=0,
           n, J)

power.mod221(es=.25, alpha=.05, two.tailed=TRUE,
             rho2, omegam2, r21=0, r2m2=0,
             p=.50, q=NULL, n, J)

power.mod222(es=.25, alpha=.05, two.tailed=TRUE,
             rho2, r22=0,
             p=.50, q=NULL, n, J)

power.med211(esa, esb1, esB, escp, two.tailed = TRUE, alpha = .05,
             mc = FALSE, nsims = 1000, ndraws = 1000,
             rhom2, rho2, r21, r22, r2m1, r2m2,
             p, n, J)

power.med221(esa, esb, escp, two.tailed = TRUE, alpha = .05,
             mc = FALSE, nsims = 1000, ndraws = 1000,
             rho2, r22, r21, r2m2,
             p = .50, n, J)

mrss.cra2(es=.25, power=.80, alpha=.05, two.tailed=TRUE,
          n, J0=10, tol=.10, rel1 = 1,
          rho2, g2=0, p=.50, r21=0, r22=0)

mrss.mod221(es=.25, power=.80, alpha=.05, two.tailed=TRUE,
            n, J0=10, tol=.10, rho2, omegam2, r21=0, r2m2=0,
            p=.50, q=NULL)

mrss.mod222(es=.25, power=.80, alpha=.05, two.tailed=TRUE,
            n, J0=10, tol=.10, rho2, r22=0,
            p=.50, q=NULL)

mdes.bcra3f2(power=.80, alpha=.05, two.tailed=TRUE,
             rho2, p=.50, g2=0, r21=0, r22=0,
             n, J, K)

power.bcra3f2(es=.25, alpha=.05, two.tailed=TRUE,
              rho2, p=.50, g2=0, r21=0, r22=0,
              n, J, K)

mrss.bcra3f2(es=.25, power=.80, alpha=.05, two.tailed=TRUE,
             n, K, J0=10, tol=.10,
             rho2, p=.50, g2=0, r21=0, r22=0)

mdes.cra2_pn(power=.80, alpha=.05, two.tailed=TRUE, df=NULL,
             rho2_trt=.20, rho_ic=0, p=.50,
             r21=0, n, J, ic_size=1)

power.cra2_pn(es=.25,alpha=.05, two.tailed=TRUE, df=NULL,
              rho2_trt=.20, rho_ic=0, p=.50,
              r21=0, n, J, ic_size=1)

mrss.cra2_pn(es=.25, power=.80, alpha=.05, two.tailed=TRUE,
             z.test=FALSE, rho2_trt=.20, rho_ic=0, p=.50,
             r21=0, n, ic_size=1, J0=10, tol=.10)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>power</code></td>
<td>
<p>statistical power <code class="reqn">(1-\beta)</code></p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>es, esa, esb, esb1, esB, escp</code></td>
<td>
<p>effect size for main/moderator effects, or for path coefficients a (treatment - mediator), b (level 2 mediator - outcome), b1 (level 1 mediator - outcome), B (overall mediator - outcome) or cp (direct treatment - outcome) in the mediation model.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>alpha</code></td>
<td>
<p>probability of type I error.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>two.tailed</code></td>
<td>
<p>logical; <code>FALSE</code> for one-tailed hypothesis testing.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>df</code></td>
<td>
<p>degrees of freedom.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>rho_ic</code></td>
<td>
<p>proportion of variance in the outcome that is between intervention clusters.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>rho2_trt</code></td>
<td>
<p>proportion of variance in the outcome (for treatment group) that is between level 2 units.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>rel1</code></td>
<td>
<p>level 1 outcome reliability coefficient (Cox \&amp; Kelcey, 2019b).</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>rho2</code></td>
<td>
<p>proportion of variance in the outcome between level 2 units (unconditional ICC2). <code>rho</code> also works.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>rhom2</code></td>
<td>
<p>proportion of variance in the mediator between level 2 units.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>omegam2</code></td>
<td>
<p>ratio of the unconditional variance in the moderator effect that is between level 2 units to the residual variance between level 2 units in the null model.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>p</code></td>
<td>
<p>proportion of level 2 units randomly assigned to treatment.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>q</code></td>
<td>
<p>proportion of level 1 or level 2 units in the moderator subgroup.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>g2</code></td>
<td>
<p>number of covariates at level 2.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>r21</code></td>
<td>
<p>proportion of level 1 variance in the outcome explained by level 1 covariates (applies to all levels in partially nested designs).</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>r22</code></td>
<td>
<p>proportion of level 2 variance in the outcome explained by level 2 covariates.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>r2m1</code></td>
<td>
<p>proportion of mediator variance at level 1 explained by level 1 covariates.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>r2m2</code></td>
<td>
<p>proportion of variance in the moderator effect that is explained by level 2 predictors. For the mediation model, proportion of variance in the mediator explained by level 2 predictors.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>n</code></td>
<td>
<p>harmonic mean of level 1 units across level 2 units (or simple average).</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>J</code></td>
<td>
<p>level 2 sample size.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>K</code></td>
<td>
<p>number of level 3 units (blocks).</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>ic_size</code></td>
<td>
<p>sample size for each intervention cluster.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>J0</code></td>
<td>
<p>starting value for <code>J</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>tol</code></td>
<td>
<p>tolerance to end iterative process for finding <code>J</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>z.test</code></td>
<td>
<p>logical; <code>TRUE</code> for z-test.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>mc</code></td>
<td>
<p>logical; <code>TRUE</code> for monte carlo simulation based power.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>nsims</code></td>
<td>
<p>number of replications, if <code>mc = TRUE</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>ndraws</code></td>
<td>
<p>number of draws from the distribution of the path coefficients for each replication, if <code>mc = TRUE</code>.</p>
</td>
</tr>
</table>
<h3>Value</h3>

<table>
<tr style="vertical-align: top;">
<td><code>fun</code></td>
<td>
<p>function name.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>parms</code></td>
<td>
<p>list of parameters used in power calculation.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>df</code></td>
<td>
<p>degrees of freedom.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>ncp</code></td>
<td>
<p>noncentrality parameter.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>power</code></td>
<td>
<p>statistical power <code class="reqn">(1-\beta)</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>mdes</code></td>
<td>
<p>minimum detectable effect size.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>J</code></td>
<td>
<p>number of level 2 units.</p>
</td>
</tr>
</table>
<h3>References</h3>

<p>Cox, K., \&amp; Kelcey, B. (2019a). Optimal sample allocation in group-randomized mediation studies with a group-level mediator. <em>The Journal of Experimental Education</em>, <em>87</em>(4), 616-640. doi: <a href="https://doi.org/10.1080/00220973.2018.1496060">10.1080/00220973.2018.1496060</a>
</p>
<p>Cox, K., \&amp; Kelcey, B. (2019b). Optimal design of cluster-and multisite-randomized studies using fallible outcome measures. <em>Evaluation Review</em>,  <em>43</em>(3-4), 189-225. doi: <a href="https://doi.org/10.1177/0193841X19870878">10.1177/0193841X19870878</a>
</p>
<p>Dong, N., Spybrook J., Kelcey, B., \&amp; Bulus, M.  (2021). Power analyses for moderator effects with (non)random slopes in cluster randomized trials. <em>Methodology</em>, <em>17</em>(2), 92-110. doi: <a href="https://doi.org/10.5964/meth.4003">10.5964/meth.4003</a>
</p>
<p>Kelcey, B., Dong, N., Spybrook, J., \&amp; Cox, K. (2017). Statistical power for causally defined indirect effects in group-randomized trials with individual-level mediators. <em>Journal of Educational and Behavioral Statistics</em>, <em>42</em>(5), 499-530. doi: <a href="https://doi.org/10.3102/1076998617695506">10.3102/1076998617695506</a>
</p>
<p>Kelcey, B., Dong, N., Spybrook, J., \&amp; Shen, Z. (2017). Experimental power for indirect effects in group-randomized studies with group-level mediators. <em>Multivariate behavioral research</em>, <em>52</em>(6), 699-719. doi: <a href="https://doi.org/10.1080/00273171.2017.1356212">10.1080/00273171.2017.1356212</a>
</p>
<p>Kelcey, B., \&amp; Shen, Z. (2020). Strategies for efficient experimental design in studies probing 2-1-1 mediation. <em>The Journal of Experimental Education</em>, <em>88</em>(2), 311-334. doi: <a href="https://doi.org/10.1080/00220973.2018.1533796">10.1080/00220973.2018.1533796</a>
</p>
<p>Kelcey, B., Spybrook, J., \&amp; Dong, N. (2019). Sample size planning for cluster-randomized interventions probing multilevel mediation. <em>Prevention Science</em>, <em>20</em>(3), 407-418. doi: <a href="https://doi.org/10.1007/s11121-018-0921-6">10.1007/s11121-018-0921-6</a>
</p>
<p>Spybrook, J., Kelcey, B., \&amp; Dong, N. (2016). Power for detecting treatment by moderator effects in two-and three-level cluster randomized trials. <em>Journal of Educational and Behavioral Statistics</em>, <em>41</em>(6), 605-627. doi: <a href="https://doi.org/10.3102/1076998616655442">10.3102/1076998616655442</a>
</p>
<p>Dong, N., \&amp; Maynard, R. (2013). PowerUp!: A tool for calculating minimum detectable effect sizes and minimum required sample sizes for experimental and quasi-experimental design studies. <em>Journal of Research on Educational Effectiveness</em>, <em>6</em>(1), 24-67. doi: <a href="https://doi.org/10.1080/19345747.2012.673143">10.1080/19345747.2012.673143</a>
</p>
<p>Lohr, S., Schochet, P. Z., \&amp; Sanders, E. (2014). Partially nested randomized controlled trials in education research: A guide to design and analysis. NCER 2014-2000. National Center for Education Research. <a href="https://ies.ed.gov/ncer/pubs/20142000/pdf/20142000.pdf">https://ies.ed.gov/ncer/pubs/20142000/pdf/20142000.pdf</a>
</p>


<h3>Examples</h3>

<pre><code class="language-R"># cross-checks for the main effect
mdes.cra2(rho2=.17, n=15, J=20)
power.cra2(es=.629, rho2=.17, n=15, J=20)
mrss.cra2(es=.629, rho2=.17, n=15)

# cross-checks for the randomly varying cont. L1 moderator effect
mdesd.mod221(rho2=.17, omegam2=.10, n=15, J=20)
power.mod221(es=.3563, rho2=.17, omegam2 =.10, n=15, J=20)
mrss.mod221(es=.3563, rho2=.17, omegam2 =.10, n=15)

# cross-checks for the non-randomly varying cont. L1 moderator effect
mdesd.mod221(rho2=.17, omegam2=0, n=15, J=20)
power.mod221(es=0.2957, rho2=.17, omegam2 =0, n=15, J=20)
mrss.mod221(es=0.2957, rho2=.17, omegam2 =0, n=15)

# cross-checks for the randomly varying bin. L1 moderator effect
mdesd.mod221(rho2=.17, omegam2=.10, q=.50, n=15, J=20)
power.mod221(es=.647, rho2=.17, omegam2 =.10, q=.50, n=15, J=20)
mrss.mod221(es=.647, rho2=.17, omegam2 =.10, q=.50, n=15)

# cross-checks for the non-randomly varying bin. L1 moderator effect
mdesd.mod221(rho2=.17, omegam2=0, q=.50, n=15, J=20)
power.mod221(es=0.5915, rho2=.17, omegam2 =0, q=.50, n=15, J=20)
mrss.mod221(es=0.5915, rho2=.17, omegam2 =0, q=.50, n=15)

# cross-checks for the cont. L2 moderator effect
mdesd.mod222(rho2=.17, n=15, J=100)
power.mod222(es=0.2757, rho2=.17, n=15, J=100)
mrss.mod222(es=0.2757, rho2=.17, n=15)

# cross-checks for the bin. L2 moderator effect
mdesd.mod222(rho2=.17, q=.50, n=15, J=100)
power.mod222(es=0.5514, rho2=.17, q=.50, n=15, J=100)
mrss.mod222(es=0.5514, rho2=.17, q=.50, n=15)

# 2-2-1 mediation
power.med221(esa=0.6596, esb=0.1891, escp=.1,
             rho2=.15, r22=.52, r21=.40, r2m2=.50,
             n=100, J=40, p=.5)

# 2-1-1 mediation
power.med211(esa=0.4135, esb1=0.0670, esB=0.3595, escp=.1,
            rhom2=.3, rho2=.3, r22=.6, r21=.6, r2m2=.6, r2m1=.6,
            n=30, J=80, p=.1)

# cross-checks for cluster-randomized block design
# treatment at level 2, with fixed effects across level 3 blocks
mdes.bcra3f2(rho2=.10, n=20, J=44, K=5)
power.bcra3f2(es = .145, rho2=.10, n=20, J=44, K=5)
mrss.bcra3f2(es = .145, rho2=.10, n=20, K=5)

# cross-checks for partially nested cluster-randomized trial
mdes.cra2_pn(n=40, J=70, rho2_trt=.15, rho_ic=.10, ic_size=10)
power.cra2_pn(es=.305, n=40, J=70, rho2_trt=.15, rho_ic=.10, ic_size=10)
mrss.cra2_pn(es=.305, n=40, rho2_trt=.15, rho_ic=.10, ic_size=10)
</code></pre>


</div>