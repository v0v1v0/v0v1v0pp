<div class="container">

<table style="width: 100%;"><tr>
<td>backtestChartStackedBar</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>Chart of the weight allocation over time for a portfolio over a single backtest</h2>

<h3>Description</h3>

<p>Create chart of the weight allocation over time for a portfolio over a single 
backtest obtained with the function <code>portfolioBacktest</code>.
By default the chart is based on the package <code>ggplot2</code>, but the user can also 
specify a plot based on <code>PerformanceAnalytics</code>.
</p>


<h3>Usage</h3>

<pre><code class="language-R">backtestChartStackedBar(
  bt,
  portfolio = names(bt[1]),
  dataset_num = 1,
  num_bars = 100,
  type = c("ggplot2", "simple"),
  legend = FALSE
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>bt</code></td>
<td>
<p>Backtest results as produced by the function <code>portfolioBacktest</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>portfolio</code></td>
<td>
<p>String with portfolio name to be charted. 
Default charts the first portfolio in the backtest.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>dataset_num</code></td>
<td>
<p>Dataset index to be charted. Default is <code>dataset_num = 1</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>num_bars</code></td>
<td>
<p>Number of bars shown over time (basically a downsample of the possibly long sequence).</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>type</code></td>
<td>
<p>Type of plot. Valid options: <code>"ggplot2", "simple"</code>. Default is 
<code>"ggplot2"</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>legend</code></td>
<td>
<p>Boolean to choose whether legend is plotted or not. Default is <code>legend = FALSE</code>.</p>
</td>
</tr>
</table>
<h3>Author(s)</h3>

<p>Daniel P. Palomar and Rui Zhou
</p>


<h3>See Also</h3>

<p><code>summaryBarPlot</code>, <code>backtestBoxPlot</code>, 
<code>backtestChartCumReturn</code>, <code>backtestChartDrawdown</code>
</p>


<h3>Examples</h3>

<pre><code class="language-R">
library(portfolioBacktest)
data(dataset10)  # load dataset

# for better illustration, let's use only the first 5 stocks
dataset10_5stocks &lt;- lapply(dataset10, function(x) {x$adjusted &lt;- x$adjusted[, 1:5]; return(x)})

# define GMVP (with heuristic not to allow shorting)
GMVP_portfolio_fun &lt;- function(dataset, ...) {
  X &lt;- diff(log(dataset$adjusted))[-1]  # compute log returns
  Sigma &lt;- cov(X)  # compute SCM
  # design GMVP
  w &lt;- solve(Sigma, rep(1, nrow(Sigma)))
  w &lt;- abs(w)/sum(abs(w))
  return(w)
}

# backtest
bt &lt;- portfolioBacktest(list("GMVP" = GMVP_portfolio_fun), dataset10_5stocks, rebalance_every = 20)

# now we can chart
backtestChartStackedBar(bt, "GMVP", type = "simple")
backtestChartStackedBar(bt, "GMVP", type = "simple", legend = TRUE)
backtestChartStackedBar(bt, "GMVP")
backtestChartStackedBar(bt, "GMVP", legend = TRUE)


</code></pre>


</div>