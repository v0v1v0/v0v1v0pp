<div class="container">

<table style="width: 100%;"><tr>
<td>error.threshold.plot</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2> Error Threshold Plot </h2>

<h3>Description</h3>

<p><code>error.threshold.plot</code> takes a single model and plots the sensitivity and specificity as a function of threshold. It will optionally add other error statistics such as PCC and/or Kappa to the plot. Optionally, it will also optimize the choice of threshold by several criteria, return the results as a dataframe, and mark the optimized thresholds on the plot.
</p>


<h3>Usage</h3>

<pre><code class="language-R">error.threshold.plot(DATA, threshold = 101, which.model = 1, na.rm = FALSE, 
xlab = "Threshold", ylab = "Accuracy Measures", main = NULL, model.names = NULL, 
color = NULL, line.type = NULL, lwd = 1, plot.it = TRUE, opt.thresholds = NULL, 
opt.methods = NULL, req.sens, req.spec, obs.prev = NULL, smoothing = 1, 
vert.lines = FALSE, add.legend = TRUE, legend.text = legend.names, 
legend.cex = 0.8, add.opt.legend = TRUE, opt.legend.text = NULL, 
opt.legend.cex = 0.7, pch = NULL, FPC, FNC)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>DATA</code></td>
<td>
<p>a matrix or dataframe of observed and predicted values where each row represents one plot and where columns are:
</p>

<table>
<tr>
<td style="text-align: left;">
	  </td>
<td style="text-align: left;"> </td>
<td style="text-align: left;"> </td>
<td style="text-align: left;"> <code>DATA[,1]</code> </td>
<td style="text-align: left;"> plot ID </td>
<td style="text-align: left;"> text</td>
</tr>
<tr>
<td style="text-align: left;">
	  </td>
<td style="text-align: left;"> </td>
<td style="text-align: left;"> </td>
<td style="text-align: left;"> <code>DATA[,2]</code> </td>
<td style="text-align: left;"> observed values </td>
<td style="text-align: left;"> zero-one values</td>
</tr>
<tr>
<td style="text-align: left;">
	  </td>
<td style="text-align: left;"> </td>
<td style="text-align: left;"> </td>
<td style="text-align: left;"> <code>DATA[,3]</code> </td>
<td style="text-align: left;"> predicted probabilities from first model </td>
<td style="text-align: left;"> numeric (between 0 and 1)</td>
</tr>
<tr>
<td style="text-align: left;">
	  </td>
<td style="text-align: left;"> </td>
<td style="text-align: left;"> </td>
<td style="text-align: left;"> <code>DATA[,4]</code> </td>
<td style="text-align: left;"> predicted probabilities from second model, etc... </td>
<td style="text-align: left;">  </td>
</tr>
</table>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>threshold</code></td>
<td>
<p>cutoff values between zero and one used for translating predicted probabilities into 0 /1 values, defaults to 0.5. It can be a single value between zero and one, a vector of values between zero and one, or a positive integer representing the number of evenly spaced thresholds to calculate.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>which.model</code></td>
<td>
<p>a number indicating which model from <code>DATA</code> should be used</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>na.rm</code></td>
<td>
<p>a logical indicating whether missing values should be removed</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>xlab</code></td>
<td>
<p> a title for the x axis</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>ylab</code></td>
<td>
<p> a title for the y axis</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>main</code></td>
<td>
<p> an overall title for the plot </p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>model.names</code></td>
<td>
<p> a vector of the names of each model included in <code>DATA</code> to be used in the legend box </p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>color</code></td>
<td>
<p> should each error statistic be plotted in a different color. It can be a logical value (where <code>TRUE</code> = color and <code>FALSE</code> = black and white), or a vector of color codes specifying particular colors for each line.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>line.type</code></td>
<td>
<p> should each model be plotted in a different line type. It can be a logical value (where <code>TRUE</code> = dashed lines and <code>FALSE</code> = solid lines), or a vector of codes specifying particular line types for each line.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>lwd</code></td>
<td>
<p> line width </p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>plot.it</code></td>
<td>
<p> a logical indicating if a graphical plot should be produced</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>opt.thresholds </code></td>
<td>
<p> logical indicating whether the optimal thresholds should be calculated and plotted, or a vector specifying thresholds to plot </p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>opt.methods</code></td>
<td>
<p> what methods should be used to optimize thresholds. Given either as a vector of method names or method numbers. Possible values are:
</p>

<table>
<tr>
<td style="text-align: right;">
  1  </td>
<td style="text-align: left;"> <code>Default</code>   </td>
<td style="text-align: left;"> threshold=0.5 </td>
</tr>
<tr>
<td style="text-align: right;">
  2  </td>
<td style="text-align: left;"> <code>Sens=Spec</code> </td>
<td style="text-align: left;"> sensitivity=specificity </td>
</tr>
<tr>
<td style="text-align: right;">
  3  </td>
<td style="text-align: left;"> <code>MaxSens+Spec</code> </td>
<td style="text-align: left;"> maximizes (sensitivity+specificity)/2 </td>
</tr>
<tr>
<td style="text-align: right;">
  4  </td>
<td style="text-align: left;"> <code>MaxKappa</code>  </td>
<td style="text-align: left;"> maximizes Kappa </td>
</tr>
<tr>
<td style="text-align: right;">
  5  </td>
<td style="text-align: left;"> <code>MaxPCC</code>    </td>
<td style="text-align: left;"> maximizes PCC (percent correctly classified) </td>
</tr>
<tr>
<td style="text-align: right;">
  6  </td>
<td style="text-align: left;"> <code>PredPrev=Obs</code> </td>
<td style="text-align: left;"> predicted prevalence=observed prevalence </td>
</tr>
<tr>
<td style="text-align: right;">
  7  </td>
<td style="text-align: left;"> <code>ObsPrev</code>   </td>
<td style="text-align: left;"> threshold=observed prevalence </td>
</tr>
<tr>
<td style="text-align: right;">
  8 </td>
<td style="text-align: left;"> <code>MeanProb </code> </td>
<td style="text-align: left;"> mean predicted probability </td>
</tr>
<tr>
<td style="text-align: right;"> 
  9  </td>
<td style="text-align: left;"> <code>MinROCdist</code>
</td>
<td style="text-align: left;"> minimizes distance between ROC plot and (0,1)</td>
</tr>
<tr>
<td style="text-align: right;">
  10 </td>
<td style="text-align: left;"> <code>ReqSens</code> </td>
<td style="text-align: left;"> user defined required sensitivity </td>
</tr>
<tr>
<td style="text-align: right;">
  11 </td>
<td style="text-align: left;"> <code>ReqSpec</code> </td>
<td style="text-align: left;"> user defined required specificity </td>
</tr>
<tr>
<td style="text-align: right;">
  12 </td>
<td style="text-align: left;"> <code>Cost</code> </td>
<td style="text-align: left;"> user defined relative costs ratio </td>
</tr>
</table>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>req.sens</code></td>
<td>
<p>a value between zero and one giving the user defined required sensitivity. Only used if <code>opt.thresholds</code> = <code>TRUE</code>. Note that <code>req.sens</code> = (1-maximum allowable errors for points with positive observations).</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>req.spec</code></td>
<td>
<p>a value between zero and one giving the user defined required sspecificity. Only used if <code>opt.thresholds</code> = <code>TRUE</code>. Note that <code>req.sens</code> = (1- maximum allowable errors for points with negative observations).</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>obs.prev</code></td>
<td>
<p>observed prevalence for <code>opt.method</code> = <code>"PredPrev=Obs"</code> and <code>"ObsPrev"</code>. Defaults to observed prevalence from <code>DATA</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>smoothing</code></td>
<td>
<p>smoothing factor for maximizing/minimizing. Only used if <code>opt.thresholds</code> = <code>TRUE</code>. Instead of find the threshold that gives the max/min value, function will average the thresholds of the given number of max/min values.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>vert.lines</code></td>
<td>
<p>a logical where: <code>TRUE</code> means vertical lines added to plot at optimal thresholds; <code>FALSE</code> means no vertical lines, instead optimal thresholds marked along error statistics plots. Only used if <code>opt.thresholds</code> = <code>TRUE</code>. </p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>add.legend</code></td>
<td>
<p>logical indicating if a legend for accuracy statistics should be included on the plot </p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>legend.text</code></td>
<td>
<p>a vector of text for accuracy statistics legend. Defaults to name of each accuracy statistic. </p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>legend.cex</code></td>
<td>
<p>cex for presence/absence legend</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>add.opt.legend</code></td>
<td>
<p>logical indicating if a legend for optimal threshold criteria should be included on the plot</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>opt.legend.text</code></td>
<td>
<p>a vector of text for optimimal threshold criteria legend. Defaults to text corresponding to 'opt.methods'.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>opt.legend.cex</code></td>
<td>
<p>cex for optimization criteria legend</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>pch</code></td>
<td>
<p>plotting "character", i.e., symbol to use for the thresholds specified in <code>MARK</code>.  <code>pch</code> can either be a single character or an integer code for one of a set of graphics symbols.  See <code>help(points)</code> for details. </p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>FPC</code></td>
<td>
<p> False Positive Costs, or for C/B ratio C = 'net costs of treating nondiseased individuals'.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>FNC</code></td>
<td>
<p> False Negative Costs, or for C/B ratio B = 'net benefits of treating diseased individuals'.</p>
</td>
</tr>
</table>
<h3>Details</h3>

<p><code>error.threshold.plot</code> serves two purposes. First, if <code>plot.it</code> = <code>TRUE</code>, it produces a graphical plot. Second, if <code>opt.thresholds</code> = <code>TRUE</code> it will find optimal thresholds by several criteria. These optimal thresholds, along with basic accuracy measures for each type of optimal threshold will be returned as a dataframe. If a plot is produced, these optimal thresholds will be added to the plot.
</p>
<p>The graphical plot will always include lines showing sensitivity and specificity as a function of threshold. In addition, for <code>opt.methods</code> = <code>"MaxKappa"</code>, <code>"MaxPCC"</code>, <code>"MinROCdist"</code>, or <code>"MaxSens+Spec"</code> additional lines will be added to show the statistic being maximized/minimized. 
</p>
<p>These lines will be added to graph even if <code>opt.thresholds</code> = <code>FALSE</code>. So for example, to produce a graph showing sensitivity, specificity, and Kappa as functions of threshold, with out marking the optimal thresholds, set <code>opt.thresholds</code> = <code>FALSE</code>, and <code>opt.methods</code> = <code>"MaxKappa"</code>.
</p>
<p>See optimal.thresholds for more details on the optimization methods, and on the arguments <code>ReqSens</code>, <code>ReqSpec</code>, <code>obs.prev</code>, <code>smoothing</code>, <code>FPC</code>, and <code>FNC</code>.
</p>
<p>When <code>opt.thresholds</code> = <code>TRUE</code>, the default is to plot the optimal thresholds directly along the corresponding error statistics (or along the sensitivity line if the method has no corresponding error statistic). If the argument <code>vert.lines</code> = <code>TRUE</code>, a vertical line is drawn at each optimal threshold, and the lines are labeled across the top of the plot.
</p>
<p>Note: if too many methods are included in <code>opt.methods</code>, the graph will get very crowded.
</p>


<h3>Value</h3>

<p>If <code>plot.it</code> = <code>TRUE</code> creates a graphical plot.
</p>
<p>If <code>opt.thresholds</code> = <code>TRUE</code>, returns a dataframe of information about the optimal thresholds where:
</p>

<table>
<tr>
<td style="text-align: left;">
  <code>[,1]</code> </td>
<td style="text-align: left;"> <code>legend.names</code> </td>
<td style="text-align: left;"> type of optimal threshold </td>
</tr>
<tr>
<td style="text-align: left;">
  <code>[,2]</code> </td>
<td style="text-align: left;"> <code>threshold</code> </td>
<td style="text-align: left;"> optimal threshold</td>
</tr>
<tr>
<td style="text-align: left;">
  <code>[,3]</code> </td>
<td style="text-align: left;"> <code>PCC</code> </td>
<td style="text-align: left;"> at that threshold </td>
</tr>
<tr>
<td style="text-align: left;">
  <code>[,4]</code> </td>
<td style="text-align: left;"> <code>sensitivity</code> </td>
<td style="text-align: left;"> at that threshold </td>
</tr>
<tr>
<td style="text-align: left;">
  <code>[,5]</code> </td>
<td style="text-align: left;"> <code>specificity</code> </td>
<td style="text-align: left;"> at that threshold </td>
</tr>
<tr>
<td style="text-align: left;">
  <code>[,6]</code> </td>
<td style="text-align: left;"> <code>Kappa</code> </td>
<td style="text-align: left;"> at that threshold </td>
</tr>
</table>
<h3>Author(s)</h3>

<p> Elizabeth Freeman <a href="mailto:eafreeman@fs.fed.us">eafreeman@fs.fed.us</a>  </p>


<h3>See Also</h3>

 <p>optimal.thresholds, presence.absence.accuracy, roc.plot.calculate, presence.absence.summary </p>


<h3>Examples</h3>

<pre><code class="language-R">
data(SIM3DATA)

error.threshold.plot(SIM3DATA,opt.methods=c(1,2,5))

error.threshold.plot( SIM3DATA, 
                      which.model=2, 
                      opt.thresholds=TRUE, 
		      opt.methods=c("Default", "Sens=Spec", "MinROCdist"), 
                      vert.lines=TRUE)


error.threshold.plot(	SIM3DATA,
				threshold=101,
				which.model=2,
				na.rm=TRUE,
				xlab="Threshold",
				ylab="Accuracy Measures",
				main="Error Rate verses Threshold",
				model.names=NULL, 
				pch=NULL,
				color= c(3,5,7),
				line.type=NULL,
				lwd=1,
				plot.it=TRUE,
				opt.thresholds=TRUE,
				opt.methods=1:4,
				req.sens=0.85,
				req.spec=0.85,
				obs.prev=NULL,
				smoothing=1,
				vert.lines=FALSE,
				add.legend=TRUE,
				legend.cex=0.8)


</code></pre>


</div>