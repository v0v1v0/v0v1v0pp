<div class="container">

<table style="width: 100%;"><tr>
<td>stepwise.test.tree</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>Fits a population tree to data from quartet concordance factors</h2>

<h3>Description</h3>

<p>From a set of quartet concordance factors obtained from genetic data
(proportion of loci that truly have a given quartet) and from a guide tree,
this functions uses a stepwise search to find the best resolution of that guide tree.
Any unresolved edge corresponds to ancestral panmixia, on which the coalescent process
is assumed.</p>


<h3>Usage</h3>

<pre><code class="language-R">stepwise.test.tree(cf, guidetree, search="both", method="PLL", kbest=5,
                   maxiter=100, startT="panmixia", shape.correction=TRUE)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>cf</code></td>
<td>
<p>data frame containing one row for each 4-taxon set and containing taxon names
in columns 1-4, and concordance factors in columns 5-7.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>guidetree</code></td>
<td>
<p>tree of class phylo on the same taxon set as those in <code>cf</code>,
with branch lengths in coalescent units.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>search</code></td>
<td>
<p>one of "both" (stepwise search both forwards and backwards at each step),
or "heuristic" (heuristic shallow search: not recommended). </p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>method</code></td>
<td>
<p>Only "PLL" is implemented. The scoring criterion to rank population trees is the
pseudo log-likelihood (ignored if search="heuristic").</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>kbest</code></td>
<td>
<p>Number of candidate population trees to consider at each step
for the forward and for the backward phase (separately). Use a lower value for faster
but less thorough search.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>maxiter</code></td>
<td>
<p>Maximum number of iterations. One iteration consists of considering
multiple candidate population trees, using both a forward step and a backward step.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>startT</code></td>
<td>
<p>starting population tree. One of "panmixia", "fulltree", or a numeric
vector of edge numbers to keep resolved. The other edges are collapsed for panmixia.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>shape.correction</code></td>
<td>
<p>boolean. If true, the shapes of all Dirichlet distributions
used to test the adequacy of a population tree
are corrected to be greater or equal to 1. This correction avoids Dirichlet densities
going near 0 or 1. It is applied both when the <code class="reqn">\alpha</code> parameter is estimated and
when the outlier p-values are calculated.</p>
</td>
</tr>
</table>
<h3>Value</h3>

<table>
<tr style="vertical-align: top;">
<td><code>Nedge</code></td>
<td>
<p>Number of edges kept resolved in the guide tree. Other edges
are collapsed to model ancestral panmixia.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>edges</code></td>
<td>
<p>Indices of edges kept resolved in the guide tree.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>notincluded</code></td>
<td>
<p>Indices of edges collapsed in the guide tree, to model ancestral panmixia.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>alpha</code></td>
<td>
<p>estimated <code class="reqn">\alpha</code> parameter.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>negPseudoLoglik</code></td>
<td>
<p>Negative pseudo log-likelihood of the final estimated population tree.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>X2</code></td>
<td>
<p>Chi-square statistic, from comparing the counts of outlier p-values
(in <code>outlier.table</code>) to the expected counts.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>chisq.pval</code></td>
<td>
<p>p-value from the chi-square test, obtained from the comparing the <code>X2</code>
value to a chi-square distribution with 3 df.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>chisq.conclusion</code></td>
<td>
<p>character string. If the chi-square test is significant, this
statement says if there is an excess (or deficit) of outlier 4-taxon sets.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>outlier.table</code></td>
<td>
<p>Table with 2 rows (observed and expected counts) and 4 columns:
number of 4-taxon sets with p-values <code class="reqn">p\leq 0.01</code>,
<code class="reqn">0.01&lt;p\leq 0.05</code>, <code class="reqn">0.05&lt;p\leq 0.10</code>
or <code class="reqn">p&gt;0.10</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>outlier.pvalues</code></td>
<td>
<p>Vector of outlier p-values, with as many entries as there
are rows in <code>cf</code>, one for each set of 4 taxa.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>cf.exp</code></td>
<td>
<p>Matrix of concordance factors expected from the estimated population tree,
with as many rows as in <code>cf</code> (one row for each 4-taxon set) and 3 columns
(one for each of the 3 possible quartet trees).</p>
</td>
</tr>
</table>
<h3>Author(s)</h3>

<p>Cécile Ané</p>


<h3>References</h3>

<p>Stenz, Noah W. M., Bret Larget, David A. Baum and Cécile Ané (2015).
Exploring tree-like and non-tree-like patterns using genome sequences:
An example using the inbreeding plant species <em>Arabidopsis thaliana</em> (L.) Heynh.
Systematic Biology, <b>64</b>(5):809-823.
</p>


<h3>See Also</h3>

<p><code>test.one.species.tree</code>.</p>


<h3>Examples</h3>

<pre><code class="language-R">data(quartetCF)
data(guidetree)
resF &lt;- stepwise.test.tree(quartetCF,guidetree,startT="fulltree") # takes ~ 1 min
resF[1:9]

</code></pre>


</div>