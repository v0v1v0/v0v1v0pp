<div class="container">

<table style="width: 100%;"><tr>
<td>tune_plsmm</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>Tune Penalized PLSMM</h2>

<h3>Description</h3>

<p>This function tunes a penalized partial linear semiparametric mixed-model (PLSMM) by performing a grid search
over a set of hyperparameters to find the best model based on a given criterion.
</p>


<h3>Usage</h3>

<pre><code class="language-R">tune_plsmm(
  x,
  y,
  series,
  t,
  name_group_var,
  bases,
  gamma_vec,
  lambda_vec,
  timexgroup,
  criterion,
  ...
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>x</code></td>
<td>
<p>A matrix of predictors.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>y</code></td>
<td>
<p>A continuous vector of response variable.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>series</code></td>
<td>
<p>A variable representing different series or groups in the data modeled as a random intercept.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>t</code></td>
<td>
<p>A numeric vector indicating the time points.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>name_group_var</code></td>
<td>
<p>A character string specifying the name of the grouping variable.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>bases</code></td>
<td>
<p>A matrix of bases functions.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>gamma_vec</code></td>
<td>
<p>A vector of values for the regularization parameter for the coefficients of the nonlinear functions.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>lambda_vec</code></td>
<td>
<p>A vector of values for the regularization parameter for the coefficients of the fixed effects.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>timexgroup</code></td>
<td>
<p>Logical indicating whether to use a time-by-group interaction.
If <code>TRUE</code>, each group in <code>name_group_var</code> will have its own estimate of the time effect.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>criterion</code></td>
<td>
<p>A character string specifying the criterion to be optimized (<code>'BIC'</code>, <code>'BICC'</code>, <code>'EBIC'</code>).</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>...</code></td>
<td>
<p>Additional arguments to be passed to the <code>plsmm_lasso</code> function.</p>
</td>
</tr>
</table>
<h3>Details</h3>

<p>This function performs a grid search over the hyperparameters specified by <code>lambda_vec</code>
and <code>gamma_vec</code> to find the best-fitted PLSMM based on the given criterion. It fits PLSMMs using the
<code>plsmm_lasso</code> function for each combination of hyperparameters and retains only the models that
have converged. The best model is selected based on the minimum value of the specified criterion.
</p>


<h3>Value</h3>

<p>A PLSMM object representing the best-tuned model based on the specified criterion.
</p>


<h3>See Also</h3>

<p><code>plsmm_lasso</code>
</p>


<h3>Examples</h3>

<pre><code class="language-R">set.seed(123)
data_sim &lt;- simulate_group_inter(
 N = 50, n_mvnorm = 3, grouped = TRUE,
 timepoints = 3:5, nonpara_inter = TRUE,
 sample_from = seq(0, 52, 13),
 cos = FALSE, A_vec = c(1, 1.5)
)
sim = data_sim$sim
x = as.matrix(sim[,-1:-3])
y = sim$y
series = sim$series
t = sim$t
bases = create_bases(t)
lambdas &lt;- c(0.0046, 0.0001)
gammas &lt;- 0.00000001
tuned_plsmm &lt;- tune_plsmm(x, y, series, t,
                      name_group_var = "group", bases$bases,
                      gamma_vec = gammas, lambda_vec = lambdas, timexgroup = TRUE,
                      criterion = "BIC"
)

</code></pre>


</div>