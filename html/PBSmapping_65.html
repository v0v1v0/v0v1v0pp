<div class="container">

<table style="width: 100%;"><tr>
<td>calcGCdist</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>
Calculate Great-Circle Distance
</h2>

<h3>Description</h3>

<p>Calculate the great-circle distance between geographic (LL)
coordinates. Also calculate the initial bearing of the 
great-circle arc (at its starting point).
</p>


<h3>Usage</h3>

<pre><code class="language-R">calcGCdist(lon1, lat1, lon2, lat2, R=6371.2)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>lon1</code></td>
<td>
<p><code>numeric</code> – Longitude coordinate (degrees) of the start point.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>lat1</code></td>
<td>
<p><code>numeric</code> – Latitude coordinate(degrees) of the start point.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>lon2</code></td>
<td>
<p><code>numeric</code> – Longitude coordinate(degrees) of the end point.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>lat2</code></td>
<td>
<p><code>numeric</code> – Latitude coordinate(degrees) of the end point.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>R</code></td>
<td>
<p><code>numeric</code> – Mean radius (km) of the Earth.</p>
</td>
</tr>
</table>
<h3>Details</h3>

<p>The great-circle distance is calculated between two points along a
spherical surface using the shortest distance and disregarding
topography.
<br><br><b>Method 1: Haversine Formula</b>
</p>
<p style="text-align: center;"><code class="reqn">a = \sin^2((\phi_2 - \phi_1)/2) + \cos(\phi_1) \cos(\phi_2) \sin^2((\lambda_2 - \lambda_1)/2)</code>
</p>

<p style="text-align: center;"><code class="reqn">c = 2~\mathrm{atan2}(\sqrt{a}, \sqrt{1-a})</code>
</p>

<p style="text-align: center;"><code class="reqn">d = R c</code>
</p>

<p>where<br><code class="reqn">\phi</code> = latitude (in radians),<br><code class="reqn">\lambda</code> = longitude (in radians),<br><code class="reqn">R</code> = radius (km) of the Earth,<br><code class="reqn">a</code> = square of half the chord length between the points,<br><code class="reqn">c</code> = angular distance in radians,<br><code class="reqn">d</code> = great-circle distance (km) between two points.
<br><br><b>Method 2: Spherical Law of Cosines</b>
</p>
<p style="text-align: center;"><code class="reqn">d = \mathrm{acos}(\sin(\phi_1)\sin(\phi_2) + \cos(\phi_1)\cos(\phi_2)\cos(\lambda_2 - \lambda_1)) R</code>
</p>

<p>The initial bearing (aka forward azimuth) for the start point can be calculated using:
</p>
<p style="text-align: center;"><code class="reqn">\theta = \mathrm{atan2}(\sin(\lambda_2-\lambda_1)\cos(\phi_2), \cos(\phi_1)\sin(\phi_2) - \sin(\phi_1)\cos(\phi_2)\cos(\lambda_2-\lambda_1))</code>
</p>



<h3>Value</h3>

<p>A list obect containing:<br><code>a</code> – Haversine <code class="reqn">a</code> = square of half the chord length between the points,<br><code>c</code> – Haversine <code class="reqn">c</code> = angular distance in radians,<br><code>d</code> – Haversine <code class="reqn">d</code> = great-circle distance (km) between two points,<br><code>d2</code> – Law of Cosines <code class="reqn">d</code> = great-circle distance (km) between two points,<br><code>theta</code> – Initial bearing <code class="reqn">\theta</code> (degrees) for the start point.
</p>


<h3>Note</h3>

<p>If one uses the north geomagnetic pole as an end point, 
<code class="reqn">\theta</code> crudely approximates the magnetic declination.
</p>


<h3>Author(s)</h3>

<p><a href="mailto:rowan.haigh@dfo-mpo.gc.ca">Rowan Haigh</a>, Program Head – Offshore Rockfish<br>
Pacific Biological Station (PBS), Fisheries &amp; Oceans Canada (DFO), Nanaimo BC<br><em>locus opus</em>: Remote office, Vancouver BC<br>
Last modified <code>Rd: 2024-03-11</code>
</p>


<h3>References</h3>

<p>Movable Type Scripts –
<a href="https://www.movable-type.co.uk/scripts/latlong.html">Calculate distance, bearing and more between Latitude/Longitude points</a>
</p>


<h3>See Also</h3>

<p>In package <span class="pkg">PBSmapping</span>:<br><code>addCompass</code>,
<code>calcArea</code>,
<code>calcCentroid</code>,
<code>calcLength</code>
</p>


<h3>Examples</h3>

<pre><code class="language-R">local(envir=.PBSmapEnv,expr={
  #-- Distance between southern BC waters and north geomagnetic pole
  print(calcGCdist(-126.5,48.6,-72.7,80.4))
})
</code></pre>


</div>