<div class="container">

<table style="width: 100%;"><tr>
<td>pilot_spec</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>Calculate initial power spectral density estimates</h2>

<h3>Description</h3>

<p>This PSD is used as the starting point – the pilot spectrum – for
the adaptive estimation routine.
</p>


<h3>Usage</h3>

<pre><code class="language-R">pilot_spec(x, ...)

## S3 method for class 'ts'
pilot_spec(x, ...)

## S3 method for class 'matrix'
pilot_spec(x, x.frequency, ...)

## Default S3 method:
pilot_spec(
  x,
  x.frequency = NULL,
  ntap = NULL,
  remove.AR = NULL,
  plot = FALSE,
  verbose = FALSE,
  fast = FALSE,
  ...
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>x</code></td>
<td>
<p>vector; the data series to find a pilot spectrum for</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>...</code></td>
<td>
<p>additional parameters passed to <code>psdcore</code></p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>x.frequency</code></td>
<td>
<p>scalar; the sampling frequency (e.g. Hz) of the series</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>ntap</code></td>
<td>
<p>scalar; the number of tapers to apply during spectrum estimation</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>remove.AR</code></td>
<td>
<p>scalar; the max AR model to be removed from the data.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>plot</code></td>
<td>
<p>logical; should a plot be created?</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>verbose</code></td>
<td>
<p>logical; should messages be given?</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>fast</code></td>
<td>
<p>logical; use fast method in <code>psdcore</code>?</p>
</td>
</tr>
</table>
<h3>Details</h3>

<p>A fixed number
of tapers is applied across all frequencies using <code>psdcore</code>, and
subsequent taper-refinements are based on the spectral derivatives
of this spectrum; hence, changes in the number of tapers can affect
how many adaptive stages may be needed (though there are no formal convergence
criteria to speak of).
</p>
<p>The taper series of the returned spectrum is constrained using
<code>as.tapers(..., minspan=TRUE)</code>.
</p>
<p>The default behavior (<code>remove.AR &lt;= 0</code>) is to remove the standard linear 
model <code class="reqn">[f(x) = \alpha x + \beta]</code> from the data; however,
the user can model the effect of an autoregressive process by specifying
<code>remove.AR</code>.
</p>


<h3>Value</h3>

<p>Invisibly, an object with class <code>'spec'</code>, and 
<code>"pilot_psd"</code> in the working environment.
</p>


<h3>Removing an AR effect from the spectrum</h3>

<p>If <code>remove.AR &gt; 0</code> the argument is used as <code>AR.max</code> in 
<code>prewhiten</code>, from which an AR-response spectrum is calculated using
the best fitting model.
</p>
<p>If the value of <code>remove.AR</code> is too low the spectrum 
could become distorted,
so use with care.
<em>Note, however, that the 
value of <code>remove.AR</code> will be restricted to within the 
range <code class="reqn">[1,100]</code>.</em>
If the AR order is much larger than this, it's unclear how <code>prewhiten</code>
will perform and whether the AR model is appropriate.
</p>
<p><em>Note that this function does not produce a parametric spectrum estimation; rather,
it will return the amplitude response of the best-fitting AR model as <code>spec.ar</code>
would. <strong>Interpret these results with caution, as an AR response spectrum
can be misleading.</strong></em>
</p>


<h3>Author(s)</h3>

<p>A.J. Barbour
</p>


<h3>See Also</h3>

<p><code>psdcore</code>, <code>prewhiten</code>, <code>spec.ar</code>
</p>


<h3>Examples</h3>

<pre><code class="language-R">## Not run: #REX
library(psd)

##
## Pilot spectrum
##

data(magnet)

## simply calculate the pilot spectrum with a few tapers
plot(pilot_spec(xc &lt;- magnet$clean), log="dB", 
     main="Pilot PSDs for MAGNET and its AR-innovations (red)")

## remove the effect of an AR model
# note: remove.AR -- the max AR model to be removed from the data
plot(pilot_spec(xc, remove.AR=10), log="dB", add=TRUE, col="red")


## End(Not run)#REX
</code></pre>


</div>