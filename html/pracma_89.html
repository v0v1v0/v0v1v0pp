<div class="container">

<table style="width: 100%;"><tr>
<td>distmat</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>Distance Matrix</h2>

<h3>Description</h3>

<p>Computes the Euclidean distance between rows of two matrices.
</p>


<h3>Usage</h3>

<pre><code class="language-R">distmat(X, Y)
pdist(X)
pdist2(X, Y)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>X</code></td>
<td>
<p>matrix of some size <code>m x k</code>; vector will be taken as row matrix.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>Y</code></td>
<td>
<p>matrix of some size <code>n x k</code>; vector will be taken as row matrix.</p>
</td>
</tr>
</table>
<h3>Details</h3>

<p>Computes Euclidean distance between two vectors A and B as:
</p>
<p><code>||A-B|| = sqrt ( ||A||^2 + ||B||^2 - 2*A.B )</code>
</p>
<p>and vectorizes to rows of two matrices (or vectors).
</p>
<p><code>pdist2</code> is an alias for <code>distmat</code>, while <code>pdist(X)</code> is the
same as <code>distmat(X, X)</code>.
</p>


<h3>Value</h3>

<p>matrix of size <code>m x n</code> if <code>x</code> is of size <code>m x k</code> and
<code>y</code> is of size <code>n x k</code>.
</p>


<h3>Note</h3>

<p>If <code>a</code> is <code>m x r</code> and <code>b</code> is <code>n x r</code> then 
</p>
<p><code>apply(outer(a,t(b),"-"),c(1,4),function(x)sqrt(sum(diag(x*x))))</code>
</p>
<p>is the <code>m x n</code> matrix of distances between the <code>m</code> rows
of <code>a</code> and <code>n</code> rows of <code>b</code>.
</p>
<p>This can be modified as necessary, if one wants to apply distances other
than the euclidean.
</p>
<p>BUT: The code shown here is 10-100 times faster, utilizing the similarity
between Euclidean distance and matrix operations.
</p>


<h3>References</h3>

<p>Copyright (c) 1999 Roland Bunschoten for a Matlab version on MatlabCentral
under the name <code>distance.m</code>. Translated to R by Hans W Borchers.
</p>


<h3>See Also</h3>

<p><code>dist</code>
</p>


<h3>Examples</h3>

<pre><code class="language-R">A &lt;- c(0.0, 0.0)
B &lt;- matrix(c(
        0,0, 1,0, 0,1, 1,1), nrow=4, ncol = 2, byrow = TRUE)
distmat(A, B)  #=&gt; 0 1 1 sqrt(2)

X &lt;- matrix(rep(0.5, 5), nrow=1, ncol=5)
Y &lt;- matrix(runif(50), nrow=10, ncol=5)
distmat(X, Y)

# A more vectorized form of distmat:
distmat2 &lt;- function(x, y) {
    sqrt(outer(rowSums(x^2), rowSums(y^2), '+') - tcrossprod(x, 2 * y))
}
</code></pre>


</div>