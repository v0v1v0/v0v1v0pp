<div class="container">

<table style="width: 100%;"><tr>
<td>plotFitted</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>Plot observed segregation ratios and fitted and theoretical models</h2>

<h3>Description</h3>

<p>Plots  histogram of observed segregation ratios on
logit scale along with scaled density of fitted
components corresponding to dosage classes. Plots of expected
theoretical distributions can be plotted with or without segregation
ratio data.
</p>


<h3>Usage</h3>

<pre><code class="language-R">
## S3 method for class 'runJagsWrapper'
plot(x, theoretical=FALSE, ...)

plotFitted(seg.ratios, summary.mixture, add.random.effect=TRUE,
  theoretical=FALSE, model=NULL, theory.col="red",
  xaxis=c("logit","raw"), ylim=NULL, NCLASS=NULL, n.seq=100,
  xlab="logit(Segregation Ratio)", ylab="Density", density.plot=FALSE,
  fitted.lwd=2, fitted.col="blue", bar.col="lightgreen", cex=1,
  warnings = FALSE, main=NULL, ...)

plotTheoretical(ploidy.level=8, seg.ratios=NULL, n.components=NULL,
  expected.segratio=NULL, proportions=c(0.65,0.2,0.1,0.03,0.01,0.01, 0, 0),
  n.individuals=200, xaxis=c("raw","logit"),
  type.parents=c("heterogeneous","homozygous"), xlim=c(0,1),
  NCLASS=NULL, xlab="Segregation Ratio", ylab="Density",
  density.plot=FALSE, fitted.lwd=2, fitted.col="blue", cex=1,
  warnings = TRUE, main=NULL, ...)

</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>x</code></td>
<td>
<p>object of class <code>runJagsWrapper</code> produced by using
<code>runSegratioMM</code> to set up and fit mixture model</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>seg.ratios</code></td>
<td>
<p>segregation ratios as class <code>segRatio</code> </p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>summary.mixture</code></td>
<td>
<p>mcmc summary data produce by
<code>summary.segratioMCMC</code></p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>add.random.effect</code></td>
<td>
<p> add random variance component to fitted
distribution plot if model includes a random effect (default: TRUE)</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>theoretical</code></td>
<td>
<p>whether to plot the expected theoretical
distribution under the fitted model (default: FALSE)</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>model</code></td>
<td>
<p>object of class <code>modelSegratioMM</code> specifying model
if plotting expected theoretical distribution</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>theory.col</code></td>
<td>
<p>colour for expected theoretical distribution
(default: "red")</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>ploidy.level</code></td>
<td>
<p>the number of homologous chromosomes</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>n.components</code></td>
<td>
<p>number of components for mixture model</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>expected.segratio</code></td>
<td>
<p>may be specified or automatically calculated
from ploidy level etc</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>xaxis</code></td>
<td>
<p>whether to plot on "logit" or "raw" scale. Defaults to
"logit" if plotting segregation ratios or "raw" for theoretical
distributions</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>proportions</code></td>
<td>
<p>for no. of markers in each component of theoretical
distribution plot</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>n.individuals</code></td>
<td>
<p>for theoretical distribution plot - taken from
segregation ratios if supplied</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>type.parents</code></td>
<td>
<p> "heterogeneous" if parental markers are 0,1 or
"homogeneous" if parental markers are both 1</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>ylim</code></td>
<td>
<p> c(lower,upper) yaxis limits for histogram of segregation ratios</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>xlim</code></td>
<td>
<p> c(lower,upper) xaxis limits for segregation ratios</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>NCLASS</code></td>
<td>
<p>number of classes for histogram (Default: 100)</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>n.seq</code></td>
<td>
<p>number of points to use for plotting fitted mixture</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>xlab</code></td>
<td>
<p>x-axis label</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>ylab</code></td>
<td>
<p>y-axis label</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>density.plot</code></td>
<td>
<p>whether to plot a smoothed density as well as
segregation data and fitted and/or theoretical distributions (default:
FALSE)</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>main</code></td>
<td>
<p>title for plot</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>fitted.lwd</code></td>
<td>
<p>width for fitted line</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>fitted.col</code></td>
<td>
<p>colour for fitted line</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>bar.col</code></td>
<td>
<p>colour for histogram</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>cex</code></td>
<td>
<p>character expansion for text (see <code>par</code>)</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>warnings</code></td>
<td>
<p>print warnings like number of components etc (Default: FALSE)</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>...</code></td>
<td>
<p>extra options for <code>plot</code></p>
</td>
</tr>
</table>
<h3>Details</h3>

<p><code>plotFitted</code> plot histogram of observed segregation ratios on
logit scale along with scaled density of fitted
components corresponding to dosage classes using trellis
</p>
<p><code>plotTheoretical</code> plot expected distribution of
autopolyploid dominant markers on probability (0,1)
scale. Segregation ratios may also be plotted
</p>
<p><code>plot.runJagsWrapper</code> plots the fitted values of object of class
<code>runJagsWrapper</code> which has been produced by using
<code>runSegratioMM</code> to set up and fit mixture model
</p>
<p>Note that since trellis graphics are employed, plots may need to be
printed in order to see them
</p>


<h3>Value</h3>

<p> None.
</p>


<h3>Author(s)</h3>

<p>Peter Baker <a href="mailto:p.baker1@uq.edu.au">p.baker1@uq.edu.au</a></p>


<h3>See Also</h3>

 <p><code>summary.mcmc</code> <code>mcmc</code>
<code>segratioMCMC</code> <code>readJags</code>
<code>diagnosticsJagsMix</code> <code>runSegratioMM</code> 
</p>


<h3>Examples</h3>

<pre><code class="language-R">## simulate small autooctaploid data set
plotTheoretical(8, proportion=c(0.7,0.2,0.1),n.individuals=50)
a1 &lt;- sim.autoMarkers(8,c(0.7,0.2,0.1),n.markers=100,n.individuals=50)
##print(a1)
sr &lt;-  segregationRatios(a1$markers)
x &lt;- setModel(3,8)

## fit simple model in one hit and summarise
## Not run: 
x.run &lt;- runSegratioMM(sr, x, burn.in=200, sample=500)
print(x.run)

## plot fitted model using 'plotFitted'
plotFitted(sr, x.run$summary)
a.plot &lt;- plotFitted(sr, x.run$summary, density.plot=TRUE)
print(a.plot)
## or the easier way
plot(x.run, theoretical=TRUE)

## End(Not run)
</code></pre>


</div>