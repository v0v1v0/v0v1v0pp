<div class="container">

<table style="width: 100%;"><tr>
<td>format_output</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>Run the EM for several values of K</h2>

<h3>Description</h3>

<p><code>estimateEM_several_K.OUsr</code> uses function <code>estimateEM</code> on the data, 
for all values of K between 0 and K_max.
</p>


<h3>Usage</h3>

<pre><code class="language-R">format_output(results_estim_EM, phylo, time = NA)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>results_estim_EM</code></td>
<td>
<p>output of function <code>estimateEM</code></p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>time</code></td>
<td>
<p>to run the function</p>
</td>
</tr>
</table>
<h3>Details</h3>

<p>The EM is first launched for K=0, with alpha and gamma estimated. The
estimated values of alpha, gamma and beta_0 found by this first EM are then
used as initialization parameters for all the other runs of the EM for other
K.
The EMs are parallelized thanks to packages <code>foreach</code> and 
<code>doParallel</code>.
WARNING : this code only work of OU with stationary root, on an ultrametric
tree.
</p>


<h3>Value</h3>

<p>summary a data frame with K_max lines, and columns:
- alpha_estim the estimated selection strength
- gamma_estim the estimated root variance
- beta_0_estim the estimated value of root optimum
- EM_steps number of iterations needed before convergence
- DV_estim has the EM diverged ?
- CV_estim has the EM converged ?
- log_likelihood log likelihood of the data using the estimated parameters
- mahalanobis_distance_data_mean the Mahalanobis distance between the data
and the estimated means at the tips
- least_squares the Mahalanobis distance, renormalized by gamma^2: 
mahalanobis_distance_data_mean * gamma_estim.
- mean_number_new_shifts the mean number of shifts that changed over the 
iterations of the EM
- number_equivalent_solutions the number of equivalent solutions to 
the solution found.
- K_try the number of shifts allowed.
- complexity the complexity for K_try
- time the CPU time needed.
</p>
<p>params a list of inferred parameters
</p>
<p>params_init a list of initial parameters
</p>
<p>alpha_0 initial values of alpha
</p>
<p>gamma_0 initial values of gamma
</p>
<p>Zhat reconstructed node states
</p>
<p>m_Y_estim reconstructed tip states
</p>
<p>edge.quality for each edge, relative number of iterations in which they
were present.
</p>


</div>