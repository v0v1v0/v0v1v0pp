<div class="container">

<table style="width: 100%;"><tr>
<td>heatmap_na</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>Visualize missing data</h2>

<h3>Description</h3>

<p>This function visualizes the patterns of missing value
occurrence using a heatmap.
</p>


<h3>Usage</h3>

<pre><code class="language-R">heatmap_na(
  raw_df,
  protein_range,
  sample_range,
  reorder_x = FALSE,
  reorder_y = FALSE,
  x_fun = mean,
  y_fun = mean,
  palette = "viridis",
  label_proteins = FALSE,
  text_size = 10,
  save = FALSE,
  file_type = "pdf",
  file_path = NULL,
  file_name = "Missing_data_heatmap",
  plot_width = 15,
  plot_height = 15,
  dpi = 80
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>raw_df</code></td>
<td>
<p>A <code>raw_df</code> object (output from <code>create_df</code>).</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>protein_range</code></td>
<td>
<p>The range or subset of proteins (rows) to plot. If not
provided, all the proteins (rows) in the data frame will be used.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>sample_range</code></td>
<td>
<p>The range of samples to plot. If not
provided, all the samples (columns) in the data frame will be used.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>reorder_x</code></td>
<td>
<p>Logical. If <code>TRUE</code> samples on the x axis are reordered
using the function given in <code>x_fun</code>. Default is <code>FALSE</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>reorder_y</code></td>
<td>
<p>Logical. If <code>TRUE</code> proteins in the y axis are reordered
using the function given in <code>y_fun</code>. Default is <code>FALSE</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>x_fun</code></td>
<td>
<p>Function to reorder samples along the x axis. Possible options
are <code>mean</code> and <code>sum</code>. Default is <code>mean</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>y_fun</code></td>
<td>
<p>Function to reorder proteins along the y axis. Possible options
are <code>mean</code> and <code>sum</code>. Default is <code>mean</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>palette</code></td>
<td>
<p>Viridis color palette option for plots. Default is
<code>"viridis"</code>. See
<code>viridis</code>
for available options.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>label_proteins</code></td>
<td>
<p>If <code>TRUE</code> proteins on the y axis
will be labeled with their Majority Protein IDs. Default is <code>FALSE</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>text_size</code></td>
<td>
<p>Text size for axis labels. Default is <code>10</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>save</code></td>
<td>
<p>Logical. If <code>TRUE</code> saves a copy of the plot in the
directory provided in <code>file_path</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>file_type</code></td>
<td>
<p>File type to save the heatmap. Default is <code>"pdf"</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>file_path</code></td>
<td>
<p>A string containing the directory path to save the file.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>file_name</code></td>
<td>
<p>File name to save the heatmap. Default is
<code>"Missing_data_heatmap"</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>plot_width</code></td>
<td>
<p>Width of the plot. Default is <code>15</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>plot_height</code></td>
<td>
<p>Height of the plot. Default is <code>15</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>dpi</code></td>
<td>
<p>Plot resolution. Default is <code>80</code>.</p>
</td>
</tr>
</table>
<h3>Details</h3>

<p>This function visualizes patterns of missing value occurrence using a
heatmap. The user can choose to reorder the axes using the available functions
(<code>x_fun</code>, <code>y_fun</code>) to better understand the underlying cause of
missing data.
</p>


<h3>Value</h3>

<p>A <code>ggplot2</code> plot object.
</p>


<h3>Author(s)</h3>

<p>Chathurani Ranathunge
</p>


<h3>See Also</h3>

<p><code>create_df</code>
</p>


<h3>Examples</h3>

<pre><code class="language-R">## Generate a raw_df object with default settings. No technical replicates.
raw_df &lt;- create_df(
  prot_groups = "https://raw.githubusercontent.com/caranathunge/promor_example_data/main/pg1.txt",
  exp_design = "https://raw.githubusercontent.com/caranathunge/promor_example_data/main/ed1.txt"
)

## Missing data heatmap with default settings.
heatmap_na(raw_df)

## Missing data heatmap with x and y axes reordered by the mean (default) of
## protein intensity.
heatmap_na(raw_df,
  reorder_x = TRUE, reorder_y = TRUE
)

## Missing data heatmap with x and y axes reordered by the sum of
## protein intensity.
heatmap_na(raw_df,
  reorder_x = TRUE, reorder_y = TRUE, x_fun = sum,
  y_fun = sum
)

## Missing data heatmap for a subset of the proteins with x and y axes
## reordered by the mean (default) of protein intensity and the y axis
## labeled with protein IDs.
heatmap_na(raw_df,
  protein_range = 1:30,
  reorder_x = TRUE, reorder_y = TRUE,
  label_proteins = TRUE
)

</code></pre>


</div>