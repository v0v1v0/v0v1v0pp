<div class="container">

<table style="width: 100%;"><tr>
<td>permmodels</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>
Permutation Test of Linear Model 
</h2>

<h3>Description</h3>

<p>This function provides permutation t-tests for coefficients of (fixed) effects and permutation F-tests 
for the terms in a linear model such as <code>aov</code>, <code>lm</code>, <code>glm</code>, <code>gls</code>, <code>lme</code>, and <code>lmer</code>.
</p>


<h3>Usage</h3>

<pre><code class="language-R">permmodels(model, nperm=4999, type=c("I", "II", "III", 1, 2, 3), 
  test.statistic=c("Chisq", "F", "LR", "Wald"), exact=FALSE, data=NULL, 
  fo=NULL, prt=TRUE, ncore=3, seed)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>model</code></td>
<td>

<p>Model object returned by <code>aov</code>, <code>lm</code>, <code>glm</code>, <code>gls</code>, <code>lme</code>, and <code>lmer</code>. 
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>nperm</code></td>
<td>

<p>The number of permutations. The default is 4999.  
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>type</code></td>
<td>

<p>type of ANOVA test, "I", "II", "III", 1, 2, or 3. Roman numerals are equivalent to the corresponding Arabic numerals.
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>test.statistic</code></td>
<td>

<p>For type I ANOVA, F test is applied to all models, while for type II and III ANOVA, F test is performed for <code>lm</code>, 
Chisq test for <code>lme</code> and <code>gls</code> model, Chisq or F tests for <code>lmer</code> model and Likelihood ratio, Wald or F tests for <code>glm</code> model.
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>exact</code></td>
<td>

<p>A logical variable to indicate whether or not exact no. of permutations will be used (applicable only to free the permutation case). The default is FALSE.
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>data</code></td>
<td>

<p>In some cases, you need to provide the data set used in model fitting, especially when you have applied some variable trnasformation in the model.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>fo</code></td>
<td>

<p>A model formula used in the <code>model</code>; <code>fo!=NULL</code> when the formula is specified by function <code>formula</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>prt</code></td>
<td>

<p>A logical variable to indicate whether or not to print output on the screen. The default is TRUE.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>ncore</code></td>
<td>

<p>Number of core for parallel computing, the default value is 3.
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>seed</code></td>
<td>

<p>Specify a random number generator seed, for reproducible results.
</p>
</td>
</tr>
</table>
<h3>Value</h3>

<p>The function produces permutation t-test table for coefficients of (fixed) effects, permutation ANOVA table for model terms and a model parameter list <code>permlist</code>, a list containing <code>nsim=4999</code> times permutation refitted <code>model</code> parameters which are used in functions <code>predictmeans</code> and <code>contrastmeans</code>. 
</p>


<h3>Author(s)</h3>

<p>Dongwen Luo, Siva Ganesh and John Koolaard
</p>


<h3>Examples</h3>

<pre><code class="language-R">## Not run for simplifying process of submiting pkg to CRAN
#library(predictmeans)
#Oats$nitro &lt;- factor(Oats$nitro) 
#fm &lt;- lme(yield ~ nitro*Variety, random=~1|Block/Variety, data=Oats)
## library(lme4)
## fm &lt;- lmer(yield ~ nitro*Variety+(1|Block/Variety), data=Oats)
#
## Permutation Test for model terms
#system.time(
#  permlme &lt;- permmodels(model=fm, nperm=999)
#)  
#
## Permutation Test for multiple comparisons
#predictmeans(model=fm, modelterm="nitro:Variety", atvar="Variety", adj="BH", 
#  permlist=permlme, plot=FALSE)
#
## Permutation Test for specified contrasts
#cm &lt;- rbind(c(-1, 0, 1, 0, 0, 0, 0, 0, 0, 0, 0, 0), 
#            c(0, 0, 1, 0, 0, 0, 0, -1, 0, 0, 0, 0))
#contrastmeans(model=fm, modelterm="nitro:Variety", ctrmatrix=cm, permlist=permlme)
</code></pre>


</div>