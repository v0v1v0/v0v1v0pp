<div class="container">

<table style="width: 100%;"><tr>
<td>polychor</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>Polychoric Correlation</h2>

<h3>Description</h3>

<p>Computes the polychoric correlation (and its standard error)
between two ordinal variables or from their contingency table, under the 
assumption that the ordinal variables dissect continuous latent variables that are bivariate normal. Either
the maximum-likelihood estimator or a (possibly much) quicker “two-step” approximation is available. For the ML
estimator, the estimates of the thresholds and the covariance matrix of the estimates are also available.
</p>


<h3>Usage</h3>

<pre><code class="language-R">polychor(x, y, ML = FALSE, control = list(), 
  std.err = FALSE, maxcor=.9999, start, thresholds=FALSE)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>x</code></td>
<td>
<p>a contingency table of counts or an ordered categorical variable; the latter can be numeric, logical, a factor,
an ordered factor, or a character variable, but if a factor, its levels 
should be in proper order, and the values of a character variable are
ordered alphabetically.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>y</code></td>
<td>
<p>if <code>x</code> is a variable, a second ordered categorical variable.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>ML</code></td>
<td>
<p>if <code>TRUE</code>, compute the maximum-likelihood estimate; if <code>FALSE</code>, the default, compute a quicker
“two-step” approximation.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>control</code></td>
<td>
<p>optional arguments to be passed to the <code>optim</code> function.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>std.err</code></td>
<td>
<p>if <code>TRUE</code>, return the estimated variance of the correlation (for the two-step estimator) 
or the estimated covariance matrix (for the ML estimator) of the correlation and thresholds; the default is <code>FALSE</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>maxcor</code></td>
<td>
<p>maximum absolute correlation (to insure numerical stability).</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>start</code></td>
<td>
<p>optional start value(s): if a single number, start value for the correlation; if a list with the elements <code>rho</code>, <code>row.thresholds</code>, and <code>column.thresholds</code>, start values for these parameters; start values are supplied automatically if omitted, and are only relevant when the ML estimator or standard errors are selected.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>thresholds</code></td>
<td>
<p>if <code>TRUE</code> (the default is <code>FALSE</code>) return estimated thresholds along with the estimated correlation even if standard errors aren't computed.</p>
</td>
</tr>
</table>
<h3>Details</h3>

<p>The ML estimator is computed by maximizing the bivariate-normal likelihood with respect to the 
thresholds for the two variables (<code class="reqn">\tau^{x}_i, i = 1,\ldots, r - 1</code>; 
<code class="reqn">\tau^{y}_j, j = 1,\ldots, c - 1</code>) and
the population correlation (<code class="reqn">\rho</code>). Here, <code class="reqn">r</code> and <code class="reqn">c</code> are respectively the number of levels
of <code class="reqn">x</code> and <code class="reqn">y</code>. The likelihood is maximized numerically using the <code>optim</code> function,
and the covariance matrix of the estimated parameters is based on the numerical Hessian computed by <code>optim</code>.
</p>
<p>The two-step estimator is computed by first estimating the thresholds (<code class="reqn">\tau^{x}_i, i = 1,\ldots, r - 1</code> 
and <code class="reqn">\tau^{y}_j, i = j,\ldots, c - 1</code>) separately from the marginal distribution of each variable. Then the 
one-dimensional likelihood for <code class="reqn">\rho</code> is maximized numerically, using <code>optim</code> if standard errors are
requested, or <code>optimise</code> if they are not. The standard error computed treats the thresholds as fixed.
</p>


<h3>Value</h3>

<p>If <code>std.err</code> or <code>thresholds</code> is <code>TRUE</code>, 
returns an object of class <code>"polycor"</code> with the following components:
</p>
<table>
<tr style="vertical-align: top;">
<td><code>type</code></td>
<td>
<p>set to <code>"polychoric"</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>rho</code></td>
<td>
<p>the polychoric correlation.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>row.cuts</code></td>
<td>
<p>estimated thresholds for the row variable (<code>x</code>), for the ML estimate.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>col.cuts</code></td>
<td>
<p>estimated thresholds for the column variable (<code>y</code>), for the ML estimate.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>var</code></td>
<td>
<p>the estimated variance of the correlation, or, for the ML estimate, 
the estimated covariance matrix of the correlation and thresholds.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>n</code></td>
<td>
<p>the number of observations on which the correlation is based.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>chisq</code></td>
<td>
<p>chi-square test for bivariate normality.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>df</code></td>
<td>
<p>degrees of freedom for the test of bivariate normality.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>ML</code></td>
<td>
<p><code>TRUE</code> for the ML estimate, <code>FALSE</code> for the two-step estimate.</p>
</td>
</tr>
</table>
<p>Othewise, returns the polychoric correlation.
</p>


<h3>Author(s)</h3>

<p>John Fox <a href="mailto:jfox@mcmaster.ca">jfox@mcmaster.ca</a></p>


<h3>References</h3>

<p>Drasgow, F. (1986) 
Polychoric and polyserial correlations. 
Pp. 68–74 in S. Kotz and N. Johnson, eds.,
<em>The Encyclopedia of Statistics, Volume 7.</em> Wiley.
</p>
<p>Olsson, U. (1979)
Maximum likelihood estimation of the polychoric correlation coefficient.
<em>Psychometrika</em> <b>44</b>, 443-460.
</p>


<h3>See Also</h3>

<p><code>hetcor</code>, <code>polyserial</code>, <code>print.polycor</code>,
<code>optim</code></p>


<h3>Examples</h3>

<pre><code class="language-R">if(require(mvtnorm)){
    set.seed(12345)
    data &lt;- rmvnorm(1000, c(0, 0), matrix(c(1, .5, .5, 1), 2, 2))
    x &lt;- data[,1]
    y &lt;- data[,2]
    cor(x, y)  # sample correlation
    }
if(require(mvtnorm)){
    x &lt;- cut(x, c(-Inf, .75, Inf))
    y &lt;- cut(y, c(-Inf, -1, .5, 1.5, Inf))
    polychor(x, y)  # 2-step estimate
    }
if(require(mvtnorm)){
    polychor(x, y, ML=TRUE, std.err=TRUE)  # ML estimate
    }
</code></pre>


</div>