<div class="container">

<table style="width: 100%;"><tr>
<td>PHcluster</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>Poisson hurdle clustering</h2>

<h3>Description</h3>

<p>This function gives the clustering result based on a Poisson hurdle model.
</p>


<h3>Usage</h3>

<pre><code class="language-R">PHcluster(
  data,
  Treatment,
  nK,
  method = c("EM", "SA"),
  absolute = FALSE,
  cool = 0.9,
  nstart = 1
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>data</code></td>
<td>
<p>Data matrix with dimension N*P indicating N features and P samples. The cluster analysis is done feature-wised.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>Treatment</code></td>
<td>
<p>Vector of length P. Indicating replicates of different treatment groups. For example, <em>Treatment</em> = c(1,1,2,2,3,3) indicates 3 treatment groups, each with 2 replicates.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>nK</code></td>
<td>
<p>Positive integer. Number of clusters.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>method</code></td>
<td>
<p>Method for the algorithm. Can choose between <em>"EM"</em> as Expectation Maximization or <em>"SA"</em> as Simulated Annealing.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>absolute</code></td>
<td>
<p>Logical. Whether we should use absolute (TRUE) or relative (False) abundance of features to determine clusters.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>cool</code></td>
<td>
<p>Real number between (0, 1). Cooling rate for the <em>"SA"</em> algorithm. Uses 0.9 by default.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>nstart</code></td>
<td>
<p>Positive integer. Number of starts for the entire algorithm. Note that as <em>nstart</em> increases the computational time also grows linearly. Uses 1 by default.</p>
</td>
</tr>
</table>
<h3>Value</h3>


<dl>
<dt>cluster</dt>
<dd>
<p>Vector of length N consisting of integers from 1 to nK. Indicating final clustering result. For evaluating the clustering result please check NMI for <em>Normalized Mutual Information</em>.</p>
</dd>
<dt>prob</dt>
<dd>
<p>N*nK matrix. The (i, j)th element representing the probability that observation i belongs to cluster j.</p>
</dd>
<dt>log_l</dt>
<dd>
<p>Scaler. The Poisson hurdle log-likelihood of the final clustering result.</p>
</dd>
<dt>alpha</dt>
<dd>
<p>Vector of length N. The geometric mean abundance level for each feature, across all treatment groups.</p>
</dd>
<dt>Normalizer</dt>
<dd>
<p>vector of length P. The normalizing constant of sequencing depth for each sample.</p>
</dd>
</dl>
<h3>Examples</h3>

<pre><code class="language-R">######## Run the following codes in order:
##
## This is a sample data set which has 100 features, and 4 treatment groups with 4 replicates each.
data('sample_data')
head(sample_data)
set.seed(1)
##
## Finding the optimal number of clusters
K &lt;- Hybrid(sample_data, Kstart = 4, Treatment = rep(c(1,2,3,4), each = 4))
##
## Clustering result from EM algorithm
result &lt;- PHcluster(sample_data, rep(c(1,2,3,4), each = 4), K, method = 'EM', nstart = 1)
print(result$cluster)
##
## Plot the feature abundance level for each cluster
plot_abundance(result, sample_data, Treatment = rep(c(1,2,3,4), each = 4))
</code></pre>


</div>