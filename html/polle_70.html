<div class="container">

<table style="width: 100%;"><tr>
<td>sim_multi_stage</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>Simulate Multi-Stage Data</h2>

<h3>Description</h3>

<p>Simulate Multi-Stage Data
</p>


<h3>Usage</h3>

<pre><code class="language-R">sim_multi_stage(
  n,
  par = list(tau = 10, gamma = c(0, -0.2, 0.3), alpha = c(0, 0.5, 0.2, -0.5, 0.4), beta =
    c(3, -0.5, -0.5), psi = 1, xi = 0.3),
  a = function(t, x, beta, ...) {
     prob &lt;- lava::expit(beta[1] + (beta[2] * t^2) +
    (beta[3] * x))
     stats::rbinom(n = 1, size = 1, prob = prob)
 },
  seed = NULL
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>n</code></td>
<td>
<p>Number of observations.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>par</code></td>
<td>
<p>Named list with distributional parameters.
</p>

<ul>
<li> <p><code>tau</code>: <code class="reqn">\tau</code>
</p>
</li>
<li> <p><code>gamma</code>: <code class="reqn">\gamma</code>
</p>
</li>
<li> <p><code>alpha</code>: <code class="reqn">\alpha</code>
</p>
</li>
<li> <p><code>beta</code>: <code class="reqn">\beta</code>
</p>
</li>
<li> <p><code>psi</code>: <code class="reqn">\psi</code>
</p>
</li>
<li> <p><code>xi</code>: <code class="reqn">\xi</code>
</p>
</li>
</ul>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>a</code></td>
<td>
<p>Function used to specify the action/treatment at every stage.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>seed</code></td>
<td>
<p>Integer.</p>
</td>
</tr>
</table>
<h3>Details</h3>

<p><code>sim_multi_stage</code> samples <code>n</code> iid observation
<code class="reqn">O</code> with the following distribution:
</p>
<p style="text-align: center;"><code class="reqn">
W \sim \mathcal{N}(0, 1)\\
B \sim Ber(\xi)
</code>
</p>

<p>For <code class="reqn">k\geq 1</code> let
</p>
<p style="text-align: center;"><code class="reqn">
(T_k - T_{k-1})| X_{k-1}, A_{k-1}, W \sim
\begin{cases}
Exp\Big\{\exp\left(\gamma^T [1, X_{k-1}, W] \right) \Big\} + \psi \quad A_{k-1} = 1\\
\infty \quad A_{k-1} = 0
\end{cases}\\
X_{k}\mid T_k, X_{k-1}, B \sim
\begin{cases}
\mathcal{N}\left\{ \alpha^T [1, T_k, T^2_k, X_{k-1}, B], 1\right\} \quad T_k &lt; \infty \\
0 \quad T_k = \infty
\end{cases}\\
A_k \mid X_k, T_k \sim
\begin{cases}
Ber\left\{ expit\left(\beta^T[1, T_{k}^2, X_k] \right)\right\} \quad T_k &lt; \infty\\
0 \quad T_k = \infty,
\end{cases}
</code>
</p>

<p>Note that <code class="reqn">\psi</code> is the minimum increment.
</p>


<h3>Value</h3>

<p>list with elements <code>stage_data</code> (data.table::data.table) and
<code>baseline_data</code> (data.table::data.table).
</p>


</div>