<div class="container">

<table style="width: 100%;"><tr>
<td>opt.covTrack</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>Fit a model in which a trait tracks a covariate</h2>

<h3>Description</h3>

<p>Fit a model in which a trait tracks a covariate
</p>


<h3>Usage</h3>

<pre><code class="language-R">opt.covTrack(
  y,
  z,
  pool = TRUE,
  cl = list(fnscale = -1),
  meth = "L-BFGS-B",
  hess = FALSE
)

opt.joint.covTrack(
  y,
  z,
  pool = TRUE,
  cl = list(fnscale = -1),
  meth = "L-BFGS-B",
  hess = FALSE
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>y</code></td>
<td>
<p>a <code>paloeTS</code> object</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>z</code></td>
<td>
<p>a vector of covariate values</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>pool</code></td>
<td>
<p>if TRUE, sample variances are substituted with their pooled
estimate</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>cl</code></td>
<td>
<p>optional control list, passed to <code>optim()</code></p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>meth</code></td>
<td>
<p>optimization algorithm, passed to <code>optim()</code></p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>hess</code></td>
<td>
<p>if TRUE, return standard errors of parameter estimates from the
hessian matrix</p>
</td>
</tr>
</table>
<h3>Details</h3>

<p>In this model, changes in a trait are linearly related to changes in
a covariate with a slope of <code>b</code> and residual variance <code>evar</code>:
<code>dx = b * dz + eps</code>, where <code>eps ~ N(0, evar)</code>.  This model was
described, and applied to an example in which body size changes tracked
changes in temperature, by Hunt et al. (2010). <br></p>
<p>For the AD version (<code>opt.covTrack</code>), a trait sequence of
length <code>ns</code>, the covariate, <code>z</code>, can be of length <code>ns</code> - 1,
interpreted as the vector of <em>changes</em>, <code>dx</code>. If <code>z</code> is
of length <code>ns</code>, differences are taken and these are used as the
<code>dx</code>'s, with a warning issued. <br></p>
<p>The Joint version
(<code>opt.joint.covTrack</code>), <code>z</code> should be of length <code>ns</code> and
there is an additional parameter that is the intercept of the linear
relationship between trait and covariate. See warning below about using the
Joint version.
</p>


<h3>Value</h3>

<p>a <code>paleoTSfit</code> object with the results of the model fitting
</p>


<h3>Functions</h3>


<ul><li> <p><code>opt.joint.covTrack()</code>: fits the covTrack model using the joint parameterization
</p>
</li></ul>
<h3>Warning</h3>

<p>The Joint parameterization of this model can be fooled by
temporal autocorrelation and, especially, trends in the trait and the
covariate.  The latter is tested for, but the AD parameterization is
generally safer for this model.
</p>


<h3>References</h3>

<p>Hunt, G, S. Wicaksono, J. E. Brown, and K. G. Macleod. 2010. Climate-driven
body size trends in the ostracod fauna of the deep Indian Ocean. <em>Palaeontology</em>
53(6): 1255-1268.
</p>


<h3>See Also</h3>

<p><code>fitSimple</code>
</p>


<h3>Examples</h3>

<pre><code class="language-R">set.seed(13)
z &lt;- c(1, 2, 2, 4, 0, 8, 2, 3, 1, 9, 4, 3)
x &lt;- sim.covTrack(ns = 12, z = z, b = 0.5, evar = 0.2)
w.urw &lt;- opt.URW(x)
w.cov &lt;- opt.covTrack(x, z)
compareModels(w.urw, w.cov)
</code></pre>


</div>