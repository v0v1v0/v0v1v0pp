<div class="container">

<table style="width: 100%;"><tr>
<td>powerEpiInt.default0</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2> 
Power Calculation Testing Interaction Effect for Cox Proportional Hazards Regression
</h2>

<h3>Description</h3>

<p>Power calculation testing interaction effect for Cox proportional hazards regression with two covariates for Epidemiological Studies. Both covariates should be  binary variables. The formula takes
into account the correlation between the two covariates.
</p>


<h3>Usage</h3>

<pre><code class="language-R">powerEpiInt.default0(n, 
		     theta, 
		     p, 
		     psi, 
		     G, 
		     rho2, 
		     alpha = 0.05)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>n</code></td>
<td>
<p>integer. total number of subjects. </p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>theta</code></td>
<td>
<p>numeric. postulated hazard ratio. </p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>p</code></td>
<td>
<p>numeric. proportion of subjects taking the value one for the covariate of interest. </p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>psi</code></td>
<td>
<p>numeric. proportion of subjects died of the disease of interest. </p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>G</code></td>
<td>
<p>numeric. a factor adjusting the sample size. The sample size needed to
detect an effect of a prognostic factor with given error probabilities has
to be multiplied by the factor <code>G</code> when an interaction of the
same magnitude is to be detected.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>rho2</code></td>
<td>
<p>numeric. square of the correlation between the covariate of interest and the other covariate. </p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>alpha</code></td>
<td>
<p>numeric. type I error rate. </p>
</td>
</tr>
</table>
<h3>Details</h3>

<p>This is an implementation of the power calculation formula 
derived by Schmoor et al. (2000) for
the following Cox proportional hazards regression in the epidemiological
studies: 
</p>
<p style="text-align: center;"><code class="reqn">h(t|x_1, x_2)=h_0(t)\exp(\beta_1 x_1+\beta_2 x_2 + \gamma (x_1 x_2)),</code>
</p>

<p>where both covariates <code class="reqn">X_1</code> and <code class="reqn">X_2</code> are binary variables.
</p>
<p>Suppose we want to check if  
the hazard ratio of the interaction effect <code class="reqn">X_1 X_2=1</code> to <code class="reqn">X_1 X_2=0</code> is equal to <code class="reqn">1</code> 
or is equal to <code class="reqn">\exp(\gamma)=\theta</code>.
Given the type I error rate <code class="reqn">\alpha</code> for a two-sided test, the power 
required to detect a hazard ratio as small as <code class="reqn">\exp(\gamma)=\theta</code> is
</p>
<p style="text-align: center;"><code class="reqn">power=\Phi\left(-z_{1-\alpha/2}+\sqrt{\frac{n}{G}[\log(\theta)]^2 p (1-p) \psi (1-\rho^2)}\right),</code>
</p>

<p>where <code class="reqn">z_{a}</code> is the <code class="reqn">100 a</code>-th percentile of the standard normal distribution, <code class="reqn">\psi</code> is the proportion of subjects died of
the disease of interest, and 
</p>
<p style="text-align: center;"><code class="reqn">\rho=corr(X_1, X_2)=(p_1-p_0)\times \sqrt{\frac{q(1-q)}{p(1-p)}},</code>
</p>
 
<p>and
<code class="reqn">p=Pr(X_1=1)</code>, <code class="reqn">q=Pr(X_2=1)</code>, <code class="reqn">p_0=Pr(X_1=1|X_2=0)</code>,
and <code class="reqn">p_1=Pr(X_1=1 | X_2=1)</code>, and
</p>
<p style="text-align: center;"><code class="reqn">G=\frac{[(1-q)(1-p_0)p_0+q(1-p_1)p_1]^2}{(1-q)q (1-p_0)p_0 (1-p_1) p_1}.</code>
</p>

<p>If <code class="reqn">X_1</code> and <code class="reqn">X_2</code> are uncorrelated, we have <code class="reqn">p_0=p_1=p</code>
leading to <code class="reqn">1/[(1-q)q]</code>. For <code class="reqn">q=0.5</code>, we have <code class="reqn">G=4</code>.
</p>


<h3>Value</h3>

<p>The power of the test.
</p>


<h3>References</h3>

 
<p>Schmoor C., Sauerbrei W., and Schumacher M. (2000).
Sample size considerations for the evaluation of prognostic factors in survival analysis.
<em>Statistics in Medicine</em>. 19:441-452.
</p>


<h3>See Also</h3>

 <p><code>powerEpiInt.default1</code>, <code>powerEpiInt2</code> </p>


<h3>Examples</h3>

<pre><code class="language-R">  # Example at the end of Section 4 of Schmoor et al. (2000).
  powerEpiInt.default0(n = 184, 
		       theta = 3, 
		       p = 0.61, 
		       psi = 139 / 184, 
                       G = 4.79177, 
		       rho2 = 0.015^2, 
		       alpha = 0.05)
  
</code></pre>


</div>