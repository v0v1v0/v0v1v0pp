<div class="container">

<table style="width: 100%;"><tr>
<td>clust</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>Identify Extreme Clusters within a Time Series</h2>

<h3>Description</h3>

<p>A function to identify clusters of exceedances of a time series.
</p>


<h3>Usage</h3>

<pre><code class="language-R">clust(data, u, tim.cond = 1, clust.max = FALSE, plot = FALSE,
only.excess = TRUE, ...)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>data</code></td>
<td>
<p>A matrix/data.frame with two columns. Columns names <b>must
be</b> <code>obs</code> for observations and <code>time</code> for the associated date of
each observation.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>u</code></td>
<td>
<p>Numeric. A value giving the threshold.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>tim.cond</code></td>
<td>
<p>A time condition to ensure independence between
events. Should be in the same unit than <code>data[,"time"]</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>clust.max</code></td>
<td>
<p>Logical. If <code>FALSE</code> (the default), a list
containing the clusters of exceedances is returned. Else, a matrix
containing the cluster maxima and related dates is returned.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>plot</code></td>
<td>
<p>Logical. If <code>TRUE</code>, identified
clusters are displayed. Else (the default), no plot is produced.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>only.excess</code></td>
<td>
<p>Logical. If <code>TRUE</code> (the default), only
exceedances are plotted. Else, all observations are displayed.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>...</code></td>
<td>
<p>Optional parameters to be passed in <code>plot</code>
function.</p>
</td>
</tr>
</table>
<h3>Details</h3>

<p>The clusters of exceedances are defined as follows:
</p>

<ul>
<li>
<p> The first exceedance initiates the first cluster;
</p>
</li>
<li>
<p> The first observation under the threshold <code>u</code> “ends” the
current cluster unless <code>tim.cond</code> does not hold;
</p>
</li>
<li>
<p> The next exceedance initiates a new cluster;
</p>
</li>
<li>
<p> The process is iterated as needed.
</p>
</li>
</ul>
<p>This function differs from the function <code>clusters</code> of <code>evd</code>
Package as independence condition i.e. <code>tim.cond</code> could be a
“temporal” condition. That is, two events are considered independent
if the inter-arrival time is greater than a fixed duration.
</p>
<p>However, it is also possible to used the “index” independence as in
<code>clust</code> by setting <code>data[,"time"] =
  1:length(data[,"obs"])</code>.
</p>


<h3>Value</h3>

<p>If <code>clust.max</code> is <code>FALSE</code>, a list containing the clusters of
exceedances is returned. Else, a matrix containing the cluster maxima,
related dates and indices are returned.
</p>
<p>In any case, the returned object has an attribute <code>exi</code> giving
an estimation of the Extremal Index, that is the inverse of the
average cluster size.
</p>


<h3>Author(s)</h3>

<p>Mathieu Ribatet</p>


<h3>See Also</h3>

<p><code>clusters</code> of package <code>evd</code>.
</p>


<h3>Examples</h3>

<pre><code class="language-R">data(ardieres)
par(mfrow=c(1,2))
clust(ardieres, 4, 10 / 365)
clust(ardieres, 4, 10 / 365, clust.max = TRUE)
clust(ardieres, 4, 10 / 365, clust.max = TRUE, plot = TRUE)
##The same but with optional arguments passed to function ``plot''
clust(ardieres, 4, 10 / 365, clust.max = TRUE, plot = TRUE,
xlab = "Time (Years)", ylab = "Flood discharges",
xlim = c(1972, 1980))
</code></pre>


</div>