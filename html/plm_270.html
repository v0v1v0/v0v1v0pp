<div class="container">

<table style="width: 100%;"><tr>
<td>vcovNW</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>Newey and West (1987) Robust Covariance Matrix Estimator</h2>

<h3>Description</h3>

<p>Nonparametric robust covariance matrix estimators <em>a la Newey
and West</em> for panel models with serial correlation.
</p>


<h3>Usage</h3>

<pre><code class="language-R">vcovNW(x, ...)

## S3 method for class 'plm'
vcovNW(
  x,
  type = c("HC0", "sss", "HC1", "HC2", "HC3", "HC4"),
  maxlag = NULL,
  wj = function(j, maxlag) 1 - j/(maxlag + 1),
  ...
)

## S3 method for class 'pcce'
vcovNW(
  x,
  type = c("HC0", "sss", "HC1", "HC2", "HC3", "HC4"),
  maxlag = NULL,
  wj = function(j, maxlag) 1 - j/(maxlag + 1),
  ...
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>x</code></td>
<td>
<p>an object of class <code>"plm"</code> or <code>"pcce"</code></p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>...</code></td>
<td>
<p>further arguments</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>type</code></td>
<td>
<p>the weighting scheme used, one of <code>"HC0"</code>, <code>"sss"</code>,
<code>"HC1"</code>, <code>"HC2"</code>, <code>"HC3"</code>, <code>"HC4"</code>, see Details,</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>maxlag</code></td>
<td>
<p>either <code>NULL</code> or a positive integer specifying the
maximum lag order before truncation</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>wj</code></td>
<td>
<p>weighting function to be applied to lagged terms,</p>
</td>
</tr>
</table>
<h3>Details</h3>

<p><code>vcovNW</code> is a function for estimating a robust covariance matrix of
parameters for a panel model according to the
Newey and West (1987) method.  The function works
as a restriction of the Driscoll and Kraay (1998) covariance (see
<code>vcovSCC()</code>) to no cross–sectional correlation.
</p>
<p>Weighting schemes specified by <code>type</code> are analogous to those in
<code>sandwich::vcovHC()</code> in package <a href="https://CRAN.R-project.org/package=sandwich"><span class="pkg">sandwich</span></a> and are
justified theoretically (although in the context of the standard
linear model) by MacKinnon and White (1985) and
Cribari–Neto (2004) (see Zeileis 2004).
</p>
<p>The main use of <code>vcovNW</code> (and the other variance-covariance estimators
provided in the package <code>vcovHC</code>, <code>vcovBK</code>, <code>vcovDC</code>, <code>vcovSCC</code>) is to pass
it to plm's own functions like <code>summary</code>, <code>pwaldtest</code>, and <code>phtest</code> or
together with testing functions from the <code>lmtest</code> and <code>car</code> packages. All of
these typically allow passing the <code>vcov</code> or <code>vcov.</code> parameter either as a
matrix or as a function, e.g., for Wald–type testing: argument <code>vcov.</code> to
<code>coeftest()</code>, argument <code>vcov</code> to <code>waldtest()</code> and other methods in the
<a href="https://CRAN.R-project.org/package=lmtest"><span class="pkg">lmtest</span></a> package; and argument <code>vcov.</code> to
<code>linearHypothesis()</code> in the <a href="https://CRAN.R-project.org/package=car"><span class="pkg">car</span></a> package (see the
examples), see (see also Zeileis 2004), 4.1-2, and examples below.
</p>


<h3>Value</h3>

<p>An object of class <code>"matrix"</code> containing the estimate of
the covariance matrix of coefficients.
</p>


<h3>Author(s)</h3>

<p>Giovanni Millo
</p>


<h3>References</h3>

<p>Cribari–Neto F (2004).
“Asymptotic Inference Under Heteroskedasticity of Unknown Form.”
<em>Computational Statistics &amp; Data Analysis</em>, <b>45</b>, 215–233.
</p>
<p>Driscoll JC, Kraay AC (1998).
“Consistent covariance matrix estimation with spatially dependent panel data.”
<em>Review of economics and statistics</em>, <b>80</b>(4), 549–560.
</p>
<p>MacKinnon JG, White H (1985).
“Some Heteroskedasticity–Consistent Covariance Matrix Estimators With Improved Finite Sample Properties.”
<em>Journal of Econometrics</em>, <b>29</b>, 305–325.
</p>
<p>Newey WK, West KD (1987).
“A Simple, Positive Semi-definite, Heteroskedasticity and Autocorrelation Consistent Covariance Matrix.”
<em>Econometrica</em>, <b>55</b>(3), 703–08.
</p>
<p>Zeileis A (2004).
“Econometric Computing With HC and HAC Covariance Matrix Estimators.”
<em>Journal of Statistical Software</em>, <b>11</b>(10), 1–17.
<a href="https://www.jstatsoft.org/article/view/v011i10">https://www.jstatsoft.org/article/view/v011i10</a>.
</p>


<h3>See Also</h3>

<p><code>sandwich::vcovHC()</code> from the <a href="https://CRAN.R-project.org/package=sandwich"><span class="pkg">sandwich</span></a> package
for weighting schemes (<code>type</code> argument).
</p>


<h3>Examples</h3>

<pre><code class="language-R">
data("Produc", package="plm")
zz &lt;- plm(log(gsp)~log(pcap)+log(pc)+log(emp)+unemp, data=Produc, model="pooling")
## as function input to plm's summary method (with and without additional arguments):
summary(zz, vcov = vcovNW)
summary(zz, vcov = function(x) vcovNW(x, method="arellano", type="HC1"))
## standard coefficient significance test
library(lmtest)
coeftest(zz)
## NW robust significance test, default
coeftest(zz, vcov.=vcovNW)
## idem with parameters, pass vcov as a function argument
coeftest(zz, vcov.=function(x) vcovNW(x, type="HC1", maxlag=4))
## joint restriction test
waldtest(zz, update(zz, .~.-log(emp)-unemp), vcov=vcovNW)
## Not run: 
## test of hyp.: 2*log(pc)=log(emp)
library(car)
linearHypothesis(zz, "2*log(pc)=log(emp)", vcov.=vcovNW)

## End(Not run)
</code></pre>


</div>