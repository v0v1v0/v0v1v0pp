<div class="container">

<table style="width: 100%;"><tr>
<td>AddPloidyChiSq</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>
Chi-Square Test on Genotype Likelihood Distributions
</h2>

<h3>Description</h3>

<p>This function is intended to help identify the correct inheritance mode for
each locus in a <code>"RADdata"</code> object.  Expected genotype frequencies
are taken from <code>object$priorProb</code>.  Observed genotype frequencies are
estimated from <code>object$genotypeLikelihood</code>, where each taxon has a
partial assignment to each genotype, proportional to genotype likelihoods.
A <code class="reqn">\chi ^ 2</code> statistic is then estimated.
</p>


<h3>Usage</h3>

<pre><code class="language-R">AddPloidyChiSq(object, ...)
## S3 method for class 'RADdata'
AddPloidyChiSq(object, excludeTaxa = GetBlankTaxa(object),
               ...)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>object</code></td>
<td>

<p>A <code>"RADdata"</code> object.  Genotype prior probabilities and
likelihoods should have been added.
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>excludeTaxa</code></td>
<td>

<p>A character vector indicating names of taxa to exclude from calculations.
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>...</code></td>
<td>

<p>Additional arguments to be passed to other methods (none currently in use).
</p>
</td>
</tr>
</table>
<h3>Details</h3>

<p>Parents (in mapping populations) and blank taxa are automatically excluded
from calculations.
</p>
<p>Genotypes with zero prior probability would result in an infinite 
A <code class="reqn">\chi ^ 2</code> statistic and therefore are excluded from
the calculation.  However, the total number of observations (total number
of taxa) remains the same, so that if there are many taxa with high
likelihood for a genotype with zero prior probability, 
<code class="reqn">\chi ^ 2</code> will be high.
</p>


<h3>Value</h3>

<p>A <code>"RADdata"</code> object identical to the one passed to the function,
but with a matrix added to the <code>$ploidyChiSq</code>
slot.  This matrix has inheritance rows (matching <code>object$priorProb</code>) in
rows and alleles in columns.  <code>object$ploidyChiSq</code> contains the 
<code class="reqn">\chi ^ 2</code> values.
</p>


<h3>Author(s)</h3>

<p>Lindsay V. Clark
</p>


<h3>See Also</h3>

<p><code>AddGenotypeLikelihood</code>, <code>AddPloidyLikelihood</code>
</p>


<h3>Examples</h3>

<pre><code class="language-R"># load dataset and set some parameters
data(exampleRAD_mapping)
exampleRAD_mapping &lt;- SetDonorParent(exampleRAD_mapping, "parent1")
exampleRAD_mapping &lt;- SetRecurrentParent(exampleRAD_mapping, "parent2")
exampleRAD_mapping &lt;- AddAlleleFreqMapping(exampleRAD_mapping,
                                           expectedFreqs = c(0.25, 0.75),
                                           allowedDeviation = 0.08)
exampleRAD_mapping &lt;- AddGenotypeLikelihood(exampleRAD_mapping)
exampleRAD_mapping &lt;- AddGenotypePriorProb_Mapping2Parents(exampleRAD_mapping,
                                                      n.gen.backcrossing = 1)
                                                      
# get chi-squared values
exampleRAD_mapping &lt;- AddPloidyChiSq(exampleRAD_mapping)
# view chi-squared and p-values (diploid only)
exampleRAD_mapping$ploidyChiSq
</code></pre>


</div>