<div class="container">

<table style="width: 100%;"><tr>
<td>power.scABEL</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>
(Empirical) Power of BE decision via scaled (widened) BE acceptance limits
</h2>

<h3>Description</h3>

<p>These function performs the power calculation of the BE decision via 
scaled (widened) BE acceptance limits by simulations.
</p>


<h3>Usage</h3>

<pre><code class="language-R">power.scABEL(alpha = 0.05, theta1, theta2, theta0, CV, n, 
             design = c("2x3x3", "2x2x4", "2x2x3"), regulator, 
             nsims, details = FALSE, setseed = TRUE)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>alpha</code></td>
<td>

<p>Type I error probability, significance level. Conventionally mostly set to 0.05.
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>theta1</code></td>
<td>

<p>Conventional lower ABE limit to be applied in the mixed procedure if 
<code>CVsWR &lt;= CVswitch</code>. Also lower limit for the point estimate constraint.<br>
Defaults to 0.8 if not given explicitly.
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>theta2</code></td>
<td>

<p>Conventional upper ABE limit to be applied in the mixed procedure if 
<code>CVsWR &lt;= CVswitch</code>. Also upper limit for the point estimate constraint.<br>
Defaults to 1.25 if not given explicitly.
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>theta0</code></td>
<td>

<p>‘True’ or assumed T/R ratio. <br>
Defaults to 0.90 according to the two Lászlós if not given explicitly.
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>CV</code></td>
<td>

<p>Intra-subject coefficient(s) of variation as ratio (not percent).
</p>

<ul>
<li>
<p> If given as a scalar (<code>length(CV)==1</code>) the <em>same</em> CV of Test
and Reference is assumed (homoscedasticity, <code>CVwT==CVwR</code>).
</p>
</li>
<li>
<p> If given as a vector (<code>length(CV)==2</code>), <em>i.e.</em>, assuming
heteroscedasticity, the CV of the Test <strong>must</strong> be given in 
<code>CV[1]</code> and the one of the Reference in the <code>CV[2]</code>.
</p>
</li>
</ul>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>n</code></td>
<td>

<p>Number of subjects under study.<br>
May be given as vector. In that case it is assumed that <code>n</code> contains the number
of subjects in the sequence groups.<br>
If <code>n</code> is given as single number (total sample size) and this number is not 
divisible by the number of sequences of the design an unbalanced design is 
assumed. A corresponding message is thrown showing the numbers of subjects 
in sequence groups.<br>
Attention! In case of the <code>"2x2x3"</code> (TRT|RTR) design the order of sample sizes is important 
if given as vector. <code>n[1]</code> is for sequence group 'TRT' and <code>n[2]</code> is for 
sequence group 'RTR'. 
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>design</code></td>
<td>

<p>Design of the study.<br><code>"2x3x3"</code> is the partial replicate design.<br><code>"2x2x4"</code> is a full replicate design with 2 sequences and 4 periods.<br><code>"2x2x3"</code> is a full replicate design with 2 sequences and 3 periods.<br>
Defaults to <code>"2x3x3"</code>. Details are given the section about Designs.
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>regulator</code></td>
<td>

<p>Regulatory settings for the widening of the BE acceptance limits.<br>
May be given as character from the choices <code>"EMA"</code>, <code>"HC"</code>, <code>"FDA"</code>, 
<code>"GCC"</code> or as an object of class 'regSet' (see <code>reg_const</code>).<br>
Defaults to <code>regulator="EMA"</code> if missing.<br>
This argument may be given also in lower case if given as character.<br></p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>nsims</code></td>
<td>

<p>Number of simulations to be performed to obtain the empirical power.
Defaults to 100,000 = 1e+05.<br>
If not given and <code>theta0</code> equals one of the expanded limits (<em>i.e.</em>, 
simulating empirical alpha), defaults to 1e+06.
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>details</code></td>
<td>

<p>If set to <code>TRUE</code> the computational time is shown as well as the components
for the BE decision.<br>
p(BE-wABEL) is the probability that the CI is within (widened) limits.<br>
p(BE-PE) is the probability that the point estimate is within theta1 ... theta2.<br>
p(BE-ABE) is the simulated probability for the conventional ABE test.
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>setseed</code></td>
<td>

<p>Simulations are dependent on the starting point of the (pseudo) random number 
generator. To avoid differences in power for different runs a <code>set.seed()</code> 
is issued if <code>setseed=TRUE</code>, the default. 
</p>
</td>
</tr>
</table>
<h3>Details</h3>

<p>The methods rely on the analysis of log-transformed data, <em>i.e.</em>, assume a 
log-normal distribution on the original scale.<br><br>
The widened BE acceptance limits will be calculated by the formula<br><code style="white-space: pre;">⁠  [L, U] = exp(-/+ r_const * sWR)⁠</code><br>
with <code>r_const</code> the regulatory constant and <code>sWR</code> the standard deviation of the within
subjects variability of the Reference. <code>r_const = 0.76</code> (~log(1.25)/0.29356) is used 
in case of <code>regulator="EMA"</code> or <code>regulator="HC"</code> and in case of 
<code>regulator="FDA"</code> <code>r_const = 0.89257...</code> (log(1.25)/0.25).
If the CVwR of the Reference is &lt; CVswitch=0.3 the conventional ABE limits 
apply (mixed procedure).<br><br> 
In case of <code>regulator="EMA"</code> a cap is placed on the widened limits if 
CVwR&gt;0.5, <em>i.e.</em>, the widened limits are held at value calculated for CVwR=0.5.
In case of <code>regulator="HC"</code> the capping is done such that the acceptance
limits are 0.6666 ... 1.5 at maximum.<br><br>
The case of <code>regulator="GCC"</code> is treatd as special case of ABEL with 
CVswitch = CVcap = 0.3. The r_const = log(1.25)/CV2se(0.3) assures that for CV&gt;0.3
the widened BE limits of 0.7 ... 1.3333 are used.<br><br>
The simulations are done via the distributional properties of the statistical
quantities necessary for deciding BE based on widened ABEL.<br>
For more details see the document <code style="white-space: pre;">⁠Implementation_scaledABE_simsVx.yy.pdf⁠</code> in the 
<code>/doc</code> sub-directory of the package.<br><br>
Function <code>power.scABEL()</code> implements the simulation via distributional 
characteristics of the ‘key’ statistics obtained from the EMA recommended 
evaluation via ANOVA if <code>regulator="EMA"</code> or if the regulator component 
<code>est_method</code> is set to <code>"ANOVA"</code> if regulator is an object of class 'regSet'.<br>
Otherwise the simulations are based on the distributional characteristis of the 
‘key’ statistics obtained from evaluation via intra-subject contrasts (ISC), 
as recommended by the FDA.
</p>


<h3>Value</h3>

<p>Returns the value of the (empirical) power if argument <code>details=FALSE</code>.<br><br>
Returns a named vector if argument <code>details=TRUE</code>.<br>
p(BE) is the power, p(BE-ABEL) is the power of the widened ABEL criterion alone 
and p(BE-pe) is the power of the criterion ‘point estimate within acceptance 
range’ alone. p(BE-ABE) is the power of the conventional ABE test given for 
comparative purposes.
</p>


<h3>Designs</h3>

<p>Although some designs are more ‘popular’ than others, power calculations are valid for <em>all</em> of the following designs:
</p>

<table>
<tr>
<td style="text-align: left;">
    <code>"2x2x4"</code> </td>
<td style="text-align: left;"> TRTR | RTRT</td>
</tr>
<tr>
<td style="text-align: left;">
    </td>
<td style="text-align: left;"> TRRT | RTTR</td>
</tr>
<tr>
<td style="text-align: left;">
    </td>
<td style="text-align: left;"> TTRR | RRTT</td>
</tr>
<tr>
<td style="text-align: left;">
    <code>"2x2x3"</code> </td>
<td style="text-align: left;"> TRT | RTR</td>
</tr>
<tr>
<td style="text-align: left;">
    </td>
<td style="text-align: left;"> TRR | RTT</td>
</tr>
<tr>
<td style="text-align: left;">
    <code>"2x3x3"</code> </td>
<td style="text-align: left;"> TRR | RTR | RRT
  </td>
</tr>
</table>
<h3>Warning </h3>

<p>Cross-validation of the simulations as implemented here and via the ‘classical’ 
subject data simulation have shown somewhat unsatisfactory results for the 
2x3x3 design if the variabilities for Test and Reference are different and/or sequences exteremly unbalanced.<br>
The function <code>power.scABEL()</code> therefore gives a warning if calculations 
with different CVwT and CVwR are requested for the 2x3x3 partial replicate design. For <code>"EMA"</code> subject simulations are provided in <code>power.scABEL.sdsims</code>.
For more details see the above mentioned document <code style="white-space: pre;">⁠Implementation_scaledABE_simsVy.xx.pdf⁠</code>.
</p>


<h3>Note</h3>

<p>In case of <code>regulator="FDA"</code> the (empirical) power is only approximate since
the BE decision method is not exactly what is expected by the FDA. But the “Two Laszlós” state that the scABEL method should be ‘operational equivalent’ to the
FDA method.<br>
To get the power for the FDA favored method via linearized scaled ABE criterion
use function <code>power.RSABE</code>.<br><br>
In case of <code>regulator="HC"</code> (based on ISC), power is also only approximative since Health Canada recommends an evaluation via mixed model approach. This could only implemented via 
subject data simulations which are very time consuming. But ISC may be a good 
substitute.
</p>


<h3>Author(s)</h3>

<p>D. Labes
</p>


<h3>References</h3>

<p>Tóthfalusi L, Endrényi L. <em>Sample Sizes for Designing Bioequivalence Studies for Highly Variable Drugs.</em> J Pharm Pharmaceut Sci. 2011;15(1):73–84. 
<a href="https://ejournals.library.ualberta.ca/index.php/JPPS/article/download/11612/9489">open source</a>
</p>


<h3>See Also</h3>

<p><code>sampleN.scABEL, power.RSABE, reg_const</code>
</p>


<h3>Examples</h3>

<pre><code class="language-R"># using all the defaults:
# design="2x3x3", EMA regulatory settings
# PE constraint 0.8-1.25, cap on widening if CV&gt;0.5
# true ratio=0.90, 1E+6 simulations
power.scABEL(CV = 0.4, n = 29)
# should give:
# Unbalanced design. n(i)=10/10/9 assumed.
# [1] 0.66113
#
# with details=TRUE to view the computational time and components
power.scABEL(CV = 0.5, n = 54, theta0 = 1.15, details = TRUE)
# should give (times may differ depending on your machine):
# 1e+05sims. Time elapsed (sec): 0.07
# 
#      p(BE) p(BE-wABEL)    p(BE-pe)   p(BE-ABE) 
#    0.81727     0.82078     0.85385     0.27542
#
# exploring 'pure ABEL' with the EMA regulatory constant
# (without mixed method, without capping, without pe constraint)
rs           &lt;- reg_const("EMA")
rs$CVswitch  &lt;- 0
rs$CVcap     &lt;- Inf
rs$pe_constr &lt;- FALSE
power.scABEL(CV = 0.5, n = 54, theta0 = 1.15, regulator = rs)
# should give
# [1] 0.8519
</code></pre>


</div>