<div class="container">

<table style="width: 100%;"><tr>
<td>CalcFert</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>
Calculating Parametric Age-Specific Fertility.
</h2>

<h3>Description</h3>

<p><code>CalcFert</code> is used to calculate age-specific fertility from different parametric models.
</p>


<h3>Usage</h3>

<pre><code class="language-R">CalcFert(beta, x, modelFert = "quadratic", checkBeta = TRUE)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>beta </code></td>
<td>
<p>Numerical vector of age-specific fertility parameters (see details).</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>x </code></td>
<td>
<p>Numerical vector of ages at which to calculate fertility.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>modelFert </code></td>
<td>
<p>Age-specific fertility model. Options are “<code>quadratic</code>” (default), “<code>PeristeraKostaki</code>”, “<code>ColcheroMuller</code>”, “<code>Hadwiger</code>”, “<code>gamma</code>”, “<code>beta</code>”, “<code>skewNormal</code>”, “<code>gammaMixture</code>”, “<code>HadwigerMixture</code>”, “<code>skewSymmetric</code>”, “<code>skewLogistic</code>” (see details)</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>checkBeta </code></td>
<td>
<p>Logical to verify that the <code>beta</code> parameters conform with the model's specification (see details).</p>
</td>
</tr>
</table>
<h3>Details</h3>

<p><b>1) Age-specific fertility models:</b>
</p>
<p>The age-specific fertility models correspond to the expected number of offspring produced by adults of a given age. Therefore, for a random variable <code class="reqn">Y_{x}</code> with realizations <code class="reqn">y_x</code> for the number of offspring produced by adults of age <code class="reqn">x</code>, we have that <code class="reqn">E(Y_x) = g(x | \beta)</code>, where <code class="reqn">g: \mathbb{R}_{\ge 0} \rightarrow \mathbb{R}_{\ge 0}</code> is a non-negative smooth fertility function and <code class="reqn">\beta</code> is a vector of parameters to be estimated. The functional forms of function <code class="reqn">g</code> fall in two main categories, namely polynomial and distributional models.
</p>
<p>2.a) Polynomial:
</p>
<p>Of the models available in <code>paramDemo</code>, the “<code>quadratic</code>”, “<code>PeristeraKostaki</code>” (Peristera and Kostaki 2007), and “<code>ColcheroMuller</code>” (Colchero  <em>et al.</em> 2021, Muller <em>et al.</em> 2020) fall within the polynomial category. Both, the “<code>PeristeraKostaki</code>” and “<code>ColcheroMuller</code>” are non-symmetric around the age at maximum fertility.
</p>
<p>2.b) Distributional:
</p>
<p>The distributional models are of the form
</p>
<p style="text-align: center;"><code class="reqn">g(x | \beta) = R f(x | \beta_1),</code>
</p>

<p>where <code class="reqn">f: \mathbb{R}_{\ge 0} \rightarrow \mathbb{R}_{\ge 0}</code> is a probability density function, <code class="reqn">R &gt; 0</code> is a parameter for the total fertility rate, and <code class="reqn">\beta_1 \in \beta</code> is a vector of parameters. The
“<code>Hadwiger</code>” (Hadwiger 1940), “<code>gamma</code>” (Hoem <em>et al.</em> 1981), “<code>beta</code>”  (Hoem <em>et al.</em> 1981), “<code>skewNormal</code>” (Mazzuco and Scarpa 2011, 2015), “<code>gammaMixture</code>” (Hoem <em>et al.</em> 1981), “<code>HadwigerMixture</code>” (Chandola <em>et al.</em> 1991), “<code>skewSymmetric</code>” (Mazzuco and Scarpa 2011, 2015), and “<code>skewLogistic</code>” (Asili <em>et al.</em> 2014) all fall in this category. Notably, the “<code>gammaMixture</code>”, “<code>HadwigerMixture</code>”, “<code>skewSymmetric</code>”, “<code>skewLogistic</code>” are appropriate when fertility might be bimodal (Hoem <em>et al.</em> 1981, Chandola <em>et al.</em> 1999, Mazzuco and Scarpa 2011, 2015, Asili <em>et al.</em> 2014). 
</p>
<p><b>2) Specifying beta parameters:</b>
</p>
<p>Argument <code>beta</code> requires a vector of parameters. For instance, for a quadratic model with parameter vector <code class="reqn">\beta^{\top} = [0.5, 0.01, 10]</code>, the argument should be specified as <code>theta = c(b0 = 0.5, b1 = 0.01, b2 = 10)</code>. Note that in this example the parameter names are specified directly, this is required when <code>checkBeta = FALSE</code>. Although assigning the names to each parameter is not necessary when <code>checkBeta = TRUE</code>, it is advisable to ensure that the right values are assigned to the right parameter.  
</p>
<p>If argument <code>checkBeta</code> is set to <code>TRUE</code>, then the vector of <code>beta</code> parameters is verified for consistency with the requirements of the model and shape selected. 
</p>


<h3>Value</h3>

<p><code>CalcFert</code> returns a vector of class “<code>numeric</code>” with the fertility values at the specified ages.
</p>


<h3>Author(s)</h3>

<p>Fernando Colchero <a href="mailto:fernando_colchero@eva.mpg.de">fernando_colchero@eva.mpg.de</a></p>


<h3>References</h3>

<p>Asili, S., Rezaei, S. &amp; Najjar, L. (2014) Using Skew-Logistic Probability Density Function as a Model for Age-Specific Fertility Rate Pattern. <em>BioMed Research International</em>, 2014, 790294.
</p>
<p>Azzalini, A. (1985) A Class of Distributions Which Includes the Normal Ones. <em>Scandinavian Journal of Statistics</em>, 2, 171-178.
</p>
<p>Chandola, T., Coleman, D.A. &amp; Hiorns, R.W. (1999) Recent European fertility patterns: Fitting curves to ‘distorted’ distributions. <em>Population Studies</em>, 53, 317-329.
</p>
<p>Colchero, F. (<em>In prep.</em>) Inference on age-specific fertility in ecology and evolution. Learning from other disciplines and improving the state of the art. 
</p>
<p>Colchero, F., Eckardt, W. &amp; Stoinski, T. (2021) Evidence of demographic buffering in an endangered great ape: Social buffering on immature survival and the role of refined sex-age classes on population growth rate. <em>Journal of Animal Ecology</em>, 90, 1701-1713.
</p>
<p>Hadwiger, H. (1940) Eine analytische Reproduktionssunktion fur biologische Gesamtheiten. <em>Scandinavian Actuarial Journal</em>, 1940, 101-113.
</p>
<p>Hoem, J.M., Madien, D., Nielsen, J.L., Ohlsen, E.M., Hansen, H.O. &amp; Rennermalm, B. (1981) Experiments in modelling recent Danish fertility curves. <em>Demography</em>, 18, 231-244.
</p>
<p>Mazzuco, S. &amp; Scarpa, B. (2011) Fitting age-specific fertility rates by a skew- symmetric probability density function. (Working paper 10), University of Padua.
</p>
<p>Mazzuco, S. &amp; Scarpa, B. (2015) Fitting age-specific fertility rates by a flexible generalized skew normal probability density function. <em>Journal of the Royal Statistical Society: Series A</em>, 178, 187-203.
</p>
<p>Muller, M. N., Blurton Jones, N. G, Colchero, F., Thompson, M. E., Enigk, D. K. (2020) Sexual dimorphism in chimpanzee (<em>Pan troglodytes schweinfurthii</em>) and human age-specific fertility. <em>Journal of human evolution</em>, 144, 102795.
</p>
<p>Peristera, P. &amp; Kostaki, A. (2007) Modeling fertility in modern populations. <em>Demographic Research</em>, 16, 141-194.
</p>


<h3>See Also</h3>

<p><code>CalcMort</code> to calculate age-specific mortality, <code>CalcSurv</code> to calculate age-specific survival</p>


<h3>Examples</h3>

<pre><code class="language-R"># Age specific fertility based on quadratic model (default):
fert &lt;- CalcFert(beta = c(b0 = 0.5, b1 = 0.01, b2 = 10), x = 10)

# Age specific fertility based on gamma model:
fert &lt;- CalcFert(beta = c(b0 = 13, b1 = 2, b2 = 0.15), x = 10,
                  modelFert = "gamma")
</code></pre>


</div>