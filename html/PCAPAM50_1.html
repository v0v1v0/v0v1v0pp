<div class="container">

<table style="width: 100%;"><tr>
<td>makeCalls.ihc</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>Make a Conventional PAM50 Intrinsic Subtype Calls</h2>

<h3>Description</h3>

<p>This function processes clinical and preprocessed PAM50 expression data to form an
estrogen receptor (ER)-balanced set based on IHC classification. The ER-balanced set
is created by distinguishing between ER-negative and ER-positive cases, and
it produces conventional PAM50 intrinsic subtype calls.
</p>


<h3>Usage</h3>

<pre><code class="language-R">makeCalls.ihc(df.cln, seed=118, mat, inputDir=NULL)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>df.cln</code></td>
<td>
<p>Data frame of clinical data; It should include the columns 'PatientID' and 'IHC'.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>seed</code></td>
<td>
<p>Seed for random number generation to ensure reproducibility. Default is 118.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>mat</code></td>
<td>
<p>Matrix of preprocessed PAM50 expression data.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>inputDir</code></td>
<td>
<p>Directory for output files.If <code>NULL</code>, a subdirectory named "Calls.PAM50" within the temporary directory will be used.</p>
</td>
</tr>
</table>
<h3>Value</h3>

<p>Returns a list containing:
</p>
<table>
<tr style="vertical-align: top;">
<td><code>Int.sbs</code></td>
<td>
<p>Data frame with integrated subtype and clinical data.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>score.fl</code></td>
<td>
<p>Data frame with scores from subtype predictions.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>mdns.fl</code></td>
<td>
<p>Data frame with median values for each gene in the ER-balanced set.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>SBS.colr</code></td>
<td>
<p>Colors associated with each subtype from the prediction results.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>outList</code></td>
<td>
<p>Detailed results from subtype prediction functions.</p>
</td>
</tr>
</table>
<h3>See Also</h3>

<p><code>prcomp</code>, <code>merge</code>, <code>set.seed</code>
</p>


<h3>Examples</h3>

<pre><code class="language-R">
  data_path &lt;- system.file("extdata", "Sample_IHC_PAM_Mat.Rdat", package = "PCAPAM50")
  load(data_path) # Loads Test.ihc and Test.matrix


  # Prepare the data
  Test.ihc$ER_status &lt;- rep("NA", length(Test.ihc$PatientID))
  Test.ihc$ER_status[grep("^L",Test.ihc$IHC)] = "pos"
  Test.ihc$ER_status[-grep("^L",Test.ihc$IHC)] = "neg"
  Test.ihc &lt;- Test.ihc[order(Test.ihc$ER_status, decreasing = TRUE),]
  Test.matrix &lt;- Test.matrix[, Test.ihc$PatientID]


  df.cln &lt;- data.frame(PatientID = Test.ihc$PatientID, IHC = Test.ihc$IHC, stringsAsFactors = FALSE)


  

  # Call the function
  result &lt;- makeCalls.ihc(df.cln=df.cln, seed = 118, mat = Test.matrix, inputDir=NULL)

</code></pre>


</div>