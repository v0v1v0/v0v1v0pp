<div class="container">

<table style="width: 100%;"><tr>
<td>ancThresh</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>Ancestral character estimation under the threshold model using Bayesian MCMC</h2>

<h3>Description</h3>

<p>This function uses Bayesian MCMC to estimate ancestral states and thresholds for a discrete character under the threshold model from quantitative genetics (Felsenstein 2012).
</p>


<h3>Usage</h3>

<pre><code class="language-R">ancThresh(tree, x, ngen=100000, sequence=NULL, method="mcmc", 
   model=c("BM","OU","lambda"), control=list(), ...)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>tree</code></td>
<td>
<p>phylogenetic tree.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>x</code></td>
<td>
<p>a named vector containing discrete character states; or a matrix containing the tip species, in rows, and probabilities of being in each state, in columns.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>ngen</code></td>
<td>
<p>number of generations to run the MCMC.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>sequence</code></td>
<td>
<p>assumed ordering of the discrete character state. If not supplied and <code>x</code> is a vector then numerical/alphabetical order is assumed; if not supplied and <code>x</code> is a matrix, then the column order of <code>x</code> is used.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>method</code></td>
<td>
<p>only method currently available is <code>"mcmc"</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>model</code></td>
<td>
<p>model for the evolution of the liability. Options are <code>"BM"</code> (Brownian motion, the default), <code>"OU"</code> (Ornstein-Uhlenbeck), or <code>"lambda"</code> (the <code class="reqn">\lambda</code> model).</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>control</code></td>
<td>
<p>list containing the following elements: <code>sample</code>, the sampling interval; <code>propliab</code> variance of the proposal distribution for liabilities; <code>propthresh</code> variance on the proposal distribution for the thresholds; <code>propalpha</code> variance on the proposal distribution for <code>alpha</code> (for <code>model="OU"</code>); <code>pr.anc</code> prior probability distribution on the ancestral states for each node, in a matrix - not all nodes need to be supplied; <code>pr.th</code> prior density on the thresholds; <code>burnin</code> number of generations to exclude for burn-in when plotting posterior probabilities on the tree; <code>plot</code> logical value indicating whether or not to plot the posterior probabilities; <code>print</code> logical value indicating whether or not to print the state of the MCMC; <code>piecol</code> colors for the posterior probabilities plotted as pie charts at internal nodes; and <code>tipcol</code> which indicates whether the tip colors should be based on the input data (<code>"input"</code>) or sampled tip liabilities (<code>"estimated"</code>). These will only differ if there is uncertainty in the tip states.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>...</code></td>
<td>
<p>additional arguments to be passed to <code>plotThresh</code> (called internally).</p>
</td>
</tr>
</table>
<h3>Details</h3>

<p>According to the threshold model from evolutionary quantitative genetics, values for our observed discrete character are determined by an unseen continuous trait, normally referred to as liability. Every time the value for liability crosses a threshold, the observed discrete character changes in state.
</p>
<p>Felsenstein (2012) first had the insight that this model could be used to study the evolution of discrete character traits on a reconstructed phylogenetic tree.
</p>
<p>This function uses Bayesian MCMC to sample ancestral liabilities and thresholds for a discrete character evolution under the threshold model.
</p>
<p><code>print</code> and <code>plot</code> S3 methods are now available for the object class <code>"ancThresh"</code>.
</p>


<h3>Value</h3>

<p>This function returns an object of class <code>"ancThresh"</code> containing the posterior sample from our analysis, along with other components.
</p>


<h3>Author(s)</h3>

<p>Liam Revell <a href="mailto:liam.revell@umb.edu">liam.revell@umb.edu</a></p>


<h3>References</h3>

<p>Felsenstein, J. (2012) A comparative method for both discrete and continuous characters using the threshold model. <em>American Naturalist</em>, <b>179</b>, 145-156.
</p>
<p>Revell, L. J. (2014) Ancestral character estimation under the threshold model from quantitative genetics. <em>Evolution</em>, <b>68</b>, 743-759.
</p>
<p>Revell, L. J. (2024) phytools 2.0: an updated R ecosystem for phylogenetic comparative methods (and other things). <em>PeerJ</em>, <b>12</b>, e16505.
</p>


<h3>See Also</h3>

<p><code>anc.Bayes</code>, <code>threshBayes</code>
</p>


<h3>Examples</h3>

<pre><code class="language-R">## Not run: 
## load data from Revell &amp; Collar (2009)
data(sunfish.tree)
data(sunfish.data)
## extract character of interest
fmode&lt;-setNames(sunfish.data$feeding.mode,
    rownames(sunfish.data))
## run MCMC
mcmc&lt;-ancThresh(sunfish.tree,fmode,ngen=1000000)
## plot results
plot(mcmc,mar=c(0.1,0.1,4.1,0.1))
title(main="Posterior probabilities for node states",
    font.main=3)
## End(Not run)
</code></pre>


</div>