<div class="container">

<table style="width: 100%;"><tr>
<td>Bruvo2.distance</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>
Distance Measure of Bruvo et al. under Genome Loss and Addition
</h2>

<h3>Description</h3>

<p>This is an inter-individual distance measure similar to
<code>Bruvo.distance</code>, except that where genotypes have different
numbers of alleles, virtual alleles are equal to those from the longer
and/or shorter genotype, rather than being equal to infinity.
</p>


<h3>Usage</h3>

<pre><code class="language-R">Bruvo2.distance(genotype1, genotype2, maxl = 7, usatnt = 2,
                missing = -9, add = TRUE, loss = TRUE)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>genotype1</code></td>
<td>

<p>A numeric vector representing the genotype of one individual at one
locus.  This type of vector is produced by the <code>Genotype</code>
method for <code>"genambig"</code> objects.
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>genotype2</code></td>
<td>

<p>The second genotype for the distance calculation, in the same format as
<code>genotype1</code>.
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>maxl</code></td>
<td>

<p>The maximum number of alleles that either genotype can have.  If it is
exceeded, <code>NA</code> is returned.  This argument exists to prevent
computations that would take in excess of an hour; see
<code>Bruvo.distance</code>.
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>usatnt</code></td>
<td>

<p>The microsatellite repeat type for the locus.  <code>2</code> for dinucleotide
repeats, <code>3</code> for dinucleotide repeats, <code>1</code> if the alleles are
already coded as repeat numbers, etc.  See <code>Usatnts</code>.
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>missing</code></td>
<td>

<p>The symbol that indicates missing data for a given sample and locus.
See <code>Missing</code>.
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>add</code></td>
<td>

<p><code>TRUE</code> if the model of genome addition is being used, and
<code>FALSE</code> if it is not.  If this model is used, the shorter genotype
will have virtual alleles added from the same genotype.
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>loss</code></td>
<td>

<p><code>TRUE</code> if the model of genome loss is being used, and <code>FALSE</code>
if it is not.  If this model is used, the shorter genotype will have
virtual alleles added from the longer genotype.
</p>
</td>
</tr>
</table>
<h3>Details</h3>

<p>Bruvo <em>et al.</em> (2004) describe multiple methods for calculating
genetic distances between individuals of different ploidy.  (See
“Special cases” starting on page 2102 of the paper.)  The
original <code>Bruvo.distance</code> function in <span class="pkg">polysat</span> uses the method
described for systems with complex changes in ploidy, adding virtual
alleles equal to infinity to the shorter genotype to make it the same
length as the longer genotype.  This method, however, can exaggerate
distances between individuals of different ploidy, particularly when
used with <code>meandistance.matrix2</code> as opposed to
<code>meandistance.matrix</code>.
</p>
<p><code>Bruvo2.distance</code> calculates distances between individuals under
the models of genome addition and genome loss.  If <code>add = TRUE</code> and
<code>loss = TRUE</code>, the distance produced is equal to that of equation 6
in the paper.
</p>
<p>If <code>add = TRUE</code> and <code>loss = FALSE</code>, the distance calculated is
that under genome addition only.  Likewise if <code>add = FALSE</code> and
<code>loss = TRUE</code> the distance is calculated under genome loss only.
The latter distance should be greater than the former.  If both were averaged
together, they would give the identical result to that produced when
<code>add = TRUE</code> and <code>loss = TRUE</code>.  All three distances will be
less than that produced by <code>Bruvo.distance</code>.
</p>
<p>If both genotypes have the same number of alleles, they are passed to
<code>Bruvo.distance</code> for the calculation.  This also happens if
<code>add = FALSE</code> and <code>loss = FALSE</code>.  Otherwise, if the genotypes have
different numbers of alleles, all possible genotypes with virtual
alleles are enumerated and passed to <code>Bruvo.distance</code> one by one, and
the results averaged.
</p>
<p>The number of different genotypes simulated under genome loss or genome
addition is <code class="reqn">l^d</code>, where <code class="reqn">l</code> is the length of the genotype from
which virtual alleles are being taken, and <code class="reqn">d</code> is the difference in
length between the longer and shorter genotype.  For example, under
genome addition for a diploid individual with alleles 1 and 2 being
compared to a tetraploid individual, the genotypes 1211, 1212, 1221, and
1222 will each be used once to represent the diploid individual.
</p>


<h3>Value</h3>

<p>A decimal between 0 and 1, with 0 indicating complete identity of two
genotypes, and 1 indicating maximum dissimilarity.  <code>NA</code> is
returned if one or both genotypes are missing or if <code>maxl</code> is exceeded.
</p>


<h3>Note</h3>

<p>Figure 1B and 1C of Bruvo <em>et al.</em> (2004) illustrate an example of
this distance measure.  To perform the identical calculation to that
listed directly under equation 6, you would type:
</p>
<p><code>Bruvo2.distance(c(20,23,24), c(20,24,26,43), usatnt=1)</code>
</p>
<p>However, you will notice that the result, 0.401, is slightly different from that
given in the paper.  This is due to an error in the paper.  For the
distance under genome loss when the virtual allele is 26, the result
should be 1 instead of 1.75.
</p>


<h3>Author(s)</h3>

<p>Lindsay V. Clark
</p>


<h3>References</h3>

<p>Bruvo, R., Michiels, N. K., D'Sousa, T. G., and Schulenberg, H. (2004)
A simple method for calculation of microsatellite genotypes
irrespective of ploidy level. <em>Molecular Ecology</em> <b>13</b>, 2101–2106.
</p>


<h3>See Also</h3>

<p><code>Lynch.distance</code>, <code>Bruvo.distance</code>,
<code>meandistance.matrix2</code>
</p>


<h3>Examples</h3>

<pre><code class="language-R">Bruvo2.distance(c(102,104), c(104,104,106,110))
Bruvo2.distance(c(102,104), c(104,104,106,110), add = FALSE)
Bruvo2.distance(c(102,104), c(104,104,106,110), loss = FALSE)
</code></pre>


</div>