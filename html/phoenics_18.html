<div class="container">

<table style="width: 100%;"><tr>
<td>test_pathway</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>Pathway differential analysis based on longitudinal metabolomics data</h2>

<h3>Description</h3>

<p>Perform a differential analysis at pathway level based on 
metabolite quantifications and information on pathway metabolite composition.
The method relies on a PCA step.
</p>


<h3>Usage</h3>

<pre><code class="language-R">test_pathway(
  quantif,
  design,
  pathways = "auto",
  fixed,
  random,
  npc = 1L,
  model = c("lmer", "blmer"),
  organism = NULL,
  min_size = 2
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>quantif</code></td>
<td>
<p>data.frame or matrix of the metabolite quantification with 
samples in rows (sample identifiers must be row names) and metabolites in 
columns (metabolite codes must be column names)</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>design</code></td>
<td>
<p>data.frame or matrix with samples in rows (sample identifiers
must be row names) and the different effects to be included in the model
in columns. Column names must be provided and are used as arguments for
<code>fixed</code> and <code>random</code></p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>pathways</code></td>
<td>
<p>data.frame or matrix with metabolites in rows (all 
metabolites in columns of <code>quantif</code> must have a row in this input) and the
following information in columns: </p>

<ul>
<li> <p><code>metabolite_code</code> metabolite code
</p>
</li>
<li> <p><code>metabolite_name</code> metabolite name
</p>
</li>
<li> <p><code>pathway_code</code> pathway code (identifier)
</p>
</li>
<li> <p><code>pathway_name</code> name of the pathway
</p>
</li>
</ul>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>fixed</code></td>
<td>
<p>character vector of fixed effects to be included in the model.
They must correspond to column names of <code>design</code></p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>random</code></td>
<td>
<p>character vector of random effects to be included in the model.
They must correspond to column names of <code>design</code></p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>npc</code></td>
<td>
<p>number of PCs for the PCA step</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>model</code></td>
<td>
<p>a character string indicating if the model has to be fitted
using lmer or blmer. Default to <code>"lmer"</code></p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>organism</code></td>
<td>
<p>organism code in KEGG database. Required if
<code>pathways = "auto"</code> and ignored otherwise</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>min_size</code></td>
<td>
<p>minimal number of metabolites in a pathway. Required if
<code>pathways = "auto"</code> and ignored otherwise. Default to <code>2</code></p>
</td>
</tr>
</table>
<h3>Details</h3>

<p>If <code>pathways = "auto"</code>, information on pathways in which metabolites are
present is automatically obtained by the function pathway_search using
<code>KEGGREST</code> that queries KEGG database. Results are specific to a given
organism (passed in <code>organism</code>). Pathways containing less than
<code>min_size</code> metabolites are filtered out.
</p>


<h3>Value</h3>

<p>an object of class <code>pathwayRes</code> which is a list of pathway 
results. Each element of the list contain the following entries:
</p>
<table>
<tr style="vertical-align: top;">
<td><code>pathway_name</code></td>
<td>
<p>a character corresponding to the pathway name</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>pathway_code</code></td>
<td>
<p>a character corresponding to the pathway code</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>metabolites</code></td>
<td>
<p>a data.frame with the names and codes of the quantified
metabolites in the pathway</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>PCA</code></td>
<td>
<p>the result of the pathway PCA (a <code>PCA</code> object as obtained 
from PCA)</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>model</code></td>
<td>
<p>the output of the mixed model fit</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>test_pathway</code></td>
<td>
<p>a data.frame with the p-values for each tested fixed
effect</p>
</td>
</tr>
</table>
<h3>Author(s)</h3>

<p>Camille Guilmineau &lt;camille.guilmineau@inrae.fr&gt;<br>
Remi Servien &lt;remi.servien@inrae.fr&gt;<br>
Nathalie Vialaneix &lt;nathalie.vialaneix@inrae.fr&gt;
</p>


<h3>See Also</h3>

<p>pathway_search for the automatic annotation of metabolites in KEGG 
pathways.
</p>


<h3>Examples</h3>

<pre><code class="language-R">data("MTBLS422")
quantif &lt;- from_ASICS_to_PHOENICS(quantif)
out_test &lt;- test_pathway(quantif, design, pathways, 
                         fixed = c("Age", "Treatment"), random = "Mouse", 
                         npc = 2, model = "blmer")
out_test

if (requireNamespace("KEGGREST", quietly = TRUE)) { 

  out_test2 &lt;- test_pathway(quantif, design, pathways = "auto", 
                            fixed = c("Age", "Treatment"), random = "Mouse", 
                            npc = 2, model = "blmer", organism = "mmu")
  out_test2
 
}

</code></pre>


</div>