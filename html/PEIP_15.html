<div class="container">

<table style="width: 100%;"><tr>
<td>gcval</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>Get c-val
</h2>

<h3>Description</h3>

<p> Extract the smallest regularization parameter.
</p>


<h3>Usage</h3>

<pre><code class="language-R">gcval(U, s, b, npoints)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>U</code></td>
<td>
<p>U matrix from gsvd(G, L)
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>s</code></td>
<td>
<p>[diag(C) diag(S)] which are the lambdas and mus from the gsvd
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>b</code></td>
<td>
<p>the data to try and match
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>npoints</code></td>
<td>
<p>number of alphas to estimate
</p>
</td>
</tr>
</table>
<h3>Details</h3>

<p>Evaluate the GCV function gcv_function at npoints points.
</p>


<h3>Value</h3>

<p>List:
</p>
<table>
<tr style="vertical-align: top;">
<td><code>reg_min</code></td>
<td>
<p> alpha with the minimal g (scalar)</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>g </code></td>
<td>
<p> || Gm_(alpha,L) - d ||^2 / (Tr(I - GG#)^2</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>alpha</code></td>
<td>
<p>alpha for the corresponding g</p>
</td>
</tr>
</table>
<h3>Author(s)</h3>

<p>Jonathan M. Lees&lt;jonathan.lees@unc.edu&gt;
</p>


<h3>See Also</h3>

<p>gcv_function
</p>


<h3>Examples</h3>

<pre><code class="language-R">
set.seed(2015)
VSP = vspprofile()
t = VSP$t2
G = VSP$G
M = VSP$M
N = VSP$N

L1 = get_l_rough(N,1);
littleU = PEIP::GSVD(as.matrix(G), as.matrix(L1) );

BIGU = flipGSVD(littleU, dim(G), dim(L1) )

U1 = BIGU$U
V1 =BIGU$V
X1=BIGU$X
Lam1=BIGU$C
M1=BIGU$S

lam=sqrt(diag(t(Lam1 %*% Lam1)));

mu=sqrt(diag(t(M1)%*%M1));

p=rnk(L1);

sm1=cbind(lam[1:p],mu[1:p])

### % get the gcv values varying alpha

###
ngcvpoints=1000;

HI = gcval(U1,sm1,t,ngcvpoints);



</code></pre>


</div>