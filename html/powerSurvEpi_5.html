<div class="container">

<table style="width: 100%;"><tr>
<td>powerConLogistic.bin</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>
Sample Size Calculation for Conditional Logistic Regression with Binary Covariate
</h2>

<h3>Description</h3>

<p>Sample Size Calculation for Conditional Logistic Regression with Binary Covariate, such as matched logistic regression or nested case-control study.
</p>


<h3>Usage</h3>

<pre><code class="language-R">powerConLogistic.bin(
  N = NULL, 
  power = 0.8, 
  OR, 
  pE, 
  nD, 
  nH, 
  R2 = 0, 
  alpha = 0.05, 
  nTests = 1,
  OR.low = 1.01,
  OR.upp = 100
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>N</code></td>
<td>

<p>integer. Number of sets. Each set contains <code>nD</code> cases and <code>nH</code> controls.  
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>power</code></td>
<td>

<p>numeric. Power of the test for if the exposure variable is associated with the risk of diseases
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>OR</code></td>
<td>

<p>numeric. Odds ratio <code class="reqn">=exp(\theta)</code>, where <code class="reqn">\theta</code> is the 
regression coefficient of the exposure variable.
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>pE</code></td>
<td>

<p>numeric. Population prevalence of exposure.
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>nD</code></td>
<td>

<p>integer. Number of cases per set.
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>nH</code></td>
<td>

<p>integer. Number of controls per set.
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>R2</code></td>
<td>

<p>numeric. Coefficient of determination of the exposure variable and other covariates
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>alpha</code></td>
<td>

<p>numeric. family-wise type I error rate.
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>nTests</code></td>
<td>

<p>integer. Number of tests.
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>OR.low</code></td>
<td>

<p>numeric. Lower bound of odds ratio. Only used when <code>OR=NULL</code> and <code>power</code> and <code>N</code> are not equal to NULL.
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>OR.upp</code></td>
<td>

<p>numeric. Upper bound of odds ratio. Only used when <code>OR=NULL</code> and <code>power</code> and <code>N</code> are not equal to NULL.
</p>
</td>
</tr>
</table>
<h3>Details</h3>

<p>The power and sample size calculation formulas are provided by Lachin (2008, Section 3.3, Formula (38))
</p>
<p style="text-align: center;"><code class="reqn">power = \Phi\left( \sqrt{N c} - z_{\alpha/(2 nTests)}\right)</code>
</p>

<p>and
</p>
<p style="text-align: center;"><code class="reqn">N = (z_{power} + z_{\alpha/(2 nTests)})^2/ c</code>
</p>

<p>where <code class="reqn">\Phi</code> is the cumulative distribution function of the 
standard normal distribution <code class="reqn">N(0, 1)</code>, <code class="reqn">z_{a}</code> is the upper <code class="reqn">100 a</code>-th
percentile of <code class="reqn">N(0, 1)</code>,
</p>
<p style="text-align: center;"><code class="reqn">c = \theta^2 pE (1-pE) (1-R^2)nD*nH/(nD+nH)</code>
</p>

<p>and <code class="reqn">R^2</code> is the coefficient of determination for linear regression
linking the exposure with other covariates.
</p>


<h3>Value</h3>

<p>If the inputs <code>is.null(N) = TRUE</code> and <code>is.null(power) = FALSE</code>, 
then the function returns the number <code>N</code> of sets.
</p>
<p>If the inputs <code>is.null(N) = FALSE</code> and <code>is.null(power) = TRUE</code>, 
then the function returns the power. 
</p>
<p>Otherwise, an error message is output.
</p>


<h3>References</h3>

<p>Lachin, JM
Sample Size Evaluation for a Multiply Matched Case-Control Study Using the Score Test From a Conditional Logistic (Discrete Cox PH) Regression Model.
Stat Med. 2008 27(14): 2509-2523
</p>


<h3>Examples</h3>

<pre><code class="language-R">
# estimate power
power = powerConLogistic.bin(
  N = 59, 
  power = NULL, 
  OR = 3.5, 
  pE = 0.15, 
  nD = 1, 
  nH = 2, 
  R2 = 0, 
  alpha = 0.05, 
  nTests = 1)

print(power) # 0.80

# estimate N (number of sets)
N = powerConLogistic.bin(
  N = NULL, 
  power = 0.80, 
  OR = 3.5, 
  pE = 0.15, 
  nD = 1, 
  nH = 2, 
  R2 = 0, 
  alpha = 0.05, 
  nTests = 1)

print(ceiling(N)) # 59

# estimate OR
OR = powerConLogistic.bin(
  N = 59, 
  power = 0.80, 
  OR = NULL, 
  pE = 0.15, 
  nD = 1, 
  nH = 2, 
  R2 = 0, 
  alpha = 0.05, 
  nTests = 1,
  OR.low = 1.01,
  OR.upp = 100)

print(OR) # 3.49



</code></pre>


</div>