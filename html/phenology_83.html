<div class="container">

<table style="width: 100%;"><tr>
<td>Tagloss_model</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>Return the daily rate of tag loss.</h2>

<h3>Description</h3>

<p>This function compute a model of daily tag loss rate for days t
based on a set of parameters, par or a fitted tag loss model in x.<br>
Parameters are described in <code>Tagloss_fit</code>.
</p>


<h3>Usage</h3>

<pre><code class="language-R">Tagloss_model(
  t = NULL,
  par = NULL,
  Hessian = NULL,
  mcmc = NULL,
  model_before = NULL,
  model_after = NULL,
  model = stop("You must specify which tag loss rate you want."),
  method = NULL,
  replicates = NULL,
  x = NULL
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>t</code></td>
<td>
<p>Time for which values of model must be estimated</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>par</code></td>
<td>
<p>Parameters</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>Hessian</code></td>
<td>
<p>Hessian matrix of parameters</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>mcmc</code></td>
<td>
<p>A mcmc result</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>model_before</code></td>
<td>
<p>Function to be used before estimation of daily tagloss rate</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>model_after</code></td>
<td>
<p>Function to be used after estimation of daily tagloss rate</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>model</code></td>
<td>
<p>The model of parameter to be used, can be 1, 2, L1, L2, R1 or R2</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>method</code></td>
<td>
<p>Can be NULL, "delta", "SE", "Hessian", "MCMC", or "PseudoHessianFromMCMC"</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>replicates</code></td>
<td>
<p>Number of replicates to estimate se of output</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>x</code></td>
<td>
<p>A Tagloss fitted model</p>
</td>
</tr>
</table>
<h3>Details</h3>

<p>Tagloss_model returns the daily rate of tag loss.
</p>


<h3>Value</h3>

<p>Return the daily rate of tag loss if hessian is null or a data.frame with distribution of daily rate of tag loss if hessian is not null.
</p>


<h3>Author(s)</h3>

<p>Marc Girondot <a href="mailto:marc.girondot@gmail.com">marc.girondot@gmail.com</a>
</p>


<h3>See Also</h3>

<p>Other Model of Tag-loss: 
<code>Tagloss_L()</code>,
<code>Tagloss_LengthObs()</code>,
<code>Tagloss_cumul()</code>,
<code>Tagloss_daymax()</code>,
<code>Tagloss_fit()</code>,
<code>Tagloss_format()</code>,
<code>Tagloss_mcmc()</code>,
<code>Tagloss_mcmc_p()</code>,
<code>Tagloss_simulate()</code>,
<code>logLik.Tagloss()</code>,
<code>o_4p_p1p2</code>,
<code>plot.Tagloss()</code>,
<code>plot.TaglossData()</code>
</p>


<h3>Examples</h3>

<pre><code class="language-R">## Not run: 
library(phenology)

# Example
t &lt;- 1:1000
par &lt;- c(D1=200, D2D1=100, D3D2=200, 
         A=-logit(0.02), B=-logit(0.05), C=-logit(0.07))
y &lt;- Tagloss_model(t, par, model="1")
plot(x=t, y, type="l")
par &lt;- c(D1_1=200, D2D1_1=100, D3D2_1=200, 
         A_1=-logit(0.02), B_1=-logit(0.05), C_1=-logit(0.07))
y &lt;- Tagloss_model(t, par, model="1")
phenology:::plot.Tagloss(x=list(), t=1:1000, fitted.parameters=par, model="1")

# Fig1A in Rivalan et al. 2005 (note an error for a0; a0 must be negative)
par &lt;- c(a0=-1E5, a1=-2000, a2=0, a3=2*max(t), a4=0.1)
y &lt;- Tagloss_model(t, par)
plot(x=t, y, type="l")

# Fig1B in Rivalan et al. 2005
par &lt;- c(a0=-0.5, a1=-2000, a2=-0.001, a3=0, a4=0.1)
y &lt;- Tagloss_model(t, par)
plot(x=t, y, type="l")

# Fig1C in Rivalan et al. 2005
par &lt;- c(a0=-1, a1=-6, a2=0, a3=0, a4=0)
y &lt;- Tagloss_model(t, par)
plot(x=t, y, type="l")

# Fig1D in Rivalan et al. 2005
par &lt;- c(a0=-1, a1=-6, a2=0, a3=0, a4=0.1)
y &lt;- Tagloss_model(t, par)
plot(x=t, y, type="l")

# Fig1E in Rivalan et al. 2005
par &lt;- c(a0=-0.1, a1=-10, a2=-0.2, a3=60, a4=0.1)
y &lt;- Tagloss_model(t, par)
plot(x=t, y, type="l")

# Fig1F in Rivalan et al. 2005
par &lt;- c(a0=-0.1, a1=-10, a2=0.2, a3=60, a4=0.1)
y &lt;- Tagloss_model(t, par)
plot(x=t, y, type="l")

# Example with fitted data
data_f_21 &lt;- Tagloss_format(outLR, model="21")
# Without the N20 the computing is much faster
data_f_21_fast &lt;- subset(data_f_21, subset=(is.na(data_f_21$N20)))
par &lt;- c('D1_2' = 49.086835072129126, 
         'D2D1_2' = 1065.0992647723231, 
         'D3D2_2' = 6.15531475922079, 
         'A_2' = 5.2179675647973758, 
         'B_2' = 8.0045560376751386, 
         'C_2' = 8.4082505219581876, 
         'D1_1' = 177.23337287498103, 
         'D2D1_1' = 615.42690323741033, 
         'D3D2_1' = 2829.0806609455867, 
         'A_1' = 28.500118091731551, 
         'B_1' = 10.175426055942701, 
         'C_1' = 6.9616630417169398)
o &lt;- Tagloss_fit(data=data_f_21_fast, fitted.parameters=par)
t &lt;- 1:10
y &lt;- Tagloss_model(t, o$par, model="1")
y &lt;- Tagloss_model(t, x=o, method=NULL, model="1")
y &lt;- Tagloss_model(t, x=o, method="Hessian", model="1", replicates=1000)

## End(Not run)
</code></pre>


</div>