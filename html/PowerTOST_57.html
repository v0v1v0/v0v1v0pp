<div class="container">

<table style="width: 100%;"><tr>
<td>power.TOST.sds</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>
Power calculation of the BE decision with models incorporating groups
</h2>

<h3>Description</h3>

<p>The power is obtained via subject data simulations.<br>
Three models are implemented:
</p>

<ul>
<li>
<p> gmodel==1 is full FDA model for testing group-by-treatment interaction
followed by gmodel==2 or gmodel==3 with data of the biggest group
depending on the test of the treatment by group interaction
</p>
</li>
<li>
<p> gmodel==2 is full FDA model but without group-by-treatment interaction
</p>
</li>
<li>
<p> gmodel==3 is model with pooled groups, i.e. without any group term
</p>
</li>
</ul>
<h3>Usage</h3>

<pre><code class="language-R">power.TOST.sds(alpha = 0.05, theta1, theta2, theta0, CV, n, 
               design = c("2x2", "2x2x2", "2x3x3", "2x2x4", "2x2x3"),
               design_dta = NULL, grps = 2, ngrp = NULL, gmodel = 2, p.level=0.1,
               nsims = 1e+05, details = FALSE, setseed = TRUE, progress)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>alpha</code></td>
<td>

<p>Type I error probability, significance level. Conventionally mostly set to 0.05.
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>theta1</code></td>
<td>

<p>Lower BE limit. Defaults to 0.8 if not given explicitely.
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>theta2</code></td>
<td>

<p>Upper BE limit. Defaults to 1.25 if not given explicitely.
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>theta0</code></td>
<td>

<p>‘True’ or assumed T/R ratio. <br>
Defaults to 0.95 if not given explicitly.
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>CV</code></td>
<td>

<p>Intra-subject coefficient(s) of variation as ratio (not percent).
</p>

<ul>
<li>
<p> If given as a scalar (<code>length(CV)==1</code>) the <em>same</em> CV of Test
and Reference is assumed (homoscedasticity, <code>CVwT==CVwR</code>).
</p>
</li>
<li>
<p> If given as a vector (<code>length(CV)==2</code>), <em>i.e.</em>, assuming
heteroscedasticity, the CV of the Test <strong>must</strong> be given in 
<code>CV[1]</code> and the one of the Reference in the <code>CV[2]</code>.
</p>
</li>
</ul>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>n</code></td>
<td>

<p>Number of subjects under study.<br>
May be given as vector. In that case it is assumed that <code>n</code> contains the number
of subjects in the sequence groups.<br>
If <code>n</code> is given as single number (total sample size) and this number is not 
divisible by the number of sequences of the design an unbalanced design is 
assumed. A corresponding message is thrown showing the numbers of subjects 
in sequence groups.<br>
Attention! In case of the <code>"2x2x3"</code> (TRT|RTR) design the order of sample sizes is important 
if given as vector. <code>n[1]</code> is for sequence group 'TRT' and <code>n[2]</code> is for 
sequence group 'RTR'. 
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>design</code></td>
<td>

<p>Design of the study to be planned.<br><code>"2x2"</code> or <code>"2x2x2"</code> is the conventional cross-over design.<br><code>"2x3x3"</code> is the partial replicate design (TRR|RTR|RRT).<br><code>"2x2x4"</code> is the full replicate design with 2 sequences and 4 periods.<br><code>"2x2x3"</code> is the 3-period design with sequences TRT|RTR.<br>
Defaults to <code>design="2x2"</code>.
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>design_dta</code></td>
<td>

<p>Alternatively to using the arguments <code>design</code> and <code>n</code> the design may 
be defined via a data.frame with columns <code>subject, sequence, period</code> and
<code>tmt</code>. This feature is experimental in the sense that the data.frame is
not checked for complying with the assumed structure.<br>
If you use the argument <code>design_dta</code> you don't need to specify the arguments
<code>design</code> and <code>n</code>.<br>
The default <code>design_dta = NULL</code> means that <code>design</code> and <code>n</code> are used
for the internal construction of the design data.frame.
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>grps</code></td>
<td>

<p>Number of (logistical) groups. Defaults to 2.
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>ngrp</code></td>
<td>

<p>Vector of number of subjects in groups.
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>gmodel</code></td>
<td>

<p>Number describing the model incorporating group effects
</p>

<ul>
<li> <p><code>gmodel=1</code> is full FDA model for testing group-by-treatment interaction
followed by <code>gmodel=2</code> or <code>gmodel=3</code> with data of the biggest group
depending on the test of the treatment by group interaction
</p>
</li>
<li> <p><code>gmodel=2</code> is full FDA model but without group-by-treatment interaction
</p>
</li>
<li> <p><code>gmodel=3</code> is model with pooled groups, i.e. without any group term
</p>
</li>
</ul>
<p>Defaults to <code>gmodel=2</code>.
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>p.level</code></td>
<td>
<p>Significance level of the test of a group-by-treatment interaction.
Defaults to <code>p.level=0.1</code>.
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>nsims</code></td>
<td>

<p>Number of simulations to be performed to obtain the empirical power.
Defaults to 100,000 = 1e+05.<br>
If simulations are aimed for empirical alpha <code>nsims=1e+06</code> is recommended.
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>details</code></td>
<td>

<p>If set to <code>TRUE</code> the computational time is shown.
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>setseed</code></td>
<td>

<p>Simulations are dependent on the starting point of the (pseudo) random number 
generator. To avoid differences in power for different runs a <code>set.seed(123456)</code> 
is issued if <code>setseed=TRUE</code>, the default. 
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>progress</code></td>
<td>

<p>Should a progressbar be shown? Defaults to <code>TRUE</code> if missing and nsims &gt;5E5.
</p>
</td>
</tr>
</table>
<h3>Details</h3>

<p>The power is calculated via subject data sims.<br>
The evaluation of BE is done via 1-2*alpha confidence interval using classical ANOVA
for the models with group effects.<br>
The data.frame with columns  <code>subject, sequence, period</code> and <code>tmt</code> 
necessary for evaluation of simulated subject data is constructed internally from 
the arguments <code>design</code> and <code>n</code> or may be given user defined via the argument 
<code>design_dta</code>. The last option is usefull if missing data have to be considered
or if designs have to be evaluated which are not in the list of argument 
<code>design</code>.<br>
This feature is experimental in the sense that the data.frame is not checked 
for complying with the assumed structure.<br><br>
The p.value of the test of the group-by-treatment interaction in case of <code>gmodel=1</code> <br>
defaults to <code>p.level = 0.1</code>, the value originally used by the FDA. Later on a value of 
<code>p.level = 0.05</code> was used.
</p>
<p>If the group-by-treatment interaction is significant the subsequent BE decision 
is done with the data of the largest group. If there are more than one with the same size, one gets a warning that this feature – showing BE in all that groups – is not implemented yet.
Only the first of the largest groups is tested for BE.
</p>


<h3>Value</h3>

<p>Returns the value of the (empirical) power
</p>


<h3>Note</h3>

<p>The run time of the function may be relatively long.<br>
Take a cup of coffee and be patient.
</p>


<h3>Author(s)</h3>

<p>D. Labes
</p>


<h3>References</h3>

<p>Schütz H. <br><em>Multi-Group Studies in Bioequivalence. To pool or not to pool?</em><br>
Presentation at BioBriges 2018, Prague. <a href="https://bebac.at/lectures/Prague2018.pdf">https://bebac.at/lectures/Prague2018.pdf</a>
</p>


<h3>Examples</h3>

<pre><code class="language-R"># power for gmodel=2, 2x2 crossover, grps=3 with even number of subjects
power.TOST.sds(CV=0.2, n=18, grps=3)
# gives [1] 0.78404
# without considering groups
power.TOST.sds(CV=0.2, n=18, gmodel=3)
# gives [1] 0.7887
</code></pre>


</div>