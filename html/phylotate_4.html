<div class="container">

<table style="width: 100%;"><tr>
<td>parse_annotated</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>Parse an annotated phylogenetic tree</h2>

<h3>Description</h3>

<p>This function takes the given text string, containing data in either
NEXUS or Newick format, and returns annotated phylogenetic trees.
</p>


<h3>Usage</h3>

<pre><code class="language-R">parse_annotated(str, format="nexus")
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>str</code></td>
<td>
<p>a text string, containing tree data</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>format</code></td>
<td>
<p>a format specifier; either <code>"nexus"</code> or <code>"newick"</code></p>
</td>
</tr>
</table>
<h3>Details</h3>

<p>The given file text is parsed and a tree object is constructed which
can be used with the functions in the <span class="pkg">ape</span> package. Annotations
of the kind produced by, for example, MrBayes, are parsed and
preserved in the returned object.
</p>
<p>In addition to <code>edge</code>, <code>edge.length</code> and <code>tip.label</code>,
two additional vectors are added. These are <code>node.comment</code> and
<code>node.distance.comment</code>. These contain annotations associated
with nodes and their distance values. These arrays are indexed by node
number, not by edge. The reason for this is that this ensures that the
object will remain in a valid state after a call to <code>reorder</code>
which might change the ordering of the edge arrays without being aware
of annotations. If you need to obtain annotations in edge-order,
subset by the second column of the <code>edge</code> array.
</p>


<h3>Value</h3>

<p>an object of type <code>"phylo"</code> or <code>"multiPhylo"</code>, augmented with
node annotations.
</p>


<h3>Author(s)</h3>

<p>Daniel Beer <a href="mailto:dlbeer@gmail.com">dlbeer@gmail.com</a></p>


<h3>References</h3>

<p>Paradis, E. Definition of Formats for Coding Phylogenetic Trees in R.
<a href="http://ape-package.ird.fr/misc/FormatTreeR_24Oct2012.pdf">http://ape-package.ird.fr/misc/FormatTreeR_24Oct2012.pdf</a>
</p>


<h3>See Also</h3>

<p><code>print_annotated</code>,
<code>read_annotated</code>,
<code>write_annotated</code>,
<code>finches</code>
</p>


<h3>Examples</h3>

<pre><code class="language-R">  # Parse the example data included with this package
  data(finches)
  t &lt;- parse_annotated(finches, format="nexus")

  # Obtain annotations in edge-order, rather than node-order
  edge.comment &lt;- t$node.comment[t$edge[,2]]
</code></pre>


</div>