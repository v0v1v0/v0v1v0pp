<div class="container">

<table style="width: 100%;"><tr>
<td>PlatypusDB_VGM_to_AIRR</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>Platypus V3 VGM to AIRR compatibility function</h2>

<h3>Description</h3>

<p>Exports AIRR compatible tables supplemented with VDJ and GEX information from the Platypus VGM object and the cellranger output airr_rearrangements.tsv
</p>


<h3>Usage</h3>

<pre><code class="language-R">PlatypusDB_VGM_to_AIRR(
  VGM,
  VDJ.features.to.append,
  GEX.features.to.append,
  airr.rearrangements,
  airr.integrate
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>VGM</code></td>
<td>
<p>Output object of the VDJ_GEX_matrix function generated with VDJ.combine = T, GEX.combine = T (to merge all samples) and integrate.VDJ.to.GEX = T (to integrate VDJ and GEX data)</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>VDJ.features.to.append</code></td>
<td>
<p>Character vector. Defaults to "none". Can be either "all" or column names of the VGM VDJ matrix (VGM[[1]]) to append to the AIRR compatible table.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>GEX.features.to.append</code></td>
<td>
<p>Character vector. Defaults to "none". Can be either "all" or GEX metadata column names or Gene names of the VGM GEX object (VGM[[2]])(passed to Seurat::FetchData()) to append to the AIRR compatible table. For a list of available features run: names(VGM[[2]]@meta.data) and rownames(VGM[[2]])</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>airr.rearrangements</code></td>
<td>
<p>Source of the airr_rearrangements.tsv file as generated by Cellranger. There are 3 available input options: 1. R list object from Platypus_DB_load_from_disk or Platypus_DB_fetch / 2. List with local paths to airr_rearrangements.tsv / 3. List of airr_rearrangements.tsv loaded in as R objects within the current R enviroment. ! Order of input list must be identical to that of sample_ids in the VGM ! If not provided or set to "none" CIGAR strings in output will be empty.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>airr.integrate</code></td>
<td>
<p>Boolean. Defaults to TRUE, whether to integrate output AIRR tables</p>
</td>
</tr>
</table>
<h3>Value</h3>

<p>A list of length of samples in VGM containing a AIRR-compatible dataframe for each sample if airr.integrate = F or a single dataframe if airr.integrate = T ! Cave the format: VGM object =&gt; 1 cell = 1 row; AIRR table 1 cell = as many rows as VDJ and VJ chains available for that cell. GEX cell-level information is attached to all rows containing a chain of that cell.
</p>


<h3>Examples</h3>

<pre><code class="language-R">
try({
airr.list.out &lt;- PlatypusDB_VGM_to_AIRR(VGM = VGM
, VDJ.features.to.append = c("VDJ_cdr3s_aa")
, GEX.features.to.append = c("CTLA4", "TOX"), airr.rearrangements = Data.in)

airr.list.out &lt;- PlatypusDB_VGM_to_AIRR(VGM = VGM
, VDJ.features.to.append = c("VDJ_cdr3s_aa")
, GEX.features.to.append = c("CTLA4", "TOX"),
airr.rearrangements =list("~/path_to/s1/airr.rearrangement.tsv"
,"~/path_to/s2/airr_rearrangement.tsv"))

airr.list.out &lt;- PlatypusDB_VGM_to_AIRR(VGM = VGM
, VDJ.features.to.append = c("VDJ_cdr3s_aa")
, GEX.features.to.append = c("CTLA4", "TOX"),
airr.rearrangements = list(airr_rearrangements.s1, airr_rearrangements_2))

VDJ.out.directory.list &lt;- list()
VDJ.out.directory.list[[1]] &lt;- c("~/cellrangerVDJ/s1")
VDJ.out.directory.list[[2]] &lt;- c("~/cellrangerVDJ/s2")

GEX.out.directory.list &lt;- list()
GEX.out.directory.list[[1]] &lt;- c("~/cellrangerGEX/s1")
GEX.out.directory.list[[2]] &lt;- c("~/cellrangerGEX/s2")
VGM &lt;- VDJ_GEX_matrix(VDJ.out.directory.list = VDJ.out.directory.list,
GEX.out.directory.list = GEX.out.directory.list,
GEX.integrate = TRUE, VDJ.combine = TRUE, integrate.GEX.to.VDJ = TRUE
, integrate.VDJ.to.GEX = TRUE,
get.VDJ.stats = FALSE, trim.and.align = FALSE)
airr.list.out &lt;- PlatypusDB_VGM_to_AIRR(VGM = VGM,
VDJ.features.to.append = c("VDJ_sequence_nt_trimmed","VJ_sequence_nt_trimmed"),
GEX.features.to.append = c("UMAP_1","UMAP_2","CTLA4", "TOX"),
airr.rearrangements = c("~/cellrangerVDJ/s1/airr_rearrangement.tsv"
,"~/cellrangerVDJ/s2/airr_rearrangement.tsv"))
})


</code></pre>


</div>