<div class="container">

<table style="width: 100%;"><tr>
<td>tpmHMM</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>Tranistion probability matrix of the HMM representation</h2>

<h3>Description</h3>

<p>Construction of the transition probability matrix corresponding to the HMM which exactly represents the HSMM. Not intended to be run by the user (internal function, called by the functions <code>w2nHSMM</code> and <code>pmleHSMM</code>).
</p>


<h3>Usage</h3>

<pre><code class="language-R">tpmHMM(N, omega, d_r, R_vec, eps=1e-10)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>N</code></td>
<td>
<p>number of states of the HSMM, integer greater than 1.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>omega</code></td>
<td>
<p>conditional transition probability matrix of the HSMM with N rows and N columns. The diagonal elements must be zero and the rows must sum to one.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>d_r</code></td>
<td>
<p>list of vectors containing the dwell-time probabilities of the unstructured starts.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>R_vec</code></td>
<td>
<p>vector of length N containing the lengths of the unstructured starts of the state dwell-time distributions.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>eps</code></td>
<td>
<p>to avoid negative probabilities due to numerical underflow. Default is <code>1e-10</code>.</p>
</td>
</tr>
</table>
<h3>Value</h3>

<p>Returns the transition probability matrix of the HMM which exactly represents the HSMM.
</p>


<h3>References</h3>

<p>For details on the code and construction of the matrix, see:
</p>
<p>Langrock, R. and Zucchini W. (2011): Hidden Markov models with arbitrary state dwell-time distributions. <em>Computational Statistics and Data Analysis</em>, <strong>55</strong>, p. 715â€“724.
</p>
<p>Zucchini, W., MacDonald, I.L. and Langrock, R. (2016): <em>Hidden Markov models for time series:
An introduction using R</em>. 2nd edition. Chapman &amp; Hall/CRC, Boca Raton.
</p>


<h3>Examples</h3>

<pre><code class="language-R"># list of dwell-time probability vectors 
# (vector elements should not sum to one)
d_r&lt;-list()
d_r[[1]]&lt;-c(dgeom(0:9,0.2))
d_r[[2]]&lt;-c(dgeom(0:9,0.1))
# tranistion probability matrix:
Gamma&lt;-tpmHMM(N=2,omega=matrix(c(0,1,1,0),2,2),
  d_r=d_r,R_vec=sapply(d_r,length))
</code></pre>


</div>