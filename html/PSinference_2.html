<div class="container">

<table style="width: 100%;"><tr>
<td>GVdist</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>Generalized Variance Empirical Distribution</h2>

<h3>Description</h3>

<p>This function calculates the empirical distribution of the pivotal random
variable that can be used to perform inferential procedures
for the Generalized Variance of the released Single Synthetic dataset
generated under Plug-in Sampling, assuming that the original distribution
is normally distributed.
</p>


<h3>Usage</h3>

<pre><code class="language-R">GVdist(nsample, pvariates, iterations = 10000)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>nsample</code></td>
<td>
<p>Sample size.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>pvariates</code></td>
<td>
<p>Number of variables.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>iterations</code></td>
<td>
<p>Number of iterations for simulating values from the distribution and finding the quantiles. Default is <code>10000</code>.</p>
</td>
</tr>
</table>
<h3>Details</h3>

<p>We define
</p>
<p style="text-align: center;"><code class="reqn">T_1^\star = (n-1)\frac{|\boldsymbol{S}^*|}{|\boldsymbol{\Sigma}|},</code>
</p>

<p>where <code class="reqn">\boldsymbol{S}^\star = \sum_{i=1}^n (v_i - \bar{v})(v_i - \bar{v})^{\top}</code>, <code class="reqn">\boldsymbol{\Sigma}</code> is the population covariance matrix
and <code class="reqn">v_i</code> is the <code class="reqn">i</code>th observation of the synthetic dataset.
Its distribution is stochastic equivalent to
</p>
<p style="text-align: center;"><code class="reqn"> \prod_{i=1}^n \chi_{n-i}^2 \prod_{i=1}^p \chi_{n-i}^2</code>
</p>

<p>where <code class="reqn">\chi_{n-i}^2</code> are all independent chi-square random variables.
The <code class="reqn">(1-\alpha)</code> level confidence interval for <code class="reqn">|\boldsymbol{\Sigma}|</code>
is given by
</p>
<p style="text-align: center;"><code class="reqn">\left(\frac{(n-1)^p|\tilde{\boldsymbol{S}}^\star|}{t^\star_{1,1-\alpha/2}},
\frac{(n-1)^p|\tilde{\boldsymbol{S}}^\star|}{t^\star_{1,\alpha/2}} \right)</code>
</p>

<p>where <code class="reqn">\tilde{\boldsymbol{S}}^\star</code> is the observed value of
<code class="reqn">\boldsymbol{S}^\star</code> and <code class="reqn">t^\star_{1,\gamma}</code>
is the <code class="reqn">\gamma</code>th percentile of <code class="reqn">T_1</code>.
</p>


<h3>Value</h3>

<p>a vector of length <code>iterations</code> that recorded the empirical distribution's values.
</p>


<h3>References</h3>

<p>Klein, M., Moura, R. and Sinha, B. (2021). Multivariate Normal Inference based on Singly Imputed Synthetic Data under Plug-in Sampling. Sankhya B 83, 273â€“287.
</p>


<h3>Examples</h3>

<pre><code class="language-R">
# Original data creation
library(MASS)
mu &lt;- c(1,2,3,4)
Sigma &lt;- matrix(c(1, 0.5, 0.5, 0.5,
                  0.5, 1, 0.5, 0.5,
                  0.5, 0.5, 1, 0.5,
                  0.5, 0.5, 0.5, 1), nrow = 4, ncol = 4, byrow = TRUE)
seed = 1
n_sample = 100
# Create original simulated dataset
df = mvrnorm(n_sample, mu = mu, Sigma = Sigma)

# Synthetic data created

df_s = simSynthData(df)


# Gather the 0.025 and 0.975 quantiles and construct confident interval for sigma^2
# Check that sigma^2 is inside in both cases
p = dim(df_s)[2]

T &lt;- GVdist(100, p, 10000)
q975 &lt;- quantile(T, 0.975)
q025 &lt;- quantile(T, 0.025)

left &lt;- (n_sample-1)^p * det(cov(df_s)*(n_sample-1))/q975
right &lt;- (n_sample-1)^p * det(cov(df_s)*(n_sample-1))/q025

cat(left,right,'\n')
print(det(Sigma))
# The synthetic value is inside the confidence interval of GV

</code></pre>


</div>