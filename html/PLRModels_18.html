<div class="container">

<table style="width: 100%;"><tr>
<td>plrm.ci</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>
Confidence intervals estimation in partial linear regression models
</h2>

<h3>Description</h3>

<p>This routine obtains a confidence interval for the value <code class="reqn">a^T * \beta</code>, by asymptotic distribution and bootstrap, <code class="reqn">{(Y_i, X_{i1}, ..., X_{ip}, t_i): i=1,...,n}</code>, where:
</p>
<p style="text-align: center;"><code class="reqn">a = (a_1,...,a_p)^T</code>
</p>

<p>is an unknown vector, 
</p>
<p style="text-align: center;"><code class="reqn">\beta = (\beta_1,...,\beta_p)^T</code>
</p>

<p>is an unknown vector parameter and
</p>
<p style="text-align: center;"><code class="reqn">Y_i= X_{i1}*\beta_1 +...+ X_{ip}*\beta_p + m(t_i) + \epsilon_i.</code>
</p>

<p>The nonparametric component, <code class="reqn">m</code>, is a smooth but unknown function, and the random errors, <code class="reqn">\epsilon_i</code>, are allowed to be time series. 
</p>


<h3>Usage</h3>

<pre><code class="language-R">plrm.ci(data=data, seed=123, CI="AD", B=1000, N=50, a=NULL, 
        b1=NULL, b2=NULL, estimator="NW", 
        kernel="quadratic", p.arima=NULL, q.arima=NULL, 
        p.max=3, q.max=3, alpha=0.05, alpha2=0.05, num.lb=10, 
        ic="BIC", Var.Cov.eps=NULL)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>data</code></td>
<td>

<p><code>data[, 1]</code> contains the values of the response variable, <code class="reqn">Y</code>;
</p>
<p><code>data[, 2:(p+1)]</code> contains the values of the "linear" explanatory variables, <code class="reqn">X_1, ..., X_p</code>;
</p>
<p><code>data[, p+2]</code> contains the values of the "nonparametric" explanatory variable, <code class="reqn">t</code>.
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>seed</code></td>
<td>
<p>the considered seed.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>CI</code></td>
<td>
<p>method to obtain the confidence interval. It allows us to choose between: “AD” (asymptotic distribution), “B” (bootstrap) or “all” (both). The default is “AD”.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>B</code></td>
<td>
<p>number of bootstrap replications. The default is 1000.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>N</code></td>
<td>
<p>Truncation parameter used in the finite approximation of the MA(infinite) expression of <code class="reqn">\epsilon</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>a</code></td>
<td>
<p>Vector which, multiplied by <code>beta</code>, is used for obtaining the confidence interval of this result.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>b1</code></td>
<td>
<p>the considered bandwidth to estimate the confidence interval by asymptotic distribution. If NULL (the default), it is obtained using cross-validation.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>b2</code></td>
<td>
<p>the considered bandwidth to estimate the confidence interval by bootstrap. If NULL (the default), it is obtained using cross-validation.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>estimator</code></td>
<td>
<p>allows us the choice between “NW” (Nadaraya-Watson) or “LLP” (Local Linear Polynomial). The default is “NW”.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>kernel</code></td>
<td>
<p>allows us the choice between “gaussian”, “quadratic” (Epanechnikov kernel), “triweight” or “uniform” kernel. The default is “quadratic”.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>p.arima</code></td>
<td>
<p>the considered p to fit the model ARMA(p,q).</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>q.arima</code></td>
<td>
<p>the considered q to fit the model ARMA(p,q).</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>p.max</code></td>
<td>
<p>if <code>Var.Cov.eps=NULL</code>, the ARMA models are selected between the models ARMA(p,q) with 0&lt;=p&lt;=<code>p.max</code> and 0&lt;=q&lt;=<code>q.max</code>. The default is 3.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>q.max</code></td>
<td>
<p>if <code>Var.Cov.eps=NULL</code>, the ARMA models are selected between the models ARMA(p,q) with 0&lt;=p&lt;=<code>p.max</code> and 0&lt;=q&lt;=<code>q.max</code>. The default is 3.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>alpha</code></td>
<td>
<p>1 - <code>alpha</code> is the confidence level of the confidence interval. The default is 0.05.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>alpha2</code></td>
<td>
<p>significance level used to check (if needed) the ARMA model fitted to the residuals. The default is 0.05.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>num.lb</code></td>
<td>
<p>if <code>Var.Cov.eps=NULL</code>, it checks the suitability of the selected ARMA model according to the Ljung-Box test and the t-test. It uses up to <code>num.lb</code> delays in the Ljung-Box test. The default is 10.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>ic</code></td>
<td>
<p>if <code>Var.Cov.eps=NULL</code>, <code>ic</code> contains the information criterion used to suggest the ARMA model. It allows us to choose between: "AIC", "AICC" or "BIC" (the default).</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>Var.Cov.eps</code></td>
<td>
 <p><code>n x n</code> matrix of variances-covariances associated to the random errors of the regression model. If NULL (the default), the function tries to estimate it: it fits an ARMA model (selected according to an information criterium) to the residuals from the fitted regression model and, then, it obtains the var-cov matrix of such ARMA model.</p>
</td>
</tr>
</table>
<h3>Value</h3>

<p>A list containing:
</p>
<table>
<tr style="vertical-align: top;">
<td><code>Bootstrap</code></td>
<td>
<p>a dataframe containing <code>ci_inf</code> and <code>ci_sup</code>, the confidence intervals using bootstrap; <code>p_opt</code> and <code>q_opt</code> (the orders for the ARMA model fitted to the residuals) and <code>b1</code> and <code>b2</code>, the considered bandwidths.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>AD</code></td>
<td>
<p>a dataframe containing <code>ci_inf</code> and <code>ci_sup</code>, the confidence intervals using the asymptotic distribution; <code>p_opt</code> and <code>q_opt</code> (the orders for the ARMA model fitted to the residuals) and <code>b1</code>, the considered bandwidth.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>pv.Box.test</code></td>
<td>
<p>p-values of the Ljung-Box test for the model fitted to the residuals.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>pv.t.test</code></td>
<td>
<p>p-values of the t.test for the model fitted to the residuals.</p>
</td>
</tr>
</table>
<h3>Author(s)</h3>

<p>German Aneiros Perez <a href="mailto:ganeiros@udc.es">ganeiros@udc.es</a>
</p>
<p>Ana Lopez Cheda <a href="mailto:ana.lopez.cheda@udc.es">ana.lopez.cheda@udc.es</a>
</p>


<h3>References</h3>

<p>Liang, H., Hardle, W., Sommerfeld, V. (2000) Bootstrap approximation in a partially linear regression model. <em>Journal of Statistical Planning and Inference</em> <b>91</b>, 413-426.
</p>
<p>You, J., Zhou, X. (2005) Bootstrap of a semiparametric partially linear model with autoregressive errors. <em>Statistica Sinica</em> <b>15</b>, 117-133.
</p>


<h3>See Also</h3>

<p>A related functions is <code>par.ci</code>.
</p>


<h3>Examples</h3>

<pre><code class="language-R"># EXAMPLE 1: REAL DATA
data(barnacles1)
data &lt;- as.matrix(barnacles1)
data &lt;- diff(data, 12)
data &lt;- cbind(data,1:nrow(data))

b.h &lt;- plrm.gcv(data)$bh.opt
b1 &lt;- b.h[1]

## Not run: plrm.ci(data, b1=b1, b2=b1, a=c(1,0), CI="all")
## Not run: plrm.ci(data, b1=b1, b2=b1, a=c(0,1), CI="all")



# EXAMPLE 2: SIMULATED DATA
## Example 2a: dependent data

set.seed(123)
# We generate the data
n &lt;- 100
t &lt;- ((1:n)-0.5)/n
m &lt;- function(t) {t+0.5}
f &lt;- m(t)

beta &lt;- c(0.5, 2)
x &lt;- matrix(rnorm(200,0,3), nrow=n)
sum &lt;- x%*%beta
sum &lt;- as.matrix(sum)
eps &lt;- arima.sim(list(order = c(1,0,0), ar=0.7), sd = 0.1, n = n)
eps &lt;- as.matrix(eps)

y &lt;-  sum + f + eps
data_plrmci &lt;- cbind(y,x,t)

## Not run: plrm.ci(data, a=c(1,0), CI="all")
## Not run: plrm.ci(data, a=c(0,1), CI="all")
</code></pre>


</div>