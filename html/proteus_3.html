<div class="container">

<table style="width: 100%;"><tr>
<td>proteus_random_search</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>proteus_random_search</h2>

<h3>Description</h3>

<p>proteus_random_search is a function for fine-tuning using random search on the hyper-parameter space of proteus (predefined or custom).
</p>


<h3>Usage</h3>

<pre><code class="language-R">proteus_random_search(
  n_samp,
  data,
  target,
  future,
  past = NULL,
  ci = 0.8,
  smoother = FALSE,
  t_embed = NULL,
  activ = NULL,
  nodes = NULL,
  distr = NULL,
  optim = NULL,
  loss_metric = "crps",
  epochs = 30,
  lr = NULL,
  patience = 10,
  latent_sample = 100,
  verbose = TRUE,
  stride = NULL,
  dates = NULL,
  rolling_blocks = FALSE,
  n_blocks = 4,
  block_minset = 10,
  error_scale = "naive",
  error_benchmark = "naive",
  batch_size = 30,
  min_default = 1,
  seed = 42,
  future_plan = "future::multisession",
  omit = FALSE,
  keep = FALSE
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>n_samp</code></td>
<td>
<p>Positive integer. Number of models to be randomly generated sampling the hyper-parameter space.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>data</code></td>
<td>
<p>A data frame with time features on columns and possibly a date column (not mandatory).</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>target</code></td>
<td>
<p>Vector of strings. Names of the time features to be jointly analyzed.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>future</code></td>
<td>
<p>Positive integer. The future dimension with number of time-steps to be predicted.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>past</code></td>
<td>
<p>Positive integer. Length of past sequences. Default: NULL (search range future:2*future).</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>ci</code></td>
<td>
<p>Positive numeric. Confidence interval. Default: 0.8.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>smoother</code></td>
<td>
<p>Logical. Perform optimal smoothing using standard loess for each time feature. Default: FALSE.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>t_embed</code></td>
<td>
<p>Positive integer. Number of embedding for the temporal dimension. Minimum value is equal to 2. Default: NULL (search range 2:30).</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>activ</code></td>
<td>
<p>String. Activation function to be used by the forward network. Implemented functions are: "linear", "mish", "swish", "leaky_relu", "celu", "elu", "gelu", "selu", "bent", "softmax", "softmin", "softsign", "softplus", "sigmoid", "tanh". Default: NULL (full-option search).</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>nodes</code></td>
<td>
<p>Positive integer. Nodes for the forward neural net. Default: NULL (search range 2:1024).</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>distr</code></td>
<td>
<p>String. Distribution to be used by variational model. Implemented distributions are: "normal", "genbeta", "gev", "gpd", "genray", "cauchy", "exp", "logis", "chisq", "gumbel", "laplace", "lognorm", "skewed". Default: NULL (full-option search).</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>optim</code></td>
<td>
<p>String. Optimization method. Implemented methods are: "adadelta", "adagrad", "rmsprop", "rprop", "sgd", "asgd", "adam". Default: NULL (full-option search).</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>loss_metric</code></td>
<td>
<p>String. Loss function for the variational model. Three options: "elbo", "crps", "score". Default: "crps".</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>epochs</code></td>
<td>
<p>Positive integer. Default: 30.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>lr</code></td>
<td>
<p>Positive numeric. Learning rate. Default: NULL (search range 0.001:0.1).</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>patience</code></td>
<td>
<p>Positive integer. Waiting time (in epochs) before evaluating the overfit performance. Default: epochs.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>latent_sample</code></td>
<td>
<p>Positive integer. Number of samples to draw from the latent variables. Default: 100.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>verbose</code></td>
<td>
<p>Logical. Default: TRUE</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>stride</code></td>
<td>
<p>Positive integer. Number of shifting positions for sequence generation. Default: NULL (search range 1:3).</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>dates</code></td>
<td>
<p>String. Label of feature where dates are located. Default: NULL (progressive numbering).</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>rolling_blocks</code></td>
<td>
<p>Logical. Option for incremental or rolling window. Default: FALSE.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>n_blocks</code></td>
<td>
<p>Positive integer. Number of distinct blocks for back-testing. Default: 4.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>block_minset</code></td>
<td>
<p>Positive integer. Minimum number of sequence to create a block. Default: 3.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>error_scale</code></td>
<td>
<p>String. Scale for the scaled error metrics (for continuous variables). Two options: "naive" (average of naive one-step absolute error for the historical series) or "deviation" (standard error of the historical series). Default: "naive".</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>error_benchmark</code></td>
<td>
<p>String. Benchmark for the relative error metrics (for continuous variables). Two options: "naive" (sequential extension of last value) or "average" (mean value of true sequence). Default: "naive".</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>batch_size</code></td>
<td>
<p>Positive integer. Default: 30.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>min_default</code></td>
<td>
<p>Positive numeric. Minimum differentiation iteration. Default: 1.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>seed</code></td>
<td>
<p>Random seed. Default: 42.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>future_plan</code></td>
<td>
<p>how to resolve the future parallelization. Options are: "future::sequential", "future::multisession", "future::multicore". For more information, take a look at future specific documentation. Default: "future::multisession".</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>omit</code></td>
<td>
<p>Logical. Flag to TRUE to remove missing values, otherwise all gaps, both in dates and values, will be filled with kalman filter. Default: FALSE.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>keep</code></td>
<td>
<p>Logical. Flag to TRUE to keep all the explored models. Default: FALSE.</p>
</td>
</tr>
</table>
<h3>Value</h3>

<p>This function returns a list including:
</p>

<ul>
<li>
<p> random_search: summary of the sampled hyper-parameters and average error metrics.
</p>
</li>
<li>
<p> best: best model according to overall ranking on all average error metrics (for negative metrics, absolute value is considered).
</p>
</li>
<li>
<p> all_models: list with all generated models (if keep flagged to TRUE).
</p>
</li>
<li>
<p> time_log: computation time.
</p>
</li>
</ul>
<h3>Author(s)</h3>

<p>Giancarlo Vercellino <a href="mailto:giancarlo.vercellino@gmail.com">giancarlo.vercellino@gmail.com</a>
</p>


<h3>References</h3>

<p>https://rpubs.com/giancarlo_vercellino/proteus
</p>


</div>