<div class="container">

<table style="width: 100%;"><tr>
<td>IBDestimate</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>Relatedness estimation</h2>

<h3>Description</h3>

<p>Estimate the pairwise IBD coefficients <code class="reqn">(\kappa_0, \kappa_1, \kappa_2)</code> for
specified pairs of pedigree members, using maximum likelihood methods.
The optimization machinery is imported from the <code>maxLik</code> package.
</p>


<h3>Usage</h3>

<pre><code class="language-R">IBDestimate(x, ids, markers = NULL, start = c(0.99, 0.001), tol = 1e-07)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>x</code></td>
<td>
<p>A single <code>linkdat</code> object or a list of <code>linkdat</code> and/or
<code>singleton</code> objects.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>ids</code></td>
<td>
<p>Either a vector of length 2, or a matrix with two columns, indicating the
the pair(s) of individuals for which IBD estimates should be computed. If a matrix,
each row corresponds to a pair. The entries can be either characters (matching the
<code>plot.labels</code> of the linkdat object(s)) or integers (matching the <code>orig.ids</code>
identifiers of the linkdat object(s)).</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>markers</code></td>
<td>
<p>A numeric indicating which marker(s) to include. If NULL (default),
all markers are used.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>start</code></td>
<td>
<p>Numeric of length 2, indicating the initial value of <code class="reqn">(\kappa_0, \kappa_2)</code>
in the optimisation (passed on to <code>maxLik</code>).</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>tol</code></td>
<td>
<p>A single numeric: the optimising tolerance value; passed on to <code>maxLik</code>).</p>
</td>
</tr>
</table>
<h3>Details</h3>

<p>This function optimises the log-likelihood function first described in (Thompson, 1975).
Optimisation is done in the <code class="reqn">(\kappa_0, \kappa_2)</code>-plane and restricted to the
probability triangle defined by <code class="reqn">\kappa_0 \ge 0, \kappa_2 \ge 0, \kappa_0 + \kappa_2 \le 1</code>.
</p>


<h3>Value</h3>

<p>A data.frame with 8 columns: ID1, ID2 (numeric IDs), Name1, Name2 (plot labels, if present), N
(#markers with no missing alleles), <code class="reqn">\kappa_0</code>, <code class="reqn">\kappa_1</code>, <code class="reqn">\kappa_2</code>.
</p>


<h3>References</h3>

<p>E. A. Thompson (2000). <em>Statistical Inferences from Genetic Data
on Pedigrees.</em> NSF-CBMS Regional Conference Series in Probability and
Statistics. Volume 6.
</p>


<h3>See Also</h3>

<p><code>examineKinships</code>,
<code>IBDtriangle</code>, <code>maxLik</code>
</p>


<h3>Examples</h3>

<pre><code class="language-R">
if (requireNamespace("maxLik", quietly = TRUE)) {

# Simulate marker data for two siblings
x = nuclearPed(2)
x = setPlotLabels(x, c("Sib1", "Sib2"), c(3,4))
x = simpleSim(x, 200, 1:2) # 200 equifrequent SNPs

# Estimate the IBD coefficients for the siblings
est1 = IBDestimate(x, ids=c(3,4))

# Estimate should be the same if pedigree structure is unknown
xlist = list(branch(x, 3), branch(x, 4))
est2 = IBDestimate(xlist, ids=c(3,4))
stopifnot(identical(est1, est2))

# If the pedigree has plot.labels, they can be used as IDs
est3 = IBDestimate(x, ids=c("Sib1", "Sib2"))
stopifnot(identical(est1, est3))

}

</code></pre>


</div>