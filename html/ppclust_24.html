<div class="container">

<table style="width: 100%;"><tr>
<td>upfc</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>
Unsupervised Possibilistic Fuzzy C-Means Clustering Algorithm
</h2>

<h3>Description</h3>

<p>Partitions a numeric data set by using the Unsupervised Possibilistic Fuzzy C-Means clustering algorithm which has been proposed by Wu et al (2010).
</p>


<h3>Usage</h3>

<pre><code class="language-R">upfc(x, centers, memberships, m=2, eta=2, a, b,   
    dmetric="sqeuclidean", pw=2, alginitv="kmpp", alginitu="imembrand", 
    nstart=1, iter.max=1000, con.val=1e-09, 
    fixcent=FALSE, fixmemb=FALSE, stand=FALSE, numseed)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>x</code></td>
<td>
<p>a numeric vector, data frame or matrix.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>centers</code></td>
<td>
<p>an integer specifying the number of clusters or a numeric matrix containing the initial cluster centers.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>memberships</code></td>
<td>
<p>a numeric matrix containing the initial membership degrees. If missing, it is internally generated.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>m</code></td>
<td>
<p>a number greater than 1 to be used as the fuzziness exponent. The default is 2.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>eta</code></td>
<td>
<p>a number greater than 1 to be used as the typicality exponent. The default is 2.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>a</code></td>
<td>
<p>a number for the relative importance of the fuzzy part of the objective function. The default is 1.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>b</code></td>
<td>
<p>a number for the relative importance of the possibilistic part of the objective function. The default is 1.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>dmetric</code></td>
<td>
<p>a string for the distance metric. The default is <span class="option">sqeuclidean</span> for the squared Euclidean distances. See <code>get.dmetrics</code> for the alternative options.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>pw</code></td>
<td>
<p>a number for the power of Minkowski distance calculation. The default is 2 if the <code>dmetric</code> is <span class="option">minkowski</span>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>alginitv</code></td>
<td>
<p>a string for the initialization of cluster prototypes matrix. The default is <span class="option">kmpp</span> for K-means++ initialization method (Arthur &amp; Vassilvitskii, 2007). For the list of alternative options see <code>get.algorithms</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>alginitu</code></td>
<td>
<p>a string for the initialization of memberships degrees matrix. The default is <span class="option">imembrand</span> for random sampling of initial membership degrees.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>nstart</code></td>
<td>
<p>an integer for the number of starts for clustering. The default is 1.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>iter.max</code></td>
<td>
<p>an integer for the maximum number of iterations allowed. The default is 1000.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>con.val</code></td>
<td>
<p>a number for the convergence value between the iterations. The default is 1e-09.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>fixcent</code></td>
<td>
<p>a logical flag to fix the initial cluster centers. The default is <code>FALSE</code>. If it is <code>TRUE</code>, the initial centers are not changed in the successive starts of the algorithm when the <code>nstart</code> is greater than 1.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>fixmemb</code></td>
<td>
<p>a logical flag to fix the initial membership degrees. The default is <code>FALSE</code>. If it is <code>TRUE</code>, the initial memberships are not changed in the successive starts of the algorithm when the <code>nstart</code> is greater than 1.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>stand</code></td>
<td>
<p>a logical flag to standardize data. Its default value is <code>FALSE</code>. If its value is <code>TRUE</code>, the data matrix <code>x</code> is standardized.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>numseed</code></td>
<td>
<p>a seeding number to set the seed of R's random number generator.</p>
</td>
</tr>
</table>
<h3>Details</h3>

<p>Unsupervised Possibilistic Fuzzy C-Means (UPFC) is an extension of Possibilistic Clustering Algorithm (PCA) by Yang &amp; Wu (2006). Wu et al (2010) reported that PCA is very sensitive to initializations and sometimes generates coincident clusters, and proposed the algorithm UPFC to overcome this problem with inspiration by Pal et al's PFCM algorithm (Pal et al, 2005). The algorithm UPFC produces both possibilistic and probabilistic memberships simultaneously, and overcomes the noise sensitivity problem of FCM and the coincident clusters problem of PCA.
</p>
<p>The objective function of UPFC is:
</p>
<p><code class="reqn">J_{UPFC}(\mathbf{X}; \mathbf{V}, \mathbf{U}, \mathbf{T})=\sum\limits_{j=1}^k \sum\limits_{i=1}^n (a \; u_{ij}^m + b \; t_{ij}^\eta \; d^2(\vec{x}_i, \vec{v}_j) + \frac{\beta}{n^2\sqrt{k}} \; \sum\limits_{j=1}^k \sum\limits_{i=1}^n (t_{ij}^\eta \; log \; t_{ij}^\eta - t_{ij}^\eta)</code>
</p>
<p>Where:
</p>
<p><code class="reqn">u_{ij} =\Bigg[\sum\limits_{j=1}^k \Big(\frac{d^2(\vec{x}_i, \vec{v}_j)}{d^2(\vec{x}_i, \vec{v}_l)}\Big)^{1/(m-1)} \Bigg]^{-1} \;\;; 1 \leq i \leq n, \; 1 \leq l \leq k</code>
</p>
<p><code class="reqn">t_{ij} = exp\Big(- \frac{b \; n \; \sqrt{k} \; d^2(\vec{x}_i, \vec{v}_j)}{\beta}\Big) \;\;; {1\leq i\leq n},\; {1\leq j\leq k}</code>
</p>
<p>Where:
</p>
<p><code class="reqn">\beta = \frac{\sum\limits_{i=1}^n \; d^2(\vec{x}_i, \overline{x})}{n}</code> with <code class="reqn">\overline{x}=\frac{\sum\limits_{i=1}^n \vec{x}_i}{n}</code>
</p>
<p>The constraints with UPFC are:
</p>
<p><code class="reqn">0 \leq \sum\limits_{i=1}^n u_{ij} \leq n \;\;;\; 1 \leq j\leq k</code>
</p>
<p><code class="reqn">\sum\limits_{j=1}^k u_{ij} = 1 \;\;;\; 1 \leq i\leq n</code>
</p>
<p><code class="reqn">a</code> and <code class="reqn">b</code> are the coefficients to define the relative importance of fuzzy membership and typicality degrees in the objective function, <code class="reqn"> a &gt; 0; \; b &gt; 0</code>.
</p>
<p>The update equation for cluster prototypes:
</p>
<p><code class="reqn">\vec{v}_j =\frac{\sum\limits_{i=1}^n (a \; u_{ij}^m + b \; t_{ij}^\eta) \; \vec{x}_i}{\sum\limits_{i=1}^n (a \; u_{ij}^m + b \; t_{ij}^\eta)} \;\;; {1\leq j\leq k}</code>
</p>


<h3>Value</h3>

<p>an object of class ‘ppclust’, which is a list consists of the following items:
</p>
<table>
<tr style="vertical-align: top;">
<td><code>v</code></td>
<td>
<p>a numeric matrix containing the final cluster prototypes.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>t</code></td>
<td>
<p>a numeric matrix containing the typicality degrees of the data objects.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>d</code></td>
<td>
<p>a numeric matrix containing the distances of objects to the final cluster prototypes.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>x</code></td>
<td>
<p>a numeric matrix containing the processed data set.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>cluster</code></td>
<td>
<p>a numeric vector containing the cluster labels found by defuzzifying the typicality degrees of the objects.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>csize</code></td>
<td>
<p>a numeric vector containing the number of objects in the clusters.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>k</code></td>
<td>
<p>an integer for the number of clusters.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>m</code></td>
<td>
<p>a number for the used fuzziness exponent.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>eta</code></td>
<td>
<p>a number for the used typicality exponent.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>a</code></td>
<td>
<p>a number for the fuzzy part of the objective function.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>b</code></td>
<td>
<p>a number for the possibilistic part of the objective function.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>beta</code></td>
<td>
<p>a numeric vector of normalization...</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>iter</code></td>
<td>
<p>an integer vector for the number of iterations in each start of the algorithm.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>best.start</code></td>
<td>
<p>an integer for the index of start that produced the minimum objective functional.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>func.val</code></td>
<td>
<p>a numeric vector for the objective function values in each start of the algorithm.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>comp.time</code></td>
<td>
<p>a numeric vector for the execution time in each start of the algorithm.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>stand</code></td>
<td>
<p>a logical value, <code>TRUE</code> shows that <code>x</code> data set contains the standardized values of raw data.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>wss</code></td>
<td>
<p>a number for the within-cluster sum of squares for each cluster.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>bwss</code></td>
<td>
<p>a number for the between-cluster sum of squares.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>tss</code></td>
<td>
<p>a number for the total within-cluster sum of squares.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>twss</code></td>
<td>
<p>a number for the total sum of squares.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>algorithm</code></td>
<td>
<p>a string for the name of partitioning algorithm. It is ‘PCM’ with this function.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>call</code></td>
<td>
<p>a string for the matched function call generating this ‘ppclust’ object.</p>
</td>
</tr>
</table>
<h3>Author(s)</h3>

<p>Zeynel Cebeci, Figen Yildiz &amp; Alper Tuna Kavlak
</p>


<h3>References</h3>

<p>Arthur, D. &amp; Vassilvitskii, S. (2007). K-means++: The advantages of careful seeding, in <em>Proc. of the 18th Annual ACM-SIAM Symposium on Discrete Algorithms</em>, p. 1027-1035. &lt;<a href="http://ilpubs.stanford.edu:8090/778/1/2006-13.pdf">http://ilpubs.stanford.edu:8090/778/1/2006-13.pdf</a>&gt;
</p>
<p>Pal, N. R., Pal, K. &amp; Bezdek, J. C. (2005). A possibilistic fuzzy c-means clustering algorithm. <em>IEEE
Trans. Fuzzy Systems</em>, 13 (4): 517-530. &lt;doi:10.1109/TFUZZ.2004.840099&gt;
</p>
<p>Yang, M. S. &amp; Wu, K. L. (2006). Unsupervised possibilistic clustering. <em>Pattern Recognition</em>, 39(1): 5-21. &lt;doi:10.1016/j.patcog.2005.07.005&gt;
</p>
<p>Wu, X., Wu, B., Sun, J. &amp; Fu, H. (2010). Unsupervised possibilistic fuzzy clustering. <em> J. of Information &amp; Computational Sci.</em>, 7 (5): 1075-1080. &lt;<a href="https://www.researchgate.net/publication/267691137_Unsupervised_Possibilistic_Fuzzy_Clustering">https://www.researchgate.net/publication/267691137_Unsupervised_Possibilistic_Fuzzy_Clustering</a>&gt;
</p>


<h3>See Also</h3>

<p><code>ekm</code>,
<code>fcm</code>,
<code>fcm2</code>,
<code>fpcm</code>,
<code>fpppcm</code>,
<code>gg</code>,
<code>gk</code>,
<code>gkpfcm</code>,
<code>hcm</code>,
<code>pca</code>,
<code>pcm</code>,
<code>pcmr</code>,
<code>pfcm</code>
</p>


<h3>Examples</h3>

<pre><code class="language-R"># Load dataset X16
data(x16)
x &lt;- x16[,-3]

# Initialize the prototype matrix using K-means++
v &lt;- inaparc::kmpp(x, k=2)$v
# Initialize the memberships degrees matrix 
u &lt;- inaparc::imembrand(nrow(x), k=2)$u

# Run UPFC
res.upfc &lt;- upfc(x, centers=v, memberships=u, eta=2)

# Display the fuzzy membership degrees
print(round(res.upfc$u, 2))

# Display the typicality degrees
print(round(res.upfc$t, 2))
</code></pre>


</div>