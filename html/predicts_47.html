<div class="container">

<table style="width: 100%;"><tr>
<td>pycnophy</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>
Pycnophylactic interpolation.
</h2>

<h3>Description</h3>

<p>Given a <code>SpatVector</code> of polygons and population data for each polygon, compute a population density estimate based on Tobler's pycnophylactic interpolation algorithm.
</p>


<h3>Usage</h3>

<pre><code class="language-R">pycnophy(x, v, pop, r = 0.2, converge = 3, verbose=FALSE)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>x</code></td>
<td>
<p>SpatRaster to interpolate to</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>v</code></td>
<td>
<p>SpatVector of polygons</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>pop</code></td>
<td>
<p>Either a character (name in <code>v</code>) or a numeric vector of length <code>nrow(v)</code></p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>r</code></td>
<td>
<p> A relaxation parameter for the iterative step in the pycnophylactic algorithm.  Prevents over-compensation in the smoothing step.  In practice the default value works well</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>converge</code></td>
<td>
<p> A convergence parameter, informing the decision on when iterative improvements on the smooth surface have converged sufficiently - see details</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>verbose</code></td>
<td>
<p>If <code>TRUE</code> the function report the maximum change in any grid cell value for each iterative step</p>
</td>
</tr>
</table>
<h3>Details</h3>

<p>This method uses an iterative approach, and for each iteration notes the maximum change in a pixel.  When this value falls below a certain level (10^(-converge) times the largest initial grid cell value) the iteration stops.  
</p>


<h3>Value</h3>

<p>SpatRaster 
</p>


<h3>Note</h3>

<p>Pycnophylatic interpolation has the property that the sum of the estimated values associated with all of the pixels in any polygon equals the supplied population for that polygon.  A further property is that all pixel values are greater than or equal to zero.  The method is generally used to obtain pixel-based population estimates when total populations for a set of irregular polygons (eg. counties) are known.
</p>


<h3>Author(s)</h3>

<p>Chris Brunsdon (adapted for terra objects by Robert Hijmans)
</p>


<h3>References</h3>

<p>Tobler, W.R. (1979) <em>Smooth Pycnophylactic Interpolation for Geographical Regions</em>. Journal of the American Statistical Association, v74(367) pp. 519-530.
</p>


<h3>Examples</h3>

<pre><code class="language-R">f &lt;- system.file("ex/lux.shp", package="terra")
v &lt;- vect(f)
r &lt;- rast(v, resolution = 0.01)
p &lt;- pycnophy(r, v, "POP", converge=3, verbose=FALSE)
plot(p); lines(v)
</code></pre>


</div>