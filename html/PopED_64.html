<div class="container">

<table style="width: 100%;"><tr>
<td>ofv_fim</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>Evaluate a criterion of the Fisher Information Matrix (FIM)</h2>

<h3>Description</h3>

<p>Compute a criterion of the FIM given the model, parameters, design and methods defined in the 
PopED database.
</p>


<h3>Usage</h3>

<pre><code class="language-R">ofv_fim(
  fmf,
  poped.db,
  ofv_calc_type = poped.db$settings$ofv_calc_type,
  ds_index = poped.db$parameters$ds_index,
  use_log = TRUE,
  ...
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>fmf</code></td>
<td>
<p>The FIM</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>poped.db</code></td>
<td>
<p>A poped database</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>ofv_calc_type</code></td>
<td>
<p>OFV calculation type for FIM
</p>
 
<ul>
<li>
<p> 1 = "D-optimality". Determinant of the FIM: det(FIM)
</p>
</li>
<li>
<p> 2 = "A-optimality".  Inverse of the sum of the expected parameter variances: 
1/trace_matrix(inv(FIM)) 
</p>
</li>
<li>
<p> 4 = "lnD-optimality".  Natural logarithm of the determinant of the FIM: log(det(FIM)) 
</p>
</li>
<li>
<p> 6 = "Ds-optimality". Ratio of the Determinant of the FIM and the Determinant of the uninteresting
rows and columns of the FIM: det(FIM)/det(FIM_u)
</p>
</li>
<li>
<p> 7 = Inverse of the sum of the expected parameter RSE: 1/sum(get_rse(FIM,poped.db,use_percent=FALSE))
</p>
</li>
</ul>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>ds_index</code></td>
<td>
<p>Ds_index is a vector set to 1 if a parameter is uninteresting, otherwise 0.
size=(1,num unfixed parameters). First unfixed bpop, then unfixed d, then unfixed docc and last unfixed sigma. 
Default is the fixed effects being important, everything else not important.  Used in conjunction with
<code>ofv_calc_type=6</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>use_log</code></td>
<td>
<p>Should the criterion be in the log domain?</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>...</code></td>
<td>
<p>arguments passed to <code>evaluate.fim</code> and <code>ofv_fim</code>.</p>
</td>
</tr>
</table>
<h3>Value</h3>

<p>The specified criterion value.
</p>


<h3>See Also</h3>

<p>Other FIM: 
<code>LinMatrixH()</code>,
<code>LinMatrixLH()</code>,
<code>LinMatrixL_occ()</code>,
<code>calc_ofv_and_fim()</code>,
<code>ed_laplace_ofv()</code>,
<code>ed_mftot()</code>,
<code>efficiency()</code>,
<code>evaluate.e.ofv.fim()</code>,
<code>evaluate.fim()</code>,
<code>gradf_eps()</code>,
<code>mf3()</code>,
<code>mf7()</code>,
<code>mftot()</code>,
<code>ofv_criterion()</code>
</p>
<p>Other evaluate_FIM: 
<code>calc_ofv_and_fim()</code>,
<code>evaluate.e.ofv.fim()</code>,
<code>evaluate.fim()</code>
</p>


<h3>Examples</h3>

<pre><code class="language-R">library(PopED)

############# START #################
## Create PopED database
## (warfarin model for optimization)
#####################################

## Warfarin example from software comparison in:
## Nyberg et al., "Methods and software tools for design evaluation 
##   for population pharmacokinetics-pharmacodynamics studies", 
##   Br. J. Clin. Pharm., 2014. 

## Optimization using an additive + proportional reidual error  
## to avoid sample times at very low concentrations (time 0 or very late samples).

## find the parameters that are needed to define from the structural model
ff.PK.1.comp.oral.sd.CL

## -- parameter definition function 
## -- names match parameters in function ff
sfg &lt;- function(x,a,bpop,b,bocc){
  parameters=c(CL=bpop[1]*exp(b[1]),
               V=bpop[2]*exp(b[2]),
               KA=bpop[3]*exp(b[3]),
               Favail=bpop[4],
               DOSE=a[1])
  return(parameters) 
}

## -- Define initial design  and design space
poped.db &lt;- create.poped.database(ff_fun=ff.PK.1.comp.oral.sd.CL,
                                  fg_fun=sfg,
                                  fError_fun=feps.add.prop,
                                  bpop=c(CL=0.15, V=8, KA=1.0, Favail=1), 
                                  notfixed_bpop=c(1,1,1,0),
                                  d=c(CL=0.07, V=0.02, KA=0.6), 
                                  sigma=c(prop=0.01,add=0.25),
                                  groupsize=32,
                                  xt=c( 0.5,1,2,6,24,36,72,120),
                                  minxt=0.01,
                                  maxxt=120,
                                  a=c(DOSE=70),
                                  mina=c(DOSE=0.01),
                                  maxa=c(DOSE=100))

############# END ###################
## Create PopED database
## (warfarin model for optimization)
#####################################


## evaluate initial design 
FIM &lt;- evaluate.fim(poped.db) 
FIM
get_rse(FIM,poped.db)

det(FIM)
ofv_fim(FIM,poped.db,ofv_calc_type=1) # det(FIM)
ofv_fim(FIM,poped.db,ofv_calc_type=2) # 1/trace_matrix(inv(FIM))
ofv_fim(FIM,poped.db,ofv_calc_type=4) # log(det(FIM)) 
ofv_fim(FIM,poped.db,ofv_calc_type=6) # Ds with fixed effects as "important"
ofv_fim(FIM,poped.db,ofv_calc_type=6,
        ds_index=c(1,1,1,0,0,0,1,1)) # Ds with random effects as "important"
ofv_fim(FIM,poped.db,ofv_calc_type=7) # 1/sum(get_rse(FIM,poped.db,use_percent=FALSE))

</code></pre>


</div>