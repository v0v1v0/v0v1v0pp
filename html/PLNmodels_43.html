<div class="container">

<table style="width: 100%;"><tr>
<td>PLNmixturefit</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>An R6 Class to represent a PLNfit in a mixture framework</h2>

<h3>Description</h3>

<p>The function <code>PLNmixture</code> produces a collection of models which are instances of object with class <code>PLNmixturefit</code>.
A <code>PLNmixturefit</code> (say, with k components) is itself a collection of k <code>PLNfit</code>.
</p>
<p>This class comes with a set of methods, some of them being useful for the user:
See the documentation for ...
</p>


<h3>Active bindings</h3>

<div class="r6-active-bindings">

<dl>
<dt><code>n</code></dt>
<dd>
<p>number of samples</p>
</dd>
<dt><code>p</code></dt>
<dd>
<p>number of dimensions of the latent space</p>
</dd>
<dt><code>k</code></dt>
<dd>
<p>number of components</p>
</dd>
<dt><code>d</code></dt>
<dd>
<p>number of covariates</p>
</dd>
<dt><code>components</code></dt>
<dd>
<p>components of the mixture (PLNfits)</p>
</dd>
<dt><code>latent</code></dt>
<dd>
<p>a matrix: values of the latent vector (Z in the model)</p>
</dd>
<dt><code>latent_pos</code></dt>
<dd>
<p>a matrix: values of the latent position vector (Z) without covariates effects or offset</p>
</dd>
<dt><code>posteriorProb</code></dt>
<dd>
<p>matrix ofposterior probability for cluster belonging</p>
</dd>
<dt><code>memberships</code></dt>
<dd>
<p>vector for cluster index</p>
</dd>
<dt><code>mixtureParam</code></dt>
<dd>
<p>vector of cluster proportions</p>
</dd>
<dt><code>optim_par</code></dt>
<dd>
<p>a list with parameters useful for monitoring the optimization</p>
</dd>
<dt><code>nb_param</code></dt>
<dd>
<p>number of parameters in the current PLN model</p>
</dd>
<dt><code>entropy_clustering</code></dt>
<dd>
<p>Entropy of the variational distribution of the cluster (multinomial)</p>
</dd>
<dt><code>entropy_latent</code></dt>
<dd>
<p>Entropy of the variational distribution of the latent vector (Gaussian)</p>
</dd>
<dt><code>entropy</code></dt>
<dd>
<p>Full entropy of the variational distribution (latent vector + clustering)</p>
</dd>
<dt><code>loglik</code></dt>
<dd>
<p>variational lower bound of the loglikelihood</p>
</dd>
<dt><code>loglik_vec</code></dt>
<dd>
<p>element-wise variational lower bound of the loglikelihood</p>
</dd>
<dt><code>BIC</code></dt>
<dd>
<p>variational lower bound of the BIC</p>
</dd>
<dt><code>ICL</code></dt>
<dd>
<p>variational lower bound of the ICL (include entropy of both the clustering and latent distributions)</p>
</dd>
<dt><code>R_squared</code></dt>
<dd>
<p>approximated goodness-of-fit criterion</p>
</dd>
<dt><code>criteria</code></dt>
<dd>
<p>a vector with loglik, BIC, ICL, and number of parameters</p>
</dd>
<dt><code>model_par</code></dt>
<dd>
<p>a list with the matrices of parameters found in the model (Theta, Sigma, Mu and Pi)</p>
</dd>
<dt><code>vcov_model</code></dt>
<dd>
<p>character: the model used for the covariance (either "spherical", "diagonal" or "full")</p>
</dd>
<dt><code>fitted</code></dt>
<dd>
<p>a matrix: fitted values of the observations (A in the model)</p>
</dd>
<dt><code>group_means</code></dt>
<dd>
<p>a matrix of group mean vectors in the latent space.</p>
</dd>
</dl>
</div>


<h3>Methods</h3>



<h4>Public methods</h4>


<ul>
<li> <p><a href="#method-PLNmixturefit-new"><code>PLNmixturefit$new()</code></a>
</p>
</li>
<li> <p><a href="#method-PLNmixturefit-optimize"><code>PLNmixturefit$optimize()</code></a>
</p>
</li>
<li> <p><a href="#method-PLNmixturefit-predict"><code>PLNmixturefit$predict()</code></a>
</p>
</li>
<li> <p><a href="#method-PLNmixturefit-plot_clustering_data"><code>PLNmixturefit$plot_clustering_data()</code></a>
</p>
</li>
<li> <p><a href="#method-PLNmixturefit-plot_clustering_pca"><code>PLNmixturefit$plot_clustering_pca()</code></a>
</p>
</li>
<li> <p><a href="#method-PLNmixturefit-postTreatment"><code>PLNmixturefit$postTreatment()</code></a>
</p>
</li>
<li> <p><a href="#method-PLNmixturefit-show"><code>PLNmixturefit$show()</code></a>
</p>
</li>
<li> <p><a href="#method-PLNmixturefit-print"><code>PLNmixturefit$print()</code></a>
</p>
</li>
<li> <p><a href="#method-PLNmixturefit-clone"><code>PLNmixturefit$clone()</code></a>
</p>
</li>
</ul>
<hr>
<a id="method-PLNmixturefit-new"></a>



<h4>Method <code>new()</code>
</h4>

<p>Optimize a the
</p>
<p>Initialize a <code>PLNmixturefit</code> model
</p>


<h5>Usage</h5>

<div class="r"><pre>PLNmixturefit$new(
  responses,
  covariates,
  offsets,
  posteriorProb,
  formula,
  control
)</pre></div>



<h5>Arguments</h5>

<div class="arguments">

<dl>
<dt><code>responses</code></dt>
<dd>
<p>the matrix of responses common to every models</p>
</dd>
<dt><code>covariates</code></dt>
<dd>
<p>the matrix of covariates common to every models</p>
</dd>
<dt><code>offsets</code></dt>
<dd>
<p>the matrix of offsets common to every models</p>
</dd>
<dt><code>posteriorProb</code></dt>
<dd>
<p>matrix ofposterior probability for cluster belonging</p>
</dd>
<dt><code>formula</code></dt>
<dd>
<p>model formula used for fitting, extracted from the formula in the upper-level call</p>
</dd>
<dt><code>control</code></dt>
<dd>
<p>a list for controlling the optimization.</p>
</dd>
</dl>
</div>


<hr>
<a id="method-PLNmixturefit-optimize"></a>



<h4>Method <code>optimize()</code>
</h4>

<p>Optimize a <code>PLNmixturefit</code> model
</p>


<h5>Usage</h5>

<div class="r"><pre>PLNmixturefit$optimize(responses, covariates, offsets, config)</pre></div>



<h5>Arguments</h5>

<div class="arguments">

<dl>
<dt><code>responses</code></dt>
<dd>
<p>the matrix of responses common to every models</p>
</dd>
<dt><code>covariates</code></dt>
<dd>
<p>the matrix of covariates common to every models</p>
</dd>
<dt><code>offsets</code></dt>
<dd>
<p>the matrix of offsets common to every models</p>
</dd>
<dt><code>config</code></dt>
<dd>
<p>a list for controlling the optimization</p>
</dd>
</dl>
</div>


<hr>
<a id="method-PLNmixturefit-predict"></a>



<h4>Method <code>predict()</code>
</h4>

<p>Predict group of new samples
</p>


<h5>Usage</h5>

<div class="r"><pre>PLNmixturefit$predict(
  newdata,
  type = c("posterior", "response", "position"),
  prior = matrix(rep(1/self$k, self$k), nrow(newdata), self$k, byrow = TRUE),
  control = PLNmixture_param(),
  envir = parent.frame()
)</pre></div>



<h5>Arguments</h5>

<div class="arguments">

<dl>
<dt><code>newdata</code></dt>
<dd>
<p>A data frame in which to look for variables, offsets and counts with which to predict.</p>
</dd>
<dt><code>type</code></dt>
<dd>
<p>The type of prediction required. The default <code>posterior</code> are posterior probabilities for each group ,
<code>response</code> is the group with maximal posterior probability and <code>latent</code> is the averaged latent coordinate (without
offset and nor covariate effects),
with weights equal to the posterior probabilities.</p>
</dd>
<dt><code>prior</code></dt>
<dd>
<p>User-specified prior group probabilities in the new data. The default uses a uniform prior.</p>
</dd>
<dt><code>control</code></dt>
<dd>
<p>a list-like structure for controlling the fit. See <code>PLNmixture_param()</code> for details.</p>
</dd>
<dt><code>envir</code></dt>
<dd>
<p>Environment in which the prediction is evaluated</p>
</dd>
</dl>
</div>


<hr>
<a id="method-PLNmixturefit-plot_clustering_data"></a>



<h4>Method <code>plot_clustering_data()</code>
</h4>

<p>Plot the matrix of expected mean counts (without offsets, without covariate effects) reordered according the inferred clustering
</p>


<h5>Usage</h5>

<div class="r"><pre>PLNmixturefit$plot_clustering_data(
  main = "Expected counts reorder by clustering",
  plot = TRUE,
  log_scale = TRUE
)</pre></div>



<h5>Arguments</h5>

<div class="arguments">

<dl>
<dt><code>main</code></dt>
<dd>
<p>character. A title for the plot.  An hopefully appropriate title will be used by default.</p>
</dd>
<dt><code>plot</code></dt>
<dd>
<p>logical. Should the plot be displayed or sent back as <code>ggplot</code> object</p>
</dd>
<dt><code>log_scale</code></dt>
<dd>
<p>logical. Should the color scale values be log-transform before plotting? Default is <code>TRUE</code>.</p>
</dd>
</dl>
</div>



<h5>Returns</h5>

<p>a <code>ggplot</code> graphic
</p>


<hr>
<a id="method-PLNmixturefit-plot_clustering_pca"></a>



<h4>Method <code>plot_clustering_pca()</code>
</h4>

<p>Plot the individual map of a PCA performed on the latent coordinates, where individuals are colored according to the memberships
</p>


<h5>Usage</h5>

<div class="r"><pre>PLNmixturefit$plot_clustering_pca(
  main = "Clustering labels in Individual Factor Map",
  plot = TRUE
)</pre></div>



<h5>Arguments</h5>

<div class="arguments">

<dl>
<dt><code>main</code></dt>
<dd>
<p>character. A title for the plot. An hopefully appropriate title will be used by default.</p>
</dd>
<dt><code>plot</code></dt>
<dd>
<p>logical. Should the plot be displayed or sent back as <code>ggplot</code> object</p>
</dd>
</dl>
</div>



<h5>Returns</h5>

<p>a <code>ggplot</code> graphic
</p>


<hr>
<a id="method-PLNmixturefit-postTreatment"></a>



<h4>Method <code>postTreatment()</code>
</h4>

<p>Update fields after optimization
</p>


<h5>Usage</h5>

<div class="r"><pre>PLNmixturefit$postTreatment(
  responses,
  covariates,
  offsets,
  weights,
  config_post,
  config_optim,
  nullModel
)</pre></div>



<h5>Arguments</h5>

<div class="arguments">

<dl>
<dt><code>responses</code></dt>
<dd>
<p>the matrix of responses common to every models</p>
</dd>
<dt><code>covariates</code></dt>
<dd>
<p>the matrix of covariates common to every models</p>
</dd>
<dt><code>offsets</code></dt>
<dd>
<p>the matrix of offsets common to every models</p>
</dd>
<dt><code>weights</code></dt>
<dd>
<p>an optional vector of observation weights to be used in the fitting process.</p>
</dd>
<dt><code>config_post</code></dt>
<dd>
<p>a list for controlling the post-treatment</p>
</dd>
<dt><code>config_optim</code></dt>
<dd>
<p>a list for controlling the optimization during the post-treatment computations</p>
</dd>
<dt><code>nullModel</code></dt>
<dd>
<p>null model used for approximate R2 computations. Defaults to a GLM model with same design matrix but not latent variable.</p>
</dd>
</dl>
</div>


<hr>
<a id="method-PLNmixturefit-show"></a>



<h4>Method <code>show()</code>
</h4>

<p>User friendly print method
</p>


<h5>Usage</h5>

<div class="r"><pre>PLNmixturefit$show()</pre></div>


<hr>
<a id="method-PLNmixturefit-print"></a>



<h4>Method <code>print()</code>
</h4>

<p>User friendly print method
</p>


<h5>Usage</h5>

<div class="r"><pre>PLNmixturefit$print()</pre></div>


<hr>
<a id="method-PLNmixturefit-clone"></a>



<h4>Method <code>clone()</code>
</h4>

<p>The objects of this class are cloneable with this method.
</p>


<h5>Usage</h5>

<div class="r"><pre>PLNmixturefit$clone(deep = FALSE)</pre></div>



<h5>Arguments</h5>

<div class="arguments">

<dl>
<dt><code>deep</code></dt>
<dd>
<p>Whether to make a deep clone.</p>
</dd>
</dl>
</div>




<h3>See Also</h3>

<p>The function <code>PLNmixture</code>, the class <code>PLNmixturefamily</code>
</p>


</div>