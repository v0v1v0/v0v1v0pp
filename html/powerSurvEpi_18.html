<div class="container">

<table style="width: 100%;"><tr>
<td>ssize.stratify</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>
Sample size calculation for Survival Analysis with Binary Predictor and Exponential Survival Function
</h2>

<h3>Description</h3>

<p>Sample size calculation for survival analysis with binary predictor and exponential survival function.
</p>


<h3>Usage</h3>

<pre><code class="language-R">ssize.stratify(
    power, 
    timeUnit, 
    gVec, 
    PVec, 
    HR, 
    lambda0Vec, 
    alpha = 0.05, 
    verbose = TRUE)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>power</code></td>
<td>

<p>numeric. Power of the test.
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>timeUnit</code></td>
<td>

<p>numeric. Total study length.
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>gVec</code></td>
<td>

<p>numeric. m by 1 vector. The s-th element is the proportion of the total sample size for 
the s-th stratum, where m is the number of strata.
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>PVec</code></td>
<td>

<p>numeric. m by 1 vector. The s-th element is the proportion of subjects in treatment group 1 for the s-th stratum, where m is the number of strata.
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>HR</code></td>
<td>

<p>numeric. Hazard ratio (Ratio of the hazard for treatment group 1 to the hazard for treatment group 0, i.e. reference group).
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>lambda0Vec</code></td>
<td>

<p>numeric. m by 1 vector. The s-th element is the hazard for treatment group 0 (i.e., reference group) in the s-th stratum.
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>alpha</code></td>
<td>

<p>numeric. Type I error rate.
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>verbose</code></td>
<td>

<p>Logical. Indicating if intermediate results will be output or not.
</p>
</td>
</tr>
</table>
<h3>Details</h3>

<p>We assume (1) there is only one predictor and no covariates in the survival model 
(exponential survival function); (2) there are <code>m</code> strata; (3) the predictor <code>x</code>
is a binary variable indicating treatment group 1 (<code class="reqn">x=1</code>) or treatment group 0
(<code class="reqn">x=0</code>); (3) the treatment effect is constant over time (proportional hazards);
(4) the hazard ratio is the same in all strata, and (5) the data will be analyzed by 
the stratified log rank test.
</p>
<p>The sample size formula is Formula (1) on page 801 of Palta M and Amini SB (1985):
</p>
<p style="text-align: center;"><code class="reqn">
n=(Z_{\alpha}+Z_{\beta})^2/\mu^2
</code>
</p>
 
<p>where <code class="reqn">\alpha</code> is the Type I error rate,
<code class="reqn">\beta</code> is the Type II error rate (power<code class="reqn">=1-\beta</code>),
<code class="reqn">Z_{\alpha}</code> is the <code class="reqn">100(1-\alpha)</code>-th percentile of standard normal distribution, and
</p>
<p style="text-align: center;"><code class="reqn">
\mu=\log(\delta)\sqrt{ \sum_{s=1}^{m} g_s P_s (1 - P_s) V_s }
</code>
</p>

<p>and
</p>
<p style="text-align: center;"><code class="reqn">
V_s=P_s\left[1-\frac{1}{\lambda_{1s}} \left\{
\exp\left[-\lambda_{1s}(T-1)\right]
-\exp(-\lambda_{1s}T)
\right\}
\right]
+(1-P_s)\left[
1-\frac{1}{\lambda_{0s}}
\left\{
\exp\left[-\lambda_{0s}(T-1)\right]
-\exp(-\lambda_{0s}T
\right\}
\right]
</code>
</p>

<p>In the above formulas, <code class="reqn">m</code> is the number of strata,
<code class="reqn">T</code> is the total study length, <code class="reqn">\delta</code> is the hazard ratio,
<code class="reqn">g_s</code> is the proportion of the total sample size in stratum <code class="reqn">s</code>,
<code class="reqn">P_s</code> is the proportion of stratum <code class="reqn">s</code>, which is in treatment group 1,
and <code class="reqn">\lambda_{is}</code> is the hazard for the <code class="reqn">i</code>-th treatment group in 
stratum <code class="reqn">s</code>.
</p>


<h3>Value</h3>

<p>The sample size.
</p>


<h3>References</h3>

<p>Palta M and Amini SB. (1985). 
Consideration of covariates and stratification in sample size determination for survival time studies. 
<em>Journal of Chronic Diseases</em>. 38(9):801-809.
</p>


<h3>See Also</h3>

<p><code>power.stratify</code>
</p>


<h3>Examples</h3>

<pre><code class="language-R">
# example on page 803 of Palta M and Amini SB. (1985). 
n &lt;- ssize.stratify(
  power = 0.9, 
  timeUnit = 1.25, 
  gVec = c(0.5, 0.5),
  PVec = c(0.5, 0.5), 
  HR = 1 / 1.91, 
  lambda0Vec = c(2.303, 1.139),
  alpha = 0.05, 
  verbose = TRUE
)

</code></pre>


</div>