<div class="container">

<table style="width: 100%;"><tr>
<td>heatmap_pvlrt</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>Heatmap, barplot and bubbleplot displaying likelihood ratio test results in
a <code>pvlrt</code> object</h2>

<h3>Description</h3>

<p>Heatmap, barplot and bubbleplot displaying likelihood ratio test results in
a <code>pvlrt</code> object
</p>


<h3>Usage</h3>

<pre><code class="language-R">heatmap_pvlrt(
  object,
  AE = NULL,
  Drug = NULL,
  grep = FALSE,
  fill_measure = "p_value",
  show_n = FALSE,
  show_lrstat = FALSE,
  show_p_value = FALSE,
  p_value_lower = 0,
  p_value_upper = 1,
  lrstat_lower = 0,
  lrstat_upper = Inf,
  n_lower = 0,
  n_upper = Inf,
  arrange_alphabetical = FALSE,
  remove_outside = FALSE,
  digits = 2,
  border_color = "black",
  fill_gradient_range = c("darkred", "white"),
  ...
)

## S3 method for class 'pvlrt'
barplot(
  height,
  AE = NULL,
  Drug = NULL,
  grep = FALSE,
  x_axis_measure = "lrstat",
  fill_measure = "p_value",
  show_n = FALSE,
  arrange_alphabetical = FALSE,
  show_p_value = FALSE,
  show_lrstat = FALSE,
  p_value_lower = 0,
  p_value_upper = 1,
  lrstat_lower = 0,
  lrstat_upper = Inf,
  n_lower = 0,
  n_upper = Inf,
  remove_outside = FALSE,
  digits = 2,
  Drug_nrow = 1,
  border_color = "black",
  x_axis_logscale = TRUE,
  fill_gradient_range = c("darkred", "white"),
  ...
)

bubbleplot_pvlrt(
  object,
  AE = NULL,
  Drug = NULL,
  grep = FALSE,
  x_axis_measure = "lrstat",
  fill_measure = "p_value",
  size_measure = "n",
  show_n = FALSE,
  arrange_alphabetical = FALSE,
  show_p_value = FALSE,
  show_lrstat = FALSE,
  p_value_lower = 0,
  p_value_upper = 1,
  lrstat_lower = 0,
  lrstat_upper = Inf,
  n_lower = 0,
  n_upper = Inf,
  remove_outside = FALSE,
  digits = 2,
  Drug_nrow = 1,
  border_color = "black",
  x_axis_logscale = TRUE,
  size_logscale = TRUE,
  fill_gradient_range = c("darkred", "white"),
  ...
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>object, height</code></td>
<td>
<p>pvlrt object; output of <code>pvlrt</code>()</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>AE</code></td>
<td>
<p>input parameter determining which adverse events to show in
the plot. This can be a numeric scalar  specifying the
number of <em>top</em> (in terms of computed LRT values) adverse events to show.
Alternatively, it can be a character vector, specifying the exact
adverse events to show. It can also be a vector of patterns to match
(ignores cases) against the full names of all available adverse events,
provided <code>grep</code> is set to TRUE. Defaults to adverse events
corresponding to the top M pairs where M = max(number of possible pairs, 50).
Set AE = Inf to force display of all adverse events.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>Drug</code></td>
<td>
<p>input parameter determining which drugs to show in
the plot. This can be a numeric scalar  specifying the
number of <em>top</em> (in terms of computed LRT values) drugs to show.
Alternatively, it can be a character vector, specifying the exact
drugs to show. It can also be a vector of patterns to match
(ignores cases) against the full names of all available drugs,
provided <code>grep</code> is set to TRUE. Defaults to drugs
corresponding to the top M pairs where M = max(number of possible pairs, 50).
Set Drug = Inf to force display all drugs.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>grep</code></td>
<td>
<p>logical. Match patterns against the supplied AE or Drug names?
Ignores if neither AE nor Drug is a character vector.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>fill_measure</code></td>
<td>
<p>Measure to govern the filling color in each cell
(in heatmap) or bar (in barplot) or circle/bubble (in bubbleplot) for each
drug/AE combination. Defaults to "p_value". Available choices are:
"p.value", "lrstat", and "n".</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>show_n</code></td>
<td>
<p>logical. show the sample size as inscribed text on each cell?</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>show_lrstat</code></td>
<td>
<p>logical. show the computed LRT statistic (on log-scale)
inscribed text on each cell?</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>show_p_value</code></td>
<td>
<p>logical. show the computed p-value as inscribed text on each cell?</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>p_value_lower, p_value_upper</code></td>
<td>
<p>lower and upper limits on the computed p-values to
display on the plot.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>lrstat_lower, lrstat_upper</code></td>
<td>
<p>lower and upper limits on the computed LRT values to
display on the plot.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>n_lower, n_upper</code></td>
<td>
<p>lower and upper limits on the computed sample sizes to
display on the plot.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>arrange_alphabetical</code></td>
<td>
<p>logical. should the rows (AEs) and columns (Drugs)
be arranged in alphabetical orders? Defaults to FALSE, in which case
the orderings of the computed LRT values are used.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>remove_outside</code></td>
<td>
<p>logical. Should the values for pairs with p-value, LRT
statistics or sample sizes falling outside of the provided ranges through p_value_lower, p_value_upper
etc., be replaced with <code>NA</code>? Defaults to FALSE. Setting this to TRUE may help
distinguish drugs or AEs which has some pairs falling within and some pairs falling
outside of the provided ranges better.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>digits</code></td>
<td>
<p>numeric. Number of decimal places to show on the
inscribed texts on the plot.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>border_color</code></td>
<td>
<p>character string. Specifies the border color of cells/bars.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>fill_gradient_range</code></td>
<td>
<p>character vector. Specifies the range of gradient colors used
for <code>fill_measure</code>. Passed into the <code>colours</code> argument of
<code>scale_fill_gradientn</code> from <code>ggplot2</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>...</code></td>
<td>
<p>Other arguments. Currently ignored</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>x_axis_measure</code></td>
<td>
<p>measure to show on the x-axis of the (horizontal) bar
plots. Defaults to "lrstat" available choices are "lrstat", "p_value" and "n".</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>Drug_nrow</code></td>
<td>
<p>Number of rows in the panels for Drugs for the barplots.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>x_axis_logscale</code></td>
<td>
<p>logical. Should the x axis measure in the bar plot or the bubble plot
be log transformed (more precisely, "log1p" transformed with the function
f(x) = log(1 + x))? Defaults to TRUE.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>size_measure</code></td>
<td>
<p>measure to govern sizes of the circles in the bubble plot.
Defaults to "n". Available choices are "lrstat", "p_value" and "n".</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>size_logscale</code></td>
<td>
<p>logical. Should the circle size measure in the the bubble plot
be log transformed (more precisely, "log1p" transformed with the function
f(x) = log(1 + x)). Defaults to TRUE.</p>
</td>
</tr>
</table>
<h3>Value</h3>

<p>A ggplot object.
</p>


<h3>See Also</h3>

<p>pvlrt
</p>


<h3>Examples</h3>

<pre><code class="language-R"># 500 bootstrap iterations (nsim) in the example below
# are for quick demonstration only --
# we recommended setting nsim to 10000 (default) or bigger
test1 &lt;- pvlrt(statin46, nsim = 500)
bubbleplot_pvlrt(test1)
heatmap_pvlrt(test1)
barplot(test1)


</code></pre>


</div>