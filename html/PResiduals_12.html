<div class="container">

<table style="width: 100%;"><tr>
<td>partial_Spearman</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>Partial Spearman's Rank Correlation</h2>

<h3>Description</h3>

<p><code>partial_Spearman</code> computes the partial Spearman's rank correlation between variable <var>X</var> and variable <var>Y</var> adjusting for other variables, <var>Z</var>.
The basic approach involves fitting a specified model of <var>X</var> on <var>Z</var>, a specified model of <var>Y</var> on <var>Z</var>, obtaining the probability-scale residuals from both models, and then calculating their Pearson's correlation.
<var>X</var> and <var>Y</var> can be any orderable variables, including continuous or discrete variables.
By default, <code>partial_Spearman</code> uses cumulative probability models (also referred as cumulative link models in literature) for both <var>X</var> on <var>Z</var> and <var>Y</var> on <var>Z</var> to preserve the rank-based nature of Spearman's correlation, since the model fit of cumulative probability models only depends on the order information of variables. However, for some specific types of variables, options of fitting parametric models are also available. See details in fit.x and fit.y
</p>


<h3>Usage</h3>

<pre><code class="language-R">partial_Spearman(
  formula,
  data,
  fit.x = "orm",
  fit.y = "orm",
  link.x = c("logit", "probit", "cloglog", "loglog", "cauchit", "logistic"),
  link.y = c("logit", "probit", "cloglog", "loglog", "cauchit", "logistic"),
  subset,
  na.action = getOption("na.action"),
  fisher = TRUE,
  conf.int = 0.95
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>formula</code></td>
<td>
<p>an object of class <code>Formula</code> (or one
that can be coerced to that class): a symbolic description of the
model to be fitted.  The details of model specification are given
under ‘Details’.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>data</code></td>
<td>
<p>an optional data frame, list or environment (or object
coercible by <code>as.data.frame</code> to a data frame)
containing the variables in the model.  If not found in
<code>data</code>, the variables are taken from
<code>environment(formula)</code>, typically the environment from which
<code>partial_Spearman</code> is called.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>fit.x, fit.y</code></td>
<td>
<p>the fitting functions used for the models of X or Y on Z.
The default function is ‘<span class="samp">⁠orm⁠</span>’, which fits cumulative probability models for continuous or discrete ordinal variables. Other options include ‘<span class="samp">⁠lm⁠</span>’, which fits linear regression models and obtains the probability-scale residuals by assuming normality;
‘<span class="samp">⁠lm.emp⁠</span>’, which fits linear regression models and obtains the probability-scale residuals by empirical ranking;
‘<span class="samp">⁠poisson⁠</span>’, which fits Poisson models for count variables; ‘<span class="samp">⁠nb⁠</span>’, which fits negative binomial models for count variables; and ‘<span class="samp">⁠logistic⁠</span>’, which fits logistic regression models for binary variables.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>link.x, link.y</code></td>
<td>
<p>the link family to be used for the ordinal model of
<var>X</var> on <var>Z</var>.  Defaults to ‘<span class="samp">⁠logit⁠</span>’. Other options are
‘<span class="samp">⁠probit⁠</span>’, ‘<span class="samp">⁠cloglog⁠</span>’, ‘<span class="samp">⁠loglog⁠</span>’, ‘<span class="samp">⁠cauchit⁠</span>’ and ‘<span class="samp">⁠logistic⁠</span>’ (equivalent with ‘<span class="samp">⁠logit⁠</span>’). Used only when
‘<span class="samp">⁠fit.x⁠</span>’ is ‘<span class="samp">⁠orm⁠</span>’.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>subset</code></td>
<td>
<p>an optional vector specifying a subset of
observations to be used in the fitting process.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>na.action</code></td>
<td>
<p>action to take when <code>NA</code> present in data.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>fisher</code></td>
<td>
<p>logical indicating whether to apply fisher transformation to compute confidence intervals and p-values for the correlation.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>conf.int</code></td>
<td>
<p>numeric specifying confidence interval coverage.</p>
</td>
</tr>
</table>
<h3>Details</h3>

<p>To compute the partial Spearman's rank correlation between <var>X</var> and <var>Y</var> adjusting for <var>Z</var>, ‘<span class="samp">⁠formula⁠</span>’ is specified as <code><var>X</var> | <var>Y</var> ~ <var>Z</var></code>.
This indicates that models of <code><var>X</var> ~ <var>Z</var></code> and
<code><var>Y</var> ~ <var>Z</var></code> will be fit.
</p>


<h3>Value</h3>

<p>object of ‘<span class="samp">⁠partial_Spearman⁠</span>’ class.
</p>


<h3>References</h3>

<p>Li C and Shepherd BE (2012)
A new residual for ordinal outcomes.
<em>Biometrika</em>. <b>99</b>: 473–480.
</p>
<p>Shepherd BE, Li C, Liu Q (2016)
Probability-scale residuals for continuous, discrete, and censored data.
<em>The Canadian Jouranl of Statistics</em>. <b>44</b>:463–476.
</p>
<p>Liu Q, Shepherd BE, Wanga V, Li C (2018)
Covariate-Adjusted Spearman's Rank Correlation with Probability-Scale Residuals.
<em>Biometrics</em>. <b>74</b>:595–605.
</p>


<h3>See Also</h3>

<p><code>print.partial_Spearman</code>
</p>


<h3>Examples</h3>

<pre><code class="language-R">data(PResidData)
#### fitting cumulative probability models for both Y and W
partial_Spearman(c|w ~ z,data=PResidData)
#### fitting a cumulative probability model for W and a poisson model for c
partial_Spearman(c|w~z, fit.x="poisson",data=PResidData)
partial_Spearman(c|w~z, fit.x="poisson", fit.y="lm.emp", data=PResidData )
</code></pre>


</div>