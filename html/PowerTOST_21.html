<div class="container">

<table style="width: 100%;"><tr>
<td>CVpooled</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>Pooled CV from several studies</h2>

<h3>Description</h3>

<p>This function pools CVs of several studies.
</p>


<h3>Usage</h3>

<pre><code class="language-R">CVpooled(CVdata, alpha = 0.2, logscale = TRUE, robust = FALSE)
## S3 method for class 'CVp'
print(x, digits = 4, verbose = FALSE, ...)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>CVdata</code></td>
<td>

<p>A data.frame that must contain the columns <code>CV</code>, <code>n</code> and <code>design</code> 
where <code>CV</code> are the error CVs from the studies, <code>n</code> the number of subjects 
and design is a character string describing the study design.<br>
See <code>known.designs()</code> for designs covered in this package.<br>
If the design column is missing the classical 2×2 crossover is assumed for each study.
A message is displayed under that circumstances.<br><br>
A data.frame that contains the columns <code>CV</code> and giving the degrees of freedom 
<code>df</code> directly is also accepted as <code>CVdata</code>.
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>alpha</code></td>
<td>

<p>Error probability for calculating an upper confidence limit of the pooled CV.<br>
Recommended 0.2–0.25 for use in subsequent sample size estimation.<br>
See f.i one of H. Schütz’ <a href="https://bebac.at/lectures/MU2010-CD2.pdf">presentations</a>.
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>logscale</code></td>
<td>

<p>Should the calculations be done for log-transformed data? Defaults to <code style="white-space: pre;">⁠TRUE⁠</code>. 
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>robust</code></td>
<td>

<p>Defaults to <code style="white-space: pre;">⁠FALSE⁠</code>.<br>
Set to <code style="white-space: pre;">⁠TRUE⁠</code> will use the degrees of freedom according to the ‘robust’ evaluation
(aka Senn’ basic estimator). These dfs are calculated as <code>n-seq</code>.<br>
They are also often more appropriate if the CV comes from a ‘true’ mixed effects model 
evaluation (FDA model for average bioequivalence).<br>
See <code>known.designs()$df2</code> for the designs covered in this package.
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>x</code></td>
<td>
<p>An object of class <code>"CVp"</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>digits</code></td>
<td>
<p>Number of significant digits for the <code>CV</code> and the <code>CL</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>verbose</code></td>
<td>
<p>Defaults to <code>FALSE</code>. Prints only the pooled <code>CV</code> and <code>df</code>.<br>
If set to <code style="white-space: pre;">⁠TRUE⁠</code> the upper confidence limit is also printed.
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>...</code></td>
<td>
<p>More args to print(). None used.</p>
</td>
</tr>
</table>
<h3>Details</h3>

<p>The pooled CV is obtained from the weighted average of the error variances obtained from 
the CVs of the single studies, weights are the degrees of freedom <code>df</code>.<br>
If only <code>n</code> is given in the input <code>CVdata</code>, the dfs are calculated via
the formulas given in <code>known.designs()</code>. If both <code>n</code> and <code>df</code> are given
the <code>df</code> column precedes.<br><br>
If <code>logscale=TRUE</code> the error variances are obtained via function <code>CV2se()</code>.
Otherwise the pooled CV is obtained via pooling the CV^2.
</p>


<h3>Value</h3>

<p>A list of class <code>"CVp"</code> with components
</p>
<table>
<tr style="vertical-align: top;">
<td><code>CV</code></td>
<td>
<p>value of the pooled CV</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>df</code></td>
<td>
<p>pooled degrees of freedom</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>CVupper</code></td>
<td>
<p>upper confidence interval of the pooled CV</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>alpha</code></td>
<td>
<p>input value</p>
</td>
</tr>
</table>
<p>The class <code>"CVp"</code> has a S3 methods <code>print.CVp</code>.
</p>


<h3>Warning</h3>

<p>Pooling of CVs from parallel group and crossover designs does not make any sense.<br>
Also the function <em>does not</em> throw an error if you do so.
</p>


<h3>Note</h3>

<p>The calculations for <code>logscale=FALSE</code> are not described in the references.
They are implemented by analogy to the case via log-transformed data.<br>
The calculations are based on a common variance of Test and Reference formulations 
in replicate crossover studies or a parallel group study, respectively.
</p>


<h3>Author(s)</h3>

<p>D. Labes
</p>


<h3>References</h3>

<p>H. Schütz’ <a href="https://bebac.at:443/Lectures.phtml">presentations</a> about sample size challenges.
</p>
<p>Patterson S, Jones B. <em>Bioequivalence and Statistics in Clinical Pharmacology.</em> Boca Raton: Chapman &amp; Hall / CRC Press; 2<sup>nd</sup> edition 2017. Chapter 5.7 “Determining Trial Size”.
</p>


<h3>See Also</h3>

<p><code>known.designs, CVfromCI </code>
</p>


<h3>Examples</h3>

<pre><code class="language-R"># some data:
# the values for AUC, study 1 and study 2 are Example 3 of H. Schuetz' presentation
CVs &lt;- ("
 PKmetric | CV   |  n |design| source
    AUC   | 0.20 | 24 | 2x2  | study 1
    Cmax  | 0.25 | 24 | 2x2  | study 1
    AUC   | 0.30 | 12 | 2x2  | study 2
    Cmax  | 0.31 | 12 | 2x2  | study 2
    AUC   | 0.25 | 12 | 2x2x4| study 3 (full replicate)
")
txtcon &lt;- textConnection(CVs)
CVdata &lt;- read.table(txtcon, header = TRUE, sep = "|",
                    strip.white = TRUE, as.is = TRUE)
close(txtcon)

# evaluation of the AUC CVs
CVsAUC &lt;- subset(CVdata, PKmetric == "AUC")
CVpooled(CVsAUC, alpha = 0.2, logscale = TRUE)
# df of the 'robust' evaluation
CVpooled(CVsAUC, alpha = 0.2, logscale = TRUE, robust = TRUE)
# print also the upper CL, data example 3
CVsAUC3 &lt;- subset(CVsAUC,design != "2x2x4")
print(CVpooled(CVsAUC3, alpha = 0.2, robust = TRUE), digits = 3, verbose = TRUE)
# will give the output:
# Pooled CV = 0.235 with 32 degrees of freedom (robust dfs)
# Upper 80% confidence limit of CV = 0.266
#
# Combining CVs from studies evaluated by ANOVA (robust=FALSE) and
# by a mixed effects model (robust=TRUE). dfs have to be provided!
CVs &lt;- ("
  CV    |  n |design| source  | model | df
  0.212 | 24 | 2x2  | study 1 | fixed | 22
  0.157 | 27 | 3x3  | study 2 | fixed | 50
  0.148 | 27 | 3x3  | study 3 | mixed | 24
")
txtcon &lt;- textConnection(CVs)
CVdata &lt;- read.table(txtcon, header = TRUE, sep = "|",
                     strip.white = TRUE, as.is = TRUE)
close(txtcon)
print(CVpooled(CVdata, alpha = 0.2), digits = 3, verbose = TRUE)
# will give the output:
# Pooled CV = 0.169 with 96 degrees of freedom
# Upper 80% confidence limit of CV = 0.181
</code></pre>


</div>