<div class="container">

<table style="width: 100%;"><tr>
<td>linkage.gp</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>Calculate recombination frequency, LOD and phase using genotype probabilities</h2>

<h3>Description</h3>

<p><code>linkage.gp</code> is used to calculate recombination frequency, LOD and phase within one type of marker or between two types of markers.
</p>


<h3>Usage</h3>

<pre><code class="language-R">linkage.gp(
  probgeno_df,
  chk,
  pardose = NULL,
  markertype1 = c(1, 0),
  markertype2 = NULL,
  target_parent = match.arg(c("P1", "P2")),
  G2_test = FALSE,
  LOD_threshold = 0,
  prefPars = c(0, 0),
  combinations_per_iter = NULL,
  iter_RAM = 500,
  ncores = 2,
  verbose = TRUE,
  check_qall_mult = FALSE,
  method = "approx",
  log = NULL
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>probgeno_df</code></td>
<td>
<p>A data frame as read from the scores file produced by function <code>saveMarkerModels</code> of R package <code>fitPoly</code>, or alternatively, a data frame containing the following columns:
</p>

<dl>
<dt>SampleName</dt>
<dd>
<p>Name of the sample (individual)
</p>
</dd>
<dt>MarkerName</dt>
<dd>
<p>Name of the marker
</p>
</dd>
<dt>P0</dt>
<dd>
<p>Probabilities of dosage score '0'
</p>
</dd>
<dt>P1...</dt>
<dd>
<p>Probabilities of dosage score '1' etc. (up to max dosage, e.g. P4 for tetraploid population)
</p>
</dd>
<dt>maxP</dt>
<dd>
<p>Maximum genotype probability identified for a particular individual and marker combination
</p>
</dd>
<dt>maxgeno</dt>
<dd>
<p>Most probable dosage for a particular individual and marker combination
</p>
</dd>
<dt>geno</dt>
<dd>
<p>Most probable dosage for a particular individual and marker combination, if <code>maxP</code> exceeds a user-defined threshold (e.g. 0.9), otherwise <code>NA</code></p>
</dd>
</dl>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>chk</code></td>
<td>
<p>Output list as returned by function <code>checkF1</code></p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>pardose</code></td>
<td>
<p>Option to include the most likely (discrete) parental dosage scores, used mainly for internal calls of this function. By default <code>NULL</code></p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>markertype1</code></td>
<td>
<p>A vector of length 2 specifying the first markertype to compare. The first element specifies the dosage in <code>target_parent</code> (and the second in the other parent).</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>markertype2</code></td>
<td>
<p>A vector of length 2 specifying the first markertype to compare. This argument is optional. If not specified, the function will calculate
linkage within the markertype as specified by <code>markertype1</code>.
The first element specifies the dosage in <code>target_parent</code> (and the second in the other parent).</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>target_parent</code></td>
<td>
<p>Which parent is being targeted (only acceptable options are "P1" or "P2"), ie. which parent is of specific interest? 
If this is the maternal parent, please specify as "P1". If the paternal parent, please use "P2". The actual identifiers of the two parents are
entered using the arguments <code>parent1_replicates</code> and <code>parent2_replicates</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>G2_test</code></td>
<td>
<p>Apply a G2 test (LOD of independence) in addition to the LOD of linkage.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>LOD_threshold</code></td>
<td>
<p>Minimum LOD score of linkages to report. Recommended to use for large number (&gt; millions) of marker comparisons in order to reduce memory usage.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>prefPars</code></td>
<td>
<p>The estimates for preferential pairing parameters for parent 1 and 2, in range 0 &lt;= p &lt; 2/3. By default this is c(0,0) (so, no preferential pairing).
See the function <code>test_prefpairing</code> and the vignette for more details.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>combinations_per_iter</code></td>
<td>
<p>Optional integer. Number of marker combinations per iteration.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>iter_RAM</code></td>
<td>
<p>A (very) conservative estimate of working memory in megabytes used per core. It only takes the size frequency matrices into account. Actual usage is more, especially with large number of linkages that are reported. Reduce memory usage by using a higher LOD_threshold.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>ncores</code></td>
<td>
<p>Number of cores to use. Works both for Windows and UNIX (using <code>doParallel</code>). Use <code>parallel::detectCores()</code> to find out how many cores you have available.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>verbose</code></td>
<td>
<p>Should messages be sent to stdout?</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>check_qall_mult</code></td>
<td>
<p>Check the <code>qall_mult</code> column of <code>chk</code>, and filter out markers with <code>qall_mult = 0</code>. By default <code>FALSE</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>method</code></td>
<td>
<p>Either <code>"approx"</code> or <code>"mappoly"</code>. If <code>"approx"</code> (the default method), then an approximated estimator is used which introduces
a small amount of bias in the estimator of recombination frequency. If method <code>"mappoly"</code> is specified, the full likelihood is used in the
estimation, leading to an unbiased estimator (this has been implemented in the mappoly package of Marcelo Mollinari). The <code>mappoly</code> method has
higher computational demands which may introduce problems for larger datasets, but will lead to higher accuracy overall.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>log</code></td>
<td>
<p>Character string specifying the log filename to which standard output should be written. If NULL log is send to stdout.</p>
</td>
</tr>
</table>
<h3>Value</h3>

<p>Returns a data.frame with columns:
</p>

<dl>
<dt>marker_a:</dt>
<dd>
<p>first marker of comparison. If markertype2 is specified, it has the type of markertype1.
</p>
</dd>
<dt>marker_b:</dt>
<dd>
<p>second marker of comparison. It has the type of markertype2 if specified.
</p>
</dd>
<dt>r:</dt>
<dd>
<p>recombination frequency
</p>
</dd>
<dt>LOD:</dt>
<dd>
<p>LOD score associated with r
</p>
</dd>
<dt>phase:</dt>
<dd>
<p>phase between markers
</p>
</dd>
</dl>
<h3>Examples</h3>

<pre><code class="language-R">data("gp_df","chk1")
SN_SN_P1.gp &lt;- linkage.gp(probgeno_df = gp_df,
                          chk = chk1,
                          markertype1 = c(1,0),
                          target_parent = "P1")
</code></pre>


</div>