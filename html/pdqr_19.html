<div class="container">

<table style="width: 100%;"><tr>
<td>form_regrid</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>Change grid of pdqr-function</h2>

<h3>Description</h3>

<p>Modify grid of pdqr-function (rows of "x_tbl" metadata) to
increase (upgrid) or decrease (downgrid) granularity using method of choice.
Upgridding might be useful in order to obtain more information during certain
type of transformations. Downgridding might be useful for decreasing amount
of used memory for storing pdqr-function without losing much information.
</p>


<h3>Usage</h3>

<pre><code class="language-R">form_regrid(f, n_grid, method = "x")
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>f</code></td>
<td>
<p>A pdqr-function.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>n_grid</code></td>
<td>
<p>A desired number of grid elements in output.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>method</code></td>
<td>
<p>Regrid method. Should be one of "x" or "q".</p>
</td>
</tr>
</table>
<h3>Details</h3>

<p>The goal here is to create pdqr-function which is reasonably similar
to <code>f</code> and has <code>n_grid</code> rows in "x_tbl" metadata.
</p>
<p>General algorithm of regridding is as follows:
</p>

<ul>
<li> <p><strong>Compute reference grid</strong>. For method "x" it is a sequence of equidistant
points between edges of <code>f</code>'s support. For method "q" -
sequence of quantiles for equidistant probabilities from 0 to 1. Lengths of
reference grids for both methods are <code>n_grid</code>.
</p>
</li>
<li> <p><strong>Adjust <code>f</code>'s grid to reference one</strong>. This is done depending on <code>f</code>'s
type and which kind or regridding is done (upgridding is the
case when <code>n_grid</code> is strictly more than number of rows in "x_tbl" metadata,
downgridding - when it is strictly less):
</p>

<ul>
<li>
<p> Type "discrete":
</p>

<ul>
<li>
<p> UPgridding "discrete" functions is not possible as it is assumed
that input "discrete" functions can't have any "x" values other then
present ones. In this case input is returned, the only case when
output doesn't have desired <code>n_grid</code> rows in "x_tbl" metadata.
</p>
</li>
<li>
<p> DOWNgridding "discrete" functions is done by computing nearest
match of reference grid to <code>f</code>'s one and collapsing (by summing
probabilities) all "x" values from input to the nearest matched ones.
Here "computing nearest match" means that every element of reference
grid is one-one matched with subset of unique values from <code>f</code>'s "x"
elements. Matching is done in greedy iterative fashion in order to
minimize total distance between reference grid and matched subset.
<strong>Note</strong> that this can result in not optimal (with not minimum total
distance) match and can take a while to compute in some cases.
</p>
</li>
</ul>
</li>
<li>
<p> Type "continuous":
</p>

<ul>
<li>
<p> UPgridding "continuous" functions is done by adding rows to "x_tbl"
metadata with "x" values equal to those elements of reference grid
which are the furthest away from input "x" grid as a set. Distance
from point to set is meant as minimum of distances between point and
all points of set. Values of "y" and "cumprob" columns are taken as
values of corresponding to <code>f</code> d- and p-functions.
</p>
</li>
<li>
<p> DOWNgridding "continuous" functions is done by computing nearest
match of reference grid to <code>f</code>'s one (as for "discrete" type) and
removing all unmatched rows from "x_tbl" metadata.
</p>
</li>
</ul>
</li>
</ul>
</li>
</ul>
<p>Special cases of <code>n_grid</code>:
</p>

<ul>
<li>
<p> If <code>n_grid</code> is the same as number of rows in "x_tbl" metadata, then input
<code>f</code> is returned.
</p>
</li>
<li>
<p> If <code>n_grid</code> is 1, appropriate <code style="white-space: pre;">⁠new_*()⁠</code> function is used with single
numeric input equal to distribution's median.
</p>
</li>
</ul>
<h3>Value</h3>

<p>A pdqr-function with modified grid.
</p>


<h3>See Also</h3>

<p><code>form_resupport()</code> for changing support of pdqr-function.
</p>
<p><code>form_retype()</code> for changing type of pdqr-function.
</p>
<p>Other form functions: 
<code>form_estimate()</code>,
<code>form_mix()</code>,
<code>form_resupport()</code>,
<code>form_retype()</code>,
<code>form_smooth()</code>,
<code>form_tails()</code>,
<code>form_trans()</code>
</p>


<h3>Examples</h3>

<pre><code class="language-R"># Type "discrete"
d_dis &lt;- new_d(data.frame(x = 1:10, prob = 1:10 / 55), type = "discrete")

# Downgridding
meta_x_tbl(form_regrid(d_dis, n_grid = 4))
meta_x_tbl(form_regrid(d_dis, n_grid = 4, method = "q"))

# Upgridding for "discrete" type isn't possible. Input is returned
identical(d_dis, form_regrid(d_dis, n_grid = 100))

# Type "continuous"
# Downgridding
d_norm &lt;- as_d(dnorm)
plot(d_norm)
lines(form_regrid(d_norm, n_grid = 10), col = "blue")
lines(form_regrid(d_norm, n_grid = 10, method = "q"), col = "green")

# Upgridding
d_con &lt;- new_d(data.frame(x = 1:3, y = rep(0.5, 3)), type = "continuous")
meta_x_tbl(form_regrid(d_con, n_grid = 6))

# Pdqr-function with center at median is returned in case `n_grid` is 1
form_regrid(d_dis, n_grid = 1)
# Dirac-like function is returned
form_regrid(d_con, n_grid = 1)
</code></pre>


</div>