<div class="container">

<table style="width: 100%;"><tr>
<td>partProb</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>Partition outlier probabilities</h2>

<h3>Description</h3>

<p>Assigns outlier probabilities to the partitions by fitting an exponential 
distribution to a nonparametric outlier statistic for simulated
data or partition centroids.
</p>


<h3>Usage</h3>

<pre><code class="language-R">partProb( simData, method = c("intrinsic","distance","logdensity","distdens",
          "density"), shrink = 1, nproj = 1000, seed = NULL)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>simData</code></td>
<td>

<p>Observations from a call to <code>simData</code>, which includes
the partition centroids and (optionally) simulated data as well.
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>method</code></td>
<td>
<p>One of the following options:
</p>

<table>
<tr>
<td style="text-align: left;">
  <code>"intrinsic"</code> </td>
<td style="text-align: center;"> : </td>
<td style="text-align: left;"> outlier statistic applied to simulation data 
                     (centroids if no simulation) </td>
</tr>
<tr>
<td style="text-align: left;">
  <code>"distance"</code> </td>
<td style="text-align: center;"> : </td>
<td style="text-align: left;"> outlier statistic applied to distances between
                      NN partitions </td>
</tr>
<tr>
<td style="text-align: left;">
  <code>"logdensity"</code> </td>
<td style="text-align: center;"> : </td>
<td style="text-align: left;"> outlier statistic applied to
             differences in log density between NN partitions</td>
</tr>
<tr>
<td style="text-align: left;">
  <code>"distdens"</code> </td>
<td style="text-align: center;"> : </td>
<td style="text-align: left;"> outlier statistic applied to a matrix
        consisting of the <code>"distance"</code> and
             <code>"logdensity"</code> values </td>
</tr>
<tr>
<td style="text-align: left;">
  <code>"density"</code> </td>
<td style="text-align: center;"> : </td>
<td style="text-align: left;"> outlier statistic applied to
             smallest/largest ratios of density between NN partitions
   </td>
</tr>
</table>
<p>The default is to use the <code>"intrinsic"</code> method.
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>shrink</code></td>
<td>

<p>Shrinkage parameter for outlier detection data. The offsets from
<code>simData</code> are scaled by this factor before adding them to the
partition centroids as data for outlier detection. The default
value is <code>shrink = 1</code>, so that no shrinkage is applied to
simulation offsets.
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>nproj</code></td>
<td>

<p>If the data is multivariate or <code>method = "distdens"</code>, 
the number of random projections to be used
to obtain the outlier statistic.
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>seed</code></td>
<td>

<p>An optional integer argument to <code>set.seed</code> for reproducible
outlier statistics. By default the current seed will be used.
Reproducibility can also be achieved by calling <code>set.seed</code>
before calling <code>partProb</code>.
</p>
</td>
</tr>
</table>
<h3>Details</h3>

<p><code>"logdensity"</code> is generally prefered over <code>"density"</code>, because
negative values that are large in magniude
of the logarithm of the density will not be 
numerically distinguishable as density values.
</p>


<h3>Value</h3>

<p>A vector of probabilities for each partition, obtained by fitting an
exponential distribution to the outlier statistic.
</p>


<h3>References</h3>

<p>C. Fraley, Estimating Outlier Probabilities for Large Datasets, 2017.
</p>


<h3>See Also</h3>

<p><code>simData</code>,
<code>OutlierStatistic</code>,
<code>allProb</code>
</p>


<h3>Examples</h3>

<pre><code class="language-R">
 set.seed(0)

 lead &lt;- leader(faithful)
 nlead &lt;- length(lead[[1]]$partitions)

# repeat multiple times to account for randomness
 ntimes &lt;- 100
 probs &lt;- matrix( NA, nlead, ntimes)
 for (i in 1:ntimes) {
    probs[,i] &lt;- partProb( simData(lead[[1]]), method = "distance")
 }

# median probability for each partition
 partprobs &lt;- apply( probs, 1, median)

 quantile(probs)

# plot leaders with outlier probability &gt; .95
 plot( faithful[,1], faithful[,2], pch = 16, cex = .5,
       main = "red : leaders with outlier probability &gt; .95")
 out &lt;- partprobs &gt; .95
 l &lt;- lead[[1]]$leaders
 points( faithful[l[out],1], faithful[l[out],2], pch = 8, cex = 1, col = "red")

</code></pre>


</div>