<div class="container">

<table style="width: 100%;"><tr>
<td>find_spikes</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>Find spikes</h2>

<h3>Description</h3>

<p>This function finds spikes in a numeric vector using the algorithm of
Whitaker and Hayes (2018). Spikes are values in spectra that are unusually
high or low compared to neighbors. They are usually individual values or very
short runs of similar "unusual" values. Spikes caused by cosmic radiation are
a frequent problem in Raman spectra. Another source of spikes are "hot
pixels" in CCD and diode arrays. Other kinds of accidental "outlayers" will
be also detected.
</p>


<h3>Usage</h3>

<pre><code class="language-R">find_spikes(
  x,
  x.is.delta = FALSE,
  z.threshold = 9,
  max.spike.width = 8,
  na.rm = FALSE
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>x</code></td>
<td>
<p>numeric vector containing spectral data.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>x.is.delta</code></td>
<td>
<p>logical Flag indicating if x contains already differences.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>z.threshold</code></td>
<td>
<p>numeric Modified Z values larger than <code>z.threshold</code>
are considered to be spikes.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>max.spike.width</code></td>
<td>
<p>integer Wider regions with high Z values are not detected as
spikes.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>na.rm</code></td>
<td>
<p>logical indicating whether <code>NA</code> values should be stripped
before searching for spikes.</p>
</td>
</tr>
</table>
<h3>Details</h3>

<p>Spikes are detected based on a modified Z score calculated from the
differenced spectrum. The Z threshold used should be adjusted to the
characteristics of the input and desired sensitivity. The lower the
threshold the more stringent the test becomes, resulting in most cases in
more spikes being detected. A modified version of the algorithm is used if
a value different from <code>NULL</code> is passed as argument to
<code>max.spike.width</code>. In such a case, an additional step filters out
broader spikes (or falsely detected steep slopes) from the returned values.
</p>


<h3>Value</h3>

<p>A logical vector of the same length as <code>x</code>. Values that are TRUE
correspond to local spikes in the data.
</p>


<h3>References</h3>

<p>Whitaker, D. A.; Hayes, K. (2018) A simple algorithm for despiking Raman
spectra. Chemometrics and Intelligent Laboratory Systems, 179, 82-84.
</p>


<h3>See Also</h3>

<p>Other peaks and valleys functions: 
<code>find_peaks()</code>,
<code>get_peaks()</code>,
<code>peaks()</code>,
<code>replace_bad_pixs()</code>,
<code>spikes()</code>,
<code>valleys()</code>,
<code>wls_at_target()</code>
</p>


<h3>Examples</h3>

<pre><code class="language-R">
with(white_led.raw_spct,
     which(find_spikes(counts_3, z.threshold = 30)))

</code></pre>


</div>