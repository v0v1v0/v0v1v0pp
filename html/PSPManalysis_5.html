<div class="container">

<table style="width: 100%;"><tr>
<td>PSPMequi</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>Bifurcation analysis of a structured population model</h2>

<h3>Description</h3>

<p><code>PSPMequi</code> computes bifurcation curves for a physiologically structured
population model as a function of one or two parameters and detects bifurcation
points along these curves.
When computing equilibrium curves of a physiologically structured population model
as a function of one parameter, <code>PSPMequi</code> can detect transcritical
bifurcation points (branching points, BP) of both the structured populations as
well as environment variables (BPE), limit points (LP) in the equilibrium curve
and evolutionary stationary points (ESS). The location of these bifurcation points
can subsequently be computed as a function of second parameter.
In addition <code>PSPMequi</code> can compute the pairwise invasion plot (PIP) as a
function of the resident and a mutant value for one evolving parameter.
</p>


<h3>Usage</h3>

<pre><code class="language-R">PSPMequi(
  modelname = NULL,
  biftype = NULL,
  startpoint = NULL,
  stepsize = NULL,
  parbnds = NULL,
  parameters = NULL,
  minvals = NULL,
  maxvals = NULL,
  options = NULL,
  clean = FALSE,
  force = FALSE,
  debug = FALSE,
  silent = FALSE
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>modelname</code></td>
<td>
<p>(string, required)
</p>

<p>Basename of the file with the model specification. The file
should have an extension ".h". For example, the model "PNAS2002"
is specified in the file "PNAS2002.h". If the model is specified 
in R include the .R extension explicitly, i.e. specify the model
name as "PNAS2002.R"</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>biftype</code></td>
<td>
<p>(string, required)
</p>

<p>Type of bifurcation to compute: "BP", "BPE", "EQ", "LP", "ESS" or "PIP"</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>startpoint</code></td>
<td>
<p>(row vector, required)
</p>

<p>The initial point from which to start the continuation of
the curve</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>stepsize</code></td>
<td>
<p>(double value, required)
</p>

<p>Value of the step size in the first bifurcation parameter</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>parbnds</code></td>
<td>
<p>(row vector, required)
</p>

<p>Vector of length 3 for EQ continuation, length 6 for BP, BPE, 
LP and PIP continuation and 3+4*N for ESS continuation.
The first triplet specifies:
Each triples specifies:
</p>

<p><code style="white-space: pre;">⁠parbnds[1]⁠</code>: the index of the first bifurcation parameter
(in case the model is specified in R, this can be
a string with the name of the parameter as specified
in the variable 'DefaultParameters')
</p>

<p><code style="white-space: pre;">⁠parbnds[2]⁠</code>: lower threshold, below which value of the
first bifurcation parameter the computation stops
</p>

<p><code style="white-space: pre;">⁠parbnds[3]⁠</code>: upper threshold, above which value of the
first bifurcation parameter the computation stops
</p>

<p>In case of two-parameter bifurcations, the second triplet specifies:
</p>

<p><code style="white-space: pre;">⁠parbnds[4]⁠</code>: the index of the second bifurcation parameter
(in case the model is specified in R, this can be
a string with the name of the parameter as specified
in the variable 'DefaultParameters')
</p>

<p><code style="white-space: pre;">⁠parbnds[5]⁠</code>: lower threshold, below which value of the
second bifurcation parameter the computation stops
</p>

<p><code style="white-space: pre;">⁠parbnds[6]⁠</code>: upper threshold, above which value of the
second bifurcation parameter the computation stops
</p>
<p>In case of ESS continuation, consecutive sets of 4 values specify:
</p>
<p><code style="white-space: pre;">⁠parbnds[4*n]⁠</code>:   the index of population that is impacted by the
parameter at its ESS value
(in case the model is specified in R, this can be
a string with the name of the parameter as specified
in the variable 'DefaultParameters')
<code style="white-space: pre;">⁠parbnds[4*n+1]⁠</code>: the index of the parameter at its ESS value
<code style="white-space: pre;">⁠parbnds[4*n+2]⁠</code>: lower threshold, below which value of this ESS
parameter the computation stops
<code style="white-space: pre;">⁠parbnds[4*n+3]⁠</code>: upper threshold, above which value of this ESS
parameter the computation stops</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>parameters</code></td>
<td>
<p>(row vector, optional, can be left equal to its default NULL)
</p>

<p>Vector of length PARAMETER_NR (set in the model program
file; This is the length of the variable 'DefaultParameters' if the
model is specified in R), specifying the values for the model
parameters to use in the computation. Vectors of other lengths,
including an empty vector will be ignored.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>minvals</code></td>
<td>
<p>(row vector, optional, can be left equal to its default NULL)
</p>

<p>Vector of length (ENVIRON_DIM + POPULATION_NR), specifying minimum 
values for the environmental variables and the population birth rates,
at which computations will stop.  Vectors of other lengths, including
an empty vector will be ignored.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>maxvals</code></td>
<td>
<p>(row vector, optional, can be left equal to its default NULL)
</p>

<p>Vector of length (ENVIRON_DIM + POPULATION_NR), specifying maximum 
values for the environmental variables and the population birth rates,
at which computations will stop. Vectors of other lengths, including 
an empty vector will be ignored.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>options</code></td>
<td>
<p>(row vector of strings, optional, can be left equal to its default NULL)
</p>

<p>Vector with pairs of strings, consisting of an option name and a value (for
example c("popBP", "1")) or single options (i.e. c("test")).
Possible option names and their values are:
</p>

<p><code style="white-space: pre;">⁠"envBP", "&lt;index&gt;"⁠</code>: Index of environment variable, of which
to continue the transcritical bifurcation
</p>

<p><code style="white-space: pre;">⁠"popBP", "&lt;index&gt;"⁠</code>: Index of structured population, of which
to continue the transcritical bifurcation
</p>

<p><code style="white-space: pre;">⁠"popEVO", "&lt;index&gt;"⁠</code>: Index of structured population, for
which to compute the selection gradient or
perform PIP continuation
</p>

<p><code style="white-space: pre;">⁠"parEVO", "&lt;index&gt;"⁠</code>: Index of parameter, for which to
compute the selection gradient
</p>

<p><code style="white-space: pre;">⁠"envZE", "&lt;index&gt;"⁠</code>: Index of environment variable in
trivial equilibrium (can be used
multiple times)
</p>

<p><code style="white-space: pre;">⁠"popZE", "&lt;index&gt;"⁠</code>: Index of structured population in
trivial equilibrium (can be used
multiple times)
</p>

<p><code style="white-space: pre;">⁠"isort", "&lt;index&gt;"⁠</code>: Index of i-state variable to use as
ruling variable for sorting the
structured populations
</p>

<p><code style="white-space: pre;">⁠"report", "&lt;value&gt;"⁠</code>: Interval between consecutive output of 
computed points to the console ( &gt;= 1). 
Minimum value of 1 implies output of every 
point
</p>

<p><code style="white-space: pre;">⁠"noBP"⁠</code>: Do not check for branching points while
computing equilibrium curves
</p>

<p><code style="white-space: pre;">⁠"noLP"⁠</code>: Do not check for limit points while
computing equilibrium curves
</p>

<p><code style="white-space: pre;">⁠"single"⁠</code>: Only compute the first point of the
solution curve, do not continue the curve
</p>

<p><code style="white-space: pre;">⁠"test"⁠</code>: Perform only a single integration over
the life history, reporting dynamics
of survival, R0, i-state and
interaction variables</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>clean</code></td>
<td>
<p>(Boolean, optional argument)
</p>

<p>Specify clean = TRUE as argument to remove all the result files
of the model before the computation</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>force</code></td>
<td>
<p>(Boolean, optional argument)
</p>

<p>Specify force = TRUE as argument to force a rebuilding of the model
before the computation</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>debug</code></td>
<td>
<p>(Boolean, optional argument)
</p>

<p>Specify debug = TRUE as argument to compile the model in verbose
mode and with debugging flag set</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>silent</code></td>
<td>
<p>(Boolean, optional argument)
</p>

<p>Specify silent = TRUE as argument to suppress reporting of compilation
commands and results on the console</p>
</td>
</tr>
</table>
<h3>Details</h3>

<p>output &lt;- PSPMequi(modelname = NULL, biftype = NULL, startpoint = NULL,
stepsize = NULL, parbnds = NULL, parameters = NULL, 
minvals = NULL, maxvals = NULL,
options = NULL, clean = FALSE, force  = FALSE,
debug  = FALSE, silent = FALSE)
</p>


<h3>Value</h3>

<p>The output is a list containing the following elements:
</p>

<p><code style="white-space: pre;">⁠curvepoints⁠</code>: Matrix with output for all computed points along the curve
</p>

<p><code style="white-space: pre;">⁠curvedesc⁠</code>:   Column vector with strings, summarizing the numerical details
of the computed curve (i.e., initial point, parameter values,
numerical settings used)
</p>

<p><code style="white-space: pre;">⁠bifpoints⁠</code>:   Matrix with the located bifurcation points along the curve
</p>

<p><code style="white-space: pre;">⁠biftypes⁠</code>:    Column vector of strings, containing a description of the
type of bifurcation for each of the located bifurcation points
</p>


<h3>Examples</h3>

<pre><code class="language-R">## Not run: 
PSPMequi("Indet_growth", "EQ", c(1, 0.22, 0), -0.1, c(6, 0.8, 1.0),
         options = c("popEVO", "0"), silent = TRUE)

## End(Not run)

</code></pre>


</div>