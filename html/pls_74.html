<div class="container">

<table style="width: 100%;"><tr>
<td>var.jack</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>Jackknife Variance Estimates of Regression Coefficients</h2>

<h3>Description</h3>

<p>Calculates jackknife variance or covariance estimates of regression
coefficients.
</p>
<p>The original (Tukey) jackknife variance estimator is defined as <code class="reqn">(g-1)/g
\sum_{i=1}^g(\tilde\beta_{-i} - \bar\beta)^2</code>, where <code class="reqn">g</code> is the number
of segments, <code class="reqn">\tilde\beta_{-i}</code> is the estimated coefficient when
segment <code class="reqn">i</code> is left out (called the jackknife replicates), and
<code class="reqn">\bar\beta</code> is the mean of the <code class="reqn">\tilde\beta_{-i}</code>.  The most common
case is delete-one jackknife, with <code class="reqn">g = n</code>, the number of observations.
</p>
<p>This is the definition <code>var.jack</code> uses by default.
</p>
<p>However, Martens and Martens (2000) defined the estimator as <code class="reqn">(g-1)/g
\sum_{i=1}^g(\tilde\beta_{-i} - \hat\beta)^2</code>, where <code class="reqn">\hat\beta</code> is the
coefficient estimate using the entire data set.  I.e., they use the original
fitted coefficients instead of the mean of the jackknife replicates.  Most
(all?) other jackknife implementations for PLSR use this estimator.
<code>var.jack</code> can be made to use this definition with <code>use.mean =
FALSE</code>.  In practice, the difference should be small if the number of
observations is sufficiently large.  Note, however, that all theoretical
results about the jackknife refer to the ‘proper’ definition.  (Also note
that this option might disappear in a future version.)
</p>


<h3>Usage</h3>

<pre><code class="language-R">var.jack(object, ncomp = object$ncomp, covariance = FALSE, use.mean = TRUE)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>object</code></td>
<td>
<p>an <code>mvr</code> object.  A cross-validated model fitted with
<code>jackknife = TRUE</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>ncomp</code></td>
<td>
<p>the number of components to use for estimating the
(co)variances</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>covariance</code></td>
<td>
<p>logical.  If <code>TRUE</code>, covariances are calculated;
otherwise only variances.  The default is <code>FALSE</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>use.mean</code></td>
<td>
<p>logical.  If <code>TRUE</code> (default), the mean coefficients
are used when estimating the (co)variances; otherwise the coefficients from
a model fitted to the entire data set.  See Details.</p>
</td>
</tr>
</table>
<h3>Value</h3>

<p>If <code>covariance</code> is <code>FALSE</code>, an <code class="reqn">p\times q \times c</code>
array of variance estimates, where <code class="reqn">p</code> is the number of predictors,
<code class="reqn">q</code> is the number of responses, and <code class="reqn">c</code> is the number of components.
</p>
<p>If <code>covariance</code> id <code>TRUE</code>, an <code class="reqn">pq\times pq \times c</code> array of
variance-covariance estimates.
</p>


<h3>Warning</h3>

<p>Note that the Tukey jackknife variance estimator is not
unbiased for the variance of regression coefficients (Hinkley 1977).  The
bias depends on the <code class="reqn">X</code> matrix.  For ordinary least squares regression
(OLSR), the bias can be calculated, and depends on the number of
observations <code class="reqn">n</code> and the number of parameters <code class="reqn">k</code> in the mode.  For
the common case of an orthogonal design matrix with <code class="reqn">\pm 1</code> levels,
the delete-one jackknife estimate equals <code class="reqn">(n-1)/(n-k)</code> times the
classical variance estimate for the regression coefficients in OLSR.
Similar expressions hold for delete-d estimates.  Modifications have been
proposed to reduce or eliminate the bias for the OLSR case, however, they
depend on the number of parameters used in the model.  See e.g. Hinkley
(1977) or Wu (1986).
</p>
<p>Thus, the results of <code>var.jack</code> should be used with caution.
</p>


<h3>Author(s)</h3>

<p>Bjørn-Helge Mevik
</p>


<h3>References</h3>

<p>Tukey J.W. (1958) Bias and Confidence in Not-quite Large
Samples. (Abstract of Preliminary Report).  <em>Annals of Mathematical
Statistics</em>, <b>29</b>(2), 614.
</p>
<p>Martens H. and Martens M. (2000) Modified Jack-knife Estimation of Parameter
Uncertainty in Bilinear Modelling by Partial Least Squares Regression
(PLSR).  <em>Food Quality and Preference</em>, <b>11</b>, 5–16.
</p>
<p>Hinkley D.V. (1977), Jackknifing in Unbalanced Situations.
<em>Technometrics</em>, <b>19</b>(3), 285–292.
</p>
<p>Wu C.F.J. (1986) Jackknife, Bootstrap and Other Resampling Methods in
Regression Analysis.  <em>Te Annals of Statistics</em>, <b>14</b>(4),
1261–1295.
</p>


<h3>See Also</h3>

<p><code>mvrCv</code>, <code>jack.test</code>
</p>


<h3>Examples</h3>

<pre><code class="language-R">
data(oliveoil)
mod &lt;- pcr(sensory ~ chemical, data = oliveoil, validation = "LOO",
           jackknife = TRUE)
var.jack(mod, ncomp = 2)

</code></pre>


</div>