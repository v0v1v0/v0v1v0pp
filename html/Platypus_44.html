<div class="container">

<table style="width: 100%;"><tr>
<td>VDJ_GEX_overlay_clones</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>Overlay clones on GEX projection</h2>

<h3>Description</h3>

<p>Highlights the cells belonging to any number of top clonotypes or of specifically selected clonotypes from one or more samples or groups in a GEX dimensional reduction.
</p>


<h3>Usage</h3>

<pre><code class="language-R">VDJ_GEX_overlay_clones(
  GEX,
  reduction,
  n.clones,
  clones.to.plot,
  by.sample,
  by.other.group,
  ncol.facet,
  pt.size,
  clone.colors,
  others.color,
  split.plot.and.legend,
  platypus.version
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>GEX</code></td>
<td>
<p>A single seurat object from VDJ_GEX_matrix, which also includes VDJ information in the metadata (set integrate.VDJ.to.GEX to TRUE in the VDJ_GEX_matrix function) (VDJ_GEX_matrix.output[[2]]) ! Clone ids and frequencies are drawn from the columns "clonotype_id" and "clonotype_frequency"</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>reduction</code></td>
<td>
<p>Character. Defaults to "umap". Name of the reduction to overlay clones on. Can be "pca", "umap", "tsne"</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>n.clones</code></td>
<td>
<p>Integer. Defaults to 5. To PLOT TOP N CLONES. Number of Top clones to plot. If either by.sample or by.group is TRUE, n.clones clones from each sample or group will be overlayed</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>clones.to.plot</code></td>
<td>
<p>Character. Alternative to n.clones. TO PLOT SPECIFIC CLONES. Must reference a column in the GEX@meta.data filled with TRUE and FALSE. Entries with TRUE label are plotted. Such a column may be generated using GEX@metadata$clones_to_plot_column &lt;- GEX@metadata$Some_cell_identifier == "Interesting"</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>by.sample</code></td>
<td>
<p>Boolean. Defaults to FALSE. Whether to overlay clones by sample. If set to TRUE this will generate a facet_wrap plot with as many facets as samples.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>by.other.group</code></td>
<td>
<p>Character string. Defaults to "none". Must be a valid column name of the metadata of the input seurat object. If so, this will generate a facet_wrap plot with as many facets unique entries in the specified column. This may be useful to plot cell type specific clones</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>ncol.facet</code></td>
<td>
<p>Integer. Defaults to 2. Number of columns in the facet_wrap plot if by.sample or by.group is TRUE</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>pt.size</code></td>
<td>
<p>Numeric. Defaults to 1. Size of points in DimPlot. Passed to Seurat::DimPlot</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>clone.colors</code></td>
<td>
<p>Character vector. Defaults to rainbow(n.clones). Colors to use for individual clones. One can provide either a vector of length n.clones or a of length Nr. of samples/groups \* n.clones. In case that a vector of length n.clones is provided and by.group or by.sample is TRUE, colors are repeated for each sample/group</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>others.color</code></td>
<td>
<p>Character. Color for cells that are not selected i.e. not part of the overlayed clonotypes. Defaults to "grey80". To hide the rest of the umap set to "white"</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>split.plot.and.legend</code></td>
<td>
<p>Boolean. Defaults to FALSE. Whether to return the plot and the legend separately as a list. This can be useful if legends get large and distort the actual plots. The packages gridExtra and cowplot are required for this. If set to TRUE a list is returned where out[[1]] is the plot which can be printed just by executing out[[1]]; out[[2]] is the legend, which can be printed either using plot(out[[2]]) or grid.arrange(out[[2]])</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>platypus.version</code></td>
<td>
<p>Character. At the moment this function runs only on the output of the VDJ_GEX_matrix function meaning that it is exclusively part of Platypus "v3". With further updates the functionality will be extended.</p>
</td>
</tr>
</table>
<h3>Value</h3>

<p>A ggplot object or a list of a ggplot and a gtable legend (if split.plot.and.legend \=\= TRUE). Theme, colors etc. may be changed directly by adding new elements to this output (e.g. out \+ theme_minimal())
</p>


<h3>Examples</h3>

<pre><code class="language-R">
overlay_clones_plot &lt;- VDJ_GEX_overlay_clones(
GEX = Platypus::small_vgm[[2]], reduction = "umap"
,n.clones = 5, by.sample = FALSE
,by.other.group = "none", pt.size = 1,split.plot.and.legend = FALSE)

overlay_clones_plot &lt;- VDJ_GEX_overlay_clones(
GEX = Platypus::small_vgm[[2]], reduction = "umap"
,n.clones = 5, by.sample = TRUE, by.other.group = "none"
,pt.size = 1,ncol.facet = 2, split.plot.and.legend = FALSE)

overlay_clones_plot &lt;- VDJ_GEX_overlay_clones(
GEX = Platypus::small_vgm[[2]], reduction = "umap"
,n.clones = 5, by.sample = TRUE, by.other.group = "group_id", pt.size = 1
,ncol.facet = 2, split.plot.and.legend = TRUE)

</code></pre>


</div>