<div class="container">

<table style="width: 100%;"><tr>
<td>plsmooth</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>Smooth and Reference Line Plotting</h2>

<h3>Description</h3>

<p>These functions add smooths or reference lines to an existing pl plot.
</p>


<h3>Usage</h3>

<pre><code class="language-R">plsmooth(x = NULL, y = NULL, ysec = NULL, band=NULL, power = NULL,
  group = NULL, weight = NULL, smooth = TRUE,
  plargs = NULL, ploptions = NULL, xy = TRUE, ...)

plsmoothline(smoothline = NULL, x = NULL, y = NULL, ysec = NULL,
  smooth.col = NULL, smooth.lty = NULL, smooth.lwd = NULL, 
  plargs = NULL, ploptions = NULL, marpar = NULL, ...)

plrefline(refline, x=NULL, innerrange=NULL, y=NULL,
  cutrange = c(x = TRUE, y = FALSE), plargs=NULL, ploptions=NULL, ...)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>x, y</code></td>
<td>
<p>coordinates for the horizontal and veritical axis,
respectively. If <code>NULL</code>, they will be retrieved from
<code>plargs$pldata</code>.
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>ysec</code></td>
<td>
<p>for <code>plsmooth, plsmoothline</code>:
matrix of secondary y values. The smooths generated or given by its
columns will be drawn thinner and with paled color.
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>band</code></td>
<td>
<p>logical: should a band (e.g., a confidence band)
be drawn together with the smooth?
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>power</code></td>
<td>
<p>for <code>plsmooth</code>: smooth will be calcutated for
<code>y^power</code> and the back-transformed. Usually, <code>power=0</code>.
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>group</code></td>
<td>
<p>for <code>plsmooth</code>: grouping variable.
If <code>NULL</code>, the variable <code>.smooth.group.</code> column in
<code>plargs$pldata</code> will be used if available.
If <code>group</code> is of length 1, there will be no grouping
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>weight</code></td>
<td>
<p>weights of observations used for generating the smooth</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>smooth</code></td>
<td>
<p>logical: should smooth be done? Will almost always be
<code>TRUE</code></p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>smoothline</code></td>
<td>
<p>for <code>plsmoothline</code>: result of a smooth fitting</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>smooth.col, smooth.lty, smooth.lwd</code></td>
<td>
<p>for <code>plsmoothline</code>:
color, line type and line width for the smooth line(s).
By default, they will be taken from ploptions.
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>refline</code></td>
<td>
<p>for <code>plrefline</code>:
A two element vector giving intercept and slope of a straight line, 
or a function that returns these as the first 2 elemnts of the
result's <code>coef</code> component, such as <code>lm</code>.
For more possibilities, see Details.
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>innerrange</code></td>
<td>
<p>for <code>plrefline</code>: inner range in x direction -
only needed if the refline should be clipped at a range different
from the <code>innerrange</code> attribute of the horizontal variable</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>cutrange</code></td>
<td>
<p>for <code>plrefline</code>: logical vector of length 2:
should the reference line(s) be cut at the inner plotting ranges in
x- and y-direction?
Otherwise, it will be continued outside it with the appropriate
transformation.
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>plargs, ploptions</code></td>
<td>
<p>result of <code>pl.control</code>, see Details
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>marpar</code></td>
<td>
<p>margin parameters, if already available.
By default, they will be retieved from <code>ploptions</code>.
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>xy</code></td>
<td>
<p>logical: should the coordinates be obtained as in
high level graphics? This is set to <code>FALSE</code> to save time and
avoid complications, in case the user is sure that <code>x</code> and
<code>y</code> are vectors rather than formulas or variable names.
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>...</code></td>
<td>
<p>absorbs extra arguments</p>
</td>
</tr>
</table>
<h3>Details</h3>

<p>The argument <code>refline</code> accepts different types of values.
If it is a function, it must either accept a formula
(which will be <code>y~x</code>) as its first argument or
<code>x</code> and <code>y</code> as the first two arguments.<br>
Alternatively, <code>refline</code> can be
a list with components <code>x</code> and <code>y</code>
and possibly a component <code>band</code> that contains the coordinates
of the line (or lines, if <code>y</code> is a matrix) and the width of
a band around it (that is, additional lines, to be drawn with
<code>ploptions("refline.col")[2]</code>).<br>
In order to obtain more than one reference line, a list of such
items may be given. It should not have compontents named
<code>coef, coefficients, x</code> or <code>y</code>, since it would otherwise
be mistaken for an argument of the types just described.
The components may carry attributes <code>lty, lwd</code> and <code>lcol</code>
to specify the properties of the lines individually. See Examples.
</p>
<p><code>plsmooth</code> and <code>plrefline</code> are very similar.
They are both called by high level pl functions.
<code>plsmooth</code> gets its smoothing function from
<code>ploptions("smooth.function")</code>.
Their properties (line type, width, color) come from different
sets of pl options. <code>plsmooth</code> can also respect a group
structure in the data.
</p>
<p>If <code>x</code> or <code>y</code> has an attribute <code>"numvalues"</code>,
these are used as the values to calculate the smooth or the
refline.
</p>
<p><code>plargs</code> and <code>ploptions</code> may be specified explicitly,
but they are usually generated by calling <code>pl.control</code>.
</p>
<p>The argument <code>getpar</code> is used for setting the graphical
parameters <code>mar, mgp</code> according to <code>ploptions</code>?
This is needed if the high level pl function has changed <code>mar</code>,
since this change has been reversed when the function was left.
By default, these graphical parameters will be retieved from
<code>pl.envir$ploptions</code>.
</p>


<h3>Value</h3>

<p><code>plsmooth</code> invisibly returns the data.frame needed for
drawing the smooth line. The other functions return <code>NULL</code>
</p>


<h3>Author(s)</h3>

<p>Werner A. Stahel
</p>


<h3>See Also</h3>

<p>pl.control
</p>


<h3>Examples</h3>

<pre><code class="language-R">plyx(Sepal.Width ~ Sepal.Length, data=iris, smooth=TRUE,
  smooth.group=Species, pch=Species)
plsmooth(smooth.group=FALSE)

## plrefline  called from  plyx
plyx(Sepal.Width ~ Sepal.Length, data=iris, smooth=TRUE, pch=Species,
     smooth.group=iris$Species, refline=lm)
## more reference lines
plrefline(list(c(-2,1), structure(c(-2.3,1), lcol="purple", lty=1)))
</code></pre>


</div>