<div class="container">

<table style="width: 100%;"><tr>
<td>parfm</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>Parametric Frailty Models</h2>

<h3>Description</h3>

<p>Fits parametric Frailty Models by maximizing the marginal likelihood.</p>


<h3>Usage</h3>

<pre><code class="language-R">parfm(formula, cluster = NULL, strata = NULL, data,
      inip = NULL, iniFpar = NULL,
      dist = c("weibull", "inweibull", "frechet", "exponential", 
               "gompertz", "loglogistic", "lognormal", "logskewnormal"),
      frailty   = c("none", "gamma", "ingau", "possta",
                    "lognormal", "loglogistic"),
      method = "nlminb", 
      maxit = 500, Fparscale = 1, showtime = FALSE, correct = 0)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>formula</code></td>
<td>
<p>A <code>formula</code> object, with the response on the left of a ~
operator,
and the terms on the right.
The response must be a survival object as returned by the <code>Surv()</code>
function.
The status indicator 'event' in the Surv object must be 0=alive, 1=dead.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>cluster</code></td>
<td>
<p>The name of a cluster variable in data.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>strata</code></td>
<td>
<p>The name of a strata variable in data.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>data</code></td>
<td>
<p>A <code>data.frame</code> in which to interpret the variables named in
the formula.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>inip</code></td>
<td>
<p>The vector of initial values.
First components are for the baseline hazard parameters according to
the order
given in 'details';
Other components are for the regression parameters according to the
order given
in 'formula'.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>iniFpar</code></td>
<td>
<p>The initial value of the frailty parameter.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>dist</code></td>
<td>

<p>The baseline hazard distribution.
One of <code>weibull</code>, <code>inweibull</code>, <code>frechet</code>, <code>exponential</code>,
<code>gompertz</code>, <code>lognormal</code>, <code>loglogistic</code>, or <code>logskewnormal</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>frailty</code></td>
<td>

<p>The Frailty distribution.
One of: <code>none</code>, <code>gamma</code>, <code>ingau</code>, <code>possta</code> or <code>lognormal</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>method</code></td>
<td>
<p>The optimisation method from the function <code>optimx()</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>maxit</code></td>
<td>
<p>Maximum number of iterations (see <code>optimx()</code>).</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>Fparscale</code></td>
<td>
<p>the scaling value for the frailty parameter in <code>optimx()</code>. 
Optimisation is performed on Fpar/Fparscale.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>showtime</code></td>
<td>
<p>Show the execution time?</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>correct</code></td>
<td>
<p>A correction factor that does not change the marginal
log-likelihood except for an additive constant given by
#clusters * correct * log(10). It may be useful in order to get finite
log-likelihood values in case of many events per cluster
with Positive Stable frailties. Note that the value of the
log-likelihood in the output is the re-adjusted value.</p>
</td>
</tr>
</table>
<h3>Details</h3>

<p><strong>Baseline hazards</strong>
</p>
<p>The Weibull hazard (<code>dist="weibull"</code>) is
</p>
<p style="text-align: center;"><code class="reqn">h(t; \rho, \lambda) = \rho \lambda t^{\rho - 1}</code>
</p>

<p>with <code class="reqn">\rho, \lambda &gt; 0</code>.
</p>
<p>The inverse Weibull (or Fr√©chet) hazard (<code>dist="inweibull"</code> or <code>dist="frechet"</code>) is
</p>
<p style="text-align: center;"><code class="reqn">h(t; \rho, \lambda) = \frac{\rho \lambda t^{-\rho - 1}}{\exp(\lambda t^{-\rho}) - 1}</code>
</p>

<p>with <code class="reqn">\rho, \lambda &gt; 0</code>.
</p>
<p>The exponential hazard (<code>dist="exponential"</code>) is
</p>
<p style="text-align: center;"><code class="reqn">h(t; \lambda) = \lambda</code>
</p>

<p>with <code class="reqn">\lambda &gt; 0</code>.
</p>
<p>The Gompertz hazard (<code>dist="gompertz"</code>) is
</p>
<p style="text-align: center;"><code class="reqn">h(t; \gamma, \lambda) = \lambda \exp ( \gamma t )</code>
</p>

<p>with <code class="reqn">\gamma, \lambda &gt; 0</code>.
</p>
<p>The lognormal hazard (<code>dist="lognormal"</code>) is
</p>
<p style="text-align: center;"><code class="reqn">h(t; \mu, \sigma) = \frac{\phi \left( \frac{\log ( t ) - \mu}{\sigma}\right)}{\sigma t \left[ 1 - \Phi \left( \frac{\log ( t ) - \mu}{\sigma}\right)\right]}</code>
</p>

<p>with <code class="reqn">\mu \in   {R}, \sigma &gt; 0</code>, and where
<code class="reqn">\phi</code> and <code class="reqn">\Phi</code> are the density and distribution functions of a standard Normal random variable.
</p>
<p>The loglogistic hazard (<code>dist="loglogistic"</code>) is
</p>
<p style="text-align: center;"><code class="reqn">h(t; \alpha, \kappa) = \frac{\exp ( \alpha ) \kappa t^{\kappa - 1}}{1 + \exp ( \alpha ) t^{\kappa}}</code>
</p>

<p>with <code class="reqn">\alpha \in   {R}, \kappa &gt; 0</code>.
</p>
<p>The log-skew-normal hazard (<code>dist="logskewnormal"</code>) is 
obtained as the ratio between the density and the cumulative distribution function
of a log-skew normal random variable (Azzalini, 1985),
which has density
</p>
<p style="text-align: center;"><code class="reqn">f(t; \xi, \omega, \alpha) = \frac{2}{\omega t}
    \phi\left(\frac{\log(t) - \xi}{\omega}\right)
    \Phi\left(\alpha\frac{\log(t)-\xi}{\omega}\right)</code>
</p>

<p>with <code class="reqn">\xi \in {R}, \omega &gt; 0, \alpha \in {R}</code>, and where
<code class="reqn">\phi</code> and <code class="reqn">\Phi</code> are the density and distribution functions of a standard Normal random variable.
Of note, if <code class="reqn">\alpha=0</code> then the log-skew-normal boils down 
to the log-normal distribution, with <code class="reqn">\mu=\xi</code> and <code class="reqn">\sigma=\omega</code>.
</p>
<p><strong>Frailty distributions</strong>
</p>
<p>The gamma frailty distribution (<code>frailty="gamma"</code>) is
</p>
<p style="text-align: center;"><code class="reqn">f ( u ) = \frac{\theta^{-\frac{1}{\theta}} u^{\frac{1}{\theta} - 1} \exp \left( - u / \theta \right)}	{\Gamma ( 1 / \theta )}</code>
</p>

<p>with <code class="reqn">\theta &gt; 0</code> and where <code class="reqn">\Gamma ( \cdot )</code> is the gamma function.
</p>
<p>The inverse Gaussian frailty distribution (<code>frailty="ingau"</code>) is
</p>
<p style="text-align: center;"><code class="reqn">f(u) = \frac1{\sqrt{2 \pi \theta}} u^{- \frac32} \exp \left( - \frac{(u-1)^2}{2 \theta u}  \right)</code>
</p>

<p>with <code class="reqn">\theta &gt; 0</code>.
</p>
<p>The positive stable frailty distribution (<code>frailty="poosta"</code>) is
</p>
<p style="text-align: center;"><code class="reqn">f(u) = f(u) = - \frac1{\pi u} \sum_{k=1}^{\infty} \frac{\Gamma ( k (1 - \nu ) + 1 )}{k!} \left( - u^{ \nu - 1} \right)^{k} \sin ( ( 1 - \nu ) k \pi )</code>
</p>

<p>with <code class="reqn">0 &lt; \nu &lt; 1</code>.
</p>
<p>The lognormal frailty distribution (<code>frailty="lognormal"</code>) is
</p>
<p style="text-align: center;"><code class="reqn">f(u) = \frac1{\sqrt{2 \pi \theta}} u^{-1} \exp \left( - \frac{\log(u)^2}{2 \theta}  \right)</code>
</p>

<p>with <code class="reqn">\theta &gt; 0</code>.
As the Laplace tranform of the lognormal frailties does not exist in closed form,
the saddlepoint approximation is used (Goutis and Casella, 1999).
</p>


<h3>Value</h3>

<p>An object of class <code>parfm</code>.</p>


<h3>Author(s)</h3>

<p>Federico Rotolo [aut, cre],
  Marco Munda [aut],
  Andrea Callegaro [ctb]
</p>


<h3>References</h3>

<p>Munda M, Rotolo F, Legrand C (2012).
parfm: Parametric Frailty Models in R.
Journal of Statistical Software, 51(11), 1-20. 
DOI &lt;doi: <a href="https://doi.org/10.18637/jss.v051.i11">10.18637/jss.v051.i11</a>&gt;
</p>
<p>Duchateau L, Janssen P (2008). The frailty model. Springer.
</p>
<p>Wienke A (2010).
Frailty Models in Survival Analysis. 
Chapman &amp; Hall/CRC biostatistics series. Taylor and Francis.
</p>
<p>Goutis C, Casella G (1999).
Explaining the Saddlepoint Approximation.
The American Statistician 53(3), 216-224.
DOI &lt;doi: <a href="https://doi.org/10.1080/00031305.1999.10474463">10.1080/00031305.1999.10474463</a>&gt;
</p>
<p>Azzalini A (1985).
A class of distributions which includes the normal ones.
Scandinavian Journal of Statistics, 12(2):171-178.
</p>


<h3>See Also</h3>

<p><code>select.parfm</code>,
<code>ci.parfm</code>,
<code>predict.parfm</code>
</p>


<h3>Examples</h3>

<pre><code class="language-R">#------Kidney dataset------
data(kidney) 
 # type 'help(kidney)' for a description of the data set
kidney$sex &lt;- kidney$sex - 1

parfm(Surv(time,status) ~ sex + age, cluster = "id",
      data = kidney, dist = "exponential", frailty = "gamma")
      
      

parfm(Surv(time,status) ~ sex + age, cluster = "id",
      data = kidney, dist = "exponential", frailty = "lognormal")

parfm(Surv(time,status) ~ sex + age, cluster = "id",
      data = kidney, dist = "weibull", frailty = "ingau")

parfm(Surv(time,status) ~ sex + age, cluster = "id",
      data = kidney, dist="gompertz", frailty="possta", method="CG")


parfm(Surv(time,status) ~ sex + age, cluster = "id",
      data = kidney, dist="logskewnormal", frailty="possta", method = 'BFGS')
#--------------------------

#------Asthma dataset------
data(asthma)
head(asthma)
  # type 'help(asthma)' for a description of the data set

asthma$time &lt;- asthma$End - asthma$Begin
parfm(Surv(time, Status) ~ Drug, cluster = "Patid", data = asthma,
      dist = "weibull", frailty = "gamma")
      
parfm(Surv(time, Status) ~ Drug, cluster = "Patid", data = asthma,
      dist = "weibull", frailty = "lognormal")

parfm(Surv(Begin, End, Status) ~ Drug, cluster = "Patid", 
      data = asthma[asthma$Fevent == 0, ],
      dist = "weibull", frailty = "lognormal", method = "Nelder-Mead")
#--------------------------

</code></pre>


</div>