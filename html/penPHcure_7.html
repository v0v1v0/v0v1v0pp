<div class="container">

<table style="width: 100%;"><tr>
<td>predict.penPHcure</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>Predict method for penPHcure.object</h2>

<h3>Description</h3>

<p>Compute probabilities to be susceptible and survival probabilities (conditional on being susceptible) for a model fitted by <code>penPHcure</code> with the argument <code>pen.type = "SCAD" | "LASSO"</code>.
</p>


<h3>Usage</h3>

<pre><code class="language-R">## S3 method for class 'penPHcure'
predict(object, newdata, crit.type=c("BIC","AIC"), X = NULL,...)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>object</code></td>
<td>
<p>an object of class <code>PHcure.object</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>newdata</code></td>
<td>
<p>a data.frame in counting process format.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>crit.type</code></td>
<td>
<p>a character string indicating the criterion used to select the tuning parameters, either <code>"AIC"</code> or <code>"BIC"</code>. By default <code>crit.type = "BIC"</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>X</code></td>
<td>
<p>[optional] a matrix of time-invariant covariates.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>...</code></td>
<td>
<p>ellipsis to pass extra arguments.</p>
</td>
</tr>
</table>
<h3>Details</h3>

<p>If the model selected by means of the BIC criterion differs from the one selected by the AIC criterion, with the argument <code>crit.type</code> it is possible to specify which model to use for the calculation of the probabilities. 
</p>
<p>If argument <code>X</code> was not supplied in the call to the <code>penPHcure</code> function, the probabilities to be susceptible are computed using the covariates retrieved using the same <code>which.X</code> method as in the <code>penPHcure</code> function call.
</p>


<h3>Value</h3>

<p>An object of class <code>predict.penPHcure</code>, a list including the following elements:
</p>
<table>
<tr style="vertical-align: top;">
<td><code>CURE</code></td>
<td>
<p>a numeric vector containing the probabilities to be susceptible to the event of interest: </p>
<p style="text-align: center;"><code class="reqn">P(Y_i=1|x_i) = \frac{ e^{\mathbf{x}_i'\hat{\mathbf{b}}}   }{1+e^{\mathbf{x}_i'\hat{\mathbf{b}}}},</code>
</p>
<p> where <code class="reqn">\mathbf{x}_i</code> is a vector of time-invariant covariates and <code class="reqn">\hat{\mathbf{b}}</code> is a vector of estimated coefficients.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>SURV</code></td>
<td>
<p>a numeric vector containing the survival probabilities (conditional on being susceptible to the event of interest): </p>
<p style="text-align: center;"><code class="reqn">S(t_i|Y_i=1,\bar{\mathbf{z}}_i(t))=\exp\left(-\sum_{j=1}^K (t_{(j-1)}-t_{(j)}) \hat{\lambda}_{0j} I(t_{(j)}\leq t_i) e^{\mathbf{z}_i(t_{(j)})\hat{\boldsymbol{\beta}}}\right),</code>
</p>
<p> where <code class="reqn">t_{(1)}&lt;t_{(2)}&lt;...&lt;t_{(K)}</code> denotes the <code class="reqn">K</code> ordered event-times, <code class="reqn">\mathbf{z}_i(t)</code> is a vector of time-varying covariates, <code class="reqn">\hat{\boldsymbol{\beta}}</code> is a vector of estimated coefficients and <code class="reqn">\hat{\lambda}_{0j}</code> is the estimated baseline hazard function (constant in the interval <code class="reqn">(t_{(j-1)},t_{(j)}]</code>). </p>
</td>
</tr>
</table>
<h3>Examples</h3>

<pre><code class="language-R">
# Generate some data (for more details type ?penPHcure.simulate in your console)
set.seed(12) # For reproducibility
data &lt;- penPHcure.simulate(N=250)

### Tune penalized cure model with SCAD penalties
# First define the grid of possible values for the tuning parameters.
pen.tuneGrid &lt;- list(CURE = list(lambda = c(0.01,0.03,0.05,0.07,0.09),
                                 a = 3.7),
                     SURV = list(lambda = c(0.01,0.03,0.05,0.07,0.09),
                                 a = 3.7))
# Tune the penalty parameters.
tuneSCAD &lt;- penPHcure(Surv(time = tstart,time2 = tstop,
                           event = status) ~ z.1 + z.2 + z.3 + z.4,
                      cureform = ~ x.1 + x.2 + x.3 + x.4,
                      data = data,pen.type = "SCAD",
                      pen.tuneGrid = pen.tuneGrid,
                      print.details = FALSE)
                      
# Use the predict method to obtain the probabilities for the selected model.
#  By default, the model is the one selected on the basis of the BIC criterion.
pred.tuneSCAD.BIC &lt;- predict(tuneSCAD,data)
# Otherwise, to return the probabilities for the model selected on the basis 
#  of the AIC criterion, the user can set argument crit.type = "AIC": 
pred.tuneSCAD.AIC &lt;- predict(tuneSCAD,data,crit.type="AIC")

# Use the predict method to make prediction for new observations.
#  For example, two individuals censored at time 0.5 and 1.2, respectively,
#  and all cavariates equal to 1.
newdata &lt;- data.frame(tstart=c(0,0),tstop=c(0.5,1.2),status=c(0,0),
                      z.1=c(1,1),z.2=c(1,1),z.3=c(1,1),z.4=c(1,1),
                      x.1=c(1,1),x.2=c(1,1),x.3=c(1,1),x.4=c(1,1))
pred.tuneSCAD.newdata.BIC &lt;- predict(tuneSCAD,newdata)
pred.tuneSCAD.newdata.AIC &lt;- predict(tuneSCAD,newdata,crit.type="AIC")
# The probabilities to be susceptible for the BIC selected model are:
pred.tuneSCAD.newdata.BIC$CURE
# [1] 0.6456631 0.6456631
# The probabilities to be susceptible for the AIC selected model are:
pred.tuneSCAD.newdata.BIC$CURE
# [1] 0.6456631 0.6456631
# The survival probabilities (conditional on being susceptible) for the BIC 
#  selected model are:
pred.tuneSCAD.newdata.BIC$SURV
# [1] 0.5624514 0.1335912
# The survival probabilities (conditional on being susceptible) for the AIC 
#  selected model are:
pred.tuneSCAD.newdata.AIC$SURV
# [1] 0.5624514 0.1335912
</code></pre>


</div>