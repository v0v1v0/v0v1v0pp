<div class="container">

<table style="width: 100%;"><tr>
<td>gif</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>General Notes on Ground Intensity Functions</h2>

<h3>Description</h3>

<p>This page contains general notes about the required structure of ground intensity functions (including those that are not conditional on their history) to be used with this package.
</p>


<h3>Forms of Usage</h3>

<p>The usage of a ground intensity function takes two forms, one to evaluate the <code>gif</code> at specified <code>evalpts</code>, or to evaluate the integral of the <code>gif</code> on the interval <code>TT</code>, each shown below, respectively.
<br><code>gif(data, evalpts, params, tplus=FALSE)</code>
<br><code>gif(data, NULL, params, TT)</code>
</p>


<h3>Arguments</h3>

<p>All ground intensity functions should be defined to contain the following arguments, in the order below, even though they may not be required (see Details below).
</p>

<dl>
<dt><code>data</code></dt>
<dd>
<p>a data frame containing the history of the process, denoted below as <code class="reqn"> {\cal H}_t</code>. It should contain all variables that are required to evaluate the <code>gif</code> function, though can contain others too. No history is represented as <code>NULL</code>.</p>
</dd>
<dt><code>evalpts</code></dt>
<dd>
<p>a object containing the values at which the <code>gif</code> function is to be evaluated, consistent with what is required by the <code>gif</code> function.</p>
</dd>
<dt><code>params</code></dt>
<dd>
<p>vector containing values of the parameters required by the <code>gif</code> function.</p>
</dd>
<dt><code>TT</code></dt>
<dd>
<p>vector of length 2, being the time interval over which the integral of the ground intensity function is to be evaluated.</p>
</dd>
<dt><code>tplus</code></dt>
<dd>
<p>logical, <code class="reqn">\lambda_g(t|{\cal H}_t)</code> is evaluated as <code class="reqn">\lambda_g(t^+|{\cal H}_t)</code> if <code>TRUE</code>, else <code class="reqn">\lambda_g(t^-|{\cal H}_t)</code>. It is important if a “jump” occurs at <code class="reqn">t</code>.</p>
</dd>
</dl>
<h3>Details</h3>

<p>Note that the <code>gif</code> functions not only evaluate values of <code class="reqn">\lambda_g(t_i|{\cal H}_t)</code>, but also the integral. The value of the ground intensity function is returned at each time point specified in <code>evalpts</code> when <code>TT==NA</code>. If <code>TT</code> is not missing, the integral between <code>TT[1]</code> and <code>TT[2]</code> of the ground intensity function is calculated. In this last situation, anything assigned to the argument <code>evalpts</code> will have no effect.
</p>
<p>At the moment, we have the following types of processes: those jump processes that are conditional on their history (<code>etas_gif</code>, <code>srm_gif</code>, <code>linksrm_gif</code>), and non-homogeneous Poisson processes that are not conditional on their history (<code>simple_gif</code>). Another case is where we have a collection of point like “regions” (or lattice nodes), each with their own ground intensity function, but where each is also dependent on what is happening in the other regions (<code>linksrm_gif</code>).
</p>
<p>Functions have been given an attribute “rate”, taking the values of <code>"bounded"</code>, <code>"decreasing"</code> or <code>"increasing"</code>. This is used within the simulation function <code>simulate.mpp</code> which uses the thinning method. This method requires a knowledge of the maximum of <code class="reqn">\lambda_g(t|{\cal H}_t)</code> in a given interval. The argument <code>tplus</code> is also used by the simulation routine, where it is necessary to determine the value of the intensity immediately after a simulated event.
</p>


<h3>Value</h3>

<p>The returned value is either <code class="reqn">\lambda_g(t_i|{\cal H}_t)</code>, where the <code class="reqn">t_i</code> are specified within <code>evalpts</code>; or
</p>
<p style="text-align: center;"><code class="reqn">\int \lambda_g(t|{\cal H}_t) dt</code>
</p>

<p>where the limits of the integral are specified by the function argument <code>TT</code>.
</p>


<h3>Function Attributes</h3>

<p>Each function should have some of the following attributes if it is to be used in conjunction with <code>residuals.mpp</code> or <code>simulate.mpp</code>:
</p>

<dl>
<dt><code>rate</code></dt>
<dd>
<p>must be specified if the default method for <code>simulate.mpp</code> is to be used. Takes the values <code>"bounded"</code>, <code>"decreasing"</code> or <code>"increasing"</code>; see Details.</p>
</dd>
<dt><code>regions</code></dt>
<dd>
<p>an expression giving the number of regions; required with <code>linksrm_gif</code>.</p>
</dd>
</dl>
<h3>See Also</h3>

<p><code>etas_gif</code>, <code>expfourier_gif</code>, <code>exppoly_gif</code>, <code>fourier_gif</code>, <code>linksrm_gif</code>, <code>poly_gif</code>, <code>simple_gif</code>, <code>srm_gif</code>
</p>


<h3>Examples</h3>

<pre><code class="language-R">#  Ogata's Data: ground intensity function
#  evaluate lambda_g(t) at certain times

data(Ogata)

p &lt;- c(0.02, 70.77, 0.47, 0.002, 1.25)
times &lt;- sort(c(seq(0, 800, 0.5), Ogata$time))
TT &lt;- c(0, 800)

plot(times, log(etas_gif(Ogata, times, params=p)), type="l",
     ylab=expression(paste(log, " ", lambda[g](t))),
     xlab=expression(t), xlim=TT)

#  Evaluate the integral
#   The first form below is where the arguments are in their
#   default positions, the 2nd is where they are not, hence
#   their names must be specified

print(etas_gif(Ogata, NULL, p, TT))
#  or
print(etas_gif(Ogata, params=p, TT=TT))
</code></pre>


</div>