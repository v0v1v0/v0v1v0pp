<div class="container">

<table style="width: 100%;"><tr>
<td>smooth_wHANTS</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>Weighted HANTS SMOOTH</h2>

<h3>Description</h3>

<p>Weighted HANTS smoother
</p>


<h3>Usage</h3>

<pre><code class="language-R">smooth_wHANTS(
  y,
  t,
  w,
  nf = 3,
  ylu,
  periodlen = 365,
  nptperyear,
  wFUN = wTSM,
  iters = 2,
  wmin = 0.1,
  ...
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>y</code></td>
<td>
<p>Numeric vector, vegetation index time-series</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>t</code></td>
<td>
<p>Numeric vector, <code>Date</code> variable</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>w</code></td>
<td>
<p>(optional) Numeric vector, weights of <code>y</code>. If not specified,
weights of all <code>NA</code> values will be <code>wmin</code>, the others will be 1.0.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>nf</code></td>
<td>
<p>number of frequencies to be considered above the zero frequency</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>ylu</code></td>
<td>
<p><code style="white-space: pre;">⁠[low, high]⁠</code> of time-series y (curve fitting values are constrained
in the range of <code>ylu</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>periodlen</code></td>
<td>
<p>length of the base period, measured in virtual samples
(days, dekads, months, etc.). nptperyear in timesat.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>nptperyear</code></td>
<td>
<p>Integer, number of images per year.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>wFUN</code></td>
<td>
<p>weights updating function, can be one of 'wTSM', 'wChen' and
'wBisquare'.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>iters</code></td>
<td>
<p>How many times curve fitting is implemented.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>wmin</code></td>
<td>
<p>Double, minimum weigth (i.e. weight of snow, ice and cloud).</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>...</code></td>
<td>
<p>Additional parameters are passed to <code>wFUN</code>.</p>
</td>
</tr>
</table>
<h3>Value</h3>


<ul>
<li> <p><code>ws</code>: weights of every iteration
</p>
</li>
<li> <p><code>zs</code>: curve fittings of every iteration
</p>
</li>
</ul>
<h3>Author(s)</h3>

<p>Wout Verhoef, NLR, Remote Sensing Dept. June 1998
Mohammad Abouali (2011), Converted to MATLAB
Dongdong Kong (2018), introduced to R and modified into weighted model.
</p>


<h3>Examples</h3>

<pre><code class="language-R">library(phenofit)
data("MOD13A1")
dt &lt;- tidy_MOD13(MOD13A1$dt)
d &lt;- dt[site == "AT-Neu", ]

l &lt;- check_input(d$t, d$y, d$w, nptperyear=23)
r_wHANTS &lt;- smooth_wHANTS(l$y, l$t, l$w, ylu = l$ylu, nptperyear = 23, iters = 2)
</code></pre>


</div>