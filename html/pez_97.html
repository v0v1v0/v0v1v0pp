<div class="container">

<table style="width: 100%;"><tr>
<td>pez.dispersion</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>Calculate (phylogenetic) dispersion: examine assemblages in the
context of a source pools</h2>

<h3>Description</h3>

<p>As described in Pearse et al. (2014), a dispersion metric is one
the examines the phylogenetic structure of species present in each
assemblage in the context of a source pool of potentially present
species. Unlike other metrics, the value of a dispersion metric is
*contingent* on the definition of source pool, and (often)
randomisations used to conduct that comparison. For completeness,
options are provided to calculate these metrics using species
traits.
</p>


<h3>Usage</h3>

<pre><code class="language-R">pez.dispersion(
  data,
  null.model = c("taxa.labels", "richness", "frequency", "sample.pool",
    "phylogeny.pool", "independentswap", "trialswap"),
  abundance = FALSE,
  sqrt.phy = FALSE,
  traitgram = NULL,
  traitgram.p = 2,
  ext.dist = NULL,
  permute = 1000,
  ...
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>data</code></td>
<td>
<p><code>comparative.comm</code> object</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>null.model</code></td>
<td>
<p>one of "taxa.labels", "richness", "frequency",
"sample.pool", "phylogeny.pool", "independentswap", or
"independentswap". These correspond to the null models available in
<code>picante</code>; only <code>d</code> does not use these null models</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>abundance</code></td>
<td>
<p>Whether to use abundance-weighted forms of these
metrics (default: FALSE). D, which is presence/absence only, and so
will not be calculated when <code>TRUE</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>sqrt.phy</code></td>
<td>
<p>If TRUE (default is FALSE) your phylogenetic
distance matrix will be square-rooted; specifying TRUE will force
the square-root transformation on phylogenetic distance matrices
(in the spirit of Leitten and Cornwell, 2014). See ‘details’ for
details about different metric calculations when a distance matrix
is used.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>traitgram</code></td>
<td>
<p>If not NULL (default), a number to be passed to
<code>funct.phylo.dist</code> (<code>phyloWeight</code>; the ‘a’ parameter),
causing analysis on a distance matrix reflecting both traits and
phylogeny (0 –&gt; only phylogeny, 1 –&gt; only traits; see
<code>funct.phylo.dist</code>). If a vector of numbers is given,
<code>pez.dispersion</code> iterates across them and returns a <code>data.frame</code>
with coefficients from each iteration. See ‘details’ for details
about different metric calculations when a distance matrix is used.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>traitgram.p</code></td>
<td>
<p>A value for ‘p’ to be used in conjunction with
<code>traitgram</code> when calling <code>funct.phylo.dist</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>ext.dist</code></td>
<td>
<p>Supply an external species-level distance matrix
for use in calculations. See ‘details’ for comments on the use of
distance matrices in different metric calculations.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>permute</code></td>
<td>
<p>number of null permutations to perform (default
1000)</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>...</code></td>
<td>
<p>additional parameters to be passed to metrics (unlikely
you will want to use this!)</p>
</td>
</tr>
</table>
<h3>Details</h3>

<p>Most of these metrics do not involve comparison with some kind of
evolutionary-derived expectation for phylogenetic shape. Those that
do, however, such as D, make no sense unless applied to a
phylogenetic distance matrix - their null expectation *requires*
it. Using square-rooted distance matrices, or distance matrices
that incorporate trait information, can be an excellent thing to
do, but (for the above reasons), <code>pez</code> won't give you an
answer for metrics for which WDP thinks it makes no sense. SESpd
can (...up to you whether it should!...) be used with a
square-rooted distance matrix, but the results *will always be
wrong* if you do not have an ultrametric tree (branch lengths
proportional to time) and you will be warned about this. WDP
strongly feels you should only be using ultrametric phylogenies in
any case, but code to fix this bug is welcome.
</p>


<h3>Value</h3>

<p>a <code>data.frame</code> with metric values
</p>


<h3>Author(s)</h3>

<p>M.R. Helmus, Will Pearse
</p>


<h3>References</h3>

<p>Pearse W.D., Purvis A., Cavender-Bares J. &amp; Helmus
M.R. (2014). Metrics and Models of Community Phylogenetics. In:
Modern Phylogenetic Comparative Methods and Their Application in
Evolutionary Biology. Springer Berlin Heidelberg, pp. 451-464.
</p>
<p><code>sesmpd,sesmntd</code> Webb C.O. (2000). Exploring the
phylogenetic structure of ecological communities: An example for
rain forest trees. American Naturalist, 156, 145-155.
</p>
<p><code>sespd</code> Webb C.O., Ackerly D.D. &amp; Kembel
S.W. (2008). Phylocom: software for the analysis of phylogenetic
community structure and trait evolution. Bioinformatics
Applications Note, 24, 2098-2100.
</p>
<p><code>innd,mipd</code> Ness J.H., Rollinson E.J. &amp; Whitney
K.D. (2011). Phylogenetic distance can predict susceptibility to
attack by natural enemies. Oikos, 120, 1327-1334.
</p>
<p><code>d</code> Fritz S.A. &amp; Purvis A. (2010). Selectivity in
Mammalian Extinction Risk and Threat Types: a New Measure of
Phylogenetic Signal Strength in Binary Traits. Conservation
Biology, 24, 1042-1051.
</p>


<h3>See Also</h3>

<p><code>pez.shape</code> <code>pez.evenness</code> <code>pez.dissimilarity</code>
</p>


<h3>Examples</h3>

<pre><code class="language-R">data(laja)
data &lt;- comparative.comm(invert.tree, river.sites, invert.traits)
## Not run: pez.dispersion(data)
pez.dispersion(data, permute = 100)
</code></pre>


</div>