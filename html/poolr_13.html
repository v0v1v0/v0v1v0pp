<div class="container">

<table style="width: 100%;"><tr>
<td>mvnconv</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>Convert Correlations Among Multivariate Normal Test Statistics to Covariances for Various Target Statistics</h2>

<h3>Description</h3>

<p>Function to convert a matrix with the correlations among multivariate normal test statistics to a matrix with the covariances among various target statistics.<script id="MathJax-script" async src="../../mathjaxr/doc/mathjax/es5/tex-chtml-full.js"></script></p>


<h3>Usage</h3>

<pre><code class="language-R">mvnconv(R, side = 2, target, cov2cor = FALSE)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>R</code></td>
<td>
<p>a \(k \times k\) symmetric matrix that contains the correlations among the test statistics.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>side</code></td>
<td>
<p>scalar to specify the sidedness of the \(p\)-values that are obtained from the test statistics (2, by default, for two-sided tests; 1 for one-sided tests).</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>target</code></td>
<td>
<p>the target statistic for which the covariances are calculated (either <code>"p"</code>, <code>"m2lp"</code>, <code>"chisq1"</code>, or <code>"z"</code>). See ‘Details’.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>cov2cor</code></td>
<td>
<p>logical to indicate whether to convert the covariance matrix to a correlation matrix (default is <code>FALSE</code>).</p>
</td>
</tr>
</table>
<h3>Details</h3>

<p>The function converts a matrix with the correlations among multivariate normal test statistics to a matrix with the covariances among various target statistics. In particular, assume \[\begin{bmatrix} t_i \\ t_j \end{bmatrix} \sim \mbox{MVN} \left(\begin{bmatrix} 0 \\ 0 \end{bmatrix}, \begin{bmatrix} 1 &amp; \rho_{ij} \\ \rho_{ij} &amp; 1 \end{bmatrix} \right)\] is the joint distribution for test statistics \(t_i\) and \(t_j\). For <code>side = 1</code>, let \(p_i = 1 - \Phi(t_i)\) and \(p_j = 1 - \Phi(t_j)\) where \(\Phi(\cdot)\) denotes the cumulative distribution function of a standard normal distribution. For <code>side = 2</code>, let \(p_i = 2(1 - \Phi(|t_i|))\) and \(p_j = 2(1 - \Phi(|t_j|))\). These are simply the one- and two-sided \(p\)-values corresponding to \(t_i\) and \(t_j\).
</p>
<p>If <code>target = "p"</code>, the function computes \(\mbox{Cov}[p_i, p_j]\).
</p>
<p>If <code>target = "m2lp"</code>, the function computes \(\mbox{Cov}[-2 \ln(p_i), -2 \ln(p_j)]\).
</p>
<p>If <code>target = "chisq1"</code>, the function computes \(\mbox{Cov}[F^{-1}(1 - p_i, 1), F^{-1}(1 - p_j, 1)]\), where \(F^{-1}(\cdot,1)\) denotes the inverse of the cumulative distribution function of a chi-square distribution with one degree of freedom.
</p>
<p>If <code>target = "z"</code>, the function computes \(\mbox{Cov}[\Phi^{-1}(1 - p_i), \Phi^{-1}(1 - p_j)]\), where \(\Phi^{-1}(\cdot)\) denotes the inverse of the cumulative distribution function of a standard normal distribution.
</p>


<h3>Value</h3>

<p>The function returns the covariance matrix (or the correlation matrix if <code>cov2cor = TRUE</code>).
</p>


<h3>Note</h3>

<p>Since computation of the covariances requires numerical integration, the function doesn't actually compute these covariances on the fly. Instead, it uses the <code>mvnlookup</code> lookup table, which contains the covariances.
</p>


<h3>Author(s)</h3>

<p>Ozan Cinar <a href="mailto:ozancinar86@gmail.com">ozancinar86@gmail.com</a> <br>
Wolfgang Viechtbauer <a href="mailto:wvb@wvbauer.com">wvb@wvbauer.com</a> <br></p>


<h3>References</h3>

<p>Cinar, O. &amp; Viechtbauer, W. (2022). The poolr package for combining independent and dependent p values. <em>Journal of Statistical Software</em>, <b>101</b>(1), 1–42. <code style="white-space: pre;">⁠https://doi.org/10.18637/jss.v101.i01⁠</code>
</p>


<h3>Examples</h3>

<pre><code class="language-R"># illustrative correlation matrix
R &lt;- matrix(c(   1,  0.8,  0.5,  0.3,
               0.8,    1,  0.2,  0.4,
               0.5,  0.2,    1,  0.7,
               0.3,  0.4,  0.7,    1), nrow = 4, ncol = 4)

# convert R into covariance matrices for the chosen targets
mvnconv(R, target = "p")
mvnconv(R, target = "m2lp")
mvnconv(R, target = "chisq1")
mvnconv(R, target = "z")

# convert R into correlation matrices for the chosen targets
mvnconv(R, target = "p",      cov2cor = TRUE)
mvnconv(R, target = "m2lp",   cov2cor = TRUE)
mvnconv(R, target = "chisq1", cov2cor = TRUE)
mvnconv(R, target = "z",      cov2cor = TRUE)
</code></pre>


</div>