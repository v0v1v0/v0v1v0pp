<div class="container">

<table style="width: 100%;"><tr>
<td>PhenoExtract</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>
Generic function for the extraction of phenological thresholds
</h2>

<h3>Description</h3>

<p>This function extracts phenological thresholds according to different methods. 
Methods include 'trs', 'derivatives', 'klosterman', 'gu'. See details for the 
computation of each method.  
</p>


<h3>Usage</h3>

<pre><code class="language-R">PhenoExtract(data, method = "trs", uncert = FALSE, 
  breaks = 3, envelope = "quantiles", 
  quantiles = c(0.1, 0.9), plot = TRUE, sf, ...)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>data</code></td>
<td>

<p>A list structured as in output from the fitting procedures, such as GuFit, 
KlostermanFit, ElmoreFit, BeckFit. 
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>method</code></td>
<td>

<p>One between 'trs', 'derivatives', 'klosterman', 'gu'.
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>uncert</code></td>
<td>

<p>Should uncertainty on thresholds be computed? It requires that uncertainty 
be computed in the fitting function. I.e. The function requires the element 
'uncertainty' in data beeing non NULL. If is.null(uncertainty) in the data or 
this item is set to FALSE, uncertainty won't be computed.  
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>breaks</code></td>
<td>

<p>Currently unused
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>envelope</code></td>
<td>

<p>One between 'quantiles' and 'min-max'. If 'quantiles', the uncertainty envelope 
will be computed as quantiles. Quantiles reported in <code>quantiles</code> will be 
computed togheter with the median. If 'min-max' is choosen, min, max and mean of 
the uncertainty envelope will be returned. 
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>quantiles</code></td>
<td>

<p>Quantiles to be calculated if envelope='quantiles'. The notation is the same as 
to specify quantiles in the <code>quantile</code> function, i.e. to get 10th and 90th 
percentile, use c(0.1, 0.9).  
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>plot</code></td>
<td>

<p>Should a diagnostic plot be returned with annotated thresholds? It calls the 
function <code>PhenoPlot</code>
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>sf</code></td>
<td>

<p>Scaling factors required to normalize the data prior to the fitting. If the function is called by e.g. <code>greenProcess</code> sf is automatically calculated. We suggest using quantile(ts, probs=c(0.05, 0.5)) if you need to compute it. 
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>...</code></td>
<td>

<p>For the plotting function, a number of parameters from generic <code>plot</code> 
can be specified.  
Additionally, a further option to 'trs' method calling <code>PhenoTrs</code> is provided: by setting a trs argument. 
The default for trs is 0.5, meaning that the phases sos (start of season) and eos (end of season) will be set when gcc reaches 50% of maximum on the increasing (sos) and decreasing (eos) seasonal trajectory.  
</p>
</td>
</tr>
</table>
<h3>Details</h3>

<p>This is a wrapper function that calls <code>PhenoTrs</code> for method='trs', <code>PhenoDeriv</code> 
for method='derivatives', (from package <code>greenbrown</code>) or <code>PhenoGu</code> for method='Gu',
and <code>PhenoKl</code> for method='klosterman' from this package. Please see help of the 
single functions for details on the calculation of thresholds.  
</p>


<h3>Value</h3>

<p>If uncertainty=FALSE a vector of phenology metrics, otherwise a dataframe. 
</p>


<h3>Author(s)</h3>

<p>Gianluca Filippa &lt;gian.filippa@gmail.com&gt;
</p>


<h3>References</h3>

<p>Klosterman ST, Hufkens K, Gray JM, Melaas E, Sonnentag O, Lavine I, Mitchell L, 
Norman R, Friedl MA, Richardson A D (2014) Evaluating remote sensing of deciduous 
forest phenology at multiple spatial scales using PhenoCam imagery, Biogeosciences, 
11, 4305-4320, doi:10.5194/bg-11-4305-2014.
</p>
<p>Gu L, Post WM, Baldocchi D, Black TA, Suyker AE, Verma SB, Vesala T, Wofsy SC. (2009) 
Characterizing the Seasonal Dynamics of Plant Community Photosynthesis Across a Range 
of Vegetation Types. In: Phenology of Ecosystem Processes (Ed: Noormets A, 
Springer New York), pp 35-58.
</p>
<p>Zhang X, Friedl MA, Schaaf CB, Strahler AH, Hodges JCF, Gao F, Reed BC, Huete A (2003) 
Monitoring vegetation phenology using MODIS, Remote Sens. Environ., 84, 471-475.
</p>


<h3>See Also</h3>

<p><code>PhenoGu</code>,
<code>PhenoKl</code>,
<code>PhenoDeriv</code>,
<code>PhenoTrs</code>,
<code>PhenoPlot</code>,
<code>PhenoGu</code>

</p>


</div>