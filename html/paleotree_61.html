<div class="container">

<table style="width: 100%;"><tr>
<td>getDataPBDB</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>Obtaining Data for Taxa or Occurrences From Paleobiology Database API</h2>

<h3>Description</h3>

<p>The Paleobiology Database API (<a href="https://paleobiodb.org/data1.2/">link</a>)
is very easy to use, and generally any data one wishes to collect can be obtained
in R through a variety of ways - the simplest being to wrap a data retrieval request
to the API, specified for CSV output, with R function <code>read.csv</code>. The functions
listed here, however, are some simple helper functions for doing tasks common to
users of this package - downloading occurrence data, or taxonomic information,
for particular clades, or for a list of specific taxa.
</p>


<h3>Usage</h3>

<pre><code class="language-R">getCladeTaxaPBDB(
  taxon,
  showTaxa = c("class", "parent", "app", "img", "entname"),
  status = "accepted",
  urlOnly = FALSE,
  stopIfMissing = FALSE,
  failIfNoInternet = TRUE
)

getSpecificTaxaPBDB(
  taxa,
  showTaxa = c("class", "parent", "app", "img", "entname"),
  status = "accepted",
  urlOnly = FALSE,
  stopIfMissing = FALSE,
  failIfNoInternet = TRUE
)

getPBDBocc(
  taxa,
  showOccs = c("class", "classext", "subgenus", "ident", "entname"),
  failIfNoInternet = TRUE
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>taxon</code></td>
<td>
<p>A single name of a of a higher taxon which you wish to catch
all taxonomic 'children' (included members - i.e. subtaxa) of, from 
within the Paleobiology Database.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>showTaxa</code></td>
<td>
<p>Which variables for taxonomic data should be requested
from the Paleobiology Database? The default is to include classification (<code>"class"</code>),
parent-child taxon information (<code>"parent"</code>), information on each
taxon's first and last appearance (<code>"app"</code>), information on the
PhyloPic silhouette images assigned to that taxon (<code>"img"</code>), and
the names of those who entered and authorized the taxonomic data you
have downloaded (<code>"entname"</code>). Multiple variable blocks can be
given as a single character string, with desired variable selections
separated by a comma with no whitespace (ex. <code>"class,img,app"</code>) or 
as a vector of character strings (ex. <code>c("class", "img", "app")</code>),
which will then formatted for use in the API call. Other options that
you might want to include, such as information on ecospace or taphonomy,
can be included: please refer to the full list at
the <a href="https://paleobiodb.org/data1.2/taxa/list_doc.htm">documentation for the API</a>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>status</code></td>
<td>
<p>What taxonomic status should the pull taxa have? 
The default is <code>status = "accepted"</code>, which means 
only those taxa that are both valid taxa and 
<em>the accepted senior homonym</em>. Other typical statuses
to consider are <code>"valid"</code>, which is all valid taxa:
senior homonyms and valid subjective synonyms, and <code>"all"</code>,
which will return all valid taxa and all otherwise repressed invalid taxa.
For additional statuses that you can request, please see the documentation at  
the <a href="https://paleobiodb.org/data1.2/taxa/list_doc.htm">documentation for the API</a>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>urlOnly</code></td>
<td>
<p>If <code>FALSE</code> (the default), then the
function behaves as expected, the API is called and a
data table pulled from the Paleobiology Database is returned.
If <code>urlOnly = TRUE</code>, the URL of the API call is returned
instead as a character string.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>stopIfMissing</code></td>
<td>
<p>If some taxa within the requested set appear
to be missing from the Paleobiology Database's taxonomy table, should
the function halt with an error?</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>failIfNoInternet</code></td>
<td>
<p>If the Paleobiology Database or another 
needed internet resource cannot be accessed, perhaps because of
no internet connection, should the function fail (with an error)
or should the function return <code>NULL</code> and return an
informative message instead, thus meeting the CRAN policy
that such functionalities must 'fail gracefully'?
The default is <code>TRUE</code> but all examples that might be auto-run
use <code>FALSE</code> so they do not fail during R CHECK.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>taxa</code></td>
<td>
<p>A character vector listing taxa of interest that the user
wishes to download information on from the Paleobiology Database.
Multiple taxa can be listed as a single character string, with desired taxa
separated by a comma with no whitespace (ex.
<code>"Homo,Pongo,Gorilla"</code>) or as a vector of character strings
(ex. <code>c("Homo", "Pongo", "Gorilla")</code>),
which will then formatted for use in the API call.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>showOccs</code></td>
<td>
<p>Which variables for occurrence data should be requested
from the Paleobiology Database? The default is to include classification (<code>"class"</code>),
classification identifiers (<code>"classext"</code>), genus and subgenus
identifiers (<code>"subgenus"</code>), and species-level identifiers (<code>"ident"</code>).
Multiple variable blocks can be given as a single character string, with desired
variable selections separated by a comma with no whitespace (ex.
<code>"class,subgenus,ident"</code>) or  as a vector of character strings
(ex. <code>c("class", "subgenus", "ident")</code>), which will then formatted for
use in the API call. For full list of other options that you might want to include, please refer
to <a href="https://paleobiodb.org/data1.2/occs/list_doc.html">documentation for the API</a>.</p>
</td>
</tr>
</table>
<h3>Details</h3>

<p>In many cases, it might be easier to write your own query - these
functions are only made to make getting data for some very specific
applications in <code>paleotree</code> easier.
</p>


<h3>Value</h3>

<p>These functions return a <code>data.frame</code> containing
variables pulled for the requested taxon selection.
This behavior can be modified by argument <code>urlOnly</code>.
</p>


<h3>Author(s)</h3>

<p>David W. Bapst
</p>


<h3>References</h3>

<p>Peters, S. E., and M. McClennen. 2015. The Paleobiology Database
application programming interface. <em>Paleobiology</em> 42(1):1-7.
</p>


<h3>See Also</h3>

<p>See <code>makePBDBtaxonTree</code>, <code>makePBDBtaxonTree</code>,
and <code>plotPhyloPicTree</code> for functions that use taxonomic data.
Occurrence data is sorted by taxon via <code>taxonSortPBDBocc</code>,
and further utilized <code>occData2timeList</code> and  <code>plotOccData</code>.
</p>


<h3>Examples</h3>

<pre><code class="language-R">

# Note that all examples here use argument 
    # failIfNoInternet = FALSE so that functions do
    # not error out but simply return NULL if internet
    # connection is not available, and thus
    # fail gracefully rather than error out (required by CRAN).
# Remove this argument or set to TRUE so functions fail
    # when internet resources (paleobiodb) is not available.

#graptolites
graptData &lt;- getCladeTaxaPBDB("Graptolithina", 
    failIfNoInternet = FALSE)
dim(graptData)
sum(graptData$taxon_rank == "genus")

# so we can see that our call for graptolithina returned 
    # a large number of taxa, a large portion of which are
    # individual genera
# (554 and 318 respectively, as of 03-18-19)

tetrapodList&lt;-c("Archaeopteryx", "Columba", "Ectopistes",
   "Corvus", "Velociraptor", "Baryonyx", "Bufo",
   "Rhamphorhynchus", "Quetzalcoatlus", "Natator",
   "Tyrannosaurus", "Triceratops", "Gavialis",
   "Brachiosaurus", "Pteranodon", "Crocodylus",
   "Alligator", "Giraffa", "Felis", "Ambystoma",
    "Homo", "Dimetrodon", "Coleonyx", "Equus",
   "Sphenodon", "Amblyrhynchus")

tetrapodData &lt;-getSpecificTaxaPBDB(tetrapodList, 
    failIfNoInternet = FALSE)
dim(tetrapodData)
sum(tetrapodData$taxon_rank == "genus")
# should be 26, with all 26 as genera

#############################################
# Now let's try getting occurrence data

# getting occurrence data for a genus, sorting it
# Dicellograptus
dicelloData &lt;- getPBDBocc("Dicellograptus", 
    failIfNoInternet = FALSE)

if(!is.null(dicelloData)){

dicelloOcc2 &lt;- taxonSortPBDBocc(dicelloData, 
    rank = "species", onlyFormal = FALSE, 
    failIfNoInternet = FALSE)
names(dicelloOcc2)

}



</code></pre>


</div>