<div class="container">

<table style="width: 100%;"><tr>
<td>getNode</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>Node and Edge look-up functions</h2>

<h3>Description</h3>

<p>Functions for retrieving node and edge IDs (possibly with corresponding
labels) from a phylogenetic tree.
</p>


<h3>Usage</h3>

<pre><code class="language-R">getNode(
  x,
  node,
  type = c("all", "tip", "internal"),
  missing = c("warn", "OK", "fail")
)

## S4 method for signature 'phylo4'
getNode(
  x,
  node,
  type = c("all", "tip", "internal"),
  missing = c("warn", "OK", "fail")
)

getEdge(
  x,
  node,
  type = c("descendant", "ancestor"),
  missing = c("warn", "OK", "fail")
)

## S4 method for signature 'phylo4'
getEdge(
  x,
  node,
  type = c("descendant", "ancestor"),
  missing = c("warn", "OK", "fail")
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>x</code></td>
<td>
<p>a phylo4 object (or one inheriting from
phylo4, e.g. a phylo4d object)</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>node</code></td>
<td>
<p>either an integer vector corresponding to node ID numbers, or a
character vector corresponding to node labels; if missing, all nodes
appropriate to the specified type will be returned by <code>getNode</code>, and
all edges appropriate to the specified type will be returned by
<code>getEdge</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>type</code></td>
<td>
<p>(<code>getNode</code>) specify whether to return nodes matching "all"
tree nodes (default), only "tip" nodes, or only "internal" nodes;
(<code>nodeId, edgeId</code>) specify whether to return "all" tree nodes, or only
those corresponding to "tip", "internal", or "root" nodes; (<code>getEdge</code>)
specify whether to look up edges based on their descendant node
("descendant") or ancestral node ("ancestor")</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>missing</code></td>
<td>
<p>what to do if some requested node IDs or names are not in the
tree: warn, do nothing, or stop with an error</p>
</td>
</tr>
</table>
<h3>Details</h3>

<p><code>getNode</code> and <code>getEdge</code> are primarily intended for looking up the
IDs either of nodes themselves or of edges associated with those nodes. Note
that they behave quite differently. With <code>getNode</code>, any input nodes are
looked up against tree nodes of the specified type, and those that match are
returned as numeric node IDs with node labels (if they exist) as element
names. With <code>getEdge</code>, any input nodes are looked up against edge ends
of the specified type, and those that match are returned as character edge
IDs with the corresponding node ID as element names.
</p>
<p>If <code>missing</code> is “warn” or “OK”, <code>NA</code> is returned for
any nodes that are unmatched for the specified type. This can provide a
mechanism for filtering a set of nodes or edges.
</p>
<p><code>nodeId</code> provides similar output to <code>getNode</code> in the case when no
node is supplied, but it is faster and returns an unnamed vector of the
numeric IDs of all nodes of the specified node type.  Similarly,
<code>edgeId</code> simply returns an unnamed vector of the character IDs of all
edges for which the descendant node is of the specified node type.
</p>


<h3>Value</h3>

<table>
<tr style="vertical-align: top;">
<td><code>list("getNode")</code></td>
<td>
<p>returns a named integer vector of node IDs,
in the order of input nodes if provided, otherwise in nodeId order</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>list("getEdge")</code></td>
<td>
<p>returns a named character vector of edge IDs, in the
order of input nodes if provide, otherwise in nodeId order</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>list("nodeId")</code></td>
<td>
<p>returns an unnamed integer vector of node IDs, in
ascending order</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>list("getEdge")</code></td>
<td>
<p>returns an unnamed character vector
of edge IDs, in edge matrix order</p>
</td>
</tr>
</table>
<h3>Examples</h3>

<pre><code class="language-R">
  data(geospiza)
  nodeLabels(geospiza) &lt;- LETTERS[1:nNodes(geospiza)]
  plot(as(geospiza, "phylo4"), show.node.label=TRUE)
  getNode(geospiza, 18)
  getNode(geospiza, "D")
  getEdge(geospiza, "D")
  getEdge(geospiza, "D", type="ancestor")

  ## match nodes only to tip nodes, flagging invalid cases as NA
  getNode(geospiza, c(1, 18, 999), type="tip", missing="OK")

  ## get all edges that descend from internal nodes
  getEdge(geospiza, type="ancestor")

  ## identify an edge from its terminal node
  getEdge(geospiza, c("olivacea", "B", "fortis"))
  getNode(geospiza, c("olivacea", "B", "fortis"))
  edges(geospiza)[c(26, 1, 11),]

  ## quickly get all tip node IDs and tip edge IDs
  nodeId(geospiza, "tip")
  edgeId(geospiza, "tip")

</code></pre>


</div>