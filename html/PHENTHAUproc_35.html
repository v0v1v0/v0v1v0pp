<div class="container">

<table style="width: 100%;"><tr>
<td>phenology</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>Calculate phenological events</h2>

<h3>Description</h3>

<p>Using daily mean or min and max temperature data, the function
calculates the temperature-dependent development stages of OPM or the bud
stages (bud swelling and leaf unfolding) of its host tree
<em>Quercus robur</em>.
</p>
<p>The default settings correspond to the model described by Halbig et al. 2024.
Additional parametrizations are provided but have not yet been tested.
</p>
<p>Halbig et al. 2024
It follows 4 different steps:
</p>

<ul>
<li>
<p> a) Calculating and summing up cold days or frost days.
(Cold days are defined as days with a mean temperature below ldt
(lower development threshold), while frost days are all days with a min
temperature below ldt).
Hatch dependent development stages need a hatch raster (hatch happened
1 or not 0) for each day
</p>
</li>
<li>
<p> b) Calculating degree days with the
single sine method of Baskerville &amp; Emin, 1969 or simple summing up tmean
temperatures over ldt.
</p>
</li>
<li>
<p> c) Calculating the needed
sum of effective temperatures for the development stage
</p>
</li>
<li>
<p> d) Comparing degree days with the needed sum of effective temperatures
</p>
</li>
</ul>
<h3>Usage</h3>

<pre><code class="language-R">phenology(
  x,
  model,
  parametrisation = NULL,
  year = NULL,
  hatch = NULL,
  return_date = TRUE,
  ...
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>x</code></td>
<td>
<p>SpatRaster list/dataframe (tmean, tmax, tmin) - numeric - with time
attribute/date column</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>model</code></td>
<td>
<p>name of model - character</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>parametrisation</code></td>
<td>
<p>name of parametrisation - character</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>year</code></td>
<td>
<p>year for prognosis - numeric</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>hatch</code></td>
<td>
<p>SpatRaster - logical - with time attribute TRUE/FALSE
hatch/no_hatch</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>return_date</code></td>
<td>
<p>TRUE/FALSE defines output -&gt; see value</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>...</code></td>
<td>
<p>parameter to change default values. (i.e. ldt = 3.5)</p>
</td>
</tr>
</table>
<h3>Value</h3>

<p>If return_date is TRUE returns single layered SpatRaster with time
serial number (first occurence of phenological event).
If return_date is FALSE returns a one layer per day SpatRaster type logical
with phenological event occurred/not TRUE/FALSE.
</p>


<h3>Author(s)</h3>

<p>Bachfischer Lorenz, Department of Forest Protection FVA (2024)
<a href="mailto:lorenz.bachfischer@posteo.de">lorenz.bachfischer@posteo.de</a>
</p>


<h3>References</h3>

<p>Halbig et al. 2014: Halbig, P., Stelzer, A. S., Baier, P., Pennerstorfer,
J., Delb, H., &amp; Schopf, A. (2024). PHENTHAUproc–An early warning and decision
support system for hazard assessment and control of oak processionary moth
(Thaumetopoea processionea). Forest Ecology and Management, 552, 121525 <br>
Baskerville &amp; Emin 1969: Baskerville, G. L., &amp; Emin, P. (1969). Rapid
estimation of heat accumulation from maximum and minimum temperatures.
Ecology, 50(3), 514-517. (<a href="doi:10.2307/1933912">doi:10.2307/1933912</a>) <br>
Menzel 1997: Menzel, A. (1997). Phänologie von Waldbäumen unter sich
ändernden Klimabedingungen: Auswertung der Beobachtungen in den
internationalen phänologischen Gärten und Möglichkeiten der Modellierung von
Phänodaten. Frank. <br></p>


<h3>See Also</h3>

<p>Other Main: 
<code>get_legend()</code>,
<code>mortality()</code>,
<code>parameter()</code>,
<code>phenthau()</code>
</p>


<h3>Examples</h3>

<pre><code class="language-R">## SpatRaster
srl &lt;- load_test()

# Calculating bud swelling for our raster example
budswelling &lt;- phenology(srl,
                         model = "budswelling",
                         parametrisation = "quercus_robur_clone256_type1",
                         year = 2020)

</code></pre>


</div>