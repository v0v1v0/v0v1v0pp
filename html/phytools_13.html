<div class="container">

<table style="width: 100%;"><tr>
<td>anc.trend</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>Ancestral character estimation with a trend</h2>

<h3>Description</h3>

<p>This function estimates the evolutionary parameters and ancestral states for Brownian evolution with a directional trend.
</p>


<h3>Usage</h3>

<pre><code class="language-R">anc.trend(tree, x, maxit=2000)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>tree</code></td>
<td>
<p>an object of class <code>"phylo"</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>x</code></td>
<td>
<p>a vector of tip values for species; <code>names(x)</code> should be the species names.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>maxit</code></td>
<td>
<p>an optional integer value indicating the maximum number of iterations for optimization.</p>
</td>
</tr>
</table>
<h3>Details</h3>

<p>Note that this will generally only work and produce sensible results for a phylogeny with some non-contemporaneous tips (i.e., a tree with some fossil species).
</p>
<p>The function uses <code>optim</code> with <code>method=</code> <code>"L-BFGS-B"</code> internally; however, optimization is only constrained for the <code>sig2</code> which must be &gt; 0.
</p>


<h3>Value</h3>

<p>An object of class <code>"anc.trend"</code> with the following components:
</p>
<table>
<tr style="vertical-align: top;">
<td><code>ace</code></td>
<td>
<p>a vector with the ancestral states.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>mu</code></td>
<td>
<p>a trend parameter per unit time.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>sig2</code></td>
<td>
<p>the variance of the BM process, <code class="reqn">\sigma^2</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>logL</code></td>
<td>
<p>the log-likelihood.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>convergence</code></td>
<td>
<p>the value of <code>$convergence</code> returned by <code>optim()</code> (0 is good).</p>
</td>
</tr>
</table>
<h3>Author(s)</h3>

<p>Liam Revell <a href="mailto:liam.revell@umb.edu">liam.revell@umb.edu</a></p>


<h3>References</h3>

<p>Revell, L. J. (2024) phytools 2.0: an updated R ecosystem for phylogenetic comparative methods (and other things). <em>PeerJ</em>, <b>12</b>, e16505.
</p>


<h3>See Also</h3>

<p><code>ace</code>, <code>anc.Bayes</code>, <code>anc.ML</code>, <code>optim</code>
</p>


<h3>Examples</h3>

<pre><code class="language-R">## simulate tree &amp; data using fastBM with a trend (m!=0)
tree&lt;-rtree(n=26,tip.label=LETTERS)
x&lt;-fastBM(tree,mu=4,internal=TRUE)
a&lt;-x[as.character(1:tree$Nnode+Ntip(tree))]
x&lt;-x[tree$tip.label]
## fit no trend model
fit.bm&lt;-anc.ML(tree,x,model="BM")
print(fit.bm)
## fit trend model
fit.trend&lt;-anc.trend(tree,x)
print(fit.trend)
## compare trend vs. no-trend models &amp; estimates
AIC(fit.bm,fit.trend)
layout(matrix(c(3,4,1,2,5,6),3,2,byrow=TRUE),
    heights=c(1.5,3,1.5),widths=c(3,3))
xlim&lt;-ylim&lt;-range(c(a,fit.bm$ace,
    fit.trend$ace))
plot(a,fit.bm$ace,pch=19,
    col=make.transparent("blue",0.5),
    xlab="true ancestral states",
    ylab="ML estimates",
    main=paste("Comparison of true and estimated",
    "\nstates under a no-trend model"),font.main=3,
    cex.main=1.2,bty="l",cex=1.5,
    xlim=xlim,ylim=ylim)
lines(xlim,ylim,lty="dotted")
plot(a,fit.trend$ace,pch=19,
    col=make.transparent("blue",0.5),
    xlab="true ancestral states",
    ylab="ML estimates",
    main=paste("Comparison of true and estimated",
    "\nstates under a trend model"),font.main=3,
    cex.main=1.2,bty="l",cex=1.5,
    xlim=xlim,ylim=ylim)
lines(xlim,ylim,lty="dotted")
par(mfrow=c(1,1))
</code></pre>


</div>