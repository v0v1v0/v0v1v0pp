<div class="container">

<table style="width: 100%;"><tr>
<td>lmperm</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>Permutation tests for regression parameters</h2>

<h3>Description</h3>

<p>Compute permutation marginal tests for linear models. This function produces t statistics with univariate and bivariate p-values. It gives the choice between multiple methods to handle nuisance variables.
</p>


<h3>Usage</h3>

<pre><code class="language-R">lmperm(
  formula,
  data = NULL,
  np = 5000,
  method = NULL,
  type = "permutation",
  ...
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>formula</code></td>
<td>
<p>A formula object.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>data</code></td>
<td>
<p>A data frame or matrix.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>np</code></td>
<td>
<p>The number of permutations. Default value is <code>5000</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>method</code></td>
<td>
<p>A character string indicating the method use to handle nuisance variables. Default is <code>"freedman_lane"</code>. For the other methods, see details.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>type</code></td>
<td>
<p>A character string to specify the type of transformations: "permutation" and "signflip" are available. Is overridden if P is given. See help from Pmat.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>...</code></td>
<td>
<p>Futher arguments, see details.</p>
</td>
</tr>
</table>
<h3>Details</h3>

<p>The following methods are available for the fixed effects model defined as <code class="reqn">y = D\eta + X\beta + \epsilon</code>. If we want to test <code class="reqn">\beta = 0</code> and take into account the effects of the nuisance variables <code class="reqn">D</code>, we transform the data :
</p>

<table>
<tr>
<td style="text-align: left;">
<code>method</code> argument </td>
<td style="text-align: center;"> <code class="reqn">y*</code> </td>
<td style="text-align: center;"> <code class="reqn">D*</code> </td>
<td style="text-align: center;"> <code class="reqn">X*</code>
</td>
</tr>
<tr>
<td style="text-align: left;">
<code>"draper_stoneman"</code> </td>
<td style="text-align: center;"> <code class="reqn">y</code> </td>
<td style="text-align: center;"> <code class="reqn">D</code> </td>
<td style="text-align: center;"> <code class="reqn">PX</code>
</td>
</tr>
<tr>
<td style="text-align: left;">
<code>"freedman_lane"</code> </td>
<td style="text-align: center;"> <code class="reqn">(H_D+PR_D)y</code> </td>
<td style="text-align: center;"> <code class="reqn">D</code> </td>
<td style="text-align: center;"> <code class="reqn">X</code>
</td>
</tr>
<tr>
<td style="text-align: left;">
<code>"manly"</code> </td>
<td style="text-align: center;"> <code class="reqn">Py</code> </td>
<td style="text-align: center;"> <code class="reqn">D</code> </td>
<td style="text-align: center;"> <code class="reqn">X</code>
</td>
</tr>
<tr>
<td style="text-align: left;">
<code>"terBraak"</code> </td>
<td style="text-align: center;"> <code class="reqn">(H_{X,D}+PR_{X,D})y</code> </td>
<td style="text-align: center;"> <code class="reqn">D</code> </td>
<td style="text-align: center;"> <code class="reqn">X</code>
</td>
</tr>
<tr>
<td style="text-align: left;">
<code>"kennedy"</code> </td>
<td style="text-align: center;"> <code class="reqn">PR_D y</code> </td>
<td style="text-align: center;"> </td>
<td style="text-align: center;"> <code class="reqn">R_D X</code>
</td>
</tr>
<tr>
<td style="text-align: left;">
<code>"huh_jhun"</code> </td>
<td style="text-align: center;"> <code class="reqn">PV'R_Dy</code> </td>
<td style="text-align: center;"> </td>
<td style="text-align: center;"> <code class="reqn">V'R_D X</code>
</td>
</tr>
<tr>
<td style="text-align: left;">
<code>"dekker"</code> </td>
<td style="text-align: center;"> <code class="reqn">y</code> </td>
<td style="text-align: center;"> <code class="reqn">D</code> </td>
<td style="text-align: center;"> <code class="reqn">PR_D X</code>
</td>
</tr>
<tr>
<td style="text-align: left;">
</td>
</tr>
</table>
<p>Other arguments could be pass in <code>...</code> :<br><br><code>P</code> : a matrix containing the permutations of class <code>matrix</code> or <code>Pmat</code> for the reproductibility of the results. The first column must be the identity. <code>P</code> overwrites <code>np</code> argument. <br><br><code>rnd_rotation</code> : a random matrix of size <code class="reqn">n \times n</code> to compute the rotation used for the <code>"huh_jhun"</code> method.
</p>


<h3>Value</h3>

<p>A <code>lmperm</code> object. See aovperm.
</p>


<h3>Author(s)</h3>

<p>jaromil.frossard@unige.ch
</p>


<h3>References</h3>

<p>Kherad-Pajouh, S., &amp; Renaud, O. (2010). An exact permutation method for testing any effect in balanced and unbalanced fixed effect ANOVA. Computational Statistics &amp; Data Analysis, 54(7), 1881-1893.
</p>
<p>Kherad-Pajouh, S., &amp; Renaud, O. (2015). A general permutation approach for analyzing repeated measures ANOVA and mixed-model designs. Statistical Papers, 56(4), 947-967.
</p>
<p>Winkler, A. M., Ridgway, G. R., Webster, M. A., Smith, S. M., &amp; Nichols, T. E. (2014). Permutation inference for the general linear model. Neuroimage, 92, 381-397.
</p>


<h3>See Also</h3>

<p><code>aovperm</code> <code>plot.lmperm</code>
</p>
<p>Other main function: 
<code>aovperm()</code>,
<code>clusterlm()</code>
</p>


<h3>Examples</h3>

<pre><code class="language-R">## data
data("emergencycost")

## Testing at 14 days
emergencycost$LOS14 &lt;- emergencycost$LOS - 14

## Univariate t test
contrasts(emergencycost$insurance) &lt;- contr.sum
contrasts(emergencycost$sex) &lt;- contr.sum

## Warning : np argument must be greater (recommendation: np&gt;=5000)
modlm_cost_14 &lt;- lmperm(cost ~ LOS14*sex*insurance, data = emergencycost, np = 2000)
modlm_cost_14
</code></pre>


</div>