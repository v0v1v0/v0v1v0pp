<div class="container">

<table style="width: 100%;"><tr>
<td>ph_rao</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>rao - Rao's quadratic entropy</h2>

<h3>Description</h3>

<p>A measure of within- and among-community diversity taking species
dissimilarity (phylogenetic dissimilarity) into account
</p>


<h3>Usage</h3>

<pre><code class="language-R">ph_rao(sample, phylo)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>sample</code></td>
<td>
<p>(data.frame/character) sample data.frame or path to a
sample file</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>phylo</code></td>
<td>
<p>(character/phylo) One of: phylogeny as a newick string (will be
written to a temp file) - OR path to file with a newick
string - OR a an <span class="pkg">ape</span> <code>phylo</code> object. required.</p>
</td>
</tr>
</table>
<h3>Details</h3>

<p>See phylocomr-inputs for expected input formats
</p>


<h3>Value</h3>

<p>A list of 6 data.frame's:
<strong>Diversity components</strong>:
</p>

<ul>
<li>
<p> overall alpha (within-site)
</p>
</li>
<li>
<p> beta (among-site)
</p>
</li>
<li>
<p> total diversity
</p>
</li>
<li>
<p> Fst statistic of differentiation for diversity and phylogenetic
diversity
</p>
</li>
</ul>
<p><strong>Within-community diversity</strong>:
</p>

<ul>
<li>
<p> Plot - Plot name
</p>
</li>
<li>
<p> NSpp - Number of species
</p>
</li>
<li>
<p> NIndiv - Number of individuals
</p>
</li>
<li>
<p> PropIndiv - Proportion of all individuals found in this plot
</p>
</li>
<li>
<p> D - Diversity (= Simpsonâ€™s diversity)
</p>
</li>
<li>
<p> Dp - Phylogenetic diversity (= Diversity weighted by interspecific
phylogenetic distances)
</p>
</li>
</ul>
<p>The remaining 4 tables compare each community pairwise:
</p>

<ul>
<li>
<p> among_community_diversity_d - Among-community diversities
</p>
</li>
<li>
<p> among_community_diversity_h - Among-community diversities excluding
within-community diversity
</p>
</li>
<li>
<p> among_community_phylogenetic_diversity_dp - Among-community
phylogenetic diversities
</p>
</li>
<li>
<p> among_community_phylogenetic_diversity_hp - Among-community
phylogenetic diversities excluding within-community diversity
</p>
</li>
</ul>
<h3>Taxon name case</h3>

<p>In the <code>sample</code> table, if you're passing in a file, the names
in the third column must be all lowercase; if not,
we'll lowercase them for you. If you pass in a data.frame, we'll lowercase
them for your. All phylo tip/node labels are also lowercased to avoid
any casing problems
</p>


<h3>See Also</h3>

<p>Other phylogenetic-diversity: 
<code>ph_pd()</code>
</p>


<h3>Examples</h3>

<pre><code class="language-R">sfile &lt;- system.file("examples/sample_comstruct", package = "phylocomr")
pfile &lt;- system.file("examples/phylo_comstruct", package = "phylocomr")

# sample from data.frame, phylogeny from a string
sampledf &lt;- read.table(sfile, header = FALSE,
  stringsAsFactors = FALSE)
phylo_str &lt;- readLines(pfile)

ph_rao(sample = sampledf, phylo = phylo_str)

# both from files
sample_str &lt;- paste0(readLines(sfile), collapse = "\n")
sfile2 &lt;- tempfile()
cat(sample_str, file = sfile2, sep = '\n')
pfile2 &lt;- tempfile()
phylo_str &lt;- readLines(pfile)
cat(phylo_str, file = pfile2, sep = '\n')

ph_rao(sample = sfile2, phylo = pfile2)
</code></pre>


</div>