<div class="container">

<table style="width: 100%;"><tr>
<td>pcps.curve</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>Curve of phylogenetic signal at metacommunity level</h2>

<h3>Description</h3>

<p>The function estimate the phylogenetic signal at metacommunity level and draws
a representation curve.
</p>


<h3>Usage</h3>

<pre><code class="language-R">pcps.curve(
  comm,
  phylodist,
  trait,
  checkdata = TRUE,
  method = "bray",
  squareroot = TRUE,
  ranks = TRUE,
  null.model.ts = FALSE,
  null.model.bm = FALSE,
  tree,
  runs = 99,
  progressbar = FALSE,
  parallel = NULL
)

pcpc.curve.calc(values, vectors, mt)

## S3 method for class 'pcpscurve'
plot(
  x,
  draw.model = c("none", "ts", "bm"),
  type = "b",
  probs = c(0.025, 0.975),
  col = "black",
  model.col = "black",
  ...
)

## S3 method for class 'pcpscurve'
print(x, ...)

## S3 method for class 'pcpscurve'
summary(object, probs = c(0.025, 0.975), ...)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>comm</code></td>
<td>
<p>Community data, with species as columns and sampling units as rows. This 
matrix can contain either presence/absence or abundance data.
Alternatively comm can be an object of class metacommunity.data, an alternative
way to set all data.frames/matrices. When you use the class metacommunity.data the arguments
trait and phylodist must not be specified. See details.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>phylodist</code></td>
<td>
<p>Matrix containing phylogenetic distances between species.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>trait</code></td>
<td>
<p>Matrix data of species described by traits, with traits as columns and species as rows.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>checkdata</code></td>
<td>
<p>Logical argument (TRUE or FALSE) to check if species
sequence in the community data follows the same order as the one in the
trait and in the phylodist matrices (Default checkdata = TRUE).</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>method</code></td>
<td>
<p>Dissimilarity index, as accepted by <code>vegdist</code> (Default dist = "bray").</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>squareroot</code></td>
<td>
<p>Logical argument (TRUE or FALSE) to specify if use square root of dissimilarity
index (Default squareroot = TRUE).</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>ranks</code></td>
<td>
<p>Logical argument (TRUE or FALSE) to specify if ordinal variables are 
convert to ranks (Default ranks = TRUE).</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>null.model.ts</code></td>
<td>
<p>Logical argument (TRUE or FALSE) to specify if use null model that shuffles
terminal tips across the phylogenetic tree to generate null curves. See details (Default null.model.ts = FALSE).</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>null.model.bm</code></td>
<td>
<p>Logical argument (TRUE or FALSE) to specify if use null model that simulate 
trait evolving under Brownian motion to generate null curves. See details (Default null.model.bm = FALSE).</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>tree</code></td>
<td>
<p>Phylogenetic tree, as phylo object.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>runs</code></td>
<td>
<p>Number of randomizations.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>progressbar</code></td>
<td>
<p>Logical argument (TRUE or FALSE) to specify if display a progress bar 
on the R console (Default progressbar = FALSE).</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>parallel</code></td>
<td>
<p>Number of parallel processes or a predefined socket cluster done with parallel package. Tip: use detectCores() (Default parallel = NULL).</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>values</code></td>
<td>
<p>The eigenvalues, relative eigenvalues and cumulative relative eigenvalues returned by <code>pcps</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>vectors</code></td>
<td>
<p>The principal coordinates of phylogenetic structure returned by <code>pcps</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>mt</code></td>
<td>
<p>Matrix containing trait average at community level for one trait.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>x</code></td>
<td>
<p>An object of class pcpscurve.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>draw.model</code></td>
<td>
<p>Type of null model to draw; none (none), taxa shuffle (ts), browian motion model (bm).</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>type</code></td>
<td>
<p>Type of the plot to be drawn (Default type = "b").</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>probs</code></td>
<td>
<p>Numeric vector of probabilities used by <code>quantile</code>. (Default probs = c(0.025, 0.975)).</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>col</code></td>
<td>
<p>Plot color.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>model.col</code></td>
<td>
<p>Color of lines of null models.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>...</code></td>
<td>
<p>Further graphical parameters for points.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>object</code></td>
<td>
<p>An object of class pcpscurve.</p>
</td>
</tr>
</table>
<h3>Details</h3>

<p>The sequence species show up in the community data matrix must be the 
same as they show up in the phylogenetic distance matrix and in traits
matrix. The function <code>organize.pcps</code> organizes the data, placing the matrices of 
community and phylogenetic distance and trait in the same order. The function use of function 
organize.pcps is not requered for run the functions, but is recommended. In this way 
the arguments comm and phylodist can be specified them as normal arguments or by passing
them with the object returned by the function <code>organize.pcps</code> using, in this
case only the argument comm. Using the object returned by organize.pcps, the comm argument 
is used as an alternative way of entering to set all data.frames/matrices, and therefore 
the arguments phylodist and trait must not be specified.
</p>
<p>The PCPS are used, in a sequential manner, as predictors in a linear regression
to model the trait averages across the metacommunity. The curve is drawn as the
percentage of cumulative eigenvalues in the abscissa and as the determination 
coefficient of regressions in the ordinate.
</p>
<p>Two null models are available. The first one (ts), the null curves are generated
shuffling terminal tips across the phylogenetic tree, generates a set of random PCPS
and recalculates the curves. The second (bm), the null curves are generated with 
simulate traits evolving under Brownian motion model.
</p>


<h3>Value</h3>

<table>
<tr style="vertical-align: top;">
<td><code>curve.obs</code></td>
<td>
<p>The cumulative PCPS eigenvalues and the coefficient of determination.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>curve.null.ts</code></td>
<td>
<p>The cumulative PCPS eigenvalues and the coefficient of determination for 
each randomization using the taxa shuffle null model.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>curve.null.bm</code></td>
<td>
<p>The cumulative PCPS 
eigenvalues and the coefficient of determination for each randomization using the Brownian motion null model.</p>
</td>
</tr>
</table>
<h3>Note</h3>

<p><strong>IMPORTANT</strong>: The sequence of species in the community data matrix
MUST be the same as that in the phylogenetic distance matrix and in traits
matrix. See details and <code>organize.pcps</code>.
</p>


<h3>Author(s)</h3>

<p>Vanderlei Julio Debastiani &lt;vanderleidebastiani@yahoo.com.br&gt;
</p>


<h3>References</h3>

<p>Duarte, L.S. (2011). Phylogenetic habitat filtering influences forest nucleation
in grasslands. Oikos, 120, 208:215.
</p>


<h3>See Also</h3>

<p><code>matrix.p</code>, <code>pcps</code>
</p>


<h3>Examples</h3>

<pre><code class="language-R">
## Not run: 
data(flona)
res&lt;-pcps.curve(flona$community, flona$phylo, flona$trait[,1,drop = FALSE], 
       null.model.ts = TRUE, runs = 9)
res
summary(res)
plot(res, draw.model = "ts", type = "b", col = "red")

## End(Not run)

</code></pre>


</div>