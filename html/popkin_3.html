<div class="container">

<table style="width: 100%;"><tr>
<td>admix_order_cols</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>Reorder admixture matrix columns</h2>

<h3>Description</h3>

<p>Returns the order of the columns (ancestries) of an admixture matrix so that they are in their average order of appearance in rows (individuals).
More specifically, for each ancestry it calculates its mean row (expected row number weighted by this ancestry's proportion distribution among rows), and returns the order in which these mean row values are increasing.
In datasets where the rows/individuals are already ordered in a meaningful way (for example, by distance from the species' geographical origin, and generally grouping the most similar individuals together), this function can lead to a more pleasing automated visualization of the admixture proportions.
</p>


<h3>Usage</h3>

<pre><code class="language-R">admix_order_cols(Q)
</code></pre>


<h3>Arguments</h3>

<table><tr style="vertical-align: top;">
<td><code>Q</code></td>
<td>
<p>The admixture proportions matrix.</p>
</td>
</tr></table>
<h3>Value</h3>

<p>The desired order of the columns (a vector of indexes).
</p>


<h3>See Also</h3>

<p><code>admix_label_cols()</code> to automatically assign labels to ancestries given labels to individuals.
</p>
<p><code>plot_admix()</code> for plotting admixture matrices.
</p>


<h3>Examples</h3>

<pre><code class="language-R"># here is a toy admixture proportions matrix with columns in no meaningful order
Q &lt;- matrix(
    c(
        0.1, 0.8, 0.1,
        0.1, 0.7, 0.2,
        0.0, 0.4, 0.6,
        0.0, 0.3, 0.7,
        0.9, 0.0, 0.1
    ),
    nrow = 5,
    ncol = 3,
    byrow = TRUE
)
# get nicer order
indexes &lt;- admix_order_cols( Q )
# apply reordering to columns
Q &lt;- Q[ , indexes ]

# notice that now the first columns takes on the highest values initially,
# followed by the second column, and lastly the third column.

</code></pre>


</div>