<div class="container">

<table style="width: 100%;"><tr>
<td>pbd_loglik</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>Loglikelihood for protracted birth-death model of diversification</h2>

<h3>Description</h3>

<p>pbd_loglik computes the loglikelihood of the parameters of the protracted speciation model given a set of branching times and number of missing species
</p>


<h3>Usage</h3>

<pre><code class="language-R">pbd_loglik(
    pars1,
    pars1f = c(function(t,pars) {pars[1]},function(t,pars) {pars[2]},
function(t,pars) {pars[3]}, function(t,pars) {pars[4]}),
    pars2 = c(1,1,2,1,"lsoda",0,0),
    brts,
    missnumspec = 0
)</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>pars1</code></td>
<td>
<p>Vector of parameters: <br><br><code>pars1[1]</code> corresponds to b (= la_1 in Etienne &amp; Rosindell R2012) = speciation initiation rate <br><code>pars1[2]</code> corresponds to mu_1 (= mu_g in Etienne &amp; Rosindell 2012) = extinction rate of good species <br><code>pars1[3]</code> corresponds to la_1 (= la_2 in Etienne &amp; Rosindell 2012) = speciation completion rate <br><code>pars1[4]</code> corresponds to mu_2 (= mu_i in ER2012) = extinction rate of incipient species <br>
When rates depend on time this time dependence should be specified in pars1f and pars1 then becomes the parameters used in pars1f <br><br></p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>pars1f</code></td>
<td>
<p>Vector of functions how the rates depend on time, default functions are constant functions of the parameters in pars1: <br><br><code>pars1f[1]</code> corresponds to time-dependence of b (= la_1 in Etienne &amp; Rosindell R2012) = speciation initiation rate <br><code>pars1f[2]</code> corresponds to time-dependence of mu_1 (= mu_g in Etienne &amp; Rosindell 2012) = extinction rate of good species <br><code>pars1f[3]</code> corresponds to tiem-dependence of la_1 (= la_2 in Etienne &amp; Rosindell 2012) = speciation completion rate <br><code>pars1f[4]</code> corresponds to time-dependence of mu_2 (= mu_i in ER2012) = extinction rate of incipient species <br><br></p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>pars2</code></td>
<td>
<p>Vector of model settings: <br><br><code>pars2[1]</code> set the conditioning on non-extinction of the clade (1) or not (0) <br><br><code>pars2[2]</code> sets whether the likelihood is for the branching times (0) or the phylogeny (1) <br><br><code>pars2[3]</code> sets whether the first element of the branching times is the stem (1) or the crown (2) age <br><br><code>pars2[4]</code> sets whether the parameters and likelihood should be shown on screen (1) or not (0) <br><br><code>pars2[5]</code> sets which method should be used in the ode-solver. Default is 'lsoda'. See package deSolve for details. <br><br><code>pars2[6]</code>Sets the lower bound of the number of species on which conditioning should be done when cond = 2. Set this to 0 when conditioning should be done on precisely the number of species (default)<br><br><code>pars2[7]</code>Sets the upper bound of the number of species on which conditioning should be done when cond = 2. Set this to 0 when conditioning should be done on precisely the number of species (default)<br><br></p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>brts</code></td>
<td>
<p>A set of branching times of a phylogeny, all positive </p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>missnumspec</code></td>
<td>
<p>The number of species that are in the clade but missing in the phylogeny </p>
</td>
</tr>
</table>
<h3>Value</h3>

<p>The loglikelihood</p>


<h3>Author(s)</h3>

<p> Rampal S. Etienne </p>


<h3>See Also</h3>

<p><code>pbd_ML</code>
</p>


<h3>Examples</h3>

<pre><code class="language-R"> pbd_loglik(pars1 = c(0.2,0.1,1,0.1), pars2 = c(1,1,2,0,"lsoda"),brts = 1:10) </code></pre>


</div>