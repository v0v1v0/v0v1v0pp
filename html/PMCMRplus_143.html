<div class="container">

<table style="width: 100%;"><tr>
<td>mackWolfeTest</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>Mack-Wolfe Test for Umbrella Alternatives</h2>

<h3>Description</h3>

<p>Performs Mack-Wolfe non-parametric test for umbrella alternatives.
</p>


<h3>Usage</h3>

<pre><code class="language-R">mackWolfeTest(x, ...)

## Default S3 method:
mackWolfeTest(x, g, p = NULL, nperm = 1000, ...)

## S3 method for class 'formula'
mackWolfeTest(formula, data, subset, na.action, p = NULL, nperm = 1000, ...)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>x</code></td>
<td>
<p>a numeric vector of data values, or a list of numeric data
vectors.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>...</code></td>
<td>
<p>further arguments to be passed to or from methods.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>g</code></td>
<td>
<p>a vector or factor object giving the group for the
corresponding elements of <code>"x"</code>.
Ignored with a warning if <code>"x"</code> is a list.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>p</code></td>
<td>
<p>the a-priori known peak as an ordinal number of the treatment
group including the zero dose level, i.e. <code class="reqn">p = \{1, \ldots, k\}</code>.
Defaults to <code>NULL</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>nperm</code></td>
<td>
<p>number of permutations for the assymptotic permutation test.
Defaults to <code>1000</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>formula</code></td>
<td>
<p>a formula of the form <code>response ~ group</code> where
<code>response</code> gives the data values and <code>group</code> a vector or
factor of the corresponding groups.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>data</code></td>
<td>
<p>an optional matrix or data frame (or similar: see
<code>model.frame</code>) containing the variables in the
formula <code>formula</code>.  By default the variables are taken from
<code>environment(formula)</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>subset</code></td>
<td>
<p>an optional vector specifying a
subset of observations to be used.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>na.action</code></td>
<td>
<p>a function which indicates what should happen when
the data contain <code>NA</code>s.  Defaults to <code>getOption("na.action")</code>.</p>
</td>
</tr>
</table>
<h3>Details</h3>

<p>In dose-finding studies one may assume an increasing treatment
effect with increasing dose level. However, the test
subject may actually succumb to toxic effects at high doses,
which leads to decresing treatment effects.
</p>
<p>The scope of the Mack-Wolfe Test is to test for umbrella alternatives
for either a known or unknown point <code class="reqn">p</code> (i.e. dose-level),
where the peak (umbrella point) is present.
</p>
<p>H<code class="reqn">_i: \theta_0 = \theta_i = \ldots = \theta_k</code> is tested
against the alternative A<code class="reqn">_i: \theta_1 \le \ldots \theta_p \ge
\theta_k</code> for some <code class="reqn">p</code>, with at least one strict inequality.
</p>
<p>If <code>p = NULL</code> (peak unknown), the upper-tail <code class="reqn">p</code>-value is computed
via an asymptotic bootstrap permutation test.
</p>
<p>If an integer value for <code>p</code> is given (peak known), the
upper-tail <code class="reqn">p</code>-value is computed from the standard normal
distribution (<code>pnorm</code>).
</p>


<h3>Value</h3>

<p>A list with class <code>"htest"</code> containing the following components:
</p>

<dl>
<dt>method</dt>
<dd>
<p>a character string indicating what type of test was performed.</p>
</dd>
<dt>data.name</dt>
<dd>
<p>a character string giving the name(s) of the data.</p>
</dd>
<dt>statistic</dt>
<dd>
<p>the estimated quantile of the test statistic.</p>
</dd>
<dt>p.value</dt>
<dd>
<p>the p-value for the test.</p>
</dd>
<dt>parameter</dt>
<dd>
<p>the parameters of the test statistic, if any.</p>
</dd>
<dt>alternative</dt>
<dd>
<p>a character string describing the alternative hypothesis.</p>
</dd>
<dt>estimates</dt>
<dd>
<p>the estimates, if any.</p>
</dd>
<dt>null.value</dt>
<dd>
<p>the estimate under the null hypothesis, if any.</p>
</dd>
</dl>
<h3>Note</h3>

<p>One may increase the number of permutations to e.g. <code>nperm = 10000</code>
in order to get more precise p-values. However, this will be on
the expense of computational time.
</p>


<h3>References</h3>

<p>Chen, I. Y. (1991) Notes on the Mack-Wolfe and Chen-Wolfe
Tests for Umbrella Alternatives, <em>Biom. J.</em> <b>33</b>, 281–290.
</p>
<p>Mack, G. A., Wolfe, D. A. (1981) K-sample rank tests for
umbrella alternatives, <em>J. Amer. Statist. Assoc.</em> <b>76</b>, 175–181.
</p>


<h3>See Also</h3>

<p><code>pnorm</code>, <code>sample</code>.
</p>


<h3>Examples</h3>

<pre><code class="language-R">## Example from Table 6.10 of Hollander and Wolfe (1999).
## Plates with Salmonella bacteria of strain TA98 were exposed to
## various doses of Acid Red 114 (in mu g / ml).
## The data are the numbers of visible revertant colonies on 12 plates.
## Assume a peak at D333 (i.e. p = 3).
x &lt;- c(22, 23, 35, 60, 59, 54, 98, 78, 50, 60, 82, 59, 22, 44,
  33, 23, 21, 25)
g &lt;- as.ordered(rep(c(0, 100, 333, 1000, 3333, 10000), each=3))
plot(x ~ g)
mackWolfeTest(x=x, g=g, p=3)

</code></pre>


</div>