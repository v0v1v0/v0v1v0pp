<div class="container">

<table style="width: 100%;"><tr>
<td>wSELF</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>Weight updating functions</h2>

<h3>Description</h3>


<ul>
<li> <p><code>wSELF</code> weigth are not changed and return the original.
</p>
</li>
<li> <p><code>wTSM</code> weight updating method in TIMESAT.
</p>
</li>
<li> <p><code>wBisquare</code> Bisquare weight update method. wBisquare has been
modified to emphasis on upper envelope.
</p>
</li>
<li> <p><code>wBisquare0</code> Traditional Bisquare weight update method.
</p>
</li>
<li> <p><code>wChen</code> Chen et al., (2004) weight updating method.
</p>
</li>
<li> <p><code>wBeck</code> Beck et al., (2006) weigth updating method. wBeck need
sos and eos input. The function parameter is different from others. It is
still not finished.
</p>
</li>
</ul>
<h3>Usage</h3>

<pre><code class="language-R">wSELF(y, yfit, w, ...)

wTSM(y, yfit, w, iter = 2, nptperyear, wfact = 0.5, ...)

wBisquare0(y, yfit, w, ..., wmin = 0.2)

wBisquare(y, yfit, w, ..., wmin = 0.2, .toUpper = TRUE)

wChen(y, yfit, w, ..., wmin = 0.2)

wKong(y, yfit, w, ..., wmin = 0.2)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>y</code></td>
<td>
<p>Numeric vector, vegetation index time-series</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>yfit</code></td>
<td>
<p>Numeric vector curve fitting values.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>w</code></td>
<td>
<p>(optional) Numeric vector, weights of <code>y</code>. If not specified,
weights of all <code>NA</code> values will be <code>wmin</code>, the others will be 1.0.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>...</code></td>
<td>
<p>other parameters are ignored.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>iter</code></td>
<td>
<p>iteration of curve fitting.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>nptperyear</code></td>
<td>
<p>Integer, number of images per year.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>wfact</code></td>
<td>
<p>weight adaptation factor (0-1), equal to the reciprocal of
'Adaptation strength' in TIMESAT.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>wmin</code></td>
<td>
<p>Double, minimum weight of bad points, which could be smaller
the weight of snow, ice and cloud.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>.toUpper</code></td>
<td>
<p>Boolean. Whether to approach the upper envelope?</p>
</td>
</tr>
</table>
<h3>Value</h3>

<p>wnew Numeric Vector, adjusted weights.
</p>


<h3>Author(s)</h3>

<p>wTSM is implemented by Per J\"onsson, Malm\"o University, Sweden
<a href="mailto:per.jonsson@ts.mah.se">per.jonsson@ts.mah.se</a> and Lars Eklundh, Lund University, Sweden
<a href="mailto:lars.eklundh@nateko.lu.se">lars.eklundh@nateko.lu.se</a>.
And Translated into Rcpp by Dongdong Kong, 01 May 2018.
</p>


<h3>References</h3>


<ol>
<li>
<p> Per J\"onsson, P., Eklundh, L., 2004. TIMESAT - A program for analyzing
time-series of satellite sensor data. Comput. Geosci. 30, 833-845.
https://doi.org/10.1016/j.cageo.2004.05.006. <br></p>
</li>
<li>
<p> https://au.mathworks.com/help/curvefit/smoothing-data.html#bq_6ys3-3 <br></p>
</li>
<li>
<p> Garcia, D., 2010. Robust smoothing of gridded data in one and higher
dimensions with missing values. Computational statistics &amp; data analysis,
54(4), pp.1167-1178. <br></p>
</li>
<li>
<p> Chen, J., J\"onsson, P., Tamura, M., Gu, Z., Matsushita, B., Eklundh, L.,
2004. A simple method for reconstructing a high-quality NDVI time-series
data set based on the Savitzky-Golay filter. Remote Sens. Environ. 91,
332-344. https://doi.org/10.1016/j.rse.2004.03.014. <br></p>
</li>
<li>
<p> Beck, P.S.A., Atzberger, C., Hogda, K.A., Johansen, B., Skidmore, A.K.,
2006. Improved monitoring of vegetation dynamics at very high latitudes:
A new method using MODIS NDVI. Remote Sens. Environ.
https://doi.org/10.1016/j.rse.2005.10.021 <br></p>
</li>
<li>
<p> https://github.com/kongdd/phenopix/blob/master/R/FitDoubleLogBeck.R
</p>
</li>
</ol>
</div>