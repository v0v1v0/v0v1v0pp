<div class="container">

<table style="width: 100%;"><tr>
<td>dbs</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>Density-based silhouette information methods</h2>

<h3>Description</h3>

<p>Computes the density-based silhouette information of clustered data. Two methods are associated to this function. The first
method applies to two arguments: the matrix of data and the vector of cluster labels; the second method applies to objects of 
<code>pdfCluster-class</code>.
</p>


<h3>Usage</h3>

<pre><code class="language-R">## S4 method for signature 'matrix'
dbs(x, clusters, h.funct="h.norm", hmult=1, prior, ...)

## S4 method for signature 'pdfCluster'
dbs(x, h.funct="h.norm", hmult = 1, prior = 
   as.vector(table(x@cluster.cores)/sum(table(x@cluster.cores))), 
   stage=NULL, ...)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>x</code></td>
<td>

<p>A matrix of data points partitioned by any density-based clustering method or an object of <code>pdfCluster-class</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>clusters</code></td>
<td>

<p>Cluster labels of grouped data. This argument has not to be set when <code>x</code> is a <code>pdfCluster-class</code> object.
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>h.funct</code></td>
<td>

<p>Function to estimate the smoothing parameters. Default is <code>h.norm</code>. 
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>hmult</code></td>
<td>

<p>Shrink factor to be multiplied by the smoothing parameters. Default value is 1. 
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>prior</code></td>
<td>

<p>Vector of prior probabilities of belonging to the groups. When <code>x</code> is of <code>pdfCluster-class</code>,
default value is set proportional to the cluster cores cardinalities. Otherwise, equal prior probabilities are 
given to the clusters by default. 
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>stage</code></td>
<td>

<p>When <code>x</code> is a <code>pdfCluster-class</code> object, this is the stage of classification of low-density data at which the dbs has to be computed.
Default value is the number of stages of the procedure. Set it to 0 if the dbs has to be computed at cluster cores only.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>...</code></td>
<td>

<p>Further arguments to be passed to methods (see <code>dbs-methods</code>) or arguments to <code>kepdf</code>. See details below.</p>
</td>
</tr>
</table>
<h3>Details</h3>

<p>This function provides diagnostics for a clustering produced by any density-based clustering method. The <code>dbs</code>
information is a suitable modification of the <code>silhouette</code> information aimed at evaluating 
the cluster quality in a density based framework. It is based on the estimation of data posterior probabilities of belonging to the clusters. It may be 	 
used to measure the quality of data allocation to the clusters. High values of the <code class="reqn">\hat{dbs}</code> are evidence of a good quality clustering. 	 
</p>
<p>Define
</p>
<p style="text-align: center;"><code class="reqn">
\hat{\tau}_m(x_i)=\frac{\pi_{m} \hat{f}(x_i|x_ \in m)}{\sum_{m=1}^M \pi_{m}\hat{f}(x_i|x_i \in m)} \quad m=1,\ldots,M, 
</code>
</p>

<p>where <code class="reqn">\pi_{m}</code> is a prior probability of <code class="reqn">m</code> and <code class="reqn">\hat{f}(x_i|x_i \in m)</code> is a density estimate at <code class="reqn">x_i</code> evaluated with function <code>kepdf</code> by using the only data points in <code class="reqn">m</code>. Density estimation is performed with fixed bandwidths <code>h</code>, as evaluated by function <code>h.funct</code>, possibly multiplied by the shrink factor <code>hmult</code>.
</p>
<p>Density-based silhouette information of <code class="reqn">x_i</code>, the <code class="reqn">i^{th}</code> row of the data matrix <code>x</code>, is defined as follows:
</p>
<p style="text-align: center;"><code class="reqn">
\hat{dbs}_i=\frac{\log\left(\frac{\hat{\tau}_{m_{0}}(x_i)}{\hat{\tau}_{m_{1}}(x_i)}\right)}{{\max}_{x_i }\left| \log\left(\frac{\hat{\tau}_{m_{0}}(x_i)}{\hat{\tau}_{m_{1}}(x_i)}\right)\right|},
</code>
</p>

<p>where <code class="reqn">m_0</code> is the group where <code class="reqn">x_i</code> has been allocated and <code class="reqn">m_1</code> is the group for which <code class="reqn">\tau_m</code> is maximum, <code class="reqn">m\neq m_0</code>. 
</p>
<p><em>Note:</em> when there exists <code class="reqn">x_j</code> such that <code class="reqn">\hat{\tau}_{m_{1}}(x_j)</code> is zero, <code class="reqn">\hat{dbs}_j</code> is forced to 1 and <code class="reqn">{\max}_{x_i }\left| \log\left(\frac{\hat{\tau}_{m_{0}}(x_i)}{\hat{\tau}_{m_{1}}(x_i)}\right)\right|</code>
is computed by excluding <code class="reqn">x_j</code> from the data matrix <code>x</code>.
</p>
<p>See Menardi (2011) for a detailed treatment.</p>


<h3>Value</h3>

<p>An object of class <code>"dbs"</code>, with slots:  
</p>
<table>
<tr style="vertical-align: top;">
<td><code>call </code></td>
<td>
<p>The matched call.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>x </code></td>
<td>
<p>The matrix of clustered data points.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>prior </code></td>
<td>
<p>The vector of prior probabilities of belonging to the groups.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>dbs </code></td>
<td>
<p>A vector reporting the density-based silhouette information of the clustered data.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>clusters </code></td>
<td>
<p>Cluster labels of grouped data.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>noc </code></td>
<td>
<p>Number of clusters</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>stage </code></td>
<td>
<p>If argument <code>x</code> of <code>dbs</code> is a  <code>pdfCluster-class</code> object, this slot provides the stage of the classification at which the dbs is computed.</p>
</td>
</tr>
</table>
<p>See <code>dbs-class</code> for more details.
</p>


<h3>Methods</h3>


<dl>
<dt><code>signature(x = "matrix", clusters = "numeric")</code></dt>
<dd>
<p>Computes the density based silhouette information for objects partitioned 
according to any density-based clustering method.
</p>
</dd>
<dt><code>signature(x = "pdfCluster", clusters = "missing")</code></dt>
<dd>
<p>Computes the density based silhouette information for objects of class 
<code>"pdfCluster"</code></p>
</dd>
</dl>
<p>.
</p>


<h3>References</h3>

<p>Menardi, G. (2011) Density-based Silhouette diagnostics for clustering methods. <em>Statistics and Computing</em>, 21, 295-308.</p>


<h3>See Also</h3>

<p><code>dbs-class</code>, <code>plot,dbs-method</code>, <code>silhouette</code>.
</p>


<h3>Examples</h3>

<pre><code class="language-R">#example 1: no groups in data
#random generation of group labels
set.seed(54321)
x &lt;- rnorm(50)
groups &lt;- sample(1:2, 50, replace = TRUE)
groups
dsil &lt;- dbs(x = as.matrix(x), clusters=groups)
dsil
summary(dsil)
plot(dsil, labels=TRUE, lwd=6)

#example 2: wines data
# load data
data(wine)

# select a subset of variables
x &lt;- wine[, c(2,5,8)]

#clustering
cl &lt;- pdfCluster(x)
 
dsil &lt;- dbs(cl)
plot(dsil)

</code></pre>


</div>