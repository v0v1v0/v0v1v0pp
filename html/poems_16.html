<div class="container">

<table style="width: 100%;"><tr>
<td>population_dispersal</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>Nested functions for population dispersal.</h2>

<h3>Description</h3>

<p>Modular functions for the population simulator for performing dispersal of stage
abundance at a specified time step via dispersal rates provided.
</p>


<h3>Usage</h3>

<pre><code class="language-R">population_dispersal(
  replicates,
  time_steps,
  years_per_step,
  populations,
  demographic_stochasticity,
  density_stages,
  dispersal,
  dispersal_stages,
  dispersal_source_n_k = NULL,
  dispersal_target_k = NULL,
  dispersal_target_n = NULL,
  dispersal_target_n_k = NULL,
  simulator
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>replicates</code></td>
<td>
<p>Number of replicate simulation runs.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>time_steps</code></td>
<td>
<p>Number of simulation time steps.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>years_per_step</code></td>
<td>
<p>Number of years per time step.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>populations</code></td>
<td>
<p>Number of populations.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>demographic_stochasticity</code></td>
<td>
<p>Boolean for optionally choosing demographic stochasticity for the transformation.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>density_stages</code></td>
<td>
<p>Array of booleans or numeric (0,1) for each stage to indicate which stages are affected by density.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>dispersal</code></td>
<td>
<p>Either a matrix of dispersal rates between populations (source columns to target rows) or a list of data frames of non-zero dispersal rates and indices for constructing a compact dispersal matrix, and optional changing rates over time (as per class <code>DispersalGenerator</code> <em>dispersal_data</em> attribute). Alternatively a user-defined function (optionally nested in a list with additional attributes) may be used: <code>function(params)</code>, where <em>params</em> is a list passed to the function containing:
</p>

<dl>
<dt><code>replicates</code></dt>
<dd>
<p>Number of replicate simulation runs.</p>
</dd>
<dt><code>time_steps</code></dt>
<dd>
<p>Number of simulation time steps.</p>
</dd>
<dt><code>years_per_step</code></dt>
<dd>
<p>Number of years per time step.</p>
</dd>
<dt><code>populations</code></dt>
<dd>
<p>Number of populations.</p>
</dd>
<dt><code>stages</code></dt>
<dd>
<p>Number of life cycle stages.</p>
</dd>
<dt><code>demographic_stochasticity</code></dt>
<dd>
<p>Boolean for optionally choosing demographic stochasticity for the transformation.</p>
</dd>
<dt><code>density_stages</code></dt>
<dd>
<p>Array of booleans or numeric (0,1) for each stage to indicate which stages are affected by density.</p>
</dd>
<dt><code>dispersal_stages</code></dt>
<dd>
<p>Array of relative dispersal (0-1) for each stage to indicate the degree to which each stage participates in dispersal.</p>
</dd>
<dt><code>dispersal_source_n_k</code></dt>
<dd>
<p>Dispersal proportion (p) density dependence via source population abundance divided by carrying capacity (n/k), where p is reduced via a linear slope (defined by two list items) from n/k &lt;= <em>cutoff</em> (p = 0) to n/k &gt;= <em>threshold</em>.</p>
</dd>
<dt><code>dispersal_target_k</code></dt>
<dd>
<p>Dispersal rate (r) density dependence via target population carrying capacity (k), where r is reduced via a linear slope (through the origin) when k &lt;= <em>threshold</em>.</p>
</dd>
<dt><code>dispersal_target_n</code></dt>
<dd>
<p>Dispersal rate (r) density dependence via target population abundance (n), where r is reduced via a linear slope (defined by two list items) from n &gt;= <em>threshold</em> to n &lt;= <em>cutoff</em> (r = 0) or vice versa.</p>
</dd>
<dt><code>dispersal_target_n_k</code></dt>
<dd>
<p>Dispersal rate (r) density dependence via target population abundance divided by carrying capacity (n/k), where r is reduced via a linear slope (defined by two list items) from n/k &gt;= <em>threshold</em> to n/k &lt;= <em>cutoff</em> (r = 0) or vice versa.</p>
</dd>
<dt><code>r</code></dt>
<dd>
<p>Simulation replicate.</p>
</dd>
<dt><code>tm</code></dt>
<dd>
<p>Simulation time step.</p>
</dd>
<dt><code>carrying_capacity</code></dt>
<dd>
<p>Array of carrying capacity values for each population at time step.</p>
</dd>
<dt><code>stage_abundance</code></dt>
<dd>
<p>Matrix of abundance for each stage (rows) and population (columns) at time step.</p>
</dd>
<dt><code>occupied_indices</code></dt>
<dd>
<p>Array of indices for populations occupied at time step.</p>
</dd>
<dt><code>simulator</code></dt>
<dd>
<p><code>SimulatorReference</code> object with dynamically accessible <em>attached</em> and <em>results</em> lists.</p>
</dd>
<dt><code>additional attributes</code></dt>
<dd>
<p>Additional attributes when the transformation is optionally nested in a list.</p>
</dd>
</dl>
<p>returns the post-dispersal abundance matrix</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>dispersal_stages</code></td>
<td>
<p>Array of relative dispersal (0-1) for each stage to indicate the degree to which each stage participates in dispersal (default is 1 for all stages).</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>dispersal_source_n_k</code></td>
<td>
<p>Dispersal proportion (p) density dependence via source population abundance divided by carrying capacity (n/k), where p is reduced via a linear slope (defined by two list items) from n/k &lt;= <em>cutoff</em> (p = 0) to n/k &gt;= <em>threshold</em> or vice versa.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>dispersal_target_k</code></td>
<td>
<p>Dispersal rate (r) density dependence via target population carrying capacity (k), where r is reduced via a linear slope (through the origin) when k &lt;= <em>threshold</em>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>dispersal_target_n</code></td>
<td>
<p>Dispersal rate (r) density dependence via target population abundance (n), where r is reduced via a linear slope (defined by two list items) from n &gt;= <em>threshold</em> to n &lt;= <em>cutoff</em> (r = 0) or visa-versa.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>dispersal_target_n_k</code></td>
<td>
<p>Dispersal rate (r) density dependence via target population abundance divided by carrying capacity (n/k), where r is reduced via a linear slope (defined by two list items) from n/k &gt;= <em>threshold</em> to n/k &lt;= <em>cutoff</em> (r = 0) or vice versa.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>simulator</code></td>
<td>
<p><code>SimulatorReference</code> object with dynamically accessible <em>attached</em> and <em>results</em> lists.</p>
</td>
</tr>
</table>
<h3>Value</h3>

<p>Dispersal function: <code>function(r, tm, carrying_capacity, stage_abundance, occupied_indices)</code>, where:
</p>

<dl>
<dt><code>r</code></dt>
<dd>
<p>Simulation replicate.</p>
</dd>
<dt><code>tm</code></dt>
<dd>
<p>Simulation time step.</p>
</dd>
<dt><code>carrying_capacity</code></dt>
<dd>
<p>Array of carrying capacity values for each population at time step.</p>
</dd>
<dt><code>stage_abundance</code></dt>
<dd>
<p>Matrix of abundance for each stage (rows) and population (columns) at time step.</p>
</dd>
<dt><code>occupied_indices</code></dt>
<dd>
<p>Array of indices for populations occupied at time step.</p>
</dd>
<dt><code>returns</code></dt>
<dd>
<p>New stage abundance matrix with dispersal applied.</p>
</dd>
</dl>
<h3>Examples</h3>

<pre><code class="language-R"># User-defined dispersal: one-quarter of dispersing stages move one population over
simulator &lt;- SimulatorReference$new()
example_function &lt;- function(params) {
  params$simulator$attached$params &lt;- params # attach to reference object
  emigrants &lt;- round(params$stage_abundance * params$dispersal_stages * 0.25)
  return(params$stage_abundance - emigrants + emigrants[, c(7, 1:6)])
}
dispersal_function &lt;- population_dispersal(
 replicates = 4,
 time_steps = 10,
 years_per_step = 1,
 populations = 7,
 demographic_stochasticity = TRUE,
 density_stages = c(0, 1, 1),
 dispersal = example_function,
 dispersal_stages = c(0, 1, 0.5),
 dispersal_source_n_k = list(cutoff = -0.5, threshold = 1.5),
 dispersal_target_k = 5,
 dispersal_target_n = list(threshold = 10, cutoff = 15),
 simulator = simulator
)
carrying_capacity &lt;- rep(10, 7)
stage_abundance &lt;- matrix(
 c(
   7, 13, 0, 26, 0, 39, 47,
   2, 0, 6, 8, 0, 12, 13,
   0, 3, 4, 6, 0, 9, 10
 ),
 nrow = 3,
 ncol = 7,
 byrow = TRUE
)
occupied_indices &lt;- (1:7)[-5]
dispersal_function(r = 2, tm = 6, carrying_capacity, stage_abundance,
                   occupied_indices)

</code></pre>


</div>