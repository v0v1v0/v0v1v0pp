<div class="container">

<table style="width: 100%;"><tr>
<td>optimal_phyloregion</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>Determine optimal number of clusters</h2>

<h3>Description</h3>

<p>This function divides the hierarchical dendrogram into meaningful
clusters ("phyloregions"), based on the ‘elbow’ or ‘knee’ of
an evaluation graph that corresponds to the point of optimal curvature.
</p>


<h3>Usage</h3>

<pre><code class="language-R">optimal_phyloregion(x, method = "average", k = 20)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>x</code></td>
<td>
<p>a numeric matrix, data frame or “dist” object.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>method</code></td>
<td>
<p>the agglomeration method to be used. This should
be (an unambiguous abbreviation of) one of “ward.D”, “ward.D2”,
“single”, “complete”, “average” (= UPGMA),
“mcquitty” (= WPGMA),
“median” (= WPGMC) or “centroid” (= UPGMC).</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>k</code></td>
<td>
<p>numeric, the upper bound of the number of clusters to
compute. DEFAULT: 20 or the number of observations (if less than 20).</p>
</td>
</tr>
</table>
<h3>Value</h3>

<p>a list containing the following as returned from the GMD
package (Zhao et al. 2011):
</p>

<ul>
<li> <p><code>k</code>:	optimal number of clusters (bioregions)
</p>
</li>
<li> <p><code>totbss</code>:	total between-cluster sum-of-square
</p>
</li>
<li> <p><code>tss</code>:	total sum of squares of the data
</p>
</li>
<li> <p><code>ev</code>:	explained variance given k
</p>
</li>
</ul>
<h3>References</h3>

<p>Salvador, S. &amp; Chan, P. (2004) <em>Determining the number of
clusters/segments in hierarchical clustering/segmentation algorithms</em>.
Proceedings of the Sixteenth IEEE International Conference on Tools
with Artificial Intelligence, pp. 576–584. Institute of Electrical
and Electronics Engineers, Piscataway, New Jersey, USA.
</p>
<p>Zhao, X., Valen, E., Parker, B.J. &amp; Sandelin, A. (2011) Systematic
clustering of transcription start site landscapes.
<em>PLoS ONE</em> <strong>6</strong>: e23409.
</p>


<h3>Examples</h3>

<pre><code class="language-R">data(africa)
tree &lt;- africa$phylo
bc &lt;- beta_diss(africa$comm)
(d &lt;- optimal_phyloregion(bc[[1]], k=15))
plot(d$df$k, d$df$ev, ylab = "Explained variances",
  xlab = "Number of clusters")
lines(d$df$k[order(d$df$k)], d$df$ev[order(d$df$k)], pch = 1)
points(d$optimal$k, d$optimal$ev, pch = 21, bg = "red", cex = 3)
points(d$optimal$k, d$optimal$ev, pch = 21, bg = "red", type = "h")
</code></pre>


</div>