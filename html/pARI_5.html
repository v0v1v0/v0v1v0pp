<div class="container">

<table style="width: 100%;"><tr>
<td>pARI</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>Permutation-based All-Resolutions Inference</h2>

<h3>Description</h3>

<p>The main function for All-Resolutions Inference (ARI) method based on the critical vector constructed 
using the <code class="reqn">p</code>-values permutation distribution. The function computes simultaneous lower bounds for the number of true discoveries 
for each set of hypotheses specified in <code>ix</code> controlling family-wise error rate at level <code>alpha</code>.
</p>


<h3>Usage</h3>

<pre><code class="language-R">pARI(X= NULL, ix, alpha = 0.05, family = "simes", delta = 0, B = 1000, pvalues = NULL, 
test.type = "one_sample", complete = FALSE, clusters = FALSE, iterative = FALSE, 
approx = TRUE, ncomb = 100, step.down = FALSE, max.step = 10, ...)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>X</code></td>
<td>
<p>Data matrix where rows represent the <code class="reqn">m</code> variables and columns the <code class="reqn">n</code> observations.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>ix</code></td>
<td>
<p>Numeric vector which expresses the set of hypotheses of interest. It can be a vector with length equals <code class="reqn">m</code> indicating the corresponding cluster for each variable,
(in this case, you must put <code>clusters = TRUE</code>), or a vector containing the position indices of the variables of interest if only one set/cluster of hypotheses is considered.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>alpha</code></td>
<td>
<p>Numeric value in '[0,1]'. <code class="reqn">\alpha</code> level to control the family-wise error rate. Default to 0.05.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>family</code></td>
<td>
<p>String character. Name of the family confidence envelope to compute the critical vector 
from <code>"simes"</code>, <code>"aorc"</code>, <code>"beta"</code>, <code>"higher.criticism"</code>, and <code>"power"</code>.
Default to "simes".</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>delta</code></td>
<td>
<p>Numeric value. <code class="reqn">\delta</code> value. Please see the reference below. Default to 0.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>B</code></td>
<td>
<p>Numeric value. Number of permutations, default to 1000.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>pvalues</code></td>
<td>
<p>Matrix of <code class="reqn">p</code>-values with dimensions <code class="reqn">m \times B</code> where <code class="reqn">m</code> is the number of variables 
and <code class="reqn">B</code> the number of permutations used instead of the data matrix <code>X</code>. Default to NULL.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>test.type</code></td>
<td>
<p>Character string. Choose a type of tests among <code>"one_sample"</code>, i.e., one-sample t-tests, or <code>"two_samples"</code>, i.e., two-samples t-tests. Default <code>"one_sample"</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>complete</code></td>
<td>
<p>Boolean value. If <code>TRUE</code> the sets of critical vectors and the raw <code class="reqn">p</code>-values are returned. Default to <code>FALSE</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>clusters</code></td>
<td>
<p>Boolean value. If <code>ix</code> indicates many clusters/sets must be <code>TRUE</code>. Default @FALSE.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>iterative</code></td>
<td>
<p>Boolean value. If <code>iterative = TRUE</code>, the iterative method is applied (computationally demanding). Default to <code>FALSE</code>. Please see the reference below.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>approx</code></td>
<td>
<p>Boolean value. Default to <code>TRUE</code>. If you are analyzing high dimensional data, we suggest to put <code>approx = TRUE</code> to speed up the computation time. Please see the reference below.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>ncomb</code></td>
<td>
<p>Numeric value. If <code>approx = TRUE</code>, you must decide how many random sub collections (level of approximation) considered. Default to 100.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>step.down</code></td>
<td>
<p>Boolean value. Default to <code>FALSE</code> If you want to compute the lambda calibration parameter using the step-down approach put <code>TRUE</code>. Please see the reference below.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>max.step</code></td>
<td>
<p>Numeric value. Default to 10. Maximum number of steps for the step down approach, so useful when <code>step.down = TRUE</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>...</code></td>
<td>
<p>Further arguments</p>
</td>
</tr>
</table>
<h3>Value</h3>

<p>by default returns a list with the following objects: 
</p>

<dl>
<dt>discoveries</dt>
<dd>
<p>lower bound for the number of true discoveries in the set selected</p>
</dd>
<dt>ix</dt>
<dd>
<p>selected variables</p>
</dd> 
</dl>
<p>If <code>complete = TRUE</code> the raw <code>pvalues</code> and <code>cv</code> critical vector are also returned.
</p>


<h3>Author(s)</h3>

<p>Angela Andreella
</p>


<h3>References</h3>

<p>For the general framework of All-Resolutions Inference see:
</p>
<p>Goeman, Jelle J., and Aldo Solari. "Multiple testing for exploratory research." Statistical Science 26.4 (2011): 584-597.
</p>
<p>For permutation-based All-Resolutions Inference see:
</p>
<p>Andreella, A., Hemerik, J., Finos, L., Weeda, W., &amp; Goeman, J. (2023). Permutation-based true discovery proportions for functional magnetic resonance imaging cluster analysis. Statistics in Medicine, 42(14), 2311-2340.
</p>


<h3>See Also</h3>

<p>The type of tests implemented: <code>signTest</code> <code>permTest</code>.
</p>


<h3>Examples</h3>

<pre><code class="language-R">datas &lt;- simulateData(pi0 = 0.8, m = 1000, n = 30, power = 0.9, rho = 0,seed = 123)
out &lt;- pARI(X = datas, ix = c(1:200),test.type = "one_sample")
out
</code></pre>


</div>