<div class="container">

<table style="width: 100%;"><tr>
<td>lme.Lb.dist.theta</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>Calculate mean and variance  <br>
for linear combination of the  <br>
Best Linear Unbiased Estimator (BLUE) <br>
for Linear Mixed Effect (LME) Model</h2>

<h3>Description</h3>

<p>Consider the following model: <br><br>
Y=XB+Zu+e, u~N(0,D), e~N(0,R) <br>
Yi~N(XBi,Vi), Vi=Zi*D*Zi'+Ri, <br><br>
for each independent observation i <br><br><br>
estimate of fixed effect coefficient B, denoted by b: <br><br>
b=inv(sum(Xi'*inv(Vi)*Xi))*(sum(Xi'*inv(Vi)*Yi)) <br><br><br>
variance of b: <br><br>
var(b)=Vb/n=inv(sum(Xi'*inv(Vi)*Xi)) <br><br>
where Vb=inv(Xi'*inv(Vi)*Xi) <br><br><br>
distribution of any linear combinations L of b is given by: <br><br>
Lb~N(mu,Sigma/n) <br><br>
where mu = LB, Sigma = L*Vb*L' <br><br><br></p>


<h3>Usage</h3>

<pre><code class="language-R">lme.Lb.dist.theta(B, D, R, X, Z, m = NULL, L)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>B</code></td>
<td>
<p>fixed effect beta in px1 matrix</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>D</code></td>
<td>
<p>list of qxq random effect variance matrix;
where the first element corresponding to the highest-level effect,
the last element corresponding to the level 1 effect <br><br></p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>R</code></td>
<td>
<p>residual variance <br><br></p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>X</code></td>
<td>
<p>nxp matrix representing the covariates for the fixed effects <br><br></p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>Z</code></td>
<td>
<p>nxq matrix representing the covariates for each level of random effects <br><br></p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>m</code></td>
<td>
<p>vector of repeated measures from the highest to lowest level
(level 1 effects are addressed by Z and X and no need to be specified) <br><br></p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>L</code></td>
<td>
<p>lxp matrix, representing l-linear-combinations of beta interested, <br>
if L is not defined, it will be auto-created to select the last coefficient <br><br></p>
</td>
</tr>
</table>
<h3>Details</h3>

<p><a href="https://drive.google.com/open?id=1MQvzp9na-Zm9mFT5jC1I_3U0JHEFky_k">Technical note</a>
</p>


<h3>Value</h3>

<p>theta:  parameters (mu and Sigma) of the normal distribution for Lb
</p>


<h3>Note</h3>

<p>License: GPL-3
</p>


<h3>Author(s)</h3>

<p>Marco Chak Yan YU <br>
Maintainer: Marco Chak Yan YU &lt;marcocyyu@gmail.com&gt;
</p>


<h3>See Also</h3>

<p><code>pass.lme.CLb.test</code>
</p>


<h3>Examples</h3>

<pre><code class="language-R">#Example 1
# calc BLUE for 1-level LME model,
# with covariates X, Z: (1,t), t=1,2,3
# for both fixed and random effects,
# with fixed effect coefficients B: (100,-0.5),
# random effect variance D: (2 1;1 2),
# residual variance R: 0.2
B &lt;- matrix(c(100,-0.5),2,1)
D &lt;- matrix(c(2,1,1,2),2,2)
R &lt;- 0.2
X &lt;- cbind(rep(1,3),1:3)
Z &lt;- X
lme.Lb.dist.theta(B,D,R,X,Z)

#Example 2
# calc BLUE for 3-levels LME model,
# with level 1 same as the above example
# with 3 repeated-measures in level 2
# and 5 repeated-measures in the highest level,
# assuming random effect variance for level 2 = (3 1;1 3),
# and random effect variance for highest level = (5 1;1 5)
D &lt;- list(matrix(c(2,1,1,2),2,2),matrix(c(3,1,1,3),2,2), matrix(c(5,1,1,5),2,2))
lme.Lb.dist.theta(B,D,R,X,Z,m=c(5,3))
</code></pre>


</div>