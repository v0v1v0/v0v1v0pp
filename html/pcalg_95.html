<div class="container">

<table style="width: 100%;"><tr>
<td>pcorOrder</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>Compute Partial Correlations</h2>

<h3>Description</h3>

<p>This function computes partial correlations given a correlation matrix
using a recursive algorithm.
</p>


<h3>Usage</h3>

<pre><code class="language-R">pcorOrder(i,j, k, C, cut.at = 0.9999999)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>i,j</code></td>
<td>
<p>(integer) position of variable <code class="reqn">i</code> and <code class="reqn">j</code>,
respectively, in correlation matrix.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>k</code></td>
<td>
<p>(integer) positions of zero or more conditioning variables in the
correlation matrix.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>C</code></td>
<td>
<p>Correlation matrix (matrix)</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>cut.at</code></td>
<td>
<p>Number slightly smaller than one; if <code class="reqn">c</code> is
<code>cut.at</code>, values outside of <code class="reqn">[-c,c]</code> are set to <code class="reqn">-c</code> or
<code class="reqn">c</code> respectively.</p>
</td>
</tr>
</table>
<h3>Details</h3>

<p>The partial correlations are computed using a recusive formula
if the size of the conditioning set is one. For larger conditioning
sets, the pseudoinverse of parts of the correlation matrix is
computed (by <code>pseudoinverse()</code> from package
<span class="pkg">corpcor</span>).  The pseudoinverse instead of the inverse is used in
order to avoid numerical problems.
</p>


<h3>Value</h3>

<p>The partial correlation of i and j given the set k.
</p>


<h3>Author(s)</h3>

<p>Markus Kalisch <a href="mailto:kalisch@stat.math.ethz.ch">kalisch@stat.math.ethz.ch</a> and Martin Maechler
</p>


<h3>See Also</h3>

<p><code>condIndFisherZ</code> for testing zero partial correlation.
</p>


<h3>Examples</h3>

<pre><code class="language-R">## produce uncorrelated normal random variables
mat &lt;- matrix(rnorm(3*20),20,3)
## compute partial correlation of var1 and var2 given var3
pcorOrder(1,2, 3, cor(mat))

## define graphical model, simulate data and compute
## partial correlation with bigger conditional set
genDAG &lt;- randomDAG(20, prob = 0.2)
dat &lt;- rmvDAG(1000, genDAG)
C &lt;- cor(dat)
pcorOrder(2,5, k = c(3,7,8,14,19), C)
</code></pre>


</div>