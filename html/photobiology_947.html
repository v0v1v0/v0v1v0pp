<div class="container">

<table style="width: 100%;"><tr>
<td>spikes</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>Spikes</h2>

<h3>Description</h3>

<p>Function that returns a subset of an R object with observations corresponding
to spikes. Spikes are values in spectra that are unusually high compared to
neighbors. They are usually individual values or very short runs of similar
"unusual" values. Spikes caused by cosmic radiation are a frequent problem in
Raman spectra. Another source of spikes are "hot pixels" in CCD and diode
arrays.
</p>


<h3>Usage</h3>

<pre><code class="language-R">spikes(x, z.threshold, max.spike.width, na.rm, ...)

## Default S3 method:
spikes(x, z.threshold = NA, max.spike.width = 8, na.rm = FALSE, ...)

## S3 method for class 'numeric'
spikes(x, z.threshold = NA, max.spike.width = 8, na.rm = FALSE, ...)

## S3 method for class 'data.frame'
spikes(
  x,
  z.threshold = 9,
  max.spike.width = 8,
  na.rm = FALSE,
  ...,
  y.var.name = NULL,
  var.name = y.var.name
)

## S3 method for class 'generic_spct'
spikes(
  x,
  z.threshold = 9,
  max.spike.width = 8,
  na.rm = FALSE,
  var.name = NULL,
  ...
)

## S3 method for class 'source_spct'
spikes(
  x,
  z.threshold = 9,
  max.spike.width = 8,
  na.rm = FALSE,
  unit.out = getOption("photobiology.radiation.unit", default = "energy"),
  ...
)

## S3 method for class 'response_spct'
spikes(
  x,
  z.threshold = 9,
  max.spike.width = 8,
  na.rm = FALSE,
  unit.out = getOption("photobiology.radiation.unit", default = "energy"),
  ...
)

## S3 method for class 'filter_spct'
spikes(
  x,
  z.threshold = 9,
  max.spike.width = 8,
  na.rm = FALSE,
  filter.qty = getOption("photobiology.filter.qty", default = "transmittance"),
  ...
)

## S3 method for class 'reflector_spct'
spikes(x, z.threshold = 9, max.spike.width = 8, na.rm = FALSE, ...)

## S3 method for class 'solute_spct'
spikes(x, z.threshold = 9, max.spike.width = 8, na.rm = FALSE, ...)

## S3 method for class 'cps_spct'
spikes(
  x,
  z.threshold = 9,
  max.spike.width = 8,
  na.rm = FALSE,
  var.name = "cps",
  ...
)

## S3 method for class 'raw_spct'
spikes(
  x,
  z.threshold = 9,
  max.spike.width = 8,
  na.rm = FALSE,
  var.name = "counts",
  ...
)

## S3 method for class 'generic_mspct'
spikes(
  x,
  z.threshold = 9,
  max.spike.width = 8,
  na.rm = FALSE,
  ...,
  var.name = NULL,
  .parallel = FALSE,
  .paropts = NULL
)

## S3 method for class 'source_mspct'
spikes(
  x,
  z.threshold = 9,
  max.spike.width = 8,
  na.rm = FALSE,
  unit.out = getOption("photobiology.radiation.unit", default = "energy"),
  ...,
  .parallel = FALSE,
  .paropts = NULL
)

## S3 method for class 'response_mspct'
spikes(
  x,
  z.threshold = 9,
  max.spike.width = 8,
  na.rm = FALSE,
  unit.out = getOption("photobiology.radiation.unit", default = "energy"),
  ...,
  .parallel = FALSE,
  .paropts = NULL
)

## S3 method for class 'filter_mspct'
spikes(
  x,
  z.threshold = 9,
  max.spike.width = 8,
  na.rm = FALSE,
  filter.qty = getOption("photobiology.filter.qty", default = "transmittance"),
  ...,
  .parallel = FALSE,
  .paropts = NULL
)

## S3 method for class 'reflector_mspct'
spikes(
  x,
  z.threshold = 9,
  max.spike.width = 8,
  na.rm = FALSE,
  ...,
  .parallel = FALSE,
  .paropts = NULL
)

## S3 method for class 'solute_mspct'
spikes(
  x,
  z.threshold = 9,
  max.spike.width = 8,
  na.rm = FALSE,
  ...,
  .parallel = FALSE,
  .paropts = NULL
)

## S3 method for class 'cps_mspct'
spikes(
  x,
  z.threshold = 9,
  max.spike.width = 8,
  na.rm = FALSE,
  ...,
  var.name = "cps",
  .parallel = FALSE,
  .paropts = NULL
)

## S3 method for class 'raw_mspct'
spikes(
  x,
  z.threshold = 9,
  max.spike.width = 8,
  na.rm = FALSE,
  ...,
  var.name = "counts",
  .parallel = FALSE,
  .paropts = NULL
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>x</code></td>
<td>
<p>an R object</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>z.threshold</code></td>
<td>
<p>numeric Modified Z values larger than <code>z.threshold</code>
are considered to correspond to spikes.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>max.spike.width</code></td>
<td>
<p>integer Wider regions with high Z values are not
detected as spikes.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>na.rm</code></td>
<td>
<p>logical indicating whether <code>NA</code> values should be stripped
before searching for spikes.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>...</code></td>
<td>
<p>ignored</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>var.name, y.var.name</code></td>
<td>
<p>character Name of column where to look
for spikes.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>unit.out</code></td>
<td>
<p>character One of "energy" or "photon"</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>filter.qty</code></td>
<td>
<p>character One of "transmittance" or "absorbance"</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>.parallel</code></td>
<td>
<p>if TRUE, apply function in parallel, using parallel backend
provided by foreach</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>.paropts</code></td>
<td>
<p>a list of additional options passed into the foreach function
when parallel computation is enabled. This is important if (for example)
your code relies on external data or packages: use the .export and
.packages arguments to supply them so that all cluster nodes have the
correct environment set up for computing.</p>
</td>
</tr>
</table>
<h3>Details</h3>

<p>Spikes are detected based on a modified Z score calculated from the
differenced spectrum. The Z threshold used should be adjusted to the
characteristics of the input and desired sensitivity. The lower the
threshold the more stringent the test becomes, resulting in most cases in
more spikes being detected. A modified version of the algorithm is used if
a value different from <code>NULL</code> is passed as argument to
<code>max.spike.width</code>. In such a case, an additional step filters out
broader spikes (or falsely detected steep slopes) from the returned values.
</p>
<p>When the argument passed to <code>x</code> contains multiple spectra, the spikes
are searched for in each spectrum independently of other spectra.
</p>


<h3>Value</h3>

<p>A subset of the object passed as argument to <code>x</code> with rows
corresponding to spikes.
</p>


<h3>Methods (by class)</h3>


<ul>
<li> <p><code>spikes(default)</code>: Default returning always NA.
</p>
</li>
<li> <p><code>spikes(numeric)</code>: Default function usable on numeric vectors.
</p>
</li>
<li> <p><code>spikes(data.frame)</code>: Method for "data.frame" objects.
</p>
</li>
<li> <p><code>spikes(generic_spct)</code>: Method for "generic_spct" objects.
</p>
</li>
<li> <p><code>spikes(source_spct)</code>: Method for "source_spct" objects.
</p>
</li>
<li> <p><code>spikes(response_spct)</code>: Method for "response_spct" objects.
</p>
</li>
<li> <p><code>spikes(filter_spct)</code>: Method for "filter_spct" objects.
</p>
</li>
<li> <p><code>spikes(reflector_spct)</code>: Method for "reflector_spct" objects.
</p>
</li>
<li> <p><code>spikes(solute_spct)</code>: Method for "solute_spct" objects.
</p>
</li>
<li> <p><code>spikes(cps_spct)</code>: Method for "cps_spct" objects.
</p>
</li>
<li> <p><code>spikes(raw_spct)</code>: Method for "raw_spct" objects.
</p>
</li>
<li> <p><code>spikes(generic_mspct)</code>: Method for "generic_mspct" objects.
</p>
</li>
<li> <p><code>spikes(source_mspct)</code>: Method for "source_mspct" objects.
</p>
</li>
<li> <p><code>spikes(response_mspct)</code>: Method for "cps_mspct" objects.
</p>
</li>
<li> <p><code>spikes(filter_mspct)</code>: Method for "filter_mspct" objects.
</p>
</li>
<li> <p><code>spikes(reflector_mspct)</code>: Method for "reflector_mspct" objects.
</p>
</li>
<li> <p><code>spikes(solute_mspct)</code>: Method for "solute_mspct" objects.
</p>
</li>
<li> <p><code>spikes(cps_mspct)</code>: Method for "cps_mspct" objects.
</p>
</li>
<li> <p><code>spikes(raw_mspct)</code>: Method for "raw_mspct" objects.
</p>
</li>
</ul>
<h3>See Also</h3>

<p>See the documentation for <code>find_spikes</code> for details of
the algorithm and implementation.
</p>
<p>Other peaks and valleys functions: 
<code>find_peaks()</code>,
<code>find_spikes()</code>,
<code>get_peaks()</code>,
<code>peaks()</code>,
<code>replace_bad_pixs()</code>,
<code>valleys()</code>,
<code>wls_at_target()</code>
</p>


<h3>Examples</h3>

<pre><code class="language-R">spikes(sun.spct)

</code></pre>


</div>