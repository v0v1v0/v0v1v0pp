<div class="container">

<table style="width: 100%;"><tr>
<td>hasEdgeLength</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>edgeLength methods</h2>

<h3>Description</h3>

<p>These functions give information about and allow replacement of edge lengths.
</p>


<h3>Usage</h3>

<pre><code class="language-R">hasEdgeLength(x)

## S4 method for signature 'phylo4'
hasEdgeLength(x)

edgeLength(x, ...)

## S4 method for signature 'phylo4'
edgeLength(x, node)

edgeLength(x, use.names = TRUE, ...) &lt;- value

## S4 replacement method for signature 'phylo4'
edgeLength(x, use.names = TRUE, ...) &lt;- value

depthTips(x)

## S4 method for signature 'phylo4'
depthTips(x)

nodeDepth(x, node)

## S4 method for signature 'phylo4'
nodeDepth(x, node)

nodeHeight(x, node, from)

## S4 method for signature 'phylo4'
nodeHeight(x, node, from = c("root", "all_tip", "min_tip", "max_tip"))

sumEdgeLength(x, node)

## S4 method for signature 'phylo4'
sumEdgeLength(x, node)

isUltrametric(x, tol = .Machine$double.eps^0.5)

## S4 method for signature 'phylo4'
isUltrametric(x, tol = .Machine$double.eps^0.5)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>x</code></td>
<td>
<p>a <code>phylo4</code> or <code>phylo4d</code> object.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>...</code></td>
<td>
<p>optional arguments (none used at present).</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>node</code></td>
<td>
<p>optional numeric or character vector indicating the
nodes for which edge</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>use.names</code></td>
<td>
<p>should the the name attributes of <code>value</code> be
used to match the length to a given edge.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>value</code></td>
<td>
<p>a numeric vector indicating the new values for the edge lengths</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>from</code></td>
<td>
<p>The point of reference for calculating the height of
the node. <code>root</code> calculates the distance between the root of
the tree and the node. <code>all_tip</code> return the distance between
the node and all the tips descending from it. <code>min_tip</code> the
distance between the node and its closest tip. <code>max_tip</code> the
distance between the node and its farther tip. <code>min_tip</code> and
<code>max_tip</code> will be identical if the tree is ultrametric. If
more than one tip is equidistant from the node, the tip with the
lowest node id will be returned.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>tol</code></td>
<td>
<p>the tolerance to decide whether all the tips have the
same depth to test if the tree is ultrametric. Default is
<code>.Machine$double.eps^0.5</code>.</p>
</td>
</tr>
</table>
<h3>Details</h3>

<p>The <code>edgeLength</code> function returns the edge length in the same
order as the edges in the matrix.
</p>


<h3>Value</h3>


<dl>
<dt>hasEdgeLength</dt>
<dd>
<p>whether or not the object has edge lengths
(logical)</p>
</dd>
<dt>edgeLength</dt>
<dd>
<p>a named vector of the edge length for the
object</p>
</dd>
<dt>isUltrametric</dt>
<dd>
<p>whether or not the tree is ultrametric (all
the tips are have the same depth (distance from the root) (logical)</p>
</dd>
<dt>sumEdgeLength</dt>
<dd>
<p>the sum of the edge lengths for a set of
nodes (intended to be used with <code>ancestors</code> or <code>descendants</code>)</p>
</dd>
<dt>nodeHeight</dt>
<dd>
<p>the distance between a node and the root or the
tips. The format of the result will depend on the options and the
number of nodes provided, either a vector or a list.</p>
</dd>
<dt>nodeDepth</dt>
<dd>
<p>Deprecated, now replaced by <code>nodeHeight</code>. A
named vector indicating the “depth” (the distance between
the root and a given node).</p>
</dd>
<dt>depthTip</dt>
<dd>
<p>Deprecated, now  replaced by <code>nodeHeight</code>.</p>
</dd>
</dl>
<h3>See Also</h3>

<p><code>ancestors</code>, <code>descendants</code>, <code>.Machine</code> for
more information about tolerance.
</p>


<h3>Examples</h3>

<pre><code class="language-R">  data(geospiza)
  hasEdgeLength(geospiza) # TRUE
  topoGeo &lt;- geospiza
  edgeLength(topoGeo) &lt;- NULL
  hasEdgeLength(topoGeo)  # FALSE

  edgeLength(geospiza)[2]       # use the position in vector
  edgeLength(geospiza)["16-17"] # or the name of the edge
  edgeLength(geospiza, 17)      # or the descendant node of the edge

  ## The same methods can be used to update an edge length
  edgeLength(geospiza)[2] &lt;- 0.33
  edgeLength(geospiza)["16-17"] &lt;- 0.34
  edgeLength(geospiza, 17) &lt;- 0.35

  ## Test if tree is ultrametric
  isUltrametric(geospiza)   # TRUE
  ## indeed all tips are at the same distance from the root
  nodeHeight(geospiza, nodeId(geospiza, "tip"), from="root")
  ## compare distances from tips of two MRCA
  nodeHeight(geospiza, MRCA(geospiza, c("pallida", "psittacula")), from="min_tip")
  nodeHeight(geospiza, MRCA(geospiza, c("fortis", "difficilis")), from="min_tip")
  ## or the same but from the root
  nodeHeight(geospiza, MRCA(geospiza, c("pallida", "psittacula")), from="root")
  nodeHeight(geospiza, MRCA(geospiza, c("fortis", "difficilis")), from="root")
</code></pre>


</div>