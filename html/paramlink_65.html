<div class="container">

<table style="width: 100%;"><tr>
<td>markers</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>Marker functions</h2>

<h3>Description</h3>

<p>Functions for setting and manipulating marker genotypes for 'linkdat'
objects.
</p>


<h3>Usage</h3>

<pre><code class="language-R">marker(
  x,
  ...,
  allelematrix,
  alleles = NULL,
  afreq = NULL,
  missing = 0,
  chrom = NA,
  pos = NA,
  name = NA,
  mutmat = NULL
)

addMarker(x, m, ...)

setMarkers(x, m, annotations = NULL, missing = 0)

modifyMarker(x, marker, ids, genotype, alleles, afreq, chrom, name, pos)

getMarkers(x, markernames = NULL, chroms = NULL, fromPos = NULL, toPos = NULL)

removeMarkers(
  x,
  markers = NULL,
  markernames = NULL,
  chroms = NULL,
  fromPos = NULL,
  toPos = NULL
)

swapGenotypes(x, ids)

modifyMarkerMatrix(x, ids, new.alleles)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>x</code></td>
<td>
<p>a <code>linkdat</code> object</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>...</code></td>
<td>
<p>an even number of vectors, indicating individuals and their
genotypes. See examples.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>allelematrix</code></td>
<td>
<p>a matrix with one row per pedigree member and two columns
per marker, containing the alleles for a single marker.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>alleles</code></td>
<td>
<p>a numeric or character vector containing allele names.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>afreq</code></td>
<td>
<p>a numerical vector with allele frequencies. An error is given if
they don't sum to 1 (rounded to 3 decimals).</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>missing</code></td>
<td>
<p>a numeric - or character - of length 1, indicating the code
for missing alleles.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>chrom</code></td>
<td>
<p>NA or an integer (the chromosome number of the marker).</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>pos</code></td>
<td>
<p>NA or a non-negative real number indicating the genetic position
(in cM) of the marker.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>name</code></td>
<td>
<p>NA or a character (the name of the marker).</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>mutmat</code></td>
<td>
<p>a mutation matrix, or a list of two such matrices named
'female' and 'male'. The matrix/matrices must be square, with the allele
labels as dimnames, and each row must sum to 1 (after rounding to 3
decimals).</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>m</code></td>
<td>
<p>a <code>marker</code> object or a matrix with alleles. (In
<code>setMarkers</code> this matrix can contain data of several markers.)</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>annotations</code></td>
<td>
<p>a list of marker annotations.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>marker, markers</code></td>
<td>
<p>a numeric indicating which marker(s) to use/modify.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>ids</code></td>
<td>
<p>a numeric indicating individual(s) to be modified. In
<code>swapGenotypes</code> this must have length 2.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>genotype</code></td>
<td>
<p>a vector of length 1 or 2, containing the genotype to be
given the <code>ids</code> individuals. See examples.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>markernames</code></td>
<td>
<p>NULL or a character vector.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>chroms</code></td>
<td>
<p>NULL or a numeric vector of chromosome numbers.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>fromPos, toPos</code></td>
<td>
<p>NULL or a single numeric.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>new.alleles</code></td>
<td>
<p>a numerical matrix of dimensions <code>length(ids),
2*x$nMark</code>. Entries refer to the internal allele numbering.</p>
</td>
</tr>
</table>
<h3>Value</h3>

<p>The <code>marker</code> function returns an object of class <code>marker</code>:
This is a numerical 2-column matrix with one row per individual, and
attributes 'alleles' (a character vector with allele names), 'nalleles'
(the number of alleles) and 'missing' (the input symbol for missing marker
alleles), 'chrom' (chromosome number), 'name' (marker identifier), 'pos'
(chromosome position in cM).
</p>
<p>For <code>addMarker</code>, <code>setMarkers</code>, <code>removeMarkers</code>,
<code>modifyMarker</code>, <code>modifyMarkerMatrix</code> and <code>swapGenotypes</code>, a
<code>linkdat</code> object is returned, whose <code>markerdata</code> element has been
set/modified.
</p>
<p>For <code>getMarkers</code> a numeric vector containing marker numbers (i.e.
their indices in <code>x$markerdata</code>) for the markers whose 'name'
attribute is contained in <code>markernames</code>, 'chrom' attribute is
contained in <code>chroms</code>, and 'pos' attribute is between <code>from</code> and
<code>to</code>. NULL arguments are skipped, so <code>getMarkers(x)</code> will return
<code>seq_len(x$nMark)</code> (i.e. all markers).
</p>


<h3>See Also</h3>

<p><code>linkdat</code>
</p>


<h3>Examples</h3>

<pre><code class="language-R">
x = linkdat(toyped)
x = removeMarkers(x, 1) # removing the only marker.
x

# Creating and adding a SNP marker with alleles 'a' and 'b', for which
# individual 1 is heterozygous, individuals 2 and 4 are homozygous for the
# 'b' allele, and individual 3 has a missing genotype.
m1 = marker(x, 1, c('a','b'), c(2,4), c('b','b'))
x = addMarker(x, m1)

# A rare SNP for which both children are heterozygous.
# The 'alleles' argument can be skipped, but is recommended to ensure
# correct order of the frequencies.
m2 = marker(x, 3:4, 1:2, alleles=1:2, afreq=c(0.99, 0.01))
x = addMarker(x, m2)

# Modifying the second marker:
# Making it triallelic, and adding a genotype to the father.
x = modifyMarker(x, marker=2, alleles=1:3, ids=1, genotype=2:3)

# Adding an empty SNP (all genotypes are missing):
x = addMarker(x, 0, alleles=c('A', 'B'))

# Similar shortcut for creating a marker for which all
# pedigree members are homozygous for an allele (say 'b'):
x = addMarker(x, 'b')
# Alternative: m = marker(x, 'b'); addMarker(x, m)


</code></pre>


</div>