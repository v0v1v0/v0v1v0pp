<div class="container">

<table style="width: 100%;"><tr>
<td>prec_lr</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>Sample size or precision for likelihood ratios</h2>

<h3>Description</h3>

<p>These functions calculate the precision or sample size for likelihood ratios (LRs).
<code>prec_lr</code> is a generalized method for that can be used for positive and
negative LRs as well as conditional LRs.
</p>
<p><code>prec_pos_lr</code> is a wrapper to <code>prec_lr</code> to ease
calculations for positive likelihood ratios by allowing sensitivity and
specificity to be given explicitly.
</p>
<p><code>prec_neg_lr</code> is a wrapper to <code>prec_lr</code> to ease
calculations for negative likelihood ratios by allowing sensitivity and
specificity to be given explicitly.
</p>


<h3>Usage</h3>

<pre><code class="language-R">prec_lr(prev, p1, p2, n = NULL, conf.width = NULL, conf.level = 0.95, ...)

prec_pos_lr(
  prev,
  sens,
  spec,
  n = NULL,
  conf.width = NULL,
  conf.level = 0.95,
  ...
)

prec_neg_lr(
  prev,
  sens,
  spec,
  n = NULL,
  conf.width = NULL,
  conf.level = 0.95,
  ...
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>prev</code></td>
<td>
<p>disease/case prevalence in the study group.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>p1</code></td>
<td>
<p>proportion of positives in group 1 (e.g. sensitivity).</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>p2</code></td>
<td>
<p>proportion of positives in group 2 (e.g. 1 - specificity).</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>n</code></td>
<td>
<p>total group size.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>conf.width</code></td>
<td>
<p>precision (the full width of the confidence interval).</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>conf.level</code></td>
<td>
<p>confidence level (defaults to 0.95).</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>...</code></td>
<td>
<p>other arguments to uniroot (e.g. <code>tol</code>).</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>sens</code></td>
<td>
<p>sensitivity.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>spec</code></td>
<td>
<p>specificity.</p>
</td>
</tr>
</table>
<h3>Details</h3>

<p>These functions implement formula 10 from Simel et al 1991.
<code>prec_lr</code> is a generalized function allowing for many scenarios, while
<code>prec_pos_lr</code> and <code>prec_neg_lr</code> are specific to positive and
negative likelihood ratios in the 2*2 setting (e.g. disease status and test
positive/negative).
</p>
<p>For the positive likelihood ratio (LR+), in a 2x2 style experiment, <code>p1</code>
should be sensitivity, <code>p2</code> should be 1-specificity. Alternatively, use
<code>prec_pos_lr</code>.
</p>
<p>For the negative likelihood ratio (LR-), in a 2x2 style experiment, <code>p1</code>
should be 1-sensitivity, <code>p2</code> should be specificity. Alternatively, use
<code>prec_neg_lr</code>.
</p>
<p>For conditional likelihood ratios with 3x2 tables, such as positive or
negative tests against inconclusive ones (yields), <code>p1</code> would be the
proportion of positive or negative tests in the diseased group and <code>p2</code>
would be the proportion of positive or negative tests in the non-diseased group.
</p>


<h3>Value</h3>

<p>Object of class "presize", a list of arguments (including the
computed one) augmented with method and note elements.
</p>


<h3>Functions</h3>


<ul>
<li> <p><code>prec_pos_lr()</code>: "Positive likelihood ratio"
</p>
</li>
<li> <p><code>prec_neg_lr()</code>: "Negative likelihood ratio"
</p>
</li>
</ul>
<h3>References</h3>

<p>Simel, DL, Samsa, GP and Matchar, DB (1991) <em>Likelihood ratios with confidence: Sample size estimation for diagnostic test studies.</em> J Clin Epidemiol 44(8), 763-770
</p>


<h3>Examples</h3>

<pre><code class="language-R"># equal numbers of diseased/non-diseased, 80% sens, 73% spec, 74 participants total
prec_lr(.5, .8, .27, 74)

# Simel et al 1991, problem 1 - LR+ CI width from N
# Sensitivity of a new test is at least 80%, specificity is 73% and the LR+
# is 2.96 (= 0.8/(1-0.73)). We have as many diseased as not diseased
# (n1 = n2, n = 2*n1 = 146.8, prevalence = .5)
prec_lr(prev = .5, p1 = .8, p2 = 1-.73, n = 146.8)
prec_pos_lr(prev = .5, sens = .8, spec = .73, n = 146.8)

# problem 1 of Simel et al actually derives n1 rather than the width of the
# confidence interval (ie N from CI width). If we know that the lower limit
# of the CI should be 2.0, the confidence interval width is approximately
# exp(2*(log(2.96) - log(2))) = 2.19 (approximate because the CI Of the LR
# is only symetrical on the log(LR) scale), which we can put in conf.width
prec_lr(prev = .5, p1 = .8, p2 = 1-.73, conf.width = 2.2)
# same, but using the wrapper to specify sens and spec
prec_pos_lr(prev = .5, sens = .8, spec = .73, conf.width = 2.2)

# Simel et al 1991, problem 2 - LR- CI width from N
# p1 = 1 - sens = .1, p2 = spec = .5
# n1 = n2, n = 160, prev = .5
prec_lr(prev = .5, p1 = .1, p2 = .5, n = 160)
# same, but using the wrapper to specify sens and spec
prec_neg_lr(prev = .5, sens = .9, spec = .5, n = 160)

</code></pre>


</div>