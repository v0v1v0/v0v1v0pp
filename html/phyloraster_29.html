<div class="container">

<table style="width: 100%;"><tr>
<td>tip.root.path</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>Compute tree edge lengths and node paths from root to each tip</h2>

<h3>Description</h3>

<p>Computation of tree edge lengths and node paths from root to each tip to
calculate PD for a entire phylogeny (= sum of all edge or branch lengths)
</p>


<h3>Usage</h3>

<pre><code class="language-R">tip.root.path(tree)
</code></pre>


<h3>Arguments</h3>

<table><tr style="vertical-align: top;">
<td><code>tree</code></td>
<td>
<p>phylo. A dated tree.</p>
</td>
</tr></table>
<h3>Details</h3>

<p>Based on the algorithm FastXtreePhylo of Peter D. Wilson
</p>


<h3>Value</h3>

<p>returns a list with two components: matrix H1
representing the paths through the tree from root to each tip,
and edge.length a
numeric vector giving the length of each branch in the tree. Some matrix
algebra and a summation of the resulting vector gives the whole-tree
PD value.
</p>


<h3>Author(s)</h3>

<p>Peter Wilson
</p>


<h3>Examples</h3>

<pre><code class="language-R">library(phyloraster)
tree &lt;- ape::read.tree(system.file("extdata", "tree.nex",
package="phyloraster"))

fxtp &lt;- tip.root.path(tree)
H1 &lt;- fxtp$H1
edge.length &lt;- fxtp$edge.length
# PD for the whole community
pres &lt;- rep(1, nrow(H1))
sum((crossprod(H1, pres)&gt;0) * edge.length)

# PD for a random subset of the community
pres &lt;- sample(c(1, 0), nrow(H1), TRUE)
sum((crossprod(H1, pres)&gt;0) * edge.length)

</code></pre>


</div>