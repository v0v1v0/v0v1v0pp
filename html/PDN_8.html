<div class="container">

<table style="width: 100%;"><tr>
<td>draw.PDN.cluster</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>Draw Personalized Disease Network for cluster of patients</h2>

<h3>Description</h3>

<p>Draw Personalized Disease Network based on cluster information
</p>


<h3>Usage</h3>

<pre><code class="language-R">draw.PDN.cluster(a0, dak)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>a0</code></td>
<td>
<p>network matrix get from buildnetworks</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>dak</code></td>
<td>
<p>ranks data for comorbidity data matrix</p>
</td>
</tr>
</table>
<h3>Examples</h3>

<pre><code class="language-R">#Select a subset of data for toy example
comorbidity_data = comorbidity_data[c(1:10),]
survival_data = survival_data[c(1:10),]
##Clustering Example
k1 = datecut(comorbidity_data,survival_data[,1],survival_data[,2])
a = buildnetworks(comorbidity_data,k1)
datark = t(apply(comorbidity_data,1,rank))
require(survival)
zsq = NULL
for(i in 1:ncol(a)){
  a1 = (summary(coxph(Surv(as.numeric(survival_data[,1]),survival_data[,2]) ~ a[,i],
  data=as.data.frame(a)))$coefficient[,4])^2
  zsq = cbind(zsq,a1)
}
zsq = as.numeric(zsq)
wi=zsq/sum(zsq,na.rm=TRUE)
wi[wi&lt;10^ -3]=10^ -3
wi[is.na(wi)]=10^ -3
#weighted matrix
wa = NULL
for(i in 1:ncol(a)){
 wa = cbind(wa,a[,i]*wi[i])
}
#PCA
pr.out=prcomp(wa)
x.svd=svd(wa)
x.score1 &lt;- wa %*% x.svd$v
x.score2 &lt;- x.svd$u %*% diag(x.svd$d)
##HC cluster using the first 8 PCA scores
dp&lt;-dist(x.score2[,1:8])
hcp&lt;-hclust(dp, method="ward.D")
##Plot Network
s1=rev(sort(apply(a[cutree(hcp,3)==2,],2,mean)))[1:50]
dak = sort(apply(datark[cutree(hcp,3)==2,],2,mean,na.rm=TRUE))
names(dak) = unlist(strsplit(names(dak),"DAT"))
draw.PDN.cluster(s1,dak)
</code></pre>


</div>