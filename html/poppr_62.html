<div class="container">

<table style="width: 100%;"><tr>
<td>genotype_curve</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>Produce a genotype accumulation curve</h2>

<h3>Description</h3>

<p>Genotype accumulation curves are useful for determining the minimum number of
loci necessary to discriminate between individuals in a population. This 
function will randomly sample loci without replacement and count the number 
of multilocus genotypes observed.
</p>


<h3>Usage</h3>

<pre><code class="language-R">genotype_curve(
  gen,
  sample = 100,
  maxloci = 0L,
  quiet = FALSE,
  thresh = 1,
  plot = TRUE,
  drop = TRUE,
  dropna = TRUE
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>gen</code></td>
<td>
<p>a <code>genclone</code>, <code>genind</code>, or
<code>loci</code> object.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>sample</code></td>
<td>
<p>an <code>integer</code> defining the number of times loci will be 
resampled without replacement.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>maxloci</code></td>
<td>
<p>the maximum number of loci to sample. By default, 
<code>maxloci = 0</code>, which indicates that n - 1 loci are to be used. Note 
that this will always take min(n - 1, maxloci)</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>quiet</code></td>
<td>
<p>if <code>FALSE</code> (default), Progress of the iterations will be 
displayed. If <code>TRUE</code>, nothing is printed to screen as the function 
runs.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>thresh</code></td>
<td>
<p>a number from 0 to 1. This will draw a line at that fraction of
multilocus genotypes, rounded. Defaults to 1, which will draw a line at the
maximum number of observable genotypes.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>plot</code></td>
<td>
<p>if <code>TRUE</code> (default), the genotype curve will be plotted via 
ggplot2. If <code>FALSE</code>, the resulting matrix will be visibly returned.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>drop</code></td>
<td>
<p>if <code>TRUE</code> (default), monomorphic loci will be removed before
analysis as these loci affect the shape of the curve.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>dropna</code></td>
<td>
<p>if <code>TRUE</code> (default) and <code>drop = TRUE</code>, NAs will be
ignored when determining if a locus is monomorphic. When <code>FALSE</code>,
presence of NAs will result in the locus being retained. This argument has
no effect when <code>drop = FALSE</code></p>
</td>
</tr>
</table>
<h3>Details</h3>

<p>Internally, this function works by converting the data into a 
<code>loci</code> object, which represents genotypes as a data 
frame of factors. Random samples are taken of 1 to n-1 columns of the 
matrix and the number of unique rows are counted to determine the number of
multilocus genotypes in that random sample. This function does not take 
into account any definitions of MLGs via <code>mlg.filter</code> or 
<code>mll.custom</code>.
</p>


<h3>Value</h3>

<p>(invisibly by deafuls) a matrix of integers showing the results of
each randomization. Columns represent the number of loci sampled and rows 
represent an independent sample.
</p>


<h3>Author(s)</h3>

<p>Zhian N. Kamvar
</p>


<h3>Examples</h3>

<pre><code class="language-R">data(nancycats)
nan_geno &lt;- genotype_curve(nancycats)
## Not run: 

# Marker Type Comparison --------------------------------------------------
# With AFLP data, it is often necessary to include more markers for resolution
data(Aeut)
Ageno &lt;- genotype_curve(Aeut)

# Many microsatellite data sets have hypervariable markers
data(microbov)
mgeno &lt;- geotype_curve(microbov)

# Adding a trendline ------------------------------------------------------

# Trendlines: you can add a smoothed trendline with geom_smooth()
library("ggplot2")
p &lt;- last_plot()
p + geom_smooth()

# Producing Figures for Publication ---------------------------------------

# This data set has been pre filtered
data(monpop)
mongeno &lt;- genotype_curve(monpop)

# Here, we add a curve and a title for publication
p &lt;- last_plot()
mytitle &lt;- expression(paste("Genotype Accumulation Curve for ", 
                            italic("M. fructicola")))
p + geom_smooth() + 
  theme_bw() + 
  theme(text = element_text(size = 12, family = "serif")) +
  theme(title = element_text(size = 14)) +
  ggtitle(mytitle)

## End(Not run)

</code></pre>


</div>