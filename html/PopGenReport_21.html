<div class="container">

<table style="width: 100%;"><tr>
<td>popgenreport</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>This is the main function of the package. It analyses an object of class
<code>genind</code> and then creates a report containing the results of the
analysis. There are several routines that can be optionally included in the
analysis and there are multiple output options including a PDF with the
report, R-code and an object (<code>fname.results</code>) containing all of the
results, which can be used for further analyses.</h2>

<h3>Description</h3>

<p>This function is used to analyse population genetic data. The main idea is
to provide a framework for analysing microsatellite and also SNP genetic
data (if not too many loci, say below 1000) using a mix of existing and new
functions. The function works on an object of class <code>genind</code>. There are
several ways to convert data into a <code>genind</code> object using
existing functions provided by the <code>adegenet</code> package (
<code>import2genind</code>,
<code>df2genind</code>,<code>read.fstat</code>,
<code>read.structure</code>, <code>read.genetix</code>
,<code>read.genepop</code>) or refer to <code>read.genetable</code> how to import
data from an EXCEL (csv) document. The function performs a number of
different genetic analyses (e.g. counts of indivuals and alleles across
sub-populations, tests for heterozygosity and Hardy-Weinberg Equilibrium,
differentiation statistics Fst, G'st, Jost's D, and genetic distance between
individuals and populations), with users having the option to select which
analysis routines are included in the report. To select a routine, the user
simply turns on a switch e.g. mk.map=TRUE returns a map with the sampling
location for each individual (if coordinates are provided). <br> Coordinates
need to specified within the genind object. As a standard genind object does
not require spatial coordinates, we extended it by using the <code>other</code>
slot in the genind object. The easiest way to provide spatial coordinates is
to use the read.genetable function and use the <code>lat</code>, <code>long</code> or
<code>x</code>, <code>y</code> arguments for WGS1984 projected data or mercator
projected data respectively. To calculate distances the data are internally
reprojected using the <code>Mercator</code> function in package
<code>dismo</code>), which is the projection used by google maps. Or you
can add data manually to your <code>genind</code> object using the mentioned (e.g.
<code>genindobject@other$latlong &lt;- yourlatlong data</code> or
<code>genindobject@other$xy &lt;- your_xy_data</code>). If you have your data in a
different projection you need to reproject them into either WGS1984 or the
google maps Mercator projection. If you use a different projection distance
calculation may be wrong and probably the map will not be correct. See the
manual for an example how to project and add spatial coordinates to your
genetic data.<br> Names for alleles (<code>genindobject@loc.names</code>) are
truncated if longer than six characters. If truncated Captial letters linked
by a hyphen are added to guarentee they are unique. You can rename them by
providing new names by accessing the <code>genind@loc.names</code> slot prior to
running <code>popgenreport</code>.<br> Note that the popgenreport function can take
a long time to run if the options mk.complete, mk.gd.kosman, or mk.gd.smouse
are set to <code>TRUE</code>. For example, running popgenreport with
<code>mk.complete=TRUE</code> on a dataset with 500 individuals with 36 loci will
take 14 to 15 minutes on a PC with a 3.5 Ghz processor and nearly 3 hours
for a dataset with ~3200 individuals.
</p>


<h3>Usage</h3>

<pre><code class="language-R">popgenreport(
  cats = NULL,
  mk.counts = TRUE,
  mk.map = FALSE,
  maptype = "satellite",
  mapdotcolor = "blue",
  mapdotsize = 1,
  mapdotalpha = 0.4,
  mapdottype = 19,
  mapzoom = NULL,
  mk.locihz = FALSE,
  mk.hwe = FALSE,
  mk.fst = FALSE,
  mk.gd.smouse = FALSE,
  mk.gd.kosman = FALSE,
  mk.pcoa = FALSE,
  mk.spautocor = FALSE,
  mk.allele.dist = FALSE,
  mk.null.all = FALSE,
  mk.allel.rich = FALSE,
  mk.differ.stats = FALSE,
  mk.custom = FALSE,
  fname = "PopGenReport",
  foldername = "results",
  path.pgr = NULL,
  mk.Rcode = FALSE,
  mk.complete = FALSE,
  mk.pdf = TRUE
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>cats</code></td>
<td>
<p>this is the <code>genind</code> object the analysis will be
based on.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>mk.counts</code></td>
<td>
<p>switch is to provide overview counts of the number of
individuals sampled, numbers of individuals and alleles sampled per
sub-population, number of alleles per locus, mean number of alleles per
locus and the percentatge of missing data.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>mk.map</code></td>
<td>
<p>switch to produce a map with the sampling location of each
individual marked. This switch requires individual coordinates (latitudes
and longitudes in WGS1984) be provided (under cats@other$latlong or see
<code>read.genetable</code> on how to import them from a table of genetic data).
An error message will be generated if you turn this routine on, but do not
provide the coordinates in the right format. If the coordinates are provided
in a seperate file, they must be attached to the genind object in the slot
<br><code>yourgenindobject@other$latlong &lt;- yourlatlongdata</code>.<br><code>yourlatlongdata</code> needs to be a data frame that has the same number and
order of individuals per row as the population genetic data. Note that an
internet connection is required to connect to the Google Maps server which
provides the basemap for this routine.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>maptype</code></td>
<td>
<p>Defines the type of map. Default is 'satellite'. Other
options are: 'roadmap', 'mobile', 'terrain', 'hybrid'.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>mapdotcolor</code></td>
<td>
<p>Color of dots for each individual on the map. Default is
'blue'.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>mapdotsize</code></td>
<td>
<p>Size of dots for each individual. Default is 1.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>mapdotalpha</code></td>
<td>
<p>Transparency of dots. 1 is invisible, 0 is no
transparency. Default is 0.4.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>mapdottype</code></td>
<td>
<p>Defines the type of the symbol. For explanation see pch
under <code>par</code>. Default is 19 - a filled circle.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>mapzoom</code></td>
<td>
<p>Zoom level of the map. If not specified the default zoom of
Google maps are used. Please be aware if you set the zoom level to high, the
map may not show all sample locations.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>mk.locihz</code></td>
<td>
<p>switch to test for population heterozygosity</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>mk.hwe</code></td>
<td>
<p>switch to test for Hardy-Weinberg equilibrium for each loci
and population</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>mk.fst</code></td>
<td>
<p>switch to calculate Fst values for each loci and pairwise Fst
(Nei's 1973) over subpopulations</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>mk.gd.smouse</code></td>
<td>
<p>Individual pairwise genetic distances based on Smouse
and Peakall (1999). Refer to <code>gd_smouse</code>. Spatial coordinates need to
be provided to be able to run this analysis.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>mk.gd.kosman</code></td>
<td>
<p>Individual pairwise genetic distances based on Kosman &amp;
Leonhard (2005). Refer to <code>gd_kosman</code>. Spatial coordinates need to be
provided to be able to run this analysis.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>mk.pcoa</code></td>
<td>
<p>Principal component analysis following Jombart et al. 2009.
Spatial coordinates need to be provided to be able to run this analysis.
Refer to vignettes within <code>adegenet</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>mk.spautocor</code></td>
<td>
<p>Spatial autocorrelation analysis following Smouse &amp;
Peakall 1999. Spatial coordinates need to be provided to be able to run this
analysis. Refer to <code>spautocor</code> for more information.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>mk.allele.dist</code></td>
<td>
<p>switch to look at allele distributions by loci and
subpopulation</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>mk.null.all</code></td>
<td>
<p>check for null alleles</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>mk.allel.rich</code></td>
<td>
<p>calculation of allelic richness</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>mk.differ.stats</code></td>
<td>
<p>switch to look at population differentiation
statistics (Nei's Gst, Hedrick's Gst, and Jost's D)</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>mk.custom</code></td>
<td>
<p>edit custom.snw to include your own function to a report.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>fname</code></td>
<td>
<p>filename for the output files. Defauts to PopGenReport. Note
that using a filename which includes a space in the name will result in the
filename for each figure being printed out in the PDF report for each
figure. Replacing the space with an underscore should prevent this from
happening.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>foldername</code></td>
<td>
<p>name of folder, where files are stored. Defaults to
'results'</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>path.pgr</code></td>
<td>
<p>Folder where the output files are stored. Defaults to the
temporary directory (<code>tempdir()</code>). If you want to store the output in
another directory, simply provide the path here. e.g.
<code>path.pgr=getwd()</code> saves it in your current working directory.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>mk.Rcode</code></td>
<td>
<p>switch to get the full R script that is used to generate the
report. A great way to get a very detailed insight on the kind of analysis
and also an easy way to generate a script which you can customize for your
analytical needs.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>mk.complete</code></td>
<td>
<p>switch to create a full report using all of the routines
(all switches are set to <code>TRUE</code>, except <code>mk.subgroups</code>).</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>mk.pdf</code></td>
<td>
<p>switch to create a shiny pdf output. You need a working
<b>latex</b> version running on your system (e.g. MikTex (Windows) or
Texmaker (Linux, MacOSX). For more information how to install latex on your
system refer to the <a href="http://www.popgenreport.org">http://www.popgenreport.org</a> and to the manuals of the
<code>knitr</code> package and its manuals.</p>
</td>
</tr>
</table>
<h3>Value</h3>

<p>The function returns an object (e.g. res) that has all of the
results produced by this function in it. The structure of the object can be
accessed via <code>str(res)</code>. The main slots in this object (if you ran a
full report) are:<br><code>dataoverview, PopHet, Alleledist, Fst,
HsHtdifferentiate, HWEresults,</code> <br><code>subgroups, GDKosman, GDSmouse</code>
</p>
<p>Additional ouput is provided in the form of a PDF (if mk.pdf=TRUE),which
will be saved to the specified subfolder (via foldername) in your current
working directory, and maps and figures which will be placed in this folder
as well. This folder will be generated automatically in your current working
directory. If you do not specify a working directory via <code>path.pgr</code>
then the temporary working directory of R will be used (<code>tempdir()</code>).
If <code>mk.Rcode=T</code> is set, an R file named fname.R will be saved to your
specified subfolder.
</p>


<h3>Author(s)</h3>

<p>Aaron Adamack &amp; Bernd Gruber, aaron.adamack@canberra.edu.au,
bernd.gruber@canberra.edu.au
</p>


<h3>References</h3>

<p>Kosman E., Leonard K.J. 2005. Similarity coefficients for
molecular markers in studies of genetic relationships between individuals
for haploid, diploid, and polyploidy species. Molecular Ecology 14:415-424
</p>
<p>Peakall R., Smouse P. 2012. GenAlEx 6.5: Genetic analysis in Excel.
Population genetic software for teaching and research - an update.
Bioinformatics 28:2537-2539
</p>



<h3>See Also</h3>

<p><code>adegenet</code>, <code>pegas</code>, <code>mmod</code>
</p>


<h3>Examples</h3>

<pre><code class="language-R">## Not run: 
data(bilby) # a generated data set
res &lt;- popgenreport(bilby, mk.counts=TRUE, mk.map=TRUE, mk.pdf=FALSE)
#check results via res or use created tables in the results folder.

### RUN ONLY with a working Latex version installed
res &lt;- popgenreport(bilby, mk.counts=TRUE, mk.map=TRUE, mk.pdf=TRUE, path.pgr="c:/temp")
#for a full report in a single pdf set mk.complete to TRUE

## End(Not run)
</code></pre>


</div>