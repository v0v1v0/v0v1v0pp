<div class="container">

<table style="width: 100%;"><tr>
<td>PLNmixturefamily</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>An R6 Class to represent a collection of PLNmixturefit</h2>

<h3>Description</h3>

<p>The function <code>PLNmixture()</code> produces an instance of this class.
</p>
<p>This class comes with a set of methods, some of them being useful for the user:
See the documentation for <code>getBestModel()</code>, <code>getModel()</code> and <code>plot()</code>.
</p>


<h3>Super class</h3>

<p><code>PLNmodels::PLNfamily</code> -&gt; <code>PLNmixturefamily</code>
</p>


<h3>Active bindings</h3>

<div class="r6-active-bindings">

<dl>
<dt><code>clusters</code></dt>
<dd>
<p>vector indicating the number of clusters considered is the successively fitted models</p>
</dd>
</dl>
</div>


<h3>Methods</h3>



<h4>Public methods</h4>


<ul>
<li> <p><a href="#method-PLNmixturefamily-new"><code>PLNmixturefamily$new()</code></a>
</p>
</li>
<li> <p><a href="#method-PLNmixturefamily-optimize"><code>PLNmixturefamily$optimize()</code></a>
</p>
</li>
<li> <p><a href="#method-PLNmixturefamily-smooth"><code>PLNmixturefamily$smooth()</code></a>
</p>
</li>
<li> <p><a href="#method-PLNmixturefamily-plot"><code>PLNmixturefamily$plot()</code></a>
</p>
</li>
<li> <p><a href="#method-PLNmixturefamily-plot_objective"><code>PLNmixturefamily$plot_objective()</code></a>
</p>
</li>
<li> <p><a href="#method-PLNmixturefamily-getBestModel"><code>PLNmixturefamily$getBestModel()</code></a>
</p>
</li>
<li> <p><a href="#method-PLNmixturefamily-show"><code>PLNmixturefamily$show()</code></a>
</p>
</li>
<li> <p><a href="#method-PLNmixturefamily-print"><code>PLNmixturefamily$print()</code></a>
</p>
</li>
<li> <p><a href="#method-PLNmixturefamily-clone"><code>PLNmixturefamily$clone()</code></a>
</p>
</li>
</ul>
<details open><summary>Inherited methods</summary><ul>
<li><span class="pkg-link" data-pkg="PLNmodels" data-topic="PLNfamily" data-id="getModel"><a href="../../PLNmodels/html/PLNfamily.html#method-PLNfamily-getModel"><code>PLNmodels::PLNfamily$getModel()</code></a></span></li>
<li><span class="pkg-link" data-pkg="PLNmodels" data-topic="PLNfamily" data-id="postTreatment"><a href="../../PLNmodels/html/PLNfamily.html#method-PLNfamily-postTreatment"><code>PLNmodels::PLNfamily$postTreatment()</code></a></span></li>
</ul></details><hr>
<a id="method-PLNmixturefamily-new"></a>



<h4>Method <code>new()</code>
</h4>

<p>helper function for forward smoothing: split a group
</p>
<p>Initialize all models in the collection.
</p>


<h5>Usage</h5>

<div class="r"><pre>PLNmixturefamily$new(
  clusters,
  responses,
  covariates,
  offsets,
  formula,
  control
)</pre></div>



<h5>Arguments</h5>

<div class="arguments">

<dl>
<dt><code>clusters</code></dt>
<dd>
<p>the dimensions of the successively fitted models</p>
</dd>
<dt><code>responses</code></dt>
<dd>
<p>the matrix of responses common to every models</p>
</dd>
<dt><code>covariates</code></dt>
<dd>
<p>the matrix of covariates common to every models</p>
</dd>
<dt><code>offsets</code></dt>
<dd>
<p>the matrix of offsets common to every models</p>
</dd>
<dt><code>formula</code></dt>
<dd>
<p>model formula used for fitting, extracted from the formula in the upper-level call</p>
</dd>
<dt><code>control</code></dt>
<dd>
<p>a list for controlling the optimization. See details.</p>
</dd>
<dt><code>control</code></dt>
<dd>
<p>a list for controlling the optimization. See details.</p>
</dd>
</dl>
</div>


<hr>
<a id="method-PLNmixturefamily-optimize"></a>



<h4>Method <code>optimize()</code>
</h4>

<p>Call to the optimizer on all models of the collection
</p>


<h5>Usage</h5>

<div class="r"><pre>PLNmixturefamily$optimize(config)</pre></div>



<h5>Arguments</h5>

<div class="arguments">

<dl>
<dt><code>config</code></dt>
<dd>
<p>a list for controlling the optimization</p>
</dd>
</dl>
</div>


<hr>
<a id="method-PLNmixturefamily-smooth"></a>



<h4>Method <code>smooth()</code>
</h4>

<p>function to restart clustering to avoid local minima by smoothing the loglikelihood values as a function of the number of clusters
</p>


<h5>Usage</h5>

<div class="r"><pre>PLNmixturefamily$smooth(control)</pre></div>



<h5>Arguments</h5>

<div class="arguments">

<dl>
<dt><code>control</code></dt>
<dd>
<p>a list to control the smoothing process</p>
</dd>
</dl>
</div>


<hr>
<a id="method-PLNmixturefamily-plot"></a>



<h4>Method <code>plot()</code>
</h4>

<p>Lineplot of selected criteria for all models in the collection
</p>


<h5>Usage</h5>

<div class="r"><pre>PLNmixturefamily$plot(criteria = c("loglik", "BIC", "ICL"), reverse = FALSE)</pre></div>



<h5>Arguments</h5>

<div class="arguments">

<dl>
<dt><code>criteria</code></dt>
<dd>
<p>A valid model selection criteria for the collection of models. Any of "loglik", "BIC" or "ICL" (all).</p>
</dd>
<dt><code>reverse</code></dt>
<dd>
<p>A logical indicating whether to plot the value of the criteria in the "natural" direction
(loglik - 0.5 penalty) or in the "reverse" direction (-2 loglik + penalty). Default to FALSE, i.e use the
natural direction, on the same scale as the log-likelihood..</p>
</dd>
</dl>
</div>



<h5>Returns</h5>

<p>A <code>ggplot2</code> object
</p>


<hr>
<a id="method-PLNmixturefamily-plot_objective"></a>



<h4>Method <code>plot_objective()</code>
</h4>

<p>Plot objective value of the optimization problem along the penalty path
</p>


<h5>Usage</h5>

<div class="r"><pre>PLNmixturefamily$plot_objective()</pre></div>



<h5>Returns</h5>

<p>a <code>ggplot</code> graph
</p>


<hr>
<a id="method-PLNmixturefamily-getBestModel"></a>



<h4>Method <code>getBestModel()</code>
</h4>

<p>Extract best model in the collection
</p>


<h5>Usage</h5>

<div class="r"><pre>PLNmixturefamily$getBestModel(crit = c("BIC", "ICL", "loglik"))</pre></div>



<h5>Arguments</h5>

<div class="arguments">

<dl>
<dt><code>crit</code></dt>
<dd>
<p>a character for the criterion used to performed the selection. Either
"BIC", "ICL" or "loglik". Default is <code>ICL</code></p>
</dd>
</dl>
</div>



<h5>Returns</h5>

<p>a <code>PLNmixturefit</code> object
</p>


<hr>
<a id="method-PLNmixturefamily-show"></a>



<h4>Method <code>show()</code>
</h4>

<p>User friendly print method
</p>


<h5>Usage</h5>

<div class="r"><pre>PLNmixturefamily$show()</pre></div>


<hr>
<a id="method-PLNmixturefamily-print"></a>



<h4>Method <code>print()</code>
</h4>

<p>User friendly print method
</p>


<h5>Usage</h5>

<div class="r"><pre>PLNmixturefamily$print()</pre></div>


<hr>
<a id="method-PLNmixturefamily-clone"></a>



<h4>Method <code>clone()</code>
</h4>

<p>The objects of this class are cloneable with this method.
</p>


<h5>Usage</h5>

<div class="r"><pre>PLNmixturefamily$clone(deep = FALSE)</pre></div>



<h5>Arguments</h5>

<div class="arguments">

<dl>
<dt><code>deep</code></dt>
<dd>
<p>Whether to make a deep clone.</p>
</dd>
</dl>
</div>




<h3>See Also</h3>

<p>The function <code>PLNmixture</code>, the class <code>PLNmixturefit</code>
</p>


</div>