<div class="container">

<table style="width: 100%;"><tr>
<td>depurate</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>Remove errors from spatial data</h2>

<h3>Description</h3>

<p>Data can be filtered by null, edge values, global
outliers and spatial outliers or local defective observations. Default
values are optimized for precision agricultural data.
</p>


<h3>Usage</h3>

<pre><code class="language-R">depurate(
  x,
  y,
  toremove = c("edges", "outlier", "inlier"),
  crs = NULL,
  buffer = -10,
  ylimitmax = NA,
  ylimitmin = 0,
  sdout = 3,
  ldist = 0,
  udist = 40,
  criteria = c("LM", "MP"),
  zero.policy = NULL,
  poly_border = NULL
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>x</code></td>
<td>
<p>an <code>sf</code> points object</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>y</code></td>
<td>
<p><code>character</code> with the name of the variable to use for
depuration/filtering process</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>toremove</code></td>
<td>
<p><code>character</code> vector specifying the procedure to
implement for errors removal. Default 'edges', 'outlier', 'inlier'.
See Details.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>crs</code></td>
<td>
<p>coordinate reference system: integer with the EPSG code,
or character with proj4string to convert coordinates if <code>x</code> has
longitude/latitude data</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>buffer</code></td>
<td>
<p><code>numeric</code> distance in meters to be removed. Negative
values are recommended</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>ylimitmax</code></td>
<td>
<p><code>numeric</code> of length 1 indicating the maximum limit
for the <code>y</code> variable. If <code>NA</code> <code>Inf</code> is assumed</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>ylimitmin</code></td>
<td>
<p><code>numeric</code> of length 1 indicating the minimum limit
for the <code>y</code> variable. If <code>NA</code> <code>-Inf</code> is assumed</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>sdout</code></td>
<td>
<p><code>numeric</code> values outside the interval
<code class="reqn">mean ± sdout × sdout</code> values will be removed</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>ldist</code></td>
<td>
<p><code>numeric</code> lower distance bound to identify neighbors</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>udist</code></td>
<td>
<p><code>numeric</code> upper distance bound to identify neighbors</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>criteria</code></td>
<td>
<p><code>character</code> with "LM" and/or "MP" for methods to
identify spatial outliers</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>zero.policy</code></td>
<td>
<p>default NULL, use global option value;
if FALSE stop with error for any empty neighbors sets,
if TRUE permit the weights list to be formed with zero-length
weights vectors</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>poly_border</code></td>
<td>
<p><code>sf</code> object with one polygon or NULL. Can be
the result of <code>concaveman::concaveman</code></p>
</td>
</tr>
</table>
<h3>Details</h3>

<p>Possible values for <code>toremove</code> are one or more elements of:
</p>

<dl>
<dt>edges</dt>
<dd>
<p>All data points for a distance of <code>buffer</code> m from data
edges are deleted.</p>
</dd>
<dt>outlier</dt>
<dd>
<p>Values that are outside the mean±<code>sdout</code> are removed</p>
</dd>
<dt>inlier</dt>
<dd>
<p>Local Moran index of spatial autocorrelation is calculated
for each datum as a tool to identify inliers</p>
</dd>
</dl>
<h3>Value</h3>

<p>an object of class <code>paar</code> with two elements:
</p>

<dl>
<dt>depurated_data</dt>
<dd>
<p><code>sf</code> object with the data after the removal
process</p>
</dd>
<dt>condition</dt>
<dd>
<p><code>character</code> vector with the condition of each
observation</p>
</dd>
</dl>
<h3>References</h3>

<p>Vega, A., Córdoba, M., Castro-Franco, M. et al. Protocol for
automating error removal from yield maps. Precision Agric 20, 1030–1044
(2019). https://doi.org/10.1007/s11119-018-09632-8
</p>


<h3>Examples</h3>

<pre><code class="language-R">library(sf)
data(barley, package = 'paar')
#Convert to an sf object
barley &lt;- st_as_sf(barley,
                   coords = c("X", "Y"),
                   crs = 32720)
depurated &lt;-
  depurate(barley,
           "Yield")

# Summary of depurated data
summary(depurated)

# Keep only depurate data
depurated_data &lt;- depurated$depurated_data
# Combine the condition for all data
all_data_condition &lt;- cbind(depurated, barley)
</code></pre>


</div>