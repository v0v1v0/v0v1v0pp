<div class="container">

<table style="width: 100%;"><tr>
<td>population_density</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>Nested functions for population density dependence.</h2>

<h3>Description</h3>

<p>Modular functions for the population simulator for performing density dependent
adjustments to transition rates.
</p>


<h3>Usage</h3>

<pre><code class="language-R">population_density(
  populations,
  stage_matrix,
  fecundity_mask,
  fecundity_max,
  density_dependence,
  growth_rate_max,
  density_affects,
  density_stages,
  density_precision,
  simulator
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>populations</code></td>
<td>
<p>Number of populations.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>stage_matrix</code></td>
<td>
<p>Matrix of transition (fecundity &amp; survival) rates between stages at each time step (Leslie/Lefkovitch matrix).</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>fecundity_mask</code></td>
<td>
<p>Matrix of 0-1 to indicate which (proportions) of transition rates refer to fecundity.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>fecundity_max</code></td>
<td>
<p>Maximum transition fecundity rate (in Leslie/Lefkovitch matrix).</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>density_dependence</code></td>
<td>
<p>Density dependence can be "ceiling" (default), "logistic" (Ricker), or a user-defined function (optionally nested in a list with additional attributes) for adjusting transition rates: <code>function(params)</code>, where <em>params</em> is a list passed to the function containing:
</p>

<dl>
<dt><code>transition_array</code></dt>
<dd>
<p>3D array of transition rates: stages by stages by populations.</p>
</dd>
<dt><code>fecundity_mask</code></dt>
<dd>
<p>Matrix of 0-1 to indicate which (proportions) of transition rates refer to fecundity.</p>
</dd>
<dt><code>fecundity_max</code></dt>
<dd>
<p>Maximum transition fecundity rate (in Leslie/Lefkovitch matrix).</p>
</dd>
<dt><code>carrying_capacity</code></dt>
<dd>
<p>Array of carrying capacity values for each population.</p>
</dd>
<dt><code>stage_abundance</code></dt>
<dd>
<p>Matrix of abundance for each stage (rows) and population (columns).</p>
</dd>
<dt><code>population_abundance</code></dt>
<dd>
<p>Array of summed population abundances for all stages.</p>
</dd>
<dt><code>density_abundance</code></dt>
<dd>
<p>Array of summed population abundances for stages affected by density.</p>
</dd>
<dt><code>growth_rate_max</code></dt>
<dd>
<p>Maximum growth rate value or array for populations.</p>
</dd>
<dt><code>occupied_indices</code></dt>
<dd>
<p>Array of indices for populations occupied at (current) time step.</p>
</dd>
<dt><code>calculate_multipliers</code></dt>
<dd>
<p>Function (<code>function(growth_rates)</code>) for finding multipliers (when stages &gt; 1) to apply to affected transitions that result in target growth rates (dominant eigenvalues).</p>
</dd>
<dt><code>apply_multipliers</code></dt>
<dd>
<p>Function (<code>function(transition_array, multipliers</code>) for applying (when stages &gt; 1) multipliers to the affected transition rates within a transition array (returns multiplied transition array).</p>
</dd>
<dt><code>simulator</code></dt>
<dd>
<p><code>SimulatorReference</code> object with dynamically accessible <em>attached</em> and <em>results</em> lists.</p>
</dd>
<dt><code>additional attributes</code></dt>
<dd>
<p>Additional attributes when density dependence is optionally nested in a list.</p>
</dd>
</dl>
<p>returns an adjusted transition array for occupied populations</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>growth_rate_max</code></td>
<td>
<p>Maximum growth rate (utilized by density dependence processes).</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>density_affects</code></td>
<td>
<p>Matrix of booleans or numeric (0-1) indicating the transition vital rates affected by density (default is all).</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>density_stages</code></td>
<td>
<p>Array of booleans or numeric (0,1) for each stage to indicate which stages are affected by density (default is all).</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>density_precision</code></td>
<td>
<p>Numeric precision of the calculated multipliers (used when stages &gt; 1) applied to affected transition rates (default is 3 decimal places).</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>simulator</code></td>
<td>
<p><code>SimulatorReference</code> object with dynamically accessible <em>attached</em> and <em>results</em> lists.</p>
</td>
</tr>
</table>
<h3>Value</h3>

<p>Density dependent calculation function, either:
</p>

<dl>
<dt><code>function(carrying_capacity, stage_abundance)</code></dt>
<dd>
<p>For ceiling density dependence function, OR</p>
</dd>
<dt><code>function(transition_array, carrying_capacity, stage_abundance, occupied_indices)</code></dt>
<dd>
<p>For user-defined density dependence function, where:
</p>

<dl>
<dt><code>transition_array</code></dt>
<dd>
<p>3D array of transition rates: stages by stages by populations.</p>
</dd>
<dt><code>carrying_capacity</code></dt>
<dd>
<p>Array of carrying capacity values for each population.</p>
</dd>
<dt><code>stage_abundance</code></dt>
<dd>
<p>Matrix of abundance for each stage (rows) and population (columns).</p>
</dd>
<dt><code>occupied_indices</code></dt>
<dd>
<p>Array of indices for populations occupied.</p>
</dd>
</dl>
</dd>
</dl>
<h3>Examples</h3>

<pre><code class="language-R"># Ceiling density dependence
stage_matrix &lt;- array(c(0, 0.5, 0, 3, 0, 0.7, 4, 0, 0.8), c(3, 3))
fecundity_mask &lt;- array(c(0, 0, 0, 1, 0, 0, 1, 0, 0), c(3, 3))
simulator &lt;- SimulatorReference$new()
density_function &lt;- population_density(
 populations = 7, stage_matrix = stage_matrix, fecundity_mask = fecundity_mask,
 fecundity_max = NULL, density_dependence = "ceiling",
 growth_rate_max = NULL, density_affects = NULL, density_stages = c(0, 1, 1),
 density_precision = NULL, simulator = simulator
)
carrying_capacity &lt;- rep(10, 7)
stage_abundance &lt;- matrix(c(
 7, 13, 0, 26, 0, 39, 47,
 2, 0, 6, 8, 0, 12, 13,
 0, 3, 4, 6, 0, 9, 10
), nrow = 3, ncol = 7, byrow = TRUE)

# Life cycle stages 2 and 3 (rows 2 and 3) all add up to 10 or less
density_function(carrying_capacity, stage_abundance)

</code></pre>


</div>