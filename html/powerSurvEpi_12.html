<div class="container">

<table style="width: 100%;"><tr>
<td>powerEpiCont</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2> 
Power Calculation for Cox Proportional Hazards Regression with Nonbinary Covariates for Epidemiological Studies
</h2>

<h3>Description</h3>

<p>Power calculation for Cox proportional hazards regression with nonbinary covariates for Epidemiological Studies. Some parameters will be estimated based on a pilot data set.
</p>


<h3>Usage</h3>

<pre><code class="language-R">powerEpiCont(formula, 
	     dat, 
	     var.X1, 
	     var.failureFlag, 
	     n, 
	     theta, 
	     alpha = 0.05)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>formula</code></td>
<td>
<p> a formula object relating the covariate of interest
to other covariates to calculate the multiple correlation coefficient. The
variables in formula must be in the data frame <code>dat</code>.
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>dat</code></td>
<td>
<p> a <code>nPilot</code> by <code>p</code> data frame representing the pilot 
data set, where <code>nPilot</code> is the number of subjects in the pilot study and
the <code>p</code> (<code class="reqn">&gt;1</code>) columns contains the covariate of interest and other
covariates.
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>var.X1</code></td>
<td>
<p>character. name of the column in the data frame <code>dat</code>, indicating the covariate of interest.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>var.failureFlag</code></td>
<td>
<p>character. name of the column in the data frame <code>dat</code>, indicating if a subject is failure (taking value 1) or alive (taking value 0). 
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>n</code></td>
<td>
<p>integer. total number of subjects. </p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>theta</code></td>
<td>
<p>numeric. postulated hazard ratio. </p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>alpha</code></td>
<td>
<p>numeric. type I error rate. </p>
</td>
</tr>
</table>
<h3>Details</h3>

<p>This is an implementation of the power calculation formula 
derived by Hsieh and Lavori (2000)
for the following Cox proportional hazards regression in the epidemiological
studies: 
</p>
<p style="text-align: center;"><code class="reqn">h(t|x_1, \boldsymbol{x}_2)=h_0(t)\exp(\beta_1 x_1+\boldsymbol{\beta}_2 
\boldsymbol{x}_2),</code>
</p>

<p>where the covariate <code class="reqn">X_1</code> is a nonbinary variable and 
<code class="reqn">\boldsymbol{X}_2</code> is a vector of other covariates.
</p>
<p>Suppose we want to check if  
the hazard ratio of the main effect <code class="reqn">X_1=1</code> to <code class="reqn">X_1=0</code> is equal to 
<code class="reqn">1</code> or is equal to <code class="reqn">\exp(\beta_1)=\theta</code>.
Given the type I error rate <code class="reqn">\alpha</code> for a two-sided test, the power
required to detect a hazard ratio as small as <code class="reqn">\exp(\beta_1)=\theta</code> is
</p>
<p style="text-align: center;"><code class="reqn">power=\Phi\left(-z_{1-\alpha/2}+\sqrt{n[\log(\theta)]^2 \sigma^2 \psi (1-\rho^2)}\right),</code>
</p>

<p>where <code class="reqn">z_{a}</code> is the <code class="reqn">100 a</code>-th percentile of the standard normal distribution, <code class="reqn">\sigma^2=Var(X_1)</code>, <code class="reqn">\psi</code> is the proportion of subjects died of
the disease of interest, and <code class="reqn">\rho</code> is the multiple correlation coefficient
of the following linear regression:
</p>
<p style="text-align: center;"><code class="reqn">x_1=b_0+\boldsymbol{b}^T\boldsymbol{x}_2.</code>
</p>
 
<p>That is, <code class="reqn">\rho^2=R^2</code>, where <code class="reqn">R^2</code> is the proportion of variance
explained by the regression of <code class="reqn">X_1</code> on the vector of covriates
<code class="reqn">\boldsymbol{X}_2</code>.
</p>
<p><code class="reqn">rho</code> will be estimated from a pilot study.
</p>


<h3>Value</h3>

<table>
<tr style="vertical-align: top;">
<td><code>power</code></td>
<td>
<p>The power of the test.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>rho2</code></td>
<td>
<p>square of the correlation between <code class="reqn">X_1</code> and <code class="reqn">X_2</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>sigma2</code></td>
<td>
<p> variance of the covariate of interest. </p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>psi</code></td>
<td>
<p> proportion of subjects died of the disease of interest. </p>
</td>
</tr>
</table>
<h3>Note</h3>

 
<p>(1) Hsieh and Lavori (2000) assumed one-sided test, while this implementation assumed two-sided test.
(2) The formula can be used to calculate
power for a randomized trial study by setting <code>rho2=0</code>.
</p>


<h3>References</h3>

 
<p>Hsieh F.Y. and Lavori P.W. (2000).
Sample-size calculation for the Cox proportional hazards regression model with nonbinary covariates.
<em>Controlled Clinical Trials</em>. 21:552-560.
</p>


<h3>See Also</h3>

 <p><code>powerEpiCont.default</code> </p>


<h3>Examples</h3>

<pre><code class="language-R">  # generate a toy pilot data set
  set.seed(123456)
  X1 &lt;- rnorm(100, mean = 0, sd = 0.3126)
  X2 &lt;- sample(c(0, 1), 100, replace = TRUE)
  failureFlag &lt;- sample(c(0, 1), 100, prob = c(0.25, 0.75), replace = TRUE)
  dat &lt;- data.frame(X1 = X1, X2 = X2, failureFlag = failureFlag)

  powerEpiCont(formula = X1 ~ X2, 
	       dat = dat, 
	       var.X1 = "X1", 
	       var.failureFlag = "failureFlag", 
               n = 107, 
	       theta = exp(1), 
	       alpha = 0.05)

</code></pre>


</div>