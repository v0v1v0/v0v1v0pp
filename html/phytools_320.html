<div class="container">

<table style="width: 100%;"><tr>
<td>sim.corrs</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>Multivariate Brownian simulation with multiple correlations and rates</h2>

<h3>Description</h3>

<p>Simulates multivariate Brownian motion evolution on a tree with multiple evolutionary correlation/covariance matrices.
</p>


<h3>Usage</h3>

<pre><code class="language-R">sim.corrs(tree, vcv, anc=NULL, internal=FALSE)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>tree</code></td>
<td>
<p>an object of class <code>"phylo"</code> or <code>"simmap"</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>vcv</code></td>
<td>
<p>is a square covariance matrix or named list of matrices (one for each mapped state on the tree).</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>anc</code></td>
<td>
<p>optional vector of values for the root state.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>internal</code></td>
<td>
<p>logical value indicating whether to return states at internal nodes.</p>
</td>
</tr>
</table>
<h3>Details</h3>

<p>This function conducts BM simulation on a tree with multiple rates and/or multiple evolutionary correlations between characters.
</p>
<p>If <code>vcv</code> is a single matrix, instead of a list of matrices, <code>sim.corrs</code> will simulate multivariate BM with a single rate matrix.
</p>


<h3>Value</h3>

<p>A matrix containing the multivariate tip states for the <code>n</code> species in the tree (and nodes if <code>internal=</code> <code>TRUE</code>).
</p>


<h3>Author(s)</h3>

<p>Liam Revell <a href="mailto:liam.revell@umb.edu">liam.revell@umb.edu</a></p>


<h3>References</h3>

<p>Revell, L. J., and D. C. Collar (2009) Phylogenetic analysis of the evolutionary correlation using likelihood. <em>Evolution</em>, <b>63</b>, 1090-1100.
</p>
<p>Revell, L. J. (2024) phytools 2.0: an updated R ecosystem for phylogenetic comparative methods (and other things). <em>PeerJ</em>, <b>12</b>, e16505.
</p>


<h3>See Also</h3>

<p><code>fastBM</code>, <code>make.simmap</code>, <code>read.simmap</code>, <code>sim.history</code>, <code>sim.rates</code>
</p>


</div>