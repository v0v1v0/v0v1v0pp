<div class="container">

<table style="width: 100%;"><tr>
<td>GenPoissonBinomial-Distribution</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>The Generalized Poisson Binomial Distribution</h2>

<h3>Description</h3>

<p>Density, distribution function, quantile function and random generation for
the generalized Poisson binomial distribution with probability vector
<code>probs</code>.
</p>


<h3>Usage</h3>

<pre><code class="language-R">dgpbinom(x, probs, val_p, val_q, wts = NULL, method = "DivideFFT", log = FALSE)

pgpbinom(
  x,
  probs,
  val_p,
  val_q,
  wts = NULL,
  method = "DivideFFT",
  lower.tail = TRUE,
  log.p = FALSE
)

qgpbinom(
  p,
  probs,
  val_p,
  val_q,
  wts = NULL,
  method = "DivideFFT",
  lower.tail = TRUE,
  log.p = FALSE
)

rgpbinom(
  n,
  probs,
  val_p,
  val_q,
  wts = NULL,
  method = "DivideFFT",
  generator = "Sample"
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>x</code></td>
<td>
<p>Either a vector of observed sums or NULL. If NULL,
probabilities of all possible observations are
returned.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>probs</code></td>
<td>
<p>Vector of probabilities of success of each Bernoulli
trial.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>val_p</code></td>
<td>
<p>Vector of values that each trial produces with probability
in <code>probs</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>val_q</code></td>
<td>
<p>Vector of values that each trial produces with probability
in <code>1 - probs</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>wts</code></td>
<td>
<p>Vector of non-negative integer weights for the input
probabilities.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>method</code></td>
<td>
<p>Character string that specifies the method of computation
and must be one of <code>"DivideFFT"</code>, <code>"Convolve"</code>, 
<code>"Characteristic"</code>, <code>"Normal"</code> or
<code>"RefinedNormal"</code> (abbreviations are allowed).</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>log, log.p</code></td>
<td>
<p>Logical value indicating if results are given as
logarithms.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>lower.tail</code></td>
<td>
<p>Logical value indicating if results are <code class="reqn">P[X \leq x]</code>
(if <code>TRUE</code>; default) or <code class="reqn">P[X &gt; x]</code> (if 
<code>FALSE</code>).</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>p</code></td>
<td>
<p>Vector of probabilities for computation of quantiles.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>n</code></td>
<td>
<p>Number of observations. If <code>length(n) &gt; 1</code>, the
length is taken to be the number required.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>generator</code></td>
<td>
<p>Character string that specifies the random number
generator and must either be <code>"Sample"</code> or
<code>"Bernoulli"</code> (abbreviations are allowed).</p>
</td>
</tr>
</table>
<h3>Details</h3>

<p>See the references for computational details. The <em>Divide and Conquer</em>
(<code>"DivideFFT"</code>) and <em>Direct Convolution</em> (<code>"Convolve"</code>)
algorithms are derived and described in Biscarri, Zhao &amp; Brunner (2018). They
have been modified for use with the generalized Poisson binomial
distribution. The
<em>Discrete Fourier Transformation of the Characteristic Function</em>
(<code>"Characteristic"</code>) is derived in Zhang, Hong &amp; Balakrishnan (2018),
the <em>Normal Approach</em> (<code>"Normal"</code>) and the
<em>Refined Normal Approach</em> (<code>"RefinedNormal"</code>) are described in Hong
(2013). They were slightly adapted for the generalized Poisson binomial
distribution.
</p>
<p>In some special cases regarding the values of <code>probs</code>, the <code>method</code>
parameter is ignored (see Introduction vignette).
</p>
<p>Random numbers can be generated in two ways. The <code>"Sample"</code> method
uses <code>R</code>'s <code>sample</code> function to draw random values according to
their probabilities that are calculated by <code>dgpbinom</code>. The
<code>"Bernoulli"</code> procedure ignores the <code>method</code> parameter and
simulates Bernoulli-distributed random numbers according to the probabilities
in <code>probs</code> and sums them up. It is a bit slower than the <code>"Sample"</code>
generator, but may yield better results, as it allows to obtain observations
that cannot be generated by the <code>"Sample"</code> procedure, because
<code>dgpbinom</code> may compute 0-probabilities, due to rounding, if the length
of <code>probs</code> is large and/or its values contain a lot of very small
values.
</p>


<h3>Value</h3>

<p><code>dgpbinom</code> gives the density, <code>pgpbinom</code> computes the distribution
function, <code>qgpbinom</code> gives the quantile function and <code>rgpbinom</code>
generates random deviates.
</p>
<p>For <code>rgpbinom</code>, the length of the result is determined by <code>n</code>, and
is the lengths of the numerical arguments for the other functions.
</p>


<h3>References</h3>

<p>Hong, Y. (2018). On computing the distribution function for the Poisson
binomial distribution. <em>Computational Statistics &amp; Data Analysis</em>,
<strong>59</strong>, pp. 41-51. <a href="https://doi.org/10.1016/j.csda.2012.10.006">doi:10.1016/j.csda.2012.10.006</a>
</p>
<p>Biscarri, W., Zhao, S. D. and Brunner, R. J. (2018) A simple and fast method
for computing the Poisson binomial distribution.
<em>Computational Statistics and Data Analysis</em>, <strong>31</strong>, pp.
216â€“222. <a href="https://doi.org/10.1016/j.csda.2018.01.007">doi:10.1016/j.csda.2018.01.007</a>
</p>
<p>Zhang, M., Hong, Y. and Balakrishnan, N. (2018). The generalized 
Poisson-binomial distribution and the computation of its distribution
function. <em>Journal of Statistical Computational and Simulation</em>,
<strong>88</strong>(8), pp. 1515-1527. <a href="https://doi.org/10.1080/00949655.2018.1440294">doi:10.1080/00949655.2018.1440294</a>
</p>


<h3>Examples</h3>

<pre><code class="language-R">set.seed(1)
pp &lt;- c(1, 0, runif(10), 1, 0, 1)
qq &lt;- seq(0, 1, 0.01)
va &lt;- rep(5, length(pp))
vb &lt;- 1:length(pp)

dgpbinom(NULL, pp, va, vb, method = "DivideFFT")
pgpbinom(75:100, pp, va, vb, method = "DivideFFT")
qgpbinom(qq, pp, va, vb, method = "DivideFFT")
rgpbinom(100, pp, va, vb, method = "DivideFFT")

dgpbinom(NULL, pp, va, vb, method = "Convolve")
pgpbinom(75:100, pp, va, vb, method = "Convolve")
qgpbinom(qq, pp, va, vb, method = "Convolve")
rgpbinom(100, pp, va, vb, method = "Convolve")

dgpbinom(NULL, pp, va, vb, method = "Characteristic")
pgpbinom(75:100, pp, va, vb, method = "Characteristic")
qgpbinom(qq, pp, va, vb, method = "Characteristic")
rgpbinom(100, pp, va, vb, method = "Characteristic")

dgpbinom(NULL, pp, va, vb, method = "Normal")
pgpbinom(75:100, pp, va, vb, method = "Normal")
qgpbinom(qq, pp, va, vb, method = "Normal")
rgpbinom(100, pp, va, vb, method = "Normal")

dgpbinom(NULL, pp, va, vb, method = "RefinedNormal")
pgpbinom(75:100, pp, va, vb, method = "RefinedNormal")
qgpbinom(qq, pp, va, vb, method = "RefinedNormal")
rgpbinom(100, pp, va, vb, method = "RefinedNormal")

</code></pre>


</div>