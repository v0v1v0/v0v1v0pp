<div class="container">

<table style="width: 100%;"><tr>
<td>lee</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>Two-phase half-life estimation by linear fitting</h2>

<h3>Description</h3>

<p>Estimation of initial and terminal half-life by two-phase linear regression fitting.</p>


<h3>Usage</h3>

<pre><code class="language-R">lee(conc, time, points=3, method=c("ols", "lad", "hub", "npr"), lt=TRUE) 	     
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>conc</code></td>
<td>
<p> Levels of concentrations. </p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>time</code></td>
<td>
<p> Time points of concentration assessment. </p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>points</code></td>
<td>
<p> Minimum number of data points in the terminal phase (default=<code>3</code>). </p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>method</code></td>
<td>
<p> Method of model fitting (default=<code>ols</code>). </p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>lt</code></td>
<td>
<p> Logical value indicating whether requesting a longer terminal than initial half-life (default=<code>TRUE</code>).</p>
</td>
</tr>
</table>
<h3>Details</h3>

<p>Estimation of initial and terminal half-life based on the method of Lee <em>et al.</em> (1990). This method uses a two-phase linear regression approach separate the model into two straight lines based on the selection of the log10 transformed concentration values. For two-phase models the initial and terminal half-lives were determined from the slopes of the regression lines. If a single-phase model is selected by this method, the corresponding half-life is utilized as both initial and terminal phase half-life. Half-life is determined only for decreasing initial and terminal phases. <br><br></p>
<p>The method <code>ols</code> uses the ordinary least squares regression (OLS) to fit regression lines. <br><br></p>
<p>The method <code>lad</code> uses the absolute deviation regression (LAD) to fit regression lines by using the algorithm as described in Birkes and Dodge (chapter 4, 1993) for calculation of regression estimates. <br><br></p>
<p>The method <code>hub</code> uses the Huber M regression to fit regression lines. Huber M-estimates are calculated by non-linear estimation using the function <code>optim</code>, where OLS regression parameters are used as starting values. The function that is minimized involved k = 1.5*1.483*MAD, where MAD is defined as the median of absolute deviation of residuals obtained by a least absolute deviation (LAD) regression based on the observed data. The initial value of MAD is used and not updated during iterations (Holland and Welsch, 1977). <br><br></p>
<p>The method <code>npr</code> uses the nonparametric regression to fit regression lines by using the algorithm as described in Birkes and Dodge (chapter 6, 1993) for calculation of regression estimates. <br><br></p>
<p>The selection criteria for the best tuple of regression lines is the sum of squared residuals for the <code>ols</code> method, the sum of Huber M residuals for the <code>hub</code> method, the sum of absolute residuals for the <code>lad</code> method and the sum of a function on ranked residuals for the <code>npr</code> method (see Birkes and Dodge (page 115, 1993)). Calculation details can be found in Wolfsegger (2006). <br><br></p>
<p>When <code>lt=TRUE</code>, the best two-phase model where terminal half-life &gt;= initial half-life &gt;= 0 is selected. When <code>lt=FALSE</code>, the best two-phase model among all possible tuples of regression is selected which can result in longer initial half-life than terminal half-life and/or in half-lifes &lt; 0. <br><br></p>


<h3>Value</h3>

<p>A list of S3 class <code>"halflife"</code> containing the following components: <br></p>
<table>
<tr style="vertical-align: top;">
<td><code>parms</code></td>
<td>
<p> half-life and model estimates.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>chgpt</code></td>
<td>
<p> change point between initial and terminal phase. </p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>time</code></td>
<td>
<p> time points of concentration assessments. </p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>conc</code></td>
<td>
<p> levels of concentrations. </p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>method</code></td>
<td>
<p> "lee". </p>
</td>
</tr>
</table>
<h3>Note</h3>

<p>Records including missing values and concentration values below or equal to zero are omitted. </p>


<h3>Author(s)</h3>

<p>Martin J. Wolfsegger</p>


<h3>References</h3>

<p>Birkes D. and Dodge Y. (1993). <em>Alternative Methods of Regression</em>. Wiley, New York, Chichester, Brisbane, Toronto, Singapore.  <br><br></p>
<p>Gabrielsson J. and Weiner D. (2000). <em>Pharmacokinetic and Pharmacodynamic Data Analysis: Concepts and Applications</em>. 4th Edition. Swedish Pharmaceutical Press, Stockholm. <br><br></p>
<p>Holland P. W. and Welsch R. E. (1977). Robust regression using iteratively reweighted least-squares. <em>Commun. Statist.-Theor. Meth.</em> A6(9):813-827. <br><br></p>
<p>Lee M. L., Poon Wai-Yin, Kingdon H. S. (1990). A two-phase linear regression model for biologic half-life data. <em>Journal of Laboratory and Clinical Medicine.</em> 115(6):745-748. <br><br></p>
<p>Wolfsegger M. J. (2006). The R Package PK for Basic Pharmacokinetics. <em>Biometrie und Medizin</em>, 5:61-68. <br></p>


<h3>Examples</h3>

<pre><code class="language-R">#### example for preparation 1 from Lee et al. (1990)
time &lt;- c(0.5, 1.0, 4.0, 8.0, 12.0, 24.0)
conc &lt;- c(75, 72, 61, 54, 36, 6)
res1 &lt;- lee(conc=conc, time=time, method='ols', points=2, lt=TRUE)
res2 &lt;- lee(conc=conc, time=time, method='ols', points=2, lt=FALSE)
plot(res1, log='y', ylim=c(1,100))
plot(res2, add=TRUE, lty=2)

#### example for preparation 2 from Lee et al. (1990)
time &lt;- c(0.5, 1.0, 2.0, 6.5, 8.0, 12.5, 24.0)
conc &lt;- c(75, 55, 48, 51, 39, 9, 5)
res3 &lt;- lee(conc=conc, time=time, method='ols', points=2, lt=FALSE)
print(res3$parms)
plot(res2, log='y', ylim=c(1,100), lty=1, pch=20)
plot(res3, add=TRUE, lty=2, pch=21)
legend(x=0, y=10, pch=c(20,21), lty=c(1,2), legend=c('Preperation 1','Preperation 2'))

#### artificial example
time &lt;- seq(1:10)
conc &lt;- c(1,2,3,4,5,5,4,3,2,1)
res4 &lt;- lee(conc=conc, time=time, method='lad', points=2, lt=FALSE)
plot(res4, log='y', ylim=c(1,7), main='', xlab='', ylab='', pch=19)

#### dataset Indometh of package datasets
require(datasets)
res5 &lt;- data.frame(matrix(ncol=3, nrow=length(unique(Indometh$Subject))))
colnames(res5) &lt;- c('ID', 'initial', 'terminal')
row &lt;- 1
for(i in unique(Indometh$Subject)){
   temp &lt;- subset(Indometh, Subject==i)
   res5[row, 1] &lt;- unique(temp$Subject)
   res5[row, c(2:3)] &lt;- lee(conc=temp$conc, time=temp$time, method='lad')$parms[1,]
   row &lt;- row + 1
}
print(res5)

## geometric means and corresponding two-sided CIs
exp(mean(log(res5$initial)))
exp(t.test(log(res5$initial), conf.level=0.95)$conf.int)

exp(mean(log(res5$terminal)))
exp(t.test(log(res5$terminal), conf.level=0.95)$conf.int)

#### example from Gabrielsson and Weiner (2000, page 743) 
#### endogenous concentration is assumed to be constant over time 
time &lt;- c(-1, 0.167E-01, 0.1167, 0.1670, 0.25, 0.583, 0.8330, 1.083, 1.583, 2.083, 4.083, 8.083,
          12, 23.5, 24.25, 26.75, 32)
conc &lt;- c(20.34, 3683, 884.7, 481.1, 215.6, 114, 95.8, 87.89, 60.19, 60.17, 34.89, 20.99, 20.54, 
          19.28, 18.18, 19.39, 22.72)
data &lt;- data.frame(conc,time)

## naive adjustment for endogenous concentration by subtraction of pre-value
## see also help for function biexp for modelling approaches  
data$concadj &lt;- data$conc - data$conc[1]
data$concadj[min(which(data$concadj&lt;0)):nrow(data)] &lt;- NA
res6 &lt;- lee(conc=data$concadj[-1], time=data$time[-1]) 

## plot results 
split.screen(c(1,2)) 
screen(1)
plot(res6, xlab='Time (hours)', ylab='Baseline-adjusted concentration (pmol/L)')
screen(2)
plot(res6, log='y', ylim=c(0.1, 1E4), xlab='Time (hours)', 
     ylab='Log of baseline-adjusted concentration (pmol/L)')
close.screen(all.screens=TRUE)

</code></pre>


</div>