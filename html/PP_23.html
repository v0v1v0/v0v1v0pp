<div class="container">

<table style="width: 100%;"><tr>
<td>PV</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>Draw Plausible values</h2>

<h3>Description</h3>

<p>This function draws <code>npv</code> plausible values for each person from their posterior density.
</p>


<h3>Usage</h3>

<pre><code class="language-R">PV(estobj, ...)

## S3 method for class 'fourpl'
PV(estobj, npv = 10, approx = TRUE, thinning = 6, burnin = 10, mult = 2, ...)

## S3 method for class 'gpcm'
PV(estobj, npv = 10, approx = TRUE, thinning = 6, burnin = 10, mult = 2, ...)

## S3 method for class 'gpcm4pl'
PV(estobj, npv = 10, approx = TRUE, thinning = 6, burnin = 10, mult = 2, ...)

## S3 method for class 'pv'
print(x, ...)

## S3 method for class 'pv'
summary(object, nrowmax = 15, ...)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>estobj</code></td>
<td>
<p>An object which originates from using <code>PP_4pl()</code>, <code>PP_gpcm()</code> or <code>PPall()</code>. EAP estimation is strongly recommended (<code>type = "eap"</code>), when plausible values are drawn afterwards, because the EAP estimate is used as starting point for the MH algorithm.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>...</code></td>
<td>
<p>More arguments</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>npv</code></td>
<td>
<p>The number of (effectively returned) plausible values - default is 10.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>approx</code></td>
<td>
<p>Whether a normal approximation <code>N(mu,sigma2)</code> is used to draw the plausible values. Default = TRUE. If FALSE a Metropolitan-Hastings-Algorithm will draw the values.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>thinning</code></td>
<td>
<p>A numeric vector of length = 1. If approx = FALSE, a Metropolitan-Hastings-Algorithm draws the plausible values. To avoid autocorrelation, thinning takes every <b>kth</b> value as effective plausible value. The default is 6 (every 6th value is taken), which works appropriately in almost all cases here (with default settings).</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>burnin</code></td>
<td>
<p>How many draws should be discarded at the chains beginning? Default is 10 - and this seems reasonable high (probably 5 will be enough as well), because starting point is the EAP.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>mult</code></td>
<td>
<p>Multiplication constant (default = 2). Use this parameter to vary the width of the proposal distribution - which is <code>N(theta_v,mult*SE_eap)</code> - when a MH-Algorithm is applied. So the constant quantifies the width in terms of multiples of the EAP standard error. 2 works fine with the default thinning. If the supplied value is large, thinning can take lower values without causing autocorrelation.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>x</code></td>
<td>
<p>An object of class <code>pv</code> which is the result of using the <code>PV()</code> function</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>object</code></td>
<td>
<p>An object of class <code>pv</code> which is the result of using the <code>PV()</code> function</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>nrowmax</code></td>
<td>
<p>When printing the matrix of estimates - how many rows should be shown? Default = 15.</p>
</td>
</tr>
</table>
<h3>Value</h3>

<p>The function returns a list which main element is <code>pvdraws</code>. This is a matrix of size number_of_persons x npv - so if 10 plausible values are requested for 100 persons, a 100x10 matrix is returned.
</p>


<h3>Author(s)</h3>

<p>Manuel Reif
</p>


<h3>References</h3>

<p>Mislevy, R. J. (1991). Randomization-based inference about latent variables from complex samples. Psychometrika, 56(2), 177-196.
</p>
<p>Von Davier, M., Gonzalez, E., &amp; Mislevy, R. (2009). What are plausible values and why are they useful. IERI monograph series, 2, 9-36.
</p>
<p>Kruschke, J. (2010). Doing Bayesian data analysis: A tutorial introduction with R. Academic Press.
</p>


<h3>See Also</h3>

<p>PP_gpcm, PP_4pl, JKpp
</p>


<h3>Examples</h3>

<pre><code class="language-R">################# Plausible values #############################################################


### 4 PL model ######


### data creation ##########

set.seed(1522)
# intercepts
diffpar &lt;- seq(-3,3,length=12)
# slope parameters
sl     &lt;- round(runif(12,0.5,1.5),2)
la     &lt;- round(runif(12,0,0.25),2)
ua     &lt;- round(runif(12,0.8,1),2)

# response matrix
awm &lt;- matrix(sample(0:1,10*12,replace=TRUE),ncol=12)


# EAP estimation - 2pl model
res2pleap &lt;- PP_4pl(respm = awm,thres = diffpar, slopes = sl,type = "eap")

# draw 10 plausible values
res_pv  &lt;- PV(res2pleap)
summary(res_pv)

# draw 10 plausible values - use a metropolitan hastings algorithm
res_pv2  &lt;- PV(res2pleap,approx = FALSE)
summary(res_pv2)

# ------ check the PVs


# -- autocorrelation?
autocor &lt;- function(acv)
  {
  cor(acv[-1],acv[-length(acv)]) 
  }


res_pvac  &lt;- PV(res2pleap,approx = FALSE,npv = 200)

# independent draws - so there cannot be any systematic autocorrelation when
# approx = TRUE. So this acts as a kind of benchmark for the MH-Alg.
res_pvac2  &lt;- PV(res2pleap,approx = TRUE,npv = 200)

apply(res_pvac$pvdraws,1,autocor)
apply(res_pvac2$pvdraws,1,autocor)

# -- autocorrelation distr?


apply(res_pvac$pvdraws,1,quantile)
apply(res_pvac2$pvdraws,1, quantile)




### GPCM model ######


# some threshold parameters
THRES  &lt;- matrix(c(-2,-1.23,1.11,3.48,1
                   ,2,-1,-0.2,0.5,1.3,-0.8,1.5),nrow=2)
# slopes
sl     &lt;- c(0.5,1,1.5,1.1,1,0.98)
awmatrix &lt;- matrix(c(1,0,2,0,1,1,1,0,0,1
                     ,2,0,0,0,0,0,0,0,0,1,1,2,2,1,1,1,1,0,0,1),byrow=TRUE,nrow=5)


# EAP estimation
resgpcmeap &lt;- PP_gpcm(respm = awmatrix,thres = THRES, slopes = sl,type = "eap")


res_gpcmpv  &lt;- PV(resgpcmeap,approx = FALSE,npv = 20)




### GPCM and 4PL model ######


# some threshold parameters
THRES  &lt;- matrix(c(-2,-1.23,1.11,3.48,1
                   ,2,-1,-0.2,0.5,1.3,-0.8,1.5),nrow=2)
# slopes
sl     &lt;- c(0.5,1,1.5,1.1,1,0.98)

THRESx &lt;- THRES
THRESx[2,1:3] &lt;- NA

# for the 4PL item the estimated parameters are submitted, 
# for the GPCM items the lower asymptote = 0 
# and the upper asymptote = 1.
la     &lt;- c(0.02,0.1,0,0,0,0)
ua     &lt;- c(0.97,0.91,1,1,1,1)

awmatrix &lt;- matrix(c(1,0,1,0,1,1,1,0,0,1
                     ,2,0,0,0,0,0,0,0,0,1
                     ,1,2,2,1,1,1,1,0,0,1),byrow=TRUE,nrow=5)

model2est &lt;- findmodel(THRESx)


# EAP estimation
respcmeap1 &lt;- PPall(respm = awmatrix,thres = THRESx, 
                    slopes = sl,lowerA = la, upperA=ua, type = "eap",
                    model2est=model2est)


res_mixedpv_1  &lt;- PV(respcmeap1,approx = FALSE,npv = 200)

# rowMeans of plausible values should approximate the EAPs
rowMeans(res_mixedpv_1$pvdraws)
# EAPs
respcmeap1

# show the quantiles of the empirical distribution
apply(res_mixedpv_1$pvdraws,1,quantile)

</code></pre>


</div>