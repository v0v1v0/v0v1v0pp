<div class="container">

<table style="width: 100%;"><tr>
<td>opt.punc</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>Fit a model of trait evolution with specified punctuation(s)</h2>

<h3>Description</h3>

<p>Fit a model of trait evolution with specified punctuation(s)
</p>


<h3>Usage</h3>

<pre><code class="language-R">opt.punc(
  y,
  gg,
  pool = TRUE,
  cl = list(fnscale = -1),
  meth = "L-BFGS-B",
  hess = FALSE,
  oshare
)

opt.joint.punc(
  y,
  gg,
  pool = TRUE,
  cl = list(fnscale = -1),
  meth = "L-BFGS-B",
  hess = FALSE,
  oshare
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>y</code></td>
<td>
<p>a <code>paleoTS</code> object</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>gg</code></td>
<td>
<p>vector of indices indicating different segments</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>pool</code></td>
<td>
<p>if TRUE, sample variances are substituted with their pooled estimate</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>cl</code></td>
<td>
<p>optional control list, passed to <code>optim()</code></p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>meth</code></td>
<td>
<p>optimization algorithm, passed to <code>optim()</code></p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>hess</code></td>
<td>
<p>if TRUE, return standard errors of parameter estimates from the</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>oshare</code></td>
<td>
<p>logical, if TRUE, variance assumed to be shared (equal) across segments</p>
</td>
</tr>
</table>
<h3>Details</h3>

<p>The sequence is divided into segments, which are separated by punctuations. Means for
each segment are given by the vector <code>theta</code> with variances given by the vector
<code>omega</code> (or a single value if <code>oshare = TRUE</code>). This function calls <code>optim</code> to numerically fit this model to a time-series, y.
</p>


<h3>Value</h3>

<p>a <code>paleoTSfit</code> object with the results of the model fitting
</p>


<h3>Functions</h3>


<ul><li> <p><code>opt.joint.punc()</code>: fits the punctuation model using the joint parameterization
</p>
</li></ul>
<h3>Note</h3>

<p>These functions would be used in the uncommon situation in which there
is a prior hypothesis as to where the punctuation(s) take place.  Normally
users will instead use the function <code>fitGpunc</code>, which uses these
functions to fit a range of possible timings for the punctuations.
</p>


<h3>See Also</h3>

<p><code>fitGpunc</code>
</p>


<h3>Examples</h3>

<pre><code class="language-R">x &lt;- sim.punc(ns = c(15, 15), theta = c(0,3), omega = c(0.1, 0.1))
w.sta  &lt;- fitSimple(x, model = "Stasis", method = "Joint")
w.punc &lt;- opt.joint.punc(x, gg = rep(1:2, each = 15), oshare = TRUE)
compareModels(w.sta, w.punc)
</code></pre>


</div>