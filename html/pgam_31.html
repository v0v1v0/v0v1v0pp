<div class="container">

<table style="width: 100%;"><tr>
<td>residuals.pgam</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>Residuals extraction</h2>

<h3>Description</h3>

<p>Method for residuals extraction.
</p>


<h3>Usage</h3>

<pre><code class="language-R">## S3 method for class 'pgam'
residuals(object, type = "deviance", ...)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>object</code></td>
<td>
<p>object of class <code>pgam</code> holding the fitted model</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>type</code></td>
<td>
<p>type of residuals to be extracted. Default is <code>deviance</code>. Options are described in <b>Details</b></p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>...</code></td>
<td>
<p>further arguments passed to method</p>
</td>
</tr>
</table>
<h3>Details</h3>

<p>The types of residuals available and a brief description are the following:
</p>
<p><code>response</code><br>
These are raw residuals of the form <code class="reqn">r_{t}=y_{t}-E\left(y_{t}|Y_{t-1}\right)</code>.
</p>
<p><code>pearson</code><br>
Pearson residuals are quite known and for this model they take the form <code class="reqn">r_{t}=\left(y_{t}-E\left(y_{t}|Y_{t-1}\right)\right)/Var\left(y_{t}|Y_{t-1}\right)</code>.
</p>
<p><code>deviance</code><br>
Deviance residuals are estimated by <code class="reqn">r_{t}=sign\left(y_{t}-E\left(y_{t}|Y_{t-1}\right)\right)*sqrt\left(d_{t}\right)</code>, where <code class="reqn">d_{t}</code> is the deviance contribution of the <em>t</em>-th observation. See <code>deviance.pgam</code> for details on deviance component estimation.
</p>
<p><code>std_deviance</code><br>
Same as deviance, but the deviance component is divided by <code class="reqn">(1-h_{t})</code>, where <code class="reqn">h_{t}</code> is the <em>t</em>-th element of the diagonal of the pseudo hat matrix of the approximating linear model. So they turn into <code class="reqn">r_{t}=sign\left(y_{t}-E\left(y_{t}|Y_{t-1}\right)\right)*sqrt\left(d_{t}/\left(1-h_{t}\right)\right)</code>.<br>
The element <code class="reqn">h_{t}</code> has the form <code class="reqn">h_{t}=\omega\exp\left(\eta_{t+1}\right)/\sum_{j=0}^{t-1}\omega^{j}\exp\left(\eta_{t-j}\right)</code>, where <code class="reqn">\eta</code> is the predictor of the approximating linear model.
</p>
<p><code>std_scl_deviance</code><br>
Just like the last one except for the dispersion parameter in its expression, so they have the form <code class="reqn">r_{t}=sign\left(y_{t}-E\left(y_{t}|Y_{t-1}\right)\right)*sqrt\left(d_{t}/\phi*\left(1-h_{t}\right)\right)</code>, where <code class="reqn">\phi</code> is the estimated dispersion parameter of the model. See <code>summary.pgam</code> for <code class="reqn">\phi</code> estimation.
</p>




<h3>Value</h3>

<p>Vector of residuals of the model fitted.
</p>


<h3>Author(s)</h3>

<p>Washington Leite Junger <a href="mailto:wjunger@ims.uerj.br">wjunger@ims.uerj.br</a> and Antonio Ponce de Leon <a href="mailto:ponce@ims.uerj.br">ponce@ims.uerj.br</a>
</p>


<h3>References</h3>

<p>Harvey, A. C., Fernandes, C. (1989) Time series models for count data or qualitative observations. Journal of Business and Economic Statistics, 7(4):407â€“417
</p>
<p>Junger, W. L. (2004) Semiparametric Poisson-Gamma models: a roughness penalty approach. MSc Dissertation. Rio de Janeiro, PUC-Rio, Department of Electrical Engineering. 
</p>
<p>McCullagh, P., Nelder, J. A. (1989). Generalized Linear Models. Chapman and Hall, 2nd edition, London
</p>
<p>Pierce, D. A., Schafer, D. W. (1986) Residuals in generalized linear models. Journal of the American Statistical Association, 81(396),977-986
</p>


<h3>See Also</h3>

<p><code>pgam</code>, <code>pgam.fit</code>, <code>predict.pgam</code></p>


<h3>Examples</h3>

<pre><code class="language-R">library(pgam)
data(aihrio)
attach(aihrio)
form &lt;- ITRESP5~f(WEEK)+HOLIDAYS+rain+PM+g(tmpmax,7)+g(wet,3)
m &lt;- pgam(form,aihrio,omega=.8,beta=.01,maxit=1e2,eps=1e-4,optim.method="BFGS")

r &lt;- resid(m,"pearson")
plot(r)

</code></pre>


</div>