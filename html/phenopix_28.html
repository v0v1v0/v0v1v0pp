<div class="container">

<table style="width: 100%;"><tr>
<td>greenClusters</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>
Performs a cluster analysis on data in output from pixel-based phenology
</h2>

<h3>Description</h3>

<p>A function to perform a cluster analysis using function <code>kmeans</code> on data in output from pixel-based phenology
</p>


<h3>Usage</h3>

<pre><code class="language-R">greenClusters(data.clusters, data.curve=NULL, nclusters, formula=NULL, 
	plot=TRUE)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>data.clusters</code></td>
<td>

<p>A numeric data.frame on which the k-means clustering has to be run. Each row stores a various number of phenophases for 
a given pixel.       
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>data.curve</code></td>
<td>

<p>A numeric data.frame with nrows equal to nrows of data.clusters and ncol equal to the number of parameters in the eaquation in formula. 
Each row contains the set of parameters to fit the equation in formula, for a given pixel. Or NULL in case of processing with method 'spline'
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>nclusters</code></td>
<td>

<p>The number of clusters, as in <code>centers</code> in function <code>kmeans</code>. 
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>formula</code></td>
<td>

<p>An expression of the equation used to fit the data in your spatial analysis. It can be retrieved from the object in output from greenProcess() function. Or NULL in case of processing with method 'spline'
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>plot</code></td>
<td>

<p>If true a plot with the average trajectories for each cluster is returned. Avaiable only with fitted curves
</p>
</td>
</tr>
</table>
<h3>Details</h3>

<p>This function allows to perform a k-means clustering based on an input data.frame containing one or more phenophases extracted from a pixel-based analysis (in the columns) for each pixel analysed by the spatial analysis (each row must have phenophases for each pixel). A number of clusters is identified and each pixel is assigned to one cluster. An approximate average curve for each of the identified clusters is also built by averaging all curve parameters belonging to the same cluster. 
</p>


<h3>Value</h3>

<p>A named list with components curves, napos and clusters. 
"curves" contains a zoo object with the average curves, one curve for each of the identified clusters, or NA for spline fitting. 
"napos" is a vector with na positions, i.e. pixels where the phenophases in the input matrix are missing. 
"clusters" is a numeric vector of length equal to the number of pixels indicating to which cluster each pixel belongs.  
</p>


<h3>Author(s)</h3>

<p>Gianluca Filippa &lt;gian.filippa@gmail.com&gt;

</p>


</div>