<div class="container">

<table style="width: 100%;"><tr>
<td>plot.summary.POUMM</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>Plot a summary of a POUMM fit</h2>

<h3>Description</h3>

<p>Plot a summary of a POUMM fit
</p>


<h3>Usage</h3>

<pre><code class="language-R">## S3 method for class 'summary.POUMM'
plot(
  x,
  type = c("MCMC"),
  doPlot = TRUE,
  stat = c("alpha", "theta", "sigma", "sigmae", "g0", "H2tMean"),
  chain = NULL,
  doZoomIn = FALSE,
  zoomInFilter = paste0("(stat %in% c('H2e','H2tMean','H2tInf','H2tMax') &amp; ",
    "(value &gt;= 0 &amp; value &lt;= 1) ) |",
    "( !stat %in% c('H2e','H2tMean','H2tInf','H2tMax') &amp; ",
    "(value &lt;= median(HPDUpper) + 4 * (median(HPDUpper) - median(HPDLower)) &amp;",
    "value &gt;= median(HPDLower) - 4 * (median(HPDUpper) - median(HPDLower))))"),
  palette = c("#999999", "#0072B2", "#CC79A7", "#E69F00", "#D55E00", "#56B4E9",
    "#009E73", "#F0E442"),
  prettyNames = TRUE,
  ...
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>x</code></td>
<td>
<p>An object of class POUMM.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>type</code></td>
<td>
<p>A character indicating the type of plot(s) to be generated.
Defaults to "MCMC", resulting in a trace and density plot for the selected
statistics (see argument stat). Currently, only 'MCMC' type is supported.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>doPlot</code></td>
<td>
<p>Logical indicating whether a plot should be printed on the 
currently active graphics device or whether only to return a list of plot- 
objects for further processing. Defaults to TRUE.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>stat</code></td>
<td>
<p>A character vector with the names of statistics to be plotted.
These should be names from the stats-list (see argument statFunctions).
Defaults to c("alpha", "theta", "sigma", "sigmae", "H2tMean", "H2tInf").</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>chain</code></td>
<td>
<p>A vector of integers indicating the chains to be plotted.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>doZoomIn</code></td>
<td>
<p>(type MCMC only) A logical value indicating whether the 
produced plots should have a limitation on the x-axis according to an 
expression set in zoomInFilter (see below). Default value is FALSE.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>zoomInFilter</code></td>
<td>
<p>A character string which evaluates as logical value. If 
doZoomIn is set to TRUE, this filter is applied to each point in each MCMC
chain and the data-point is filtered out if it evaluates to FALSE. This 
allows to zoomIn the x-axis of density plots but should be used with caution,
since filtering out points from the MCMC-sample can affect the kernel densities.
Unfortunately, filtering out values is currently the only way to affect the
limits of individual facets in ggplot2. The default value is a complicated 
expression involving the HPD from all MCMC chains (normally one chain from the
prior and 2 chains from the posterior):
zoomInFilter = paste0("stat 
The identifiers in this expression can be any
column names found in a summary of a POUMM object.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>palette</code></td>
<td>
<p>A vector of colors (can be character strings) corresponding to the 
different chains (in their order 1 (prior), 2, 3). Defaults to c("#999999", 
"#0072B2", "#CC79A7", "#E69F00", "#D55E00", "#56B4E9", "#009E73", "#F0E442"),
which is a color-blind friendly.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>prettyNames</code></td>
<td>
<p>A logical indicating if greek letters and sub/superscripts 
should be used for the names of columns in the posterior density pairs-plot.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>...</code></td>
<td>
<p>Not used; included for compatibility with the generic function plot.</p>
</td>
</tr>
</table>
<h3>Value</h3>

<p>If doPlot==TRUE, the function returns nothing and produces output on 
the current graphics device as a side-effect. Otherwise, the function returns
a list of plot-objects: traceplot and densplot.
</p>


<h3>Examples</h3>

<pre><code class="language-R">## Not run: 
library(POUMM)

set.seed(1)

N &lt;- 1000

# create a random non-ultrametric tree of N tips
tree &lt;- ape::rtree(N)  

# Simulate the evolution of a trait along the tree
z &lt;- rVNodesGivenTreePOUMM(
  tree, g0 = 8, alpha = 1, theta = 4, sigma = 1.2, sigmae = .8)

fit &lt;- POUMM(z[1:N], tree, spec = list(nSamplesMCMC = 4e5))

# Summarize the results from the fit in a table:
summary(fit)

# Create plots for some of the inferred parameters/statistics:
pl &lt;- plot(fit, stat = c("alpha", "theta", "sigma", "sigmae", "H2tMean"), 
           doZoomIn = TRUE, 
           zoomInFilter = paste("!(stat %in% c('alpha', 'sigma', 'sigmae')) |",
                                "(value &gt;= 0 &amp; value &lt;= 8)"),
           doPlot = FALSE)

pl$traceplot
pl$densplot

## End(Not run)

</code></pre>


</div>