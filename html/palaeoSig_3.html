<div class="container">

<table style="width: 100%;"><tr>
<td>agelme</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2> Estimation of the relationship between Calibrated age and depth </h2>

<h3>Description</h3>

<p>Estimates the relationship of Calibrated age and depth for palaeorecords. The function uses a smooth spline
of the mgcv library by Simon Wood. It produces predicted confidence interval for the relationship approximating 
a mixed effect model, as there are two levels of uncertainty, i.e. within dated object and between dated objects.
</p>


<h3>Usage</h3>

<pre><code class="language-R">agelme(depup, depdo, bpup, bpdo, use, weights=c(1,rep(0,length(depup)-1)), 
    vspan=1, k=length(depup)-1, m=2, diagnostic=FALSE)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>depup</code></td>
<td>
<p> The upper depths of the dated slides </p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>depdo</code></td>
<td>
<p> The lower depths of the dated slides </p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>bpup</code></td>
<td>
<p> The younger calibrated ages of the dated slides </p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>bpdo</code></td>
<td>
<p> The older calibrated ages of the dated slides </p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>use</code></td>
<td>
<p> Logical vector of dates to include in the model. Default is to use all.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>weights</code></td>
<td>
<p> Weights to be used for the estimation, default is fixed top-layer followed by inverse variance of within dated object </p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>vspan</code></td>
<td>
<p> The span to be used for the diagnostic plots, default span = 1 </p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>k</code></td>
<td>
<p> Number of base function to start the shrinkage in the gam estimation procedure </p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>m</code></td>
<td>
<p>The order of penalty for the term, i.e. the degree of continuity at the knots (default, m = 2 gives cubic smooth spline) </p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>diagnostic</code></td>
<td>
<p>Logical, should diagnostic plots be made.</p>
</td>
</tr>
</table>
<h3>Details</h3>

<p>Note that the fixation of the top layer is done by a weight = 1, whereas the other weights follows inverse variance within object.
</p>
<p>The diagnostic plots is used to check the quality of the estimation and to see if there is a need for an assumption of between
object variance proportional to mean. The latter however is rarely encountered for palaeodata.
</p>


<h3>Value</h3>

<table>
<tr style="vertical-align: top;">
<td><code>tdf </code></td>
<td>
<p>Degrees of freedom used by the cubic smooth spline, a vector with first value for constant variance and second vector for variance equal to mu.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>weights </code></td>
<td>
<p>A vector of the weights used by the cubic smooth spline </p>
</td>
</tr>
</table>
<table>
<tr style="vertical-align: top;">
<td><code>RES</code></td>
<td>
<p>A vector of the Residual sum of squares</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>Models</code></td>
<td>
<p>A list with the models from the cubic smooth spline, constant and mu variance, respectively</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>Data</code></td>
<td>
<p>A data.frame including the data used for the estimation</p>
</td>
</tr>
</table>
<h3>Author(s)</h3>

<p> Einar Heegaard &lt;einar.heegaard@bio.uib.no&gt; </p>


<h3>References</h3>

<p> Heegaard, E., Birks, HJB. &amp; Telford, RJ. 2005. Relationships between calibrated ages and depth in stratigraphical sequences: an estimation procedure by mixed-effect regression. The Holocene 15: 612-618</p>


<h3>Examples</h3>

<pre><code class="language-R">data(STOR)

fit.mod &lt;- with(STOR,agelme(depthup,depthdo,cageup,cagedo))

#Predicting using the constant variance model,
#for each cm between 70 and 400 cm.
fit.pre &lt;- predict(fit.mod,1,70:400)
plot(fit.pre)

</code></pre>


</div>