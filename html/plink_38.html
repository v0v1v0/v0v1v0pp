<div class="container">

<table style="width: 100%;"><tr>
<td>grm-methods</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>Graded Response Model Probabilities</h2>

<h3>Description</h3>

<p>This function computes the cumulative probability of responding within or above a certain 
category or the probability of responding in a specific category for one or more items for 
a given set of theta values using the graded response model or multidimensional graded
response model.
</p>


<h3>Usage</h3>

<pre><code class="language-R">grm(x, cat, theta, dimensions = 1, catprob = FALSE, D = 1, 
  location = FALSE, items, information = FALSE, angle, ...)

## S4 method for signature 'matrix', 'numeric'
grm(x, cat, theta, dimensions, catprob, D, location, items, information, angle, ...)

## S4 method for signature 'data.frame', 'numeric'
grm(x, cat, theta, dimensions, catprob, D, location, items, information, angle, ...)

## S4 method for signature 'list', 'numeric'
grm(x, cat, theta, dimensions, catprob, D, location, items, information, angle, ...)

## S4 method for signature 'irt.pars', 'ANY'
grm(x, cat, theta, dimensions, catprob, D, location, items, information, angle, ...)

## S4 method for signature 'sep.pars', 'ANY'
grm(x, cat, theta, dimensions, catprob, D, location, items, information, angle, ...)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>x</code></td>
<td>
<p>ans <code>R</code> object containing item parameters.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>cat</code></td>
<td>
<p>vector identifying the number of response categories (not the number of threshold
parameters) for each item.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>theta</code></td>
<td>
<p>vector, matrix, or list of theta values for which probabilities will be computed. 
If <code>theta</code> is not specified, an equal interval range of values from -4 to 4 is used 
with an increment of 0.5. See details below for more information. </p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>dimensions</code></td>
<td>
<p>number of modeled dimensions </p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>catprob</code></td>
<td>
<p>if <code>TRUE</code>, compute category probabilities instead of cumulative
probabilities </p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>D</code></td>
<td>
<p>scaling constant. The default value assumes that the parameters are already in the 
desired metric. If the parameters are in the logistic metric, they can be transformed to a 
normal metric by setting D = 1.7</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>location</code></td>
<td>
<p>if <code>TRUE</code>, the step parameters are deviations from a difficulty
parameter </p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>items</code></td>
<td>
<p>numeric vector identifying the items for which probabilities should be computed</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>information</code></td>
<td>
<p>logical value. If <code>TRUE</code> compute item information. In the multidimensional
case, information will be computed in the directions specified by <code>angle</code> or default angles
of 0 - 90 in increments of 10 degrees.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>angle</code></td>
<td>
<p>vector or matrix of angles between the dimension 1 axis and the corresponding axes for each 
of the other dimensions for which information will be computed. When there are more than two dimensions 
and <code>angle</code> is a vector, the same set of angles will be used relative to each of the corresponding axes.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>...</code></td>
<td>
<p>further arguments passed to or from other methods </p>
</td>
</tr>
</table>
<h3>Details</h3>

<p><code>theta</code> can be specified as a vector, matrix, or list.  For the unidimensional case, <code>theta</code>
should be a vector. If a matrix or list of values is supplied, they will be converted to a single vector
of theta values.  For the multidimensional case, if a vector of values is supplied it will be assumed
that this same set of values should be used for each dimension.  Probabilities will be computed for each
combination of theta values.  Similarly, if a list is supplied, probabilities will be computed for each
combination of theta values.  In instances where probabilities are desired for specific combinations of 
theta values, a j x m matrix should be specified for j ability points and m dimensions where the columns 
are ordered from dimension 1 to m.
</p>


<h3>Value</h3>

<p>Returns an object of class <code>irt.prob</code>
</p>


<h3>Methods</h3>


<dl>
<dt>x = "matrix", cat = "numeric"</dt>
<dd>
<p> This method allows one to specify an n x k 
matrix for n items.  The number of columns can vary depending on the number of dimensions
and whether a location parameter is included.  The first m columns, for m dimensions, are
for item slopes and the remaining columns are for the threshold/threshold deviation 
parameters.
</p>
<p>Threshold parameters can be characterized in two ways: the actual thresholds or 
deviations from an overall item difficulty (location).  In the deviation scenario the 
<code>location</code> argument should be <code>TRUE</code> and the location parameters should be 
in the m+1 column.  The columns for the threshold/threshold deviation parameters 
will always follow the slope column(s) and, if applicable, the location column.  The number 
of threshold/threshold deviation parameters can vary for each item.  In these instances, 
all cells with missing values should be filled with <code>NA</code>s.  For example, for a 
unidimensional model with no location parameter, if one item has five categories (four 
threshold parameters) and another item has three categories (two threshold parameters), 
there should be five columns.  The first column includes the slope parameters and columns 
2-5 include the threshold parameters.  The values in the last two columns for the item with 
three categories should be <code>NA</code>.</p>
</dd>
<dt>x = "data.frame", cat = "numeric"</dt>
<dd>
<p>See the method for x = "matrix" </p>
</dd>
<dt>x = "list", cat = "numeric"</dt>
<dd>
<p>This method is for a list with two elements.  The first 
list element is for item slopes and the second for the threshold/threshold deviation 
parameters.  For the unidimensional case, the slope values should be a vector of length n 
or an n x 1 matrix for n items.  For the multidimensional case, the slopes should be
specified in an n x m matrix.  For both the unidimensional and multidimensional cases, 
the threshold/threshold deviation parameters should be formatted as an n x k matrix.  If 
the thresholds are deviations from a location parameter, the argument <code>location</code> 
should be <code>TRUE</code> and the location parameters should be in the first column.  The 
number of threshold/threshold deviation parameters can vary for each item.  In these 
instances, all cells with missing values should be filled with <code>NA</code>s (See the 
example in the method for x = "matrix"). </p>
</dd>
<dt>x = "irt.pars", cat = "ANY"</dt>
<dd>
<p>This method can be used to compute probabilities 
for the grm items in an object of class <code>"irt.pars"</code>.  If <code>x</code> contains 
dichotomous items or items associated with another polytomous model, a warning will be 
displayed stating that probabilities will be computed for the grm items only. If <code>x</code> 
contains parameters for multiple groups, a list of <code>"irt.prob"</code> objects will be 
returned.  The argument <code>dimensions</code> does not need to be included for this method.</p>
</dd>
<dt>x = "sep.pars", cat = "ANY"</dt>
<dd>
<p>This method can be used to compute probabilities 
for the grm items in an object of class <code>sep.pars</code>. If <code>x</code> contains 
dichotomous items or items associated with another polytomous model, a warning will be 
displayed stating that probabilities will be computed for the grm items only.  The 
argument <code>dimensions</code> does not need to be included for this method.</p>
</dd>
</dl>
<h3>Author(s)</h3>

<p> Jonathan P. Weeks <a href="mailto:weeksjp@gmail.com">weeksjp@gmail.com</a> </p>


<h3>References</h3>

 
<p>Embretson, S. E., &amp; Reise, S. P. (2000)
<em>Item Response Theory for Psychologists.</em>
Mahwah, New Jersey: Lawrence Erlbaum Associates.
</p>
<p>Kolen, M. J. &amp; Brennan, R. L. (2004)
<em>Test Equating, Scaling, and Linking (2nd ed.).</em>
New York: Springer.
</p>
<p>Muraki, E., &amp; Carlson, J. E. (1995). 
Full-information factor analysis for polytomous item responses. 
<em>Applied Psychological Measurement</em>, <em>19</em>(1), 73-90.
</p>
<p>Samejima, F. (1969)
Estimation of latent ability using a response pattern of graded scores.
<em>Psychometrika Monograph</em>, No. 17.
</p>
<p>Samejima, F. (1996)
The graded response model.
In W. J. van der Linden &amp; Hambleton, R. K. (Eds.) 
<em>Handbook of Modern Item Response Theory</em> (pp. 85-100). 
New York: Springer-Verlag.
</p>
<p>Weeks, J. P. (2010) 
<b>plink</b>: An R package for linking mixed-format tests using IRT-based methods. 
<em>Journal of Statistical Software</em>, <b>35(12)</b>, 1â€“33. 
URL <a href="http://www.jstatsoft.org/v35/i12/">http://www.jstatsoft.org/v35/i12/</a>
</p>


<h3>See Also</h3>

 
<p><code>mixed:</code> compute probabilities for mixed-format items<br><code>plot:</code> plot item characteristic/category curves<br><code>irt.prob</code>, <code>irt.pars</code>, <code>sep.pars:</code> classes
</p>


<h3>Examples</h3>

<pre><code class="language-R">###### Unidimensional Examples ######
## Cumulative probabilities 
## Item parameters from Embretson &amp; Reise (2000, p. 101) items 9-11
# Includes a location parameter
a &lt;- c(2.09,1.18,1.69)
b &lt;- matrix(c(-1.07,-1.03,.39,.86,1.78,1.85,-.87,-.39,.31,NA,
  -1.4,-.42,NA,NA,-1.74),3,5) 
pars &lt;- cbind(a,b)
rownames(pars) &lt;- paste("Item",9:11,sep=" ")
colnames(pars) &lt;- c("a","b",paste("c",1:4,sep=""))
cat &lt;- c(3,4,5)
x &lt;- grm(pars,cat,location=TRUE)
plot(x)

## Item parameters from Kolen &amp; Brennan (2004, p. 210)
# Use theta values from -3 to 3 with an increment of 0.5
pars &lt;- t(c(1.2,-.5,.6,1.1,1.3))
x &lt;- grm(pars,5,theta=seq(-3,3,.05))
plot(x,item.lab=FALSE)


## Category probabilities
## Single item
pars &lt;- t(c(1.2,-.5,.6,1.1,1.3))
x &lt;- grm(pars,5,seq(-3,3,.05),catprob=TRUE)
plot(x,item.lab=FALSE)

# Items without location parameter
a &lt;- c(2.09,1.18,1.69)
b &lt;- matrix(c(-1.93,-2.81,-1.46,-.2,-.64,.08,NA,.37,.81,NA,NA,2.13),3,4) 
pars &lt;- cbind(a,b)
rownames(pars) &lt;- paste("Item",9:11,sep=" ")
colnames(pars) &lt;- c("a",paste("b",1:4,sep=""))
cat &lt;- c(3,4,5)
x &lt;- grm(pars,cat,catprob=TRUE)
plot(x)

## Create sep.pars object then compute category probabilities
a &lt;- c(2.09,1.18,1.69)
b &lt;- matrix(c(-1.93,-2.81,-1.46,-.2,-.64,.08,NA,.37,.81,NA,NA,2.13),3,4) 
pars &lt;- cbind(a,b)
cat &lt;- c(3,4,5)
pm &lt;- as.poly.mod(3,"grm")
out &lt;- sep.pars(pars,cat,pm)
x &lt;- grm(out,catprob=TRUE)
plot(x)


###### Multidimensional Examples ######
## Cumulative probabilities
a &lt;- matrix(c(.873, .226, .516, .380, .613, .286 ),3,2,byrow=TRUE)
d &lt;- matrix(c(2.255, 1.334, -.503, -2.051, -3.082,
1.917, 1.074, -.497, -1.521, -2.589,
1.624, .994, -.656, -1.978, NA),3,5,byrow=TRUE)
pars &lt;- cbind(a,d)
cat &lt;- c(6,6,5)
x &lt;- grm(pars,cat,dimensions=2)
plot(x)

# Plot separated response surfaces
plot(x, separate=TRUE, drape=TRUE)

## Category Probabilities
## Use {pars} an {cat} from the example above
x &lt;- grm(pars,cat,dimensions=2, catprob=TRUE)

# plot combined item category surfaces
# The screen argument adjusts the orientation of the axes
plot(x,screen=list(z=-40,x=-60), auto.key=list(space="right"))
</code></pre>


</div>