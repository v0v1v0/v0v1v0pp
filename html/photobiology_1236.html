<div class="container">

<table style="width: 100%;"><tr>
<td>water_vp_sat</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>Water vapour pressure</h2>

<h3>Description</h3>

<p>Approximate water pressure in air as a function of temperature, and its
inverse the calculation of dewpoint.
</p>


<h3>Usage</h3>

<pre><code class="language-R">water_vp_sat(
  temperature,
  over.ice = FALSE,
  method = "tetens",
  check.range = TRUE
)

water_dp(water.vp, over.ice = FALSE, method = "tetens", check.range = TRUE)

water_fp(water.vp, over.ice = TRUE, method = "tetens", check.range = TRUE)

water_vp2mvc(water.vp, temperature)

water_mvc2vp(water.mvc, temperature)

water_vp2RH(
  water.vp,
  temperature,
  over.ice = FALSE,
  method = "tetens",
  pc = TRUE,
  check.range = TRUE
)

water_RH2vp(
  relative.humidity,
  temperature,
  over.ice = FALSE,
  method = "tetens",
  pc = TRUE,
  check.range = TRUE
)

water_vp_sat_slope(
  temperature,
  over.ice = FALSE,
  method = "tetens",
  check.range = TRUE,
  temperature.step = 0.1
)

psychrometric_constant(atmospheric.pressure = 101325)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>temperature</code></td>
<td>
<p>numeric vector of air temperatures (C).</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>over.ice</code></td>
<td>
<p>logical vector Is the estimate for equilibrium with liquid
water or with ice.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>method</code></td>
<td>
<p>character Currently "tetens", modified "magnus", "wexler" and
"goff.gratch" equations  are supported.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>check.range</code></td>
<td>
<p>logical Flag indicating whether to check or not that
arguments for temperature are within the range of validity of the
<code>method</code> used.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>water.vp</code></td>
<td>
<p>numeric vector of water vapour pressure in air (Pa).</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>water.mvc</code></td>
<td>
<p>numeric vector of water vapour concnetration as mass per
volume (<code class="reqn">g m^{-3}</code>).</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>pc</code></td>
<td>
<p>logical flag for result returned as percent or not.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>relative.humidity</code></td>
<td>
<p>numeric Relative humidity as 
fraction of 1.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>temperature.step</code></td>
<td>
<p>numeric Delta or step used to estimate the slope
as a finite difference (C).</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>atmospheric.pressure</code></td>
<td>
<p>numeric Atmospheric pressure (Pa).</p>
</td>
</tr>
</table>
<h3>Details</h3>

<p>Function <code>water_vp_sat()</code> provides implementations of several
well known equations for the estimation of saturation vapor pressure in
air. Functions <code>water_dp()</code> and <code>water_fp()</code> use the inverse of
these equations to compute the dew point or frost point from water vapour
pressure in air. The inverse functions are either analytical solutions or
fitted approximations. None of these functions are solved numerically by
iteration.
</p>
<p>Method <code>"tetens"</code> implements Tetens' (1930) equation for the cases of
equilibrium with a water and an ice surface. Method <code>"magnus"</code>
implements the modified Magnus equations of Alduchov and Eskridge (1996,
eqs. 21 and 23). Method <code>"wexler"</code> implements the equations proposed
by Wexler (1976, 1977), and their inverse according to Hardy (1998). Method
<code>"goff.gratch"</code> implements the equations of Groff and Gratch (1946)
with the minor updates of Groff (1956).
</p>
<p>The equations are approximations, and in spite of their different names,
Tetens' and Magnus' equations have the same form with the only difference
in the values of the parameters. However, the modified Magnus equation is
more accurate as Tetens equation suffers from some bias errors at extreme
low temperatures (&lt; -40 C). In contrast Magnus equations with recently
fitted values for the parameters are usable for temperatures from -80 C to
+50 C over water and -80 C to 0 C over ice. The Groff Gratch equation is
more complex and is frequently used as a reference in comparison as it is
considered reliable over a broad range of temperatures. Wexler's equations
are computationally simpler and fitted to relatively recent data. There is
little difference at temperatures in the range -20 C to +50 C, and
differences become large at extreme temperatures. Temperatures outside the
range where estimations are highly reliable for each equation return
<code>NA</code>, unless extrapolation is enabled by passing <code>FALSE</code> as
argument to parameter <code>check.range</code>.
</p>
<p>The switch between equations for ice or water cannot be based on
air temperature, as it depends on the presence or not of a surface of
liquid water. It must be set by passing an argument to parameter
<code>over.ice</code> which defaults to <code>FALSE</code>.
</p>
<p>Tetens equation is still very frequently used, and is for example the
one recommended by FAO for computing potential evapotranspiration. For this
reason it is used as default here.
</p>


<h3>Value</h3>

<p>A numeric vector of partial pressures in pascal (Pa) for
<code>water_vp_sat()</code> and <code>water_mvc2vp()</code>, a numeric vector of dew point
temperatures (C) for <code>water_dp()</code> and numeric vector of mass per volume
concentrations (<code class="reqn">g m^{-3}</code>) for <code>water_vp2mvc()</code>.  <code>water_vp_sat()</code> and
<code>psychrometric_constant()</code> both return numeric vectors of pressure per
degree of temperature (<code class="reqn">Pa C^{-1}</code>)
</p>


<h3>Note</h3>

<p>The inverse of the Groff Gratch equation has yet to be implemented.
</p>


<h3>References</h3>

<p>Tetens, O., 1930. Uber einige meteorologische Begriffe.
Zeitschrift fur Geophysik, Vol. 6:297.
</p>
<p>Goff, J. A., and S. Gratch (1946) Low-pressure properties of water from
-160 to 212 F, in Transactions of the American Society of Heating and
Ventilating Engineers, pp 95-122, presented at the 52nd annual meeting of
the American Society of Heating and Ventilating Engineers, New York, 1946.
</p>
<p>Wexler, A. (1976) Vapor Pressure Formulation for Water in Range 0 to 100Â°C.
A Revision, Journal of Research ofthe National Bureau of Standards: A.
Physics and Chemistry, September-December 1976, Vol. 80A, Nos.5 and 6,
775-785
</p>
<p>Wexler, A., (1977) Vapor Pressure Formulation for Ice, Journal of Research of the
National Bureau of Standards - A. Physics and Chemistry, Vol. 81A, No. 1, 5-19
</p>
<p>Alduchov, O. A., Eskridge, R. E., 1996. Improved Magnus Form Approximation
of Saturation Vapor Pressure. Journal of Applied Meteorology, 35: 601-609 .
</p>
<p>Hardy, Bob (1998) ITS-90 formulations for vapor pressure, frostpoint
temperature, dewpoint temperature, andenhancement factors in the range -100
TO +100 C. The Proceedings of the Third International Symposium on Humidity
&amp; Moisture, Teddington, London, England, April 1998.
<a href="https://www.decatur.de/javascript/dew/resources/its90formulas.pdf">https://www.decatur.de/javascript/dew/resources/its90formulas.pdf</a>
</p>
<p>Monteith, J., Unsworth, M. (2008) Principles of Environmental Physics.
Academic Press, Amsterdam.
</p>
<p>Allen R G, Pereira L S, Raes D, Smith M. (1998) Crop evapotranspiration:
Guidelines for computing crop water requirements. FAO Irrigation and
drainage paper 56. Rome: FAO.
</p>
<p>[Equations describing the physical properties of moist
air](http://www.conservationphysics.org/atmcalc/atmoclc2.pdf)
</p>


<h3>Examples</h3>

<pre><code class="language-R">water_vp_sat(20) # C -&gt; Pa
water_vp_sat(temperature = c(0, 10, 20, 30, 40)) # C -&gt; Pa
water_vp_sat(temperature = -10) # over water!!
water_vp_sat(temperature = -10, over.ice = TRUE)
water_vp_sat(temperature = 20) / 100 # C -&gt; mbar

water_vp_sat(temperature = 20, method = "magnus") # C -&gt; Pa
water_vp_sat(temperature = 20, method = "tetens") # C -&gt; Pa
water_vp_sat(temperature = 20, method = "wexler") # C -&gt; Pa
water_vp_sat(temperature = 20, method = "goff.gratch") # C -&gt; Pa

water_vp_sat(temperature = -20, over.ice = TRUE, method = "magnus") # C -&gt; Pa
water_vp_sat(temperature = -20, over.ice = TRUE, method = "tetens") # C -&gt; Pa
water_vp_sat(temperature = -20, over.ice = TRUE, method = "wexler") # C -&gt; Pa
water_vp_sat(temperature = -20, over.ice = TRUE, method = "goff.gratch") # C -&gt; Pa

water_dp(water.vp = 1000) # Pa -&gt; C
water_dp(water.vp = 1000, method = "magnus") # Pa -&gt; C
water_dp(water.vp = 1000, method = "wexler") # Pa -&gt; C
water_dp(water.vp = 500, over.ice = TRUE) # Pa -&gt; C
water_dp(water.vp = 500, method = "wexler", over.ice = TRUE) # Pa -&gt; C

water_fp(water.vp = 300) # Pa -&gt; C
water_dp(water.vp = 300, over.ice = TRUE) # Pa -&gt; C

water_vp2RH(water.vp = 1500, temperature = 20) # Pa, C -&gt; RH %
water_vp2RH(water.vp = 1500, temperature = c(20, 30)) # Pa, C -&gt; RH %
water_vp2RH(water.vp = c(600, 1500), temperature = 20) # Pa, C -&gt; RH %

water_vp2mvc(water.vp = 1000, temperature = 20) # Pa -&gt; g m-3

water_mvc2vp(water.mvc = 30, temperature = 40) # g m-3 -&gt; Pa

water_dp(water.vp = water_mvc2vp(water.mvc = 10, temperature = 30)) # g m-3 -&gt; C


water_vp_sat_slope(temperature = 20) # C -&gt; Pa / C


psychrometric_constant(atmospheric.pressure = 81.8e3) # Pa -&gt; Pa / C

</code></pre>


</div>