<div class="container">

<table style="width: 100%;"><tr>
<td>SubtypingOmicsData</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>Subtyping multi-omics data</h2>

<h3>Description</h3>

<p>Perform subtyping using multiple types of data
</p>


<h3>Usage</h3>

<pre><code class="language-R">SubtypingOmicsData(
  dataList,
  kMin = 2,
  kMax = 5,
  k = NULL,
  agreementCutoff = 0.5,
  ncore = 1,
  verbose = T,
  sampledSetSize = 2000,
  knn.k = NULL,
  ...
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>dataList</code></td>
<td>
<p>a list of data matrices. Each matrix represents a data type where the rows are items and the columns are features. The matrices must have the same set of items.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>kMin</code></td>
<td>
<p>The minimum number of clusters used for automatically detecting the number of clusters in <code>PerturbationClustering</code>. This paramter is passed to <code>PerturbationClustering</code> and does not affect the final number of cluster in <code>SubtypingOmicsData</code>. Default value is <code>2</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>kMax</code></td>
<td>
<p>The maximum number of clusters used for automatically detecting the number of clusters in <code>PerturbationClustering</code>. This paramter is passed to <code>PerturbationClustering</code> and does not affect the final number of cluster in <code>SubtypingOmicsData</code>. Default value is <code>5</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>k</code></td>
<td>
<p>The number of clusters. If k is set then kMin and kMax will be ignored.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>agreementCutoff</code></td>
<td>
<p>agreement threshold to be considered consistent. Default value is <code>0.5</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>ncore</code></td>
<td>
<p>Number of cores that the algorithm should use. Default value is <code>1</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>verbose</code></td>
<td>
<p>set it to <code>TRUE</code> of <code>FALSE</code> to get more or less details respectively.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>sampledSetSize</code></td>
<td>
<p>The number of sample size used for the sampling process when dataset is big. Default value is <code>2000</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>knn.k</code></td>
<td>
<p>The value of k of the k-nearest neighbors algorithm. If knn.k is not set then it will be used elbow method to calculate the k.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>...</code></td>
<td>
<p>these arguments will be passed to <code>PerturbationClustering</code> algorithm. See details for more information</p>
</td>
</tr>
</table>
<h3>Details</h3>

<p><code>SubtypingOmicsData</code> implements the Subtyping multi-omic data that are based on Perturbaion clustering algorithm of Nguyen et al (2017), Nguyen et al (2019) and Nguyen, et al. (2021).
The input is  a list of data matrices where each matrix represents the molecular measurements of a data type. The input matrices must have the same number of rows. 
<code>SubtypingOmicsData</code> aims to find the optimum number of subtypes and location of each sample in the clusters from integrated input data <code>dataList</code> through two processing stages:
</p>
<p>1. Stage I: The algorithm first partitions each data type using the function <code>PerturbationClustering</code>.
It then merges the connectivities across data types into similarity matrices.
Both kmeans and similarity-based clustering algorithms - partitioning around medoids <code>pam</code> are used to partition the built similarity.
The algorithm returns the partitioning that agrees the most with individual data types.<br>
2. Stage II: The algorithm attempts to split each discovered group if there is a strong agreement between data types,
or if the subtyping in Stage I is very unbalanced.
</p>
<p>When clustering a large number of samples, this function uses a subsampling technique to reduce the computational complexity with the two parameters <code>sampledSetSize</code> and <code>knn.k</code>. Please consult Nguyen et al. (2021) for details.
</p>


<h3>Value</h3>

<p><code>SubtypingOmicsData</code> returns a list with at least the following components:
</p>
<table>
<tr style="vertical-align: top;">
<td><code>cluster1</code></td>
<td>
<p>A vector of labels indicating the cluster to which each sample is allocated in Stage I</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>cluster2</code></td>
<td>
<p>A vector of labels indicating the cluster to which each sample is allocated in Stage II</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>dataTypeResult</code></td>
<td>
<p>A list of results for individual data type. Each element of the list is the result of the <code>PerturbationClustering</code> for the corresponding data matrix provided in dataList.</p>
</td>
</tr>
</table>
<h3>References</h3>

<p>1. H Nguyen, S Shrestha, S Draghici, &amp; T Nguyen. PINSPlus: a tool for tumor subtype discovery in integrated genomic data. Bioinformatics, 35(16), 2843-2846, (2019).
</p>
<p>2. T Nguyen, R Tagett, D Diaz, S Draghici. A novel method for data integration and disease subtyping. Genome Research, 27(12):2025-2039, 2017.
</p>
<p>3. T. Nguyen, "Horizontal and vertical integration of bio-molecular data", PhD thesis, Wayne State University, 2017.
</p>
<p>4. H Nguyen, D Tran, B Tran, M Roy, A Cassell, S Dascalu, S Draghici &amp; T Nguyen. SMRT: Randomized Data Transformation for Cancer Subtyping and Big Data Analysis. Frontiers in oncology. 2021.
</p>


<h3>See Also</h3>

<p><code>PerturbationClustering</code>
</p>


<h3>Examples</h3>

<pre><code class="language-R">
# Load the kidney cancer carcinoma data
data(KIRC)

# Perform subtyping on the multi-omics data
dataList &lt;- list (as.matrix(KIRC$GE), as.matrix(KIRC$ME), as.matrix(KIRC$MI)) 
names(dataList) &lt;- c("GE", "ME", "MI")
result &lt;- SubtypingOmicsData(dataList = dataList)

# Change Pertubation clustering algorithm's arguments
result &lt;- SubtypingOmicsData(
    dataList = dataList, 
    clusteringMethod = "kmeans", 
    clusteringOptions = list(nstart = 50)
)

# Plot the Kaplan-Meier curves and calculate Cox p-value
library(survival)
cluster1=result$cluster1;cluster2=result$cluster2
a &lt;- intersect(unique(cluster2), unique(cluster1))
names(a) &lt;- intersect(unique(cluster2), unique(cluster1))
a[setdiff(unique(cluster2), unique(cluster1))] &lt;- seq(setdiff(unique(cluster2), unique(cluster1))) 
                                                  + max(cluster1)
colors &lt;- a[levels(factor(cluster2))]
coxFit &lt;- coxph(
 Surv(time = Survival, event = Death) ~ as.factor(cluster2),
 data = KIRC$survival,
 ties = "exact"
)
mfit &lt;- survfit(Surv(Survival, Death == 1) ~ as.factor(cluster2), data = KIRC$survival)
plot(
 mfit, col = colors,
 main = "Survival curves for KIRC, level 2",
 xlab = "Days", ylab = "Survival",lwd = 2
)
legend("bottomright", 
    legend = paste(
        "Cox p-value:", 
        round(summary(coxFit)$sctest[3], digits = 5), 
        sep = ""
    )
)
legend(
    "bottomleft",
    fill = colors,
    legend = paste(
        "Group ",
        levels(factor(cluster2)),": ", table(cluster2)[levels(factor(cluster2))], 
        sep =""
    )
)


</code></pre>


</div>