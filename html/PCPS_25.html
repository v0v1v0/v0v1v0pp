<div class="container">

<table style="width: 100%;"><tr>
<td>pcps</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>Principal Coordinates of Phylogenetic Structure</h2>

<h3>Description</h3>

<p>Function to generate Principal Coordinates of Phylogenetic Structure (PCPS).
</p>


<h3>Usage</h3>

<pre><code class="language-R">pcps(
  comm,
  phylodist,
  checkdata = TRUE,
  method = "bray",
  squareroot = TRUE,
  correlations = TRUE
)

## S3 method for class 'pcps'
plot(
  x,
  groups = NULL,
  choices = c(1, 2),
  display = "text",
  showlabel = TRUE,
  ...
)

## S3 method for class 'pcps'
print(x, ...)

## S3 method for class 'summarypcps'
print(x, ...)

scores.pcps(x, choices = c(1, 2), ...)

## S3 method for class 'pcps'
summary(object, choices = c(1, 2), ...)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>comm</code></td>
<td>
<p>Community data, with species as columns and sampling units as rows. 
This matrix can contain either presence/absence or abundance data.
Alternatively comm can be an object of class metacommunity.data, an alternative
way to set all data.frames/matrices. When you use the class metacommunity.data the argument
phylodist must not be specified. See details.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>phylodist</code></td>
<td>
<p>Matrix containing phylogenetic distances between species.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>checkdata</code></td>
<td>
<p>Logical argument (TRUE or FALSE) to check if species
sequence in the community data follows the same order as the one in the phylodist 
matrix (Default checkdata = TRUE).</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>method</code></td>
<td>
<p>Dissimilarity index, as accepted by <code>vegdist</code> (Default dist="bray").</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>squareroot</code></td>
<td>
<p>Logical argument (TRUE or FALSE) to specify if use square root of 
dissimilarity index (Default squareroot = TRUE).</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>correlations</code></td>
<td>
<p>Logical argument (TRUE or FALSE) to specify if are calculed the correlations
between each PCPS and each species in matrix P (Default correlations = TRUE).</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>x</code></td>
<td>
<p>An object of class pcps.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>groups</code></td>
<td>
<p>Factor giving the groups (Clades) for each species  (Default groups = NULL).</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>choices</code></td>
<td>
<p>Axes for re-scaling. Choices must have length equal to two (Default choices = c(1, 2)).</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>display</code></td>
<td>
<p>Display text or points for the sampling units, partial match to "text" or "points" (Default display = "text").</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>showlabel</code></td>
<td>
<p>Label the groups by their names in the centroid of the object.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>...</code></td>
<td>
<p>Other parameters for the respective functions.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>object</code></td>
<td>
<p>An object of class pcps.</p>
</td>
</tr>
</table>
<h3>Details</h3>

<p>The function obtains a matrix containing phylogeny-weighted species composition 
(<code>matrix.p</code>) and is submitted to principal coordinates analysis (PCoA). 
This method generates the principal coordinates of phylogenetic structure 
(PCPS) (Duarte, 2011).
</p>
<p>The sequence species show up in the community data matrix must be the 
same as they show up in the phylogenetic distance matrix. The 
function <code>organize.pcps</code> organizes the data, placing the matrices of 
community and phylogenetic distance in the same order. The use of  
organize.pcps is not requered for run this function, but is recommended. In this way 
the arguments comm and phylodist can be specified them as normal arguments or by passing
them with the object returned by the function <code>organize.pcps</code> using, in this
case only the argument comm. Using the object returned by organize.pcps, the comm argument 
is used as an alternative way of entering to set all data.frames/matrices, and therefore 
the phylodist argument must not be specified.
</p>
<p>The function summary or the function scores.pcps re-scales the correlation values 
for obtain the scores for <code>biplot</code> graphics. The function plot draws a 
simple biplot and represent clades as "spider" graphs (see <code>ordispider</code>).
</p>


<h3>Value</h3>

<table>
<tr style="vertical-align: top;">
<td><code>P</code></td>
<td>
<p>Phylogeny-weighted species composition matrix.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>values</code></td>
<td>
<p>The eigenvalues, 
relative eigenvalues and cumulative relative eigenvalues.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>vectors</code></td>
<td>
<p>The principal coordinates
of phylogenetic structure (PCPS).</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>correlations</code></td>
<td>
<p>Correlations between a PCPS axis and 
phylogenetically weighted species abundances or frequencies.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>scores</code></td>
<td>
<p>Scores for biplot graphics.</p>
</td>
</tr>
</table>
<h3>Note</h3>

<p><strong>IMPORTANT</strong>: The sequence species show up in the community data matrix MUST be the 
same as they show up in the phylogenetic distance matrix. See details and <code>organize.pcps</code>.
</p>


<h3>Author(s)</h3>

<p>Vanderlei Julio Debastiani &lt;vanderleidebastiani@yahoo.com.br&gt;
</p>


<h3>References</h3>

<p>Duarte, L.S. (2011). Phylogenetic habitat filtering influences forest nucleation 
in grasslands. Oikos, 120, 208:215.
</p>


<h3>See Also</h3>

<p><code>matrix.p</code>, <code>wcmdscale</code>, <code>ordispider</code>, <code>ordilabel</code>
</p>


<h3>Examples</h3>

<pre><code class="language-R">
data(ADRS)
res&lt;-pcps(ADRS$community, ADRS$phylo)
res
summary(res)
summary(res, choices = c(1, 2))$scores
plot(res, display = "text", groups = c(rep("Clade-A", 2), rep("Clade-B", 4)))

</code></pre>


</div>