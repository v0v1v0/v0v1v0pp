<div class="container">

<table style="width: 100%;"><tr>
<td>rqbinom</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>Sampling of overdispersed binomial data with constant overdispersion</h2>

<h3>Description</h3>

<p>rqbinom samples overdispersed binomial data with constant overdispersion from
the beta-binomial distribution such that the quasi-binomial assumption is fulfilled.
</p>


<h3>Usage</h3>

<pre><code class="language-R">rqbinom(n, size, prob, phi)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>n</code></td>
<td>
<p>defines the number of clusters (<code class="reqn">i</code>)</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>size</code></td>
<td>
<p>integer vector defining the number of trials per cluster (<code class="reqn">n_i</code>)</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>prob</code></td>
<td>
<p>probability of success on each trial (<code class="reqn">\pi</code>)</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>phi</code></td>
<td>
<p>dispersion parameter (<code class="reqn">\Phi</code>)</p>
</td>
</tr>
</table>
<h3>Details</h3>

<p>It is assumed that the dispersion parameter (<code class="reqn">\Phi</code>)
is constant for all <code class="reqn">i=1, ... I</code> clusters, such that the variance becomes
</p>
<p style="text-align: center;"><code class="reqn">var(y_i)=\Phi n_i \pi (1-\pi).</code>
</p>

<p>For the sampling <code class="reqn">(a+b)_i</code> is defined as
</p>
<p style="text-align: center;"><code class="reqn">(a+b)_i=(\Phi-n_i)/(1-\Phi)</code>
</p>

<p>where <code class="reqn">a_i=\pi (a+b)_i</code> and <code class="reqn">b_i=(a+b)_i-a_i</code>. Then, the binomial proportions
for each cluster are sampled from the beta distribution
</p>
<p style="text-align: center;"><code class="reqn">\pi_i \sim Beta(a_i, b_i)</code>
</p>

<p>and the numbers of success for each cluster are sampled to be
</p>
<p style="text-align: center;"><code class="reqn">y_i \sim Bin(n_i, \pi_i).</code>
</p>

<p>In this parametrization <code class="reqn">E(\pi_i)=\pi</code> and <code class="reqn">E(y_i)=n_i \pi</code>.
Please note, the quasi-binomial assumption is not in contradiction with
the beta-binomial distribution if all cluster sizes are the same.
</p>


<h3>Value</h3>

<p>a <code>data.frame</code> with two columns (succ, fail)
</p>


<h3>Examples</h3>

<pre><code class="language-R"># Sampling of example data
set.seed(456)
qb_dat1 &lt;- rqbinom(n=10, size=50, prob=0.1, phi=3)
qb_dat1

set.seed(456)
qb_dat2 &lt;- rqbinom(n=3, size=c(40, 50, 60), prob=0.1, phi=3)
qb_dat2


</code></pre>


</div>