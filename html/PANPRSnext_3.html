<div class="container">

<table style="width: 100%;"><tr>
<td>gsfPEN_R</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>Run the gsfPEN algorithm for multiple traits, with functional annotations.</h2>

<h3>Description</h3>

<p>Run the gsfPEN algorithm for multiple traits, with functional annotations.
</p>


<h3>Usage</h3>

<pre><code class="language-R">gsfPEN_R(
  summary_z,
  n_vec,
  plinkLD,
  func_index,
  n_iter = 1000,
  upper_val = NULL,
  breaking = 1,
  z_scale = 1,
  tuning_matrix = NULL,
  p_threshold = NULL,
  p_threshold_params = c(0.5, 10^-4, 4),
  tau_factor = c(1/25, 1, 3),
  sub_tuning = 4,
  lim_lambda = c(0.5, 0.9),
  len_lambda = 4,
  lambda_vec = NULL,
  lambda_vec_limit_len = c(1.5, 3),
  df_max = NULL,
  sparse_beta = FALSE,
  debug_output = FALSE,
  verbose = FALSE
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>summary_z</code></td>
<td>
<p>A matrix of summary statistics for each SNP and trait.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>n_vec</code></td>
<td>
<p>A vector of sample sizes for each of the Q traits corresponding to the Q columns of summary_z.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>plinkLD</code></td>
<td>
<p>A matrix of LD values for each pair of SNPs.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>func_index</code></td>
<td>
<p>A matrix of functional annotations for each SNP and trait. For the element at i-th row, j-th column, the entry 0 means SNP i without j-th functional annotation; entry 1 means otherwise.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>n_iter</code></td>
<td>
<p>The number of iterations to run the algorithm.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>upper_val</code></td>
<td>
<p>The upper bound for the tuning parameter.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>breaking</code></td>
<td>
<p>The number of iterations to run before checking for convergence.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>z_scale</code></td>
<td>
<p>The scaling factor for the summary statistics.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>tuning_matrix</code></td>
<td>
<p>A matrix of tuning parameters.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>p_threshold</code></td>
<td>
<p>A vector of p-values to use for the tuning parameters.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>p_threshold_params</code></td>
<td>
<p>A vector of parameters to use for the p-value tuning parameters.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>tau_factor</code></td>
<td>
<p>A vector of factors to multiply the median value by to get the tuning parameters.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>sub_tuning</code></td>
<td>
<p>The number of tuning parameters to use for the second iteration.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>lim_lambda</code></td>
<td>
<p>The range of tuning parameters to use for the first iteration.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>len_lambda</code></td>
<td>
<p>The number of tuning parameters to use for the second iteration.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>lambda_vec</code></td>
<td>
<p>A vector of tuning parameters to use for the first iteration.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>lambda_vec_limit_len</code></td>
<td>
<p>The number of tuning parameters to use for the first iteration.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>df_max</code></td>
<td>
<p>The maximum degrees of freedom for the model.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>sparse_beta</code></td>
<td>
<p>Whether to use the sparse version of the algorithm.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>debug_output</code></td>
<td>
<p>Whether to output the tuning combinations that did not converge.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>verbose</code></td>
<td>
<p>Whether to output information through the evaluation of the algorithm.</p>
</td>
</tr>
</table>
<h3>Value</h3>

<p>A named list containing the following elements:
beta_matrix: A matrix of the estimated coefficients for each SNP and trait.
num_iter_vec: A vector of the number of iterations for each tuning combination.
all_tuning_matrix: A matrix of the tuning parameters used for each tuning combination.
</p>


<h3>Examples</h3>

<pre><code class="language-R"># Load the library and data
library(PANPRSnext)
data("summaryZ")
data("Nvec")
data("plinkLD")
data("funcIndex")

# Take random subset of the data
subset &lt;- sample(nrow(summaryZ), 100)
subset_summary_z &lt;- summaryZ[subset, ]
subset_func_index &lt;- funcIndex[subset, ]

# Run gsfPEN
output &lt;- gsfPEN_R(
  summary_z = subset_summary_z,
  n_vec = Nvec,
  plinkLD = plinkLD,
  func_index = subset_func_index
)
</code></pre>


</div>