<div class="container">

<table style="width: 100%;"><tr>
<td>PhylogeneticH2</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>Phylogenetic Heritability</h2>

<h3>Description</h3>

<p>The phylogenetic heritability, <code class="reqn">H^2</code>, is defined as the 
ratio of the genetic variance over the total phenotypic variance expected 
at a given evolutionary time t (measured from the root of the tree). Thus,
the phylogenetic heritability connects the parameters alpha, sigma and
sigmae of the POUMM model through a set of equations. The functions
described here provide an R-implementation of these equations.
</p>


<h3>Usage</h3>

<pre><code class="language-R">alpha(H2, sigma, sigmae, t = Inf)

sigmaOU(H2, alpha, sigmae, t = Inf)

sigmae(H2, alpha, sigma, t = Inf)

H2e(z, sigmae, tree = NULL, tFrom = 0, tTo = Inf)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>H2</code></td>
<td>
<p>Phylogenetic heritability at time t.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>sigmae</code></td>
<td>
<p>Numeric, environmental phenotypic deviation at the tips.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>t</code></td>
<td>
<p>Numeric value denoting evolutionary time (i.e. distance from the 
root of a phylogenetic tree).</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>alpha, sigma</code></td>
<td>
<p>Numeric values or n-vectors, parameters of the OU process;
alpha and sigma must be non-negative. A zero alpha is interpreted as the 
Brownian motion process in the limit alpha -&gt; 0.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>z</code></td>
<td>
<p>Numerical vector of observed phenotypes.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>tree</code></td>
<td>
<p>A phylo object.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>tFrom, tTo</code></td>
<td>
<p>Numerical minimal and maximal root-tip distance to limit the
calculation.</p>
</td>
</tr>
</table>
<h3>Details</h3>

<p>The function sigmae uses the formula H2 = varOU(t, alpha, sigma) /
(varOU(t, alpha, sigma) + sigmae^2)
</p>


<h3>Value</h3>

<p>All functions return numerical values or NA, in case of invalid 
parameters
</p>


<h3>Functions</h3>


<ul>
<li> <p><code>alpha</code>: Calculate alpha given time t, H2, sigma and sigmae
</p>
</li>
<li> <p><code>sigmaOU</code>: Calculate sigma given time t, H2 at time t, alpha
and sigmae
</p>
</li>
<li> <p><code>sigmae</code>: Calculate sigmae given alpha, sigma, and H2 at
time t
</p>
</li>
<li> <p><code>H2e</code>: "Empirical" phylogenetic heritability estimated
from the empirical variance of the observed phenotypes and sigmae
</p>
</li>
</ul>
<h3>Note</h3>

<p>This function is called sigmaOU and not simply sigma to avoid a conflict 
with a function sigma in the base R-package.
</p>


<h3>See Also</h3>

<p>OU
</p>


<h3>Examples</h3>

<pre><code class="language-R"># At POUMM stationary state (equilibrium, t=Inf)
H2 &lt;- H2(alpha = 0.75, sigma = 1, sigmae = 1, t = Inf)     # 0.4
alpha &lt;- alpha(H2 = H2, sigma = 1, sigmae = 1, t = Inf)    # 0.75
sigma &lt;- sigmaOU(H2 = H2, alpha = 0.75, sigmae = 1, t = Inf) # 1
sigmae &lt;- sigmae(H2 = H2, alpha = 0.75, sigma = 1, t = Inf) # 1

# At finite time t = 0.2
H2 &lt;- H2(alpha = 0.75, sigma = 1, sigmae = 1, t = 0.2)     # 0.1473309
alpha &lt;- alpha(H2 = H2, sigma = 1, sigmae = 1, t = 0.2)    # 0.75
sigma &lt;- sigmaOU(H2 = H2, alpha = 0.75, sigmae = 1, t = 0.2) # 1
sigmae &lt;- sigmae(H2  =  H2, alpha = 0.75, sigma = 1, t = 0.2) # 1

   
</code></pre>


</div>