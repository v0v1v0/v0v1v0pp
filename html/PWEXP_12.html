<div class="container">

<table style="width: 100%;"><tr>
<td>plot_event</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>Plot Cumulative Event Curve</h2>

<h3>Description</h3>

<p>Plot cumulative event curve with right censoring data.
</p>


<h3>Usage</h3>

<pre><code class="language-R">## Default S3 method:
plot_event(time, event, abs_time=TRUE, additional_event=0,
         add=FALSE, plot=TRUE, xyswitch=FALSE, ...)
## S3 method for class 'predict.pwexp.fit'
plot_event(time, abs_time=TRUE, add=TRUE, plot=TRUE,
         xyswitch=FALSE, eval_at=NULL, ...)
## S3 method for class 'predict.boot.pwexp.fit'
plot_event(time, abs_time=TRUE, alpha=0.1, type='confidence',
         add=TRUE, plot=TRUE, xyswitch=FALSE, eval_at=NULL,
         show_CI=TRUE, CI_par=NULL, ...)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>time</code></td>
<td>
<p>observed/follow-up time from individual randomization time (<code>abs_time=FALSE</code>) or from the first subject randomization time (<code>abs_time=TRUE</code>); or a predicted object from <code>predict.pwexp.fit</code>, or a predicted object with bootstrapping  from <code>predict.boot.pwexp.fit</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>abs_time</code></td>
<td>
<p>logical; if TRUE, <code>time</code> is the time from first randomization of the trial. if FALSE, <code>time</code> is the time from the randomization of each subject. </p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>event</code></td>
<td>
<p>the status indicator, 0=censor, 1=event. Other choices are TRUE/FALSE (TRUE = event).</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>additional_event</code></td>
<td>
<p>adding the cumulative number of events by a constant number from the beginning. </p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>add</code></td>
<td>
<p>logical; if TRUE add lines to current plot.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>plot</code></td>
<td>
<p>logical; if FALSE, do not plot any lines, but return the line data</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>xyswitch</code></td>
<td>
<p>logical; if TRUE, x-axis will be cumulative number of events and y will be the time.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>eval_at</code></td>
<td>
<p>a vector of the time (when <code>xyswitch=FALSE</code>) or the number of events (when <code>xyswitch=TRUE</code>) that you want to make prediction on. </p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>alpha</code></td>
<td>
<p>the significance level of the confidence interval.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>type</code></td>
<td>
<p>the type of prediction required. The default <code>confidence</code> returns the confidence interval without random error; the alternative <code>predictive</code> returns the predictive interval.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>show_CI</code></td>
<td>
<p>logical; if TRUE add confidence interval of the estimated event curve. </p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>CI_par</code></td>
<td>
<p>a list of parameters to control the apperance of lines of confidence intervals. The values pass to <code>lines</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>...</code></td>
<td>
<p>other arguments (e.g., <code>lwd</code>, etc.) are passed over to <code>plot.</code></p>
</td>
</tr>
</table>
<h3>Details</h3>

<p>A convenient function to calculate and plot the cumulative number of events.
</p>
<p>Parameters in <code>...</code> are passed to <code>plot</code> function to control the appearance of the event curve; parameters in <code>CI_par</code> are passed to <code>lines</code> function to control the appearance of confidence intervals. See examples for usage.
</p>
<p>By default, <code>plot_event</code> plots a data frame in a new figure; and plots a predicted model in existing figure.
</p>


<h3>Value</h3>

<p>A data frame containing these columns:
</p>
<table>
<tr style="vertical-align: top;">
<td><code>time</code></td>
<td>
<p>sorted time</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>n_event</code></td>
<td>
<p>cumulative number of events</p>
</td>
</tr>
</table>
<h3>Author(s)</h3>

<p>Tianchen Xu <a href="mailto:zjph602xutianchen@gmail.com">zjph602xutianchen@gmail.com</a>
</p>


<h3>See Also</h3>

<p><code>plot_survival</code></p>


<h3>Examples</h3>

<pre><code class="language-R">set.seed(1818)
event_dist &lt;- function(n)rpwexp(n, rate = c(0.1, 0.01, 0.2), breakpoint =  c(5,14))
dat &lt;- simdata(rand_rate = 20, drop_rate = 0.03,  total_sample = 1000,
               advanced_dist = list(event_dist=event_dist),
               add_column = c('censor_reason','event','followT','followT_abs'))
cut &lt;- quantile(dat$randT, 0.8)
train &lt;- cut_dat(var_randT = 'randT', cut = cut, data = dat,
                 var_followT = 'followT', var_followT_abs = 'followT_abs',
                 var_event = 'event', var_censor_reason = 'censor_reason')

fit_res3 &lt;- pwexp.fit(train$followT, train$event, nbreak = 2)
fit_res_boot &lt;- boot.pwexp.fit(fit_res3, nsim = 8) # here nsim=8 is for demo purpose,
                                                    # pls increase it in practice

drop_indicator &lt;-  ifelse(train$censor_reason=='drop_out' &amp; !is.na(train$censor_reason),1,0)
fit_res_censor &lt;- pwexp.fit(train$followT, drop_indicator, nbreak = 0)
fit_res_censor_boot &lt;- boot.pwexp.fit(fit_res_censor, nsim = 8)

cut_indicator &lt;- train$censor_reason=='cut'
cut_indicator[is.na(cut_indicator)] &lt;- 0

predicted_boot &lt;- predict(fit_res_boot, cut_indicator = cut_indicator,
                     analysis_time = cut,  censor_model_boot=fit_res_censor_boot,
                     future_rand=list(rand_rate=20, total_sample=NROW(dat)-NROW(train)))

plot_event(dat$followT_abs, abs_time = TRUE, event=dat$event, ylim=c(0,800))
plot_event(predicted_boot, eval_at = seq(40,90,5), CI_par = list(lty=3, lwd=2))

plot_event(dat$followT_abs, xlim=c(0,800), event=dat$event, xyswitch = TRUE)
plot_event(predicted_boot, xyswitch = TRUE, eval_at = seq(600,900,50))
</code></pre>


</div>