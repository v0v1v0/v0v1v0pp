<div class="container">

<table style="width: 100%;"><tr>
<td>maxamp</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>Calculate maximal amplification</h2>

<h3>Description</h3>

<p>Calculate maximal amplification for a population matrix projection model.
</p>


<h3>Usage</h3>

<pre><code class="language-R">maxamp(
  A,
  vector = "n",
  return.N = FALSE,
  return.t = FALSE,
  return.stage = FALSE,
  conv.iterations = 1e+05,
  conv.accuracy = 1e-05
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>A</code></td>
<td>
<p>a square, primitive, non-negative numeric matrix of any dimension</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>vector</code></td>
<td>
<p>(optional) a numeric vector or one-column matrix describing 
the age/stage distribution ('demographic structure') used to calculate a 
'case-specific' maximal amplification.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>return.N</code></td>
<td>
<p>(optional) if <code>TRUE</code>, returns population size at the 
point of maximal amplification (including effects of asymptotic growth and 
initial population size), alongside standardised maximal amplification.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>return.t</code></td>
<td>
<p>(optional) if <code>TRUE</code>, returns the time at which maximal 
amplification occurs in the population projection.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>return.stage</code></td>
<td>
<p>(optional) if <code>TRUE</code> and <code>vector="n"</code>, returns 
the stage that achieves the bound on maximal amplification.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>conv.iterations</code></td>
<td>
<p>the maximum number of iterations allowed when calulating 
convergence time (see details). Please see <code>iterations</code> in 
<code>convt</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>conv.accuracy</code></td>
<td>
<p>the accuracy of convergence (see details). Please see 
<code>accuracy</code> in <code>convt</code>.</p>
</td>
</tr>
</table>
<h3>Details</h3>

<p><code>maxamp</code> returns a standardised measure of maximal amplification, 
discounting the effects of both initial population size and asymoptotic growth 
(Stott et al. 2011).
</p>
<p>If <code>vector</code> is not specified then the bound on maximal amplification (the 
largest maximal amplification that may be achieved) is returned, otherwise a 
'case-specific' maximal amplification for the specified matrix and demographic 
structure is calculated. Note that not all demographic structures will yield a 
maximal amplification: if the model does not amplify then an error is returned.
</p>
<p>Setting <code>return.N=T</code>, <code>return.t=T</code> and <code>return.stage=T</code> results in 
the function returning realised population size at maximal amplification 
(including the effects of asymptotic growth and initial population size), the 
time at which maximal amplification occurs and (if <code>vector="n"</code>), 
the stage-bias that results in the bound on maximal amplification, respectively.
NOTE that <code>N</code> is not indicative of maximum possible population size for a 
non-standardised model: merely the population size at the point of maximal 
amplification (i.e. largest positive deviation from lambda-max).
</p>
<p><code>max.amp</code> uses a simulation technique, using <code>project</code> to project 
the dynamics of the model before evaluating maximum projected density over all t. 
<code>conv.accuracy</code> and <code>conv.iterations</code> are passed to 
<code>convt</code>, which is used to find the point of model convergence 
in order to ensure maximal amplification is correctly captured in model projection.
</p>
<p><code>maxamp</code> will not work for imprimitive or reducible matrices.
</p>


<h3>Value</h3>

<p>If <code>vector="n"</code>, the bound on maximal amplification of <code>A</code>.<br>
If <code>vector</code> is specified, the case-specific maximal amplification of the model.<br>
If <code>return.N=TRUE</code>, <code>return.t=TRUE</code> and/or <code>return.stage=TRUE</code>,
a list with possible components:<br></p>

<dl>
<dt>maxamp</dt>
<dd>
<p>the bound on or case-specific maximal amplification</p>
</dd>
<dt>N</dt>
<dd>
<p>the population size at the point of maximal amplification, including the 
effects of initial population size and asymptotic growth. NOTE that <code>N</code> is not 
indicative of maximum possible population size for a non-standardised model:
merely the population size at the point of maximal amplification (i.e. largest 
positive deviation from lambda-max).</p>
</dd>
<dt>t</dt>
<dd>
<p>the projection interval at which maximal amplification is achieved.</p>
</dd>
<dt>stage</dt>
<dd>
<p>(only if <code>vector="n"</code>), the stage that achieves the bound on 
maximal amplification.</p>
</dd>
</dl>
<h3>References</h3>


<ul>
<li>
<p> Neubert &amp; Caswell (1997) Ecology, 78, 653-665.
</p>
</li>
<li>
<p> Stott et al. (2011) Ecol. Lett., 14, 959-970.
</p>
</li>
<li>
<p> Townley &amp; Hodgson (2008) J. Appl. Ecol., 45, 1836-1839.
</p>
</li>
</ul>
<h3>See Also</h3>

<p>Other TransientIndices: 
<code>Kreiss()</code>,
<code>inertia()</code>,
<code>maxatt()</code>,
<code>reac()</code>
</p>


<h3>Examples</h3>

<pre><code class="language-R">  # Create a 3x3 PPM
  ( A &lt;- matrix(c(0,1,2,0.5,0.1,0,0,0.6,0.6), byrow=TRUE, ncol=3) )

  # Create an initial stage structure
  ( initial &lt;- c(1,3,2) )

  # Calculate the bound on maximal amplification of A
  maxamp(A)

  # Calculate the bound on maximal amplification of A and 
  # return the stage that achieves it
  maxamp(A, return.stage=TRUE)

  # Calculate case-specific maximal amplification of A
  # and initial
  maxamp(A, vector=initial)

  # Calculate case-specific maximal amplification of A
  # and initial and return realised population size and the 
  # time at which it is achieved
  maxamp(A, vector=initial, return.N=TRUE, return.t=TRUE)

</code></pre>


</div>