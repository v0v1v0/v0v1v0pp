<div class="container">

<table style="width: 100%;"><tr>
<td>taxa2phylo</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>Convert Simulated Taxon Data into a Phylogeny</h2>

<h3>Description</h3>

<p>Converts temporal and ancestor-descendant relationships of taxa into a
dated phylogeny with tips at instantaneous points in time.
</p>


<h3>Usage</h3>

<pre><code class="language-R">taxa2phylo(taxaData, obs_time = NULL, plot = FALSE)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>taxaData</code></td>
<td>
<p>A five-column matrix of taxonomic data,
as output by <code>fossilRecord2fossilTaxa</code> via simulations
produced using <code>simFossilRecord</code>. Previously, this was the
default output of the deprecated function <code>simFossilTaxa</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>obs_time</code></td>
<td>
<p>A vector of per-taxon times of observation which must be in
the same order of taxa as in the object <code>taxaData</code>. 
If <code>obs_time = NULL</code>, the LADs (column 4) in <code>taxaData</code> are used.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>plot</code></td>
<td>
<p>If <code>TRUE</code> result the output with <code>ape::plot.phylo</code>.</p>
</td>
</tr>
</table>
<h3>Details</h3>

<p>As described in the documentation for <code>taxa2cladogram</code>, the relationships
among morphotaxa in the fossil record are difficult to describe in terms of
traditional phylogenies. One possibility is to arbitrarily choose particular
instantaneous points of time in the range of some taxa and describe the
temporal relationships of the populations present at those dates. This is
the tactic used by <code>taxa2phylo</code>.
</p>
<p>By default, the dates selected (the <code>obs_time</code> argument) are the last occurrences
of the taxon, so a simple use of this function will produce a dated
tree which describes the relationships of the populations present at the
last occurrence time of each taxon in the sampled data. 
Alternatively, <code>obs_time</code> can be supplied with different dates within the taxon ranges.
</p>
<p>All data relating to when static morphotaxa appear or disappear in the
record is lost. Branching points will be the actual time of speciation,
which (under budding) will often be in the middle of the temporal range of a
taxon.
</p>
<p>Cryptic taxa are not dropped or merged as can be done with <code>taxa2cladogram</code>.
The purpose of <code>taxa2phylo</code> is to obtain the 'true' pattern of evolution for
the observation times, independent of what we might actually be able to
recover, for the purpose of comparing in simulation analyses.
</p>
<p>As with many functions in the <code>paleotree</code> library, absolute time is always
decreasing, i.e. the present day is zero.
</p>


<h3>Value</h3>

<p>The resulting phylogeny with branch lengths is output as an object
of class <code>phylo</code>. This function will output trees with the element <code>$root.time</code>,
which is the time of the root divergence in absolute time.
</p>
<p>The tip labels are the row-names from the simulation input; see the documentation
for <code>simFossilRecord</code> and <code>fossilRecord2fossilTaxa</code> for details.
</p>


<h3>Note</h3>

<p>Do <em>NOT</em> use this function to date a real tree for a real dataset.
It assumes you know the divergence/speciation times of the branching nodes
and relationships perfectly, which is almost impossible given the
undersampled nature of the fossil record. Use <code>timePaleoPhy</code> or
<code>cal3TimePaleoPhy</code> instead.
</p>
<p>Do use this function when doing simulations and you want to make a tree of
the 'true' history, such as for simulating trait evolution along
phylogenetic branches.
</p>
<p>Unlike <code>taxa2cladogram</code>, this function does not merge cryptic taxa in output
from <code>simFossilRecord</code> (via <code>fossilRecord2fossilTaxa</code>)
and I do not offer an option to secondarily drop them.
The tip labels should provide the necessary information for users to drop
such taxa, however. See <code>simFossilRecord</code>.
</p>


<h3>Author(s)</h3>

<p>David W. Bapst
</p>


<h3>See Also</h3>

<p><code>simFossilRecord</code>,
<code>taxa2cladogram</code>, fossilRecord2fossilTaxa
</p>


<h3>Examples</h3>

<pre><code class="language-R">
set.seed(444)
record &lt;- simFossilRecord(
   p = 0.1, 
   q = 0.1, 
   nruns = 1,
   nTotalTaxa = c(30,40), 
   nExtant = 0
   )
taxa &lt;- fossilRecord2fossilTaxa(record)
# let's use taxa2cladogram to get the 'ideal' cladogram of the taxa
tree &lt;- taxa2phylo(taxa)
phyloDiv(tree)

# now a phylogeny with tips placed at
   # the apparent time of extinction for each taxon
rangesCont &lt;- sampleRanges(taxa,r = 0.5)
tree &lt;- taxa2phylo(taxa,obs_time = rangesCont[,2])
phyloDiv(tree,drop.ZLB = FALSE)
#note that it drops taxa which were never sampled!

#testing with cryptic speciation
set.seed(444)
record &lt;- simFossilRecord(
   p = 0.1, 
   q = 0.1, 
   prop.cryptic = 0.5, 
   nruns = 1,
   nTotalTaxa = c(30,40), 
   nExtant = 0, 
   count.cryptic = TRUE
   )
taxaCrypt &lt;- fossilRecord2fossilTaxa(record)
treeCrypt &lt;- taxa2phylo(taxaCrypt)
layout(1)
plot(treeCrypt)
axisPhylo()

</code></pre>


</div>