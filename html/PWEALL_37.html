<div class="container">

<table style="width: 100%;"><tr>
<td>rmstutil</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>A utility function to calculate the true restricted mean survival time (RMST) and its variance
account for delayed treatment, discontinued treatment and non-uniform entry</h2>

<h3>Description</h3>

<p>A utility function to calculate the true restricted mean survival time (RMST) and its variance
account for delayed treatment, discontinued treatment and non-uniform entry</p>


<h3>Usage</h3>

<pre><code class="language-R">rmstutil(tcut=2.0,tstudy=5.0,taur=5,u=c(1/taur,1/taur),ut=c(taur/2,taur),
        rate1=c(1,0.5),rate2=rate1,rate3=c(0.7,0.4),
        rate4=rate2,rate5=rate2,ratec=c(0.5,0.6),
        tchange=c(0,1),type=1,rp2=0.5,
        eps=1.0e-2,veps=1.0e-2)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>tcut</code></td>
<td>
<p>time point at which rmst is calculated</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>tstudy</code></td>
<td>
<p>the study time point from first patient in, it must be not smaller than <code>tcut</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>taur</code></td>
<td>
<p>Recruitment time</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>u</code></td>
<td>
<p>Piecewise constant recuitment rate</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>ut</code></td>
<td>
<p>Recruitment intervals</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>rate1</code></td>
<td>
<p>piecewise constant event rate before crossover</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>rate2</code></td>
<td>
<p>piecewise constant event rate after crossover</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>rate3</code></td>
<td>
<p>piecewise constant event rate for crossover</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>rate4</code></td>
<td>
<p>additional piecewise constant event rate for more complex crossover</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>rate5</code></td>
<td>
<p>additional piecewise constant event rate for more complex crossover</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>ratec</code></td>
<td>
<p>Hazard for time to censoring</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>tchange</code></td>
<td>
<p>a strictly increasing sequence of time points starting from zero at which event rate changes. The first element of tchange must be zero. The above rates <code>rate1</code> to <code>ratec</code> and tchange must have the same length.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>type</code></td>
<td>
<p>type of crossover, 1=markov, 2=semi-markov, 3=hybrid</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>rp2</code></td>
<td>
<p>re-randomization probability to receive the rescue treatment when semi-markov crossover occurs.
When it happens, the overall hazard will be rp2*r2(t-s)+(1-rp2)*r4(t), where r2 is the hazard 
for the semi-markov rescue treatment and r4 is hazard for the markov rescue treatment.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>eps</code></td>
<td>
<p>A small number representing the error tolerance when calculating the utility function
</p>
<p style="text-align: center;"><code class="reqn">\Phi_l(x)=\frac{\int_0^x s^l e^{-s}ds}{x^{l+1}}</code>
</p>
<p> with <code class="reqn">l=0,1,2</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>veps</code></td>
<td>
<p>A small number representing the error tolerance when calculating the variance.</p>
</td>
</tr>
</table>
<h3>Details</h3>

<p>More details</p>


<h3>Value</h3>

<table>
<tr style="vertical-align: top;">
<td><code>tcut</code></td>
<td>
<p>time point at which rmst is calculated</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>tstudy</code></td>
<td>
<p>the study time point from first patient in, it must be not smaller than <code>tcut</code></p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>rmst</code></td>
<td>
<p>rmst at cut-point <code>tcut</code></p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>var</code></td>
<td>
<p>the variance of <code>rmst</code></p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>vadd</code></td>
<td>
<p>the additional variance term of <code>rmst</code></p>
</td>
</tr>
</table>
<h3>Note</h3>

<p>This calculates the "true" variance of restricted mean survival times</p>


<h3>Author(s)</h3>

<p>Xiaodong Luo</p>


<h3>References</h3>

<p>Luo et al. (2018) Design and monitoring of survival trials in complex scenarios, Statistics in Medicine &lt;doi: https://doi.org/10.1002/sim.7975&gt;.
</p>


<h3>Examples</h3>

<pre><code class="language-R">r1&lt;-c(0.6,0.3)
r2&lt;-c(0.6,0.6)
r3&lt;-c(0.1,0.2)
r4&lt;-c(0.5,0.4)
r5&lt;-c(0.4,0.5)
rc&lt;-c(0.1,0.1)
rmt&lt;-rmstutil(tcut=2.0,tstudy=5.0,taur=5,
        rate1=r1,rate2=r2,rate3=r3,
        rate4=r4,rate5=r5,ratec=rc,
        tchange=c(0,1),type=1,rp2=0.5,
        eps=1.0e-2,veps=1.0e-2)
rmt
</code></pre>


</div>