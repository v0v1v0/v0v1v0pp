<div class="container">

<table style="width: 100%;"><tr>
<td>pspline.kffobi</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>P-Spline smoothed functional PCA/ICA</h2>

<h3>Description</h3>

<p>This function is an alternative way of computing the smoothed functional ICA in terms of principal components (see <code>kffobi</code>). The function further provides smoothed (and non-smoothed) functional PCA estimates. A discrete penalty  that measures the roughness of principal factors by summing squared <em>r</em>-order differences between adjacent B-spline coefficients (P-spline penalty) is used; see Aguilera and Aguilera-Morillo (2013) and Eliers and Marx (2021).</p>


<h3>Usage</h3>

<pre><code class="language-R">pspline.kffobi(fdx, ncomp = fdx$basis$nbasis, pp = 0, r = 2,
               w = c("PCA", "PCA-cor","ZCA", "ZCA-cor","Cholesky"),
               pr = c("fdx", "wfdx", "KL", "wKL"),
               center = TRUE)</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>fdx</code></td>
<td>
<p>a functional data object obtained from the <strong>fda</strong> package.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>ncomp</code></td>
<td>
<p>number of independent components to compute (must be &gt; 1).</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>pp</code></td>
<td>
<p>the penalty parameter. It can be estimated using <em>leave-one-out</em> cross-validation.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>r</code></td>
<td>
<p>a number indicating the order of the penalty.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>w</code></td>
<td>
<p>the whitening procedure. By default <code>ZCA</code> (Mahalanobis whitening) is used.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>pr</code></td>
<td>
<p>the functional data object to project on to the space spanned by the eigenfunctions of the kurtosis kernel function.  To compute the independent components, the usual procedure is to use <code>wKL</code>, the whitened principal component expansion. If <code>pr</code> is not supplied, then <code>wKL</code> is used. Note that <code>w</code> stands for whitened, e.g., <code>wfdx</code> is the whitened original data.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>center</code></td>
<td>
<p>a logical value indicating whether the mean function has to be subtracted from each functional observation.</p>
</td>
</tr>
</table>
<h3>Value</h3>

<p>a list with the following named entries:
</p>
<table>
<tr style="vertical-align: top;">
<td><code>PCA.eigv</code></td>
<td>
<p>a numeric vector giving the eigenvalues of the covariance kernel function.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>PCA.basis</code></td>
<td>
<p>a functional data object for the eigenfunctions of the covariance kernel function.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>PCA.scores</code></td>
<td>
<p>a matrix whose column vectors are the principal components.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>ICA.eigv</code></td>
<td>
<p>a numeric vector giving the eigenvalues of the kurtosis kernel function.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>ICA.eigv</code></td>
<td>
<p>a numeric vector giving the eigenvalues of the kurtosis kernel function.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>ICA.scores</code></td>
<td>
<p>a matrix whose column vectors are the projection coefficients for <code>fdx, wfdx, KL</code> or <code>wKL</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>wKL</code></td>
<td>
<p>the whitened principal components expansion whith coefficients in terms of basis functions.</p>
</td>
</tr>
</table>
<h3>Author(s)</h3>

<p>Marc Vidal, Ana Mª Aguilera</p>


<h3>References</h3>

<p>Aguilera, A.M. and M.C. Aguilera-Morillo (2013). <em>Penalized PCA approaches for B-spline expansions of smooth functional data.</em> Applied Mathematics and Computation 219(14), 7805–7819, &lt;doi:10.1016/j.amc.2013.02.009&gt;.
</p>
<p>Eilers, P. and B. Marx (2021). <em>Practical Smoothing: The Joys of P-splines.</em> Cambridge: Cambridge University Press, &lt;doi:10.1017/9781108610247&gt;.
</p>
<p>Vidal, M., M. Rosso and A.M. Aguilera. (2021). <em>Bi-Smoothed Functional Independent Component Analysis for EEG Artifact Removal</em>. Mathematics 9(11), 1243, &lt;doi:10.3390/math9111243&gt;.
</p>


<h3>See Also</h3>

<p><code>kffobi</code>, <code>whiten.fd</code></p>


<h3>Examples</h3>

<pre><code class="language-R">## Canadian Weather data
library(fda)
arg &lt;- 1:365
Temp &lt;- CanadianWeather$dailyAv[,,1]
B &lt;- create.bspline.basis(rangeval=c(min(arg),max(arg)), nbasis=14)
x &lt;- Data2fd(Temp, argvals = arg, B)
#plot(x) #plot data
ica.fd &lt;- pspline.kffobi(x, 2, pp = 10^4, w="ZCA-cor")

## Whitened data using the two first smoothed principal components
wKL &lt;- ica.fd$wKL

## Plot by region
sc &lt;- ica.fd$ICA.scores
plot(sc[,2], sc[,1], pch = 20, col = factor(CanadianWeather$region),
     ylab = "IC 1", xlab = "IC 2")
</code></pre>


</div>