<div class="container">

<table style="width: 100%;"><tr>
<td>parmaf</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>
PARMA coefficients estimation
</h2>

<h3>Description</h3>

<p>Procedure <code>parmaf</code> enables the estimation of parameters of the chosen representation of PARMA(p,q) model. For general PARMA we use non-linear 
optimization methods to obtain minimum of negative logarithm of likelihood function using <code>loglikef</code> procedure. Intitial values of parameters are computed using Yule-Walker equations.
</p>


<h3>Usage</h3>

<pre><code class="language-R">parmaf(x, T_t, p, q, af, bf, ...)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>x</code></td>
<td>

<p>input time series.
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>T_t</code></td>
<td>

<p>period length of PC-T structure.
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>p</code></td>
<td>

<p>maximum PAR order, which is a number of columns in <code>af</code>.
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>q</code></td>
<td>

<p>maximum PMA order, which is a number of columns in <code>bf</code> diminished by 1.
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>af</code></td>
<td>

<p><code class="reqn">T \times p</code> logical values matrix pointing to active frequency 
components for <code>phi</code>.
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>bf</code></td>
<td>

<p><code class="reqn">T \times (q+1)</code> logical matrix pointing to active frequency 
components for <code>theta</code>.
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>...</code></td>
<td>

<p>Other arguments:<br><code>a0</code> starting value for <code>a</code>, where <code>a</code> is Fourier representation of
<code>phi</code> (use <code>phi=ab2phth(a)</code> to recover <code>phi</code>);
if <code>a0</code> is not defined Yule Walker method is used to estimate it;<br><code>b0</code> starting values for <code>b</code>, where <code>b</code> is Fourier representation of
<code>theta</code> (use <code>del=ab2phth(b[,1])</code> 
to recover <code>del</code> and use <code>theta = ab2phth(b[,2:q+1])</code> to recover 
<code>theta</code>);
if <code>b0</code> is not defined Yule Walker method is used to estimate it;<br><code>stype</code>  numeric parameter connected with covariance matrix computation, so far should be equal to 0 to use procedure 
<code>R_w_ma</code> (see <code>R_w_ma</code> description). In the future also other values of <code>stype</code> will be available for 
full covariance matrix computation. 
</p>
</td>
</tr>
</table>
<h3>Details</h3>

<p>In order to obtain maximum likelihood estimates of model parameters <code>a</code> and <code>b</code>
we use a numerical optimization method to minimalize value of <code>y</code> (as negative value of logarithm of loglikelihood function returned by <code>loglikef</code>) 
over parameter values. Internally, parameters <code>a</code> and <code>b</code> are
converted to <code>phi</code>  and <code>theta</code> as needed via function 
<code>ab2phth</code>. For the present we use <code>optim</code> function with defined <code>method="BFGS"</code> (see code for more details). 
</p>


<h3>Value</h3>

<p>list of values:
</p>
<table>
<tr style="vertical-align: top;">
<td><code>a</code></td>
<td>
<p>is matrix of Fourier coefficients determining <code>phi</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>b</code></td>
<td>
<p>is matrix of Fourier corfficients determining <code>theta</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>negloglik</code></td>
<td>
<p>minimum value of negative logarithm of likehood function.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>aicval</code></td>
<td>
<p>value of AIC criterion.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>fpeval</code></td>
<td>
<p>value of FPE criterion.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>bicval</code></td>
<td>
<p>value of BIC criterion.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>resids</code></td>
<td>
<p>series of residuals.</p>
</td>
</tr>
</table>
<h3>Author(s)</h3>

<p>Harry Hurd 
</p>


<h3>References</h3>

<p>Box, G. E. P., Jenkins, G. M., Reinsel, G. (1994), Time Series Analysis, 3rd Ed., Prentice-Hall, Englewood Cliffs, NJ.
<br><br>
Brockwell, P. J., Davis, R. A., (1991), Time Series: Theory and Methods, 2nd Ed., Springer: New York.
<br><br>
Jones, R., Brelsford, W., (1967), Time series with periodic structure, Biometrika 54, 403-408.
<br><br>
Vecchia, A., (1985), Maximum Likelihood Estimation for Periodic Autoregressive Moving Average Models, Technometrics, v. 27, pp.375-384.
</p>


<h3>See Also</h3>

<p><code>loglikef</code>, <code>perYW</code>,  <code>R_w_ma</code>,   
</p>


<h3>Examples</h3>

<pre><code class="language-R">
######## simulation of periodic series
T=12
nlen=480
p=2
 a=matrix(0,T,p)
q=1
 b=matrix(0,T,q)
a[1,1]=.8                 
a[2,1]=.3                
                                                 
a[1,2]=-.9               
phia&lt;-ab2phth(a) 
phi0=phia$phi            
phi0=as.matrix(phi0)       
      
b[1,1]=-.7	          
b[2,1]=-.6                  
thetab&lt;-ab2phth(b)       
theta0=thetab$phi  
theta0=as.matrix(theta0) 
del0=matrix(1,T,1)        
makeparma_out&lt;-makeparma(nlen,phi0,theta0,del0)                      
y=makeparma_out$y

## Do not run 
## It could take more than one minute


############ fitting of PARMA(0,1) model
p=0
q=1
af=matrix(0,T,p)
bf=matrix(0,T,q+1)
bf[1,1]=1
bf[1:3,2]=1

parmaf(y,T,p,q,af,bf)

########### fitting of PARMA(2,0) model
p=2
q=0
af=matrix(0,T,p)
bf=matrix(0,T,q+1)
af[1:3,1]=1       
af[1:3,2]=1
bf[1,1]=1
parmaf(y,T,p,q,af,bf)
############ fitting of PARMA(2,1) model
p=2
q=1
af=matrix(0,T,p)
bf=matrix(0,T,q+1)
af[1:3,1]=1       
af[1:3,2]=1
bf[1,1]=1
bf[1:3,2]=1
parmaf(y,T,p,q,af,bf)

</code></pre>


</div>