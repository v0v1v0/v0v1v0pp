<div class="container">

<table style="width: 100%;"><tr>
<td>gv.model</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>
Fit a model to the semi-variogram.
</h2>

<h3>Description</h3>

<p>Fits a model to a semi-variogram contructed with
<code>gen.variogram</code>. Parameters for each model are estimated by
nonlinear least squares.
</p>


<h3>Usage</h3>

<pre><code class="language-R">gv.model(gv, model='spherical', sill = NA, range=NA, nugget = 0,
         ctrl=nls.control())
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>gv</code></td>
<td>

<p>'gv' object from the <code>gen.variogram</code> function.
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>model</code></td>
<td>

<p>Model to fit the data. Available models are spherical (default),
gaussian, exponential or linear. See details.
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>sill</code></td>
<td>

<p>The heigth (semi-variance) of the model when it stabilizes. Defaults to
NA.
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>range</code></td>
<td>

<p>The length (real distance) where stabilization occurs. Defaults to NA.
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>nugget</code></td>
<td>

<p>Intercept in the y-axis. Defaults to 0.
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>ctrl</code></td>
<td>

<p>Nls control object for the fitting procedure. (check ?nls.control for more
details).
</p>
</td>
</tr>
</table>
<h3>Details</h3>

<p>This function fits a model to the data, either by estimating the model
parameters using nonlinear least squares or by user provided values.
Notice that parameters with NA will be estimated by the nls function
and parameters with values given are not estimated (by default, the
nugget is not estimated and set to zero).
The variogram model can be plotted using 'plot' function or used to predict
to a new set of values using 'predict'. It is used to define weights for
the krigging interpolation.
</p>
<p>The parameters of the semi-variogram model (<code class="reqn">\gamma</code>) are the
distance (<code class="reqn">h</code>), range (<code class="reqn">a</code>), sill (<code class="reqn">c = c_0 + c_1</code>;
where <code class="reqn">c_1</code> is the partial sill), and nugget
(<code class="reqn">c_0</code>).
The models available are:
</p>

<ol>
<li>
<p>gaussian:
</p>
<p style="text-align: center;"><code class="reqn">\gamma(h) = c_0 + c_1 \left(1-exp\left(-3\frac{h^2}
              {a^2}\right)\right)</code>
</p>

</li>
<li>
<p>exponential:
</p>
<p style="text-align: center;"><code class="reqn">\gamma(h) = c_0 + c_1 \left(1-exp\left(-\frac{3h}{a}
              \right)\right)</code>
</p>

</li>
<li>
<p>spherical:
</p>
<p style="text-align: center;"><code class="reqn"> \gamma(h) = \left\{
                \begin{array}{ll}
                c_0 + c_1\left(\frac{3}{2}\frac{h}{a} -
		                   \frac{1}{2}(\frac{h}{a})^3\right) &amp;
                    0 &lt; h \le a \\
                    c &amp; h &gt; a
                    \end{array}\right. </code>
</p>

</li>
<li>
<p>pentaspherical:
</p>
<p style="text-align: center;"><code class="reqn"> \gamma(h) = \left\{
                \begin{array}{ll}
                c_0 + c_1\left(\frac{15}{8}\frac{h}{a} -
		                   \frac{5}{4}(\frac{h}{a})^3 +
		                   \frac{3}{8}(\frac{h}{a})^5\right) &amp;
                    0 &lt; h \le a \\
                    c &amp; h &gt; a
                    \end{array}\right. </code>
</p>

</li>
<li>
<p>cubic:
</p>
<p style="text-align: center;"><code class="reqn"> \gamma(h) = \left\{
                \begin{array}{ll}
                c_0 + c_1\left(7(\frac{h}{a})^2 -
		                \frac{35}{4}(\frac{h}{a})^3 +
				\frac{7}{2}(\frac{h}{a})^5 -
				\frac{3}{4}(\frac{h}{a})^7\right) &amp;
                    0 &lt; h \le a \\
                    c &amp; h &gt; a
                    \end{array}\right. </code>
</p>

</li>
<li>
<p>linear:
</p>
<p style="text-align: center;"><code class="reqn"> \gamma(h) = \left\{
                \begin{array}{ll}
                c_0 + \left(\frac{c_1}{a}h\right) &amp;
                    0 &lt; h \le a \\
                    c &amp; h &gt; a
                    \end{array}\right. </code>
</p>

</li>
</ol>
<h3>Value</h3>

<p>Returns a 'gv' object with the model, input data, and parameter values.
</p>


<h3>Author(s)</h3>

<p>Pedro Tarroso &lt;ptarroso@cibio.up.pt&gt;
</p>


<h3>References</h3>

<p>Fortin, M. -J. and Dale, M. (2006) <em>Spatial Analysis: A guide for Ecologists</em>. Cambridge: Cambridge University Press.
</p>
<p>Isaaks, E. H. and Srivastava, R. M. (1989) <em>An Introduction to applied geostatistics</em>. New York: Oxford University Press.
</p>
<p>Legendre, P. and Legendre, L. (1998) <em>Numerical ecology</em>. 2nd english edition. Amesterdam: Elsevier
</p>


<h3>See Also</h3>

<p><code>plot.gv</code>
<code>predict.gv</code>
</p>


<h3>Examples</h3>

<pre><code class="language-R">
data(vipers)
data(d.gen)

# create a distance matrix between samples
r.dist &lt;- dist(vipers[,1:2])

# fit a variogram with defaults (shperical model) and estimation of range
gv &lt;- gen.variogram(r.dist, d.gen)
gv &lt;- gv.model(gv)

# plot variogram
plot(gv)

# fit a new variogram with linear with sill model and range 8
gv2 &lt;- gv.model(gv, model='linear', range=8)
plot(gv2)

</code></pre>


</div>