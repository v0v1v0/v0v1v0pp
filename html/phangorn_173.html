<div class="container">

<table style="width: 100%;"><tr>
<td>pmlCluster</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>Stochastic Partitioning</h2>

<h3>Description</h3>

<p>Stochastic Partitioning of genes into p cluster.
</p>


<h3>Usage</h3>

<pre><code class="language-R">pmlCluster(formula, fit, weight, p = 1:5, part = NULL, nrep = 10,
  control = pml.control(epsilon = 1e-08, maxit = 10, trace = 1), ...)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>formula</code></td>
<td>
<p>a formula object (see details).</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>fit</code></td>
<td>
<p>an object of class <code>pml</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>weight</code></td>
<td>
<p><code>weight</code> is matrix of frequency of site patterns for all
genes.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>p</code></td>
<td>
<p>number of clusters.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>part</code></td>
<td>
<p>starting partition, otherwise a random partition is generated.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>nrep</code></td>
<td>
<p>number of replicates for each p.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>control</code></td>
<td>
<p>A list of parameters for controlling the fitting process.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>...</code></td>
<td>
<p>Further arguments passed to or from other methods.</p>
</td>
</tr>
</table>
<h3>Details</h3>

<p>The <code>formula</code> object allows to specify which parameter get optimized.
The formula is generally of the form <code>edge + bf + Q ~ rate + shape +
...{}</code>, on the left side are the parameters which get optimized over all
cluster, on the right the parameter which are optimized specific to each
cluster. The parameters available are <code>"nni", "bf", "Q", "inv",
"shape", "edge", "rate"</code>.  Each parameter can be used only once in the
formula.  There are also some restriction on the combinations how parameters
can get used. <code>"rate"</code> is only available for the right side.  When
<code>"rate"</code> is specified on the left hand side <code>"edge"</code> has to be
specified (on either side), if <code>"rate"</code> is specified on the right hand
side it follows directly that <code>edge</code> is too.
</p>


<h3>Value</h3>

<p><code>pmlCluster</code> returns a list with elements
</p>
<table>
<tr style="vertical-align: top;">
<td><code>logLik</code></td>
<td>
<p>log-likelihood of the fit</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>trees</code></td>
<td>
<p>a list of all trees
during the optimization.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>fits</code></td>
<td>
<p>fits for the final partitions</p>
</td>
</tr>
</table>
<h3>Author(s)</h3>

<p>Klaus Schliep <a href="mailto:klaus.schliep@gmail.com">klaus.schliep@gmail.com</a>
</p>


<h3>References</h3>

<p>K. P. Schliep (2009). Some Applications of statistical
phylogenetics (PhD Thesis)
</p>
<p>Lanfear, R., Calcott, B., Ho, S.Y.W. and Guindon, S. (2012) PartitionFinder:
Combined Selection of Partitioning Schemes and Substitution Models for
Phylogenetic Analyses. <em>Molecular Biology and Evolution</em>, <b>29(6)</b>,
1695-1701
</p>


<h3>See Also</h3>

<p><code>pml</code>,<code>pmlPart</code>,<code>pmlMix</code>,
<code>SH.test</code>
</p>


<h3>Examples</h3>

<pre><code class="language-R">
## Not run: 
data(yeast)
dm &lt;- dist.logDet(yeast)
tree &lt;- NJ(dm)
fit &lt;- pml(tree,yeast)
fit &lt;- optim.pml(fit)

weight &lt;- xtabs(~ index+genes,attr(yeast, "index"))
set.seed(1)

sp &lt;- pmlCluster(edge~rate, fit, weight, p=1:4)
sp
SH.test(sp)

## End(Not run)

</code></pre>


</div>