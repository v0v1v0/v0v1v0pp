<div class="container">

<table style="width: 100%;"><tr>
<td>finish_linkage_analysis</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>Linkage analysis between all markertypes within a linkage group.</h2>

<h3>Description</h3>

<p><code>finish_linkage_analysis</code> is a wrapper for <code>linkage</code>, or in the case of probabilistic genotypes, <code>linkage.gp</code>.
The function performs linkage calculations between all markertypes within a linkage group.
</p>


<h3>Usage</h3>

<pre><code class="language-R">finish_linkage_analysis(
  input_type = "discrete",
  marker_assignment,
  dosage_matrix,
  probgeno_df,
  chk,
  marker_combinations = NULL,
  parent1 = "P1",
  parent2 = "P2",
  which_parent = 1,
  ploidy,
  ploidy2 = NULL,
  convert_palindrome_markers = TRUE,
  pairing = "random",
  prefPars = c(0, 0),
  LG_number,
  verbose = TRUE,
  log = NULL,
  ...
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>input_type</code></td>
<td>
<p>Can be either one of 'discrete' or 'probabilistic'. For the former (default), <code>dosage_matrix</code> must be supplied,
while for the latter <code>probgeno_df</code> and <code>chk</code> must be supplied.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>marker_assignment</code></td>
<td>
<p>A marker assignment matrix with markernames as rownames and at least containing the column <code>"Assigned_LG"</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>dosage_matrix</code></td>
<td>
<p>A named integer matrix with markers in rows and individuals in columns.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>probgeno_df</code></td>
<td>
<p>A data frame as read from the scores file produced by function
<code>saveMarkerModels</code> of R package <code>fitPoly</code>, or alternatively, a data frame containing the following columns:
</p>

<dl>
<dt>SampleName</dt>
<dd>
<p>Name of the sample (individual)
</p>
</dd>
<dt>MarkerName</dt>
<dd>
<p>Name of the marker
</p>
</dd>
<dt>P0</dt>
<dd>
<p>Probabilities of dosage score '0'
</p>
</dd>
<dt>P1...</dt>
<dd>
<p>Probabilities of dosage score '1' etc. (up to max dosage, e.g. P4 for tetraploid population)
</p>
</dd>
<dt>maxP</dt>
<dd>
<p>Maximum genotype probability identified for a particular individual and marker combination
</p>
</dd>
<dt>maxgeno</dt>
<dd>
<p>Most probable dosage for a particular individual and marker combination
</p>
</dd>
<dt>geno</dt>
<dd>
<p>Most probable dosage for a particular individual and marker combination, if <code>maxP</code> exceeds a user-defined threshold (e.g. 0.9), otherwise <code>NA</code></p>
</dd>
</dl>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>chk</code></td>
<td>
<p>Output list as returned by function <code>checkF1</code>. This argument is only needed if probabilistic genotypes are used.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>marker_combinations</code></td>
<td>
<p>A matrix with four columns specifying marker combinations to calculate linkage.
If <code>NULL</code> all combinations are used for which there are rf functions.
Dosages of markers should be in the same order as specified in the names of rf functions.
E.g. if using 1.0_2.0 and 1.0_3.0 types use: <code>matrix(c(1,0,2,0,1,0,3,0), byrow = TRUE, ncol = 4)</code></p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>parent1</code></td>
<td>
<p>Character string specifying the identifier of parent 1, by default "P1"</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>parent2</code></td>
<td>
<p>Character string specifying the identifier of parent 2, by default "P2"</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>which_parent</code></td>
<td>
<p>Integer, either 1 or 2, with default 1, where 1 or 2 refers to parent1 or parent2 respectively.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>ploidy</code></td>
<td>
<p>Integer ploidy level of parent1, and also by default parent2. Argument <code>ploidy2</code> can be used if parental ploidies differ.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>ploidy2</code></td>
<td>
<p>Integer, by default <code>NULL</code>. If parental ploidies differ, use this to specify the ploidy of parent2.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>convert_palindrome_markers</code></td>
<td>
<p>Logical. Should markers that behave the same for both parents be converted to a workable format for that parent? E.g.: should 3.1 markers be converted to 1.3?</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>pairing</code></td>
<td>
<p>Type of pairing at meiosis, with options <code>"random"</code> or <code>"preferential"</code>. By default, random pairing is assumned.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>prefPars</code></td>
<td>
<p>The estimates for preferential pairing parameters for parent 1 and 2, in range 0 &lt;= p &lt; 2/3. By default this is c(0,0) (so, no preferential pairing).
See the function <code>test_prefpairing</code> and the vignette for more details.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>LG_number</code></td>
<td>
<p>Number of linkage groups (chromosomes).</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>verbose</code></td>
<td>
<p>Should messages be sent to stdout or log?</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>log</code></td>
<td>
<p>Character string specifying the log filename to which standard output should be written. If NULL log is send to stdout.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>...</code></td>
<td>
<p>(Other) arguments passed to <code>linkage</code></p>
</td>
</tr>
</table>
<h3>Value</h3>

<p>Returns a matrix with marker assignments. Number of linkages of 1.0 markers are artificial.
</p>


<h3>Examples</h3>

<pre><code class="language-R">## Not run: 
data("screened_data3", "marker_assignments_P1")
linkages_list_P1&lt;-finish_linkage_analysis(marker_assignment=marker_assignments_P1,
                                          dosage_matrix=screened_data3,
                                          parent1="P1",
                                          parent2="P2",
                                          which_parent=1,
                                          convert_palindrome_markers=FALSE,
                                          ploidy=4,
                                          pairing="random",
                                          LG_number=5)
                                          
## End(Not run)
</code></pre>


</div>