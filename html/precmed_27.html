<div class="container">

<table style="width: 100%;"><tr>
<td>data.preproc.surv</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>Data preprocessing
Apply at the beginning of <code>catefitcount()</code>, <code>catecvcount()</code>, <code>catefitsurv()</code>, and <code>catecvsurv()</code>, after <code>arg.checks()</code>
</h2>

<h3>Description</h3>

<p>Data preprocessing
Apply at the beginning of <code>catefitcount()</code>, <code>catecvcount()</code>, <code>catefitsurv()</code>, and <code>catecvsurv()</code>, after <code>arg.checks()</code>
</p>


<h3>Usage</h3>

<pre><code class="language-R">data.preproc.surv(
  fun,
  cate.model,
  ps.model,
  ipcw.model = NULL,
  tau0 = NULL,
  data,
  prop.cutoff = NULL,
  prop.multi = NULL,
  ps.method,
  initial.predictor.method = NULL,
  response = "count"
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>fun</code></td>
<td>
<p>A function for which argument check is needed; "catefit" for <code>catefitcount()</code> and <code>catefitsurv()</code>,
"crossv" for <code>catecvcount()</code> and <code>catecvsurv()</code>,
and "drinf" for <code>drcount.inference()</code> and <code>drsurv.inference()</code>. No default.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>cate.model</code></td>
<td>
<p>A formula describing the outcome model to be fitted.
The outcome must appear on the left-hand side.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>ps.model</code></td>
<td>
<p>A formula describing the propensity score model to be fitted.
The treatment must appear on the left-hand side. The treatment must be a numeric vector
coded as 0/1. If data are from a RCT, specify <code>ps.model</code> as an intercept-only model.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>ipcw.model</code></td>
<td>
<p>A formula describing inverse probability of censoring weighting(IPCW) model to be fitted.
If covariates are the same as outcome model, set <code>ipcw.model = NULL</code>.
Otherwise, the left-hand side must be empty and the right-hand side is a covariates model.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>tau0</code></td>
<td>
<p>The truncation time for defining restricted mean time lost. Default is <code>NULL</code>,
which corresponds to setting the truncation time as the maximum survival time in the data</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>data</code></td>
<td>
<p>A data frame containing the variables in the outcome, propensity score, and IPCW models;
a data frame with <code>n</code> rows (1 row per observation).</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>prop.cutoff</code></td>
<td>
<p>A vector of numerical values (in '(0, 1]') specifying percentiles of the
estimated log CATE scores to define nested subgroups. Each element represents the cutoff to
separate observations in nested subgroups (below vs above cutoff).
The length of <code>prop.cutoff</code> is the number of nested subgroups.
An equally-spaced sequence of proportions ending with 1 is recommended.
Default is <code>seq(0.5, 1, length = 6)</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>prop.multi</code></td>
<td>
<p>A vector of numerical values (in '[0, 1]') specifying percentiles of the
estimated log CATE scores to define mutually exclusive subgroups.
It should start with 0, end with 1, and be of <code>length(prop.multi) &gt; 2</code>.
Each element represents the cutoff to separate the observations into
<code>length(prop.multi) - 1</code> mutually exclusive subgroups.
Default is <code>c(0, 1/3, 2/3, 1)</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>ps.method</code></td>
<td>
<p>A character value for the method to estimate the propensity score.
Allowed values include one of:
<code>'glm'</code> for logistic regression with main effects only (default), or
<code>'lasso'</code> for a logistic regression with main effects and LASSO penalization on
two-way interactions (added to the model if interactions are not specified in <code>ps.model</code>).
Relevant only when <code>ps.model</code> has more than one variable.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>initial.predictor.method</code></td>
<td>
<p>A character vector for the method used to get initial
outcome predictions conditional on the covariates. Only applies when <code>score.method</code>
includes <code>'twoReg'</code> or <code>'contrastReg'</code>. Allowed values include one of
<code>'randomForest'</code> (survival outcomes only), <code>'boosting'</code>, <code>'logistic'</code>
(survival outcomes only, fast), <code>'poisson'</code> (count outcomes only, fast), and
<code>'gam'</code> (count outcomes only). Default is <code>NULL</code>, which assigns <code>'boosting'</code>
for count outcomes and <code>'randomForest'</code> for survival outcomes.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>response</code></td>
<td>
<p>The type of response variables; <code>count</code> (default) or <code>survival</code>.</p>
</td>
</tr>
</table>
<h3>Value</h3>

<p>A list of elements:
- y: outcome; vector of length <code>n</code> (observations)
- d : the event indicator; vector of length <code>n</code>; only if <code>respone = "survival"</code>
- trt: binary treatment; vector of length <code>n</code>
- x.ps: matrix of <code>p.ps</code> baseline covariates specified in the propensity score model (plus intercept); dimension <code>n</code> by <code>p.ps + 1</code>
- x.cate: matrix of <code>p.cate</code> baseline covariates specified in the outcome model; dimension <code>n</code> by <code>p.cate</code>
- x.ipcw: matrix of <code>p.ipw</code> baseline covarites specified in inverse probability of censoring weighting model; dimension <code>n</code> by <code>p.ipw</code>
- time: offset; vector of length <code>n</code>; only if <code>response = "count"</code>
- if <code>fun = "catefit"</code>:
- prop: formatted <code>prop.cutoff</code>
- prop.no1: formatted <code>prop.cutoff</code> with 1 removed if applicable; otherwise prop.no1 is the same as prop
- if <code>fun = "crossv"</code>
- prop.onlyhigh: formatted <code>prop.cutoff</code> with 0 removed if applicable
- prop.bi; formatted <code>prop.cutoff</code> with 0 and 1 removed if applicable
- prop.multi: formatted <code>prop.multi</code>, starting with 0 and ending with 1
</p>


</div>