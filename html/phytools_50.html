<div class="container">

<table style="width: 100%;"><tr>
<td>phyl.RMA</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>Phylogenetic reduced major axis (RMA) regression</h2>

<h3>Description</h3>

<p>Phylogenetic reduced major axis (RMA) regression.
</p>


<h3>Usage</h3>

<pre><code class="language-R">phyl.RMA(x, y, tree, method="BM", lambda=NULL, fixed=FALSE, h0=1.0)
## S3 method for class 'phyl.RMA'
coef(object, ...)
## S3 method for class 'phyl.RMA'
plot(x, ...)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>x</code></td>
<td>
<p>vector with names. In the case of the S3 <code>plot</code> method <code>x</code> is an object of class <code>"phyl.RMA"</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>y</code></td>
<td>
<p>vector with names.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>tree</code></td>
<td>
<p>a phylogenetic tree in <code>"phylo"</code> format.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>method</code></td>
<td>
<p>method to obtain the correlation structure: can be <code>"BM"</code> or <code>"lambda"</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>lambda</code></td>
<td>
<p>value of <code>lambda</code> for fixed <code class="reqn">\lambda</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>fixed</code></td>
<td>
<p>logical value indicating whether or not <code class="reqn">\lambda</code> should be optimized using likelihood.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>h0</code></td>
<td>
<p>null hypothesis for <code class="reqn">\beta</code>. Defaults to 1.0. Note that a null hypothesis of 0.0 is not allowed.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>object</code></td>
<td>
<p>for <code>coef</code> method, an object of class <code>"phyl.RMA"</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>...</code></td>
<td>
<p>optional arguments for S3 methods.</p>
</td>
</tr>
</table>
<h3>Details</h3>

<p>Optionally jointly estimates <code class="reqn">\lambda</code> if <code>method="lambda"</code>. Likelihood optimization of <code class="reqn">\lambda</code> is performed using <code>optimize</code> on the interval (0,1).
</p>
<p>The statistical hypothesis testing is based on Clarke (1980; reviewed in McArdle 1988), which differs from some other implementations of non-phylogenetic major axis regression in R.
</p>
<p>Note that some statistician think there is <em>never</em> a condition in which a reduced-major-axis regression is appropriate.
</p>


<h3>Value</h3>

<p>An object of class <code>"phyl.RMA"</code> consisting of a list with the following elements:
</p>
<table>
<tr style="vertical-align: top;">
<td><code>RMA.beta</code></td>
<td>
<p>a vector of RMA regression coefficients.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>V</code></td>
<td>
<p>a VCV matrix for the traits.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>lambda</code></td>
<td>
<p>fitted value of <code class="reqn">\lambda</code> (<code>method="lambda"</code> only).</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>logL</code></td>
<td>
<p>log-likelihood (<code>method="lambda"</code> only).</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>test</code></td>
<td>
<p>a vector containing results for hypothesis tests on <code class="reqn">\beta</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>resid</code></td>
<td>
<p>a vector of residuals for <code>y</code> given <code>x</code>.</p>
</td>
</tr>
</table>
<h3>Author(s)</h3>

<p>Liam Revell <a href="mailto:liam.revell@umb.edu">liam.revell@umb.edu</a></p>


<h3>References</h3>

<p>Clarke, M. R. B. (1980) The reduced major axis of a bivariate sample. <em>Biometrika</em>, <b>67</b>, 441-446.
</p>
<p>McArdle, B. H. (1988) The structural relationship: Regression in biology. <em>Can. J. Zool.</em>, <b>66</b>, 2329-2339.
</p>
<p>Revell, L. J. (2024) phytools 2.0: an updated R ecosystem for phylogenetic comparative methods (and other things). <em>PeerJ</em>, <b>12</b>, e16505.
</p>


<h3>See Also</h3>

<p><code>phyl.cca</code>, <code>phyl.pca</code>, <code>phyl.resid</code>
</p>


<h3>Examples</h3>

<pre><code class="language-R">## load data from Garland et al. (1992)
data(mammal.data)
data(mammal.tree)
## pull out &amp; log transform variables
lnBodyMass&lt;-setNames(log(mammal.data$bodyMass),
  rownames(mammal.data))
lnHomeRange&lt;-setNames(log(mammal.data$homeRange),
  rownames(mammal.data))
## fit RMA regression &amp; print results
fitted.rma&lt;-phyl.RMA(lnBodyMass,lnHomeRange,
  mammal.tree)
print(fitted.rma)
## plot fitted RMA
par(las=1,bty="n")
plot(fitted.rma,las=1,bty="n")
</code></pre>


</div>