<div class="container">

<table style="width: 100%;"><tr>
<td>hprop2f</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>
Sample smoothing parameters in adaptive density estimation
</h2>

<h3>Description</h3>

<p>This function computes the sample smoothing parameters to be used in adaptive kernel density estimation, according to Silverman (1986).   
</p>


<h3>Usage</h3>

<pre><code class="language-R">hprop2f(x, h = h.norm(x), alpha = 1/2, kernel = "gaussian")
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>x</code></td>
<td>

<p>Vector or matrix of data.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>h</code></td>
<td>

<p>Vector of smoothing parameters to be used to get a pilot estimate of the density function. It has length equal to <code>NCOL(x)</code>.
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>alpha</code></td>
<td>

<p>Sensitivity parameter satysfying <code class="reqn">0 \leq \alpha \leq 1</code>, giving the power to which raise the pilot density. Default value is 1/2.
See details.	
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>kernel</code></td>
<td>

<p>Kernel to be used to compute the pilot density estimate. It should be one of 
"gaussian" or "t7". See <code>kepdf</code> for further details.	
</p>
</td>
</tr>
</table>
<h3>Details</h3>

<p>A vector of smoothing parameters <code class="reqn">h_{i}</code> is chosen for each sample point <code class="reqn">x_i</code>, as follows:
</p>
<p style="text-align: center;"><code class="reqn">h_i = h \left(\frac{\hat{f}_h(x_i)}{g}\right)^{- \alpha }</code>
</p>

<p>where <code class="reqn">\hat{f}_h</code> is a pilot kernel density estimate of the density function <code class="reqn">f</code>, with vector of bandwidths <code>h</code>,
and <code class="reqn">g</code> is the geometric mean of <code class="reqn">\hat{f}_h(x_i)</code>,
<code class="reqn">i=1, ..., n</code>.
See Section 5.3.1 of the reference below.
</p>


<h3>Value</h3>

<p>Returns a matrix with the same dimensions of <code>x</code> where row <code class="reqn">i</code> provides
the vector of smoothing parameters for sample point <code class="reqn">x_i</code>.    
</p>


<h3>References</h3>

<p>Silverman, B. (1986). <em>Density estimation for statistics and data analysis</em>. Chapman and Hall, London.
</p>


<h3>See Also</h3>

<p><code>h.norm</code>
</p>


<h3>Examples</h3>

<pre><code class="language-R">set.seed(123)
x &lt;- rnorm(10)

sm.par &lt;- hprop2f(x)
pdf &lt;- kepdf(x, bwtype= "adaptive")

pdf@par$hx
sm.par

plot(pdf,eval.points=seq(-4,4,by=.2))
</code></pre>


</div>