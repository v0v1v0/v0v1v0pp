<div class="container">

<table style="width: 100%;"><tr>
<td>model_classification</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>Building the machine learning model for product classification</h2>

<h3>Description</h3>

<p>This function provides a trained machine learning model to classify products into classes or any other groups defined by the user. In addition, the function returns the characteristics of the model and figures describing the learning process.
</p>


<h3>Usage</h3>

<pre><code class="language-R">model_classification(
  data_train = data.frame(),
  data_test = data.frame(),
  class = c(),
  indicators = c(),
  key_words = c(),
  sensitivity = FALSE,
  p = 0.9,
  w = 0.2,
  rounds = 200,
  grid = list()
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>data_train</code></td>
<td>
<p>Training data set for the model. This set must contain all the columns defined by the <code>indicators</code> parameter and the <code>class</code> column. If the <code>key_words</code> vector is non-empty, the set should also contain a <code>description</code> column. Ideally, the indicators should be of the numerical type. If the indicator is not of the numerical type, it will be converted to this type.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>data_test</code></td>
<td>
<p>A test set that is used to validate the machine learning model. This set should have the same structure as the training set, but it is not obligatory. If the test set is not specified by the user then the test set is drawn from the training set (see <code>p</code> parameter).</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>class</code></td>
<td>
<p>A character string which indicates the column with classes (groups) of products (e.g. COICOPs).</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>indicators</code></td>
<td>
<p>A vector of column names to be considered in building a machine learning model. Important: the indicated variables can be numeric but also categorical (factor or character types are acceptable).</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>key_words</code></td>
<td>
<p>A vector of keywords or phrases that will be recognized in the <code>description</code> column. For each such keyword and or phrase, a new binary variable (column) will be created and included in the machine model training process.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>sensitivity</code></td>
<td>
<p>A logical parameter that indicates whether lowercase or uppercase letters are to be distinguished when the <code>key_words</code> vector is not empty.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>p</code></td>
<td>
<p>A parameter related to creating the testing set, if it has not been specified by the user. The test set is then created on the basis of a class-balanced subsample of the training set. The size of this subsample is 100p percents of the training set size.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>w</code></td>
<td>
<p>A parameter for determining the measure of choosing the optimal machine learning model. For each combination of parameters specified in the <code>grid</code> list, the error rate of the trained model is calculated on the basis of the error on the training set (error_L=1-accuracy_L) and the error on the testing set (error_T=1-accuracy_T). Final accuracy of the model is estimated as: <code>w accuracy_L + (1-w) accuracy_T</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>rounds</code></td>
<td>
<p>The maximum number of iterations during the training stage.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>grid</code></td>
<td>
<p>The list of vectors of parameters which are taken into consideration during the <code>Extreme Gradient Boosting training</code>. The default value of this list is as follows: <code>grid=list(eta=c(0.05,0.1,0.2),max_depth=c(6),min_child_weight=c(1),max_delta_step=c(0),subsample=c(1),gamma=c(0),lambda=c(1),alpha=c(0)</code>. The complete list of parameters for the used <code>Tree Booster</code> is available online <a href="https://xgboost.readthedocs.io/en/latest/parameter.html">here</a>.</p>
</td>
</tr>
</table>
<h3>Value</h3>

<p>In general, this function provides a trained machine learning model to classify products into classes (or any other groups). In addition, the function returns the characteristics of the model and figures describing the learning process. The machine learning process is based on the <code>XGBoost</code> algorithm (from the <code>XGBoost</code> package) which is an implementation of gradient boosted decision trees designed for speed and performance. The function takes into account each combination of model parameters (specified by the <code>grid</code> list) and provides, inter alia, an optimally trained model (a model that minimizes the error rate calculated on the basis of a fixed value of the <code>w</code> parameter). After all, the function returns a list of the following objects: <code>model</code> - the optimally trained model; <code>best_parameters</code> - a set of parameters of the optimal model;  <code>indicators</code> - a vector of all indicators used; <code>key_words</code> - a vector of all key words and phrases used; <code>classes</code> - a dataframe with categorized classes; <code>sensitivity</code> - a value of the used 'sensitivity' parameter; <code>figure_training</code> - a plot of the error levels calculated for the training set and the testing set during the learning process of the returned model (error = 1 - accuracy); <code>figure_importance</code> - a plot of the relative importance of the used indicators.
</p>


<h3>References</h3>

<p>Tianqi Chen and Carlos Guestrin (2016). <em>XGBoost: A Scalable Tree Boosting System</em>. 22nd SIGKDD Conference on Knowledge Discovery and Data Mining.
</p>


<h3>Examples</h3>

<pre><code class="language-R">my.grid=list(eta=c(0.01,0.02,0.05),subsample=c(0.5,0.8))
data_train&lt;-dplyr::filter(dataCOICOP,dataCOICOP$time&lt;=as.Date("2021-10-01"))
data_test&lt;-dplyr::filter(dataCOICOP,dataCOICOP$time==as.Date("2021-11-01"))
ML&lt;-model_classification(data_train,data_test,class="coicop6",grid=my.grid,
indicators=c("description","codeIN","grammage"),key_words=c("uht"),rounds=60)
ML$best_parameters
ML$indicators
ML$figure_training 
ML$figure_importance
</code></pre>


</div>