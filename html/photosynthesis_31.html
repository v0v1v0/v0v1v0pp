<div class="container">

<table style="width: 100%;"><tr>
<td>fit_r_light2</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>Fit models to estimate light respiration (<code class="reqn">R_\mathrm{d}</code>)</h2>

<h3>Description</h3>

<p>We recommend using <code>fit_photosynthesis()</code> with argument <code>.photo_fun = "r_light"</code> rather than calling this function directly.
</p>


<h3>Usage</h3>

<pre><code class="language-R">fit_r_light2(
  .data,
  .model = "default",
  .method = "ls",
  Q_lower = NA,
  Q_upper = NA,
  Q_levels = NULL,
  C_upper = NA,
  quiet = FALSE,
  brm_options = NULL
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>.data</code></td>
<td>
<p>A data frame containing plant ecophysiological data. See <code>required_variables()</code> for the variables required for each model.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>.model</code></td>
<td>
<p>A character string of model name to use. See <code>get_all_models()</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>.method</code></td>
<td>
<p>A character string of the statistical method to use: 'ls' for least-squares and 'brms' for Bayesian model using <code>brms::brm()</code>. Default is 'ls'.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>Q_lower</code></td>
<td>
<p>Lower light intensity limit for estimating Rd using <code>kok_1956</code> and <code>yin_etal_2011</code> models.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>Q_upper</code></td>
<td>
<p>Upper light intensity limit for estimating Rd using <code>kok_1956</code> and <code>yin_etal_2011</code> models</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>Q_levels</code></td>
<td>
<p>A numeric vector of light intensity levels (<code class="reqn">\mu</code>mol / mol) for estimating <code class="reqn">R_\mathrm{d}</code> from the linear region of the A-C curve using the <code>walker_ort_2015</code> model.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>C_upper</code></td>
<td>
<p>Upper C (<code class="reqn">\mu</code>mol / mol) limit for estimating <code class="reqn">R_\mathrm{d}</code> from the linear region of the A-C curve using the <code>walker_ort_2015</code> model.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>quiet</code></td>
<td>
<p>Flag. Should messages be suppressed? Default is FALSE.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>brm_options</code></td>
<td>
<p>A list of options passed to <code>brms::brm()</code> if <code>.method = "brms"</code>. Default is NULL.</p>
</td>
</tr>
</table>
<h3>Value</h3>


<ul>
<li>
<p> If <code>.method = 'ls'</code>: an <code>stats::nls()</code> or <code>stats::lm()</code> object.
</p>
</li>
<li>
<p> If <code>.method = 'brms'</code>: a <code>brms::brmsfit()</code> object.
</p>
</li>
</ul>
<h3>Note</h3>

<p>Confusingly, <code class="reqn">R_\mathrm{d}</code> typically denotes respiration in the light, but you might see <code class="reqn">R_\mathrm{day}</code> or <code class="reqn">R_\mathrm{light}</code>.
</p>
<p><strong>Models</strong>
</p>
<p><em>Kok (1956)</em>
</p>
<p>The <code>kok_1956</code> model estimates light respiration using the Kok method
(Kok, 1956). The Kok method involves looking for a breakpoint in the
light response of net CO2 assimilation at very low light intensities
and extrapolating from data above the breakpoint to estimate light
respiration as the y-intercept. Rd value should be negative,
denoting an efflux of CO2.
</p>
<p><em>Yin et al. (2011)</em>
</p>
<p>The <code>yin_etal_2011</code> model estimates light respiration according
to the Yin <em>et al.</em> (2009, 2011) modifications of the Kok
method. The modification uses fluorescence data to get a
better estimate of light respiration. Rd values should be negative here to
denote an efflux of CO2.
</p>
<p><em>Walker &amp; Ort (2015)</em>
</p>
<p>The <code>walker_ort_2015</code> model estimates light respiration and
<code class="reqn">\Gamma*</code> according to Walker &amp; Ort (2015) using a slope-
intercept regression method to find the intercept of multiple
A-C curves run at multiple light intensities. The method estimates
<code class="reqn">\Gamma*</code> and <code class="reqn">R_\mathrm{d}</code>. If estimated  <code class="reqn">R_\mathrm{d}</code> is
positive this could indicate issues (i.e. leaks) in the gas exchange
measurements. <code class="reqn">\Gamma*</code> is in units of umol / mol and <code class="reqn">R_\mathrm{d}</code>
is in units of <code class="reqn">\mu</code>mol m<code class="reqn">^{-2}</code> s<code class="reqn">^{-1}</code> of respiratory flux.
If using <code class="reqn">C_\mathrm{i}</code>, the estimated value is technically <code class="reqn">C_\mathrm{i}</code>*.
You need to use <code class="reqn">C_\mathrm{c}</code> to get <code class="reqn">\Gamma*</code> Also note, however,
that the convention in the field is to completely ignore this note.
</p>


<h3>References</h3>

<p>Kok B. 1956. On the inhibition of photosynthesis by intense light.
Biochimica et Biophysica Acta 21: 234–244
</p>
<p>Walker BJ, Ort DR. 2015. Improved method for measuring the apparent
CO2 photocompensation point resolves the impact of multiple internal
conductances to CO2 to net gas exchange. Plant Cell Environ 38:2462-
2474
</p>
<p>Yin X, Struik PC, Romero P, Harbinson J, Evers JB, van der Putten
PEL, Vos J. 2009. Using combined measurements of gas exchange and
chlorophyll fluorescence to estimate parameters of a biochemical C3
photosynthesis model: a critical appraisal and a new integrated
approach applied to leaves in a wheat (Triticum aestivum) canopy.
Plant Cell Environ 32:448-464
</p>
<p>Yin X, Sun Z, Struik PC, Gu J. 2011. Evaluating a new method to
estimate the rate of leaf respiration in the light by analysis of
combined gas exchange and chlorophyll fluorescence measurements.
Journal of Experimental Botany 62: 3489–3499
</p>


<h3>Examples</h3>

<pre><code class="language-R">

# Walker &amp; Ort (2015) model

library(broom)
library(dplyr)
library(photosynthesis)

acq_data = system.file("extdata", "A_Ci_Q_data_1.csv", package = "photosynthesis") |&gt; 
  read.csv()

fit = fit_photosynthesis(
  .data = acq_data,
  .photo_fun = "r_light",
  .model = "walker_ort_2015",
  .vars = list(.A = A, .Q = Qin, .C = Ci),
  C_upper = 300,
  # Irradiance levels used in experiment
  Q_levels =  c(1500, 750, 375, 125, 100, 75, 50, 25),
)

# The 'fit' object inherits class 'lm' and many methods can be used

## Model summary:
summary(fit)

## Estimated parameters:
coef(fit)

## 95% confidence intervals:
## n.b. these confidence intervals are not correct because the regression is fit 
## sequentially. It ignores the underlying data and uncertainty in estimates of 
## slopes and intercepts with each A-C curve. Use '.method = "brms"' to properly 
## calculate uncertainty. 
confint(fit)

## Tidy summary table using 'broom::tidy()'
tidy(fit, conf.int = TRUE, conf.level = 0.95)

## Calculate residual sum-of-squares
sum(resid(fit)^2)

# Yin et al. (2011) model

fit = fit_photosynthesis(
  .data = acq_data,
  .photo_fun = "r_light",
  .model = "yin_etal_2011",
  .vars = list(.A = A, .phiPSII = PhiPS2, .Q = Qin),
  Q_lower = 20,
  Q_upper = 250
)

# The 'fit' object inherits class 'lm' and many methods can be used

## Model summary:
summary(fit)

## Estimated parameters:
coef(fit)

## 95% confidence intervals:
confint(fit)

## Tidy summary table using 'broom::tidy()'
tidy(fit, conf.int = TRUE, conf.level = 0.95)

## Calculate residual sum-of-squares
sum(resid(fit)^2)

# Kok (1956) model

fit = fit_photosynthesis(
  .data = acq_data,
  .photo_fun = "r_light",
  .model = "kok_1956",
  .vars = list(.A = A, .Q = Qin),
  Q_lower = 20,
  Q_upper = 150
)

# The 'fit' object inherits class 'lm' and many methods can be used

## Model summary:
summary(fit)

## Estimated parameters:
coef(fit)

## 95% confidence intervals:
confint(fit)

## Tidy summary table using 'broom::tidy()'
tidy(fit, conf.int = TRUE, conf.level = 0.95)

## Calculate residual sum-of-squares
sum(resid(fit)^2)


</code></pre>


</div>