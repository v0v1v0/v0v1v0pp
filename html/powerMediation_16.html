<div class="container">

<table style="width: 100%;"><tr>
<td>powerMediation.VSMc.cox</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>
Power for testing mediation effect in cox regression based on Vittinghoff, Sen and McCulloch's (2009) method
</h2>

<h3>Description</h3>

<p>Calculate Power for testing mediation effect in cox regression based on Vittinghoff, Sen and McCulloch's (2009) method. 
</p>


<h3>Usage</h3>

<pre><code class="language-R">powerMediation.VSMc.cox(n, 
                        b2, 
                        sigma.m, 
                        psi, 
                        corr.xm, 
                        alpha = 0.05, 
                        verbose = TRUE)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>n</code></td>
<td>

<p>sample size.
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>b2</code></td>
<td>

<p>regression coefficient for the mediator <code class="reqn">m</code> in the cox regression
<code class="reqn">\log(\lambda)=\log(\lambda_0)+b1 x_i + b2 m_i</code>, where <code class="reqn">\lambda</code> is the hazard function and
<code class="reqn">\lambda_0</code> is the baseline hazard function.
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>sigma.m</code></td>
<td>

<p>standard deviation of the mediator.
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>psi</code></td>
<td>

<p>the probability that an observation is uncensored, so that
the number of event <code class="reqn">d= n * psi</code>, where <code class="reqn">n</code> is the sample size.
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>corr.xm</code></td>
<td>

<p>correlation between the predictor <code class="reqn">x</code> and the mediator <code class="reqn">m</code>.
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>alpha</code></td>
<td>

<p>type I error rate.
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>verbose</code></td>
<td>

<p>logical. <code>TRUE</code> means printing power; <code>FALSE</code> means not printing power.
</p>
</td>
</tr>
</table>
<h3>Details</h3>

<p>The power is for testing the null hypothesis <code class="reqn">b_2=0</code>
versus the alternative hypothesis <code class="reqn">b_2\neq 0</code>
for the cox regressions:
</p>
<p style="text-align: center;"><code class="reqn">\log(\lambda)=\log(\lambda_0)+b_1 x_i + b_2 m_i </code>
</p>

<p>where <code class="reqn">\lambda</code> is the hazard function and
<code class="reqn">\lambda_0</code> is the baseline hazard function.
</p>
<p>Vittinghoff et al. (2009) showed that for the above cox regression, testing the mediation effect
is equivalent to testing the null hypothesis <code class="reqn">H_0: b_2=0</code>
versus the alternative hypothesis <code class="reqn">H_a: b_2\neq 0</code>.
</p>
<p>The full model is
</p>
<p style="text-align: center;"><code class="reqn">\log(\lambda)=\log(\lambda_0)+b_1 x_i + b_2 m_i </code>
</p>

<p>The reduced model is
</p>
<p style="text-align: center;"><code class="reqn">\log(\lambda)=\log(\lambda_0)+b_1 x_i </code>
</p>

<p>Vittinghoff et al. (2009) mentioned that if confounders need to be included
in both the full and reduced models, the sample size/power calculation formula
could be accommodated by redefining <code>corr.xm</code> as the multiple
correlation of the mediator with the confounders as well as the predictor.
</p>


<h3>Value</h3>

<table>
<tr style="vertical-align: top;">
<td><code>power </code></td>
<td>
<p>power for testing if <code class="reqn">b_2=0</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>delta </code></td>
<td>
<p><code class="reqn">b_2\sigma_m\sqrt{(1-\rho_{xm}^2) psi}</code></p>
</td>
</tr>
</table>
<p>, where
<code class="reqn">\sigma_m</code> is the standard deviation of the mediator <code class="reqn">m</code>,
<code class="reqn">\rho_{xm}</code> is the correlation between the predictor <code class="reqn">x</code>
and the mediator <code class="reqn">m</code>, and <code class="reqn">psi</code> is 
the probability that an observation is uncensored, so that
the number of event <code class="reqn">d= n * psi</code>, where <code class="reqn">n</code> is the sample size.
</p>


<h3>Note</h3>

<p>The test is a two-sided test. For one-sided tests, please double the 
significance level. For example, you can set <code>alpha=0.10</code>
to obtain one-sided test at 5% significance level.
</p>


<h3>Author(s)</h3>

<p>Weiliang Qiu <a href="mailto:stwxq@channing.harvard.edu">stwxq@channing.harvard.edu</a>
</p>


<h3>References</h3>

<p>Vittinghoff, E. and Sen, S. and McCulloch, C.E..
Sample size calculations for evaluating mediation.
<em>Statistics In Medicine</em>.  2009;28:541-557.
</p>


<h3>See Also</h3>

<p><code>minEffect.VSMc.cox</code>, 
<code>ssMediation.VSMc.cox</code> 
</p>


<h3>Examples</h3>

<pre><code class="language-R">  # example in section 6 (page 547) of Vittinghoff et al. (2009).
  # power = 0.7999916
  powerMediation.VSMc.cox(n = 1399, b2 = log(1.5), 
    sigma.m = sqrt(0.25 * (1 - 0.25)), psi = 0.2, corr.xm = 0.3,
    alpha = 0.05, verbose = TRUE)
</code></pre>


</div>