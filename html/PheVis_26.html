<div class="container">

<table style="width: 100%;"><tr>
<td>train_phevis</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>train_phevis</h2>

<h3>Description</h3>

<p>Global function to train phevis model.
</p>


<h3>Usage</h3>

<pre><code class="language-R">train_phevis(
  half_life,
  df,
  START_DATE,
  PATIENT_NUM,
  ENCOUNTER_NUM,
  var_vec,
  main_icd,
  main_cui,
  rf = TRUE,
  p.noise = 0.3,
  bool_SAFE = TRUE,
  omega = 2,
  GS = NULL
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>half_life</code></td>
<td>
<p>Duration of cumulation. For a chronic disease you might chose Inf, for acute disease you might chose the duration of the disease.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>df</code></td>
<td>
<p><code>data.frame</code> containing all the variables.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>START_DATE</code></td>
<td>
<p>Column name of the time column. The time column should be numeric</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>PATIENT_NUM</code></td>
<td>
<p>Column name of the patient id column.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>ENCOUNTER_NUM</code></td>
<td>
<p>Column name of the encounter id column.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>var_vec</code></td>
<td>
<p>Explanatory variables used for the prediction, including the main variables.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>main_icd</code></td>
<td>
<p>Character vector of the column names of the main ICD codes.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>main_cui</code></td>
<td>
<p>Character vector of the column names of the main CUIs.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>rf</code></td>
<td>
<p>should pseudo-labellisation with random forest be used (default is true)</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>p.noise</code></td>
<td>
<p>percentage of noise introduced during the noising step (default is 0.3)</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>bool_SAFE</code></td>
<td>
<p>A boolean. If TRUE, SAFE selection is done, else it is not (default is TRUE)</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>omega</code></td>
<td>
<p>Constant for the extrema population definition (default is 2)</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>GS</code></td>
<td>
<p>Character string corresponding to the name of the gold-standard variable (default is null for which a vector of 0 will be taken).</p>
</td>
</tr>
</table>
<h3>Value</h3>

<p>A list
</p>

<ul>
<li>
<p> surparam - the parameters used to compute the surrogate
</p>
</li>
<li>
<p> model - the random intercept logistic regression
</p>
</li>
<li>
<p> df_train_result - the <code>data.frame</code> containing the output predictions
</p>
</li>
<li>
<p> train_param - parameters for the model training (variables used, main ICD and CUIS, half_life, gold standard)
</p>
</li>
</ul>
<h3>Examples</h3>

<pre><code class="language-R">library(dplyr)
PheVis::data_phevis
df &lt;- data_phevis %&gt;%
         mutate(ENCOUNTER_NUM = row_number(),
         time = round(as.numeric(time)))
model &lt;- PheVis::train_phevis(half_life = Inf,
         df = df,
         START_DATE = "time",
         PATIENT_NUM = "subject",
         ENCOUNTER_NUM = "ENCOUNTER_NUM",
         var_vec = c(paste0("var",1:10), "mainCUI", "mainICD"),
         main_icd = "mainICD",
         main_cui = "mainCUI")

</code></pre>


</div>