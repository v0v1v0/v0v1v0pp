<div class="container">

<table style="width: 100%;"><tr>
<td>ElmoreFit</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>
Fit a double logistic equation to a time series according to Elmore et al. (2012)  
</h2>

<h3>Description</h3>

<p>This function fits a double logistic curve to observed values using the
function as described in Elmore et al. (2012) (equation 4). It can also
provide and uncertainty estimation. 
</p>


<h3>Usage</h3>

<pre><code class="language-R">ElmoreFit(ts, uncert = FALSE, nrep = 100, ncores='all', 
sf=quantile(ts, probs=c(0.05, 0.95), na.rm=TRUE))
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>ts</code></td>
<td>

<p>A ts or zoo object with gcc data. index(ts) must be numeric days of
year (doys) or a POSIXct vector
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>uncert</code></td>
<td>

<p>Should uncertainty be estimated?
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>nrep</code></td>
<td>

<p>Number of relications to estimate uncertainty, defaults to 100. 
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>ncores</code></td>
<td>

<p>Number of processors to be used in parallel computation, defaults to 'all' which will accidentally slow down any other activity on your computer. Otherwise set the number of processors you want to use in parallelization. 

</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>sf</code></td>
<td>

<p>Scaling factors required to normalize the data prior to the fitting. If the function is called by e.g. <code>greenProcess</code> sf is automatically calculated.
</p>
</td>
</tr>
</table>
<h3>Details</h3>

<p>The function estimates parameters of the double logistic equation from
Elmore et al. 2012 and provides an uncertainty estimation. Parameters are
estimated by a call to the function <code>FitDoubleLogElmore</code> from the 
greenbrown package. Uncertainty is computed by adding noise to the raw
data and by estimating again the parameters. Noise is added according
to the standard deviation of the residuals (fitted - observed).
The procedure is repeated nrep times.    
</p>


<h3>Value</h3>

<p>A list containing the following items. 
</p>
<table>
<tr style="vertical-align: top;">
<td><code>fit</code></td>
<td>
<p>A list as returned by the function FitDoubleLogElmore</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>uncertainty</code></td>
<td>
<p>A list containing a zoo data.frame with the
uncertainty predicted values, and a dataframe containing the
respective uncertainty curve parameters</p>
</td>
</tr>
</table>
<h3>Author(s)</h3>

<p>Gianluca Filippa &lt;gian.filippa@gmail.com&gt;
</p>


<h3>References</h3>

<p>Elmore, A.J., S.M. Guinn, B.J. Minsley and A.D. Richardson (2012): 
Landscape controls on the timing of spring, autumn, and growing season 
length in mid-Atlantic forests. - Global Change Biology 18, 656-674.
</p>


<h3>See Also</h3>

<p><code>FitDoubleLogElmore</code>
</p>


<h3>Examples</h3>

<pre><code class="language-R">
## Not run: 
library(zoo)
data(bartlett2009.filtered)
## fit without uncertainty estimation
fitted.elmore &lt;- ElmoreFit(bartlett2009.filtered)
days &lt;- as.numeric(format(index(bartlett2009.filtered), '
plot(days, bartlett2009.filtered)
lines(fitted.elmore$fit$predicted, col='red')
## look at fitting parameters
fitted.elmore$fit$params
## look at fitting equation, where t is time
fitted.elmore$fit$formula

## End(Not run)
</code></pre>


</div>