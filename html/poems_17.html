<div class="container">

<table style="width: 100%;"><tr>
<td>population_env_stoch</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>Nested functions for population environmental stochasticity.</h2>

<h3>Description</h3>

<p>Modular functions for the population simulator for performing correlated
environmentally stochastic adjustments to transition rates.
</p>


<h3>Usage</h3>

<pre><code class="language-R">population_env_stoch(
  populations,
  fecundity_matrix,
  fecundity_max,
  survival_matrix,
  standard_deviation,
  correlation
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>populations</code></td>
<td>
<p>Number of populations.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>fecundity_matrix</code></td>
<td>
<p>Matrix of transition fecundity rates (Leslie/Lefkovitch matrix with non-zero fecundities only).</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>fecundity_max</code></td>
<td>
<p>Maximum transition fecundity rate (in Leslie/Lefkovitch matrix).</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>survival_matrix</code></td>
<td>
<p>Matrix of transition survival rates (Leslie/Lefkovitch matrix with non-zero survivals only).</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>standard_deviation</code></td>
<td>
<p>Standard deviation matrix for applying environmental stochasticity to transition rates.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>correlation</code></td>
<td>
<p>List containing either an environmental correlation matrix (correlation_matrix), a pre-calculated transposed (Cholesky) decomposition matrix (t_decomposition_matrix), or a compact transposed (Cholesky) decomposition matrix (t_decomposition_compact_matrix) and a corresponding map of population indices (t_decomposition_compact_map), as per <em>SpatialCorrelation</em> class attributes.</p>
</td>
</tr>
</table>
<h3>Value</h3>

<p>Environmental stochasticity calculation function: <code>function(fecundity_array, survival_array, occupied_indices)</code>, where:
</p>

<dl>
<dt><code>fecundity_array</code></dt>
<dd>
<p>3D array of fecundity rates (<em>stages</em> rows by <em>stages</em> columns by <em>populations</em> deep).</p>
</dd>
<dt><code>survival_array</code></dt>
<dd>
<p>3D array of survival rates (<em>stages</em> rows by <em>stages</em> columns by <em>populations</em> deep).</p>
</dd>
<dt><code>occupied_indices</code></dt>
<dd>
<p>Array of indices for those populations occupied.</p>
</dd>
<dt><code>returns</code></dt>
<dd>
<p>List containing stochastically varied fecundity and survival arrays.</p>
</dd>
</dl>
<h3>Examples</h3>

<pre><code class="language-R">fecundity_matrix &lt;- array(c(0, 0, 0, 3, 0, 0, 4, 0, 0), c(3, 3))
survival_matrix &lt;- array(c(0, 0.5, 0, 0, 0, 0.7, 0, 0, 0.8), c(3, 3))
standard_deviation &lt;- (fecundity_matrix + survival_matrix) * 0.3
variation_array &lt;- array(rep(seq(0.85, 1.15, 0.05), each = 9), c(3, 3, 7))
fecundity_array &lt;- array(fecundity_matrix, c(3, 3, 7)) * variation_array
survival_array &lt;- array(survival_matrix, c(3, 3, 7)) * variation_array
stage_abundance &lt;- matrix(c(
   7, 13, 0, 26, 0, 39, 47,
   2, 0, 6, 8, 0, 12, 13,
   0, 3, 4, 6, 0, 9, 10
), nrow = 3, ncol = 7, byrow = TRUE)
occupied_indices &lt;- (1:7)[-5]
env_stoch_function &lt;- population_env_stoch(
  populations = 7, fecundity_matrix, fecundity_max = NULL, survival_matrix,
  standard_deviation, correlation = NULL
)
env_stoch_function(fecundity_array, survival_array, occupied_indices)

</code></pre>


</div>