<div class="container">

<table style="width: 100%;"><tr>
<td>SimSpsoContour</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>Simulates trial replications from the SPSO model with desirability optimality function.</h2>

<h3>Description</h3>

<p>Simulates replications from a Bayesian adaptive phase 12 clinical trial design using the SPSO model and a optimality function based on the desirability tradeoff contour.
</p>


<h3>Usage</h3>

<pre><code class="language-R">SimSpsoContour(
  NSims,
  PE,
  PT,
  corET,
  Nmax,
  cohort,
  Contour,
  CutE,
  CutT,
  AcceptE,
  AcceptT,
  HypermeansE,
  HypermeansT,
  Hypervars
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>NSims</code></td>
<td>
<p>Number of trial simulations to run.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>PE</code></td>
<td>
<p>True efficacy probability for each dose.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>PT</code></td>
<td>
<p>True toxicity probaiblity for each dose.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>corET</code></td>
<td>
<p>Correlation parameter between efficacy and toxicity probability.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>Nmax</code></td>
<td>
<p>Maximum trial sample size.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>cohort</code></td>
<td>
<p>Patient cohort size.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>Contour</code></td>
<td>
<p>Contour vector for desirability function. Contains in order: (pi_1,E,pi_2,T,pi_3,E,pi_4,T).</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>CutE</code></td>
<td>
<p>Cutoff for efficacy probability acceptability. Dose-efficacy probabilities must be larger than this for patient assignment.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>CutT</code></td>
<td>
<p>Cutoff for toxicity probability acceptability. Dose-toxicity probabilities must be smaller than this for patient assignment.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>AcceptE</code></td>
<td>
<p>Posterior probability threshold for efficacy acceptability.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>AcceptT</code></td>
<td>
<p>Posterior probability threshold for toxicity acceptability.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>HypermeansE</code></td>
<td>
<p>Hypermeans for dose-specific efficacy parameters.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>HypermeansT</code></td>
<td>
<p>Hypermeans for dose-specific toxcity parameters.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>Hypervars</code></td>
<td>
<p>Hypervariances needed for the SPSO model. Contains, in order (sigma_0^2, sigma_mu^2,tau).</p>
</td>
</tr>
</table>
<h3>Value</h3>

<p>A list with the first entry corresponding to a matrix with: (1) True toxicity probabilities at each dose, (2) True efficacy probabilities at each dose, (3) True Desirability of each dose, (4) Optimal dose selection probability, (5) Average sample size of patients treated at each dose. The second entry of the list contains a vector with rows corresponding to (1) the true binary bivariate correlation between efficacy and toxicity, (2) Stopping probability of the trial, (3) Average number of efficacy events, (4) Average number of toxicity events, and (5) Delta.
</p>


<h3>Examples</h3>

<pre><code class="language-R">library(mvtnorm)
##True toxicity probability
PT=c(.05,.10,.15,.20,.30)
##True Efficacy Probability
PE=c(.2,.4,.6,.65,.7)
#True Correlation
corET=.5
##Number of simulations
NSims=1 ##Increase this when using
##Hypermeans and hypervariances
HypermeansE=c(-1.189, -0.357,  0.360,  0.546,  0.743)
HypermeansT=c(-2.325, -1.811, -1.464, -1.189, -0.740)
Hypervars=c(1,16,1)
##Trial Parameters
##Cohort Size, N^F and N_ET
cohort=3
##Starting Dose
DoseStart=1
Nmax=30 ##Max Sample Size
#Acceptability Criterion
CutE=.3
CutT=.4
##Limits on acceptability
AcceptE=.1
AcceptT=.1
##Contour vector
Contour = c(.35, .75,.7,.4)
RESULTS=SimSpsoContour(NSims, PE, PT, corET, Nmax, cohort, Contour,
CutE, CutT, AcceptE, AcceptT,HypermeansE, HypermeansT, Hypervars)
RESULTS
</code></pre>


</div>