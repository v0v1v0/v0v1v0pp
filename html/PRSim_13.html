<div class="container">

<table style="width: 100%;"><tr>
<td>pRsim.weather</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>Weather simulation (temperature and precipitation) for multiple stations</h2>

<h3>Description</h3>

<p>Applies the wavelet-based weather simulation algorithm to multiple sites (single site possible as well)
</p>


<h3>Usage</h3>

<pre><code class="language-R">prsim.weather(data_p, data_t, station_id_p="Precip",
station_id_t="Temp", number_sim=1, win_h_length=15,
n_wave=100,verbose=TRUE,t_margin='sep',p_margin='egpd',...)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>data_p</code></td>
<td>
<p>list of precipitation data frames. One list entry, i.e. data frame, corresponds to one station/grid cell. Each data frame contains the time indications and precipitation of one station. See ‘Details’.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>data_t</code></td>
<td>
<p>list of temperature data frames. One list entry, i.e. data frame, corresponds to one station/grid cell. Each data frame contains the time indications and temperature of one station. See ‘Details’.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>station_id_p</code></td>
<td>
<p>identifies the precipitation variable name in case several time series are present in <code>data_p</code>. See ‘Details’.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>station_id_t</code></td>
<td>
<p>identifies the temperature variable name in case several time series are present in <code>data_t</code>. See ‘Details’.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>number_sim</code></td>
<td>
<p>number of simulations to be carried out.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>win_h_length</code></td>
<td>
<p>(half-)length of moving window size.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>t_margin</code></td>
<td>
<p>marginal distribution to be used for the backtransformation of temperature. Can be either <code>"sep"</code> or any type of CDF (see ‘Details’). <code>"sep"</code> uses the four-parameter skewed-exponential power for backtransformation. CDF allows for specifying any distribution ‘Examples’.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>p_margin</code></td>
<td>
<p>marginal distribution to be used for the backtransformation of precipitation. Can be either <code>"egpd"</code> or any type of CDF (see ‘Details’). <code>"egpd"</code> uses the extended GPD for backtransformation. CDF allows for specifying any distribution ‘Examples’.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>verbose</code></td>
<td>
<p>logical. Should progress be reported?</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>n_wave</code></td>
<td>
<p>number of scales to be considered in the continuous wavelet transform.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>...</code></td>
<td>
<p>any other argument passed to the sub-function specifying the cdf for fitting.  See ‘Details’ and  ‘Examples’. </p>
</td>
</tr>
</table>
<h3>Details</h3>

<p>Time can be given with three columns named <code>"YYYY"</code>, <code>"MM"</code>, <code>"DD"</code>, or as in POSIXct format <code>YYYY-MM-DD</code>.
All leap days (Feb 29th) will be omitted from the analysis, but no missing observations are allowed.
</p>
<p>Stations are identified by list index.
</p>
<p>Alternative distributions can be specified by providing three functions: (1) a function fitting the parameters of a distributions and providing a vector of these parameters as output (CDF_fit), (2) a function simulating random numbers from this distribution (rCDF), and (3) a function specifying the distribution (pCDF). See ‘Examples’ for the generalized beta for the second kind and for the Generalized Extreme Values (GEV) distribution.
</p>


<h3>Value</h3>

<p>A list with elements temperature and precipitation of
</p>
<table><tr style="vertical-align: top;">
<td><code>simulation</code></td>
<td>
<p>data frames with time information, observations, and 
<code>number_sim</code> columns containing the simulated data.</p>
</td>
</tr></table>
<h3>Author(s)</h3>

<p>Manuela Brunner
</p>


<h3>References</h3>

<p>Brunner, M. I., and E. Gilleland (2021). Spatial compound hot-dry events in the United States: assessment using a multi-site multi-variable weather generator, in preparation.</p>


</div>