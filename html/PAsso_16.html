<div class="container">

<table style="width: 100%;"><tr>
<td>diagnostic.plot</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>Residual-based diagnostic plots</h2>

<h3>Description</h3>

<p>A set of visualization tools for the diagnostic of the fitted model in
the partial association analysis. It can provides a plot matrix including Q-Q plots,
residual-vs-fitted plots, residual-vs-covariate plots of all the fitted models.
This function also support the direct diagnostic of the cumulative link regression model
in the class of <code>clm</code>, <code>glm</code>, <code>lrm</code>,
<code>orm</code>, <code>polr</code>. Currently, <code>vglm</code>
is not supported.
</p>


<h3>Usage</h3>

<pre><code class="language-R">diagnostic.plot(object, ...)

## Default S3 method:
diagnostic.plot(object, ...)

## S3 method for class 'resid'
diagnostic.plot(object, output = c("qq", "fitted", "covariate"), ...)

## S3 method for class 'PAsso'
diagnostic.plot(
  object,
  output = c("qq", "fitted", "covariate"),
  model_id = NULL,
  x_name = NULL,
  ...
)

## S3 method for class 'glm'
diagnostic.plot(
  object,
  output = c("qq", "fitted", "covariate"),
  x = NULL,
  fit = NULL,
  distribution = qnorm,
  ncol = NULL,
  alpha = 1,
  xlab = NULL,
  color = "#444444",
  shape = 19,
  size = 2,
  qqpoint.color = "#444444",
  qqpoint.shape = 19,
  qqpoint.size = 2,
  qqline.color = "#888888",
  qqline.linetype = "dashed",
  qqline.size = 1,
  smooth = TRUE,
  smooth.color = "red",
  smooth.linetype = 1,
  smooth.size = 1,
  fill = NULL,
  resp_name = NULL,
  ...
)

## S3 method for class 'clm'
diagnostic.plot(object, output = c("qq", "fitted", "covariate"), ...)

## S3 method for class 'lrm'
diagnostic.plot(object, output = c("qq", "fitted", "covariate"), ...)

## S3 method for class 'orm'
diagnostic.plot(object, output = c("qq", "fitted", "covariate"), ...)

## S3 method for class 'polr'
diagnostic.plot(object, output = c("qq", "fitted", "covariate"), ...)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>object</code></td>
<td>
<p>The object in the support classes (This function is mainly designed
for <code>PAsso</code>).</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>...</code></td>
<td>
<p>Additional optional arguments can be passed onto <code>ggplot</code> for drawing
various plots.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>output</code></td>
<td>
<p>A character string specifying what type of output to plot. Default is
<code>"qq"</code> which produces a plot matrix with quantile-quantile plots of the residuals.
<code>"fitted"</code> produces a plot matrix between residuals and all corresponding fitted responses.
<code>"covariates"</code> produces a plot matrix between residuals and corresponding covariate.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>model_id</code></td>
<td>
<p>A number refers to the index of the model that needs to be diagnosed. If NULL, all
models will be diagnosed.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>x_name</code></td>
<td>
<p>A string refers to the covariate name that needs to be diagnosed. If NULL, all adjustments
will be diagnosed.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>x</code></td>
<td>
<p>A vector giving the covariate values to use for residual-by-
covariate plots (i.e., when <code>output = "covariate"</code>).</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>fit</code></td>
<td>
<p>The fitted model from which the residuals were extracted. (Only
required if <code>output = "fitted"</code> and <code>object</code> inherits from class
<code>"resid"</code>.)</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>distribution</code></td>
<td>
<p>Function that computes the quantiles for the reference
distribution to use in the quantile-quantile plot. Default is <code>qnorm</code>
which is only appropriate for models using a probit link function. When
<code>jitter.scale = "probability"</code>, the reference distribution is always
U(-0.5, 0.5). (Only
required if <code>object</code> inherits from class <code>"resid"</code>.)</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>ncol</code></td>
<td>
<p>Integer specifying the number of columns to use for the plot
layout (if requesting multiple plots). Default is <code>NULL</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>alpha</code></td>
<td>
<p>A single values in the interval [0, 1] controlling the opacity
alpha of the plotted points. Only used when <code>nsim</code> &gt; 1.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>xlab</code></td>
<td>
<p>Character string giving the text to use for the x-axis label in
residual-by-covariate plots. Default is <code>NULL</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>color</code></td>
<td>
<p>Character string or integer specifying what color to use for the
points in the residual vs fitted value/covariate plot.
Default is <code>"black"</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>shape</code></td>
<td>
<p>Integer or single character specifying a symbol to be used for
plotting the points in the residual vs fitted value/covariate plot.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>size</code></td>
<td>
<p>Numeric value specifying the size to use for the points in the
residual vs fitted value/covariate plot.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>qqpoint.color</code></td>
<td>
<p>Character string or integer specifying what color to use
for the points in the quantile-quantile plot.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>qqpoint.shape</code></td>
<td>
<p>Integer or single character specifying a symbol to be
used for plotting the points in the quantile-quantile plot.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>qqpoint.size</code></td>
<td>
<p>Numeric value specifying the size to use for the points
in the quantile-quantile plot.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>qqline.color</code></td>
<td>
<p>Character string or integer specifying what color to use
for the points in the quantile-quantile plot.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>qqline.linetype</code></td>
<td>
<p>Integer or character string (e.g., <code>"dashed"</code>)
specifying the type of line to use in the quantile-quantile plot.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>qqline.size</code></td>
<td>
<p>Numeric value specifying the thickness of the line in the
quantile-quantile plot.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>smooth</code></td>
<td>
<p>Logical indicating whether or not too add a nonparametric
smooth to certain plots. Default is <code>TRUE</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>smooth.color</code></td>
<td>
<p>Character string or integer specifying what color to use
for the nonparametric smooth.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>smooth.linetype</code></td>
<td>
<p>Integer or character string (e.g., <code>"dashed"</code>)
specifying the type of line to use for the nonparametric smooth.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>smooth.size</code></td>
<td>
<p>Numeric value specifying the thickness of the line for the
nonparametric smooth.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>fill</code></td>
<td>
<p>Character string or integer specifying the color to use to fill
the boxplots for residual-by-covariate plots when <code>x</code> is of class
<code>"factor"</code>. Default is <code>NULL</code> which colors the boxplots according
to the factor levels.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>resp_name</code></td>
<td>
<p>Character string to specify the response name that will be
displayed in the figure.</p>
</td>
</tr>
</table>
<h3>Value</h3>

<p>A <code>"ggplot"</code> object for supported models. For class "PAsso", it returns a plot in
<code>"gtable"</code> object that combines diagnostic plots of all responses.
</p>
<p>A "ggplot" object based on the input residuals.
</p>
<p>A "ggplot" object based on the input residuals.
</p>
<p>A plot in "gtable" object that combines diagnostic plots of all responses.
</p>
<p>A "ggplot" object based on the residuals generated from glm object.
</p>
<p>A "ggplot" object based on the residuals generated from clm object.
</p>
<p>A "ggplot" object based on the residuals generated from lrm object.
</p>
<p>A "ggplot" object based on the residuals generated from orm object.
</p>
<p>A "ggplot" object based on the residuals generated from polr object.
</p>


<h3>Examples</h3>

<pre><code class="language-R"># Import data for partial association analysis
data("ANES2016")
ANES2016$PreVote.num &lt;- as.factor(ANES2016$PreVote.num)

PAsso_3v &lt;- PAsso(responses = c("PreVote.num", "PID", "selfLR"),
                  adjustments = c("income.num", "age", "edu.year"),
                  data = ANES2016, uni.model = "probit",
                  method = c("kendall"),
                  resids.type = "surrogate", jitter = "latent")

diag_p1 &lt;- diagnostic.plot(object = PAsso_3v, output = "qq")
diag_p2 &lt;- diagnostic.plot(object = PAsso_3v, output = "fitted")
diag_p3 &lt;- diagnostic.plot(object = PAsso_3v, output = "covariate")

# Simply diagnose a model
# Fit cumulative link models

fit1 &lt;- ordinal::clm(PreVote.num ~ income.num + age + edu.year, data = ANES2016, link = "logit")

# diagnostic.plot
plot_qq_1 &lt;- diagnostic.plot(object = fit1, output = "qq")
plot_fit_1 &lt;- diagnostic.plot(object = fit1, output = "fitted")
plot_cov_1 &lt;- diagnostic.plot(object = fit1, output = "covariate")

</code></pre>


</div>