<div class="container">

<table style="width: 100%;"><tr>
<td>calculate_aa_scores</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>Calculate scores for each amino acid position in a protein sequence</h2>

<h3>Description</h3>

<p><a href="https://lifecycle.r-lib.org/articles/stages.html#experimental"><img src="../help/figures/lifecycle-experimental.svg" alt="[Experimental]"></a>
Calculate a score for each amino acid position in a protein sequence based on the product of the
-log10(adjusted p-value) and the absolute log2(fold change) per peptide covering this amino acid. In detail, all the
peptides are aligned along the sequence of the corresponding protein, and the average score per
amino acid position is computed. In a limited proteolysis coupled to mass spectrometry (LiP-MS)
experiment, the score allows to prioritize and narrow down structurally affected regions.
</p>


<h3>Usage</h3>

<pre><code class="language-R">calculate_aa_scores(
  data,
  protein,
  diff = diff,
  adj_pval = adj_pval,
  start_position,
  end_position,
  retain_columns = NULL
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>data</code></td>
<td>
<p>a data frame containing at least the input columns.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>protein</code></td>
<td>
<p>a character column in the data frame containing the protein identifier or name.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>diff</code></td>
<td>
<p>a numeric column in the <code>data</code> data frame containing the log2 fold change.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>adj_pval</code></td>
<td>
<p>a numeric column in the <code>data</code> data frame containing the adjusted p-value.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>start_position</code></td>
<td>
<p>a numeric column <code>data</code> in the data frame containing the start position
of a peptide or precursor.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>end_position</code></td>
<td>
<p>a numeric column in the data frame containing the end position of a peptide or
precursor.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>retain_columns</code></td>
<td>
<p>a vector indicating if certain columns should be retained from the input
data frame. Default is not retaining additional columns <code>retain_columns = NULL</code>. Specific
columns can be retained by providing their names (not in quotations marks, just like other
column names, but in a vector).</p>
</td>
</tr>
</table>
<h3>Value</h3>

<p>A data frame that contains the aggregated scores per amino acid position, enabling to
draw fingerprints for each individual protein.
</p>


<h3>Author(s)</h3>

<p>Patrick Stalder
</p>


<h3>Examples</h3>

<pre><code class="language-R">
data &lt;- data.frame(
  pg_protein_accessions = c(rep("protein_1", 10)),
  diff = c(2, -3, 1, 2, 3, -3, 5, 1, -0.5, 2),
  adj_pval = c(0.001, 0.01, 0.2, 0.05, 0.002, 0.5, 0.4, 0.7, 0.001, 0.02),
  start = c(1, 3, 5, 10, 15, 25, 28, 30, 41, 51),
  end = c(6, 8, 10, 16, 23, 35, 35, 35, 48, 55)
)
calculate_aa_scores(
  data,
  protein = pg_protein_accessions,
  diff = diff,
  adj_pval = adj_pval,
  start_position = start,
  end_position = end
)
</code></pre>


</div>