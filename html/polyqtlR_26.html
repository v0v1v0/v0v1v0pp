<div class="container">

<table style="width: 100%;"><tr>
<td>PVE</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>Function to determine the percentage variance explained (PVE) of a (maximal) QTL model, and explore sub-models.</h2>

<h3>Description</h3>

<p>This function builds a (maximal) QTL model from previously detected QTL peaks and outputs the percentage variance explained (PVE)
of the full QTL model and all sub-models. It uses a similar approach to the fitting of genetic co-factors in the function <code>QTLscan</code>.
The PVE is very similar to but not exactly equal to the adjusted R2 returned in <code>QTLscan</code> at each position (and note: in the former case, these
R2 values are per-locus, while this function can estimate the PVE combined over multiple loci). The discrepancy has to do with how PVE is calculated 
using the formula 100(1 - RSS0/RSS1), where RSS0 and RSS1 are the residual sums of squares of the NULL and QTL models, respectively.
</p>


<h3>Usage</h3>

<pre><code class="language-R">PVE(
  IBD_list,
  Phenotype.df,
  genotype.ID,
  trait.ID,
  block = NULL,
  QTL_df = NULL,
  prop_Pheno_rep = 0.5,
  log = NULL,
  verbose = FALSE
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>IBD_list</code></td>
<td>
<p>List of IBD probabilities</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>Phenotype.df</code></td>
<td>
<p>A data.frame containing phenotypic values</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>genotype.ID</code></td>
<td>
<p>The colname of <code>Phenotype.df</code> that contains the offspring identifiers (F1 names)</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>trait.ID</code></td>
<td>
<p>The colname of <code>Phenotype.df</code> that contains the response variable to use in the model</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>block</code></td>
<td>
<p>The blocking factor to be used, if any (must be colname of <code>Phenotype.df</code>). By default <code>NULL</code>, in 
which case no blocking structure (for unreplicated experiments)</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>QTL_df</code></td>
<td>
<p>A 2-column data frame of previously-detected QTL; column 1 gives linkage group identifiers, 
column 2 specifies the cM position of the QTL. If not specified, an error results. It can be convenient to generate a compatible
data.frame by first running the function <code>check_cofactors</code> to build a multi-QTL model.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>prop_Pheno_rep</code></td>
<td>
<p>The minimum proportion of phenotypes represented across blocks. If less than this, the individual is 
removed from the analysis. If there is incomplete data, the missing phenotypes are imputed using the mean values across the recorded observations.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>log</code></td>
<td>
<p>Character string specifying the log filename to which standard output should be written. If <code>NULL</code> log is send to stdout.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>verbose</code></td>
<td>
<p>Should messages be written to standard output?</p>
</td>
</tr>
</table>
<h3>Value</h3>

<p>A list with percentage variance explained of maximal QTL model and all sub-models
</p>


<h3>Examples</h3>

<pre><code class="language-R">data("IBD_4x","Phenotypes_4x")
PVE(IBD_list = IBD_4x,
    Phenotype.df = Phenotypes_4x,
    genotype.ID = "geno",trait.ID = "pheno",
    block = "year",
    QTL_df = data.frame(LG=1,cM=12.3))
</code></pre>


</div>