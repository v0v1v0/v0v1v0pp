<div class="container">

<table style="width: 100%;"><tr>
<td>gac</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>Test If Set Satisfies Generalized Adjustment Criterion (GAC)</h2>

<h3>Description</h3>

<p>This function tests if <code>z</code> satisfies  the Generalized Adjustment
Criterion (GAC) relative to <code>(x,y)</code> in the graph represented by
adjacency matrix <code>amat</code> and interpreted as <code>type</code> (DAG,
maximal PDAG, CPDAG, MAG, PAG). If yes, <code>z</code> can be used in covariate adjustment
for estimating causal effects of <code>x</code> on <code>y</code>.
</p>


<h3>Usage</h3>

<pre><code class="language-R">gac(amat, x, y, z, type = "pag")
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>amat</code></td>
<td>
<p>adjacency matrix of type amat.cpdag or amat.pag</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>x,y,z</code></td>
<td>
<p>(integer) positions of variables in <code>x</code>,
<code>y</code> or <code>z</code> in the adjacency matrix. <code>x</code>, <code>y</code> and
<code>z</code> can be vectors representing several nodes.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>type</code></td>
<td>
<p>string specifying the type of graph of the adjacency matrix
<code>amat</code>.  It can be a DAG (type="dag"), a PDAG (type="pdag") or a CPDAG (type="cpdag");
then the type of the adjacency matrix is assumed to be
amat.cpdag. It can also be a MAG (type="mag"), or a PAG
(type="pag"); then the type of the adjacency matrix is assumed to be
amat.pag.</p>
</td>
</tr>
</table>
<h3>Details</h3>

<p>This work is a generalization of the work of Shpitser et al. (2012)
(necessary and sufficient criterion in DAGs/ADMGs)
and van der Zander et al. (2014) (necessary and sufficient criterion
in MAGs). Moreover, it is a generalization of the
Generalized Backdoor Criterion (GBC) of Maathuis and Colombo (2013):
While GBC is sufficient but not necessary, GAC is both sufficient and
necessary for DAGs, CPDAGs, MAGs and PAGs. For more details see
Perkovic et al. (2015, 2017a, 2017b).
</p>
<p>The motivation to find a set <code>z</code> that satisfies the GAC with
respect to <code>(x,y)</code> is the following:
</p>
<p><em>A set of variables <code>z</code> satisfies the GAC relative to
<code>(x,y)</code> in the given graph, if and only if
the causal effect of <code>x</code> on <code>y</code> is identifiable by
covariate adjustment and is given by</em>
</p>
<p style="text-align: center;"><code class="reqn">%
    P(Y|do(X = x)) = \sum_Z P(Y|X,Z) \cdot P(Z),</code>
</p>

<p>(for any joint distribution “compatible” with the graph; the formula
is for discrete variables with straightforward modifications for
continuous variables).
This result allows to write post-intervention densities (the one
written using Pearl's do-calculus) using only observational densities
estimated from the data.
</p>
<p>For <code>z</code> to satisfy the GAC relative to <code>(x,y)</code> and the graph, the
following three conditions must hold:
</p>

<dl>
<dt>(0)</dt>
<dd>
<p> The graph is adjustment amenable relative to <code>(x,y)</code>.</p>
</dd>
<dt>(1)</dt>
<dd>
<p> The intersection of <code>z</code> and the forbidden set
(explained in Perkovic et al. (2015, 2017b) is empty.</p>
</dd>
<dt>(2)</dt>
<dd>
<p> All proper definite status non-causal paths in the graph from
<code>x</code> to <code>y</code> are blocked by <code>z</code>.</p>
</dd>
</dl>
<p>It is important to note that there can be <code>x</code> and
<code>y</code> for which there is no set Z that satisfies the GAC, but the
total causal effect might be identifiable via some technique other
than covariate adjustment.
</p>
<p>For details on the GAC for DAGs, CPDAGs, PAGs see Perkovic et. al (2015,2017a). For details on the GAC for MAGs see van der Zander et. al (2014) and for details on the GAC for maximal PDAGs see Perkovic et. al (2017b).
</p>
<p>For the coding of the adjacency matrix see amatType. The input
matrix can either be of class <code>matrix</code> or of class <code>amat</code>.
</p>


<h3>Value</h3>

<p>A <code>list</code> with three components:
</p>
<table>
<tr style="vertical-align: top;">
<td><code>gac</code></td>
<td>
<p>logical; TRUE if <code>z</code> satisfies the GAC relative to
<code>(x,y)</code> in the graph represented by <code>amat</code> and <code>type</code></p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>res</code></td>
<td>
<p>logical vector of length three indicating if each of the three
conditions (0), (1) and (2) are true</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>f</code></td>
<td>
<p>node positions of nodes in the forbidden set (see Perkovic
et al. (2015, 2017b)</p>
</td>
</tr>
</table>
<h3>Author(s)</h3>

<p>Emilija Perkovic and Markus Kalisch (<a href="mailto:kalisch@stat.math.ethz.ch">kalisch@stat.math.ethz.ch</a>)</p>


<h3>References</h3>

<p>E. Perkovic, J. Textor, M. Kalisch and M.H. Maathuis (2015). A
Complete Generalized Adjustment Criterion. In <em>Proceedings of UAI
2015.</em>
</p>
<p>E. Perkovic, J. Textor, M. Kalisch and M.H. Maathuis (2017a). Complete graphical characterization and construction of adjustment sets in Markov equivalence classes of ancestral graphs. To appear in <em>Journal of Machine Learning Research.</em>
</p>
<p>E. Perkovic, M. Kalisch and M.H. Maathuis (2017b). Interpreting and using CPDAGs with background knowledge. In <em>Proceedings of UAI 2017.</em>
</p>
<p>I. Shpitser, T. VanderWeele and J.M. Robins (2012). On the validity of
covariate adjustment for estimating causal effects. In
<em>Proceedings of UAI 2010.</em>
</p>
<p>B. van der Zander, M. Liskiewicz and J. Textor (2014). Constructing
separators and adjustment sets in ancestral graphs. In
<em>Proceedings of UAI 2014.</em>
</p>
<p>M.H. Maathuis and D. Colombo (2013). A generalized backdoor
criterion. <em>Annals of Statistics</em> 43 1060-1088.
</p>


<h3>See Also</h3>

<p><code>backdoor</code> for the Generalized Backdoor Criterion,
<code>pc</code> for estimating a CPDAG and <code>fci</code> and
<code>fciPlus</code> for estimating a PAG.
</p>


<h3>Examples</h3>

<pre><code class="language-R">
## We reproduce the four examples in Perkovic et. al (2015, 2017a)

##############################
## Example 4.1 in Perkovic et. al (2015), Example 2 in Perkovic et. al (2017a)
##############################
mFig1 &lt;- matrix(c(0,1,1,0,0,0, 1,0,1,1,1,0, 0,0,0,0,0,1,
                  0,1,1,0,1,1, 0,1,0,1,0,1, 0,0,0,0,0,0), 6,6)
type &lt;- "cpdag"
x &lt;- 3; y &lt;- 6
## Z satisfies GAC :
gac(mFig1, x,y, z=c(2,4),    type)
gac(mFig1, x,y, z=c(4,5),    type)
gac(mFig1, x,y, z=c(4,2,1),  type)
gac(mFig1, x,y, z=c(4,5,1),  type)
gac(mFig1, x,y, z=c(4,2,5),  type)
gac(mFig1, x,y, z=c(4,2,5,1),type)
## Z does not satisfy GAC :
gac(mFig1,x,y, z=2,    type)
gac(mFig1,x,y, z=NULL, type)

##############################
## Example 4.2 in Perkovic et. al (2015), Example 3 in Perkovic et. al (2017a)
##############################
mFig3a &lt;- matrix(c(0,1,0,0, 1,0,1,1, 0,1,0,1, 0,1,1,0), 4,4)
mFig3b &lt;- matrix(c(0,2,0,0, 3,0,3,3, 0,2,0,3, 0,2,2,0), 4,4)
mFig3c &lt;- matrix(c(0,3,0,0, 2,0,3,3, 0,2,0,3, 0,2,2,0), 4,4)
type &lt;- "pag"
x &lt;- 2; y &lt;- 4
## Z does not satisfy GAC
gac(mFig3a,x,y, z=NULL, type) ## not amenable rel. to (X,Y)
gac(mFig3b,x,y, z=NULL, type) ## not amenable rel. to (X,Y)
## Z satisfies GAC
gac(mFig3c,x,y, z=NULL, type) ## amenable rel. to (X,Y)

##############################
## Example 4.3 in Perkovic et. al (2015), Example 4 in Perkovic et. al (2017a)
##############################
mFig4a &lt;- matrix(c(0,0,1,0,0,0, 0,0,1,0,0,0, 2,2,0,3,3,2,
                   0,0,2,0,2,2, 0,0,2,1,0,2, 0,0,1,3,3,0), 6,6)
mFig4b &lt;- matrix(c(0,0,1,0,0,0, 0,0,1,0,0,0, 2,2,0,0,3,2,
                   0,0,0,0,2,2, 0,0,2,3,0,2, 0,0,2,3,2,0), 6,6)
type &lt;- "pag"
x &lt;- 3; y &lt;- 4
## both PAGs are amenable rel. to (X,Y)
## Z satisfies GAC in Fig. 4a
gac(mFig4a,x,y, z=6, type)
gac(mFig4a,x,y, z=c(1,6), type)
gac(mFig4a,x,y, z=c(2,6), type)
gac(mFig4a,x,y, z=c(1,2,6), type)
## no Z satisfies GAC in Fig. 4b
gac(mFig4b,x,y, z=NULL, type)
gac(mFig4b,x,y, z=6, type)
gac(mFig4b,x,y, z=c(5,6), type)

##############################
## Example 4.4 in Perkovic et. al (2015), Example 8 in Perkovic et. al (2017a)
##############################
mFig5a &lt;- matrix(c(0,1,0,0,0, 1,0,1,0,0, 0,0,0,0,1, 0,0,1,0,0, 0,0,0,0,0), 5,5)
type &lt;- "cpdag"
x &lt;- c(1,5); y &lt;- 4
## Z satisfies GAC
gac(mFig5a,x,y, z=c(2,3), type)
## Z does not satisfy GAC
gac(mFig5a,x,y, z=2, type)

mFig5b &lt;- matrix(c(0,1,0,0,0,0,0, 2,0,2,3,0,3,0, 0,1,0,0,0,0,0,
0,2,0,0,3,0,0, 0,0,0,2,0,2,3, 0,2,0,0,2,0,0, 0,0,0,0,2,0,0), 7,7)
type &lt;- "pag"
x&lt;-c(2,7); y&lt;-6
## Z satisfies GAC
gac(mFig5b,x,y, z=c(4,5), type)
gac(mFig5b,x,y, z=c(4,5,1), type)
gac(mFig5b,x,y, z=c(4,5,3), type)
gac(mFig5b,x,y, z=c(1,3,4,5), type)
## Z does not satisfy GAC
gac(mFig5b,x,y, z=NULL, type)

##############################
## Example 4.7 in Perkovic et. al (2017b)
##############################
mFig3a &lt;- matrix(c(0,1,0,0, 1,0,1,1, 0,1,0,1, 0,1,1,0), 4,4)
mFig3b &lt;- matrix(c(0,1,0,0, 0,0,1,1, 0,0,0,1, 0,0,1,0), 4,4)
mFig3c &lt;- matrix(c(0,0,0,0, 1,0,1,0, 0,1,0,1, 0,1,1,0), 4,4)
type &lt;- "pdag"
x &lt;- 2; y &lt;- 4
## Z does not satisfy GAC
gac(mFig3a,x,y, z=NULL, type) ## not amenable rel. to (X,Y)
gac(mFig3c,x,y, z=NULL, type) ## amenable rel. to (X,Y), but no set can block X &lt;- Y
## Z satisfies GAC
gac(mFig3b,x,y, z=NULL, type) ## amenable rel. to (X,Y)


</code></pre>


</div>