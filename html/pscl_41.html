<div class="container">

<table style="width: 100%;"><tr>
<td>igamma</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>inverse-Gamma distribution</h2>

<h3>Description</h3>

<p>Density, distribution function, quantile function, and highest density region calculation for the inverse-Gamma distribution with parameters <code>alpha</code> and <code>beta</code>.</p>


<h3>Usage</h3>

<pre><code class="language-R">	densigamma(x,alpha,beta)
  	pigamma(q,alpha,beta)
	qigamma(p,alpha,beta)
	rigamma(n,alpha,beta)
	igammaHDR(alpha,beta,content=.95,debug=FALSE)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>x,q</code></td>
<td>
<p>vector of quantiles</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>p</code></td>
<td>
<p>vector of probabilities</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>n</code></td>
<td>
<p>number of random samples in <code>rigamma</code></p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>alpha,beta</code></td>
<td>
<p>rate and shape parameters of the
inverse-Gamma density, both positive</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>content</code></td>
<td>
<p>scalar, 0 &lt; <code>content</code> &lt; 1, volume of
highest density region</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>debug</code></td>
<td>
<p>logical; if TRUE, debugging information from the
search for the HDR is printed</p>
</td>
</tr>
</table>
<h3>Details</h3>

<p>The inverse-Gamma density arises frequently in Bayesian
analysis of normal data, as the (marginal) conjugate prior for
the unknown variance parameter.  The inverse-Gamma density
for <code class="reqn">x&gt;0</code> with parameters <code class="reqn">\alpha&gt;0</code> and <code class="reqn">\beta&gt;0</code>
is
</p>
<p style="text-align: center;"><code class="reqn">f(x) = \frac{\beta^\alpha}{\Gamma(\alpha)} x^{-\alpha-1}
    \exp(-\beta/x)</code>
</p>

<p>where <code class="reqn">\Gamma(x)</code> is the <code>gamma</code> function
</p>
<p style="text-align: center;"><code class="reqn">\Gamma(a) = \int_0^\infty t^{a-1} \exp(-t) dt</code>
</p>

<p>and so ensures <code class="reqn">f(x)</code> integrates to one.  The
inverse-Gamma density has a mean at <code class="reqn">\beta/(\alpha-1)</code> for
<code class="reqn">\alpha&gt;1</code> and has variance <code class="reqn">\beta^2/((\alpha-1)^2
    (\alpha-2))</code> for
<code class="reqn">\alpha&gt;2</code>.  The inverse-Gamma density has a unique mode at
<code class="reqn">\beta/(\alpha+1)</code>.  
</p>
<p>The evaluation of the density,
cumulative distribution function and quantiles is done by
calls to the <code>dgamma</code>, <code>pgamma</code> and <code>igamma</code>
functions, with the arguments appropriately transformed.  That
is, note
that if <code class="reqn">x \sim IG(\alpha,\beta)</code> then <code class="reqn">1/x \sim
    G(\alpha,\beta)</code>.  
</p>
<p><em>Highest Density Regions</em>. In general, suppose <code class="reqn">x</code>
has a density <code class="reqn">f(x)</code>, where <code class="reqn">x \in \Theta</code>.  Then a
highest density region (HDR) for <code class="reqn">x</code> with content <code class="reqn">p
    \in (0,1]</code> is a region (or set of regions) <code class="reqn">\mathcal{Q}
    \subseteq \Theta</code> such that:
</p>
<p style="text-align: center;"><code class="reqn">\int_\mathcal{Q} f(x) dx = p</code>
</p>

<p>and
</p>
<p style="text-align: center;"><code class="reqn">f(x) &gt; f(x^*) \, \forall\ x \in \mathcal{Q},
    x^* \not\in \mathcal{Q}.</code>
</p>

<p>For a continuous, unimodal
density defined with respect to a single parameter (like the
inverse-Gamma case considered here with parameters <code class="reqn">0 &lt;
    \alpha &lt; \infty, \,\, 0 &lt; \beta &lt; \infty</code>), a HDR region <code class="reqn">Q</code>
of content <code class="reqn">p</code> (with <code class="reqn">0 &lt; p &lt; 1</code>) is a unique, closed
interval on the real half-line.
</p>
<p>This function uses numerical methods to solve for the
boundaries of a HDR with <code>content</code> <code class="reqn">p</code> for the
inverse-Gamma density, via repeated calls the functions
<code>densigamma</code>, <code>pigamma</code> and
<code>qigamma</code>. In particular, the function <code>uniroot</code> is used to
find points <code class="reqn">v</code> and <code class="reqn">w</code> such that </p>
<p style="text-align: center;"><code class="reqn">f(v) = f(w)</code>
</p>
<p> subject
to the constraint
</p>
<p style="text-align: center;"><code class="reqn">\int_v^w f(x; \alpha, \beta) d\theta = p.</code>
</p>



<h3>Value</h3>

<p><code>densigamma</code> gives the density, <code>pigamma</code> the
distribution function, <code>qigamma</code> the quantile function,
<code>rigamma</code> generates random samples, and <code>igammaHDR</code> gives
the lower and upper limits of the HDR, as defined above (<code>NA</code>s if
the optimization is not successful).
</p>


<h3>Note</h3>

<p>The <code>densigamma</code> is named so as not to conflict with the
<code>digamma</code> function in the R <code>base</code> package
(the derivative of the <code>gamma</code> function).
</p>


<h3>Author(s)</h3>

<p>Simon Jackman <a href="mailto:simon.jackman@sydney.edu.au">simon.jackman@sydney.edu.au</a></p>


<h3>See Also</h3>

<p><code>gamma</code>, <code>dgamma</code>,
<code>pgamma</code>, <code>qgamma</code>, <code>uniroot</code></p>


<h3>Examples</h3>

<pre><code class="language-R">alpha &lt;- 4
beta &lt;- 30
summary(rigamma(n=1000,alpha,beta))

xseq &lt;- seq(.1,30,by=.1)
fx &lt;- densigamma(xseq,alpha,beta)
plot(xseq,fx,type="n",
     xlab="x",
     ylab="f(x)",
     ylim=c(0,1.01*max(fx)),
     yaxs="i",
     axes=FALSE)
axis(1)
title(substitute(list(alpha==a,beta==b),list(a=alpha,b=beta)))
q &lt;- igammaHDR(alpha,beta,debug=TRUE)
xlo &lt;- which.min(abs(q[1]-xseq))
xup &lt;- which.min(abs(q[2]-xseq))
plotZero &lt;- par()$usr[3]
polygon(x=xseq[c(xlo,xlo:xup,xup:xlo)],
        y=c(plotZero,
          fx[xlo:xup],
          rep(plotZero,length(xlo:xup))),
        border=FALSE,
        col=gray(.45))
lines(xseq,fx,lwd=1.25)


## Not run: 
alpha &lt;- beta &lt;- .1
xseq &lt;- exp(seq(-7,30,length=1001))
fx &lt;- densigamma(xseq,alpha,beta)
plot(xseq,fx,
     log="xy",
     type="l",
     ylim=c(min(fx),1.01*max(fx)),
     yaxs="i",
     xlab="x, log scale",
     ylab="f(x), log scale",
     axes=FALSE)
axis(1)

title(substitute(list(alpha==a,beta==b),list(a=alpha,b=beta)))
q &lt;- igammaHDR(alpha,beta,debug=TRUE)
xlo &lt;- which.min(abs(q[1]-xseq))
xup &lt;- which.min(abs(q[2]-xseq))
plotZero &lt;- min(fx)
polygon(x=xseq[c(xlo,xlo:xup,xup:xlo)],
        y=c(plotZero,
          fx[xlo:xup],
          rep(plotZero,length(xlo:xup))),
        border=FALSE,
        col=gray(.45))
lines(xseq,fx,lwd=1.25)

## End(Not run)
</code></pre>


</div>