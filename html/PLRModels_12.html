<div class="container">

<table style="width: 100%;"><tr>
<td>par.ancova</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>
Parametric analysis of covariance (based on linear models)
</h2>

<h3>Description</h3>

<p>This routine tests the equality of <code class="reqn">L</code> vector coefficients, (<code class="reqn">\beta_1, ..., \beta_L</code>), from samples <code class="reqn">{(Y_{ki}, X_{ki1},...,X_{kip})}</code>: 
<code class="reqn">i=1,...,n</code>, <code class="reqn">k=1,...,L</code>, where:
</p>
<p style="text-align: center;"><code class="reqn">\beta_k = (\beta_{k1},...,\beta_{kp})</code>
</p>

<p>is an unknown vector parameter and
</p>
<p style="text-align: center;"><code class="reqn">Y_{ki} = X_{ki1}*\beta_{k1}+ ... + X_{kip}*\beta_{kp} + \epsilon_{ki}.</code>
</p>

<p>The random errors, <code class="reqn">\epsilon_{ki}</code>, are allowed to be time series. The test statistic used for testing the null hypothesis, <code class="reqn">H0: \beta_1 = ...= \beta_L</code>, derives from the asymptotic normality of the ordinary least squares estimator of <code class="reqn">\beta_k</code> (<code class="reqn">k=1,...,L</code>), this result giving a <code class="reqn">\chi^2</code>-test.
</p>


<h3>Usage</h3>

<pre><code class="language-R">par.ancova(data = data, time.series = FALSE, Var.Cov.eps = NULL, 
p.max = 3, q.max = 3, ic = "BIC", num.lb = 10, alpha = 0.05)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>data</code></td>
<td>

<p><code>data[, 1, k]</code> contains the values of the response variable, <code class="reqn">Y_k</code>, for each model k (<code class="reqn">k=1, ..., L</code>);
</p>
<p><code>data[, 2:(p+1), k]</code> contains the values of the explanatory variables, 
</p>
<p><code class="reqn">X_{k1}, ..., X_{kp}</code>, for each model k (<code class="reqn">k=1, ..., L</code>).
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>time.series</code></td>
<td>
<p>it denotes whether the data is independent (FALSE) or if data is a time series (TRUE). The default is FALSE.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>Var.Cov.eps</code></td>
<td>
<p><code>Var.Cov.eps[, , k]</code> contains the <code>n x n</code> matrix of variances-covariances associated to the random errors of the regression model k (<code class="reqn">k=1, ..., L</code>). If NULL (the default), the function tries to estimate it: it fits an ARMA model (selected according to an information criterium) to the residuals from the fitted linear regression model and, then, it obtains the var-cov matrix of such ARMA model.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>p.max</code></td>
<td>
<p>if <code>Var.Cov.eps=NULL</code>, the ARMA models are selected between the models ARMA(p,q) with 0&lt;=p&lt;=p.max and 0&lt;=q&lt;=q.max. The default is 3.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>q.max</code></td>
<td>
<p>if <code>Var.Cov.eps=NULL</code>, the ARMA models are selected between the models ARMA(p,q) with 0&lt;=p&lt;=p.max and 0&lt;=q&lt;=q.max. The default is 3.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>ic</code></td>
<td>
<p>if <code>Var.Cov.eps=NULL</code>, <code>ic</code> contains the information criterion used to suggest the ARMA models. It allows us to choose between: "AIC", "AICC" or "BIC" (the default).</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>num.lb</code></td>
<td>
<p>if <code>Var.Cov.eps=NULL</code>, it checks the suitability of the ARMA models according to the Ljung-Box and the t.test. It uses up to <code>num.lb</code> delays in the Ljung-Box test. The default is 10.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>alpha</code></td>
<td>
<p>if <code>Var.Cov.eps=NULL</code>, <code>alpha</code> contains the significance level (default is 0.05) which the ARMA models are checked.</p>
</td>
</tr>
</table>
<h3>Details</h3>

<p>If <code>Var.Cov.eps=NULL</code> and the routine is not able to suggest an approximation for <code>Var.Cov.eps</code>, it warns the user with a message saying that the model could be not appropriate and then it shows the results. In order to construct <code>Var.Cov.eps</code>, the procedure suggested in Domowitz (1982) can be followed.
</p>
<p>The implemented procedure particularizes the parametric test in the routine <code>plrm.ancova</code> to the case where is known that the nonparametric components in the corresponding PLR models are null.
</p>


<h3>Value</h3>

<p>A list with a dataframe containing:
</p>
<table>
<tr style="vertical-align: top;">
<td><code>Q.beta</code></td>
<td>
<p>value of the test statistic.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>p.value</code></td>
<td>
<p>p-value of the corresponding statistic test.</p>
</td>
</tr>
</table>
<p>Moreover, if <code>data</code> is a time series and <code>Var.Cov.eps</code> is not especified:
</p>
<table>
<tr style="vertical-align: top;">
<td><code>pv.Box.test</code></td>
<td>
<p>p-values of the Ljung-Box test for the model fitted to the residuals.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>pv.t.test</code></td>
<td>
<p>p-values of the t.test for the model fitted to the residuals.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>ar.ma</code></td>
<td>
<p>ARMA orders for the model fitted to the residuals.</p>
</td>
</tr>
</table>
<h3>Author(s)</h3>

<p>German Aneiros Perez <a href="mailto:ganeiros@udc.es">ganeiros@udc.es</a>
</p>
<p>Ana Lopez Cheda <a href="mailto:ana.lopez.cheda@udc.es">ana.lopez.cheda@udc.es</a></p>


<h3>References</h3>

<p>Domowitz, J. (1982) The linear model with stochastic regressors and heteroscedastic dependent errors. Discussion paper No 543, Center for Mathematical studies in Economic and Management Science, Northwestern University, Evanston, Illinois.
</p>
<p>Judge, G.G., Griffiths, W.E., Carter Hill, R., Lutkepohl, H. and Lee, T-C. (1980) <em>The Theory and Practice of Econometrics</em>. Wiley.
</p>
<p>Seber, G.A.F. (1977) <em>Linear Regression Analysis</em>. Wiley.
</p>


<h3>See Also</h3>

<p>Other related functions are <code>np.ancova</code> and <code>plrm.ancova</code>.
</p>


<h3>Examples</h3>

<pre><code class="language-R"># EXAMPLE 1: REAL DATA
data(barnacles1)
data &lt;- as.matrix(barnacles1)
data &lt;- diff(data, 12)
data &lt;- cbind(data[,1],1,data[,-1])

data(barnacles2)
data2 &lt;- as.matrix(barnacles2)
data2 &lt;- diff(data2, 12)
data2 &lt;- cbind(data2[,1],1,data2[,-1])

data3 &lt;- array(0, c(nrow(data),ncol(data),2))
data3[,,1] &lt;- data
data3[,,2] &lt;- data2

par.ancova(data=data3)



# EXAMPLE 2: SIMULATED DATA
## Example 2a: dependent data - true null hypothesis

set.seed(1234)
# We generate the data
n &lt;- 100
t &lt;- ((1:n)-0.5)/n
beta &lt;- c(0.05, 0.01)

x1 &lt;- matrix(rnorm(200,0,1), nrow=n)
sum1 &lt;- x1%*%beta
epsilon1 &lt;- arima.sim(list(order = c(1,0,0), ar=0.7), sd = 0.01, n = n)
y1 &lt;-  sum1 + epsilon1
data1 &lt;- cbind(y1,x1)

x2 &lt;- matrix(rnorm(200,1,2), nrow=n)
sum2 &lt;- x2%*%beta
epsilon2 &lt;- arima.sim(list(order = c(0,0,1), ma=0.5), sd = 0.02, n = n)
y2 &lt;- sum2 + epsilon2
data2 &lt;- cbind(y2,x2)

data_eq &lt;- array(cbind(data1,data2),c(100,3,2))

# We apply the test
par.ancova(data_eq, time.series=TRUE)


## Example 2a: dependent data - false null hypothesis
# We generate the data
n &lt;- 100
beta3 &lt;- c(0.05, 0.01)
beta4 &lt;- c(0.05, 0.02)

x3 &lt;- matrix(rnorm(200,0,1), nrow=n)
sum3 &lt;- x3%*%beta3
epsilon3 &lt;- arima.sim(list(order = c(1,0,0), ar=0.7), sd = 0.01, n = n)
y3 &lt;-  sum3 + epsilon3
data3 &lt;- cbind(y3,x3)

x4 &lt;- matrix(rnorm(200,1,2), nrow=n)
sum4 &lt;- x4%*%beta4
epsilon4 &lt;- arima.sim(list(order = c(0,0,1), ma=0.5), sd = 0.02, n = n)
y4 &lt;-  sum4 + epsilon4
data4 &lt;- cbind(y4,x4)

data_neq &lt;- array(cbind(data3,data4),c(100,3,2))

# We apply the test
par.ancova(data_neq, time.series=TRUE) 

</code></pre>


</div>