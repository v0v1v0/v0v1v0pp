<div class="container">

<table style="width: 100%;"><tr>
<td>CO2_conductance</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>Conductance to CO2 (mol / m^2 / s)</h2>

<h3>Description</h3>

<p>Conductance to CO2 (mol / m^2 / s)
</p>

<ul><li>
<p> g_tc: total conductance to CO2
</p>
</li></ul>
<ul><li>
<p> g_uc: cuticular conductance to CO2
</p>
</li></ul>
<ul><li>
<p> g_bc: boundary layer conductance to CO2
</p>
</li></ul>
<ul><li>
<p> g_mc: mesophyll conductance to CO2
</p>
</li></ul>
<ul><li>
<p> g_sc: stomatal conductance to CO2
</p>
</li></ul>
<h3>Usage</h3>

<pre><code class="language-R">.get_gtc(pars, unitless, use_legacy_version)

.get_guc(pars, surface, unitless)

.get_gbc(pars, surface, unitless, use_legacy_version)

.get_gmc(pars, surface, unitless)

.get_gsc(pars, surface, unitless)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>pars</code></td>
<td>
<p>Concatenated parameters (<code>leaf_par</code>, <code>enviro_par</code>, and <code>constants</code>)</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>unitless</code></td>
<td>
<p>Logical. Should <code>units</code> be set? The function is faster when FALSE, but input must be in correct units or else results will be incorrect without any warning.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>use_legacy_version</code></td>
<td>
<p>Logical. Should legacy model (&lt;2.1.0) be used? See <a href="https://github.com/cdmuir/photosynthesis/blob/master/NEWS.md">NEWS</a> for further information. Default is FALSE.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>surface</code></td>
<td>
<p>Leaf surface (lower or upper)</p>
</td>
</tr>
</table>
<h3>Details</h3>

<p><strong>Default conductance model</strong>
</p>
<p>The conductance model described in this section is used by default unless
additional anatomical parameters described in the next section are provided.
</p>
<p>Total conductance to CO2 is the sum of parallel conductances on the lower
(<code class="reqn">g_\mathrm{c,lower}</code>) and upper
(<code class="reqn">g_\mathrm{c,upper}</code>) leaf portions:
</p>
<p style="text-align: center;"><code class="reqn">g_\mathrm{c,total} = g_\mathrm{c,lower} + g_\mathrm{c,upper}</code>
</p>

<p>Each partial conductance consists of two parallel conductances, the
cuticular conductance (<code class="reqn">g_\mathrm{u,c}</code>) and the in-series
conductances through mesophyll (<code class="reqn">g_\mathrm{m,c}</code>), stomata (<code class="reqn">g_\mathrm{s,c}</code>), and boundary layer (<code class="reqn">g_\mathrm{b,c}</code>). To simplify the formula, I use substitute resistance where <code class="reqn">r_x = 1 / g_x</code>. For surface <code class="reqn">i</code>:
</p>
<p style="text-align: center;"><code class="reqn">g_{\mathrm{c},i} = g_{\mathrm{u},i} + (1 / (r_{\mathrm{m},i} + r_{\mathrm{s},i} + r_{\mathrm{b},i}))</code>
</p>

<p>The cuticular, stomatal, and mesophyll conductances can be the same or
different for upper and lower. The partitioning factors (<code class="reqn">k_x</code>) divide the conductance between surfaces while keeping the total conductance constant:
</p>
<p style="text-align: center;"><code class="reqn">g_{x,\mathrm{lower}} = g_x (1 / (1 + k_x))</code>
</p>

<p style="text-align: center;"><code class="reqn">g_{x,\mathrm{upper}} = g_x (k_x / (1 + k_x))</code>
</p>

<p style="text-align: center;"><code class="reqn">g_x = g_{x,\mathrm{lower}} + g_{x,\mathrm{upper}}</code>
</p>

<p>How the partitioning factors work: <br></p>

<table>
<tr>
<td style="text-align: left;">
<code class="reqn">k_x</code> </td>
<td style="text-align: left;"> description </td>
</tr>
<tr>
<td style="text-align: left;">
0 </td>
<td style="text-align: left;"> all conductance on <strong>lower</strong> surface/portion </td>
</tr>
<tr>
<td style="text-align: left;">
0.5 </td>
<td style="text-align: left;"> 2/3 conductance on <strong>lower</strong> surface </td>
</tr>
<tr>
<td style="text-align: left;">
1 </td>
<td style="text-align: left;"> conductance evenly divided between surfaces/portions </td>
</tr>
<tr>
<td style="text-align: left;">
2 </td>
<td style="text-align: left;"> 2/3 conductance on <strong>upper</strong> surface </td>
</tr>
<tr>
<td style="text-align: left;">
Inf </td>
<td style="text-align: left;"> all conductance on <strong>upper</strong> surface/portion
</td>
</tr>
</table>
<p>The boundary layer conductances for each are calculated on the basis of mass
and heat transfer (see <code>.get_gbc()</code>).
</p>

<table>
<tr>
<td style="text-align: left;">
<em>Symbol</em> </td>
<td style="text-align: left;"> <em>R</em> </td>
<td style="text-align: left;"> <em>Description</em> </td>
<td style="text-align: left;"> <em>Units</em> </td>
<td style="text-align: left;"> <em>Default</em>
</td>
</tr>
<tr>
<td style="text-align: left;">
<code class="reqn">g_\mathrm{mc}</code> </td>
<td style="text-align: left;"> <code>g_mc</code> </td>
<td style="text-align: left;"> mesophyll conductance to CO2 (T_leaf) </td>
<td style="text-align: left;"> mol / m<code class="reqn">^2</code> / s </td>
<td style="text-align: left;"> calculated </td>
</tr>
<tr>
<td style="text-align: left;">
<code class="reqn">g_\mathrm{sc}</code> </td>
<td style="text-align: left;"> <code>g_sc</code> </td>
<td style="text-align: left;"> stomatal conductance to CO2 </td>
<td style="text-align: left;"> mol / m<code class="reqn">^2</code> / s </td>
<td style="text-align: left;"> 0.4 </td>
</tr>
<tr>
<td style="text-align: left;">
<code class="reqn">g_\mathrm{uc}</code> </td>
<td style="text-align: left;"> <code>g_uc</code> </td>
<td style="text-align: left;"> cuticular conductance to CO2 </td>
<td style="text-align: left;"> mol / m<code class="reqn">^2</code> / s </td>
<td style="text-align: left;"> 0.01 </td>
</tr>
<tr>
<td style="text-align: left;">
<code class="reqn">k_\mathrm{mc}</code> </td>
<td style="text-align: left;"> <code>k_mc</code> </td>
<td style="text-align: left;"> partition of <code class="reqn">g_\mathrm{mc}</code> to lower mesophyll </td>
<td style="text-align: left;"> none </td>
<td style="text-align: left;"> 1 </td>
</tr>
<tr>
<td style="text-align: left;">
<code class="reqn">k_\mathrm{sc}</code> </td>
<td style="text-align: left;"> <code>k_sc</code> </td>
<td style="text-align: left;"> partition of <code class="reqn">g_\mathrm{sc}</code> to lower surface </td>
<td style="text-align: left;"> none </td>
<td style="text-align: left;"> 1 </td>
</tr>
<tr>
<td style="text-align: left;">
<code class="reqn">k_\mathrm{uc}</code> </td>
<td style="text-align: left;"> <code>k_uc</code> </td>
<td style="text-align: left;"> partition of <code class="reqn">g_\mathrm{uc}</code> to lower surface </td>
<td style="text-align: left;"> none </td>
<td style="text-align: left;"> 1 </td>
</tr>
<tr>
<td style="text-align: left;">
</td>
</tr>
</table>
<p><strong>New conductance model</strong>
</p>
<p>The conductance model described in this section is implemented in
<strong>photosynthesis</strong> (&gt;= 2.1.0) if parameters to calculate the internal
airspace and liquid-phase conductances (<code>A_mes_A</code>, <code>g_liqc</code>) are
provided. These parameters are 1) the effective path lengths through the
lower and upper leaf internal airspaces (<code>delta_ias_lower</code>,
<code>delta_ias_upper</code>) and 2) the mesophyll area per leaf area
(<code>A_mes_A</code>) and liquid-phase conductance per mesophyll cell area
(<code>g_liqc</code>).
</p>
<p>Two parallel diffusion pathways, one from each leaf surface, converge to a
single CO2 concentration at the mesophyll cell boundary. We use a single
liquid-phase resistance to represent the combined cell wall, plasmalemma, and
chloroplast resistances. The gas-phase resistance through boundary layer,
cuticle/stomata, and internal airspace is <code class="reqn">r_\mathrm{gas,c}</code>; the
liquid-phase intracellular resistance is <code class="reqn">r_\mathrm{i,c}</code>.
</p>
<p style="text-align: center;"><code class="reqn">r_\mathrm{total,c} = r_\mathrm{gas,c} + r_\mathrm{i,c}</code>
</p>

<p>The gas-phase resistance occurs through two parallel pathways, which we refer
to as the 'lower' and 'upper' pathways because horizontally oriented leaves
often have different anatomical properties on each surface. The gas-phase
resistance through pathway <code class="reqn">i \in \{\textrm{lower,upper\}}</code> is:
</p>
<p style="text-align: center;"><code class="reqn">r_{\mathrm{gas,c},i} = r_{\mathrm{b,c},i} + r_{\mathrm{u+s,c},i} + r_{\mathrm{ias,c},i}</code>
</p>

<p>The subscripts <code class="reqn">_\mathrm{b}</code>, <code class="reqn">_\mathrm{u+s}</code>, and <code class="reqn">_\mathrm{ias}</code>
denote boundary layer, cuticular + stomatal, and internal airspace,
respectively. The subscript <code class="reqn">_\mathrm{c}</code> indicates we are considering
the conductance to CO2 rather than another molecular species.
</p>
<p>Cuticular and stomatal conductances (1 / resistance) are parallel, so:
</p>
<p style="text-align: center;"><code class="reqn">1 / r_{\mathrm{u+s,c},i} = g_{\mathrm{u+s,c},i} = g_{\mathrm{u,c},i} + g_{\mathrm{s,c},i}</code>
</p>

<p>Substituting the above expression into the equation for <code class="reqn">r_{\mathrm{gas,c},i}</code>:
</p>
<p style="text-align: center;"><code class="reqn">r_{\mathrm{gas,c},i} = r_{\mathrm{b,c},i} + 1 / (g_{\mathrm{u,c},i} = g_{\mathrm{s,c},i}) + r_{\mathrm{ias,c},i}</code>
</p>

<p>The total gas-phase resistance is the inverse of the sum of the parallel
lower and upper conductances:
</p>
<p style="text-align: center;"><code class="reqn">1 / r_{\mathrm{gas,c}} = g_\mathrm{gas,c,lower} + g_\mathrm{gas,c,upper}</code>
</p>

<p>The cuticular, stomatal, and mesophyll conductances can be the same or
different for upper and lower. The partitioning factors <code class="reqn">k_u</code> and <code class="reqn">k_s</code>
divide the total cuticular and stomatal conductances, respectively, between
surfaces while keeping the total conductance constant:
</p>
<p style="text-align: center;"><code class="reqn">g_{x,\mathrm{lower}} = g_x (1 / (1 + k_x))</code>
</p>

<p style="text-align: center;"><code class="reqn">g_{x,\mathrm{upper}} = g_x (k_x / (1 + k_x))</code>
</p>

<p style="text-align: center;"><code class="reqn">g_x = g_{x,\mathrm{lower}} + g_{x,\mathrm{upper}}</code>
</p>

<p>How the partitioning factors work: <br></p>

<table>
<tr>
<td style="text-align: left;">
<code class="reqn">k_x</code> </td>
<td style="text-align: left;"> description </td>
</tr>
<tr>
<td style="text-align: left;">
0 </td>
<td style="text-align: left;"> all conductance on <strong>lower</strong> surface/portion </td>
</tr>
<tr>
<td style="text-align: left;">
0.5 </td>
<td style="text-align: left;"> 2/3 conductance on <strong>lower</strong> surface </td>
</tr>
<tr>
<td style="text-align: left;">
1 </td>
<td style="text-align: left;"> conductance evenly divided between surfaces/portions </td>
</tr>
<tr>
<td style="text-align: left;">
2 </td>
<td style="text-align: left;"> 2/3 conductance on <strong>upper</strong> surface </td>
</tr>
<tr>
<td style="text-align: left;">
Inf </td>
<td style="text-align: left;"> all conductance on <strong>upper</strong> surface/portion
</td>
</tr>
</table>
<p>The internal airspace conductance is the diffusivity of CO2 at a given
temperature and pressure divided by the effective path length:
</p>
<p style="text-align: center;"><code class="reqn">g_\mathrm{ias,c,lower} = D_\mathrm{c} / \delta_\mathrm{ias,lower}</code>
</p>

<p style="text-align: center;"><code class="reqn">g_\mathrm{ias,c,upper} = D_\mathrm{c} / \delta_\mathrm{ias,upper}</code>
</p>

<p><code>g_iasc_lower</code> and <code>g_iasc_upper</code> are calculated in the bake
function. See <code>tealeaves::.get_Dx()</code> for calculating <code>D_c</code>.
</p>
<p>The liquid-phase intracellular resistance is given by:
</p>
<p style="text-align: center;"><code class="reqn">1 / r_\mathrm{i,c} = g_\mathrm{i,c} = g_\mathrm{liq,c} A_\mathrm{mes} / A</code>
</p>

<p><code class="reqn">g_\mathrm{liq,c}</code> is temperature sensitive. See <code>bake()</code>.
</p>
<p>The boundary layer conductances for each are calculated on the basis of mass
and heat transfer (see <code>.get_gbc()</code>).
</p>


</div>