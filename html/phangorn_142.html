<div class="container">

<table style="width: 100%;"><tr>
<td>multiphyDat2pmlPart</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>Partition model.</h2>

<h3>Description</h3>

<p>Model to estimate phylogenies for partitioned data.
</p>


<h3>Usage</h3>

<pre><code class="language-R">multiphyDat2pmlPart(x, method = "unrooted", tip.dates = NULL, ...)

pmlPart2multiPhylo(x)

pmlPart(formula, object, control = pml.control(epsilon = 1e-08, maxit = 10,
  trace = 1), model = NULL, method = "unrooted", ...)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>x</code></td>
<td>
<p>an object of class <code>pmlPart</code></p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>method</code></td>
<td>
<p>One of "unrooted", "ultrametric" or "tiplabeled". Only unrooted
is properly supported right now.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>tip.dates</code></td>
<td>
<p>A named vector of sampling times associated to the
tips/sequences. Leave empty if not estimating tip dated phylogenies.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>...</code></td>
<td>
<p>Further arguments passed to or from other methods.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>formula</code></td>
<td>
<p>a formula object (see details).</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>object</code></td>
<td>
<p>an object of class <code>pml</code> or a list of objects of class
<code>pml</code> .</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>control</code></td>
<td>
<p>A list of parameters for controlling the fitting process.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>model</code></td>
<td>
<p>A vector containing the models containing a model for each
partition.</p>
</td>
</tr>
</table>
<h3>Details</h3>

<p>The <code>formula</code> object allows to specify which parameter get optimized.
The formula is generally of the form <code>edge + bf + Q ~ rate + shape +
...{}</code>, on the left side are the parameters which get optimized over all
partitions, on the right the parameter which are optimized specific to each
partition. The parameters available are <code>"nni", "bf", "Q", "inv",
"shape", "edge", "rate"</code>.  Each parameters can be used only once in the
formula.  <code>"rate"</code> is only available for the right side of the formula.
</p>
<p>For partitions with different edge weights, but same topology, <code>pmlPen</code>
can try to find more parsimonious models (see example).
</p>
<p><code>pmlPart2multiPhylo</code> is a convenience function to extract the trees out
of a <code>pmlPart</code> object.
</p>


<h3>Value</h3>

<p><code>kcluster</code> returns a list with elements
</p>
<table>
<tr style="vertical-align: top;">
<td><code>logLik</code></td>
<td>
<p>log-likelihood of the fit</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>trees</code></td>
<td>
<p>a list of all trees
during the optimization.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>object</code></td>
<td>
<p>an object of class <code>"pml"</code> or
<code>"pmlPart"</code></p>
</td>
</tr>
</table>
<h3>Author(s)</h3>

<p>Klaus Schliep <a href="mailto:klaus.schliep@gmail.com">klaus.schliep@gmail.com</a>
</p>


<h3>See Also</h3>

<p><code>pml</code>,<code>pmlCluster</code>,<code>pmlMix</code>,
<code>SH.test</code>
</p>


<h3>Examples</h3>

<pre><code class="language-R">
data(yeast)
dm &lt;- dist.logDet(yeast)
tree &lt;- NJ(dm)
fit &lt;- pml(tree,yeast)
fits &lt;- optim.pml(fit)

weight=xtabs(~ index+genes,attr(yeast, "index"))[,1:10]

sp &lt;- pmlPart(edge ~ rate + inv, fits, weight=weight)
sp

## Not run: 
sp2 &lt;- pmlPart(~ edge + inv, fits, weight=weight)
sp2
AIC(sp2)

sp3 &lt;- pmlPen(sp2, lambda = 2)
AIC(sp3)

## End(Not run)

</code></pre>


</div>