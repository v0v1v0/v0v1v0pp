<div class="container">

<table style="width: 100%;"><tr>
<td>full_enumeration_pep</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>Bayesian variable selection through exhaustive search</h2>

<h3>Description</h3>

<p>Given a response vector and an input data matrix, performs Bayesian variable 
selection using full enumeration of the model space. Normal linear 
models are assumed for the data with the prior distribution on the model 
parameters (beta coefficients and error variance) being the PEP or the intrinsic. 
The prior distribution on the model space can be the uniform on the model 
space or the uniform on the model dimension (special case of the beta-binomial prior).
The model space consists of all possible models including an intercept term.
</p>


<h3>Usage</h3>

<pre><code class="language-R">full_enumeration_pep(
  x,
  y,
  intrinsic = FALSE,
  reference.prior = TRUE,
  beta.binom = TRUE,
  ml_constant.term = FALSE
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>x</code></td>
<td>
<p>A matrix of numeric (of size nxp), input data matrix. 
This matrix contains the values of the p explanatory variables 
without an intercept column of 1's.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>y</code></td>
<td>
<p>A vector of numeric (of length n), response vector.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>intrinsic</code></td>
<td>
<p>Boolean, indicating whether the PEP 
(<code>FALSE</code>) or the intrinsic - which   
is a special case of it - (<code>TRUE</code>) should be used as prior on the  
regression parameters. Default value=<code>FALSE</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>reference.prior</code></td>
<td>
<p>Boolean, indicating whether the reference prior
(<code>TRUE</code>) or the dependence Jeffreys prior (<code>FALSE</code>) is used as 
baseline. Default value=<code>TRUE</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>beta.binom</code></td>
<td>
<p>Boolean, indicating whether the beta-binomial 
distribution (<code>TRUE</code>) or the uniform distribution (<code>FALSE</code>)    
should be used as prior on the model space. Default value=<code>TRUE</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>ml_constant.term</code></td>
<td>
<p>Boolean, indicating whether the constant
(marginal likelihood of the null/intercept-only model) should be
included in computing the marginal likelihood of a model (<code>TRUE</code>)  
or not (<code>FALSE</code>). Default value=<code>FALSE</code>.</p>
</td>
</tr>
</table>
<h3>Details</h3>

<p>The function works when p&lt;=n-2 where p is the number of explanatory variables
and n is the sample size.
</p>
<p>It is suggested to use this function (i.e. enumeration of the model space) 
when p is up to 20.
</p>
<p>The reference model is the null model (i.e. intercept-only model).
</p>
<p>The case of missing data (i.e. presence of <code>NA</code>'s either in the  
input data matrix or the response vector) is not currently supported.
</p>
<p>All models considered (i.e. model space) include an intercept term.
</p>
<p>If p&gt;1, the input data matrix needs to be of full rank.
</p>
<p>The reference prior as baseline corresponds to hyperparameter values
d0=0 and d1=0, while the dependence Jeffreys prior corresponds to 
model-dependent-based values for the hyperparameters d0 and d1,
see Fouskakis and Ntzoufras (2022) for more details.
</p>
<p>For computing the marginal likelihood of a model, Equation 16 of 
Fouskakis and Ntzoufras (2022) is used.
</p>
<p>When <code>ml_constant.term=FALSE</code> then the log marginal likelihood of a
model in the output is shifted by -logC1
(logC1: log marginal likelihood of the null model).
</p>
<p>When the prior on the model space is beta-binomial 
(i.e. <code>beta.binom=TRUE</code>), the following special case is used: uniform 
prior on model dimension.
</p>


<h3>Value</h3>

<p><code>full_enumeration_pep</code> returns an object of class <code>pep</code>, 
i.e. a list with the following elements:
</p>
<table>
<tr style="vertical-align: top;">
<td><code>models</code></td>
<td>
<p>A matrix containing information about the models examined. 
In particular, in row i after representing the model i with variable inclusion 
indicators, its marginal likelihood (in log scale), the R2, its dimension  
(including the intercept), the corresponding Bayes factor, 
posterior odds and its posterior probability are contained. The models
are sorted in decreasing order of the posterior probability. For the 
Bayes factor and the posterior odds, the comparison is done to the model 
with the largest posterior probability.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>inc.probs</code></td>
<td>
<p>A named vector with the posterior inclusion probabilities of the 
explanatory variables.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>x</code></td>
<td>
<p>The input data matrix (of size nxp).</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>y</code></td>
<td>
<p>The response vector (of length n).</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>intrinsic</code></td>
<td>
<p>Whether the prior on the model parameters was PEP or intrinsic.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>reference.prior</code></td>
<td>
<p>Whether the baseline prior was the reference prior
or the dependence Jeffreys prior.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>beta.binom</code></td>
<td>
<p>Whether the prior on the model space was beta-binomial or
uniform.</p>
</td>
</tr>
</table>
<h3>References</h3>

<p>Fouskakis, D. and Ntzoufras, I. (2022) Power-Expected-Posterior 
Priors as Mixtures of g-Priors in Normal Linear Models. 
Bayesian Analysis, 17(4): 1073-1099. <a href="https://doi.org/10.1214/21-BA1288">doi:10.1214/21-BA1288</a>
</p>


<h3>See Also</h3>

<p><code>mc3_pep</code>
</p>


<h3>Examples</h3>

<pre><code class="language-R">data(UScrime_data)
y &lt;- UScrime_data[,"y"]
X &lt;- UScrime_data[,-15]
res &lt;- full_enumeration_pep(X,y)
resu &lt;- full_enumeration_pep(X,y,beta.binom=FALSE)
resi &lt;- full_enumeration_pep(X,y,intrinsic=TRUE)
resiu &lt;- full_enumeration_pep(X,y,intrinsic=TRUE,beta.binom=FALSE)
resj &lt;- full_enumeration_pep(X,y,reference.prior=FALSE)

</code></pre>


</div>