<div class="container">

<table style="width: 100%;"><tr>
<td>optPenaltyPmultiT.kCVauto</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>
Automatic search for optimal penalty parameter (ridge precision with multi-targets).
</h2>

<h3>Description</h3>

<p>Function that determines the optimal penalty parameters through maximization of the k-fold cross-validated log-likelihood score, assuming that variates are grouped and penalized group-wise.
</p>


<h3>Usage</h3>

<pre><code class="language-R">optPenaltyPmultiT.kCVauto(Y, lambdaMin, lambdaMax, 
                          lambdaInit=(lambdaMin+lambdaMax)/2,
                          fold=nrow(Y), targetList) 
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>Y</code></td>
<td>
<p> Data <code>matrix</code> with samples as rows and variates as columns. </p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>lambdaMin</code></td>
<td>
<p> A <code>numeric</code> giving the minimum value for the penalty parameters. One value per target. Values should be specified in the same order as the target's appearance in <code>targetList</code>. </p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>lambdaMax</code></td>
<td>
<p> A <code>numeric</code> giving the maximum value for the penalty parameters. One value per group. Values should be specified in the same order as the target's appearance in <code>targetList</code>. </p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>lambdaInit</code></td>
<td>
<p> A <code>numeric</code> giving the initial (starting) value for the penalty parameters. One value per group. Values should be specified in the same order as the target's appearance in <code>targetList</code>. </p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>fold</code></td>
<td>
<p> A <code>numeric</code> or <code>integer</code> specifying the number of folds to apply in the cross-validation. </p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>targetList</code></td>
<td>
<p> A list of semi-positive definite target matrices towards which the precision matrix is potentially shrunken. </p>
</td>
</tr>
</table>
<h3>Value</h3>

<p>The function returns a <code>numeric</code> containing the cross-validated optimal positive penalty parameters.
</p>


<h3>Author(s)</h3>

<p>W.N. van Wieringen.
</p>


<h3>References</h3>

<p>van Wieringen, W.N., Stam, K.A., Peeters, C.F.W., van de Wiel, M.A. (2020), "Updating of the Gaussian graphical model through targeted penalized estimation", <em>Journal of Multivariate Analysis</em>, 178, Article 104621.
</p>


<h3>See Also</h3>

<p><code>ridgePmultiT</code>
</p>


<h3>Examples</h3>

<pre><code class="language-R"># set dimension and sample size
p &lt;- 10
n &lt;- 10

# specify vector of penalty parameters
lambda       &lt;- c(2, 1)

# generate precision matrix
T1       &lt;- matrix(0.7, p, p)
diag(T1) &lt;- 1
T2       &lt;- diag(rep(2, p))

# generate precision matrix
Omega       &lt;- matrix(0.4, p, p)
diag(Omega) &lt;- 2
Sigma       &lt;- solve(Omega)

# data 
Y &lt;- mvtnorm::rmvnorm(n, mean=rep(0,p), sigma=Sigma)
S &lt;- cov(Y)

# find optimal penalty parameters through cross-validation
lambdaOpt &lt;- optPenaltyPmultiT.kCVauto(Y, rep(10^(-10), 2), 
                          rep(10^(10), 2), rep(1, 2), 
                          targetList=list(T1=T1, T2=T2)) 

# unpenalized diagonal estimate
Phat &lt;- ridgePmultiT(S, lambdaOpt, list(T1=T1, T2=T2))
</code></pre>


</div>