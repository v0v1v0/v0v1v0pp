<div class="container">

<table style="width: 100%;"><tr>
<td>mixCov</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>Aggregating covariances matrices and/or error vectors into a single covariance matrix</h2>

<h3>Description</h3>

<p>This function aggregates covariances matrices, single variance values or a vector of multiple variance values into one final covariance matrix suitable for <code>propagate</code>.
</p>


<h3>Usage</h3>

<pre><code class="language-R">mixCov(...)
</code></pre>


<h3>Arguments</h3>

<table><tr style="vertical-align: top;">
<td><code>...</code></td>
<td>
<p>either covariance matrices, or a vector of single/multiple variance values.</p>
</td>
</tr></table>
<h3>Details</h3>

<p>'Mixes' (aggregates) data of the following types into a final covariance matrix:<br>
1) covariance matrices <code class="reqn">\mathbf{\Sigma}</code> that are already available.<br>
2) single variance values <code class="reqn">\sigma^2</code>.<br>
3) a vector of variance values <code class="reqn">\sigma^2_1, \sigma^2_2, ..., \sigma^2_n</code>.<br></p>
<p>This is accomplished by filling a <code class="reqn">m_1 + m_2 + \ldots + m_n</code> sized square matrix <code class="reqn">\mathbf{C}</code> succesively with elements <code class="reqn">1 \ldots m_1, m_1 + 1 \ldots m1 + m2, \ldots, m_n + 1 \ldots m_n + m_{n + 1}</code> with either covariance matrices at <code class="reqn">C_{m_n + 1 \ldots m_n + m_{n + 1}, m_n + 1 \ldots m_n + m_{n + 1}}</code> or single variance values on the diagonals at <code class="reqn">C_{m_n, m_n}</code>.
</p>


<h3>Value</h3>

<p>The aggregated covariance matrix.</p>


<h3>Author(s)</h3>

<p>Andrej-Nikolai Spiess
</p>


<h3>References</h3>

<p>Evaluation of measurement data - Guide to the expression of uncertainty in measurement.<br>
JCGM 100:2008 (GUM 1995 with minor corrections).<br><a href="http://www.bipm.org/utils/common/documents/jcgm/JCGM_100_2008_E.pdf">http://www.bipm.org/utils/common/documents/jcgm/JCGM_100_2008_E.pdf</a>.
</p>
<p>Evaluation of measurement data - Supplement 1 to the Guide to the expression of uncertainty in measurement - Propagation of distributions using a Monte Carlo Method.<br>
JCGM 101:2008.<br><a href="http://www.bipm.org/utils/common/documents/jcgm/JCGM_101_2008_E.pdf">http://www.bipm.org/utils/common/documents/jcgm/JCGM_101_2008_E.pdf</a>.
</p>


<h3>Examples</h3>

<pre><code class="language-R">#######################################################
## Example in Annex H.4.1 from the GUM 2008 manual
## (see 'References'), measurement of activity.
## This will give exactly the same values as Table H.8.
data(H.4)
attach(H.4)
T0 &lt;- 60
lambda &lt;- 1.25894E-4
Rx &lt;- ((Cx - Cb)/60) * exp(lambda * tx)
Rs &lt;- ((Cs - Cb)/60) * exp(lambda * ts)

mRx &lt;- mean(Rx)
sRx &lt;- sd(Rx)/sqrt(6)
mRx
sRx

mRs &lt;- mean(Rs)
sRs &lt;- sd(Rs)/sqrt(6)
mRs
sRs

R &lt;- Rx/Rs
mR &lt;- mean(R)
sR &lt;- sd(R)/sqrt(6)
mR
sR

cor(Rx, Rs)

## Definition as in H.4.3.
As &lt;- c(0.1368, 0.0018)
ms &lt;- c(5.0192, 0.005)
mx &lt;- c(5.0571, 0.001)

## We have to scale Rs/Rx by sqrt(6) to get the 
## corresponding covariances.
Rs &lt;- Rs/sqrt(6)
Rx &lt;- Rx/sqrt(6)

## Here we create an aggregated covariance matrix
## from the raw and summary data.
COV1 &lt;- cov(cbind(Rs, Rx))
COV &lt;- mixCov(COV1, As[2]^2, ms[2]^2, mx[2]^2)
COV

## Prepare the data for 'propagate'.
MEANS &lt;- c(mRs, mRx, As[1], ms[1], mx[1])
SDS &lt;- c(sRs, sRx, As[2], ms[2], mx[2])
DAT &lt;- rbind(MEANS, SDS)
colnames(DAT) &lt;- c("Rs", "Rx", "As", "ms", "mx")

## This will give exactly the same values as 
## in H.4.3/H.4.3.1.
EXPR &lt;- expression(As * (ms/mx) * (Rx/Rs))
RES &lt;- propagate(EXPR, data = DAT, cov = COV, nsim = 100000)
RES
</code></pre>


</div>