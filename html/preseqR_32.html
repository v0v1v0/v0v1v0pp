<div class="container">

<table style="width: 100%;"><tr>
<td>ztnb.rSAC</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>
ZTNB estimator
</h2>

<h3>Description</h3>

<p><code>ztnb.rSAC</code> predicts the expected number of species represented at least 
<code class="reqn">r</code> times in a random sample, based on the initial sample. 
</p>


<h3>Usage</h3>

<pre><code class="language-R">ztnb.rSAC(n, r=1, size=SIZE.INIT, mu=MU.INIT)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>n</code></td>
<td>

<p>A two-column matrix.  
The first column is the frequency <code class="reqn">j = 1,2,\dots</code>; and the second column
is <code class="reqn">N_j</code>, the number of species with each species represented exactly <code class="reqn">j</code>
times in the initial sample. The first column must be sorted in an
ascending order.
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>r</code></td>
<td>

<p>A positive integer. Default is 1.
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>size</code></td>
<td>

<p>A positive double, the initial value of the parameter <code>size</code> in
the negative binomial distribution for the EM algorithm. Default value is 1.
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>mu</code></td>
<td>

<p>A positive double, the initial value of the parameter <code>mu</code> in the
negative binomial distribution for the EM algorithm. Default value is 0.5.
</p>
</td>
</tr>
</table>
<h3>Details</h3>

<p>The statistical assumption is that for each species the number of individuals
in a sample follows a Poisson distribution. The Poisson rate <code>lambda</code>
are numbers generated from a gamma distribution. So the random variable
<code>X</code>, which is the number of species represented x (x &gt; 0) times in the
sample, follows a zero-truncated negative binomial distribution. The
unknown parameters are estimated by the function <code>preseqR.ztnb.em</code> based
on the initial sample. Using the estimated distribution, we calculate the 
expected number of species represented at least r times in a random sample.
Details of the estimation procedure can be found in the supplement of 
Daley T. and Smith AD. (2013).
</p>


<h3>Value</h3>

<p>The estimator for the <code class="reqn">r</code>-SAC. The input of the estimator is a vector of
sampling efforts <code class="reqn">t</code>, i.e., the relative sample sizes comparing with the initial
sample. For example, <code class="reqn">t = 2</code> means a random sample that is twice the size of
the initial sample.
</p>


<h3>Author(s)</h3>

<p>Chao Deng
</p>


<h3>References</h3>

<p>Daley, T., &amp; Smith, A. D. (2013). Predicting the molecular complexity of
sequencing libraries. Nature methods, 10(4), 325-327.
</p>
<p>Deng C, Daley T &amp; Smith AD (2015). Applications of species accumulation curves
in large-scale biological data analysis. Quantitative Biology, 3(3), 135-144. 
</p>


<h3>See Also</h3>

<p><code>preseqR.ztnb.em</code>
</p>


<h3>Examples</h3>

<pre><code class="language-R">## load library
library(preseqR)

## import data
data(FisherButterfly)

## construct the estimator for SAC
ztnb1 &lt;- ztnb.rSAC(FisherButterfly, r=1)
## The number of species represented at least once in a sample, 
## when the sample size is 10 or 20 times of the initial sample
ztnb1(c(10, 20))

## construct the estimator for r-SAC
ztnb2 &lt;- ztnb.rSAC(FisherButterfly, r=2)
## The number of species represented at least twice in a sample, 
## when the sample size is 50 or 100 times of the initial sample
ztnb2(c(50, 100))
</code></pre>


</div>