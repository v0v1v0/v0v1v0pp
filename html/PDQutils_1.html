<div class="container">

<table style="width: 100%;"><tr>
<td>PDQutils</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>PDQ Functions via Gram Charlier, Edgeworth, and Cornish Fisher Approximations</h2>

<h3>Description</h3>

<p>PDQ Functions via Gram-Charlier, Edgeworth, and Cornish Fisher Approximations
</p>


<h3>Gram Charlier and Edgeworth Expansions</h3>

<p>Given the raw moments of a probability distribution, we can approximate the probability 
density function, or the cumulative distribution function, via a Gram-Charlier 'A'
expansion on the standardized distribution.
</p>
<p>Suppose <code class="reqn">f(x)</code> is the probability density of some random
variable, and let <code class="reqn">F(x)</code> be the cumulative distribution function.
Let <code class="reqn">He_j(x)</code> be the <code class="reqn">j</code>th probabilist's Hermite
polynomial. These polynomials form an orthogonal basis, with respect to the
function <code class="reqn">w(x)</code> of the Hilbert space of functions which are square
<code class="reqn">w</code>-weighted integrable. The weighting function is 
<code class="reqn">w(x) = e^{-x^2/2} = \sqrt{2\pi}\phi(x)</code>.
The orthogonality relationship is
</p>
<p style="text-align: center;"><code class="reqn">\int_{-\infty}^{\infty} He_i(x) He_j(x) w(x) \mathrm{d}x = \sqrt{2\pi} j! \delta_{ij}.</code>
</p>

<p>Expanding the density <code class="reqn">f(x)</code> in terms of these polynomials in the
usual way (abusing orthogonality) one has
</p>
<p style="text-align: center;"><code class="reqn">f(x) \approx \sum_{0\le j} \frac{He_j(x)}{j!} \phi(x) \int_{-\infty}^{\infty} f(z) He_j(z) \mathrm{d}z.</code>
</p>

<p>The cumulative distribution function is 'simply' the integral of this
expansion. Abusing certain facts regarding the PDF and CDF of the normal
distribution and the probabilist's Hermite polynomials, the CDF has
the representation
</p>
<p style="text-align: center;"><code class="reqn">F(x) = \Phi(x) - \sum_{1\le j} \frac{He_{j-1}(x)}{j!} \phi(x) \int_{-\infty}^{\infty} f(z) He_j(z) \mathrm{d}z.</code>
</p>

<p>These series contain coefficients defined by the probability distribution 
under consideration. They take the form
</p>
<p style="text-align: center;"><code class="reqn">c_j = \frac{1}{j!}\int_{-\infty}^{\infty} f(z) He_j(z) \mathrm{d}z.</code>
</p>

<p>Using linearity of the integral, these coefficients are easily computed in
terms of the coefficients of the Hermite polynomials and the raw, uncentered
moments of the probability distribution under consideration. Note that it may be the
case that the computation of these coefficients suffers from bad numerical
cancellation for some distributions, and that an alternative formulation
may be more numerically robust.
</p>


<h3>Generalized Gram Charlier Expansions</h3>

<p>The Gram Charlier 'A' expansion is most appropriate for random variables
which are vaguely like the normal distribution. For those which are like
another distribution, the same general approach can be pursued. One needs
only define a weighting function, <code class="reqn">w</code>, which is the density of the
'parent' probability distribution, then find polynomials,
<code class="reqn">p_n(x)</code> which are orthogonal with respect to <code class="reqn">w</code> over
its support. One has
</p>
<p style="text-align: center;"><code class="reqn">f(x) = \sum_{0\le j} p_j(x) w(x) \frac{1}{h_j} \int_{-\infty}^{\infty} f(z) p_j(z) \mathrm{d}z.</code>
</p>

<p>Here <code class="reqn">h_j</code> is the normalizing constant:
</p>
<p style="text-align: center;"><code class="reqn">h_j = \int w(z)p_j^2(z)\mathrm{d}z.</code>
</p>

<p>One must then use facts about the orthogonal polynomials to approximate
the CDF.
</p>
<p>Another approach to arrive at the same computation is described by 
Berberan-Santos.
</p>


<h3>Cornish Fisher Approximation</h3>

<p>The Cornish Fisher approximation is the Legendre
inversion of the Edgeworth expansion of a distribution, but ordered
in a way that is convenient when used on the mean of a number of
independent draws of a random variable. 
</p>
<p>Suppose <code class="reqn">x_1, x_2, \ldots, x_n</code> are <code class="reqn">n</code> independent 
draws from some probability distribution. 
Letting 
</p>
<p style="text-align: center;"><code class="reqn">X = \frac{1}{\sqrt{n}} \sum_{1 \le i \le n} x_i,</code>
</p>

<p>the Central Limit Theorem assures us that, assuming finite variance, 
</p>
<p style="text-align: center;"><code class="reqn">X \rightarrow \mathcal{N}(\sqrt{n}\mu, \sigma),</code>
</p>

<p>with convergence in <code class="reqn">n</code>.
</p>
<p>The Cornish Fisher approximation gives a more detailed picture of the
quantiles of <code class="reqn">X</code>, one that is arranged in decreasing powers of
<code class="reqn">\sqrt{n}</code>. The quantile function is the function <code class="reqn">q(p)</code> 
such that <code class="reqn">P\left(X \le q(p)\right) = q(p)</code>. The
Cornish Fisher expansion is 
</p>
<p style="text-align: center;"><code class="reqn">q(p) = \sqrt{n}\mu + \sigma \left(z + \sum_{3 \le j} c_j f_j(z)\right),</code>
</p>

<p>where <code class="reqn">z = \Phi^{-1}(p)</code>, and <code class="reqn">c_j</code> involves
standardized cumulants of the distribution of <code class="reqn">x_i</code> of order
<code class="reqn">j</code> and higher. Moreover, the <code class="reqn">c_j</code> feature decreasing powers
of <code class="reqn">\sqrt{n}</code>, giving some justification for truncation.
When <code class="reqn">n=1</code>, however, the ordering is somewhat arbitrary.
</p>


<h3>Legal Mumbo Jumbo</h3>

<p>PDQutils is distributed in the hope that it will be useful,
but WITHOUT ANY WARRANTY; without even the implied warranty of
MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the
GNU Lesser General Public License for more details.
</p>


<h3>Note</h3>

<p>This package is maintained as a hobby.
</p>


<h3>Author(s)</h3>

<p>Steven E. Pav <a href="mailto:shabbychef@gmail.com">shabbychef@gmail.com</a>
</p>


<h3>References</h3>

<p>Lee, Y-S., and Lin, T-K. "Algorithm AS269: High Order Cornish Fisher
Expansion." Appl. Stat. 41, no. 1 (1992): 233-240. 
<a href="http://www.jstor.org/stable/2347649">http://www.jstor.org/stable/2347649</a>
</p>
<p>Lee, Y-S., and Lin, T-K. "Correction to Algorithm AS269: High Order 
Cornish Fisher Expansion." Appl. Stat. 42, no. 1 (1993): 268-269. 
<a href="http://www.jstor.org/stable/2347433">http://www.jstor.org/stable/2347433</a>
</p>
<p>AS 269. <a href="http://lib.stat.cmu.edu/apstat/269">http://lib.stat.cmu.edu/apstat/269</a>
</p>
<p>Jaschke, Stefan R. "The Cornish-Fisher-expansion in the context of 
Delta-Gamma-normal approximations." No. 2001, 54. Discussion Papers, 
Interdisciplinary Research Project 373: Quantification and Simulation of 
Economic Processes, 2001. 
<a href="http://www.jaschke-net.de/papers/CoFi.pdf">http://www.jaschke-net.de/papers/CoFi.pdf</a>
</p>
<p>S. Blinnikov and R. Moessner. "Expansions for nearly Gaussian
distributions." Astronomy and Astrophysics Supplement 130 (1998): 193-205.
<a href="http://arxiv.org/abs/astro-ph/9711239">http://arxiv.org/abs/astro-ph/9711239</a>
</p>
<p>M. N. Berberan-Santos. "Expressing a Probability Density Function in Terms of another 
PDF: A Generalized Gram-Charlier Expansion." Journal of Mathematical
Chemistry 42, no 3 (2007): 585-594.
<a href="http://web.ist.utl.pt/ist12219/data/115.pdf">http://web.ist.utl.pt/ist12219/data/115.pdf</a>
</p>


</div>