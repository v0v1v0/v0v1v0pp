<div class="container">

<table style="width: 100%;"><tr>
<td>Sphdist</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>Spherical Empirical Distribution</h2>

<h3>Description</h3>

<p>This function calculates the empirical distribution of the pivotal random
variable that can be used to perform the Sphericity test of the population covariance matrix
<code class="reqn">\boldsymbol{\Sigma}</code> that is <code class="reqn">\boldsymbol{\Sigma} = \sigma^2 \mathbf{I}_p</code>,
based on the released Single Synthetic data generated under Plug-in Sampling,
assuming that the original dataset is normally distributed.
</p>


<h3>Usage</h3>

<pre><code class="language-R">Sphdist(nsample, pvariates, iterations)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>nsample</code></td>
<td>
<p>Sample size.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>pvariates</code></td>
<td>
<p>Number of variables.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>iterations</code></td>
<td>
<p>Number of iterations for simulating values from the
distribution and finding the quantiles. Default is <code>10000</code>.</p>
</td>
</tr>
</table>
<h3>Details</h3>

<p>We define
</p>
<p style="text-align: center;"><code class="reqn">T_2^\star = \frac{|\boldsymbol{S}^{\star}|^{\frac{1}{p}}}{tr(\boldsymbol{S}^{\star})/p}</code>
</p>

<p>where <code class="reqn">\boldsymbol{S}^\star = \sum_{i=1}^n (v_i - \bar{v})(v_i - \bar{v})^{\top}</code>,
<code class="reqn">v_i</code> is the <code class="reqn">i</code>th observation of the synthetic dataset.
For <code class="reqn">\boldsymbol{\Sigma} = \sigma^2 \mathbf{I}_p</code>, its distribution is
stochastic equivalent to
</p>
<p style="text-align: center;"><code class="reqn">\frac{|\boldsymbol{\Omega}_{1}\boldsymbol{\Omega}_{2}|^{\frac{1}{p}}}{tr(\boldsymbol{\Omega}_{1}\boldsymbol{\Omega}_{2})/p}</code>
</p>

<p>where <code class="reqn">\boldsymbol{\Omega}_1</code> and <code class="reqn">\boldsymbol{\Omega}_2</code> are
Wishart random variables,
<code class="reqn">\boldsymbol{\Omega}_1 \sim \mathcal{W}_p(n-1, \frac{\mathbf{I}_p}{n-1})</code>
is independent of <code class="reqn">\boldsymbol{\Omega}_2 \sim \mathcal{W}_p(n-1, \mathbf{I}_p)</code>.
To test <code class="reqn">\mathcal{H}_0: \boldsymbol{\Sigma} = \sigma^2 \mathbf{I}_p</code>, compute the observed value of
<code class="reqn">T_{2}^\star</code>, <code class="reqn">\widetilde{T_{2}^\star}</code>,  with the observed values
and reject the null hypothesis if
<code class="reqn">\widetilde{T_{2}^\star}&gt;t^\star_{2,\alpha}</code>
for <code class="reqn">\alpha</code>-significance level, where <code class="reqn">t^\star_{2,\gamma}</code>
is the <code class="reqn">\gamma</code>th percentile of <code class="reqn">T_2^\star</code>.
</p>


<h3>Value</h3>

<p>a vector of length <code>iterations</code> that recorded the empirical distribution's values.
</p>


<h3>References</h3>

<p>Klein, M., Moura, R. and Sinha, B. (2021). Multivariate Normal Inference based on Singly Imputed Synthetic Data under Plug-in Sampling. Sankhya B 83, 273â€“287.
</p>


<h3>Examples</h3>

<pre><code class="language-R"># Original data created
library(MASS)
mu &lt;- c(1,2,3,4)
Sigma &lt;- matrix(c(1, 0, 0, 0,
                  0, 1, 0, 0,
                  0, 0, 1, 0,
                  0, 0, 0, 1), nrow = 4, ncol = 4, byrow = TRUE)
seed = 1
n_sample = 100
# Create original simulated dataset
df = mvrnorm(n_sample, mu = mu, Sigma = Sigma)

# Synthetic data created

df_s = simSynthData(df)


# Gather the 0.95 quantile

p = dim(df_s)[2]

T_sph &lt;- Sphdist(nsample = n_sample, pvariates = p, iterations = 10000)
q95 &lt;- quantile(T_sph, 0.95)

# Compute the observed value of T from the synthetic dataset
S_star = cov(df_s*(n_sample-1))

T_obs = (det(S_star)^(1/p))/(sum(diag(S_star))/p)

print(q95)
print(T_obs)

#Since the observed value is bigger than the 95% quantile,
#we don't have statistical evidences to reject the Sphericity property.
#
#Note that the value is very close to one
</code></pre>


</div>