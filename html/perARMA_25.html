<div class="container">

<table style="width: 100%;"><tr>
<td>perpacf</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>
Periodic PACF function
</h2>

<h3>Description</h3>

<p>The function <code>perpacf</code>, given an input time series, a specified period <code>T</code> and a lag <code>p</code>, computes
the periodic sample correlation coefficients <code class="reqn">\pi(t,n)</code> and returns their values as a matrix <code>ppa</code>  of size <code class="reqn"> T \times (p+1)</code>.<br></p>
<p>The <code>ppfcoeffab</code> procedure transforms the output of <code>perpacf</code> into Fourier form, i.e. into Fourier coeficients,
so we can represent <code class="reqn">\pi(t,n)</code> by its Fourier coefficients.<br></p>
<p>Function <code>ppfplot</code> plots perpacf coefficients returned by <code>perpacf</code> as function of <code>n</code> for each specified lag <code class="reqn">t=1, 2,\ldots, T</code>.
</p>


<h3>Usage</h3>

<pre><code class="language-R">perpacf(x, T_t, p, missval)
ppfcoeffab(ppf, nsamp, printflg, datastr)
ppfplot(ppf, nsamp, alpha, datastr)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>x</code></td>
<td>

<p>input time series.
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>T_t</code></td>
<td>

<p>period of PC-T structure.
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>p</code></td>
<td>

<p>maximum lag used in computation.
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>missval</code></td>
<td>

<p>notation for missing values.
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>ppf</code></td>
<td>

<p>matrix of periodic PACF values (of size <code class="reqn">T \times (p+1)</code>) returned by <code>perpacf</code> function.
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>nsamp</code></td>
<td>

<p>number of samples (periods) used to compute <code>ppf</code>.
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>printflg</code></td>
<td>

<p>parameter should be positive to return messages.
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>alpha</code></td>
<td>

<p>parameter for thresolds are displayed along with the Bonferroni corrected thresholds.
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>datastr</code></td>
<td>

<p>string name of data for printing.
</p>
</td>
</tr>
</table>
<h3>Details</h3>

<p>Procedure <code>perpacf</code> returns <code>ppa</code> matrix, where for
each separation <code>n=0,1,...,p</code>, <code>ppa[,n]</code> is the value
of <code class="reqn">\hat{\pi}(t,n)</code> for <code>t=1,2,...,T</code>. Further, since <code>T</code> is assumed to be the period of the underlying PC process,
<code class="reqn">\pi(t,n)</code> is periodic in <code>t</code> with period <code>T</code>. So we can represent <code class="reqn">\pi(t,n)</code> by its Fourier coefficients.
Further, if the variation in time of <code class="reqn">\pi(t,n)</code> is really smooth over the period, then looking at
these Fourier coefficients (the output of <code>ppfcoeffab</code>) may be a more sensitive detector of linear dependence
of  <code class="reqn">x_{t+1}</code> on the preceding <code>n</code> samples
(think of <code>n</code> as fixed here) than looking at <code class="reqn">\pi(t,n)</code> for individual times.
The <code>ppfcoeffab</code> procedure  also needs the sample size <code>nsamp</code> used by <code>perpacf</code> in computing the <code class="reqn">\pi(t,n)</code>
in order to compute p-values for the <code>pkab</code> coefficients. The
p-values are computed assuming that for each <code>t</code>, <code class="reqn">\pi(t,n)</code> is <code>N(0,1/sqrt(nsamp))</code> under the null.
The procedure <code>ppfcoeffab</code> is called in  <code>parma_ident</code>.
<br>
Function <code>ppfplot</code> plots values of <code class="reqn">\pi(t,n+1)</code> and computes p-values for testing
if <code class="reqn"> \pi(n_0+1,t)=0</code> for all <code> t = 1, ..., T</code> and fix <code class="reqn">n_0</code> (p-values in column labelled <code class="reqn">n_0=n</code>) and
if <code class="reqn"> \pi(n+1,t)=0</code> for all <code> t = 1, ..., T</code> and <code class="reqn"> n_0 \leq n \leq nmax</code> (p-values in column labelled <code class="reqn"> n_0 \leq n \leq nmax</code>).
perpacf is plotted as function of n for each specified lag <code class="reqn">t=1, 2,\ldots, T</code>.
</p>


<h3>Value</h3>

<p>The function <code>perpacf</code> returns two matrixes:
</p>
<table>
<tr style="vertical-align: top;">
<td><code>ppa</code></td>
<td>
<p>matrix of size <code class="reqn"> T \times (p+1)</code> with perpacf coefficients.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>nsamp</code></td>
<td>
<p>matrix of size <code class="reqn"> T \times (p+1)</code> with numbers of samples used in estimation of sample correlation.</p>
</td>
</tr>
</table>
<p>The function <code>ppfcoeffab</code> returns table of values:
</p>
<table>
<tr style="vertical-align: top;">
<td><code>pihat_k</code></td>
<td>
<p>Fourier coefficients <code>pkab</code> of <code>ppf</code> values.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>pv</code></td>
<td>
<p>Bonferroni corrected p-values.</p>
</td>
</tr>
</table>
<p>The function <code>ppfplot</code> returns plot of <code class="reqn">\pi(t,n+1)</code> coefficients and table of p-vaules for provided
tests. Note that there are two plots; the first plot presents values of <code class="reqn">\pi(t,n+1)</code> for all considered <code class="reqn">t</code> and <code class="reqn">n</code>, whereas
the second plot presents separate charts for particular <code class="reqn">t</code> values.
</p>


<h3>Author(s)</h3>

<p>Harry Hurd
</p>


<h3>References</h3>

<p>Hurd, H. L., Miamee, A. G., (2007), Periodically Correlated Random Sequences: Spectral Theory and Practice, Wiley InterScience.
</p>


<h3>See Also</h3>

<p><code>peracf</code>
</p>


<h3>Examples</h3>

<pre><code class="language-R"> data(volumes)
 perpacf_out&lt;-perpacf(t(volumes),24,12,NaN)
 ppa=perpacf_out$ppa
 nsamp=perpacf_out$nsamp
 ppfcoeffab(ppa,nsamp,1,'volumes')
 ppfplot(ppa,41,.05,'volumes')
</code></pre>


</div>