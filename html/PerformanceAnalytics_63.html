<div class="container">

<table style="width: 100%;"><tr>
<td>chart.StackedBar</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>create a stacked bar plot</h2>

<h3>Description</h3>

<p>This creates a stacked column chart with time on the horizontal axis and
values in categories.  This kind of chart is commonly used for showing
portfolio 'weights' through time, although the function will plot any values
by category.
</p>


<h3>Usage</h3>

<pre><code class="language-R">chart.StackedBar(
  w,
  colorset = NULL,
  space = 0.2,
  cex.axis = 0.8,
  cex.legend = 0.8,
  cex.lab = 1,
  cex.labels = 0.8,
  cex.main = 1,
  xaxis = TRUE,
  legend.loc = "under",
  element.color = "darkgray",
  unstacked = TRUE,
  xlab = "Date",
  ylab = "Value",
  ylim = NULL,
  date.format = "%b %y",
  major.ticks = "auto",
  minor.ticks = TRUE,
  las = 0,
  xaxis.labels = NULL,
  ...
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>w</code></td>
<td>
<p>a matrix, data frame or zoo object of values to be plotted.
Rownames should contain dates or period labels; column names should indicate
categories.  See examples for detail.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>colorset</code></td>
<td>
<p>color palette to use, set by default to rational choices</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>space</code></td>
<td>
<p>the amount of space (as a fraction of the average bar width)
left before each bar, as in <code>barplot</code>. Default is 0.2.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>cex.axis</code></td>
<td>
<p>The magnification to be used for sizing the axis text
relative to the current setting of 'cex', similar to <code>plot</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>cex.legend</code></td>
<td>
<p>The magnification to be used for sizing the legend
relative to the current setting of 'cex', similar to <code>plot</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>cex.lab</code></td>
<td>
<p>The magnification to be used for x- and y-axis labels
relative to the current setting of 'cex'.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>cex.labels</code></td>
<td>
<p>The magnification to be used for event line labels
relative to the current setting of 'cex'.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>cex.main</code></td>
<td>
<p>The magnification to be used for the chart title relative to
the current setting of 'cex'.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>xaxis</code></td>
<td>
<p>If true, draws the x axis</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>legend.loc</code></td>
<td>
<p>places a legend into a location on the chart similar to
<code>chart.TimeSeries</code>. The default, "under," is the only location
currently implemented for this chart.  Use 'NULL' to remove the legend.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>element.color</code></td>
<td>
<p>provides the color for drawing less-important chart
elements, such as the box lines, axis lines, etc.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>unstacked</code></td>
<td>
<p>logical.  If set to 'TRUE' <em>and</em> only one row of data
is submitted in 'w', then the chart creates a normal column chart.  If more
than one row is submitted, then this is ignored.  See examples below.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>xlab</code></td>
<td>
<p>the x-axis label, which defaults to 'NULL'.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>ylab</code></td>
<td>
<p>Set the y-axis label, same as in <code>plot</code></p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>ylim</code></td>
<td>
<p>set the y-axis limit, same as in <code>plot</code></p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>date.format</code></td>
<td>
<p>Re-format the dates for the xaxis; the default is "%m/%y"</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>major.ticks</code></td>
<td>
<p>Should major tickmarks be drawn and labeled, default
'auto'</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>minor.ticks</code></td>
<td>
<p>Should minor tickmarks be drawn, default TRUE</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>las</code></td>
<td>
<p>sets the orientation of the axis labels, as described in
<code>par</code>.  Defaults to '3'.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>xaxis.labels</code></td>
<td>
<p>Allows for non-date labeling of date axes, default is
NULL</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>...</code></td>
<td>
<p>arguments to be passed to <code>barplot</code>.</p>
</td>
</tr>
</table>
<h3>Details</h3>

<p>This function is a wrapper for <code>barplot</code> but adds three
additional capabilities.  First, it calculates and sets a bottom margin for
long column names that are rotated vertically.  That doesn't always result
in the prettiest chart, but it does ensure readable labels.
</p>
<p>Second, it places a legend "under" the graph rather than within the bounds
of the chart (which would obscure the data).  The legend is created from the
column names.  The default is to create the legend when there's more than
one row of data being presented.  If there is one row of data, the chart may
be "unstacked" and the legend removed.
</p>
<p>Third, it plots or stacks negative values from an origin of zero, similar to
the behavior of <code>barchart</code> from the 'lattice' package.
</p>


<h3>Note</h3>

<p>The "w" attribute is so named because this is a popular way to show
portfolio weights through time.  That being said, this function is not
limited to portfolio weight values and does not provide any normalization 
so that the chart can be used more generally with different data.
</p>
<p>The principal drawback of stacked column charts is that it is very difficult
for the reader to judge size of 2nd, 3rd, etc., data series because they do
not have common baseline.  Another is that with a large number of series,
the colors may be difficult to discern.  As alternatives, Cleveland
advocates the use of trellis like displays, and Tufte advocates the use of
small multiple charts.
</p>


<h3>Author(s)</h3>

<p>Peter Carl
</p>


<h3>References</h3>

<p>Cleveland, W.S. (1994), The Elements of Graphing Data, Summit,
NJ: Hobart Press.
</p>
<p>Tufte, Edward R. (2001) The Visual Display of Quantitative Information, 2nd
edition. The Graphics Press, Cheshire, Connecticut. See
http://www.edwardtufte.com for this and other references.
</p>


<h3>See Also</h3>

<p><code>barplot</code>, <code>par</code>
</p>


<h3>Examples</h3>

<pre><code class="language-R">
data(weights)
head(weights)

# With the legend "under" the chart
chart.StackedBar(weights, date.format="%Y", cex.legend = 0.7, colorset=rainbow12equal)

# Without the legend
chart.StackedBar(weights, colorset=rainbow12equal, legend.loc=NULL)

# for one row of data, use 'unstacked' for a better chart
chart.StackedBar(weights[1,,drop=FALSE], unstacked=TRUE, las=3)

</code></pre>


</div>