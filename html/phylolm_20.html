<div class="container">

<table style="width: 100%;"><tr>
<td>phyloglmstep</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>Stepwise model selection for Phylogenetic Generalized Linear Model</h2>

<h3>Description</h3>

<p>Performs stepwise model selection for phylogenetic generalized
linear models, using the criterion -2*log-likelihood + k*npar, where npar 
is the number of estimated parameters and k=2 for the usual AIC.</p>


<h3>Usage</h3>

<pre><code class="language-R">phyloglmstep(formula, starting.formula = NULL, data=list(), phy, 
       method = c("logistic_MPLE","logistic_IG10", "logistic_MLE", "poisson_GEE"),
       direction = c("both", "backward", "forward"), trace = 2,
       btol = 10, log.alpha.bound = 4, start.beta=NULL, 
       start.alpha=NULL, boot = 0, full.matrix = TRUE,
       k=2, ...)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>formula</code></td>
<td>
<p>formula of the full model.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>starting.formula</code></td>
<td>
<p>optional formula of the starting model.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>data</code></td>
<td>
<p>a data frame containing variables in the model. If not
found in <code>data</code>, the variables are taken from current environment.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>phy</code></td>
<td>
<p>a phylogenetic tree of type phylo with branch lengths.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>method</code></td>
<td>
<p>The "logistic_IG10" method optimizes a GEE approximation to the penalized likelihood of the logistic regression. "logistic_MPLE" maximizes the penalized likelihood of the logistic regression. In both cases, the penalty is Firth's correction.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>direction</code></td>
<td>
<p>direction for stepwise search, can be <code>both</code>, <code>forward</code>, and <code>backward</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>trace</code></td>
<td>
<p>if positive, information on each searching step is
printed. Larger values may give more detailed information.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>btol</code></td>
<td>
<p>bound on the linear predictor to bound the searching space.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>log.alpha.bound</code></td>
<td>
<p>bound for the log of the parameter alpha.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>start.beta</code></td>
<td>
<p>starting values for beta coefficients.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>start.alpha</code></td>
<td>
<p>starting values for alpha (phylogenetic correlation).</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>boot</code></td>
<td>
<p>number of independent bootstrap replicates, <code>0</code> means no bootstrap.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>full.matrix</code></td>
<td>
<p>if <code>TRUE</code>, the full matrix of bootstrap estimates (coefficients and alpha) will be returned.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>k</code></td>
<td>
<p>optional weight for the penalty.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>...</code></td>
<td>
<p>further arguments to be passed to the function <code>optim</code>.</p>
</td>
</tr>
</table>
<h3>Details</h3>

<p>The default <code class="reqn">k=2</code> corresponds to the usual AIC penalty.
Use <code class="reqn">k=\log(n)</code> for the usual BIC, although it is
unclear how BIC should be defined for phylogenetic regression.
</p>
<p>See <code>phyloglm</code> for details on the possible
phylogenetic methods for the error term, for default bounds on the
phylogenetic signal parameters, or for matching tip labels between the
tree and the data.
</p>


<h3>Value</h3>

<p>A phyloglm object correponding to the best model is returned.
</p>


<h3>Author(s)</h3>

<p>Rutger Vos</p>


<h3>See Also</h3>

<p><code>phyloglm</code>.
</p>


<h3>Examples</h3>

<pre><code class="language-R">set.seed(123456)
tre = rcoal(60)
taxa = sort(tre$tip.label)
b0=0; b1=1;
x1 = rTrait(phy=tre,model="BM",
           parameters=list(ancestral.state=0,sigma2=10))
x2 = rTrait(phy=tre,model="BM",
            parameters=list(ancestral.state=0,sigma2=10))
x3 = rTrait(phy=tre,model="BM",
            parameters=list(ancestral.state=0,sigma2=10))
X = cbind(rep(1,60), x1)
y = rbinTrait(n=1,phy=tre, beta=c(-1,0.5), alpha=1 ,X=X)
dat = data.frame(trait=y[taxa],pred1=x1[taxa],pred2=x2[taxa],pred3=x3[taxa])
fit = phyloglmstep(trait~pred1+pred2+pred3,data=dat,phy=tre,method="logistic_MPLE",direction="both")
summary(fit)
</code></pre>


</div>