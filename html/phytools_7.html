<div class="container">

<table style="width: 100%;"><tr>
<td>add.species.to.genus</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>Add species to genus on a phylogeny or bind simulated species subtrees to a backbone genus tree</h2>

<h3>Description</h3>

<p><code>add.species.to.genus</code> adds an additional species to a genus on a phylogeny. 
</p>
<p><code>genus.to.species.tree</code> simulates pure-birth subtrees and then binds them at a random height along the terminal edge leading to each corresponding genus on a genus-level backbone tree.
</p>


<h3>Usage</h3>

<pre><code class="language-R">add.species.to.genus(tree, species, genus=NULL, where=c("root","random"))
genus.to.species.tree(tree, species)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>tree</code></td>
<td>
<p>an object of class <code>"phylo"</code>. In the case of <code>genus.to.species.tree</code> this should be a genus-level backbone tree.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>species</code></td>
<td>
<p>string contain species name in the format <code>"Genus_species"</code> or <code>"Genus species"</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>genus</code></td>
<td>
<p>for <code>add.species.to.genus</code>, optional argument containing the genus to which <code>species</code> is to be attached. If <code>NULL</code> then <code>genus</code> will be extracted from <code>species</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>where</code></td>
<td>
<p>for <code>add.species.to.genus</code>, the location to attach <code>species</code> to the tree. <code>where=</code> <code>"root"</code> will cause the species to be attached to the MRCA of all members of <code>genus</code>. <code>where="random"</code> will cause <code>species</code> to be attached at random to the subtree descended from the MRCA of all members of <code>genus</code>.</p>
</td>
</tr>
</table>
<h3>Details</h3>

<p>For <code>add.species.to.genus</code>, if <code>genus</code> contains only one species and <code>where="root"</code>, then <code>species</code> will be attached midway along the branch leading to the one species. If <code>where="random"</code> then <code>species</code> will be added at a random position along the edge. 
</p>
<p>If <code>genus</code> cannot be found in the tree, then the original tree is returned and a warning printed. If the tree is not ultrametric, then the resultant tree may not contain branch lengths and a warning will be printed. 
</p>
<p>Note that for some cases in which a tree is read in from file, R may initially think it is ultrametric, but then later (as tips are added) decide that it is not due to rounding of the edge lengths when it was written to file. This can most likely be resolved by using <code>force.ultrametric</code> to coerce the tree to be exactly ultrametric (to the maximum numerical precision permitted by R) before adding tips to the tree.
</p>
<p>If <code>genus</code> is non-monophyletic then <code>species</code> will be attached to the most inclusive group containing members of <code>genus</code> and a warning will be printed.
</p>


<h3>Value</h3>

<p>An object of class <code>"phylo"</code>.
</p>


<h3>Author(s)</h3>

<p>Liam Revell <a href="mailto:liam.revell@umb.edu">liam.revell@umb.edu</a></p>


<h3>References</h3>

<p>Revell, L. J. (2024) phytools 2.0: an updated R ecosystem for phylogenetic comparative methods (and other things). <em>PeerJ</em>, <b>12</b>, e16505.
</p>


<h3>See Also</h3>

<p><code>add.random</code>, <code>bind.tip</code>
</p>


</div>