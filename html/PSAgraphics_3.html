<div class="container">

<table style="width: 100%;"><tr>
<td>bal.fe.psa</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>Fisher's Exact Test for Independence of Treatments within Strata</h2>

<h3>Description</h3>

<p>Simple function that calls fisher.test repeatedly for each strata, testing
the independence of treatements for the given covariate within strata.
</p>


<h3>Usage</h3>

<pre><code class="language-R">bal.fe.psa(categorical, treatment = NULL, strata = NULL, FB = 2000)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>categorical</code></td>
<td>
<p>Categorical covariate that is being balanced within
strata in a PSA. If <code>categorical</code> has three columns, then the second
and third are assumed to be the treatment and strata respectively.  Missing
values are not allowed. May be factor or numeric.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>treatment</code></td>
<td>
<p>Binary variable of same length as <code>categorical</code>;
generally 0 for 'control,' 1 for 'treatment.'</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>strata</code></td>
<td>
<p>Integer variable; a vector of same length as
<code>categorical</code> indicating the derived strata from estimated propensity
scores.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>FB</code></td>
<td>
<p>Numeric; number of replications sent to fisher.test.</p>
</td>
</tr>
</table>
<h3>Details</h3>

<p>This function makes repeated calls to fisher.test, Fisher's Exact test, to
test whether the distribution of the covariate categorical is independent of
treatment within each stratum; a list of p-values for the test for each
stratum are returned.
</p>


<h3>Value</h3>

<p>Returns list of the same lenght as the number of strata containing
p-values for the indpendence of treatment within each stratum derived from
Fisher's Exact test.
</p>


<h3>Author(s)</h3>

<p>James E. Helmreich <a href="mailto:James.Helmreich@Marist.edu">James.Helmreich@Marist.edu</a>
</p>
<p>Robert M. Pruzek <a href="mailto:RMPruzek@yahoo.com">RMPruzek@yahoo.com</a>
</p>


<h3>See Also</h3>

<p><code>bal.cs.psa</code>, <code>bal.ms.psa</code>, <code>bal.ks.psa</code>
</p>


<h3>Examples</h3>

<pre><code class="language-R">#Everything random
categorical&lt;-sample(4, 1000, replace = TRUE)
treatment&lt;-sample(c(0,1), 1000, replace = TRUE)
strata&lt;-sample(5, 1000, replace = TRUE)
bal.fe.psa(categorical, treatment, strata)

#Perfect balance on 80%, random on last 20%
categorical&lt;-rep(sample(5,1000, replace=TRUE), 2)
treatment&lt;-c(rep(0,1000), rep(1,1000))
strata&lt;-sample(6, 1200, replace=TRUE)
strata&lt;-c(strata[1:1000], strata[1:800], strata[1001:1200])
bal.fe.psa(categorical, treatment, strata)

</code></pre>


</div>