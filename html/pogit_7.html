<div class="container">

<table style="width: 100%;"><tr>
<td>pogitBvs</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>Bayesian variable selection for the Pogit model</h2>

<h3>Description</h3>

<p>This function performs Bayesian variable selection for a Poisson-Logistic (Pogit) 
model via spike and slab priors. For posterior inference, a MCMC sampling scheme 
is used that relies on augmenting the observed data by the unobserved counts and 
involves only Gibbs sampling steps.
</p>


<h3>Usage</h3>

<pre><code class="language-R">pogitBvs(
  y,
  E = NULL,
  X,
  W = NULL,
  validation = NULL,
  method = "val",
  model = list(),
  prior = list(),
  mcmc = list(),
  start = list(),
  BVS = TRUE
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>y</code></td>
<td>
<p>an integer vector of observed counts for units i = 1,...,I</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>E</code></td>
<td>
<p>an (optional) vector containing total exposure times (offset); 
should be <code>NULL</code> or an integer vector of length equal to the number of 
counts.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>X</code></td>
<td>
<p>a design matrix in the Poisson part of the joint model</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>W</code></td>
<td>
<p>a design matrix in the logit part of the joint model (can be a subset
of <code>X</code>) or <code>NULL</code>, if the same design matrix is used in both 
sub-models, i.e. <code>W</code> = <code>X</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>validation</code></td>
<td>
<p>a two-column data frame or list with the number of 
reported cases (= <code>v</code>) in the validation sample and the number of 
total cases (= <code>m</code>) subject to the fallible reporting process 
(i.e. validation sample size) for each unit (or sub-category); 
required if <code>method =</code> "<code>val</code>", otherwise <code>NULL</code>. 
The number of rows must conform with the number of rows in <code>W</code> or with 
the number of units I (if <code>X = W</code>), respectively.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>method</code></td>
<td>
<p>the method to be used to obtain parameter identification: 
The default method "<code>val</code>" requires a small sample of validation data 
(see <code>validation</code>). If the information on all or some parameters
of the reporting process is not provided by validation data, an informative
prior distribution for the regression effects in the logit sub-model 
can be used (<code>method</code> = "<code>infprior</code>"). This prior information is encoded 
in a normal distribution instead of the spike and slab prior (see the details 
for <code>prior</code>).</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>model</code></td>
<td>
<p>a list specifying the structure of the model (see details)</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>prior</code></td>
<td>
<p>an (optional) list of prior settings and hyper-parameters 
controlling the priors (see details)</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>mcmc</code></td>
<td>
<p>an (optional) list of MCMC sampling options (see details)</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>start</code></td>
<td>
<p>an (optional) list containing starting values for the 
regression effects in both sub-models (see details)</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>BVS</code></td>
<td>
<p>if <code>TRUE</code> (default), Bayesian variable selection 
(in at least one part of the joint model) is performed to identify 
regressors with a non-zero effect; otherwise, an unrestricted model is 
estimated (without variable selection).</p>
</td>
</tr>
</table>
<h3>Details</h3>

<p>The method provides Bayesian variable selection for regression
models of count data subject to under-reporting using mixture priors with a spike 
and a slab component. 
By augmenting the observed count data with the unobserved counts, the resulting 
model can be factorized into a Poisson and a binomial logit model part. Hence, 
for this two-part model, sampling algorithms for a Poisson and a binomial 
logit model can be used which are described in <code>poissonBvs</code> and 
<code>logitBvs</code>. 
Bayesian variable selection is incorporated in both parts of the joint model 
using mixture priors with a Dirac spike and (by default) a Student-t slab. 
The implementation relies on the representation of the respective model as a 
Gaussian regression model in auxiliary variables (see again the help for the 
respective function). Though variable selection is primarily used to identify 
regressors with a non-zero effect, it can also be useful for identification of
the Pogit model. 
</p>
<p>By default, identification of the Pogit model is achieved by additional
information on the reporting process through validation data and 
incorporation of variable selection. If the information on the parameters
of the reporting process is not provided by validation data, the
identification of the model parameters has to be guaranteed by specifying an 
informative prior distribution (see arguments).  
</p>
<p>To model under-reported clustered data, a cluster-specific random intercept can
be included in both model parts of the Pogit model to account for dependence
within clusters. Bayesian variance selection is applied to determine whether
there is within-cluster dependence in either part of the model.  
Note that an observation-specific random intercept in the
Poisson sub-model yields an overdispersed Pogit model for unobserved
heterogeneity.   
</p>
<p>For details concerning the sampling algorithm see Dvorzak and Wagner (2016).
</p>
<p>Details for model specification (see arguments):  
</p>
 
<dl>
<dt>
<code>model</code>:</dt>
<dd>

<dl>
<dt><code>deltaBetafix, deltaAlphafix</code></dt>
<dd>
<p>indicator vectors of length 
<code>ncol(X)-1</code> and <code>ncol(W)-1</code>, respectively, for the Poisson and the 
logit sub-model, to specify which regression effects are subject to selection 
(i.e., 0 = subject to selection, 1 = fix in the model); defaults to vectors 
of zeros.</p>
</dd> 
<dt><code>gammaBetafix, gammaAlphafix</code></dt>
<dd>
<p>indicators for variance selection 
of the random intercept term in the Poisson and the logit sub-model 
(i.e., 0 = with variance selection (default), 1 = no variance selection); 
only used if a random intercept is included in either part of the joint 
model (see <code>riBeta</code> and <code>riAlpha</code>, respectively).</p>
</dd> 
<dt><code>riBeta, riAlpha</code></dt>
<dd>
<p>logical. If <code>TRUE</code>, a cluster-specific
random intercept is included in the respective part of the joint model;
defaults to <code>FALSE</code>.</p>
</dd> 
<dt><code>clBetaID, clAlphaID</code></dt>
<dd>
<p>numeric vectors of length equal to the 
number of observations containing the cluster ID c = 1,...,C for each unit
(or sub-category) in the respective sub-model (required if 
<code>riBeta=TRUE</code> or <code>riAlpha=TRUE</code>, respectively).</p>
</dd> 
<dt><code>subcat</code></dt>
<dd>
<p>a factor variable of length equal to the number of
units that specifies for which sub-category validation data are available 
(is required if <code>W</code> is a subset of <code>X</code>). 
If <code>NULL</code> (default), it is presumed that validation data are available 
for each unit (see also examples).</p>
</dd>
</dl>
</dd>
<dt>
<code>prior</code>:</dt>
<dd>

<dl>
<dt><code>slabP, slabL</code></dt>
<dd>
<p>distribution of the slab component in the
Poisson and logit sub-model, i.e. "<code>Student</code>" (default) or "<code>Normal</code>".</p>
</dd>
<dt><code>psi.nuP, psi.nuL</code></dt>
<dd>
<p>hyper-parameter of the Student-t slab in
the respective sub-model (used for a Student-t slab); defaults to 5.</p>
</dd>
<dt><code>m0b, m0a</code></dt>
<dd>
<p>prior mean for the intercept parameter in the 
Poisson and the logit model; defaults to 0. If the argument <code>method</code> = 
"<code>infprior</code>", the specification of <code>m0a</code> is required.</p>
</dd>
<dt><code>M0b, M0a</code></dt>
<dd>
<p>prior variance for the intercept parameter in the
Poisson and the logit model; defaults to 100.</p>
</dd>
<dt><code>bj0, aj0</code></dt>
<dd>
<p>a vector of prior means for the regression effects 
in the Poisson and the logit sub-model (which is encoded in a normal distribution, 
see notes); defaults to a vector of zeros. If the argument <code>method</code> = 
"<code>infprior</code>", the specification of <code>aj0</code> is mandatory.</p>
</dd>
<dt><code>VP, VL</code></dt>
<dd>
<p>variance of the slab in the respective sub-model; 
defaults to 5.</p>
</dd>
<dt><code>wBeta, wAlpha</code></dt>
<dd>
<p>hyper-parameters of the Beta-prior for the mixture 
weights <code class="reqn">\omega_\beta</code> and <code class="reqn">\omega_\alpha</code> in the respective sub-model; 
defaults to <code>c(wa0=1, wb0=1)</code>, i.e. a uniform distribution.</p>
</dd>
<dt><code>piBeta, piAlpha</code></dt>
<dd>
<p>hyper-parameters of the Beta-prior for the mixture 
weights <code class="reqn">\pi_\beta</code> and <code class="reqn">\pi_\alpha</code> in the respective sub-model; 
defaults to <code>c(pa0=1, pb0=1)</code>, i.e. a uniform distribution.</p>
</dd>
</dl>
</dd>
<dt>
<code>mcmc</code>:</dt>
<dd>

<dl>
<dt><code>M</code></dt>
<dd>
<p>number of MCMC iterations after the burn-in phase; 
defaults to 8000.</p>
</dd> 
<dt><code>burnin</code></dt>
<dd>
<p>number of MCMC iterations discarded as burn-in; 
defaults to 2000.</p>
</dd> 
<dt><code>thin</code></dt>
<dd>
<p>thinning parameter; defaults to 1.</p>
</dd> 
<dt><code>startsel</code></dt>
<dd>
<p>number of MCMC iterations drawn from the unrestricted
model (e.g., <code>burnin/2</code>); defaults to 1000.</p>
</dd> 
<dt><code>verbose</code></dt>
<dd>
<p>MCMC progress report in each <code>verbose</code>-th 
iteration step; defaults to 500. If <code>verbose=0</code>, no output is 
generated.</p>
</dd> 
<dt><code>msave</code></dt>
<dd>
<p>returns additional output with variable 
selection details (i.e. posterior samples for <code class="reqn">\omega_\beta</code>, 
<code class="reqn">\omega_\alpha</code>, <code class="reqn">\delta_\beta</code>, <code class="reqn">\delta_\alpha</code>, 
<code class="reqn">\pi_\beta</code>, <code class="reqn">\pi_\alpha</code>, <code class="reqn">\gamma_\beta</code>,
<code class="reqn">\gamma_\alpha</code>); defaults to <code>FALSE</code>.</p>
</dd> 
</dl>
</dd>
<dt>
<code>start</code>:</dt>
<dd>

<dl>
<dt><code>beta</code></dt>
<dd>
<p>a vector of length <code>ncol(X)</code> containing starting 
values for the regression parameters <code class="reqn">\beta</code> in the Poisson model part.
By default, a Poisson glm is fitted to the observed counts.</p>
</dd>
<dt><code>alpha</code></dt>
<dd>
<p>a vector of length <code>ncol(W)</code> containing starting
values for the regression parameters <code class="reqn">\alpha</code> in the logit model part. 
By default, a binomial glm is fitted to the validation data for 
<code>method</code> = "<code>val</code>". If <code>method</code> = "<code>infprior</code>", 
starting values for <code class="reqn">\alpha</code> are sampled from the (informative) prior 
distribution.</p>
</dd>
<dt><code>firth</code></dt>
<dd>
<p>logical. If <code>TRUE</code>, a logistic regression model 
applying Firth's correction to the likelihood using 
<code>logistf</code> is fitted to the validation data
(only used if <code>method</code> = "<code>val</code>").</p>
</dd>
</dl>
</dd>
</dl>
<h3>Value</h3>

<p>The function returns an object of class "<code>pogit</code>" with methods
<code>print.pogit</code>, <code>summary.pogit</code> and 
<code>plot.pogit</code>. 
</p>
<p>An object of class "<code>pogit</code>" is a list containing the following elements:
</p>
<table>
<tr style="vertical-align: top;">
<td><code>samplesL</code></td>
<td>
<p>a named list containing the samples from the posterior
distribution of the parameters in the logit part of the joint model 
(see also <code>msave</code>):
</p>

<dl>
<dt><code>alpha, thetaAlpha</code></dt>
<dd>
<p>regression coefficients <code class="reqn">\alpha</code> and
<code class="reqn">\theta_\alpha</code></p>
</dd>
<dt><code>pdeltaAlpha</code></dt>
<dd>
<p>P(<code class="reqn">\delta_\alpha</code>=1)</p>
</dd>
<dt><code>psiAlpha</code></dt>
<dd>
<p>scale parameter <code class="reqn">\psi_\alpha</code> of the slab component</p>
</dd>
<dt><code>pgammaAlpha</code></dt>
<dd>
<p>P(<code class="reqn">\gamma_\alpha</code>=1)</p>
</dd>
<dt><code>ai</code></dt>
<dd>
<p>cluster-specific random intercept</p>
</dd>
</dl>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>samplesP</code></td>
<td>
<p>a named list containing the samples from the posterior
distribution of the parameters in the Poisson part of the joint model 
(see also <code>msave</code>):
</p>

<dl>
<dt><code>beta, thetaBeta</code></dt>
<dd>
<p>regression coefficients <code class="reqn">\beta</code> and
<code class="reqn">\theta_\beta</code></p>
</dd>
<dt><code>pdeltaBeta</code></dt>
<dd>
<p>P(<code class="reqn">\delta_\beta</code>=1)</p>
</dd>
<dt><code>psiBeta</code></dt>
<dd>
<p>scale parameter <code class="reqn">\psi_\beta</code> of the slab component</p>
</dd>
<dt><code>pgammaBeta</code></dt>
<dd>
<p>P(<code class="reqn">\gamma_\beta</code>=1)</p>
</dd>
<dt><code>bi</code></dt>
<dd>
<p>cluster-specific random intercept</p>
</dd>
</dl>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>data</code></td>
<td>
<p>a list containing the data <code>y</code>, <code>E</code>, 
<code>X</code>, <code>W</code>, <code>val</code> and <code>subcat</code></p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>model.logit</code></td>
<td>
<p>a list containing details on the model specification in
the logit sub-model, see details for <code>model</code></p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>model.pois</code></td>
<td>
<p>a list containing details on the model specification in
the Poisson sub-model, see details for <code>model</code></p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>mcmc</code></td>
<td>
<p>see details for <code>mcmc</code></p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>prior.logit</code></td>
<td>
<p>see details for <code>prior</code></p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>prior.pois</code></td>
<td>
<p>see details for <code>prior</code></p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>dur</code></td>
<td>
<p>a list containing the total runtime (<code>total</code>) 
and the runtime after burn-in (<code>durM</code>), in seconds</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>BVS</code></td>
<td>
<p>see arguments</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>method</code></td>
<td>
<p>see arguments</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>start</code></td>
<td>
<p>a list containing starting values, see arguments</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>family</code></td>
<td>
<p>"pogit"</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>call</code></td>
<td>
<p>function call</p>
</td>
</tr>
</table>
<h3>Note</h3>

<p>If <code>method</code> = "<code>infprior</code>", an 
informative prior for the regression parameters in the logit model is 
required to guarantee identification of the model parameters. 
Otherwise, identification of the Pogit model may be weak and inference
will be biased.
</p>


<h3>Author(s)</h3>

<p>Michaela Dvorzak &lt;m.dvorzak@gmx.at&gt;, Helga Wagner
</p>


<h3>References</h3>

<p>Dvorzak, M. and Wagner, H. (2016). Sparse Bayesian modelling
of underreported count data. <em>Statistical Modelling</em>, <strong>16</strong>(1),
24 - 46, <a href="https://doi.org/10.1177/1471082x15588398">doi:10.1177/1471082x15588398</a>.
</p>


<h3>See Also</h3>

<p><code>logitBvs</code>, <code>poissonBvs</code>
</p>


<h3>Examples</h3>

<pre><code class="language-R">## Not run: 
## Examples below (except for m3) should take 3-4 minutes. 

## ------ (use simul1) ------
# load simulated data set 'simul1'
data(simul1)
y &lt;- simul1$y
E &lt;- simul1$E
X &lt;- as.matrix(simul1[, -c(1,2,8,9)]) # W = X
validation &lt;- simul1[, c("m", "v"), drop = FALSE]

# function call (with specific MCMC settings)
m1 &lt;- pogitBvs(y = y, E = E, X = X, validation = validation, 
               mcmc = list(M = 4000, thin = 5, verbose = 1000))

# print, summarize and plot results
print(m1)
summary(m1)
plot(m1)

# show traceplots disregarding burn-in and thinning
plot(m1, burnin = FALSE, thin = FALSE)
# show density plot of MCMC draws
plot(m1, type = "density")

# informative prior instead of validation data (change prior settings)
# e.g. available prior information on reporting probabilities 
p.a0 &lt;- 0.9 
p.a  &lt;- c(0.125, 0.5, 0.5, 0.5)
m0a_inf &lt;- log(p.a0/(1 - p.a0))  # prior information for alpha_0
aj0_inf &lt;- log(p.a/(1 - p.a))    # prior information for alpha

prior.set &lt;- list(m0a = m0a_inf, aj0 = aj0_inf, VL = 0.005, slabL = "Normal")
m2 &lt;- pogitBvs(y = y, E = E, X = X, method = "infprior", prior = prior.set, 
               mcmc = list(M = 4000, burnin = 2000, thin = 2), BVS = FALSE)
print(m2)
summary(m2)
plot(m2)
plot(m2, type = "acf", lag.max = 30)

## ------ (use simul2) ------
# complex model (with a long (!) runtime)

# load simulated data set 'simul2'
data(simul2)
y &lt;- simul2$y
E &lt;- simul2$E
cID &lt;- simul2$cID
X &lt;- as.matrix(simul2[, -c(1:3,9,10)])
validation &lt;- simul2[, c("v", "m"), drop = FALSE]
 
# function call (with random intercept in both sub-models)
model &lt;- list(riBeta = 1, riAlpha = 1, clBetaID = cID, clAlphaID = cID)
m3 &lt;- pogitBvs(y = y, E = E, X = X, validation = validation, model = model, 
               mcmc = list(M = 6000, burnin = 200, thin = 10), BVS = TRUE)
print(m3)
summary(m3)
plot(m3)

## ------ (use cervical cancer data) ------
# load cervical cancer data
data(cervical)
data(cervical_validation)
y &lt;- cervical$y
E &lt;- cervical$E
X &lt;- as.matrix(cervical[, -c(1:4)])
validation &lt;- cervical_validation[, c(1, 2), drop = FALSE]
W          &lt;- as.matrix(cervical_validation[, -c(1:3)])
subcat     &lt;- factor(as.numeric(cervical$country))

# function call 
m4 &lt;- pogitBvs(y = y, E = E, X = X, W = W, validation = validation, 
               model = list(subcat = subcat), mcmc = list(M = 10000, 
               burnin = 2000, thin = 10), start = list(firth = TRUE), 
               BVS = TRUE)             
print(m4)
# additionally compute estimated risks and reporting probabilities
summary(m4, printRes = TRUE) 
plot(m4, burnin = FALSE, thin = FALSE)
plot(m4, type = "acf", lag.max = 50)

# informative prior instead of validation data (change prior settings)
# e.g. prior information on country-specific reporting probabilities 
p.a0 &lt;- 0.85
p.a  &lt;- c(0.99, 0.70, 0.85)
m0a_inf &lt;- log(p.a0/(1 - p.a0))  # prior information for alpha_0
aj0_inf &lt;- log(p.a/(1 - p.a))    # prior information for alpha

prior.set &lt;- list(m0a = m0a_inf, aj0 = aj0_inf, VL = 0.005, slabL = "Normal")
m5 &lt;- pogitBvs(y = y, X = X, W = W, E = E, method = "infprior", 
               model = list(subcat = subcat), prior = prior.set, 
               mcmc = list(M = 10000, burnin = 2000, thin = 10))
print(m5)
summary(m5, printRes = TRUE)
plot(m5, burnin = FALSE, thin = FALSE)
plot(m5, type = "acf", lag.max = 50)

## End(Not run)
</code></pre>


</div>