<div class="container">

<table style="width: 100%;"><tr>
<td>pheno.flm.fit</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>Fits a two-way linear fixed model</h2>

<h3>Description</h3>

<p>Fits a two-way linear fixed model. 
The model assumes the first factor f1 the second factor f2 to be fixed. 
Errors are assumed to be i.i.d. No general mean and sum of 
f2 is constrained to be zero.
</p>


<h3>Usage</h3>

<pre><code class="language-R">pheno.flm.fit(D,limit=1000)</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>D</code></td>
<td>
<p>Data frame with three columns (x, f1, f2) or a matrix
where rows are ranks of factor f1 levels and columns are ranks 
of factor f2 levels and missing values are assumed to be NA or 0.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>limit</code></td>
<td>
<p>Integer that determines which algorithm to use (see Details).</p>
</td>
</tr>
</table>
<h3>Details</h3>

<p>This function is basically a wrapper for the <code>slm.fit()</code> function
form the <code>SparseM</code> package, adapted for the estimation of combined phenological time series.
In phenological application, x should be the julian day
of observation of a certain phase, factor f1 should be the observation year
and factor f2 should be a station-id.
For large problems <code>length(x)&gt;limit</code>, the linear model is calculated
for treatment contrasts for efficiency reasons, and the constraint that the sum of f2 is zero,
is adjusted afterwards. This results in a slight over-estimation of
standard errors.
Note that the input data is sorted before fitting, such that subsequent
analyses using the input data should be done using the sorted output data frame.
</p>


<h3>Value</h3>

<table>
<tr style="vertical-align: top;">
<td><code>f1</code></td>
<td>
<p>Estimated fixed effects f1, in phenology this is precisely the combined time series.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>f1.se</code></td>
<td>
<p>f1 estimated standard error.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>f1.lev</code></td>
<td>
<p>Levels of f1. Should be the same order as f1.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>f2</code></td>
<td>
<p>Estimated fixed effects f2, in phenology these are the station effects.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>f2.se</code></td>
<td>
<p>f2 estimated standard error.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>f2.lev</code></td>
<td>
<p>Levels of f2. Should be the same order as f2.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>resid</code></td>
<td>
<p>Residuals</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>lclf1</code></td>
<td>
<p>Lower 95 percent confidence limit of factor f1.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>uclf1</code></td>
<td>
<p>Upper 95 percent confidence limit of factor f1.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>lclf2</code></td>
<td>
<p>Lower 95 percent confidence limit of factor f2.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>uclf2</code></td>
<td>
<p>Upper 95 percent confidence limit of factor f2.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>D</code></td>
<td>
<p>The input as ordered data frame, ordered first by f2 then by f1</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>fit</code></td>
<td>
<p>The fitted lm model object.</p>
</td>
</tr>
</table>
<h3>Author(s)</h3>

<p>Joerg Schaber
</p>


<h3>References</h3>

<p>Searle (1997) 'Linear Models'. Wiley.
Schaber J, Badeck F-W (2002) 'Evaluation of methods for the combination of phenological time series and outlier detection'. Tree Physiology 22:973-982
</p>


<h3>See Also</h3>

<p><code>lm</code>
</p>


<h3>Examples</h3>

<pre><code class="language-R">	data(DWD)
	R &lt;- pheno.flm.fit(DWD)					# parameter estimation
</code></pre>


</div>