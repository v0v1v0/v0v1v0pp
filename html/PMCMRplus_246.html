<div class="container">

<table style="width: 100%;"><tr>
<td>steelTest</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>Steel's Many-to-One Rank Test</h2>

<h3>Description</h3>

<p>Performs Steel's non-parametric many-to-one comparison
test for Wilcox-type ranked data.
</p>


<h3>Usage</h3>

<pre><code class="language-R">steelTest(x, ...)

## Default S3 method:
steelTest(x, g, alternative = c("greater", "less"), ...)

## S3 method for class 'formula'
steelTest(
  formula,
  data,
  subset,
  na.action,
  alternative = c("greater", "less"),
  ...
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>x</code></td>
<td>
<p>a numeric vector of data values, or a list of numeric data
vectors.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>...</code></td>
<td>
<p>further arguments to be passed to or from methods.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>g</code></td>
<td>
<p>a vector or factor object giving the group for the
corresponding elements of <code>"x"</code>.
Ignored with a warning if <code>"x"</code> is a list.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>alternative</code></td>
<td>
<p>the alternative hypothesis. Defaults to <code>greater</code></p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>formula</code></td>
<td>
<p>a formula of the form <code>response ~ group</code> where
<code>response</code> gives the data values and <code>group</code> a vector or
factor of the corresponding groups.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>data</code></td>
<td>
<p>an optional matrix or data frame (or similar: see
<code>model.frame</code>) containing the variables in the
formula <code>formula</code>.  By default the variables are taken from
<code>environment(formula)</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>subset</code></td>
<td>
<p>an optional vector specifying a
subset of observations to be used.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>na.action</code></td>
<td>
<p>a function which indicates what should happen when
the data contain <code>NA</code>s.  Defaults to <code>getOption("na.action")</code>.</p>
</td>
</tr>
</table>
<h3>Details</h3>

<p>For many-to-one comparisons (pairwise comparisons with one control)
in an one-factorial balanced layout with non-normally distributed
residuals Steels's non-parametric single-step test can be performed.
Let there be <code class="reqn">k</code> treatment levels (excluding the control),
then <code class="reqn">k</code> pairwise comparisons can be performed between
the <code class="reqn">i</code>-th treatment level and the control.
H<code class="reqn">_i: \theta_0 = \theta_i</code> is tested in the one-tailed case (less) against
A<code class="reqn">_i: \theta_0 &gt; \theta_i, ~~ (1 \le i \le k)</code>.
</p>
<p>For each control - treatment level the data are ranked in increasing order.
The ranksum <code class="reqn">R_i</code> for the <code class="reqn">i</code>-th treatment level is compared
to a critical <code class="reqn">R</code> value and is significantly(<code class="reqn">p = 0.05</code>) less,
if <code class="reqn">R_i \le R</code>. For the <code>alternative = "greater"</code> the sign is changed.
</p>
<p>The function does not return p-values. Instead the critical <code class="reqn">R</code>-values
as given in the tables of USEPA (2002) for <code class="reqn">\alpha = 0.05</code> (one-sided, less)
are looked up according to the balanced sample sizes (<code class="reqn">n</code>) and the order number of the
dose level (<code class="reqn">i</code>).
</p>


<h3>Value</h3>

<p>A list with class <code>"osrt"</code> that contains the following components:
</p>

<dl>
<dt>method</dt>
<dd>
<p>a character string indicating what type of test was performed.</p>
</dd>
<dt>data.name</dt>
<dd>
<p>a character string giving the name(s) of the data.</p>
</dd>
<dt>statistic</dt>
<dd>
<p>the estimated statistic(s)</p>
</dd>
<dt>crit.value</dt>
<dd>
<p>critical values for <code class="reqn">\alpha = 0.05</code>.</p>
</dd>
<dt>alternative</dt>
<dd>
<p>a character string describing the alternative hypothesis.</p>
</dd>
<dt>parameter</dt>
<dd>
<p>the parameter(s) of the test distribution.</p>
</dd>
<dt>dist</dt>
<dd>
<p>a string that denotes the test distribution.</p>
</dd>
</dl>
<p>There are print and summary methods available.
</p>


<h3>Source</h3>

<p>The critical rank sum values were taken from Table E.5 of USEPA (2002).
</p>
<p>USEPA (2002) <em>Short-term Methods for Estimating the
Chronic Toxicity of Effluents and Receiving
Waters to Freshwater Organisms</em>, 4th edition, EPA-821-R-02-013.
</p>


<h3>Note</h3>

<p>Steel's Many-to-One Rank test is only applicable for balanced designs and
directional hypotheses. An error message will occur, if the design is unbalanced.
In the current implementation, only one-sided tests on
the level of <code class="reqn">\alpha = 0.05</code> can be performed.
</p>


<h3>References</h3>

<p>Steel, R. G. D. (1959) A multiple comparison rank sum test:
treatments versus control, <em>Biometrics</em> <b>15</b>, 560â€“572.
</p>


<h3>See Also</h3>

<p><code>wilcox.test</code>, <code>pairwise.wilcox.test</code>,
<code>manyOneUTest</code>, <code>flignerWolfeTest</code>,
<code>shirleyWilliamsTest</code>, <code>kwManyOneDunnTest</code>,
<code>kwManyOneNdwTest</code>, <code>kwManyOneConoverTest</code>,
<code>print.osrt</code>, <code>summary.osrt</code>
</p>


<h3>Examples</h3>

<pre><code class="language-R">## Example from Sachs (1997, p. 402)
x &lt;- c(106, 114, 116, 127, 145,
110, 125, 143, 148, 151,
136, 139, 149, 160, 174)
g &lt;- gl(3,5)
levels(g) &lt;- c("0", "I", "II")

## Steel's Test
steelTest(x ~ g)


## Example from USEPA (2002):
## Reproduction data from a Ceriodaphnia dubia
## 7-day chronic test to several concentrations
## of effluent. Dose level 50% is excluded.
x &lt;- c(20, 26, 26, 23, 24, 27, 26, 23, 27, 24,
13, 15, 14, 13, 23, 26, 0, 25, 26, 27,
18, 22, 13, 13, 23, 22, 20, 22, 23, 22,
14, 22, 20, 23, 20, 23, 25, 24, 25, 21,
9, 0, 9, 7, 6, 10, 12, 14, 9, 13,
rep(0,10))
g &lt;- gl(6, 10)
levels(g) &lt;- c("Control", "3%", "6%", "12%", "25%", "50%")

## NOEC at 3%, LOEC at 6%
steelTest(x ~ g, subset = g != "50%", alternative = "less")



</code></pre>


</div>