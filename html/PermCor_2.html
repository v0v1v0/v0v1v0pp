<div class="container">

<table style="width: 100%;"><tr>
<td>perm_test</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>Robust Permutation Tests of Correlation Coefficients</h2>

<h3>Description</h3>

<p>This function performs robust permutation tests for various correlation coefficients, providing
reliable type I error control under general scenarios, especially when the sample size is small and
two variables are dependent but uncorrelated.
</p>


<h3>Usage</h3>

<pre><code class="language-R">perm_test(
  x,
  y,
  B = 1000,
  r0 = 0,
  w = NULL,
  method = c("Pearson", "wtdPearson", "Spearman", "CCC"),
  alternative = c("two.sided", "less", "greater")
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>x</code></td>
<td>
<p>a <code>numeric</code> vector.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>y</code></td>
<td>
<p>a <code>numeric</code> vector.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>B</code></td>
<td>
<p>an <code>integer</code> number of permutations.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>r0</code></td>
<td>
<p>a <code>numeric</code> denoting the CCC under the null hypothesis. It should be in the range between
-1 and 1. This parameter will be ignored for the tests of Pearson, weighted Pearson, or Spearman's
correlation coefficient.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>w</code></td>
<td>
<p><code>numeric</code> vector denoting the weights of the elements in vectors <code>x</code> and <code>y</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>method</code></td>
<td>
<p>the correlation coefficient to be tested, options include Pearson's correlation coefficient
(<code>Pearson</code>), weighted Pearson correlation coefficient (<code>wtdPearson</code>),
Spearman's correlation coefficient (<code>Spearman</code>), Lin's concordance correlation coefficient (<code>CCC</code>).</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>alternative</code></td>
<td>
<p>the alternative hypothesis, can be <code>two.sided</code>, <code>less</code>, or <code>greater</code>.</p>
</td>
</tr>
</table>
<h3>Details</h3>

<p>#' The test supports the following correlation coefficients: Pearson correlation coefficient, Weighted
Pearson correlation coefficient, Spearman correlation coefficient, and Lin's concordance correlation coefficient (CCC)
</p>
<p>For Pearson, weighted Pearson, and Spearman correlation coefficients, the test supports a zero null
hypothesis. The alternative hypothesis can be either one-sided or two-sided.
</p>
<p>For Lin's concordance correlation coefficient (CCC), the test accommodates a more general null
hypothesis. Currently, the test only supports a one-sided alternative hypothesis (greater).
</p>


<h3>Value</h3>


<dl>
<dt><code>estimate</code></dt>
<dd>
<p>the estimated correlation coefficient.</p>
</dd>
<dt><code>p.value</code></dt>
<dd>
<p>the p-value from the studentized test.</p>
</dd>
<dt><code>method</code></dt>
<dd>
<p>the method for measuring correlation coefficient.</p>
</dd>
<dt><code>alternative</code></dt>
<dd>
<p>the alternative hypothesis.</p>
</dd>
</dl>
<h3>Author(s)</h3>

<p>Mengyu Fang, Han Yu, Alan Hutson
</p>


<h3>References</h3>

<p>Lawrence, I., &amp; Lin, K. (1989). A concordance correlation coefficient to evaluate reproducibility. Biometrics, 255-268.
</p>
<p>DiCiccio, C. J., &amp; Romano, J. P. (2017). Robust permutation tests for correlation and regression coefficients. Journal of the American Statistical Association, 112(519), 1211-1220.
</p>
<p>Hutson, A. D., &amp; Yu, H. (2021). A robust permutation test for the concordance correlation coefficient. Pharmaceutical Statistics, 20(4), 696-709.
</p>
<p>Yu, H., &amp; Hutson, A. D. (2024). A robust Spearman correlation coefficient permutation test. Communications in Statistics-Theory and Methods, 53(6), 2141-2153.
</p>
<p>Yu, H., &amp; Hutson, A. D. (2024). Inferential procedures based on the weighted Pearson correlation coefficient test statistic. Journal of Applied Statistics, 51(3), 481-496.
</p>


<h3>Examples</h3>

<pre><code class="language-R">set.seed(123)
x &lt;- rnorm(20)
y &lt;- rnorm(20)
perm_test(x, y, B = 500, method = "Pearson", alternative = "greater")

perm_test(x, y, B = 500, method = "Spearman", alternative = "two.sided")

perm_test(x, y, B = 500, w = rep(0.05,20), method = "wtdPearson", alternative = "less")

perm_test(x, y, B = 500, r0 = -0.5, method = "CCC", alternative = "greater")

</code></pre>


</div>