<div class="container">

<table style="width: 100%;"><tr>
<td>plot.pendensity</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>Plotting estimated penalized densities</h2>

<h3>Description</h3>

<p>Plotting estimated penalized densities, need object of class 'pendensity'. 
</p>


<h3>Usage</h3>

<pre><code class="language-R">## S3 method for class 'pendensity'
plot(x, plot.val = 1, val=NULL, latt = FALSE, kernel = FALSE, confi = TRUE,
 main = NULL, sub = NULL, xlab = NULL, ylab = NULL, plot.base = FALSE,
 lwd=NULL,legend.txt=NULL,plot.dens=TRUE,...)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>x</code></td>
<td>
<p>object of class pendensity</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>plot.val</code></td>
<td>
<p>if plot.val=1 the density is plotted, if plot.val=2
the distribution function of the observation values is plotted, if
plot.val=3 the distribution function is plotted as function</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>val</code></td>
<td>
<p>vector of y, at which the estimated density should be calculated. If plot.val=2, the calculated values of distribution are returned and the values are pointed in the distribution function of the observed values.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>latt</code></td>
<td>
<p>TRUE/FALSE, if TRUE the lattice interface should be used for plotting, default=FALSE</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>kernel</code></td>
<td>
<p>TRUE/FALSE, if TRUE a kernel density estimation should be added to the density plots, default=FALSE</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>confi</code></td>
<td>
<p>TRUE/FALSE, if TRUE confidence intervals should be added to the density plots, default=TRUE </p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>main</code></td>
<td>
<p>Main of the density plot, if NULL main contains settings 'K', 'AIC' and 'lambda0' of the estimation</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>sub</code></td>
<td>
<p>sub of the density plot, if NULL sub contains settings used base 'base' and used order of B-Spline 'q'</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>xlab</code></td>
<td>
<p>xlab of the density plot, if NULL xlab contains 'y'</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>ylab</code></td>
<td>
<p>ylab of the density plot, if NULL ylab contains 'density'</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>plot.base</code></td>
<td>
<p>TRUE/FALSE, if TRUE the weighted base should be added to the density plot, default=FALSE</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>lwd</code></td>
<td>
<p>lwd of the lines of density plot, if NULL lwd=3, the confidence bands are plotted with lwd=2</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>legend.txt</code></td>
<td>
<p>if FALSE no legend is plotted, legend.txt can get a
vector of characters with length of the groupings. legend.txt works
only for plot.val=1</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>plot.dens</code></td>
<td>
<p>TRUE/FALSE, if the estimated density should be plotted. Default=TRUE. Interesting for evaluating densities in values 'val', while this special plot is not needed.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>...</code></td>
<td>
<p>further arguments</p>
</td>
</tr>
</table>
<h3>Details</h3>

<p>Each grouping of factors is plotted. Therefore, equidistant help values are constructed in the support of the response for each grouping of factors. Weighting these help values with knots weights ck results in the density estimation for each grouping of factors. If asked for, pointwise confidence intervals are computed and plotted.
</p>


<h3>Value</h3>

<p>If the density function is plotted, function returns two values
</p>
<table>
<tr style="vertical-align: top;">
<td><code>help.env</code></td>
<td>
<p>Contains the constructed help values for the response, the corresponding values for the densities and if asked for the calculated confidence intervals</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>combi</code></td>
<td>
<p>list of all combinations of the covariates</p>
</td>
</tr>
</table>
<p>If additionally the function is called with a valid argument for 'val',
a list returns with
</p>
<table>
<tr style="vertical-align: top;">
<td><code>y</code></td>
<td>
<p>values at which the estimated density has been calculated</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>fy</code></td>
<td>
<p>calculated density values in y</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>sd.up.y.val</code></td>
<td>
<p>the values of the upper confidence interval of y</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>sd.down.y.val</code></td>
<td>
<p>the values of the lower confidence interval of y</p>
</td>
</tr>
</table>
<p>If the empirical distribution function is plotted, the function returns
</p>
<table>
<tr style="vertical-align: top;">
<td><code>y</code></td>
<td>
<p>containing the observed values y</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>sum</code></td>
<td>
<p>containing the empirical distribution of each observation y</p>
</td>
</tr>
</table>
<p>If the theoretical distribution function is plotted, the function returns an environment. For plotting the theoretical distributions, each interval between two knots is evaluated at 100 equidistant simulated points between the two knots considered. These points are saved in the environment with the name "paste("x",i,sep="")" for each interval i, the calculated distribution is save with the name "paste("F(x)",i,sep="")" for each interval i. For these points, the distribution is calculated. 
</p>


<h3>Note</h3>

<p>For plotting the density and e.g. the empirical distributions, use e.g. 'X11()' before calling the second plot to open a new graphic device.
</p>


<h3>Author(s)</h3>

<p>Christian Schellhase &lt;cschellhase@wiwi.uni-bielefeld.de&gt;</p>


<h3>References</h3>

<p>Density Estimation with a Penalized Mixture Approach, Schellhase C. and Kauermann G. (2012), Computational Statistics 27 (4), p. 757-777.</p>


<h3>Examples</h3>

<pre><code class="language-R">y &lt;- rnorm(100)
test &lt;- pendensity(y~1)
plot(test)

#distribution
plot(test,plot.val=2)
</code></pre>


</div>