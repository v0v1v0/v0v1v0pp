<div class="container">

<table style="width: 100%;"><tr>
<td>plot-PSTr</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>
Plot a PST
</h2>

<h3>Description</h3>

<p>Plot a PST
</p>


<h3>Usage</h3>

<pre><code class="language-R">	## S4 method for signature 'PSTf,ANY'
plot(x, y=missing, max.level=NULL,
		nodePar = list(), edgePar = list(),
		axis=FALSE, xlab = NA, ylab = if (axis) { "L" } else {NA}, 
		horiz = FALSE, xlim, ylim, 
		withlegend=TRUE, ltext=NULL, cex.legend=1, 
		use.layout=withlegend!=FALSE, legend.prop=NA, ...)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>x</code></td>
<td>

<p>A PST, that is an object of class <code>PSTf</code> as returned by the <code>pstree</code> or <code>prune</code> method.
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>y</code></td>
<td>

<p>not applicable
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>max.level</code></td>
<td>
 
<p>integer. The maximal depth for the display of the tree.
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>nodePar</code></td>
<td>
 
<p>list. A list of parameters for tuning the node representation. Possible parameters are
</p>

<ul>
<li>
<p> node.size. numeric. The size of the node, in fraction of a unit of the x axis (or y axis if horiz=TRUE).
</p>
</li>
<li>
<p> gratio. The ratio between horizontal and vertical dimensions of the node. usefull if the horizontal and vertical dimensions of the plot are not equal. If not provided, it is estimated as a function of the number of leaves represented in the plot and the depth of the tree.
</p>
</li>
</ul>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>edgePar</code></td>
<td>
 
<p>list. A list of parameters for tuning the edges representation. Possible paramters are
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>axis</code></td>
<td>
 
<p>logical. If TRUE the axes are displayed on the plot.
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>xlab</code></td>
<td>
 
<p>character. Label for the x axis.
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>ylab</code></td>
<td>
 
<p>character. Label for the y axis representing the tree depth.
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>horiz</code></td>
<td>
 
<p>logical. If FALSE, the tree is represented vertically. The root node at depth L=0 is plotted on the top, and the nodes of maximal depth are plotted on the bottom of the plot. If TRUE, the tree is represented horizontally. The root node at depth L=0 is plotted on the right, and the nodes of maximal depth are plotted on the left of the plot.
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>xlim</code></td>
<td>

<p>numeric. Vector of length 2 giving the x limits for the plot. By default the limits are 1 .. number of terminal nodes (at max.level if specified). This may be usefull to facilitate comparison if several trees are plotted on the same figure.
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>ylim</code></td>
<td>

<p>numeric. Vector of length 2 giving the y limits for the plot. By default the limits are 0 .. max. depth of the tree (max.level if specified). This may be usefull to facilitate comparison if several trees are plotted on the same figure.
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>withlegend</code></td>
<td>
 
<p>defines if and where the legend of the state colors is plotted. The default value <code>TRUE</code> sets the position of the legend automatically. Other possible value is <code>"right"</code>.
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>ltext</code></td>
<td>

<p>optional description of the states to appear in the legend. Must be a vector of character strings with number of elements equal to the size of the alphabet. If unspecified, the <code>label</code> attribute of the <code>seqdata</code> sequence object is used (see <code>seqdef</code>).
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>cex.legend</code></td>
<td>

<p>expansion factor for setting the size of the font for the labels in the legend. The default value is 1. Values lesser than 1 will reduce the size of the font, values greater than 1 will increase the size.
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>use.layout</code></td>
<td>

<p>if <code>TRUE</code>, <code>layout</code> is used to arrange plots when using the group option or plotting a legend. When layout is activated, the standard '<code>par(mfrow=....)</code>' for arranging plots does not work. With <code>withlegend=FALSE</code> and <code>group=NULL</code>, layout is automatically deactivated and '<code>par(mfrow=....)</code>' can be used.
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>legend.prop</code></td>
<td>

<p>sets the proportion of the graphic area used for plotting the legend when <code>use.layout=TRUE</code> and <code>withlegend=TRUE</code>. Default value is set according to the place (bottom or right of the graphic area) where the legend is plotted. Values from 0 to 1.
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>...</code></td>
<td>

<p>arguments to be passed to the plot function or graphical parameters
</p>
</td>
</tr>
</table>
<h3>Details</h3>

<p>The function for graphical representation of a PST uses is recursive. The main argument of the function is a tree represented as a nested list (an object of class <code>PSTr</code>). See also <cite>Gabadinho 2016</cite>.
</p>


<h3>Author(s)</h3>

<p>Alexis Gabadinho, based on code from <code>plot.dendrogram</code> 
</p>


<h3>References</h3>

<p>Gabadinho, A. &amp; Ritschard, G. (2016). Analyzing State Sequences with Probabilistic Suffix Trees: The PST R Package. <em>Journal of Statistical Software</em>, <b>72</b>(3), pp. 1-39.
</p>


<h3>Examples</h3>

<pre><code class="language-R">data(s1)
s1 &lt;- seqdef(s1)
S1 &lt;- pstree(s1, L=3)
plot(S1)
plot(S1, horiz=TRUE)
plot(S1, nodePar=list(node.type="path", lab.type="prob", lab.pos=1, lab.offset=2, lab.cex=0.7), 
	edgePar=list(type="triangle"), withlegend=FALSE)
</code></pre>


</div>