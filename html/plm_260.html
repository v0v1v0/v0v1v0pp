<div class="container">

<table style="width: 100%;"><tr>
<td>vcovBK</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>Beck and Katz Robust Covariance Matrix Estimators</h2>

<h3>Description</h3>

<p>Unconditional Robust covariance matrix estimators <em>a la Beck
and Katz</em> for panel models (a.k.a. Panel Corrected Standard Errors
(PCSE)).
</p>


<h3>Usage</h3>

<pre><code class="language-R">vcovBK(x, ...)

## S3 method for class 'plm'
vcovBK(
  x,
  type = c("HC0", "HC1", "HC2", "HC3", "HC4"),
  cluster = c("group", "time"),
  diagonal = FALSE,
  ...
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>x</code></td>
<td>
<p>an object of class <code>"plm"</code>,</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>...</code></td>
<td>
<p>further arguments.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>type</code></td>
<td>
<p>the weighting scheme used, one of <code>"HC0"</code>, <code>"HC1"</code>,
<code>"HC2"</code>, <code>"HC3"</code>, <code>"HC4"</code>, see Details,</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>cluster</code></td>
<td>
<p>one of <code>"group"</code>, <code>"time"</code>,</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>diagonal</code></td>
<td>
<p>a logical value specifying whether to force
non-diagonal elements to zero,</p>
</td>
</tr>
</table>
<h3>Details</h3>

<p><code>vcovBK</code> is a function for estimating a robust covariance matrix of
parameters for a panel model according to the
Beck and Katz (1995) method, a.k.a. Panel
Corrected Standard Errors (PCSE), which uses an unconditional
estimate of the error covariance across time periods (groups)
inside the standard formula for coefficient
covariance. Observations may be clustered either by <code>"group"</code> to
account for timewise heteroskedasticity and serial correlation or
by <code>"time"</code> to account for cross-sectional heteroskedasticity and
correlation. It must be borne in mind that the Beck and Katz
formula is based on N- (T-) asymptotics and will not be appropriate
elsewhere.
</p>
<p>The <code>diagonal</code> logical argument can be used, if set to
<code>TRUE</code>, to force to zero all non-diagonal elements in the
estimated error covariances; this is appropriate if both serial and
cross–sectional correlation are assumed out, and yields a
timewise- (groupwise-) heteroskedasticity–consistent estimator.
</p>
<p>Weighting schemes specified by <code>type</code> are analogous to those in
<code>sandwich::vcovHC()</code> in package <a href="https://CRAN.R-project.org/package=sandwich"><span class="pkg">sandwich</span></a> and are
justified theoretically (although in the context of the standard
linear model) by MacKinnon and White (1985) and
Cribari–Neto (2004) (see Zeileis 2004).
</p>
<p>The main use of <code>vcovBK</code> (and the other variance-covariance estimators
provided in the package <code>vcovHC</code>, <code>vcovNW</code>, <code>vcovDC</code>, <code>vcovSCC</code>) is to pass
it to plm's own functions like <code>summary</code>, <code>pwaldtest</code>, and <code>phtest</code> or
together with testing functions from the <code>lmtest</code> and <code>car</code> packages. All of
these typically allow passing the <code>vcov</code> or <code>vcov.</code> parameter either as a
matrix or as a function, e.g., for Wald–type testing: argument <code>vcov.</code> to
<code>coeftest()</code>, argument <code>vcov</code> to <code>waldtest()</code> and other methods in the
<a href="https://CRAN.R-project.org/package=lmtest"><span class="pkg">lmtest</span></a> package; and argument <code>vcov.</code> to
<code>linearHypothesis()</code> in the <a href="https://CRAN.R-project.org/package=car"><span class="pkg">car</span></a> package (see the
examples), see (see also Zeileis 2004), 4.1-2, and examples below.
</p>


<h3>Value</h3>

<p>An object of class <code>"matrix"</code> containing the estimate of
the covariance matrix of coefficients.
</p>


<h3>Author(s)</h3>

<p>Giovanni Millo
</p>


<h3>References</h3>

<p>Beck N, Katz JN (1995).
“What to do (and not to do) with time-series cross-section data.”
<em>American Political Science Review</em>, <b>89</b>(03), 634–647.
</p>
<p>Cribari–Neto F (2004).
“Asymptotic Inference Under Heteroskedasticity of Unknown Form.”
<em>Computational Statistics &amp; Data Analysis</em>, <b>45</b>, 215–233.
</p>
<p>Greene WH (2003).
<em>Econometric Analysis</em>, 5th edition.
Prentice Hall.
</p>
<p>MacKinnon JG, White H (1985).
“Some Heteroskedasticity–Consistent Covariance Matrix Estimators With Improved Finite Sample Properties.”
<em>Journal of Econometrics</em>, <b>29</b>, 305–325.
</p>
<p>Zeileis A (2004).
“Econometric Computing With HC and HAC Covariance Matrix Estimators.”
<em>Journal of Statistical Software</em>, <b>11</b>(10), 1–17.
<a href="https://www.jstatsoft.org/article/view/v011i10">https://www.jstatsoft.org/article/view/v011i10</a>.
</p>


<h3>See Also</h3>

<p><code>sandwich::vcovHC()</code> from the <a href="https://CRAN.R-project.org/package=sandwich"><span class="pkg">sandwich</span></a>
package for weighting schemes (<code>type</code> argument).
</p>


<h3>Examples</h3>

<pre><code class="language-R">
data("Produc", package="plm")
zz &lt;- plm(log(gsp)~log(pcap)+log(pc)+log(emp)+unemp, data=Produc, model="random")
summary(zz, vcov = vcovBK)
summary(zz, vcov = function(x) vcovBK(x, type="HC1"))

## standard coefficient significance test
library(lmtest)
coeftest(zz)
## robust significance test, cluster by group
## (robust vs. serial correlation), default arguments
coeftest(zz, vcov.=vcovBK)
## idem with parameters, pass vcov as a function argument
coeftest(zz, vcov.=function(x) vcovBK(x, type="HC1"))
## idem, cluster by time period
## (robust vs. cross-sectional correlation)
coeftest(zz, vcov.=function(x) vcovBK(x, type="HC1", cluster="time"))
## idem with parameters, pass vcov as a matrix argument
coeftest(zz, vcov.=vcovBK(zz, type="HC1"))
## joint restriction test
waldtest(zz, update(zz, .~.-log(emp)-unemp), vcov=vcovBK)
## Not run: 
## test of hyp.: 2*log(pc)=log(emp)
library(car)
linearHypothesis(zz, "2*log(pc)=log(emp)", vcov.=vcovBK)

## End(Not run)
</code></pre>


</div>