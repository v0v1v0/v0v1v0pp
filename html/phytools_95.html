<div class="container">

<table style="width: 100%;"><tr>
<td>evolvcv.lite</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>Likelihood test for a shift in the evolutionary correlation between traits</h2>

<h3>Description</h3>

<p>Fits a multi-regime model for differences in the evolutionary variance-covariance structure or correlation between two continuous traits, following Revell &amp; Collar (2009) and Revell et al. (2022).
</p>


<h3>Usage</h3>

<pre><code class="language-R">evolvcv.lite(tree, X, maxit=2000, tol=1e-10, ...)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>tree</code></td>
<td>
<p>an object of class <code>"simmap"</code>. If <code>tree</code> is an object of class <code>"phylo"</code> then a simple multivariate Brownian motion model will be fit to the data in <code>X</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>X</code></td>
<td>
<p>an <code>n</code> x <code>m</code> matrix of tip values for <code>m</code> continuously valued traits in <code>n</code> species - row names should be species names. If <code>X</code> is supplied as a data frame it will be coerced into a matrix without warning.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>maxit</code></td>
<td>
<p>an optional integer value indicating the maximum number of iterations for optimization - may need to be increased for large trees.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>tol</code></td>
<td>
<p>tolerance value for <code>"L-BFGS-B"</code> optimization.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>...</code></td>
<td>
<p>other optional arguments. The most important optional argument is probably <code>models</code> which species the models to be fit. See <em>Description</em> for more information. A second useful argument is <code>error_vcv</code> which should be supplied as a list of matrices of sampling <em>variances</em> and covariances for (and between) the means of each species. The sampling variance for the mean is just the square of the sampling error. Sampling covariances will tend to be zero (or close to zero) if error for different traits is uncorrelated, for instance, because different specimens were used to estimate the means for different traits, and non-zero otherwise.</p>
</td>
</tr>
</table>
<h3>Details</h3>

<p>This function takes an object of class <code>"simmap"</code> with a mapped binary or multi-state trait and data for two and only two continuously valued character. It then fits (by default) four different evolutionary models: common rates and correlation; different rates, common correlation; different correlations, common rates; no common structure.
</p>
<p>In addition to the four default models specified above, <code>evolvcv.lite</code> now fits an additional four additional models.
</p>
<p>The set of models to be fit can be specified using the optional argument <code>models</code> in multiple ways.
</p>
<p>First, if left unspecified, then the four models listed above will be fit.
</p>
<p>Second, if <code>models</code> is set to <code>"all models"</code> than eight models will be fit.
</p>
<p>Lastly, one or more (up to all eight) models can be fit by encoding the models to be fit into a single vector containing a subset or all of the following elements: <code>"1"</code>, <code>"2"</code>, <code>"2b"</code>, <code>"3"</code>, <code>"3b"</code>, <code>"3c"</code>, and <code>"4"</code>. These codes correspond to the following eight models: 1. common rates, common correlation; 2. different rates, common correlation; 2b. different rates for trait 1 only, common correlation; 2c. different rates for trait 2 only, common correlation; 3. common rates, different correlations; 3b. different rates for trait 1 only, different correlations; 3c. different rates for trait 2 only, different correlation; and 4. no common structure.
</p>


<h3>Value</h3>

<p>A list with the results summarized for each model.
</p>


<h3>Author(s)</h3>

<p>Liam Revell <a href="mailto:liam.revell@umb.edu">liam.revell@umb.edu</a></p>


<h3>References</h3>

<p>Revell, L. J. (2024) phytools 2.0: an updated R ecosystem for phylogenetic comparative methods (and other things). <em>PeerJ</em>, <b>12</b>, e16505.
</p>
<p>Revell, L. J., and D. C. Collar (2009) Phylogenetic analysis of the evolutionary correlation using likelihood. <em>Evolution</em>, <b>63</b>, 1090-1100.
</p>
<p>Revell, L. J., K. S. Toyama, and D. L. Mahler (2022) A simple hierarchical model for heterogeneity in the evolutionary correlation on a phylogenetic tree. <em>PeerJ</em>, <b>10</b>, e13910.
</p>


<h3>See Also</h3>

<p><code>brownie.lite</code>, <code>evol.vcv</code>
</p>


<h3>Examples</h3>

<pre><code class="language-R">## load data from Revell &amp; Collar (2009)
data(sunfish.tree)
data(sunfish.data)
## fit heirarchical common-structure models
sunfish.fit&lt;-evolvcv.lite(sunfish.tree,
    sunfish.data[,2:3],models="all models")
## print fitted models
print(sunfish.fit)
## compare models
anova(sunfish.fit)
</code></pre>


</div>