<div class="container">

<table style="width: 100%;"><tr>
<td>fingerprint.regression</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>Regress trait evolution against trait ecology (following
Cavender-Bares et al. 2004)</h2>

<h3>Description</h3>

<p>Calculates traits' phylogenetic inertia and regresses this against
trait similarity among co-existing species (sensu Cavender-Bares et
al. 2004 Figure 6)
</p>


<h3>Usage</h3>

<pre><code class="language-R">fingerprint.regression(
  data,
  eco.rnd = c("taxa.labels", "richness", "frequency", "sample.pool", "phylogeny.pool",
    "independentswap", "trialswap"),
  eco.method = c("quantile", "lm", "mantel"),
  eco.permute = 1000,
  evo.method = c("lambda", "delta", "kappa", "blom.k"),
  eco.swap = 1000,
  abundance = TRUE,
  ...
)

## S3 method for class 'fingerprint.regression'
print(x, ...)

## S3 method for class 'fingerprint.regression'
summary(object, ...)

## S3 method for class 'fingerprint.regression'
plot(
  x,
  eco = c("slope", "corrected"),
  xlab = "Community Trait Similarity",
  ylab = "Phylogenetic inertia",
  ...
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>data</code></td>
<td>
<p><code>comparative.comm</code> for analysis</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>eco.rnd</code></td>
<td>
<p>null distribution with which to compare your
community data, one of: <code>taxa.labels</code> (DEFAULT),
<code>richness</code>, <code>frequency</code>, <code>sample.pool</code>,
<code>phylogeny.pool</code>, <code>independentswap</code>, <code>trialswap</code> (as
implemented in <code>picante</code>)</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>eco.method</code></td>
<td>
<p>how to compare distance matrices (only the lower
triangle;), one of: <code>lm</code> (linear regression),
<code>quantile</code> (DEFAULT; <code>rq</code>),
<code>mantel</code> (<code>mantel</code>)</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>eco.permute</code></td>
<td>
<p>number of permutations for ecological null model
(<code>eco.rnd</code>); default 1000</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>evo.method</code></td>
<td>
<p>how to measure phylogenetic inertia, one of:
<code>lambda</code> (default), <code>delta</code>, <code>kappa</code>, <code>blom.k</code>;
see <code>phy.signal</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>eco.swap</code></td>
<td>
<p>number of independent swap iterations to perform
(if specified in <code>eco.rnd</code>; DEFAULT 1000)</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>abundance</code></td>
<td>
<p>whether to incorporate species' abundances
(default: TRUE)</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>...</code></td>
<td>
<p>additional parameters to pass on to model fitting
functions and plotting functions</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>x</code></td>
<td>
<p><code>fingerprint.regression</code> object</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>object</code></td>
<td>
<p><code>fingerprint.regression</code> object</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>eco</code></td>
<td>
<p>plot the observed slopes (DEFAULT: <code>slope</code>), or the
median difference between the simulations and the observed values
(<code>corrected</code>)</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>xlab</code></td>
<td>
<p>label for x-axis (default "Ecological Trait Coexistence")</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>ylab</code></td>
<td>
<p>label for y-axis (default "Phylogenetic inertia")</p>
</td>
</tr>
</table>
<h3>Details</h3>

<p>While the term ‘fingerprint regression’ is new to pez, the method
is very similar to that employed in Cavender-Bares et al. 2004
Figure 6. For each trait, the phylogenetic inertia of species
traits is regressed against their co-occurrence in the community
matrix. Note that Pagel's lambda, delta, and kappa, and Blomberg's
K, can be used, unlike the original where a mantel test was
employed. Moreover, note also that Pianka's distance (as described
in the manuscript) is used to measure species overlap.
</p>


<h3>Note</h3>

<p>Like <code>eco.xxx.regression</code>, this is a data-hungry
method. Warnings will be generated if any of the methods cannot be
fitted properly (the examples below give toy examples of this). In
such cases the summary and plot methods of these functions may
generate errors; perhaps using <code>traceback</code> to examine
where these are coming from, and consider whether you want to be
working with the data generating these errors. I am loathe to hide
these errors or gloss over them, because they represent the reality
of your data!
</p>
<p>WDP loves quantile regressions, and advises that you check
different quantiles using the <code>tau</code> options.
</p>


<h3>Author(s)</h3>

<p>Will Pearse and Jeannine Cavender-Bares
</p>


<h3>References</h3>

<p>Cavender-Bares J., Ackerly D.D., Baum D.A. &amp; Bazzaz F.A. (2004) Phylogenetic overdispersion in Floridian oak communities. The Americant Naturalist 163(6): 823–843.
</p>
<p>Kembel, S.W., Cowan, P.D., Helmus, M.R., Cornwell, W.K., Morlon, H., Ackerly, D.D., Blomberg, S.P. &amp; Webb, C.O. Picante: R tools for integrating phylogenies and ecology. Bioinformatics 26(11): 1463–1464.
</p>
<p>Pagel M. Inferring the historical patterns of biological evolution. Nature 401(6756): 877–884.
</p>


<h3>See Also</h3>

<p><code>eco.xxx.regression</code> <code>phy.signal</code>
</p>


<h3>Examples</h3>

<pre><code class="language-R">data(laja)
data &lt;- comparative.comm(invert.tree, river.sites, invert.traits, river.env)
fingerprint.regression(data, eco.permute=10)
plot(fingerprint.regression(data, permute=10, method="lm"))
</code></pre>


</div>