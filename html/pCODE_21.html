<div class="container">

<table style="width: 100%;"><tr>
<td>tunelambda</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>Find optimial penalty parameter lambda by cross-validation.</h2>

<h3>Description</h3>

<p>Obtain the optimal sparsity parameter given a search grid based on cross validation score with replications.
</p>


<h3>Usage</h3>

<pre><code class="language-R">tunelambda(data, time, ode.model, par.names, state.names,
                  par.initial, basis.list,lambda_grid,cv_portion,kfolds, rep,controls)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>data</code></td>
<td>
<p>A data frame or matrix contrain observations from each dimension of the ODE model.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>time</code></td>
<td>
<p>The vector contain observation times or a matrix if time points are different between dimensions.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>ode.model</code></td>
<td>
<p>Defined R function that computes the time derivative of the ODE model given observations of states variable.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>par.names</code></td>
<td>
<p>The names of structural parameters defined in the 'ode.model'.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>state.names</code></td>
<td>
<p>The names of state variables defined in the 'ode.model'.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>par.initial</code></td>
<td>
<p>Initial value of structural parameters to be optimized.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>basis.list</code></td>
<td>
<p>A list of basis objects for smoothing each dimension's observations. Can be the same or different across dimensions.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>lambda_grid</code></td>
<td>
<p>A search grid for finding the optimial sparsity parameter lambda.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>cv_portion</code></td>
<td>
<p>A number indicating the proportion of data will be saved for doing cross validation. Default is set at 5 as minimum.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>kfolds</code></td>
<td>
<p>A number indicating the number of folds the data should be seprated into.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>rep</code></td>
<td>
<p>A integer controls the number of replication of doing cross-validation for each penalty parameter.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>controls</code></td>
<td>
<p>A list of control parameters. See ‘Details’.</p>
</td>
</tr>
</table>
<h3>Value</h3>

<table>
<tr style="vertical-align: top;">
<td><code>lambda_grid</code></td>
<td>
<p>The original input vector of a search grid for the optimal lambda.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>cv.score</code></td>
<td>
<p>The matrix contains the cross validation score for each lambda of each replication</p>
</td>
</tr>
</table>
</div>