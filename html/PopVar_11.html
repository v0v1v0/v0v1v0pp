<div class="container">

<table style="width: 100%;"><tr>
<td>mppop.predict</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>Predict genetic variance and genetic correlations in multi-parent populations
using a deterministic equation.</h2>

<h3>Description</h3>

<p>Predicts the genotypic mean, genetic variance, and
usefulness criterion (superior progeny mean) in a set of multi-parent populations
using marker effects and a genetic map. If more than two traits are specified,
the function will also return predictions of the genetic correlation in the population
and the correlated response to selection.
</p>


<h3>Usage</h3>

<pre><code class="language-R">mppop.predict(
  G.in,
  y.in,
  map.in,
  crossing.table,
  parents,
  n.parents = 4,
  tail.p = 0.1,
  self.gen = 10,
  DH = FALSE,
  models = c("rrBLUP", "BayesA", "BayesB", "BayesC", "BL", "BRR"),
  n.core = 1,
  ...
)

mppop_predict2(
  M,
  y.in,
  marker.effects,
  map.in,
  crossing.table,
  parents,
  n.parents = 4,
  tail.p = 0.1,
  self.gen = 10,
  DH = FALSE,
  models = c("rrBLUP", "BayesA", "BayesB", "BayesC", "BL", "BRR"),
  n.core = 1,
  ...
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>G.in</code></td>
<td>
<p>See <code>G.in</code> in <code>pop.predict</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>y.in</code></td>
<td>
<p>See <code>y.in</code> in <code>pop.predict</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>map.in</code></td>
<td>
<p>See <code>map.in</code> in <code>pop.predict</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>crossing.table</code></td>
<td>
<p>A <code>data.frame</code> with 2 columns (for bi-parental crosses) or 4 columns (for four-way crosses), each of which contains the names of parents to use in a potential cross. Rows contain individual crosses. See Details.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>parents</code></td>
<td>
<p>See <code>parents</code> in <code>pop.predict</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>n.parents</code></td>
<td>
<p>Integer number of parents per cross. May be 2 or 4. If <code>crossing.table</code> is passed,
this argument is ignored.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>tail.p</code></td>
<td>
<p>See <code>tail.p</code> in <code>pop.predict</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>self.gen</code></td>
<td>
<p>The number of selfing generations in the potential cross. Can be an integer or <code>Inf</code> for
recombinant inbreds. Note: <code>self.gen = 1</code> corresponds to an F2 population.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>DH</code></td>
<td>
<p>Indicator if doubled-haploids are to be induced after the number of selfing generations indicated by
<code>self.gen</code>. For example, if <code>self.gen = 0</code> and <code>DH = TRUE</code>, then doubled-haploids are assumed
to be induced using gametes from F1 plants.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>models</code></td>
<td>
<p>See <code>models</code> in <code>pop.predict</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>n.core</code></td>
<td>
<p>Number of cores for parallelization. Parallelization is supported
only on a Linux or Mac OS operating system; if working on a Windows system, the function
is executed on a single core.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>...</code></td>
<td>
<p>Additional arguments to pass depending on the choice of <code>model</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>M</code></td>
<td>
<p>A Matrix of marker genotypes of dimensions <code>nLine</code> x <code>nMarker</code>, coded as
-1, 0, and 1.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>marker.effects</code></td>
<td>
<p>A data frame of marker effects. The first column should include the marker name and
subsequent columns should include the marker effects. Supercedes <code>y.in</code> if passed.</p>
</td>
</tr>
</table>
<h3>Details</h3>

<p>Predictions are based on the deterministic equations specified by Allier et al. (2019).
</p>
<p>In the case of four-way crosses (i.e. 4 parents), the function assumes that the first two parents are mated,
producing a <code class="reqn">F_1</code> offspring; then, the next two parents are mated, producing another <code class="reqn">F_1</code> offspring.
The two <code class="reqn">F_1</code> offspring are then mated and inbreeding or doubled haploid induction (if specified) proceeds
from there. For example, say cross <em>i</em> uses parents P1, P2, P3, and P4. P1 and P2 are first mated,
producing O1; then, P3 and P4 are mated, producing O2; then, O1 and O2 are mated, producing a segregating family.
</p>
<p>The <code>mppop.predict</code> function takes similarly formatted arguments as the <code>pop.predict</code> function
in the <code>PopVar</code> package. For the sake of simplicity, we also include the <code>mppop_predict2</code> function, which
takes arguments in a format more consistent with other genomewide prediction packages/functions.
</p>
<p>If you select a <code>model</code> other than "rrBLUP", you must specify the following additional arguments:
</p>

<ul>
<li>
<p><code>nIter</code>: See <code>pop.predict</code>.
</p>
</li>
<li>
<p><code>burnIn</code>: See <code>pop.predict</code>.
</p>
</li>
</ul>
<h3>Value</h3>

<p>A <code>data.frame</code> containing predictions of <code class="reqn">\mu</code>, <code class="reqn">V_G</code>, and <code class="reqn">\mu_{sp}</code> for
each trait for each potential multi-parent cross. When multiple traits are provided, the correlated
responses and correlation between all pairs of traits is also returned.
</p>


<h3>References</h3>

<p>Allier, A., L. Moreau, A. Charcosset, S. Teyssèdre, and C. Lehermeier, 2019 Usefulness Criterion and Post-selection Parental
Contributions in Multi-parental Crosses: Application to Polygenic Trait Introgression. G3 (Bethesda) 9: 1469–1479.
https://doi.org/https://doi.org/10.1534/g3.119.400129
</p>


<h3>Examples</h3>

<pre><code class="language-R">

# Load data
data("think_barley")

# Vector with 8 parents
parents &lt;- sample(y.in_ex$Entry, 8)

# Create a crossing table with four parents per cross
cross_tab &lt;- as.data.frame(t(combn(x = parents, m = 4)))
names(cross_tab) &lt;- c("parent1", "parent2", "parent3", "parent4")

out &lt;- mppop_predict2(M = G.in_ex_mat, y.in = y.in_ex, map.in = map.in_ex, 
                      crossing.table = cross_tab, models = "rrBLUP")






</code></pre>


</div>