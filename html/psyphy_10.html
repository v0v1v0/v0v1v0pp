<div class="container">

<table style="width: 100%;"><tr>
<td>glm.WH</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2> mafc Probit Fit to Psychometric Function with Upper Asymptote Less than One</h2>

<h3>Description</h3>

<p>A probit fit of a psychometric function with upper asymptote less than 1 is obtained by cycling between a fit with <code>glm</code> using the <code>probit.lambda</code> link and <code>optimize</code> to estimate <code>lambda</code>, 1 - the upper asymptotic value, until the log Likelihood changes by less than a  pre-set tolerance.
</p>


<h3>Usage</h3>

<pre><code class="language-R">glm.WH(formula, data, NumAlt = 2, lambda.init = 0.01, 
	interval = c(0, 0.05), trace = FALSE, tol = 1e-06, ...)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>formula</code></td>
<td>
<p> a symbolic description of the model to be fit. </p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>data</code></td>
<td>
<p> an optional data frame, list or enviroment (or object coercible by <code>as.data.frame</code> containing the variables in the model.  If not found in data, the variables are taken from the <code>environment(formula)</code>, typically the environment from <code>glm.WH</code> was called.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>NumAlt</code></td>
<td>
<p> integer indicating the number of alternatives (&gt; 1) in the mafc-task.  (Default: 2). </p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>lambda.init</code></td>
<td>
<p> numeric, initial estimate of 1 - upper asymptote. </p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>interval</code></td>
<td>
<p> numeric vector giving interval endpoints within which to search for <code>lambda</code>. </p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>trace</code></td>
<td>
<p> logical, indicating whether or not to print out a trace of the iterative process. </p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>tol</code></td>
<td>
<p> numeric, tolerance for ending iterations.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>...</code></td>
<td>
<p> futher arguments passed to <code>glm</code>. </p>
</td>
</tr>
</table>
<h3>Details</h3>

<p>The psychometric function fit to the data is described by
</p>
<p style="text-align: center;"><code class="reqn">P(x) = 1/m + (1 -  1/m - \lambda) \Phi(x)</code>
</p>
<p> where <code class="reqn">m</code> is the number of alternatives and the lower asymptote, <code class="reqn">1 - \lambda</code> is the upper asymptote and <code class="reqn">\Phi</code> is the cumulative normal function.</p>


<h3>Value</h3>

<p>returns an object of class ‘lambda’ which inherits from classes ‘glm’ and ‘lm’.  It only differs from an object of class ‘glm’ in including an additional components, <code>lambda</code>, giving the estimated minimum of <code>lambda</code>.  The degrees of freedom are reduced by 1 to take into account the estimation of <code>lambda</code>.</p>


<h3>Author(s)</h3>

<p> Ken Knoblauch </p>


<h3>References</h3>

<p>Wichmann, F. A. and Hill, N. J. (2001) The psychometric function: I.Fitting, sampling, and goodness of fit. Percept Psychophys., 63(8), 1293–1313.
</p>
<p>Yssaad-Fesselier, R. and Knoblauch, K. (2006) Modeling psychometric
functions in R. <em> Behav Res Methods.</em>,  <b>38(1)</b>, 28–41. (for examples
with <code>gnlr</code>).	
</p>


<h3>See Also</h3>

 <p><code>mafc</code>, <code>glm</code>,<code>glm.lambda</code>, <code>probit.lambda</code>, <code>family</code> </p>


<h3>Examples</h3>

<pre><code class="language-R">b &lt;- 3.5
g &lt;- 1/4
d &lt;- 0.04
a &lt;- 0.04
p &lt;- c(a, b, g, d)
num.tr &lt;- 160
cnt &lt;- 10^seq(-2, -1, length = 6) # contrast levels

#simulated Weibull-Quick observer responses
truep &lt;- g + (1 - g - d) * pweibull(cnt, b, a)
ny &lt;- rbinom(length(cnt), num.tr, truep)
nn &lt;- num.tr - ny
phat &lt;- ny/(ny + nn)
resp.mat &lt;- matrix(c(ny, nn), ncol = 2)

tst.glm &lt;- glm(resp.mat ~ cnt, binomial(mafc.probit(1/g)))
pcnt &lt;- seq(0.005, 1, len = 1000)
plot(cnt, phat, log = "x", ylim = c(0, 1), xlim = c(0.005, 1),
	cex = 1.75)
lines(pcnt, predict(tst.glm, data.frame(cnt = pcnt), type = "response"), lwd = 2)
tst.lam &lt;- glm.WH(resp.mat ~ cnt, NumAlt = 1/g, trace = TRUE)
lines(pcnt, predict(tst.lam, data.frame(cnt = pcnt), 
	type = "response"), lty = 2, lwd = 2)

</code></pre>


</div>