<div class="container">

<table style="width: 100%;"><tr>
<td>scoh</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>
Plotting the squared coherence statistic of time series
</h2>

<h3>Description</h3>

<p>The magnitude of squared coherence is computed in a specified square set of <code class="reqn">( \lambda_p, \lambda_q) \in [0, 2\pi) </code>
and using a specified smoothing window. The perception of this empirical spectral coherence is aided
by plotting the coherence values only at points where thereshold is exceeded. For identification/discovery of 
PC structure, the sample periodic mean should be first subtracted from the series because a periodic mean itself has 
PC structure that can dominate and confound the perception of the second order PC structure.
</p>


<h3>Usage</h3>

<pre><code class="language-R">scoh(x, m, win,...)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>x</code></td>
<td>

<p>input time series.
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>m</code></td>
<td>

<p>length of the smoothing window.
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>win</code></td>
<td>

<p>vector of smoothing weights, they should be non-negative.
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>...</code></td>
<td>
<p>other arguments that will be connected with squared coherence statistic plot: <code>pfa</code>, <code>plflg</code>, <code>bfflg</code>, <code>ix</code>, <code>iy</code>, <code>nx</code>, <code>ny</code>, <code>datastr</code>,
where <br><code>plflg</code> should be positive to plot values of statistic,<br><code>pfa</code>  should be positive to plot threshold,<br><code>bfflg</code> is a Bonferroni correction parameter; it sholud be positive to correct <code>pfa</code> before thresholding,<br><code>ix</code> and <code>iy</code> are initial values at x and y axes (the lower left corner of plot),<br><code>nx, ny</code> are the incremental frequency indices above the starting point <code>(ix,iy)</code> (the ending values of frequency index are <code>ix+nx,iy+ny</code>),<br><code>datastr</code> string name of data for printing.<br>  
By default they are fixed to <code>pfa = 1</code>, <code>plflg = 1</code>, <code>bfflg = 1</code>, <code>ix = 0</code>, <code>iy = 0</code>, <code>nx = length(x)/2</code>, <code>ny = length(x)/2</code>, <code>datastr = "data")</code>.
</p>
</td>
</tr>
</table>
<h3>Details</h3>

<p>To ensure that periodic structure seen in the spectral coherence image is not a consequence 
of an additive periodic mean, it is recommended that the <code>permest</code> function is first used to remove the periodic mean.
</p>


<h3>Value</h3>

<p>The program returns plot of squared coherence statistic values, that
exceed threshold.
</p>


<h3>Author(s)</h3>

<p>Harry Hurd 
</p>


<h3>References</h3>

<p>Hurd, H. L., Gerr, N. L., (1991), Graphical Methods for Determining
the Presence of Periodic Correlation in Time Series, J.
Time Series Anal.,  (12),   pp. 337-350(1991).
<br><br>
Hurd, H. L., Miamee, A. G., (2007), Periodically Correlated Random Sequences: 
Spectral Theory and Practice, Wiley InterScience.
</p>


<h3>See Also</h3>

<p><code>pgram</code>, <code>permest</code>
</p>


<h3>Examples</h3>

<pre><code class="language-R">## Do not run 
## It could take a few seconds

data(volumes)
m=16
win=matrix(1/m,1,m)
dev.set(which=1)
scoh(t(volumes),m,win,datastr='volumes')
</code></pre>


</div>