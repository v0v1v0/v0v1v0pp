<div class="container">

<table style="width: 100%;"><tr>
<td>convt</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>Calculate time to convergence</h2>

<h3>Description</h3>

<p>Calculate the time to convergence of a population matrix projection model
from the model projection
</p>


<h3>Usage</h3>

<pre><code class="language-R">convt(A, vector = "n", accuracy = 0.01, iterations = 1e+05)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>A</code></td>
<td>
<p>a square, non-negative numeric matrix of any dimension</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>vector</code></td>
<td>
<p>(optional) a numeric vector or one-column matrix describing 
the age/stage distribution used to calculate the projection.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>accuracy</code></td>
<td>
<p>the accuracy with which to determine convergence on 
asymptotic growth, expressed as a proportion (see details).</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>iterations</code></td>
<td>
<p>the maximum number of iterations of the model before the 
code breaks.  For slowly-converging models and/or high specified convergence
accuracy, this may need to be increased.</p>
</td>
</tr>
</table>
<h3>Details</h3>

<p><code>convt</code> works by simulating the given model and manually 
determining growth when convergence to the given <code>accuracy</code> is reached. 
Convergence on an asymptotic growth is deemed to have been reached when the 
growth of the model stays within the window determined by <code>accuracy</code> for 
10*s iterations of the model, with s equal to the dimension of <code>A</code>. For 
example, projection of an 8 by 8 matrix with convergence accuracy of 1e-2 is 
deemed to have converged on asymptotic growth when 10*8=80 consecutive 
iterations of the model have a growth within 1-1e-2=0.99 (i.e. 99%) and 
1+1e-2=1.01 (i.e. 101%) of each other.
</p>
<p>If <code>vector</code> is specified, the convergence time of the projection of 
<code>vector</code> through <code>A</code> is returned. If <code>vector="n"</code> then 
asymptotic growths of the set of 'stage-biased' vectors are calculated. These 
projections are achieved using a set of standard basis vectors equal in number 
to the dimension of <code>A</code>. These have every element equal to 0, except for 
a single element equal to 1, i.e. for a matrix of dimension 3, the set of 
stage-biased vectors are: <code>c(1,0,0)</code>, <code>c(0,1,0)</code> and 
<code>c(0,0,1)</code>.
</p>
<p>Due to the way in which convergence is defined, <code>convt</code> can 
only properly work for strongly ergodic models. Therefore, it will not 
function for imprimitive (therefore potentially weakly ergodic) or reducible 
(therefore potentially nonergodic) models.
</p>


<h3>Value</h3>

<p>If <code>vector</code> is specified, the convergence time of <code>vector</code> projected
through <code>A</code>.
</p>
<p>If <code>vector</code> is not specified, a numeric vector of convergence times for 
corresponding stage-biased projections: the length of the vector is equal to 
the dimension of <code>A</code>; the first entry is the convergence time of 
[1,0,0,...], the second entry is the convergence time of [0,1,0,...], etc.).
</p>


<h3>References</h3>


<ul><li>
<p> Stott et al. (2011) Ecol. Lett., 14, 959-970.
</p>
</li></ul>
<h3>See Also</h3>

<p>Other ConvergenceMeasures: 
<code>dr()</code>,
<code>truelambda()</code>
</p>


<h3>Examples</h3>

<pre><code class="language-R"> # Create a 3x3 PPM
 ( A &lt;- matrix(c(0,1,2,0.5,0.1,0,0,0.6,0.6), byrow=TRUE, ncol=3) )

 # Create an initial stage structure
 ( initial &lt;- c(1,3,2) )

 # Calculate the convergence time of the 3 stage-biased 
 # populations within 0.1% of lambda-max
 ( convt(A, accuracy=1e-3) )

 # Calculate the convergence time of the projection of initial and A
 # to within 0.001% of lambda-max
 ( convt(A, vector=initial, accuracy=1e-5) )

</code></pre>


</div>