<div class="container">

<table style="width: 100%;"><tr>
<td>rraf</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>Round Robin Allele Frequencies</h2>

<h3>Description</h3>

<p>This function utilizes <code>rrmlg</code> to calculate multilocus genotypes 
and then subsets each locus by the resulting MLGs to calculate the 
round-robin allele frequencies used for pgen and psex.
</p>


<h3>Usage</h3>

<pre><code class="language-R">rraf(gid, pop = NULL, res = "list", by_pop = FALSE, correction = TRUE, ...)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>gid</code></td>
<td>
<p>a genind or genclone object</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>pop</code></td>
<td>
<p>either a formula to set the population factor from the 
<code>strata</code> slot or a vector specifying the population factor for 
each sample. Defaults to <code>NULL</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>res</code></td>
<td>
<p>either "list" (default), "vector", or "data.frame".</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>by_pop</code></td>
<td>
<p>When this is <code>TRUE</code>, the calculation will be done by 
population. Defaults to <code>FALSE</code></p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>correction</code></td>
<td>
<p>a logical indicating whether or not zero-valued allele 
frequencies should be corrected using the methods outlined in 
correcting rare alleles. 
(Default: <code>TRUE</code>)</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>...</code></td>
<td>
<p>options from correcting rare
alleles. The default is to correct allele frequencies to 1/n</p>
</td>
</tr>
</table>
<h3>Details</h3>

<p>Calculating allele frequencies for clonal populations is a difficult
task. Frequencies calculated on non-clone-corrected data suffer from bias 
due to non-independent samples. On the other hand, frequencies calculated 
on clone-corrected data artificially increases the significance of rare 
alleles. The method of round-robin allele frequencies as presented in Parks
and Werth (1993) provides a method of calculating allele frequencies in a 
way that minimizes both of these effects. 
</p>


<h4>Rare Alleles</h4>

<p>Allele frequencies at a given locus are
calculated based on samples that are <strong>clone corrected without that
locus</strong>. When this happens, rare alleles have a high likelihood of dropping
out, giving them a frequency of "0". For some analyses, this is a perfectly
fine outcome, but for analyses such as <code>pgen</code> and
<code>psex</code>, this could result in undefined values. Setting 
<code>correction = TRUE</code> will allow you to control how these zero-valued 
allele frequencies are corrected. For details, please see the documentation
on correcting rare alleles and examples.</p>



<h3>Value</h3>

<p>a vector or list of allele frequencies
</p>


<h3>Note</h3>

<p>When <code>by_pop = TRUE</code>, the output will be a matrix of allele 
frequencies. Additionally, when the argument <code>pop</code> is not <code>NULL</code>,
<code>by_pop</code> is automatically <code>TRUE</code>.
</p>


<h3>Author(s)</h3>

<p>Zhian N. Kamvar, Jonah Brooks, Stacy A. Krueger-Hadfield, Erik Sotka
</p>


<h3>References</h3>

<p>Arnaud-Haond, S., Duarte, C. M., Alberto, F., &amp; Serr√£o, E. A. 2007.
Standardizing methods to address clonality in population studies.
<em>Molecular Ecology</em>, 16(24), 5115-5139.
</p>
<p>Parks, J. C., &amp; Werth, C. R. 1993. A study of spatial features of clones in a
population of bracken fern, <em>Pteridium aquilinum</em> (Dennstaedtiaceae).
<em>American Journal of Botany</em>, 537-544.
</p>


<h3>See Also</h3>

<p><code>rrmlg</code>, <code>pgen</code>, <code>psex</code>,
<code>rare_allele_correction</code>
</p>


<h3>Examples</h3>

<pre><code class="language-R">
data(Pram)

# Round robin allele frequencies, correcting zero-valued frequencies to 1/nInd(Pram)
rraf(Pram)


## Not run: 

## Round robin allele frequencies will be different than observed

# Compare to without round robin:
PrLoc &lt;- seploc(Pram, res = "mat") # get locus by matrix
lapply(PrLoc, colMeans, na.rm = TRUE)

# Without round robin, clone corrected:
Pcc    &lt;- clonecorrect(Pram, strata = NA) # indiscriminantly clone correct
PccLoc &lt;- seploc(Pcc, res = "mat")
lapply(PccLoc, colMeans, na.rm = TRUE)

## Different methods of obtaining round robin allele frequencies

# Get vector output.
rraf(Pram, res = "vector")

# Getting the output as a data frame allows us to use ggplot2 to visualize
(Prdf &lt;- rraf(Pram, res = "data.frame"))
library("ggplot2")
ggplot(Prdf, aes(y = allele, x = frequency)) +
  geom_point() +
  facet_grid(locus ~ ., scale = "free_y", space = "free")

## Round Robin allele frequencies by population (matrix only)

# By default, allele frequencies will be corrected by 1/n per population
(Prbp &lt;- rraf(Pram, by_pop = TRUE))

# This might be problematic because populations like PistolRSF_OR has a 
# population size of four.

# By using the 'e' argument to rare_allele_correction, this can be set to a
# more reasonable value.
(Prbp &lt;- rraf(Pram, by_pop = TRUE, e = 1/nInd(Pram)))




## End(Not run)
</code></pre>


</div>