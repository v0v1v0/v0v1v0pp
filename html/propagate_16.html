<div class="container">

<table style="width: 100%;"><tr>
<td>numDerivs</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>Functions for creating Gradient and Hessian matrices by numerical differentiation (Richardson's method) of the partial derivatives</h2>

<h3>Description</h3>

<p>These two functions create Gradient and Hessian matrices by Richardson's central finite difference method of the partial derivatives for any expression. 
</p>


<h3>Usage</h3>

<pre><code class="language-R">numGrad(expr, envir = .GlobalEnv)
numHess(expr, envir = .GlobalEnv)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>expr</code></td>
<td>
<p>an expression, such as <code>expression(x/y)</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>envir</code></td>
<td>
<p>the <code>environment</code> to evaluate in.</p>
</td>
</tr>
</table>
<h3>Details</h3>

<p>Calculates first- and second-order numerical approximation using Richardson's <b>central difference formula</b>:<br></p>
<p style="text-align: center;"><code class="reqn">f'_i(x) \approx \frac{f(x_1, \ldots, x_i + d, \ldots, x_n) - f(x_1, \ldots, x_i - d, \ldots, x_n)}{2d}</code>
</p>

<p style="text-align: center;"><code class="reqn">f''_i(x) \approx \frac{f(x_1, \ldots, x_i + d, \ldots, x_n) - 2f(x_1, \ldots, x_n) + f(x_1, \ldots, x_i - d, \ldots, x_n)}{d^2}</code>
</p>



<h3>Value</h3>

<p>The numeric Gradient/Hessian matrices.</p>


<h3>Note</h3>

<p>The two functions are modified versions of the <code>genD</code> function in the 'numDeriv' package, but a bit more easy to handle because they use expressions and the function's <code>x</code> value must not be defined as splitted scalar values <code>x[1], x[2], ... x[n]</code> in the body of the function.</p>


<h3>Author(s)</h3>

<p>Andrej-Nikolai Spiess
</p>


<h3>Examples</h3>

<pre><code class="language-R">## Check for equality of symbolic  
## and numerical derivatives.
EXPR &lt;- expression(2^x + sin(2 * y) - cos(z))
x &lt;- 5
y &lt;- 10
z &lt;- 20

symGRAD &lt;- evalDerivs(makeGrad(EXPR))
numGRAD &lt;- numGrad(EXPR)
all.equal(symGRAD, numGRAD)

symHESS &lt;- evalDerivs(makeHess(EXPR))
numHESS &lt;- numHess(EXPR)
all.equal(symHESS, numHESS)
</code></pre>


</div>