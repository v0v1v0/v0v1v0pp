<div class="container">

<table style="width: 100%;"><tr>
<td>construct_adj_r_squared</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>Construct adjusted R squared</h2>

<h3>Description</h3>

<p>This function computes the adjusted R squared and returns some useful matrices from this computation.
</p>


<h3>Usage</h3>

<pre><code class="language-R">construct_adj_r_squared(X, k, y, n, intercept = c(TRUE, FALSE), sst)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>X</code></td>
<td>
<p>Design matrix of type "matrix"  and dimension nxp</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>k</code></td>
<td>
<p>Index set included in model k</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>y</code></td>
<td>
<p>Response vector of type "matrix"  and dimension nx1</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>n</code></td>
<td>
<p>An integer for the sample size</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>intercept</code></td>
<td>
<p>Logical value: TRUE if fitted models should contain intercept, FALSE if not</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>sst</code></td>
<td>
<p>An integer for the total sum of squares</p>
</td>
</tr>
</table>
<h3>Value</h3>

<table>
<tr style="vertical-align: top;">
<td><code>X_M_k</code></td>
<td>
<p>The design matrix of model k</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>P_M_k</code></td>
<td>
<p>The projection matrix of model k</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>R_M_k</code></td>
<td>
<p>The orthogonal projection matrix of model k</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>kappa_M_k</code></td>
<td>
<p>Adjustment factor for model complexity kappa of model k</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>adj_r_squared</code></td>
<td>
<p>The adjusted R squared value of model k</p>
</td>
</tr>
</table>
<h3>References</h3>

<p>Pirenne, S. and Claeskens, G. (2024). Exact Post-Selection Inference for Adjusted R Squared.
</p>


<h3>Examples</h3>

<pre><code class="language-R"># Generate data
n &lt;- 100
k &lt;- 1:10
Data &lt;- datagen.norm(seed = 7, n, p = 10, rho = 0, beta_vec = c(1,0.5,0,0.5,0,0,0,0,0,0))
X &lt;- Data$X
y &lt;- Data$y
sst &lt;- sum((y-mean(y))^2)

construct_adj_r_squared(X, k, y, n, intercept=FALSE, sst)
</code></pre>


</div>