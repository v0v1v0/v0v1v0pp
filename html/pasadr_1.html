<div class="container">

<table style="width: 100%;"><tr>
<td>pasad_test</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>
A test function of Process-Aware Stealthy Attack Detection(PASAD)
</h2>

<h3>Description</h3>

<p>Singular value decomposition of log covariance matrix (Trajectory matrix). This is a test phase of pasad
</p>


<h3>Usage</h3>

<pre><code class="language-R">pasad_test(obj, test_idx, newdata, r = 3, calib = 1, thres = NULL, movn = 10, plot = TRUE)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>obj</code></td>
<td>
<p>A pasad model object result from <code>pasad_train</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>test_idx</code></td>
<td>
<p>A test index for pasad. For example, <code>test_idx = c(1:4801)</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>newdata</code></td>
<td>
<p>A test data for pasad.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>r</code></td>
<td>
<p>A cardinal number of eigen value. Generally, r is same by the training phase.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>calib</code></td>
<td>
<p>A threshold multiplier. since the threshold calculated during the training phase is a rather small, so the calib can be multiplied to the threshold. (default is 1, should be biggner than 0).</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>thres</code></td>
<td>
<p>If user already know the threshold, user can input the threshold.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>movn</code></td>
<td>
<p>A moving average window value to see the trend of the score.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>plot</code></td>
<td>
<p>Whether to draw a anomaly score or not. (default : TRUE).</p>
</td>
</tr>
</table>
<h3>Value</h3>

<p>An object of class <code>pasad_test</code>.
</p>
<table>
<tr style="vertical-align: top;">
<td><code>total_scores</code></td>
<td>
<p>Anomaly score results from the pasad.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>tr_score</code></td>
<td>
<p>A pasad score of the training index.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>te_score</code></td>
<td>
<p>A pasad score of the test index.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>extraced</code></td>
<td>
<p>A noise-reduced signal.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>threshold</code></td>
<td>
<p>A (calculated) threshold.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>outidx</code></td>
<td>
<p>An index of a anomaly score greater than the threshold.</p>
</td>
</tr>
</table>
<h3>Author(s)</h3>

<p>Donghwan Kim<br><a href="mailto:donhkim9714@korea.ac.kr">donhkim9714@korea.ac.kr</a>
<a href="mailto:dhkim2@bistel.com">dhkim2@bistel.com</a>
</p>


<h3>References</h3>

<p>Wissam Aoudi, Mikel Iturbe, and Magnus Almgren (2018) &lt;DOI:10.1145/3243734.3243781&gt;. <em>In Proceedings of the 2018 ACM SIGSAC Conference on Computer and Communications Security</em>, pp. 817-831.
<br><a href="https://github.com/mikeliturbe/pasad">https://github.com/mikeliturbe/pasad</a>
<a href="https://github.com/rahulrajpl/PyPASAD">https://github.com/rahulrajpl/PyPASAD</a>
</p>


<h3>See Also</h3>

<p><code>pasad_train</code></p>


<h3>Examples</h3>

<pre><code class="language-R"># data input
fpath = system.file("extdata", "sa.csv", package="pasadr")
sa = read.csv(fpath)

# check data
sig = sa$V5
plot(sig)

# training using pasad and check the scree plot
train_idx = c(1:500)  
obj = pasad_train(x = sig, 
                  train_idx = train_idx,
                  r = 1, 
                  ws = length(train_idx)/2,
                  scree_plot = TRUE)
                  
# test whole data and check the anomaly score of test data
pred = pasad_test(obj = obj, 
                  test_idx = 1:4801,
                  newdata = sig, 
                  r = 1, 
                  calib = 1,  
                  plot = TRUE)
                  
# check the structure of test results
str(pred)

</code></pre>


</div>