<div class="container">

<table style="width: 100%;"><tr>
<td>plsim.MAVE</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>Minimum Average Variance Estimation</h2>

<h3>Description</h3>

<p>MAVE (Minimum Average Variance Estimation), proposed by Xia <em>et al.</em> (2006)
to estimate parameters in PLSiM
</p>
<p style="text-align: center;"><code class="reqn">Y=\eta(Z^T\alpha)+X^T\beta+\epsilon.</code>
</p>



<h3>Usage</h3>

<pre><code class="language-R">plsim.MAVE(...)

## S3 method for class 'formula'
plsim.MAVE(formula, data, ...)

## Default S3 method:
plsim.MAVE(xdat=NULL, zdat, ydat, h=NULL, zeta_i=NULL, maxStep=100,
tol=1e-8, iniMethods="MAVE_ini", ParmaSelMethod="SimpleValidation", TestRatio=0.1, 
K = 3, seed=0, verbose=TRUE, ...)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>...</code></td>
<td>
<p>additional arguments.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>formula</code></td>
<td>
<p>a symbolic description of the model to be fitted.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>data</code></td>
<td>
<p>an optional data frame, list or environment containing the variables in the model.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>xdat</code></td>
<td>
<p>input matrix (linear covariates). The model reduces to a single index model when <code>x</code> is NULL.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>zdat</code></td>
<td>
<p>input matrix (nonlinear covariates). <code>z</code> should not be NULL.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>ydat</code></td>
<td>
<p>input vector (response variable).</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>h</code></td>
<td>
<p>a numerical value or a vector for bandwidth. If <code>h</code> is NULL, a default 
vector c(0.01,0.02,0.05,0.1,0.5) will be given. 
plsim.bw is employed to select the optimal bandwidth when <code>h</code> is a vector or NULL.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>zeta_i</code></td>
<td>
<p>initial coefficients, optional (default: NULL). It could be obtained by the function <code>plsim.ini</code>.
<code>zeta_i[1:ncol(z)]</code> is the initial coefficient vector <code class="reqn">\alpha_0</code>,
and <code>zeta_i[(ncol(z)+1):(ncol(z)+ncol(x))]</code> is the initial coefficient vector <code class="reqn">\beta_0</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>maxStep</code></td>
<td>
<p>the maximum iterations, default: 100.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>tol</code></td>
<td>
<p>convergence tolerance, default: 1e-8.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>iniMethods</code></td>
<td>
<p>string, optional (default: "SimpleValidation").</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>ParmaSelMethod</code></td>
<td>
<p>the parameter for the function plsim.bw.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>TestRatio</code></td>
<td>
<p>the parameter for the function plsim.bw.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>K</code></td>
<td>
<p>the parameter for the function plsim.bw.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>seed</code></td>
<td>
<p>int, default: 0.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>verbose</code></td>
<td>
<p>bool, default: TRUE. Enable verbose output.</p>
</td>
</tr>
</table>
<h3>Value</h3>

<table>
<tr style="vertical-align: top;">
<td><code>eta</code></td>
<td>
<p>estimated non-parametric part <code class="reqn">\hat{\eta}(Z^T{\hat{\alpha} })</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>zeta</code></td>
<td>
<p>estimated coefficients. <code>zeta[1:ncol(z)]</code> is <code class="reqn">\hat{\alpha}</code>, 
and <code>zeta[(ncol(z)+1):(ncol(z)+ncol(x))]</code> is <code class="reqn">\hat{\beta}</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>data</code></td>
<td>
<p>data information including <code>x</code>, <code>z</code>, <code>y</code>, bandwidth <code>h</code>, 
initial coefficients <code>zetaini</code> and iteration step <code>MaxStep</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>y_hat</code></td>
<td>
 <p><code>y</code>'s estimates.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>mse</code></td>
<td>
<p>mean squares erros between <code>y</code> and <code>y_hat</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>variance</code></td>
<td>
<p>variance of <code>y_hat</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>r_square</code></td>
<td>
<p>multiple correlation coefficient.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>Z_alpha</code></td>
<td>
 <p><code class="reqn">Z^T{\hat{\alpha}}</code>.</p>
</td>
</tr>
</table>
<h3>References</h3>

<p>Y. Xia, W. HÃ¤rdle. <em>Semi-parametric estimation of partially linear single-index models</em>.
Journal of Multivariate Analysis, 2006, 97(5): 1162-1184.
</p>


<h3>Examples</h3>

<pre><code class="language-R">
# EXAMPLE 1 (INTERFACE=FORMULA)
# To estimate parameters in partially linear single-index model using MAVE.

n = 30
sigma = 0.1

alpha = matrix(1,2,1)
alpha = alpha/norm(alpha,"2")

beta = matrix(4,1,1)

x = matrix(1,n,1)
z = matrix(runif(n*2),n,2)
y = 4*((z%*%alpha-1/sqrt(2))^2) + x%*%beta + sigma*matrix(rnorm(n),n,1)

fit = plsim.MAVE(y~x|z, h=0.1)

# EXAMPLE 2 (INTERFACE=DATA FRAME)
# To estimate parameters in partially linear single-index model using MAVE.

n = 30
sigma = 0.1

alpha = matrix(1,2,1)
alpha = alpha/norm(alpha,"2")
beta = matrix(4,1,1)

x = rep(1,n)
z1 = runif(n)
z2 = runif(n) 
X = data.frame(x)
Z = data.frame(z1,z2)

x = data.matrix(X)
z = data.matrix(Z)
y = 4*((z%*%alpha-1/sqrt(2))^2) + x%*%beta + sigma*matrix(rnorm(n),n,1)

fit = plsim.MAVE(xdat=X, zdat=Z, ydat=y, h=0.1)

</code></pre>


</div>