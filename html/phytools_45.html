<div class="container">

<table style="width: 100%;"><tr>
<td>brownie.lite</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>Likelihood test for rate variation in a continuous trait</h2>

<h3>Description</h3>

<p>Fits a multi-rate Brownian motion evolution model using maximum likelihood.
</p>


<h3>Usage</h3>

<pre><code class="language-R">brownie.lite(tree, x, maxit=2000, test="chisq", nsim=100, se=NULL, ...)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>tree</code></td>
<td>
<p>a phylogenetic tree either as an object of class <code>"phylo"</code> or <code>"simmap"</code>. (See <code>read.simmap</code>, <code>make.simmap</code>, or <code>paintSubTree</code> for more details about the latter object class.)</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>x</code></td>
<td>
<p>a vector of tip values for species. <code>names(x)</code> should be the species names.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>maxit</code></td>
<td>
<p>an optional integer value indicating the maximum number of iterations for optimization - may need to be increased for large trees.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>test</code></td>
<td>
<p>an optional string indicating the method for hypothesis testing - options are <code>"chisq"</code> or <code>"simulation"</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>nsim</code></td>
<td>
<p>number of simulations (only used if <code>test="simulation"</code>).</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>se</code></td>
<td>
<p>a vector containing the standard errors for each estimated mean in <code>x</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>...</code></td>
<td>
<p>optional arguments.</p>
</td>
</tr>
</table>
<h3>Details</h3>

<p>This function takes an object of class <code>"phylo"</code> or class <code>"simmap"</code> with a mapped binary or multi-state trait (see <code>read.simmap</code>) and data for a single continuously valued character.  It then fits the Brownian rate variation ("noncensored") model of O'Meara et al. (2006; <em>Evolution</em>). This is also the basic model implemented in Brian O'Meara's <em>Brownie</em> software.
</p>
<p>Sampling error in the estimation of species means can also be accounted for by assigning the vector <code>se</code> with the species specific sampling errors for <code>x</code>.
</p>


<h3>Value</h3>

<p>An object of class <code>"brownie.lite"</code> containing the following elements:
</p>
<table>
<tr style="vertical-align: top;">
<td><code>sig2.single</code></td>
<td>
<p>is the rate, <code class="reqn">\sigma^2</code>, for a single-rate model. This is usually the "null" model.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>a.single</code></td>
<td>
<p>is the estimated state at the root node for the single rate model.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>var.single</code></td>
<td>
<p>variance on the single rate estimator - obtained from the Hessian.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>logL1</code></td>
<td>
<p>log-likelihood of the single-rate model.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>k1</code></td>
<td>
<p>number of parameters in the single rate model (always 2).</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>sig2.multiple</code></td>
<td>
<p>is a length <em>p</em> (for <em>p</em> rates) vector of BM rates (<code class="reqn">\sigma_1^2</code>, <code class="reqn">\sigma_2^2</code>, and so on) from the multi-rate model.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>a.multiple</code></td>
<td>
<p>is the estimated state at the root node for the multi-rate model.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>var.multiple</code></td>
<td>
<p><em>p</em> x <em>p</em> variance-covariance matrix for the <em>p</em> rates - the square-roots of the diagonals should give the standard error for each rate.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>logL.multiple</code></td>
<td>
<p>log-likelihood of the multi-rate model.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>k2</code></td>
<td>
<p>number of parameters in the multi-rate model (<em>p</em>+1).</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>P.chisq</code></td>
<td>
<p>P-value for a likelihood ratio test against the <code class="reqn">\chi^2</code> distribution; or</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>P.sim</code></td>
<td>
<p>P-value for a likelihood ratio test against a simulated null distribution.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>convergence</code></td>
<td>
<p>logical value indicating if the likelihood optimization converged.</p>
</td>
</tr>
</table>
<h3>Author(s)</h3>

<p>Liam Revell <a href="mailto:liam.revell@umb.edu">liam.revell@umb.edu</a></p>


<h3>References</h3>

<p>O'Meara, B. C., C. Ane, M. J. Sanderson, and P. C. Wainwright (2006) Testing for different rates of continuous trait evolution using likelihood. <em>Evolution</em>, <b>60</b>, 922-933.
</p>
<p>Revell, L. J. (2024) phytools 2.0: an updated R ecosystem for phylogenetic comparative methods (and other things). <em>PeerJ</em>, <b>12</b>, e16505.
</p>


<h3>See Also</h3>

<p><code>brownieREML</code>, <code>evol.vcv</code>, <code>ratebytree</code>
</p>


<h3>Examples</h3>

<pre><code class="language-R">## load data from Revell &amp; Collar (2009)
data(sunfish.tree)
data(sunfish.data)
## extract character of interest
buccal.length&lt;-setNames(sunfish.data$buccal.length,
    rownames(sunfish.data))
## fit model
multiBM.fit&lt;-brownie.lite(sunfish.tree,
    buccal.length)
print(multiBM.fit)
</code></pre>


</div>