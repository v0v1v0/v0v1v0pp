<div class="container">

<table style="width: 100%;"><tr>
<td>weightM</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>Generate optimal GMM weighting matrix</h2>

<h3>Description</h3>

<p>In a Wooldridge estimation setting, i.e., in a system GMM framework, this function returns the optimal weighting matrix or the variance-covariance matrix given 1st or 2nd stage estimation results.
</p>


<h3>Usage</h3>

<pre><code class="language-R">  weightM(Y, X1, X2, Z1, Z2, betas, numR, SE = FALSE)
</code></pre>


<h3>Arguments</h3>


<table><tr style="vertical-align: top;">
<td><code>Y</code></td>
<td>

<p>Vector of log(value added output).
</p>
</td>
</tr></table>
<table><tr style="vertical-align: top;">
<td><code>X1</code></td>
<td>

<p>Matrix of regressors for the first equation.
</p>
</td>
</tr></table>
<table><tr style="vertical-align: top;">
<td><code>X2</code></td>
<td>

<p>Matrix of regressors for the second equation.
</p>
</td>
</tr></table>
<table><tr style="vertical-align: top;">
<td><code>Z1</code></td>
<td>

<p>Matrix of instruments for the first equation.
</p>
</td>
</tr></table>
<table><tr style="vertical-align: top;">
<td><code>Z2</code></td>
<td>

<p>Matrix of instruments for the second equation.
</p>
</td>
</tr></table>
<table><tr style="vertical-align: top;">
<td><code>betas</code></td>
<td>

<p>Vector of first/second stage parameter estimates.
</p>
</td>
</tr></table>
<table><tr style="vertical-align: top;">
<td><code>numR</code></td>
<td>

<p>Number of state + number of free + number of control variables (i.e., number of constrained parameters).
</p>
</td>
</tr></table>
<table><tr style="vertical-align: top;">
<td><code>SE</code></td>
<td>

<p>Binary indicator for first (<code>SE == FALSE</code>, the default) or second stage.
</p>
</td>
</tr></table>
<h3>Details</h3>

<p><code>weightM()</code> accepts at least 7 inputs: Y, X1, X2, Z1, Z2, betas and numR. With these, computes the optimal weighting matrix in a system GMM framework, i.e. W* = sigma*Z'Z. If it is called during the first stage, it returns W*, otherwise will return an estimate of the parameters' standard errors, i.e., the square root of the diagonal of the variance-covariance matrix: 1/N( (X'Z) W* (Z'X) )^-1.
</p>


<h3>Author(s)</h3>

<p>Gabriele Rovigatti</p>


</div>