<div class="container">

<table style="width: 100%;"><tr>
<td>normalize</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>Normalize spectral data</h2>

<h3>Description</h3>

<p>This method returns a spectral object of the same class as the one supplied
as argument but with the spectral data normalized to 1.0 at a specific
wavelength.  When the object contains multiple spectra, the normalisation is
applied to each spectrum individually.
</p>


<h3>Usage</h3>

<pre><code class="language-R">normalize(x, ...)

normalise(x, ...)

## Default S3 method:
normalize(x, ...)

## S3 method for class 'source_spct'
normalize(
  x,
  ...,
  range = NULL,
  norm = "max",
  unit.out = getOption("photobiology.radiation.unit", default = "energy"),
  keep.scaling = FALSE,
  na.rm = FALSE
)

## S3 method for class 'response_spct'
normalize(
  x,
  ...,
  range = NULL,
  norm = "max",
  unit.out = getOption("photobiology.radiation.unit", default = "energy"),
  keep.scaling = FALSE,
  na.rm = FALSE
)

## S3 method for class 'filter_spct'
normalize(
  x,
  ...,
  range = NULL,
  norm = "max",
  qty.out = getOption("photobiology.filter.qty", default = "transmittance"),
  keep.scaling = FALSE,
  na.rm = FALSE
)

## S3 method for class 'reflector_spct'
normalize(
  x,
  ...,
  range = NULL,
  norm = "max",
  qty.out = NULL,
  keep.scaling = FALSE,
  na.rm = FALSE
)

## S3 method for class 'solute_spct'
normalize(
  x,
  ...,
  range = NULL,
  norm = "max",
  keep.scaling = FALSE,
  na.rm = FALSE
)

## S3 method for class 'raw_spct'
normalize(
  x,
  ...,
  range = NULL,
  norm = "max",
  keep.scaling = FALSE,
  na.rm = FALSE
)

## S3 method for class 'cps_spct'
normalize(
  x,
  ...,
  range = NULL,
  norm = "max",
  keep.scaling = FALSE,
  na.rm = FALSE
)

## S3 method for class 'generic_spct'
normalize(
  x,
  ...,
  range = NULL,
  norm = "max",
  col.names,
  keep.scaling = FALSE,
  na.rm = FALSE
)

## S3 method for class 'source_mspct'
normalize(
  x,
  ...,
  range = NULL,
  norm = "max",
  unit.out = getOption("photobiology.radiation.unit", default = "energy"),
  keep.scaling = FALSE,
  na.rm = FALSE,
  .parallel = FALSE,
  .paropts = NULL
)

## S3 method for class 'response_mspct'
normalize(
  x,
  ...,
  range = NULL,
  norm = "max",
  unit.out = getOption("photobiology.radiation.unit", default = "energy"),
  keep.scaling = FALSE,
  na.rm = FALSE,
  .parallel = FALSE,
  .paropts = NULL
)

## S3 method for class 'filter_mspct'
normalize(
  x,
  ...,
  range = NULL,
  norm = "max",
  qty.out = getOption("photobiology.filter.qty", default = "transmittance"),
  keep.scaling = FALSE,
  na.rm = FALSE,
  .parallel = FALSE,
  .paropts = NULL
)

## S3 method for class 'reflector_mspct'
normalize(
  x,
  ...,
  range = x,
  norm = "max",
  qty.out = NULL,
  keep.scaling = FALSE,
  na.rm = FALSE,
  .parallel = FALSE,
  .paropts = NULL
)

## S3 method for class 'raw_mspct'
normalize(
  x,
  ...,
  range = x,
  norm = "max",
  keep.scaling = FALSE,
  na.rm = FALSE,
  .parallel = FALSE,
  .paropts = NULL
)

## S3 method for class 'cps_mspct'
normalize(
  x,
  ...,
  range = x,
  norm = "max",
  keep.scaling = FALSE,
  na.rm = FALSE,
  .parallel = FALSE,
  .paropts = NULL
)

## S3 method for class 'solute_mspct'
normalize(
  x,
  ...,
  range = x,
  norm = "max",
  keep.scaling = FALSE,
  na.rm = FALSE,
  .parallel = FALSE,
  .paropts = NULL
)

## S3 method for class 'generic_mspct'
normalize(
  x,
  ...,
  range = NULL,
  norm = "max",
  col.names,
  keep.scaling = FALSE,
  na.rm = FALSE,
  .parallel = FALSE,
  .paropts = NULL
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>x</code></td>
<td>
<p>An R object</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>...</code></td>
<td>
<p>not used in current version</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>range</code></td>
<td>
<p>An R object on which <code>range()</code> returns a numeric vector of
length 2 with the limits of a range of wavelengths in nm, with min and max
wavelengths (nm) used to set boundaries for search for normalization.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>norm</code></td>
<td>
<p>numeric Normalization wavelength (nm) or character string "max",
or "min" for normalization at the corresponding wavelength, "update" to
update the normalization after modifying units of expression, quantity
or range but respecting the previously used criterion, or "skip" to force
return of <code>x</code> unchanged.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>unit.out</code></td>
<td>
<p>character Allowed values "energy", and "photon",
or its alias "quantum"</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>keep.scaling</code></td>
<td>
<p>logical or numeric Flag to indicate if any existing
scaling should be preserved or not. The default, <code>FALSE</code>, preserves
the behaviour of versions (&lt;= 0.10.9). If numeric, the spectrum is scaled
to this value before normalization and marked as not scaled.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>na.rm</code></td>
<td>
<p>logical indicating whether <code>NA</code> values should be stripped
before calculating the summary (e.g. "max") used for normalization.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>qty.out</code></td>
<td>
<p>character string  Allowed values are "transmittance", and
"absorbance" indicating on which quantity to apply the normalization.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>col.names</code></td>
<td>
<p>character vector containing the names of columns or
variables to which to apply the normalization.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>.parallel</code></td>
<td>
<p>if TRUE, apply function in parallel, using parallel backend
provided by foreach</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>.paropts</code></td>
<td>
<p>a list of additional options passed into the foreach function
when parallel computation is enabled. This is important if (for example)
your code relies on external data or packages: use the .export and
.packages arguments to supply them so that all cluster nodes have the
correct environment set up for computing.</p>
</td>
</tr>
</table>
<h3>Details</h3>

<p>By default normalization is done based on the maximum of the
spectral data. It is possible to also do the normalization based on a
user-supplied wavelength expressed in nanometres or the minimum. An
existing normalization can be updated for a different unit of expression or
after a conversion to a related spectral quantity.
</p>
<p>By default the function is applied to the whole spectrum, but by passing a
range of wavelengths as input, the search, e.g., for the maximum, can be
limited to a range of wavelengths of interest instead of the whole
spectrum.
</p>
<p>In 'photobiology' (&gt;= 0.10.8) detailed information about the normalization
is stored in an attribute. In 'photobiology' (&gt;= 0.10.10)
applying a new normalization to an already normalized spectrum recomputes
the multiplier factors stored in the attributes whenever possible. This
ensures that the returned object is identical, except for possible
accumulated loss of precision due to floating-point arithmetic,
independently of the previous application of a different normalization.
</p>


<h3>Value</h3>

<p>A copy of the object passed as argument to <code>x</code> with the values
of the spectral quantity rescaled to 1 at the normalization wavelength. If
the normalization wavelength is not already present in <code>x</code>, it is
added by interpolationâ€”i.e. the returned value may be one row longer than
<code>x</code>. Attributes <code>normalized</code> and <code>normalization</code> are set to
keep a log of the computations applied.
</p>


<h3>Methods (by class)</h3>


<ul>
<li> <p><code>normalize(default)</code>: Default for generic function
</p>
</li>
<li> <p><code>normalize(source_spct)</code>: Normalize a <code>source_spct</code> object.
</p>
</li>
<li> <p><code>normalize(response_spct)</code>: Normalize a response spectrum.
</p>
</li>
<li> <p><code>normalize(filter_spct)</code>: Normalize a filter spectrum.
</p>
</li>
<li> <p><code>normalize(reflector_spct)</code>: Normalize a reflector spectrum.
</p>
</li>
<li> <p><code>normalize(solute_spct)</code>: Normalize a solute spectrum.
</p>
</li>
<li> <p><code>normalize(raw_spct)</code>: Normalize a raw spectrum.
</p>
</li>
<li> <p><code>normalize(cps_spct)</code>: Normalize a cps spectrum.
</p>
</li>
<li> <p><code>normalize(generic_spct)</code>: Normalize a raw spectrum.
</p>
</li>
<li> <p><code>normalize(source_mspct)</code>: Normalize the members of a source_mspct object.
</p>
</li>
<li> <p><code>normalize(response_mspct)</code>: Normalize the members of a response_mspct object.
</p>
</li>
<li> <p><code>normalize(filter_mspct)</code>: Normalize the members of a filter_mspct object.
</p>
</li>
<li> <p><code>normalize(reflector_mspct)</code>: Normalize the members of a reflector_mspct object.
</p>
</li>
<li> <p><code>normalize(raw_mspct)</code>: Normalize the members of a raw_mspct object.
</p>
</li>
<li> <p><code>normalize(cps_mspct)</code>: Normalize the members of a cps_mspct object.
</p>
</li>
<li> <p><code>normalize(solute_mspct)</code>: Normalize the members of a solute_mspct object.
</p>
</li>
<li> <p><code>normalize(generic_mspct)</code>: Normalize the members of a solute_mspct object.
</p>
</li>
</ul>
<h3>Note</h3>

<p>When the spectrum passed as argument to <code>x</code> had been previously
scaled, in 'photobiology' (&lt;= 0.10.9) the scaling attribute was always
removed and no normalization factors returned. In 'photobiology'
(&gt;= 0.10.10) scaling information can be preserved by passing
<code>keep.scaling = TRUE</code>.
</p>
<p>By default if <code>x</code> contains one or more <code>NA</code> values and the
normalization is based on a summary quantity, the returned spectrum will
contain only <code>NA</code> values. If <code>na.rm == TRUE</code> then the summary
quantity will be calculated after striping <code>NA</code> values, and only the
values that were <code>NA</code> in <code>x</code> will be <code>NA</code> values in the
returned spectrum.
</p>
<p>When a numeric value is passed as argument to keep.scaling, the scaling
uses <code>f = "total"</code> or <code>f = "mean"</code> depending on the class of
<code>x</code>. Prescaling is only occasionally needed.
</p>
<p>Method <code>normalize</code> is implemented for <code>solute_spct</code> objects but
as the spectral data stored in them are a description of an intensive
property of a substance, normalization is unlikely to useful. To represent
solutions of specific concentrations of solutes, <code>filter_spct</code> objects
should be used instead.
</p>
<p><code>normalise()</code> is a synonym for this <code>normalize()</code> method.
</p>


<h3>See Also</h3>

<p>Other rescaling functions: 
<code>fscale()</code>,
<code>fshift()</code>,
<code>getNormalized()</code>,
<code>getScaled()</code>,
<code>is_normalized()</code>,
<code>is_scaled()</code>,
<code>setNormalized()</code>,
<code>setScaled()</code>
</p>


<h3>Examples</h3>

<pre><code class="language-R">
normalize(sun.spct)
normalise(sun.spct) # equivalent

normalize(sun.spct, norm = "max")
normalize(sun.spct, norm = 400)

</code></pre>


</div>