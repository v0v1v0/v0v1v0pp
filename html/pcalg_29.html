<div class="container">

<table style="width: 100%;"><tr>
<td>dsepAM</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>Test for d-separation in a MAG</h2>

<h3>Description</h3>

<p>This function tests for d-separation (also known as m-separation) of nodes <code>X</code> and nodes <code>Y</code> given nodes <code>S</code> in a MAG.
</p>


<h3>Usage</h3>

<pre><code class="language-R">dsepAM(X, Y, S = NULL, amat, verbose=FALSE)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>X</code></td>
<td>
<p>Vector of column numbers of nodes <code>X</code> in the adjacency matrix</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>Y</code></td>
<td>
<p>Vector of column numbers of nodes <code>Y</code> in the adjacency matrix</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>S</code></td>
<td>
<p>Vector of column numbers of nodes <code>S</code> in the adjacency matrix (may be empty)</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>amat</code></td>
<td>
<p>The Maximal Ancestral Graph encoded as adjacency matrix 
of type amatType</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>verbose</code></td>
<td>
<p>If true, more detailed output is provided.</p>
</td>
</tr>
</table>
<h3>Details</h3>

<p>This function checks separation in the moralized graph as
explained in Richardson and Spirtes (2002).</p>


<h3>Value</h3>

<p>TRUE if <code>X</code> and <code>Y</code> are d-separated by <code>S</code> in the 
MAG encoded by <code>amat</code>, otherwise FALSE.
</p>


<h3>Author(s)</h3>

<p>Markus Kalisch (<a href="mailto:kalisch@stat.math.ethz.ch">kalisch@stat.math.ethz.ch</a>), Joris Mooij
</p>


<h3>References</h3>

<p>T.S. Richardson and P. Spirtes (2002). Ancestral graph Markov models.
<em>Annals of Statistics</em> <b>30</b> 962-1030.
</p>


<h3>See Also</h3>

<p><code>dsepAMTest</code> for a wrapper of this function that can
easily be included into <code>skeleton</code>, <code>fci</code> or
<code>fciPlus</code>. <code>dsep</code> for a similar function for DAGs.
</p>


<h3>Examples</h3>

<pre><code class="language-R"># Y-structure MAG
# Encode as adjacency matrix
p &lt;- 4 # total number of variables
V &lt;- c("X1","X2","X3","X4") # variable labels
# amat[i,j] = 0 iff no edge btw i,j
# amat[i,j] = 1 iff i *-o j
# amat[i,j] = 2 iff i *-&gt; j
# amat[i,j] = 3 iff i *-- j
amat &lt;- rbind(c(0,0,2,0),
              c(0,0,2,0),
              c(3,3,0,2),
              c(0,0,3,0))
rownames(amat)&lt;-V
colnames(amat)&lt;-V

## d-separated
cat('X1 d-separated from X2? ', dsepAM(1,2,S=NULL,amat),'\n')
## not d-separated given node 3
cat('X1 d-separated from X2 given X4? ', dsepAM(1,2,S=4,amat),'\n')
## not d-separated by node 3 and 4
cat('X1 d-separated from X2 given X3 and X4? ', dsepAM(1,2,S=c(3,4),amat),'\n') 
</code></pre>


</div>