<div class="container">

<table style="width: 100%;"><tr>
<td>pvs.wnn</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>
P-Values to Classify New Observations (Weighted Nearest Neighbors)
</h2>

<h3>Description</h3>

<p>Computes nonparametric p-values for the potential class memberships of new observations. The p-values are based on 'weighted nearest-neighbors'.
</p>


<h3>Usage</h3>

<pre><code class="language-R">pvs.wnn(NewX, X, Y, wtype = c('linear', 'exponential'), W = NULL,
        tau = 0.3, distance = c('euclidean', 'ddeuclidean',
        'mahalanobis'), cova = c('standard', 'M', 'sym'))
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>NewX</code></td>
<td>
<p> data matrix consisting of one or several new observations (row vectors) to be classified. </p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>X</code></td>
<td>
<p> matrix containing training observations, where each observation is a row vector. </p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>Y</code></td>
<td>
<p> vector indicating the classes which the training observations belong to. </p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>wtype</code></td>
<td>
<p> type of the weight function (see section 'Details' below). </p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>W</code></td>
<td>
<p> vector of the (decreasing) weights (see section 'Details' below). </p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>tau</code></td>
<td>
<p> parameter of the weight function. If <code>tau</code> is a vector or <code>tau = NULL</code>, the program searches for the best <code>tau</code>. For more information see section 'Details'. </p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>distance</code></td>
<td>
<p> the distance measure: <br>
'euclidean':    fixed Euclidean distance, <br>
'ddeuclidean':  data driven Euclidean distance (component-wise standardization), <br>
'mahalanobis':  Mahalanobis distance. </p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>cova</code></td>
<td>
<p> estimator for the covariance matrix: <br>
'standard': standard estimator, <br>
'M': M-estimator, <br>
'sym': symmetrized M-estimator. </p>
</td>
</tr>
</table>
<h3>Details</h3>

<p>Computes nonparametric p-values for the potential class memberships of new observations. Precisely, for each new observation <code>NewX[i,]</code> and each class <code>b</code> the number <code>PV[i,b]</code> is a p-value for the null hypothesis that <code class="reqn">Y[i] = b</code>. <br>
This p-value is based on a permutation test applied to an estimated Bayesian likelihood ratio, using 'weighted nearest neighbors' with estimated prior probabilities <code class="reqn">N(b)/n</code>. Here <code class="reqn">N(b)</code> is the number of observations of class <code class="reqn">b</code> and <code class="reqn">n</code> is the total number of observations. <br>
The (decreasing) weights for the observation can be either indicated with a <code class="reqn">n</code> dimensional vector <code>W</code> or (<code>if W = NULL</code>) one of the following weight functions can be used: <br>
linear: </p>
<p style="text-align: center;"><code class="reqn">W_i = \max(1-\frac{i}{n}/\tau,0),</code>
</p>

<p>exponential: </p>
<p style="text-align: center;"><code class="reqn">W_i = (1-\frac{i}{n})^\tau.</code>
</p>

<p>If <code>tau</code> is a vector, the program searches for the best <code>tau</code>. To determine the best <code>tau</code> for the p-value <code>PV[i,b]</code>, the new observation <code>NewX[i,]</code> is added to the training data with class label <code>b</code> and then for all training observations with <code>Y[j] != b</code> the sum of the weights of the observations belonging to class <code>b</code> is computed. Then the <code>tau</code> which minimizes the sum of these values is chosen. <br>
If <code>tau = NULL</code>, it is set to <code>seq(0.1,0.9,0.1)</code> if <code>wtype = "l"</code> and to <code>c(1,5,10,20)</code> if <code>wtype = "e"</code>. 
</p>


<h3>Value</h3>

<p><code>PV</code> is a matrix containing the p-values. Precisely, for each new observation <code>NewX[i,]</code> and each class <code>b</code> the number <code>PV[i,b]</code> is a p-value for the null hypothesis that <code class="reqn">Y[i] = b</code>. <br>
If <code>tau</code> is a vector or <code>NULL</code> (and <code>W = NULL</code>), <code>PV</code> has an attribute <code>"opt.tau"</code>,  which is a matrix and <code>opt.tau[i,b]</code> is the best <code>tau</code> for observation <code>NewX[i,]</code> and class <code>b</code> (see section 'Details'). <code>opt.tau[i,b]</code> is used to compute the p-value for observation <code>NewX[i,]</code> and class <code>b</code>.
</p>


<h3>Author(s)</h3>

<p>Niki Zumbrunnen <a href="mailto:niki.zumbrunnen@gmail.com">niki.zumbrunnen@gmail.com</a> <br>
Lutz Dümbgen <a href="mailto:lutz.duembgen@stat.unibe.ch">lutz.duembgen@stat.unibe.ch</a> <br><a href="www.imsv.unibe.ch/duembgen/index_ger.html">www.imsv.unibe.ch/duembgen/index_ger.html</a>
</p>


<h3>References</h3>

<p>Zumbrunnen N. and Dümbgen L. (2017)
pvclass: An R Package for p Values for Classification.
<em>Journal of Statistical Software <b>78(4)</b></em>, 1–19.
doi:10.18637/jss.v078.i04
</p>
<p>Dümbgen L., Igl B.-W. and Munk A. (2008)
P-Values for Classification.
<em>Electronic Journal of Statistics <b>2</b></em>, 468–493, available at <a href="http://dx.doi.org/10.1214/08-EJS245">http://dx.doi.org/10.1214/08-EJS245</a>.
</p>
<p>Zumbrunnen N. (2014)
P-Values for Classification – Computational Aspects and Asymptotics.
Ph.D. thesis, University of Bern, available at <a href="http://boris.unibe.ch/id/eprint/53585">http://boris.unibe.ch/id/eprint/53585</a>.
</p>


<h3>See Also</h3>

 
<p><code> pvs, pvs.gaussian, pvs.knn, pvs.logreg</code>
</p>


<h3>Examples</h3>

<pre><code class="language-R">X &lt;- iris[c(1:49, 51:99, 101:149), 1:4]
Y &lt;- iris[c(1:49, 51:99, 101:149), 5]
NewX &lt;- iris[c(50, 100, 150), 1:4]

pvs.wnn(NewX, X, Y, wtype = 'l', tau = 0.5)
</code></pre>


</div>