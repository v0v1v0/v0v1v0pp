<div class="container">

<table style="width: 100%;"><tr>
<td>LiMcLeod</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>The Modified Multivariate Portmanteau Test, Li-McLeod (1981)</h2>

<h3>Description</h3>

<p>The modified multivariate portmanteau test suggested by Li and McLeod (1981).
</p>


<h3>Usage</h3>

<pre><code class="language-R">LiMcLeod(obj,lags=seq(5,30,5),fitdf=0,sqrd.res=FALSE)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>obj</code></td>
<td>
<p>a univariate or multivariate series with class <code>"numeric"</code>, <code>"matrix"</code>, 
<code>"ts"</code>, or <code>("mts" "ts")</code>.
It can be also an object of fitted time-series model with class <code>"ar"</code>, 
<code>"arima0"</code>, <code>"Arima"</code>, <code>("ARIMA forecast ARIMA Arima")</code>, <code>"lm"</code>,
<code>("glm" "lm")</code>, or <code>"varest"</code>. 
<code>obj</code> may also an object with class <code>"list"</code> (see details and following examples).</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>lags</code></td>
<td>
<p>vector of lag auto-cross correlation coefficients used for <code>Hosking</code> test.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>fitdf</code></td>
<td>
<p>Default is zero for testing the randomness of a given sequence with 
class <code>"numeric"</code>, <code>"matrix"</code>, <code>"ts"</code>, or <code>("mts" "ts")</code>. 
In general <code>fitdf</code> equals to the number of estimated parameters in the fitted model.
If <code>obj</code> is an object with class <code>"ar"</code>, <code>"arima0"</code>, <code>"Arima"</code>, 
<code>"varest"</code>, <code>("ARIMA forecast ARIMA Arima")</code>, or <code>"list"</code> then no need to enter 
the value of <code>fitdf</code> as it will be automatically determined.
For <code>obj</code> with other classes, the <code>fitdf</code> is needed for degrees 
of freedom of asymptotic chi-square distribution.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>sqrd.res</code></td>
<td>
<p>if <code>TRUE</code> then apply the test on the squared values. 
This checks for Autoregressive Conditional Heteroscedastic, 
<code>ARCH</code>, effects. 
When <code>sqrd.res = FALSE</code>, then apply the test on the usual residuals. </p>
</td>
</tr>
</table>
<h3>Details</h3>

<p>However the portmanteau test statistic can be applied directly on the output objects from 
the built in <code>R</code> functions <code>ar()</code>, <code>ar.ols()</code>, <code>ar.burg()</code>, 
<code>ar.yw()</code>, <code>ar.mle()</code>, <code>arima()</code>, <code>arim0()</code>, <code>Arima()</code>,
<code>auto.arima()</code>, <code>lm()</code>, <code>glm()</code>, and <code>VAR()</code>, 
it works with output objects from any fitted model. 
In this case, users should write their own function to fit any model they want, where they 
may use the built in <code>R</code> functions <code>garch()</code>, <code>garchFit()</code>, 
<code>fracdiff()</code>, <code>tar()</code>, etc.
The object <code>obj</code> represents the output of this function. 
This output must be a list with at least two outcomes: 
the fitted residual and the fitdf of the fitted model (<code>list(res = ..., fitdf = ...)</code>). 
See the following example with the function <code>FitModel()</code>.
</p>


<h3>Value</h3>

<p>The multivariate test statistic suggested by Li and McLeod (1981) and its corresponding p-values 
for different lags based on the asymptotic chi-square distribution with <code>k^2(lags-fitdf)</code> degrees of freedom.
</p>


<h3>Author(s)</h3>

<p> Esam Mahdi and A.I. McLeod.</p>


<h3>References</h3>

<p>Li, W. K. and McLeod, A. I. (1981). "Distribution of The Residual Autocorrelations in 
Multivariate ARMA Time Series Models". Journal of The Royal Statistical Society, Series B, 43, 231-239.
</p>


<h3>See Also</h3>

<p><code>Box.test</code>, <code>BoxPierce</code>, <code>LjungBox</code>, <code>MahdiMcLeod</code>, 
<code>Hosking</code>, <code>portest</code>, <code>GetResiduals</code>.
</p>


<h3>Examples</h3>

<pre><code class="language-R">x &lt;- rnorm(100)
LiMcLeod(x)                              ## univariate test
x &lt;- cbind(rnorm(100),rnorm(100))
LiMcLeod(x)                              ## multivariate test 
##
##
## Monthly log stock returns of Intel corporation data: Test for ARCH Effects 
monthintel &lt;- as.ts(monthintel)
LjungBox(monthintel)                         ## Usual test 
LjungBox(monthintel,sqrd.res=TRUE)  ## Test for ARCH effects 
##
##
## Quarterly, west German investment, income, and consumption from 1960 Q1 to 1982 Q4 
data(WestGerman)
DiffData &lt;- matrix(numeric(3 * 91), ncol = 3)
  for (i in 1:3) 
    DiffData[, i] &lt;- diff(log(WestGerman[, i]), lag = 1)
fit &lt;- ar.ols(DiffData, intercept = TRUE, order.max = 2)
lags &lt;- c(5,10)
## Apply the test statistic on the fitted model (fitdf will be automatically applied)
LiMcLeod(fit,lags,fitdf = 2)                          ## Correct (no need to specify fitdf)
LiMcLeod(fit,lags)                                    ## Correct
## Apply the test statistic on the residuals
res &lt;- ts((fit$resid)[-(1:2), ])
LiMcLeod(res,lags,fitdf = 2)                          ## Correct
LiMcLeod(res,lags)                                    ## Wrong (fitdf is needed!)  
##
##
## Write a function to fit a model: Apply portmanteau test on fitted obj with class "list"
FitModel &lt;- function(data){
    fit &lt;- ar.ols(data, intercept = TRUE, order.max = 2)
    fitdf &lt;- 2
    res &lt;- res &lt;- ts((fit$resid)[-(1:2), ]) 
 list(res=res,fitdf=fitdf)
}
data(WestGerman)
DiffData &lt;- matrix(numeric(3 * 91), ncol = 3)
  for (i in 1:3) 
    DiffData[, i] &lt;- diff(log(WestGerman[, i]), lag = 1)
Fit &lt;- FitModel(DiffData)
LiMcLeod(Fit) 
</code></pre>


</div>