<div class="container">

<table style="width: 100%;"><tr>
<td>bal.cs.psa</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>Balance for Categorical Covariate: Random Strata as part of a PSA</h2>

<h3>Description</h3>

<p>Function provides a measure of the balance achieved between control and
treatment groups for a categorical covariate from user defined strata. This
statistic is compared to the same measure for randomly permuted strata.
</p>


<h3>Usage</h3>

<pre><code class="language-R">bal.cs.psa(
  categorical,
  treatment = NULL,
  strata = NULL,
  B = 1000,
  eps = 0.02,
  main = NULL,
  ...
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>categorical</code></td>
<td>
<p>Categorical covariate that is being balanced within
strata in a PSA. If <code>categorical</code> has three columns, then the second
and third are assumed to be the treatment and strata respectively.  Missing
values are not allowed. May be factor or numeric.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>treatment</code></td>
<td>
<p>Binary variable of same length as <code>categorical</code>;
generally 0 for 'control,' 1 for 'treatment.'</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>strata</code></td>
<td>
<p>Integer variable; a vector of same length as
<code>categorical</code> indicating the derived strata from estimated propensity
scores.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>B</code></td>
<td>
<p>Numeric; number of randomly generated iterations of the balance
measure are created for the comparison distribution.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>eps</code></td>
<td>
<p>Numeric; ensures that weighting is reasonable for small
categories.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>main</code></td>
<td>
<p>Title passed to <code>histogram</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>...</code></td>
<td>
<p>Other graphical parameters passed to <code>histogram</code>.</p>
</td>
</tr>
</table>
<h3>Details</h3>

<p>This function measures the balance achieved across K strata for a
categorical covariate with J categories.  If <code class="reqn">p_{ijk}</code> is the proportion
of cases in stratum k, category j, and treatment i, then the statistic is
the sum over all K, J of <code class="reqn"> |\sqrt{p_{0jk} + \epsilon} - \sqrt{p_{1jk} +
\epsilon } | </code>.  A permutation distribution is generated by randomly
assigning cases to strata, thus generating B permuted stratifications and
the associated B permutation statistics.  The permutation stratifications
are generated under a fixed marginals model to retain comparability with the
original stratification.  A histogram of the permutation statistics is
produced with the original statistic referenced as a red dot.
</p>


<h3>Value</h3>

<p>In addition to the histogram, a list with the following components
is returned: </p>
<table>
<tr style="vertical-align: top;">
<td><code>balance.orig </code></td>
<td>
<p>Balance measure of user defined strata.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>rank.orig</code></td>
<td>
<p>Rank of original balance measure in comparison with the B
randomly generated values.</p>
</td>
</tr>
</table>
<h3>Author(s)</h3>

<p>James E. Helmreich <a href="mailto:James.Helmreich@Marist.edu">James.Helmreich@Marist.edu</a>
</p>
<p>Robert M. Pruzek <a href="mailto:RMPruzek@yahoo.com">RMPruzek@yahoo.com</a>
</p>


<h3>See Also</h3>

<p><code>bal.cws.psa</code>, <code>bal.ms.psa</code>, <code>bal.ks.psa</code>
</p>


<h3>Examples</h3>

<pre><code class="language-R">#Everything random
categorical&lt;-sample(4,1000,replace=TRUE)
treatment&lt;-sample(c(0,1),1000,replace=TRUE)
strata&lt;-sample(5,1000,replace=TRUE)
bal.cs.psa(categorical,treatment,strata)

#Perfect balance on 80%, random on last 20%
categorical&lt;-rep(sample(5,1000,replace=TRUE),2)
treatment&lt;-c(rep(0,1000),rep(1,1000))
strat&lt;-sample(6,1200,replace=TRUE)
strat&lt;-c(strat[1:1000],strat[1:800],strat[1001:1200])
bal.cs.psa(categorical,treatment,strat,B=200)


</code></pre>


</div>