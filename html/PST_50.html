<div class="container">

<table style="width: 100%;"><tr>
<td>tune</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>
AIC, AICc or BIC based model selection 
</h2>

<h3>Description</h3>

<p>Prune a probabilistic suffix tree with a series of cut-offs and select the model having the lowest value of the selected information criterion. Available information criterion are Akaike information criterion (AIC), AIC with a correction for finite sample sizes (AICc) and Bayesian information criterion (BIC).
</p>


<h3>Usage</h3>

<pre><code class="language-R">## S4 method for signature 'PSTf'
tune(object, gain="G2", C, criterion = "AIC", output = "PST")
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>object</code></td>
<td>

<p>a probabilistic suffix tree, i.e., an object of class <code>"PSTf"</code> as returned by the <code>pstree</code>, <code>prune</code> or <code>tune</code> function.
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>gain</code></td>
<td>
 
<p>character. The gain function used for pruning decisions. See <code>prune</code> for details.
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>C</code></td>
<td>
 
<p>numeric. A vector of cutoff values. See <code>prune</code> for details.
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>criterion</code></td>
<td>

<p>The criterion used to select the model, either AIC, AICc or BIC. AICc should be used when the ratio between the number of observations and the number of estimated parameters is low, which is often the case with VLMC models. <cite>Burnham et al 2004</cite> suggest to use AICc instead of AIC when the ratio is lower than 40.
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>output</code></td>
<td>

<p>If <code>output='PST'</code> the PST (an object of class <code>"PSTr"</code>) having the lowest AIC, AICc or BIC value. If <code>output='stats'</code>, a table with the statistics for each model obtained by pruning <code>object</code> with the cut-offs in <code>C</code>. 
</p>
</td>
</tr>
</table>
<h3>Details</h3>

<p>The <code>tune</code> function selects among a series of PST pruned with different values of the <code class="reqn">C</code> cutoff the model having the lowest <code class="reqn">AIC</code> or <code class="reqn">AIC_{c}</code> value. The function can return either the selected PST or a data frame containing the statistics for each model. For more details, see <cite>Gabadinho 2016</cite>.
</p>


<h3>Value</h3>

<p>If <code>output="PST"</code> a PST that is an object of class <code>PSTf</code>. If <code>output="stats"</code> a matrix with the results of the tuning procedure.<br> 
The selected model is tagged with <code>***</code>, while models with <code class="reqn">IC &lt; min(IC)+2</code> are tagged with <code>**</code>, and models with <code class="reqn">IC &lt; min(IC)+10</code> are tagged with <code>**</code>.
</p>


<h3>Author(s)</h3>

<p>Alexis Gabadinho
</p>


<h3>References</h3>

<p>Burnham, K. P. &amp; Anderson, D. R. (2004). Multimodel Inference <em>Sociological Methods &amp; Research</em>, 33, pp. 261-304.
</p>
<p>Gabadinho, A. &amp; Ritschard, G. (2016). Analyzing State Sequences with Probabilistic Suffix Trees: The PST R Package. <em>Journal of Statistical Software</em>, <b>72</b>(3), pp. 1-39.
</p>


<h3>See Also</h3>

<p><code>prune</code>
</p>


<h3>Examples</h3>

<pre><code class="language-R">## activity calendar for year 2000
## from the Swiss Household Panel
## see ?actcal
data(actcal)

## selecting individuals aged 20 to 59
actcal &lt;- actcal[actcal$age00&gt;=20 &amp; actcal$age00 &lt;60,]

## defining a sequence object
actcal.lab &lt;- c("&gt; 37 hours", "19-36 hours", "1-18 hours", "no work")
actcal.seq &lt;- seqdef(actcal,13:24,labels=actcal.lab)

## building a PST
actcal.pst &lt;- pstree(actcal.seq, nmin=2, ymin=0.001)

## Cut-offs for 5% and 1% (see ?prune)
C95 &lt;- qchisq(0.95,4-1)/2
C99 &lt;- qchisq(0.99,4-1)/2

## selecting the optimal PST using AIC criterion
actcal.pst.opt &lt;- tune(actcal.pst, gain="G2", C=c(C95,C99))

## plotting the tree
plot(actcal.pst.opt)
</code></pre>


</div>