<div class="container">

<table style="width: 100%;"><tr>
<td>correlatedBgEffects</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>Simulate correlated background effects.</h2>

<h3>Description</h3>

<p>correlatedBgEffects computes a background effect that simulates structured 
correlation between the phenotypes.
</p>


<h3>Usage</h3>

<pre><code class="language-R">correlatedBgEffects(
  N,
  P,
  pcorr = NULL,
  corr_mat = NULL,
  sampleID = "ID_",
  phenoID = "Trait_",
  id_samples = NULL,
  id_phenos = NULL,
  verbose = FALSE
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>N</code></td>
<td>
<p>Number [integer] of samples to simulate.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>P</code></td>
<td>
<p>Number [integer] of phenotypes to simulate.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>pcorr</code></td>
<td>
<p>Initial strength of correlation [double] between neighbouring 
traits. Decreases by pcorr^(distance); distance from 0 to P-1. See details.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>corr_mat</code></td>
<td>
<p>[P x P] correlation matrix [double] as covariance 
component for the multivariate normal distribution. If not provided, pcorr is
used to construct the correlation matrix.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>sampleID</code></td>
<td>
<p>Prefix [string] for naming samples.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>phenoID</code></td>
<td>
<p>Prefix [string] for naming traits.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>id_samples</code></td>
<td>
<p>Vector of [NrSamples] sample IDs [string]; if not provided
constructed by paste(sampleID, 1:N, sep="").</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>id_phenos</code></td>
<td>
<p>Vector of [NrTraits] phenotype IDs [string]; if not provided
constructed by paste(phenoID, 1:P, sep="").</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>verbose</code></td>
<td>
<p>[boolean] If TRUE, progress info is printed to standard out.</p>
</td>
</tr>
</table>
<h3>Details</h3>

<p>correlatedBgEffects can be used to simulate phenotypes with a 
defined level of correlation between traits. If the corr_mat is not provided,
a simple correlation structure based on the distance of the traits will be 
constructed. Traits of distance d=1 (adjacent columns) will have correlation 
cor=<code class="reqn">pcorr^1</code>, traits with d=2 have cor=<code class="reqn">pcorr^2</code> 
up to traits with d=(P-1) cor=<code class="reqn">pcorr^{(P-1)}</code> and 
0 &lt; pcorr &lt; 1. The correlated background effect correlated is simulated based 
on this correlation structure C: 
<code class="reqn">correlated ~ N_{NP}(0,C)</code>.
</p>


<h3>Value</h3>

<p>Named list with [N x P] matrix of correlated background effects (
correlatedBg) and the correlation matrix (cov_correlated). If corr_mat 
provided corr_mat == cov_correlated.
</p>


<h3>See Also</h3>

<p><code>rmvnorm</code> which is used to simulate the 
multivariate normal distribution
</p>


<h3>Examples</h3>

<pre><code class="language-R">correlatedBg &lt;- correlatedBgEffects(N=100, P=20, pcorr=0.4)
</code></pre>


</div>