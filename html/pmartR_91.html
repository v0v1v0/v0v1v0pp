<div class="container">

<table style="width: 100%;"><tr>
<td>normalize_nmr</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>Normalize an Object of Class nmrData</h2>

<h3>Description</h3>

<p>The data is normalized either to a spiked-in metabolite or to a
sample-specific property
</p>


<h3>Usage</h3>

<pre><code class="language-R">normalize_nmr(
  omicsData,
  apply_norm = FALSE,
  backtransform = FALSE,
  metabolite_name = NULL,
  sample_property_cname = NULL
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>omicsData</code></td>
<td>
<p>an object of the class 'nmrData'</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>apply_norm</code></td>
<td>
<p>logical, indicates whether normalization should be applied
to omicsData$e_data. Defaults to FALSE. If TRUE, the normalization is
applied to the data and an S3 object of the same class as <code>omicsData</code>
(e.g. 'nmrData') with normalized values in <code>e_data</code> is returned. If
FALSE, the normalization is not applied and an S3 object of the class
<code>nmrnormRes</code> is returned, allowing some exploratory data analysis
prior to subsequently applying the normalization.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>backtransform</code></td>
<td>
<p>logical argument indicating if parameters for back
transforming the data, after normalization, should be calculated. Defaults
to FALSE. If TRUE, the parameters for back transforming the data after
normalization will be calculated, and subsequently included in the data
normalization if <code>apply_norm</code> is TRUE. See details for an explanation 
of how these factors are calculated.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>metabolite_name</code></td>
<td>
<p>optional character string specifying the name of the
(spiked in) metabolite in <code>e_data</code> to use for instrument normalization
of the nmrData object. These values will be used to divide the raw
abundance of the corresponding sample in e_data (if e_data is log
transformed, this function accounts for that and returns normalized data on
the same scale it was provided). If using this argument, the
'sample_property_cname' argument should not be specified.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>sample_property_cname</code></td>
<td>
<p>optional character string specifying the name of
the column in f_data containing information to use for instrument
normalization of the nmrData object, such as a concentration. These values
will be used to divide the raw abundance of the corresponding sample in
e_data (if e_data is log transformed, this function accounts for that by
temporarily un-log transforming the data and then returning normalized data
on the same scale it was provided). If using this argument, the
'metabolite_name' argument should not be specified.</p>
</td>
</tr>
</table>
<h3>Details</h3>

<p>There are two ways to specify the information needed for
performing instrument normalization on an nmrData object: </p>
 <ol>
<li>
<p>specify <code>metabolite_name</code>. This should be used when normalization to a
spiked in standard is desired. Here <code>metabolite_name</code> gives the name of
the metabolite in e_data (and e_meta, if present) corresponding to the spiked
in standard. If any samples have a missing value for this metabolite, an
error is returned. </p>
</li>
<li>
<p> specify <code>sample_property_cname</code>. This should be
used when normalizing to a sample property, such as concentration, is
desired. Here, <code>sample_property_cname</code> gives the name of the column in
<code>f_data</code> which contains the property to use for normalization. If any
samples have a missing value for this column, and error is returned.</p>
</li>
</ol>
<h3>Value</h3>

<p>If <code>apply_norm</code> is TRUE, an object of class 'nmrData', normalized
and with information about the normalization process in 'nmr_info'.  Otherwise,
an object of class 'nmrnormRes' is returned, with the same info about
normalization in attribute 'nmr_info' to be passed to plotting and summary functions.
</p>


<h3>Backtransform</h3>

<p>The purpose of back transforming data is to ensure
values are on a scale similar to their raw values before normalization. The
following values are calculated and/or applied for backtransformation
purposes: </p>

<table>
<tr>
<td style="text-align: left;"> If normalization using a metabolite in
<code>e_data</code> is specified </td>
<td style="text-align: left;"> location parameter is the median of the
values for <code>metabolite_name</code> </td>
</tr>
<tr>
<td style="text-align: left;"> </td>
<td style="text-align: left;"> </td>
</tr>
<tr>
<td style="text-align: left;"> If normalization using a
sample property in <code>f_data</code> is specified </td>
<td style="text-align: left;"> location parameter is
the median of the values in <code>sample_property</code> </td>
</tr>
<tr>
<td style="text-align: left;"> </td>
</tr>
</table>
<p> See examples below.
</p>


<h3>Examples</h3>

<pre><code class="language-R">
library(pmartRdata)

# Normalize using a metabolite (this is merely an example of how to use this specification;
# the metabolite used was not actually spiked-in for the purpose of normalization)
mynmr &lt;- edata_transform(
  omicsData = nmr_identified_object,
  data_scale = "log2"
)
nmr_norm &lt;- normalize_nmr(
  omicsData = mynmr, apply_norm = TRUE,
  metabolite_name = "unkm1.53",
  backtransform = TRUE
)

# Normalization using a sample property
mynmr &lt;- edata_transform(
  omicsData = nmr_identified_object,
  data_scale = "log2"
)
nmr_norm &lt;- normalize_nmr(
  omicsData = mynmr, apply_norm = TRUE,
  sample_property_cname = "Concentration",
  backtransform = TRUE
)

</code></pre>


</div>