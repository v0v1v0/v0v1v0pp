<div class="container">

<table style="width: 100%;"><tr>
<td>haploFreq</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>Haplotype Frequencies With a Covariate</h2>

<h3>Description</h3>

<p>This utility function extracts the absolute frequencies of haplotypes
with respect to a categorical variable (a factor). The output is
useful when ploting haplotype networks.
</p>


<h3>Usage</h3>

<pre><code class="language-R">haploFreq(x, fac, split = "_", what = 2, haplo = NULL)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>x</code></td>
<td>
<p>a set of DNA sequences (as an object of class
<code>"DNAbin"</code>).</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>fac</code></td>
<td>
<p>a factor giving the categorical variable (can be missing).</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>split</code></td>
<td>
<p>a single character (see details).</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>what</code></td>
<td>
<p>a single integer (see details).</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>haplo</code></td>
<td>
<p>an object of class <code>"haplotype"</code>.</p>
</td>
</tr>
</table>
<h3>Details</h3>

<p>The frequencies of each haplotype in <code>x</code> are counted with respect
to a factor which is either specified with <code>fac</code>, or extracted
from the labels of <code>x</code>. In the second case, these labels are
split with respect to the character specified in <code>split</code> and the
<code>what</code>'th substrings are extracted and taken as the categorical
variable (see example).
</p>
<p>If <code>haplo</code> is specified, the haplotype frequencies are taken from
it, otherwise they are calculated from <code>x</code>.
</p>


<h3>Value</h3>

<p>a matrix of counts.
</p>


<h3>Author(s)</h3>

<p>Klaus Schliep and Emmanuel Paradis</p>


<h3>See Also</h3>

<p><code>haplotype</code>, <code>haploNet</code>
</p>


<h3>Examples</h3>

<pre><code class="language-R">## generate some artificial data from 'woodmouse':
data(woodmouse)
x &lt;- woodmouse[sample(15, size = 50, replace = TRUE), ]
## labels IdXXX_PopXXX_LocXXX
rownames(x) &lt;- paste("Id", 1:50, "_Pop", 1:2, "_Loc", 1:5, sep = "")
head(labels(x))
h &lt;- haplotype(x)
## frequencies of haplotypes wrt 'Pop':
f.pop &lt;- haploFreq(x, haplo = h)
## frequencies of haplotypes wrt 'Loc':
f.loc &lt;- haploFreq(x, what = 3, haplo = h)
nt &lt;- haploNet(h)
fq &lt;- attr(nt, "freq")
op &lt;- par(mfcol = c(1, 2))
plot(nt, size = fq, pie = f.pop, labels = FALSE)
plot(nt, size = fq, pie = f.loc, labels = FALSE)
par(op)
</code></pre>


</div>