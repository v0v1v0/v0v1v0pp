<div class="container">

<table style="width: 100%;"><tr>
<td>fitPoD</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>PoD curve: fitting function</h2>

<h3>Description</h3>

<p>Function calculates the root mean squared error (RMSE) between provided PoD values and calculated PoD values. The latter are calculated using for provided titers and provided PoD curve parameters.
</p>
<p>By using the input titers <code>PoDParamPointEstimation</code> function and median of the estimated set of PoD curve parameters (output of <code>PoDParamEstimation</code> function), the point estimate of PoD curve can be obtained (for details see <code>PoDParamPointEstimation</code> function).
</p>


<h3>Usage</h3>

<pre><code class="language-R">fitPoD(params, TitersInput, CurveTitersMedian)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>params</code></td>
<td>
<p>named data frame ("pmax", "slope", "et50"): provided PoD curve parameters</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>TitersInput</code></td>
<td>
<p>numeric vector: provided titers</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>CurveTitersMedian</code></td>
<td>
<p>numeric vector: provided PoD values</p>
</td>
</tr>
</table>
<h3>Details</h3>

<p style="text-align: center;"><code class="reqn">RMSE = \sqrt{\frac{\sum_{i}^{N} (PoD_{median}(titers) - PoD_{optimized}(titers))^2}{N}}</code>
</p>



<h3>Value</h3>

<p>negative RMSE
</p>


<h3>Examples</h3>

<pre><code class="language-R">## Data preparation
data(estimatedParameters)
data(PoDParams)

## Example 1

# grid of titers
TitersInput &lt;- seq(from = 0, to = 20, by = 0.01)

# for each estimated PoD curve calculate functional values
functionValues &lt;- 
  matrix(NA, 
         nrow = nrow(estimatedParameters$resultsPriorReset), 
         ncol = length(TitersInput))

for (i in 1:nrow(estimatedParameters$resultsPriorReset)) { 
  functionValues[i,] &lt;- PoD(TitersInput,
  pmax = estimatedParameters$resultsPriorReset[i,1], 
  et50 = estimatedParameters$resultsPriorReset[i,3], 
  slope = estimatedParameters$resultsPriorReset[i,2], adjustTiters = FALSE)
}

# functional values corresponding to the median of the estimated PoD curve parameters
CurveTitersMedian &lt;- apply(functionValues, 2, median)

# squared error of CurveTitersMedian and functional values of "params" curve
fitPoD(PoDParams, TitersInput, CurveTitersMedian)

</code></pre>


</div>