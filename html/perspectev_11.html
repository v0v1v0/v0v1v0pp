<div class="container">

<table style="width: 100%;"><tr>
<td>perspectev.simulate</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>
Simulate upper/lower level selection at different intensities and observe resulting p values.
</h2>

<h3>Description</h3>

<p>Perform simulations of natural selection on a data set, and observe what p values result. Performs linear transformation of trait vs. survivorship (using provided or fitted slope and intercept) and then transforms into survviorship probabilites using inv.logit function.
</p>


<h3>Usage</h3>

<pre><code class="language-R">perspectev.simulate(data,simulations,cores,traitfun=mcpRange,vlist=NULL,
	binary=NA,intercept=NA,slope=NA,level=NA,noise=0,fit=FALSE,quiet=FALSE)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>data</code></td>
<td>

<p>Dataframe in perspectev format. See ?perspectev.read for more information.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>simulations</code></td>
<td>

<p>Number of simulations to perform. At least 1000 is recommended but can be slow.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>cores</code></td>
<td>

<p>Number of cores over which to parallelize the simulations.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>traitfun</code></td>
<td>

<p>Function for calculating trait value at each level.
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>vlist</code></td>
<td>

<p>Optional variable list for trait function.
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>intercept</code></td>
<td>

<p>Intercept of the regression between range and survivorship. Can be manually provided or, if not provided, is fit to the data set. Will attempt to set automatically if unspecified.
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>slope</code></td>
<td>

<p>Slope of the regression between range and survivorship. Can be manually provided or, if not provided, is fit to the data set. Will attempt to set automatically if unspecified.
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>level</code></td>
<td>

<p>Simulate either upper or lower level selection. Accepts either "lower" or "upper" respectively. Will set to 'upper' if unspecified.
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>noise</code></td>
<td>

<p>Extra stochasticity to the simulation. 
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>fit</code></td>
<td>

<p>Fit simulation to observed parameters? Will do automatically if intercept or slope are not specified.
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>binary</code></td>
<td>

<p>Is survivorship binary or continuous? Will attempt to set automatically if unspecified.
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>quiet</code></td>
<td>

<p>Suppress information messages?
</p>
</td>
</tr>
</table>
<h3>Value</h3>

<table>
<tr style="vertical-align: top;">
<td><code>correlation_simulated</code></td>
<td>
<p>Correlation between trait and surivovorship from permuted groups at each simulation.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>correlation_observed</code></td>
<td>
<p>Observed correlation between trait and surivovorship from simulated groups.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>pvalue</code></td>
<td>
<p>p value observed under simulation of selection.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>level</code></td>
<td>
<p>Level of simulated selection.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>intercept</code></td>
<td>
<p>Intercept of simulation.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>slope</code></td>
<td>
<p>Slope of the simulation.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>noise</code></td>
<td>
<p>Noise level selected for simulation.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>fitted_model</code></td>
<td>
<p>Was the model fitted to the data set?</p>
</td>
</tr>
</table>
<h3>Note</h3>

<p>See original publication and tutorial for more information on simulation.
</p>


<h3>Author(s)</h3>

<p>Kenneth B. Hoehn &lt;perspectev@gmail.com&gt;
</p>


</div>