<div class="container">

<table style="width: 100%;"><tr>
<td>pdr_optimize</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>Optimize production and consumption parameters for pool dilution data</h2>

<h3>Description</h3>

<p>Optimize production and consumption parameters for pool dilution data
</p>


<h3>Usage</h3>

<pre><code class="language-R">pdr_optimize(
  time,
  m,
  n,
  m_prec,
  ap_prec,
  P,
  k,
  params_to_optimize = c("P", "k"),
  pool = "CH4",
  frac_P = NULL,
  frac_k = NULL,
  other_params = list(),
  cost_fn = pdr_cost,
  prediction_fn = pdr_predict,
  include_progress = FALSE,
  quiet = FALSE
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>time</code></td>
<td>
<p>Vector of numeric time values (e.g. days); first should be zero</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>m</code></td>
<td>
<p>Observed total pool size (as a volume), same length as time</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>n</code></td>
<td>
<p>Observed heavy isotope (as a volume), same length as time</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>m_prec</code></td>
<td>
<p>Instrument precision for pool size, expressed as a standard deviation</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>ap_prec</code></td>
<td>
<p>Instrument precision for atom percent, expressed as a standard deviation</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>P</code></td>
<td>
<p>production rate, unit gas/unit time</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>k</code></td>
<td>
<p>first-order rate constant for consumption, 1/unit time</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>params_to_optimize</code></td>
<td>
<p>Named vector of parameters ("P", "k", "frac_P",
and/or "frac_k") to optimize against observations</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>pool</code></td>
<td>
<p>Name of pool to use when looking up fractionation values if they
are not supplied; see <code>pdr_fractionation</code></p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>frac_P</code></td>
<td>
<p>Fractionation value for production; see <code>pdr_fractionation</code></p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>frac_k</code></td>
<td>
<p>Fractionation value for consumption; see <code>pdr_fractionation</code></p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>other_params</code></td>
<td>
<p>Other parameters pass on to <code>optim</code></p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>cost_fn</code></td>
<td>
<p>Cost function to use; the default is <code>pdr_cost</code></p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>prediction_fn</code></td>
<td>
<p>Prediction function that the cost function will use;
the default is <code>pdr_predict</code></p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>include_progress</code></td>
<td>
<p>Include detailed optimizer progress data in output?</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>quiet</code></td>
<td>
<p>Suppress output messages, logical</p>
</td>
</tr>
</table>
<h3>Value</h3>

<p>The output of <code>optim</code>.
</p>


<h3>Note</h3>

<p>Currently there is only one set of fractionation values available in
<code>pdr_fractionation</code>, from von Fischer and Hedin
(2002, 10.1029/2001GB001448).
</p>


<h3>See Also</h3>

<p><code>pdr_optimize_df</code>
</p>


<h3>Examples</h3>

<pre><code class="language-R">tm &lt;- 0:5
m &lt;- c(10, 8, 6, 5, 4, 3)
n &lt;- c(1, 0.7, 0.6, 0.4, 0.3, 0.2)
m_prec &lt;- 0.001
ap_prec &lt;- 0.01

# Optimize values for P (production) and k (consumption), provide starting values for P and k
pdr_optimize(time = tm, m, n, m_prec, ap_prec, P = 0.5, k = 0.3)
# If we don't provide a value for k, it can be estimated from the data
pdr_optimize(tm, m, n, m_prec, ap_prec, P = 0.5)
# Hold k and frac_k constant (ie., k = estimated k0, frac_k = default value), optimize P and frac_P
pdr_optimize(tm, m, n, m_prec, ap_prec, P = 0.5, params_to_optimize = c("P", "frac_P"))
# Optimize only k (provide P and exclude from params_to_optimize)
pdr_optimize(tm, m, n, m_prec, ap_prec, P = 0.5, params_to_optimize = "k")
# Optimize only k, bounding its possible values
op &lt;- list(lower = c("k" = 0.2), upper = c("k" = 0.3))
pdr_optimize(tm, m, n, m_prec, ap_prec, 0.5, 0.27, params_to_optimize = "k", other_params = op)
</code></pre>


</div>