<div class="container">

<table style="width: 100%;"><tr>
<td>shirleyWilliamsTest</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>Shirley-Williams Test</h2>

<h3>Description</h3>

<p>Performs Shirley's nonparametric equivalent of William's test
for contrasting increasing dose levels of a treatment.
</p>


<h3>Usage</h3>

<pre><code class="language-R">shirleyWilliamsTest(x, ...)

## Default S3 method:
shirleyWilliamsTest(
  x,
  g,
  alternative = c("two.sided", "greater", "less"),
  method = c("look-up", "boot"),
  nperm = 10000,
  ...
)

## S3 method for class 'formula'
shirleyWilliamsTest(
  formula,
  data,
  subset,
  na.action,
  alternative = c("two.sided", "greater", "less"),
  method = c("look-up", "boot"),
  nperm = 10000,
  ...
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>x</code></td>
<td>
<p>a numeric vector of data values, or a list of numeric data
vectors.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>...</code></td>
<td>
<p>further arguments to be passed to or from methods.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>g</code></td>
<td>
<p>a vector or factor object giving the group for the
corresponding elements of <code>"x"</code>.
Ignored with a warning if <code>"x"</code> is a list.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>alternative</code></td>
<td>
<p>the alternative hypothesis. Defaults to <code>two.sided</code></p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>method</code></td>
<td>
<p>a character string specifying the test statistic to use.
Defaults to <code>"look-up"</code> that uses published Table values of Williams (1972).</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>nperm</code></td>
<td>
<p>number of permutations for the asymptotic permutation test.
Defaults to <code>1000</code>. Ignored, if <code>method = "look-up"</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>formula</code></td>
<td>
<p>a formula of the form <code>response ~ group</code> where
<code>response</code> gives the data values and <code>group</code> a vector or
factor of the corresponding groups.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>data</code></td>
<td>
<p>an optional matrix or data frame (or similar: see
<code>model.frame</code>) containing the variables in the
formula <code>formula</code>.  By default the variables are taken from
<code>environment(formula)</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>subset</code></td>
<td>
<p>an optional vector specifying a
subset of observations to be used.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>na.action</code></td>
<td>
<p>a function which indicates what should happen when
the data contain <code>NA</code>s.  Defaults to <code>getOption("na.action")</code>.</p>
</td>
</tr>
</table>
<h3>Details</h3>

<p>The Shirley-William test is a non-parametric step-down trend test for testing several treatment levels
with a zero control. Let there be <code class="reqn">k</code> groups including the control and let
the zero dose level be indicated with <code class="reqn">i = 0</code> and the highest
dose level with <code class="reqn">i = m</code>, then the following <code>m = k - 1</code> hypotheses are tested:
</p>
<p style="text-align: center;"><code class="reqn">
\begin{array}{ll}
\mathrm{H}_{m}: \theta_0 = \theta_1 = \ldots = \theta_m, &amp; \mathrm{A}_{m} = \theta_0 \le \theta_1 \le \ldots \theta_m, \theta_0 &lt; \theta_m \\
\mathrm{H}_{m-1}: \theta_0 = \theta_1 = \ldots = \theta_{m-1}, &amp; \mathrm{A}_{m-1} = \theta_0 \le \theta_1 \le \ldots \theta_{m-1}, \theta_0 &lt; \theta_{m-1} \\
\vdots &amp; \vdots \\
\mathrm{H}_{1}: \theta_0 = \theta_1, &amp; \mathrm{A}_{1} = \theta_0 &lt; \theta_1\\
\end{array}
</code>
</p>

<p>Let <code class="reqn">R_{ij}</code> be the rank of <code class="reqn">X_{ij}</code>,
where <code class="reqn">X_{ij}</code> is jointly ranked
from <code class="reqn">\left\{1, 2, \ldots, N \right\}, ~~ N = \sum_{i=1}^k n_i</code>,
then the test statistic is
</p>
<p style="text-align: center;"><code class="reqn">
  t_{i} = \frac{\max_{1 \le u \le i} \left(\sum_{j=u}^i n_j \bar{R}_j / \sum_{j=u}^i n_j \right) - \bar{R}_0}
{\sigma_{R_i} \sqrt{1/n_i + 1/n_0}},
</code>
</p>

<p>with expected variance of
</p>
<p style="text-align: center;"><code class="reqn">
\sigma_{R_i}^2 = N_i \left(N_i + 1 \right) / 12 - T_i,
</code>
</p>

<p>where <code class="reqn">N_i = n_0 + n_1 + n_2 + \ldots + n_i</code> and
<code class="reqn">T_i</code> the ties for the <code class="reqn">i</code>-th comparison is given by
</p>
<p style="text-align: center;"><code class="reqn">
 T_i = \sum_{j=1}^i \frac{t_j^3 - t_j}{12 \left(N_i - 1\right)}.
</code>
</p>

<p>The procedure starts from the highest dose level (<code class="reqn">m</code>) to the the lowest dose level (<code class="reqn">1</code>) and
stops at the first non-significant test. The consequent lowest effect dose
is the treatment level of the previous test number. This function has
included the modifications as recommended by Williams (1986), i.e.
the data are re-ranked for each of the <code class="reqn">i</code>-th comparison.
</p>
<p>If <code>method = "look-up"</code> is selected, the function does not return p-values.
Instead the critical <code class="reqn">t'_{i,v,\alpha}</code>-values
as given in the tables of Williams (1972) for <code class="reqn">\alpha = 0.05</code> (one-sided)
are looked up according to the degree of freedoms (<code class="reqn">v = \infty</code>) and the order number of the
dose level (<code class="reqn">i</code>) and (potentially) modified according to the given extrapolation
coefficient <code class="reqn">\beta</code>.
</p>
<p>Non tabulated values are linearly interpolated with the function
<code>approx</code>.
</p>
<p>For the comparison of the first dose level (i = 1) with the control, the critical
z-value from the standard normal distribution is used (<code>Normal</code>).
</p>
<p>If <code>method = "boot"</code>, the p-values are estimated through an assymptotic
boot-strap method. The p-values for H<code class="reqn">_1</code>
are calculated from the t distribution with infinite degree of freedom.
</p>


<h3>Value</h3>

<p>Either a list with class <code>"osrt"</code> or a list with class <code>"PMCMR"</code>.
</p>

<dl>
<dt>method</dt>
<dd>
<p>a character string indicating what type of test was performed.</p>
</dd>
<dt>data.name</dt>
<dd>
<p>a character string giving the name(s) of the data.</p>
</dd>
<dt>statistic</dt>
<dd>
<p>the estimated statistic(s)</p>
</dd>
<dt>crit.value</dt>
<dd>
<p>critical values for <code class="reqn">\alpha = 0.05</code>.</p>
</dd>
<dt>alternative</dt>
<dd>
<p>a character string describing the alternative hypothesis.</p>
</dd>
<dt>parameter</dt>
<dd>
<p>the parameter(s) of the test distribution.</p>
</dd>
<dt>dist</dt>
<dd>
<p>a string that denotes the test distribution.</p>
</dd>
</dl>
<p>There are print and summary methods available.
</p>
<p>A list with class <code>"PMCMR"</code> containing the following components:
</p>

<dl>
<dt>method</dt>
<dd>
<p>a character string indicating what type of test was performed.</p>
</dd>
<dt>data.name</dt>
<dd>
<p>a character string giving the name(s) of the data.</p>
</dd>
<dt>statistic</dt>
<dd>
<p>lower-triangle matrix of the estimated
quantiles of the pairwise test statistics.</p>
</dd>
<dt>p.value</dt>
<dd>
<p>lower-triangle matrix of the p-values for the pairwise tests.</p>
</dd>
<dt>alternative</dt>
<dd>
<p>a character string describing the alternative hypothesis.</p>
</dd>
<dt>p.adjust.method</dt>
<dd>
<p>a character string describing the method for p-value
adjustment.</p>
</dd>
<dt>model</dt>
<dd>
<p>a data frame of the input data.</p>
</dd>
<dt>dist</dt>
<dd>
<p>a string that denotes the test distribution.</p>
</dd>
</dl>
<h3>Note</h3>

<p>For <code>method = "look-up"</code>, only tests on the level of <code class="reqn">\alpha = 0.05</code>
can be performed for alternative hypotheses less or greater.
</p>
<p>For <code>method = "boot"</code> only the alternative <code>"two.sided"</code> can be calculated.
One may increase the number of permutations to e.g. <code>nperm = 10000</code>
in order to get more precise p-values. However, this will be on the expense of
computational time.
</p>


<h3>References</h3>

<p>Shirley, E., (1977) Nonparametric Equivalent of Williams Test for Contrasting Increasing
Dose Levels of a Treatment, <em>Biometrics</em> <b>33</b>, 386–389.
</p>
<p>Williams, D. A. (1986) Note on Shirley's nonparametric test for comparing
several dose levels with a zero-dose control, <em>Biometrics</em> <b>42</b>, 183–186.
</p>


<h3>See Also</h3>

<p><code>williamsTest</code>
</p>


<h3>Examples</h3>

<pre><code class="language-R">## Example from Shirley (1977)
## Reaction times of mice to stimuli to their tails.
x &lt;- c(2.4, 3, 3, 2.2, 2.2, 2.2, 2.2, 2.8, 2, 3,
 2.8, 2.2, 3.8, 9.4, 8.4, 3, 3.2, 4.4, 3.2, 7.4, 9.8, 3.2, 5.8,
 7.8, 2.6, 2.2, 6.2, 9.4, 7.8, 3.4, 7, 9.8, 9.4, 8.8, 8.8, 3.4,
 9, 8.4, 2.4, 7.8)
g &lt;- gl(4, 10)

## Shirley's test
## one-sided test using look-up table
shirleyWilliamsTest(x ~ g, alternative = "greater")

## Chacko's global hypothesis test for 'greater'
chackoTest(x , g)

## post-hoc test, default is standard normal distribution (NPT'-test)
summary(chaAllPairsNashimotoTest(x, g, p.adjust.method = "none"))

## same but h-distribution (NPY'-test)
chaAllPairsNashimotoTest(x, g, dist = "h")

## NPM-test
NPMTest(x, g)

## Hayter-Stone test
hayterStoneTest(x, g)

## all-pairs comparisons
hsAllPairsTest(x, g)
</code></pre>


</div>