<div class="container">

<table style="width: 100%;"><tr>
<td>matrix.D</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>Produce the Matrix D of Garland and Ives (2000) for GLS</h2>

<h3>Description</h3>

<p>Produces the matrix D in Garland and Ives, 2000, p. 361, for further use
in GLS procedures. You will rarely need to call this function
directly. It is called by phylog.gls.fit.
</p>


<h3>Usage</h3>

<pre><code class="language-R">matrix.D(x)
</code></pre>


<h3>Arguments</h3>

<table><tr style="vertical-align: top;">
<td><code>x</code></td>
<td>
<p> a phylogenetic variance-covariance matrix, such as a matrix returned
from a call to read.phylog.matrix. </p>
</td>
</tr></table>
<h3>Value</h3>

<p>A variance-covariance matrix.</p>


<h3>Note</h3>

<p> The file read is a dsc file generated from PDDIST under option 5
with the additional options : - in matrix form; - with header; - with
scaled values. </p>


<h3>Author(s)</h3>

<p>Ramon Diaz-Uriarte and Theodore Garland, Jr.</p>


<h3>References</h3>

<p>Diaz-Uriarte, R., and Garland, T., Jr., in prep. PHYLOGR:
an R package for the analysis of comparative data via Monte Carlo
simulations and generalized least squares approaches.
</p>
<p>Garland, T. Jr. and Ives, A. R. (2000) Using the past to predict the
present: confidence intervals for regression equations in phylogenetic
comparative methods. <em>The American Naturalist</em>, 155, 346-364.
</p>


<h3>See Also</h3>

<p><code>read.phylog.matrix</code>, <code>phylog.gls.fit</code></p>


<h3>Examples</h3>

<pre><code class="language-R">#perform GLS using lm function after transforming the variables
data(Lacertid.varcov)
mD &lt;- matrix.D(Lacertid.varcov)
data(Lacertid.Original)
# obtain transformed variables
Z &lt;- mD %*% Lacertid.Original$clutch.size
U &lt;- mD %*% cbind(rep(1,18),Lacertid.Original$svl) # intercept included
lm1 &lt;- lm(Z ~ U - 1) # eliminate intercept, since already included in U matrix
summary(lm1)
</code></pre>


</div>