<div class="container">

<table style="width: 100%;"><tr>
<td>power.williams.test</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>Power calculations for
minimum detectable difference of the Williams' test</h2>

<h3>Description</h3>

<p>Compute the power of a Williams' test,
or determine parameters to obtain a target power.
</p>


<h3>Usage</h3>

<pre><code class="language-R">power.williams.test(n = NULL, k, delta, sd = 1, power = NULL, ...)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>n</code></td>
<td>
<p>number of observations (per group).</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>k</code></td>
<td>
<p>number of treatment groups.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>delta</code></td>
<td>
<p>clinically meaningful minimal difference
(between a treatment group and control).</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>sd</code></td>
<td>
<p>common standard deviation.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>power</code></td>
<td>
<p>power of test (1 minus Type II error probability).</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>...</code></td>
<td>
<p>further arguments, currently ignored.</p>
</td>
</tr>
</table>
<h3>Details</h3>

<p>Exactly one of the parameters <code>n</code> or <code>power</code>
must be passed as <code>NULL</code>, and that
parameter is determined from the others.
</p>
<p>The function has implemented the following Eq. in order to
estimate power (Chow et  al. 2008):
</p>
<p style="text-align: center;"><code class="reqn">
 1 - \beta = 1 - \Phi \left(T_{K \alpha v} -
 |\Delta| / \sigma \sqrt{2/n}\right)
</code>
</p>

<p>with <code class="reqn">|\Delta|</code> the clinically meaningful minimal difference,
<code class="reqn">T_{K \alpha v}</code> the critical Williams' t-statistic
for <code class="reqn">\alpha = 0.05</code>, <code class="reqn">v = \infty</code> degree of freedom
and <code class="reqn">\Phi</code> the probability function of the standard normal function.
</p>
<p>The required sample size (balanced design) is estimated
based on the expression as given by the PASS manual, p. 595-2:
</p>
<p style="text-align: center;"><code class="reqn">
n = 2 \sigma^2 ~ \left(T_{K \alpha v} + z_{\beta} \right)^2 ~ / ~ \Delta^2
</code>
</p>



<h3>Value</h3>

<p>Object of class ‘<code>power.htest</code>’, a list of the arguments
(including the
computed one) augmented with method and note elements.
</p>


<h3>Note</h3>

<p>The current function calculates power for <code>sig.level = 0.05</code>
significance level (Type I error probability) only (one-sided test).
</p>


<h3>References</h3>

<p>Chow, S.-C., Shao, J., Wan, H., 2008,
<em>Sample Size Calculations in Clinical Research</em>, 2nd ed,
Chapman &amp; Hall/CRC: Boca Raton, FL.
</p>


<h3>See Also</h3>

<p><code>optimise</code> <code>williamsTest</code>
</p>


<h3>Examples</h3>

<pre><code class="language-R">## Chow et al. 2008, p. 288 depicts 53 (rounded),
## better use ceiling for rounding
power.williams.test(power = 0.8, k = 3, delta = 11, sd = 22)
power.williams.test(n = 54, k = 3, delta = 11, sd = 22)

## PASS manual example:
## up-rounded n values are:
## 116, 52, 29, 14, 8 and 5
## according to PASS manual, p. 595-5
D &lt;- c(10, 15, 20, 30, 40, 50)
y &lt;- sapply(D, function(delta) {
 power.williams.test(power = 0.9, k = 4, delta = delta, sd = 25)$n
 })
ceiling(y)

## Not run: 
 ## compare with power.t.test
 ## and bonferroni correction
 power.t.test(power = 0.9, delta = 50, sd = 25,
 sig.level = 0.05 / 4, alternative = "one.sided")

## End(Not run)

</code></pre>


</div>