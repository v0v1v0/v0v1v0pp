<div class="container">

<table style="width: 100%;"><tr>
<td>pbd_LR</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>Bootstrap likelihood ratio test of protracted birth-death model of diversification
</h2>

<h3>Description</h3>

<p>This function computes the maximum likelihood and the associated estimates of the parameters of a protracted birth-death model of diversification for a given set of phylogenetic branching times. It then performs a bootstrap likelihood ratio test of the protracted birth-death (PBD) model against the constant-rates (CR) birth-death model. Finally, it computes the power of this test.
</p>


<h3>Usage</h3>

<pre><code class="language-R">pbd_LR(
  brts,
  initparsoptPBD,
  initparsoptCR,
  missnumspec,
  outputfilename = NULL,
  seed = 42,
  endmc = 1000,
  alpha = 0.05,
  plotit = TRUE,
  parsfunc = c(function(t,pars) {pars[1]},
  function(t,pars) {pars[2]},
  function(t,pars) {pars[3]},
  function(t,pars) {pars[4]}),
  cond = 1,
  btorph = 1,
  soc = 2,
  methode = 'lsoda',
  n_low = 0,
  n_up = 0,
  tol = c(1E-6,1E-6,1E-6),
  maxiter = 2000,
  optimmethod = 'subplex',
  verbose = FALSE
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>brts</code></td>
<td>
<p>A set of branching times of a phylogeny, all positive </p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>initparsoptPBD</code></td>
<td>
<p>The initial values of the parameters that must be optimized for the protracted birth-death (PBD) model: b, mu and lambda</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>initparsoptCR</code></td>
<td>
<p>The initial values of the parameters that must be optimized for the constant-rates (CR) model: b and mu</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>missnumspec</code></td>
<td>
<p>The number of species that are in the clade but missing in the phylogeny </p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>outputfilename</code></td>
<td>
<p>The name (and location) of the file where the output will be saved. Default is no save.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>seed</code></td>
<td>
<p>The seed for the pseudo random number generator for simulating the bootstrap data</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>endmc</code></td>
<td>
<p>The number of bootstraps</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>alpha</code></td>
<td>
<p>The significance level of the test</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>plotit</code></td>
<td>
<p>Boolean to plot results or not</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>parsfunc</code></td>
<td>
<p>Specifies functions how the rates depend on time, default functions are constant functions</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>cond</code></td>
<td>
<p> Conditioning: <br>
cond == 0 : conditioning on stem or crown age <br>
cond == 1 : conditioning on stem or crown age and non-extinction of the phylogeny <br>
cond == 2 : conditioning on stem or crown age and on the total number of extant taxa (including missing species) <br>
cond == 3 : conditioning on the total number of extant taxa (including missing species) <br>
Note: cond == 3 assumes a uniform prior on stem age, as is the standard in constant-rate birth-death models, see
e.g. D. Aldous &amp; L. Popovic 2004. Adv. Appl. Prob. 37: 1094-1115 and T. Stadler 2009. J. Theor. Biol. 261: 58-66.
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>btorph</code></td>
<td>
<p>Sets whether the likelihood is for the branching times (0) or the phylogeny (1)</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>soc</code></td>
<td>
<p>Sets whether stem or crown age should be used (1 or 2) </p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>methode</code></td>
<td>
<p>The numerical method used to solve the master equation, such as 'lsoda' or 'ode45'.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>n_low</code></td>
<td>
<p>Sets the lower bound of the number of species on which conditioning should be done when cond = 2. Set this to 0 when conditioning should be done on precisely the number of species (default)</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>n_up</code></td>
<td>
<p>Sets the upper bound of the number of species on which conditioning should be done when cond = 2. Set this to 0 when conditioning should be done on precisely the number of species (default)</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>tol</code></td>
<td>
<p>Sets the tolerances in the optimization. Consists of: <br>
reltolx = relative tolerance of parameter values in optimization <br>
reltolf = relative tolerance of function value in optimization <br>
abstolx = absolute tolerance of parameter values in optimization
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>maxiter</code></td>
<td>
<p>Sets the maximum number of iterations in the optimization</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>optimmethod</code></td>
<td>
<p>Method used in optimization of the likelihood. Current default is 'subplex'. Alternative is 'simplex'.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>verbose</code></td>
<td>
<p>if TRUE, explanatory text will be shown</p>
</td>
</tr>
</table>
<h3>Details</h3>

<p>The output is a list with 3 elements:
</p>


<h3>Value</h3>

<table>
<tr style="vertical-align: top;">
<td><code>brtsCR</code></td>
<td>
<p>a list of sets of branching times generated under the constant-rates model using the ML parameters under the CR model</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>brtsDD</code></td>
<td>
<p>a list of sets of branching times generated under the protracted birth-death model using the ML parameters under the PBD model</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>out</code></td>
<td>
<p>a dataframe with the parameter estimates and maximum likelihoods for protracted birth-death and constant-rates models
<code>$model</code> - the model used to generate the data. 0 = unknown (for real data), 1 = CR, 2 = PBD <br><code>$mc</code> - the simulation number for each model <br><code>$b_CR</code> - speciation rate estimated under CR <br><code>$mu_CR</code> - extinction rate estimated under CR <br><code>$LL_CR</code> - maximum likelihood estimated under CR <br><code>$conv_CR</code> - convergence code for likelihood optimization; conv = 0 means convergence <br><code>$b_PBD1</code> - speciation-initation rate estimated under PBD for first set of initial values<br><code>$mu_PB1</code> - extinction rate estimated under DD for first set of initial values <br><code>$lambda_PB1</code> - speciation-completion rate estimated under PBD for first set of initial values <br><code>$LL_PBD1</code> - maximum likelihood estimated under DD for first set of initial values <br><code>$conv_PBD1</code> - convergence code for likelihood optimization for first set of initial values; conv = 0 means convergence <br><code>$b_PBD2</code> - speciation-initation rate estimated under PBD for second set of initial values<br><code>$mu_PB2</code> - extinction rate estimated under DD for second set of initial values <br><code>$lambda_PB2</code> - speciation-completion rate estimated under PBD for second set of initial values <br><code>$LL_PBD2</code> - maximum likelihood estimated under DD for second set of initial values <br><code>$conv_PBD2</code> - convergence code for likelihood optimization for second set of initial values; conv = 0 means convergence <br><code>$LR</code> - likelihood ratio between DD and CR
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>pvalue</code></td>
<td>
<p>p-value of the test</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>LRalpha</code></td>
<td>
<p>Likelihood ratio at the signifiance level alpha</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>poweroftest</code></td>
<td>
<p>power of the test for significance level alpha</p>
</td>
</tr>
</table>
<h3>Author(s)</h3>

<p> Rampal S. Etienne </p>


<h3>References</h3>

<p>- Etienne, R.S. et al. 2016. Meth. Ecol. Evol. 7: 1092-1099, doi: 10.1111/2041-210X.12565 <br></p>


<h3>See Also</h3>

<p><code>pbd_loglik</code>,
<code>pbd_ML</code>
</p>


</div>