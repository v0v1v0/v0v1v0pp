<div class="container">

<table style="width: 100%;"><tr>
<td>setMutationModel</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>Set a mutation model</h2>

<h3>Description</h3>

<p><em><strong>NB: This function has been replaced by <code>pedtools::setMutmod()</code>.</strong></em>
This function attaches mutation models to a pedigree with marker data,
calling <code>pedmut::mutationModel()</code> for creating the models.
</p>


<h3>Usage</h3>

<pre><code class="language-R">setMutationModel(x, model, markers = NULL, ...)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>x</code></td>
<td>
<p>A <code>ped</code> object or a list of such.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>model</code></td>
<td>
<p>A model name implemented by <code>pedmut::mutationModel()</code> (see
Details), or NULL.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>markers</code></td>
<td>
<p>A vector of names or indices referring to markers attached to
<code>x</code>. (Default: All markers.)</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>...</code></td>
<td>
<p>Arguments forwarded to <code>pedmut::mutationModel()</code>, e.g., <code>rate</code>.</p>
</td>
</tr>
</table>
<h3>Details</h3>

<p>Currently, the following models are handled:
</p>

<ul>
<li> <p><code>equal</code> :  All mutations equally likely; probability <code class="reqn">1-rate</code> of no
mutation
</p>
</li>
<li> <p><code>proportional</code> : Mutation probabilities are proportional to the target
allele frequencies
</p>
</li>
<li> <p><code>onestep</code>: A mutation model for microsatellite markers, allowing mutations
only to the nearest neighbours in the allelic ladder. For example, '10' may
mutate to either '9' or '11', unless '10' is the lowest allele, in which case
'11' is the only option. This model is not applicable to loci with
non-integral microvariants.
</p>
</li>
<li> <p><code>stepwise</code>: A common model in forensic genetics, allowing different
mutation rates between integer alleles (like '16') and non-integer
"microvariants" like '9.3'). Mutations also depend on the size of the
mutation if the parameter 'range' differs from 1.
</p>
</li>
<li> <p><code>custom</code> : Allows any mutation matrix to be provided by the user, in the
<code>matrix</code> parameter
</p>
</li>
<li> <p><code>random</code> : This produces a matrix of random numbers, where each row is
normalised so that it sums to 1
</p>
</li>
<li> <p><code>trivial</code> : The identity matrix; i.e. no mutations are possible.
</p>
</li>
</ul>
<h3>Value</h3>

<p>An object similar to <code>x</code>.
</p>


<h3>Examples</h3>

<pre><code class="language-R">### Example requires the pedmut package ###
if (requireNamespace("pedmut", quietly = TRUE)){

# A pedigree with data from a single marker
x = nuclearPed(1) |&gt;
  addMarker(geno = c("a/a", NA, "b/b")) # mutation!

# Set `equal` model
y = setMutationModel(x, marker = 1, model = "equal", rate = 0.01)

# Inspect model
mutmod(y, 1)

# Likelihood
likelihood(y, 1)

# Remove mutation model
z = setMutationModel(y, model = NULL)
stopifnot(identical(z, x))
}

</code></pre>


</div>