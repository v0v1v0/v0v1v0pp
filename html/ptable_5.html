<div class="container">

<table style="width: 100%;"><tr>
<td>create_ptable</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>Noise Probability Generator for the Cell-Key Method (CKM)</h2>

<h3>Description</h3>

<p><a href="https://github.com/sdcTools/ptable">ptable</a> makes it easy to create
perturbation tables that can be used for applying noise to statistical
tables with any cell-key method approach - among others either the
<a href="https://github.com/sdcTools/cellKey">cellKey()</a>-package
or the standalone tool <a href="https://github.com/sdcTools/tauargus">TauArgus</a>.
</p>
<p>The package
provides four main functions to create the perturbation tables:
</p>

<ul>
<li> <p><code>create_ptable()</code>: generic function that creates a ptable, either for
frequency count or magnitude tables with a various set of options.
</p>
</li>
<li> <p><code>create_cnt_ptable()</code>: creates a ptable suitable for frequency count
tables.
</p>
</li>
<li> <p><code>create_num_ptable()</code>: creates a ptable suitable for magnitude tables
(i.e. with numerical variables).
</p>
</li>
<li> <p><code>modify_cnt_ptable()</code>: modifies the ptable for a higher level of protection
</p>
</li>
</ul>
<h3>Usage</h3>

<pre><code class="language-R">create_ptable(
  D,
  V,
  js = 0,
  pstay = NULL,
  optim = 1,
  mono = TRUE,
  step = 1,
  icat = NULL,
  table = "cnts",
  type = "all",
  label = paste0("D", D, "V", V * 100),
  monitoring = FALSE,
  debugging = FALSE,
  create = TRUE,
  params = NULL
)

create_cnt_ptable(
  D,
  V,
  js = 0,
  pstay = NULL,
  optim = 1,
  mono = TRUE,
  label = paste0("D", D, "V", V * 100),
  monitoring = FALSE,
  create = TRUE
)

create_num_ptable(
  D,
  V,
  pstay = NULL,
  optim = 1,
  mono = TRUE,
  step = 2,
  icat = NULL,
  type = "all",
  label = paste0("D", D, "V", V * 100),
  monitoring = FALSE,
  create = TRUE
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>D</code></td>
<td>
<p>perturbation parameter for maximum noise (scalar integer)</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>V</code></td>
<td>
<p>perturbation parameter for variance (scalar double)</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>js</code></td>
<td>
<p>threshold value for blocking of small frequencies
(i.e. the perturbation will not produce positive cell values that are equal
to or smaller than the threshold value). (scalar integer)</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>pstay</code></td>
<td>
<p>optional parameter to set the probability (0 &lt; p &lt; 1) of
an original frequency to remain unperturbed: NA (default) no preset
probability (i.e. produces the maximum entropy solution)</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>optim</code></td>
<td>
<p>optimization parameter: <code>1</code> standard approach (default) with
regular constraints, <code>4</code> alternative approach with simplified constraints
(may work if constraints using the standard approach are violated)</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>mono</code></td>
<td>
<p>(logical) vector specifying optimization parameter for
monotony condition</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>step</code></td>
<td>
<p>(integer) number of steps for the noise (between two integer
values). Whereas the cell-key approach
for frequency count tables only allows to have noise values that are
integers (<code>step = 1</code>)
</p>
<p style="text-align: center;"><code class="reqn">-D, 1-D, 2-D, ..., -1, 0, 1, ..., D-2, D-1, D</code>
</p>

<p>the noise distribution for magnitude values does not have
to be integer valued:
</p>
<p style="text-align: center;"><code class="reqn">-D, (1/step)-D, (2/step)-D, ..., 0, ..., D-(2/step), D-(1/step), D</code>
</p>

<p>The reciprocal of step (='step width') is computed and used internally
for the perturbation table.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>icat</code></td>
<td>
<p>(integer) categorized original frequencies i</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>table</code></td>
<td>
<p>(character) type of the table: frequency count (<code>cnts</code>)
or magnitude table (<code>nums</code>)</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>type</code></td>
<td>
<p>(character) type indicator for the extra column 'type' used for
magnitude tables: <code>'even'</code>, <code>'odd'</code> or <code>'all'</code> (default)</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>label</code></td>
<td>
<p>(character) label of the Output</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>monitoring</code></td>
<td>
<p>(logical) output monitoring on/off</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>debugging</code></td>
<td>
<p>(logical) debug monitoring on/off</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>create</code></td>
<td>
<p>(logical) scalar specifying to create just the
input parameters of class ptable_params (<code>FALSE</code>) or also to
create the perturbation table object of class ptable
(default: <code>TRUE</code>)</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>params</code></td>
<td>
<p>object of class ptable_params can be used as input
instead of the remaining parameters</p>
</td>
</tr>
</table>
<h3>Details</h3>

<p>The perturbation probabilities are constructed given the following
constraints:
</p>

<ul>
<li>
<p> Maximum noise
</p>
</li>
<li>
<p> Zero mean (unbiased noise)
</p>
</li>
<li>
<p> Fixed noise variance
</p>
</li>
<li>
<p> Transition probabilities are between zero and one and the sum up to 1
</p>
</li>
<li>
<p> Perturbations will not produce negative cell values or positive cell values
equal to or less than a specific threshold value
</p>
</li>
</ul>
<h3>Value</h3>

<p>Returns ptable object including the
created perturbation table by default. If the argument <code>create = FALSE</code>,
a ptable_params object is returned.
</p>


<h3>See Also</h3>


<ul>
<li> <p><code>plot()</code> to analyze the created perturbation table visually
</p>
</li>
<li> <p><code>pt_export()</code> to export the perturbation table for external sdcTools
like <a href="https://github.com/sdcTools/tauargus">TauArgus</a> or SAS.
</p>
</li>
</ul>
<h3>Examples</h3>

<pre><code class="language-R">
# create ptable for frequency count tables
create_cnt_ptable(D = 3, V = 1.08, js = 1, label = "ptable_frequency_tab")

# create ptable for magnitude tables
create_num_ptable(D = 5, V = 2, step = 4, icat = c(1, 3, 5))

# create ptable for frequency or magnitude tables
create_ptable(D = 3, V = 1.08, js = 1, table="cnts")
create_ptable(D = 5, V = 2, step = 4, icat = c(1, 4, 5), table="nums")


</code></pre>


</div>