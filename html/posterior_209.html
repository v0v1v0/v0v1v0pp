<div class="container">

<table style="width: 100%;"><tr>
<td>pareto_khat</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>Pareto khat diagnostic</h2>

<h3>Description</h3>

<p>Estimate Pareto k value by fitting a Generalized Pareto
Distribution to one or two tails of x. This can be used to estimate
the number of fractional moments that is useful for convergence
diagnostics. For further details see Vehtari et al. (2024).
</p>


<h3>Usage</h3>

<pre><code class="language-R">pareto_khat(x, ...)

## Default S3 method:
pareto_khat(
  x,
  tail = c("both", "right", "left"),
  r_eff = NULL,
  ndraws_tail = NULL,
  verbose = FALSE,
  are_log_weights = FALSE,
  ...
)

## S3 method for class 'rvar'
pareto_khat(x, ...)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>x</code></td>
<td>
<p>(multiple options) One of:
</p>

<ul>
<li>
<p> A matrix of draws for a single variable (iterations x chains). See
<code>extract_variable_matrix()</code>.
</p>
</li>
<li>
<p> An <code>rvar</code>.
</p>
</li>
</ul>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>...</code></td>
<td>
<p>Arguments passed to individual methods (if applicable).</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>tail</code></td>
<td>
<p>(string) The tail to diagnose/smooth:
</p>

<ul>
<li> <p><code>"right"</code>: diagnose/smooth only the right (upper) tail
</p>
</li>
<li> <p><code>"left"</code>: diagnose/smooth only the left (lower) tail
</p>
</li>
<li> <p><code>"both"</code>: diagnose/smooth both tails and return the maximum k-hat value
</p>
</li>
</ul>
<p>The default is <code>"both"</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>r_eff</code></td>
<td>
<p>(numeric) relative effective sample size estimate. If
<code>r_eff</code> is NULL, it will be calculated assuming the draws are
from MCMC. Default is NULL.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>ndraws_tail</code></td>
<td>
<p>(numeric) number of draws for the tail. If
<code>ndraws_tail</code> is not specified, it will be calculated as
ceiling(3 * sqrt(length(x) / r_eff)) if length(x) &gt; 225 and
length(x) / 5 otherwise (see Appendix H in Vehtari et
al. (2024)).</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>verbose</code></td>
<td>
<p>(logical) Should diagnostic messages be printed? If
<code>TRUE</code>, messages related to Pareto diagnostics will be
printed. Default is <code>FALSE</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>are_log_weights</code></td>
<td>
<p>(logical) Are the draws log weights? Default is
<code>FALSE</code>. If <code>TRUE</code> computation will take into account that the
draws are log weights, and only right tail will be smoothed.</p>
</td>
</tr>
</table>
<h3>Value</h3>

<p>If the input is an array, returns a single numeric value. If any of the draws
is non-finite, that is, <code>NA</code>, <code>NaN</code>, <code>Inf</code>, or <code>-Inf</code>, the returned output
will be (numeric) <code>NA</code>. Also, if all draws within any of the chains of a
variable are the same (constant), the returned output will be (numeric) <code>NA</code>
as well. The reason for the latter is that, for constant draws, we cannot
distinguish between variables that are supposed to be constant (e.g., a
diagonal element of a correlation matrix is always 1) or variables that just
happened to be constant because of a failure of convergence or other problems
in the sampling process.
</p>
<p>If the input is an <code>rvar</code>, returns an array of the same dimensions as the
<code>rvar</code>, where each element is equal to the value that would be returned by
passing the draws array for that element of the <code>rvar</code> to this function.
</p>


<h3>References</h3>

<p>Aki Vehtari, Daniel Simpson, Andrew Gelman, Yuling Yao and
Jonah Gabry (2024). Pareto Smoothed Importance Sampling.
<em>Journal of Machine Learning Research</em>, 25(72):1-58.
<a href="https://jmlr.org/papers/v25/19-556.html">PDF</a>
</p>


<h3>See Also</h3>

<p><code>pareto_diags</code> for additional related diagnostics, and
<code>pareto_smooth</code> for Pareto smoothed draws.
</p>
<p>Other diagnostics: 
<code>ess_basic()</code>,
<code>ess_bulk()</code>,
<code>ess_quantile()</code>,
<code>ess_sd()</code>,
<code>ess_tail()</code>,
<code>mcse_mean()</code>,
<code>mcse_quantile()</code>,
<code>mcse_sd()</code>,
<code>pareto_diags()</code>,
<code>rhat()</code>,
<code>rhat_basic()</code>,
<code>rhat_nested()</code>,
<code>rstar()</code>
</p>


<h3>Examples</h3>

<pre><code class="language-R">mu &lt;- extract_variable_matrix(example_draws(), "mu")
pareto_khat(mu)

d &lt;- as_draws_rvars(example_draws("multi_normal"))
pareto_khat(d$Sigma)
</code></pre>


</div>