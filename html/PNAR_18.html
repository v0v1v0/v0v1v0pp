<div class="container">

<table style="width: 100%;"><tr>
<td>poisson.MODpq.nonlin</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>
Generation of multivariate count time series from a non-linear Intercept Drift Poisson NAR(p)
model with q covariates (ID-PNAR(p))
</h2>

<h3>Description</h3>

<p>Generation of counts from a non-linear Intercept Drift Poisson Network
Autoregressive model of order <code class="reqn">p</code> with <code class="reqn">q</code> covariates (ID-PNAR(<code class="reqn">p</code>)).
</p>


<h3>Usage</h3>

<pre><code class="language-R">poisson.MODpq.nonlin(b, W, gama, p, d, Z = NULL, TT, N, copula = "gaussian",
corrtype = "equicorrelation", rho, dof = 1)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>b</code></td>
<td>

<p>The linear coefficients of the model, in the following order: (intercept,
network parameters, autoregressive parameters, covariates). The dimension of
the vector should be <code class="reqn">2p + 1 + q</code>, where <code class="reqn">q</code> denotes the number of covariates.
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>W</code></td>
<td>

<p>The <code class="reqn">N \times N</code> row-normalized non-negative adjacency matrix describing
the network. The main diagonal entries of the matrix should be zeros, all the
other entries should be non-negative and the maximum sum of elements over the
rows should equal one. The function row-normalizes the matrix if a non-normalized
adjacency matrix is provided.
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>gama</code></td>
<td>

<p>A scalar non-linear intercept drift parameter.
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>p</code></td>
<td>

<p>The number of lags in the model.
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>d</code></td>
<td>

<p>The lag parameter of non-linear variable (should be between 1 and <code class="reqn">p</code>).
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>Z</code></td>
<td>

<p>An <code class="reqn">N \times q</code> matrix of covariates (one for each column),
where <code class="reqn">q</code> is the number of covariates in the model.
Note that they must be non-negative.
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>TT</code></td>
<td>

<p>The temporal sample size.
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>N</code></td>
<td>

<p>The number of nodes on the network.
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>copula</code></td>
<td>

<p>Which copula function to use? The "gaussian", "t", or "clayton".
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>rho</code></td>
<td>

<p>The value of the copula parameter (<code class="reqn">\rho</code>). A scalar in <code class="reqn">[-1,1]</code> for
elliptical copulas (Gaussian, t), a value greater than or equal to -1 for
Clayton copula.
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>corrtype</code></td>
<td>

<p>Used only for elliptical copulas. The type of correlation matrix employed for
the copula; it will either be the "equicorrelation" or "toeplitz". The
"equicorrelation" option generates a correlation matrix where all the off-diagonal
entries equal <code class="reqn">\rho</code>. The "toeplitz" option generates a correlation matrix
whose generic off-diagonal <code class="reqn">(i,j)</code>-element is <code class="reqn">\rho^{|i-j|}</code>.
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>dof</code></td>
<td>

<p>The degrees of freedom for Student's t copula.
</p>
</td>
</tr>
</table>
<h3>Details</h3>

<p>This function generates counts from a non-linear Intercept Drift Poisson NAR(<code class="reqn">p</code>) model, where <code class="reqn">q</code> non time-varying covariates are allowed as well. The counts are simulated from <code class="reqn">Y_{t}=N_{t}(\lambda_{t})</code>, where <code class="reqn">N_{t}</code> is a sequence of <code class="reqn">N</code>-dimensional IID Poisson count processes, with intensity 1, and whose structure of dependence is modelled through a copula construction <code class="reqn">C(\rho)</code> on their associated exponential waiting times random variables. For details see Armillotta and Fokianos (2024, Sec. 2.1-2.2). The sequence <code class="reqn">\lambda_{i,t}</code> is the expecation of <code class="reqn">Y_{i,t}</code>, conditional to its past values and it is generated by means of the following ID-PNAR(<code class="reqn">p</code>) model. For each node of the network <code class="reqn">i=1,...,N</code> over the time sample <code class="reqn">t=1,...,TT</code>
</p>
<p style="text-align: center;"><code class="reqn">
\lambda_{i,t}=\frac{\beta_{0}}{(1+X_{i,t-d})^{\gamma}}+\sum_{h=1}^{p}(\beta_{1h}X_{i,t-h}+\beta_{2h}Y_{i,t-h})+\sum_{l=1}^{q}\delta_{l}Z_{i,l}
</code>
</p>

<p>where <code class="reqn">X_{i,t}=\sum_{j=1}^{N}W_{ij}Y_{j,t}</code> is the network effect, i.e. the weighted average impact of node <code class="reqn">i</code> connections, with the weights of the mean being <code class="reqn">W_{ij}</code>, the single element of the network matrix <code class="reqn">W</code>.
</p>
<p>The parameter <code class="reqn">\beta_{0}</code> is the intercept of the model, <code class="reqn">\beta_{1h}</code> are the network coefficients, <code class="reqn">\beta_{2h}</code> are the autoregressive parameters, <code class="reqn">\gamma</code> is the non-linear coefficient associated with the intercept drift, and <code class="reqn">\delta_{l}</code> are the coefficients assocciated with the covariates <code class="reqn">Z_{i,l}</code>. The coefficient <code class="reqn">d</code> is considered as an extra parameter defining the lag of the network effect in the non-linear part of the model and is left to be set by the user. For details on ID-PNAR models see Armillotta and Fokianos (2023, Sec. 2).
</p>


<h3>Value</h3>

<p>A list including:
</p>
<table>
<tr style="vertical-align: top;">
<td><code>p2R</code></td>
<td>

<p>The Toeplitz correlation matrix, if employed in the copula or NULL else.
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>lambda</code></td>
<td>

<p>A <code class="reqn">TT \times N</code> time series object matrix of simulated Poisson means for <code class="reqn">N</code> time
series over <code class="reqn">TT</code>.
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>y</code></td>
<td>

<p>A <code class="reqn">TT \times N</code> time series object matrix of simulated counts for <code class="reqn">N</code> time series
over <code class="reqn">TT</code>.
</p>
</td>
</tr>
</table>
<h3>Author(s)</h3>

<p>Mirko Armillotta, Michail Tsagris and Konstantinos Fokianos.
</p>


<h3>References</h3>

<p>Armillotta, M. and K. Fokianos (2023). Nonlinear network autoregression. <em>Annals of Statistics</em>, 51(6): 2526–2552.
</p>
<p>Armillotta, M. and K. Fokianos (2024). Count network autoregression. <em>Journal of Time Series Analysis</em>, 45(4): 584–612.
</p>
<p>Armillotta, M., Tsagris, M. and Fokianos, K. (2024). Inference for Network Count Time Series with the R Package PNAR. <em>The R Journal</em>, 15/4: 255–269.
</p>


<h3>See Also</h3>

<p><code>poisson.MODpq, poisson.MODpq.log,
poisson.MODpq.stnar, poisson.MODpq.tnar
</code>
</p>


<h3>Examples</h3>

<pre><code class="language-R">W &lt;- adja( N = 20, K = 5, alpha= 0.5)
y &lt;- poisson.MODpq.nonlin( b = c(0.5, 0.3, 0.2), W = W, gama = 1, p = 1,
d = 1, Z = NULL, TT = 1000, N = 20, copula = "gaussian",
corrtype = "equicorrelation", rho = 0.5)$y
</code></pre>


</div>