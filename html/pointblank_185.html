<div class="container">

<table style="width: 100%;"><tr>
<td>tt_time_shift</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>Table Transformer: shift the times of a table</h2>

<h3>Description</h3>

<p>With any table object containing date or date-time columns, these values can
be precisely shifted with <code>tt_time_shift()</code> and specification of the time
shift. We can either provide a string with the time shift components and the
shift direction (like <code>"-4y 10d"</code>) or a <code>difftime</code> object (which can be
created via <strong>lubridate</strong> expressions or by using the <code>base::difftime()</code>
function).
</p>


<h3>Usage</h3>

<pre><code class="language-R">tt_time_shift(tbl, time_shift = "0y 0m 0d 0H 0M 0S")
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>tbl</code></td>
<td>
<p><em>A data table</em>
</p>
<p><code style="white-space: pre;">⁠obj:&lt;tbl_*&gt;⁠</code> // <strong>required</strong>
</p>
<p>A table object to be used as input for the transformation. This can be a
data frame, a tibble, a <code>tbl_dbi</code> object, or a <code>tbl_spark</code> object.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>time_shift</code></td>
<td>
<p><em>Time-shift specification</em>
</p>
<p><code style="white-space: pre;">⁠scalar&lt;character&gt;⁠</code> // <em>default:</em> <code>"0y 0m 0d 0H 0M 0S"</code>
</p>
<p>Either a character-based representation that specifies the time difference
by which all time values in time-based columns will be shifted, or, a
<code>difftime</code> object. The character string is constructed in the format
<code>"0y 0m 0d 0H 0M 0S"</code> and individual time components can be omitted (i.e.,
<code>"1y 5d"</code> is a valid specification of shifting time values ahead one year
and five days). Adding a <code>"-"</code> at the beginning of the string (e.g.,
<code>"-2y"</code>) will shift time values back.</p>
</td>
</tr>
</table>
<h3>Details</h3>

<p>The <code>time_shift</code> specification cannot have a higher time granularity than the
least granular time column in the input table. Put in simpler terms, if there
are any date-based based columns (or just a single date-based column) then
the time shifting can only be in terms of years, months, and days. Using a
<code>time_shift</code> specification of <code>"20d 6H"</code> in the presence of any dates will
result in a truncation to <code>"20d"</code>. Similarly, a <code>difftime</code> object will be
altered in the same circumstances, however, the object will resolved to an
exact number of days through rounding.
</p>


<h3>Value</h3>

<p>A data frame, a tibble, a <code>tbl_dbi</code> object, or a <code>tbl_spark</code> object
depending on what was provided as <code>tbl</code>.
</p>


<h3>Examples</h3>

<p>Let's use the <code>game_revenue</code> dataset, included in the <strong>pointblank</strong> package,
as the input table for the first demo. It has entries in the first 21 days of
2015 and we'll move all of the date and date-time values to the beginning of
2021 with the <code>tt_time_shift()</code> function and the <code>"6y"</code> <code>time_shift</code>
specification.
</p>
<div class="sourceCode r"><pre>tt_time_shift(
  tbl = game_revenue,
  time_shift = "6y"
)
#&gt; # A tibble: 2,000 x 11
#&gt;    player_id       session_id  session_start       time                item_type
#&gt;    &lt;chr&gt;           &lt;chr&gt;       &lt;dttm&gt;              &lt;dttm&gt;              &lt;chr&gt;    
#&gt;  1 ECPANOIXLZHF896 ECPANOIXLZ~ 2021-01-01 01:31:03 2021-01-01 01:31:27 iap      
#&gt;  2 ECPANOIXLZHF896 ECPANOIXLZ~ 2021-01-01 01:31:03 2021-01-01 01:36:57 iap      
#&gt;  3 ECPANOIXLZHF896 ECPANOIXLZ~ 2021-01-01 01:31:03 2021-01-01 01:37:45 iap      
#&gt;  4 ECPANOIXLZHF896 ECPANOIXLZ~ 2021-01-01 01:31:03 2021-01-01 01:42:33 ad       
#&gt;  5 ECPANOIXLZHF896 ECPANOIXLZ~ 2021-01-01 11:50:02 2021-01-01 11:55:20 ad       
#&gt;  6 ECPANOIXLZHF896 ECPANOIXLZ~ 2021-01-01 11:50:02 2021-01-01 12:08:56 ad       
#&gt;  7 ECPANOIXLZHF896 ECPANOIXLZ~ 2021-01-01 11:50:02 2021-01-01 12:14:08 ad       
#&gt;  8 ECPANOIXLZHF896 ECPANOIXLZ~ 2021-01-01 11:50:02 2021-01-01 12:21:44 ad       
#&gt;  9 ECPANOIXLZHF896 ECPANOIXLZ~ 2021-01-01 11:50:02 2021-01-01 12:24:20 ad       
#&gt; 10 FXWUORGYNJAE271 FXWUORGYNJ~ 2021-01-01 15:17:18 2021-01-01 15:19:36 ad       
#&gt; # i 1,990 more rows
#&gt; # i 6 more variables: item_name &lt;chr&gt;, item_revenue &lt;dbl&gt;,
#&gt; #   session_duration &lt;dbl&gt;, start_day &lt;date&gt;, acquisition &lt;chr&gt;, country &lt;chr&gt;
</pre></div>
<p>Keeping only the <code>date_time</code> and <code>a</code>-<code>f</code> columns of <code>small_table</code>, also
included in the package, shift the times back 2 days and 12 hours with the
<code>"-2d 12H"</code> specification.
</p>
<div class="sourceCode r"><pre>small_table %&gt;%
  dplyr::select(-date) %&gt;%
  tt_time_shift("-2d 12H")
#&gt; # A tibble: 13 x 7
#&gt;    date_time               a b             c      d e     f    
#&gt;    &lt;dttm&gt;              &lt;int&gt; &lt;chr&gt;     &lt;dbl&gt;  &lt;dbl&gt; &lt;lgl&gt; &lt;chr&gt;
#&gt;  1 2016-01-01 23:00:00     2 1-bcd-345     3  3423. TRUE  high 
#&gt;  2 2016-01-01 12:32:00     3 5-egh-163     8 10000. TRUE  low  
#&gt;  3 2016-01-03 01:32:00     6 8-kdg-938     3  2343. TRUE  high 
#&gt;  4 2016-01-04 05:23:00     2 5-jdo-903    NA  3892. FALSE mid  
#&gt;  5 2016-01-07 00:36:00     8 3-ldm-038     7   284. TRUE  low  
#&gt;  6 2016-01-08 18:15:00     4 2-dhe-923     4  3291. TRUE  mid  
#&gt;  7 2016-01-13 06:46:00     7 1-knw-093     3   843. TRUE  high 
#&gt;  8 2016-01-14 23:27:00     4 5-boe-639     2  1036. FALSE low  
#&gt;  9 2016-01-17 16:30:00     3 5-bce-642     9   838. FALSE high 
#&gt; 10 2016-01-17 16:30:00     3 5-bce-642     9   838. FALSE high 
#&gt; 11 2016-01-24 08:07:00     4 2-dmx-010     7   834. TRUE  low  
#&gt; 12 2016-01-25 14:51:00     2 7-dmx-010     8   108. FALSE low  
#&gt; 13 2016-01-27 23:23:00     1 3-dka-303    NA  2230. TRUE  high
</pre></div>


<h3>Function ID</h3>

<p>12-5
</p>


<h3>See Also</h3>

<p>Other Table Transformers: 
<code>get_tt_param()</code>,
<code>tt_string_info()</code>,
<code>tt_summary_stats()</code>,
<code>tt_tbl_colnames()</code>,
<code>tt_tbl_dims()</code>,
<code>tt_time_slice()</code>
</p>


</div>