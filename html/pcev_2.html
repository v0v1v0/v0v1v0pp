<div class="container">

<table style="width: 100%;"><tr>
<td>computePCEV</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>Principal Component of Explained Variance</h2>

<h3>Description</h3>

<p><code>computePCEV</code> computes the first PCEV and tests its significance.
</p>


<h3>Usage</h3>

<pre><code class="language-R">computePCEV(response, covariate, confounder, estimation = c("all", "block",
  "singular"), inference = c("exact", "permutation"), index = "adaptive",
  shrink = FALSE, nperm = 1000, Wilks = FALSE)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>response</code></td>
<td>
<p>A matrix of response variables.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>covariate</code></td>
<td>
<p>An array or a data frame of covariates.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>confounder</code></td>
<td>
<p>An array or data frame of confounders.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>estimation</code></td>
<td>
<p>Character string specifying which estimation method to use: <code>"all"</code>, 
<code>"block"</code> or <code>"singular"</code>. Default value is <code>"all"</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>inference</code></td>
<td>
<p>Character string specifying which inference method to use: <code>"exact"</code> or 
<code>"permutation"</code>. Default value is <code>"exact"</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>index</code></td>
<td>
<p>Only used if <code>estimation = "block"</code>. Default value is <code>"adapative"</code>. See 
details.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>shrink</code></td>
<td>
<p>Should we use a shrinkage estimate of the residual variance? Default value is 
<code>FALSE</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>nperm</code></td>
<td>
<p>The number of permutations to perform if <code>inference = "permutation"</code> or for the
Tracy-Widom empirical estimate (if <code>estimation = "singular"</code>).</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>Wilks</code></td>
<td>
<p>Should we use a Wilks test instead of Roy's largest test? This is only implemented 
for a single covariate and with <code>estimation = "all"</code>.</p>
</td>
</tr>
</table>
<h3>Details</h3>

<p>This is the main function. It computes the PCEV using either the classical method, block approach
or singular. A p-value is also computed, testing the significance of the PCEV.
</p>
<p>The p-value is computed using either a permutation approach or an exact test. The implemented 
exact tests use Wilks' Lambda (only for a single covariate) or Roy's Largest Root. The latter 
uses Johnstone's approximation to the null distribution. Note that for the block approach, only 
p-values obtained from a permutation procedure are available.
</p>
<p>When <code>estimation = "singular"</code>, the p-value is computed using a heuristic: using the method 
of moments and a small number of permutations (i.e. 25), a location-scale family of the 
Tracy-Widom distribution of order 1 is fitted to the null distribution. This fitted distribution 
is then used to compute p-values.
</p>
<p>When <code>estimation = "block"</code>, there are three different ways of specifying the blocks: 1) if 
<code>index</code> is a vector of the same length as the number of columns in <code>response</code>, then it 
is used to match each response to a block. 2) If <code>index</code> is a single positive integer, it is
understood as the number of blocks, and each response is matched to a block randomly. 3) If 
<code>index = "adaptive"</code> (the default), the number of blocks is chosen so that there are about 
n/2 responses per block, and each response is match to a block randomly. All other values of 
<code>index</code> should result in an error.
</p>


<h3>Value</h3>

<p>An object of class <code>Pcev</code> containing the first PCEV, the p-value, the estimate of 
the shrinkage factor, etc.
</p>


<h3>See Also</h3>

<p><code>estimatePcev</code>
</p>


<h3>Examples</h3>

<pre><code class="language-R">set.seed(12345)
Y &lt;- matrix(rnorm(100*20), nrow=100)
X &lt;- rnorm(100)
pcev_out &lt;- computePCEV(Y, X)
pcev_out2 &lt;- computePCEV(Y, X, shrink = TRUE)
</code></pre>


</div>