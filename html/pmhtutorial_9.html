<div class="container">

<table style="width: 100%;"><tr>
<td>particleFilter</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>Fully-adapted particle filter for state estimate in a linear Gaussian state 
space model</h2>

<h3>Description</h3>

<p>Estimates the filtered state and the log-likelihood for a linear Gaussian 
state space model of the form <code class="reqn"> x_{t} = \phi x_{t-1} + \sigma_v v_t </code> 
and <code class="reqn"> y_t = x_t + \sigma_e e_t </code>, where <code class="reqn">v_t</code> and <code class="reqn">e_t</code> denote 
independent standard Gaussian random variables, i.e.<code class="reqn">N(0,1)</code>.
</p>


<h3>Usage</h3>

<pre><code class="language-R">particleFilter(y, theta, noParticles, initialState)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>y</code></td>
<td>
<p>Observations from the model for <code class="reqn">t=1,...,T</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>theta</code></td>
<td>
<p>The parameters <code class="reqn">\theta=\{\phi,\sigma_v,\sigma_e\}</code> of the 
LGSS model. The parameter <code class="reqn">\phi</code> scales the current state in 
the state dynamics. The standard deviations of the state process noise
and the observation process noise are denoted <code class="reqn">\sigma_v</code> and 
<code class="reqn">\sigma_e</code>, respectively.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>noParticles</code></td>
<td>
<p>The number of particles to use in the filter.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>initialState</code></td>
<td>
<p>The initial state.</p>
</td>
</tr>
</table>
<h3>Value</h3>

<p>The function returns a list with the elements:
</p>

<ul>
<li>
<p>xHatFiltered: The estimate of the filtered state at time <code class="reqn">t=1,...,T</code>.
</p>
</li>
<li>
<p>logLikelihood: The estimate of the log-likelihood.
</p>
</li>
<li>
<p>particles: The particle system at each time point.
</p>
</li>
<li>
<p>weights: The particle weights at each time point.
</p>
</li>
</ul>
<h3>Note</h3>

<p>See Section 3 in the reference for more details.
</p>


<h3>Author(s)</h3>

<p>Johan Dahlin <a href="mailto:uni@johandahlin.com">uni@johandahlin.com</a>
</p>


<h3>References</h3>

<p>Dahlin, J. &amp; Schon, T. B. "Getting Started with Particle 
Metropolis-Hastings for Inference in Nonlinear Dynamical Models." 
Journal of Statistical Software, Code Snippets,
88(2): 1â€“41, 2019.
</p>


<h3>Examples</h3>

<pre><code class="language-R"># Generates 500 observations from a linear state space model with
# (phi, sigma_e, sigma_v) = (0.5, 1.0, 0.1) and zero initial state.
theta &lt;- c(0.5, 1.0, 0.1)
d &lt;- generateData(theta, noObservations=500, initialState=0.0) 

# Estimate the filtered state using a Particle filter
pfOutput &lt;- particleFilter(d$y, theta, noParticles = 50, 
  initialState=0.0)

# Plot the estimate and the true state
par(mfrow=c(3, 1))
plot(d$x[1:500], type="l", xlab="time", ylab="true state", bty="n", 
  col="#1B9E77")
plot(pfOutput$xHatFiltered, type="l", xlab="time", 
  ylab="paticle filter estimate", bty="n", col="#D95F02")
plot(d$x[1:500]-pfOutput$xHatFiltered, type="l", xlab="time", 
  ylab="difference", bty="n", col="#7570B3")
</code></pre>


</div>