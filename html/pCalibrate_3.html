<div class="container">

<table style="width: 100%;"><tr>
<td>FCalibrate</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>
Calibration of two-sided p-values from the F-test in the linear model

</h2>

<h3>Description</h3>

<p>Transforms two-sided p-values from the F-test of overall significance in the linear model to sample-size adjusted lower bounds on the Bayes factor
for the point null hypothesis against the alternative.

</p>


<h3>Usage</h3>

<pre><code class="language-R">FCalibrate(p, n, d, alternative="chi.squared", intercept=TRUE, 
           transform="id")
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>p</code></td>
<td>
<p>a vector of two-sided p-values

</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>n</code></td>
<td>
<p>a scalar or a vector of positive integers. Specifies the sample size(s). May be a vector only if <code>d</code> is a scalar.

</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>d</code></td>
<td>
<p>a scalar or a vector of positive integers. 
Specifies the dimension(s) of the vector(s) of regression coefficients,
i.e. the number(s) of explanatory variables in the linear model(s).
May be a vector only if <code>n</code> is a scalar.


</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>alternative</code></td>
<td>
<p>either <code>"simple"</code> or <code>"chi.squared"</code>.
Defaults to <code>"chi.squared"</code>. <br>
Specifies the alternative hypotheses
on the non-centrality parameter of the 
F-distribution to consider.
<code>"simple"</code> only considers simple point alternative hypotheses.
<code>"chi.squared"</code> assumes a scaled chi-squared distribution.

</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>intercept</code></td>
<td>
<p>logical. If TRUE, the linear model contains an unknown intercept term,
otherwise the intercept is fixed. Defaults to TRUE.
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>transform</code></td>
<td>

<p>either <code>"id"</code>, <code>"log"</code>, <code>"log2"</code>  or <code>"log10"</code>.
Defaults to <code>"id"</code>.
Specifies how to transform the lower bound on the Bayes factor.
<code>"id"</code> corresponds to no transformation.
<code>"log"</code> refers to the natural logarithm, <code>"log2"</code> to the logarithm
to the base 2 and <code>"log10"</code> to the logarithm
to the base 10.
</p>
</td>
</tr>
</table>
<h3>Details</h3>

<p>Note that under the point null hypothesis that all regression coefficients are
equal to zero, the F-statistic <code class="reqn">F</code>
(which is the <code class="reqn">(1-p)</code>-quantile of the F-distribution with <code class="reqn">d</code> and <code class="reqn">n-d-1</code> degrees of freedom)
has a central F-distribution with <code class="reqn">d</code> and <code class="reqn">n-d-1</code> degrees of freedom
if the linear model contains an unknown intercept term
(otherwise <code class="reqn">F</code>
has a central F-distribution with <code class="reqn">d</code> and <code class="reqn">n-d</code> degrees of freedom).
Under a simple point alternative, 
F has a non-central F-distribution with <code class="reqn">d</code> and <code class="reqn">n-d-1</code> degrees of freedom. 
</p>
<p>To obtain the lower bound on the Bayes factor 
for <code>alternative="simple"</code>,
the likelihood under the alternative is then maximized numerically with respect to
the non-centrality parameter.
That calibration is described in Held &amp; Ott (2018), 
Section 3.1 (in the last two paragraphs).
</p>
<p>For <code>alternative="chi-squared"</code>, the calibration is proposed in Held &amp; Ott (2016), 
Section 3
and also described in Held &amp; Ott (2018), Section 3.2.
The corresponding minimum Bayes factor has already been derived in Johnson (2005).
As described there, assigning a scaled chi-sqaured distribution to the
non-centrality parameter of the F-distribution corresponds to
assigning a (multivariate) normal prior distribution 
centered around the null value to the vector of regression coefficients.
</p>


<h3>Value</h3>

<p>A matrix containing the lower bounds on the Bayes factors 
as entries,
for all combinations of p-value and sample size <code>n</code> or dimension <code>d</code>
(whichever is multidimensional).
The values for the k-th sample size or dimension (k-th entry in the vector <code>n</code> or <code>d</code>) and the different p-values
are given in the k-th row.
</p>


<h3>Note</h3>

<p>Computation may fail for <code>alternative="simple"</code> if the p-value <code>p</code> is extremely small
and min{n, n-d} is also small. Warnings will be given in this case and
the returned value is <code>minBF=NaN</code>.
</p>


<h3>References</h3>

<p>Held , L. and Ott, M. (2016). How the maximal evidence of P -values against point null hypotheses depends on sample size. <em>American Statistician</em>, <b>70</b>, 335–341
</p>
<p>Held, L. and Ott, M. (2018). On p-values and Bayes factors.
<em>Annual Review of Statistics and Its Application</em>, <b>5</b>, 393–419.
</p>
<p>Johnson, V. E. (2005). Bayes factors based on test statistics. 
<em>Journal of the Royal Statistical Society, Series B</em> <b>67</b>:689–701.

</p>


<h3>See Also</h3>

<p><code>tCalibrate</code> 


</p>


<h3>Examples</h3>

<pre><code class="language-R">FCalibrate(p=c(0.05, 0.01, 0.005), n=20, d=2, alternative="simple")
# chi-squared alternatives
FCalibrate(p=c(0.05, 0.01, 0.005), n=20, d=2, intercept=FALSE)
FCalibrate(p=c(0.05, 0.01, 0.005), n=20, d=c(2, 5, 10))
FCalibrate(p=c(0.05, 0.01, 0.005), n=c(10, 20, 50), d=2)

# plot for chi-squared alternatives: d=2 and different sample sizes n
# note that the minimum Bayes factor decreases with decreasing sample 
# size
p &lt;- exp(seq(log(0.0001), log(0.3), by=0.01))
n &lt;- c(5, 10, 20)
minBF &lt;- FCalibrate(p, n, d=2) 
# compare to the bound for large n
minTBF &lt;- LRCalibrate(p, df=2)
par(las=1)
matplot(p, t(minBF), ylim=c(0.0003, 1), type="l", 
        xlab="two-sided F-test p-value", ylab="Minimum Bayes factor", 
        log="xy", lty=1, lwd=2, axes=FALSE, 
        main="Local normal alternatives")
lines(p, minTBF, col="gray", lty=2, lwd=2)
axis(1, at=c(0.0001, 0.0003, 0.001, 0.003, 0.01, 0.03, 0.1, 0.3), 
     as.character(c(format(c(0.0001,0.0003), nsmall=4, digits=4, 
                           scientific=FALSE), 
                    c(0.001, 0.003, 0.01, 0.03, 0.1, 0.3))))
my.values &lt;- c(3000, 1000, 300, 100, 30, 10, 3, 1)
my.at &lt;- 1/my.values
my.ylegend &lt;- c(paste("1/", my.values[-length(my.values)], sep=""), 
                "1")
axis(2, at=my.at, my.ylegend)
box()
legend("bottomright", 
       legend=rev(c("n=5", "n=10", "n=20", "n large")), 
       col=rev(c(1:3, "gray")), lty=c(2, rep(1, times=3)), lwd=2)
</code></pre>


</div>