<div class="container">

<table style="width: 100%;"><tr>
<td>in_convex_hull</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>Check whether treated unit is in the convex hull of donors</h2>

<h3>Description</h3>

<p>This function finds out if the treated unit is in the convex hull
of the donor units.
</p>


<h3>Usage</h3>

<pre><code class="language-R">in_convex_hull(X1, X0, ...)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>X1</code></td>
<td>
<p><code style="white-space: pre;">⁠N_covars by 1 matrix⁠</code> of treated unit covariates</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>X0</code></td>
<td>
<p><code style="white-space: pre;">⁠N_covars by N_donors matrix⁠</code> of donor unit covariates</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>...</code></td>
<td>
<p>additional arguments passed to <code>clarabel::clarabel()</code></p>
</td>
</tr>
</table>
<h3>Details</h3>

<p>This function does not actually construct the convex hull (which
is infeasible in higher dimensions), but rather it checks whether
the following linear program has a feasible solution:
</p>
<p>min q'w s.t. Aw = b
</p>
<p>with w constrained to be above 0 and sum to 1, the feasibility
of this linear program directly corresponds to whether the treated
is in the convex hull
</p>
<p>When the treated unit very close to the boundary of the convex hull
this method usually cannot determine this exactly and this function
may return <code>NA</code> with the warning "Solver terminated due to lack of
progress"
</p>


<h3>Value</h3>

<p><code>bool</code> whether the treated unit is in the convex hull of
the donor units. <code>NA</code> if this cannot be determined. Vector if X1
has multiple columns.
</p>


<h3>Examples</h3>

<pre><code class="language-R"># create some data
set.seed(45)
X0 &lt;- matrix(runif(20), nrow = 2)
X1 &lt;- matrix(c(.5, .5))

# test if X1 is in the convex hull:
in_convex_hull(X1, X0)

# also works with multiple units in X1:
X1 &lt;- cbind(X1, c(1.3, -3))
in_convex_hull(X1, X0)
</code></pre>


</div>