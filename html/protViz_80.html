<div class="container">

<table style="width: 100%;"><tr>
<td>centroid</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>
Centroid a spectrum acquired in profile mode
</h2>

<h3>Description</h3>

<p>returns a centroid spectrum of a recorded profile mode spectrum.
</p>


<h3>Usage</h3>

<pre><code class="language-R">centroid(mZ, intensity, tolppm=100, debug=FALSE)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>mZ</code></td>
<td>
<p>Numerical vector of profile recorded data and sorted mZ values.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>intensity</code></td>
<td>
<p>corresponding intensity values.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>tolppm</code></td>
<td>
<p>maximal distance in Da between to profile mZ values. default is set to 100ppm.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>debug</code></td>
<td>
<p>if true all peak profiles are plotted. default is false.</p>
</td>
</tr>
</table>
<h3>Details</h3>

<p>the method is tested on an Orbitrap Fusion Lumos FSN20242 data set.
</p>


<h3>Value</h3>

<p>returns a <code>data.frame</code> with a mZ and a intensity column.
</p>


<h3>Note</h3>

<p>thanks to Nienke Meekel and Andrea Brunner (kwrwater.nl) and Witold E. Wolski.
</p>


<h3>Author(s)</h3>

<p>Christian Panse and Jonas Grossmann, April 2020
</p>


<h3>See Also</h3>


<ul>
<li>
<p><a href="https://github.com/lgatto/MSnbase/blob/2b6d6f5162e7464c39b48d0daa4d981c6ec30bbd/R/functions-Spectrum.R#L649">MSnbase functions-Spectrum.R</a>
</p>
</li>
<li>
<p><a href="https://proteowizard.sourceforge.io/">https://proteowizard.sourceforge.io/</a>
</p>
</li>
</ul>
<h3>Examples</h3>

<pre><code class="language-R">   # Orbitrap Fusion Lumos FSN20242 
   # p2722/.../.../stds_pos_neg_MS_highconc_UVPD_50_300.raw
   # scan 1959
   # CC(C)(C)C(O)C(OC1=CC=C(Cl)C=C1)N1C=NC=N1	1
   # exact.mass 295.1088
   # FTMS + p ESI d Full ms2 296.1162@uvpd50.00 

    p &lt;- protViz:::.getProfileMS2()
    
    # determine eps
    plot((diff(p$mZ)) ~ p$mZ[2:length(p$mZ)], log='y');
    abline(h=0.1, col='red')
    points(p$mZ , 1E-4 * p$mZ, col='grey', type='l')
    abline(v=296.1162, col='cyan')

    op &lt;- par(mfrow=c(2, 1))
    plot(p$mZ, p$intensity, type='h',
      main='profile', xlim=c(100,300))
    abline(v=296.1162, col='cyan')
    
    plot(centroid(p$mZ, p$intensity),type='h',
      main="centroid",xlim=c(100,300))
    par(op)
    
    
    op &lt;- par(mfrow=c(2, 1), ask = TRUE)
        rv &lt;- centroid(p$mZ, p$intensity, debug = TRUE)

</code></pre>


</div>