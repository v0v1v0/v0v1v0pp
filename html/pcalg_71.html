<div class="container">

<table style="width: 100%;"><tr>
<td>isValidGraph</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>
Check for a DAG, CPDAG or a maximally oriented PDAG

</h2>

<h3>Description</h3>

<p>Check whether the adjacency matrix <code>amat</code> matches the specified <code>type</code>.

</p>


<h3>Usage</h3>

<pre><code class="language-R">isValidGraph(amat, type = c("pdag", "cpdag", "dag"), verbose = FALSE)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>amat</code></td>
<td>

<p>adjacency matrix of type <code>amat.cpdag</code> (see <code>amatType</code>)
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>type</code></td>
<td>

<p>string specifying the type of graph of the adjacency matrix amat. It
can be a DAG (<code>type="dag"</code>), a CPDAG (<code>type="cpdag"</code>) or a
maximally oriented PDAG (<code>type="pdag"</code>) from Meek (1995). 
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>verbose</code></td>
<td>

<p>If TRUE, detailed output on why the graph might not be valid is provided.
</p>
</td>
</tr>
</table>
<h3>Details</h3>

<p>For a given adjacency matrix <code>amat</code> and graph <code>type</code>, this
function checks whether the two match. 
</p>
<p>For <code>type = "dag"</code> we require that <code>amat</code> does NOT contain
directed cycles. 
</p>
<p>For <code>type = "cpdag"</code> we require that <code>amat</code> does NOT contain
directed or partially directed cycles. We also require that the
undirected part of the CPDAG (represented by <code>amat</code>) is made up of
chordal components and that our graph is maximally oriented according to
rules from Meek (1995). 
</p>
<p>For <code>type = "pdag"</code> we require that <code>amat</code> does NOT contain
directed cycles. We also require that the PDAG is maximally oriented
according to rules from Meek (1995). Additionally, we require that the
adjacency matrix <code>amat1</code> of the CPDAG corresponding to our PDAG
(represented by <code>amat</code>), satisfies <code>isValidGraph(amat =
  amat1,type = "cpdag") == TRUE</code> and that there is no mismatch in the
orientations implied by <code>amat</code> and <code>amat1</code>. We obtain
<code>amat1</code> by extracting the skeleton and v-structures from
<code>amat</code> and then closing the orientation rules from Meek (1995). 
</p>


<h3>Value</h3>

<p>TRUE, if the adjacency matrix <code>amat</code> is of the <code>type</code> specified and FALSE, otherwise.
</p>


<h3>Author(s)</h3>

<p>Emilija Perkovic and Markus Kalisch
</p>


<h3>References</h3>

<p>C. Meek (1995). Causal inference and causal explanation with background knowledge, In Proceedings of UAI 1995, 403-410.
</p>


<h3>Examples</h3>

<pre><code class="language-R">## a -&gt; b -&gt; c
amat &lt;- matrix(c(0,1,0, 0,0,1, 0,0,0), 3,3)
colnames(amat) &lt;- rownames(amat) &lt;- letters[1:3]
## graph::plot(as(t(amat), "graphNEL"))             
isValidGraph(amat = amat, type = "dag") ## is a valid DAG
isValidGraph(amat = amat, type = "cpdag") ## not a valid CPDAG 
isValidGraph(amat = amat, type = "pdag") ## is a valid PDAG

## a -- b -- c
amat &lt;- matrix(c(0,1,0, 1,0,1, 0,1,0), 3,3)
colnames(amat) &lt;- rownames(amat) &lt;- letters[1:3]
## plot(as(t(amat), "graphNEL"))             
isValidGraph(amat = amat, type = "dag") ## not a valid DAG
isValidGraph(amat = amat, type = "cpdag") ## is a valid CPDAG
isValidGraph(amat = amat, type = "pdag") ## is a valid PDAG

## a -- b -- c -- d -- a
amat &lt;- matrix(c(0,1,0,1, 1,0,1,0, 0,1,0,1, 1,0,1,0), 4,4)
colnames(amat) &lt;- rownames(amat) &lt;- letters[1:4]
## plot(as(t(amat), "graphNEL"))             
isValidGraph(amat = amat, type = "dag") ## not a valid DAG
isValidGraph(amat = amat, type = "cpdag") ## not a valid CPDAG
isValidGraph(amat = amat, type = "pdag") ## not a valid PDAG
</code></pre>


</div>