<div class="container">

<table style="width: 100%;"><tr>
<td>Ancestors</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>tree utility function</h2>

<h3>Description</h3>

<p>Functions for describing relationships among phylogenetic nodes.
</p>


<h3>Usage</h3>

<pre><code class="language-R">Ancestors(x, node, type = c("all", "parent"))

allDescendants(x)

Children(x, node)

Descendants(x, node, type = c("tips", "children", "all"))

Siblings(x, node, include.self = FALSE)

mrca.phylo(x, node = NULL, full = FALSE)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>x</code></td>
<td>
<p>a tree (a phylo object).</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>node</code></td>
<td>
<p>an integer or character vector (or scalar) corresponding to a
node ID</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>type</code></td>
<td>
<p>specify whether to return just direct children / parents or all</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>include.self</code></td>
<td>
<p>whether to include self in list of siblings</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>full</code></td>
<td>
<p>a logical indicating whether to return the MRCAs among all tips
and nodes (if TRUE); the default is to return only the MRCAs among tips.</p>
</td>
</tr>
</table>
<h3>Details</h3>

<p>These functions are inspired by <code>treewalk</code> in phylobase package, but
work on the S3 <code>phylo</code> objects.  The nodes are the indices as given in
edge matrix of an phylo object. From taxon labels these indices can be
easily derived matching against the <code>tip.label</code> argument of an phylo
object, see example below.  All the functions allow <code>node</code> to be either
a scalar or vector.  <code>mrca</code> is a faster version of the mrca in ape, in
phangorn only because of dependencies.
If the argument node is missing the function is evaluated for all nodes.
</p>


<h3>Value</h3>

<p>a vector or a list containing the indices of the nodes.
</p>


<h3>Functions</h3>


<ul><li> <p><code>allDescendants()</code>: list all the descendant nodes of each node
</p>
</li></ul>
<h3>See Also</h3>

<p><code>treewalk</code>, <code>as.phylo</code>,
<code>nodelabels</code>
</p>


<h3>Examples</h3>

<pre><code class="language-R">
tree &lt;- rtree(10)
plot(tree, show.tip.label = FALSE)
nodelabels()
tiplabels()
Ancestors(tree, 1:3, "all")
Children(tree, 11)
Descendants(tree, 11, "tips")
Siblings(tree, 3)
# Siblings of all nodes
Siblings(tree)
mrca.phylo(tree, 1:3)
mrca.phylo(tree, match(c("t1", "t2", "t3"), tree$tip))
mrca.phylo(tree)
# same as mrca(tree), but faster for large trees

</code></pre>


</div>