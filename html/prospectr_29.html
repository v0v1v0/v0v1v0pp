<div class="container">

<table style="width: 100%;"><tr>
<td>naes</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>k-means sampling</h2>

<h3>Description</h3>

<p>Perform a k-means sampling on a matrix for multivariate calibration
</p>


<h3>Usage</h3>

<pre><code class="language-R">naes(X, k, pc, iter.max = 10, method = 0, .center = TRUE, .scale = FALSE)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>X</code></td>
<td>
<p>a numeric matrix (optionally a data frame that can
be coerced to a numerical matrix).</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>k</code></td>
<td>
<p>either the number of calibration samples to select or a set of
cluster centres to initiate the k-means clustering.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>pc</code></td>
<td>
<p>optional. If not specified, k-means is run directly on the variable
(Euclidean) space.
Alternatively, a PCA is performed before k-means and <code>pc</code> is the number of
principal components kept. If <code>pc &lt; 1</code>,the number of principal components
kept corresponds to the number of components explaining at least (<code>pc * 100</code>)
percent of the total variance.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>iter.max</code></td>
<td>
<p>maximum number of iterations allowed for the k-means
clustering. Default is <code>iter.max = 10</code> (see <code>?kmeans</code>).</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>method</code></td>
<td>
<p>the method used for selecting calibration samples within each
cluster: either samples closest to the cluster.
centers (<code>method = 0</code>, default), samples farthest away from the centre of the
data (<code>method = 1</code>) or
random selection (<code>method = 2</code>).</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>.center</code></td>
<td>
<p>logical value indicating whether the input matrix must be
centered before Principal Component Analysis. Default set to <code>TRUE</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>.scale</code></td>
<td>
<p>logical value indicating whether the input matrix must be
scaled before Principal Component Analysis. Default set to <code>FALSE</code>.</p>
</td>
</tr>
</table>
<h3>Details</h3>

<p>K-means sampling is a simple procedure based on cluster analysis to
select calibration samples from large multivariate datasets.
The method can be described in three points (Naes et al.,2001):
</p>

<ol>
<li>
<p> Perform a PCA and decide how many principal component to keep,
</p>
</li>
<li>
<p> Carry out a k-means clustering on the principal component scores and
choose the number of resulting clusters to be equal to
the number of desired calibration samples,
</p>
</li>
<li>
<p> Select one sample from each cluster.
</p>
</li>
</ol>
<h3>Value</h3>

<p>a list with components:
</p>

<ul>
<li>
<p>'<code>model</code>': numeric vector giving the row indices of the input data
selected for calibration
</p>
</li>
<li>
<p>'<code>test</code>': numeric vector giving the row indices of the remaining
observations
</p>
</li>
<li>
<p>'<code>pc</code>': if the <code>pc</code> argument is specified, a numeric matrix of the
scaled pc scores
</p>
</li>
<li>
<p>'<code>cluster</code>': integer vector indicating the cluster to which each
point was assigned
</p>
</li>
<li>
<p>'<code>centers</code>': a matrix of cluster centres
</p>
</li>
</ul>
<h3>Author(s)</h3>

<p>Antoine Stevens &amp; <a href="https://orcid.org/0000-0002-5369-5120">Leonardo Ramirez-Lopez</a>
</p>


<h3>References</h3>

<p>Naes, T., 1987. The design of calibration in near infra-red reflectance
analysis by clustering. Journal of Chemometrics 1, 121-134.
</p>
<p>Naes, T., Isaksson, T., Fearn, T., and Davies, T., 2002. A user friendly
guide to multivariate calibration and classification. NIR Publications,
Chichester, United Kingdom.
</p>


<h3>See Also</h3>

<p><code>kenStone</code>, <code>honigs</code>, <code>duplex</code>,
<code>shenkWest</code>
</p>


<h3>Examples</h3>

<pre><code class="language-R">data(NIRsoil)
sel &lt;- naes(NIRsoil$spc, k = 5, p = .99, method = 0)
# clusters
plot(sel$pc[, 1:2], col = sel$cluster + 2)
# points selected for calibration with method = 0
points(sel$pc[sel$model, 1:2],
  col = 2,
  pch = 19,
  cex = 1
)
# pre-defined centers can also be provided
sel2 &lt;- naes(NIRsoil$spc,
  k = sel$centers,
  p = .99, method = 1
)
# points selected for calibration with method = 1
points(sel$pc[sel2$model, 1:2],
  col = 1,
  pch = 15,
  cex = 1
)
</code></pre>


</div>