<div class="container">

<table style="width: 100%;"><tr>
<td>power.tsd</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>
Power calculation of adaptive 2-stage BE studies in a 2x2 crossover design
</h2>

<h3>Description</h3>

<p>This function calculates the ‘empiric’ power of 2-stage BE studies according
to Potvin <em>et al.</em> via simulations. The Potvin methods are modified to include
a futility criterion Nmax and to allow the sample size estimation step to be
done with the point estimate (<abbr><span class="acronym">PE</span></abbr>) and <abbr><span class="acronym">MSE</span></abbr> (calculated from CV)
of stage 1.
</p>


<h3>Usage</h3>

<pre><code class="language-R">power.tsd(method = c("B", "C", "B0"), alpha0 = 0.05, alpha = c(0.0294, 0.0294), 
          n1, GMR, CV, targetpower = 0.8, pmethod = c("nct", "exact", "shifted"),
          usePE = FALSE, Nmax = Inf, min.n2 = 0, theta0, theta1, theta2,
          npct = c(0.05, 0.5, 0.95), nsims, setseed = TRUE, details = FALSE)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>method</code></td>
<td>

<p>Decision schemes according to Potvin <em>et.al.</em> (defaults to <code style="white-space: pre;">⁠"B"⁠</code>).<br>
Potvin’s ‘Method D’ can be obtained by choosing <code style="white-space: pre;">⁠"C"⁠</code> but setting
<code style="white-space: pre;">⁠alpha=c(0.028, 0.028)⁠</code>.<br>
Montague’s ‘Method D’ can be obtained by choosing <code style="white-space: pre;">⁠"C"⁠</code> but setting
<code style="white-space: pre;">⁠alpha=c(0.028, 0.028)⁠</code> and <code style="white-space: pre;">⁠GMR=0.9⁠</code>.<br><code style="white-space: pre;">⁠method="B0"⁠</code> uses the decision scheme of Zheng <em>et al.</em> <abbr><span class="acronym">MSDBE</span></abbr>
(modified sequential design for <abbr><span class="acronym">B</span></abbr>E studies) which differs from B in case
of different alphas w.r.t. power monitoring and BE decision in case of power
&gt;= target power.
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>alpha0</code></td>
<td>

<p>Alpha value for the first step(s) in Potvin <code style="white-space: pre;">⁠"C"⁠</code>, the power inspection
and BE decision if power &gt; targetpower. Defaults to 0.05.<br>
Only observed if <code style="white-space: pre;">⁠method="C"⁠</code>.
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>alpha</code></td>
<td>

<p>Vector (two elements) of the nominal alphas for the two stages. Defaults to
Pocock’s setting <code style="white-space: pre;">⁠alpha=c(0.0294, 0.0294)⁠</code>.<br>
Common values together with other arguments are:<br><code style="white-space: pre;">⁠rep(0.0294, 2)⁠</code>: Potvin <em>et al.</em> ‘Method B’<br><code style="white-space: pre;">⁠rep(0.0269, 2)⁠</code>: Fulgsang ‘Method C/D’ <code style="white-space: pre;">⁠(method="C", GMR=0.9, targetpower=0.9)⁠</code><br><code style="white-space: pre;">⁠rep(0.0274, 2)⁠</code>: Fuglsang ‘Method C/D’ <code style="white-space: pre;">⁠(method="C", targetpower=0.9)⁠</code><br><code style="white-space: pre;">⁠rep(0.0280, 2)⁠</code>: Montague <em>et al.</em> ‘Method D’ <code style="white-space: pre;">⁠(method="C", GMR=0.9)⁠</code><br><code style="white-space: pre;">⁠rep(0.0284, 2)⁠</code>: Fulgsang ‘Method B’ <code style="white-space: pre;">⁠(GMR=0.9, targetpower=0.9)⁠</code><br><code style="white-space: pre;">⁠rep(0.0304, 2)⁠</code>: Kieser &amp; Rauch<br><code style="white-space: pre;">⁠c(0.01, 0.04)⁠</code>: Zheng <em>et al.</em> ‘MSDBE’ <code style="white-space: pre;">⁠(method="B0")⁠</code>
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>n1</code></td>
<td>

<p>Sample size of stage 1.
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>GMR</code></td>
<td>

<p>Ratio T/R to be used in decision scheme (power calculations in
stage 1 and sample size estimation for
stage 2).
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>CV</code></td>
<td>

<p>Coefficient of variation of the intra-subject variability
(use <em>e.g.</em>, 0.3 for 30%).
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>targetpower</code></td>
<td>

<p>Power threshold in the power monitoring steps and power to achieve
in the sample size estimation step.
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>pmethod</code></td>
<td>

<p>Power calculation method, also to be used in the sample size estimation for
stage 2.<br>
Implemented are <code style="white-space: pre;">⁠"nct"⁠</code> (approximate calculations via non-central
<em>t</em>-distribution, <code style="white-space: pre;">⁠"exact"⁠</code> (exact calculations via Owen’s Q),
and <code style="white-space: pre;">⁠"shifted"⁠</code> (approximate calculation via shifted central <em>t</em>-distribution
like in the paper of Potvin <em>et al.</em><br>
Defaults to <code style="white-space: pre;">⁠"nct"⁠</code> as a reasonable compromise between speed and
accuracy in the sample size estimation step.
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>usePE</code></td>
<td>

<p>If <code style="white-space: pre;">⁠TRUE⁠</code> the sample size estimation step is done with <abbr><span class="acronym">MSE</span></abbr>
<b>and</b> <abbr><span class="acronym">PE</span></abbr> of stage 1.<br>
Defaults to <code>FALSE</code> <em>i.e.</em>, the sample size is estimated with
<code style="white-space: pre;">⁠GMR⁠</code> and <abbr><span class="acronym">MSE</span></abbr> (calculated from <code style="white-space: pre;">⁠CV⁠</code>) of
stage 1 analogous to Potvin <em>et. al</em>.<br>
NB: The power inspection steps in the Potvin methods are always done with the
<code style="white-space: pre;">⁠GMR⁠</code> argument and <abbr><span class="acronym">MSE</span></abbr> (<code style="white-space: pre;">⁠CV⁠</code>) of
stage 1.
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>Nmax</code></td>
<td>

<p>Futility criterion. If set to a finite value, all studies simulated in which a
sample size <code style="white-space: pre;">⁠&gt;Nmax⁠</code> is obtained will be regarded as BE=FAIL.<br>
Set this argument to <code style="white-space: pre;">⁠Inf⁠</code>, the default, to work without that futility
criterion.
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>min.n2</code></td>
<td>

<p>Minimum sample size of stage 2. Defaults to zero.<br>
If the sample size estimation step gives <code style="white-space: pre;">⁠N &lt; n1+min.n2⁠</code> the sample size for
stage 2 will be forced to <code style="white-space: pre;">⁠min.n2⁠</code>,
<em>i.e.</em>, the total sample size to <code>n1+min.n2</code>.
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>theta0</code></td>
<td>

<p>True ratio of T/R for simulating. Defaults to the <code>GMR</code> argument if missing.
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>theta1</code></td>
<td>

<p>Lower bioequivalence limit. Defaults to 0.8.
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>theta2</code></td>
<td>

<p>Upper bioequivalence limit. Defaults to 1.25.
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>npct</code></td>
<td>

<p>Percentiles to be used for the presentation of the distribution of
<code style="white-space: pre;">⁠n(total)=n1+n2⁠</code>.<br>
Defaults to <code style="white-space: pre;">⁠c(0.05, 0.5, 0.95)⁠</code> to obtain the 5% and 95% percentiles
and the median.
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>nsims</code></td>
<td>

<p>Number of studies to simulate.<br>
If missing, <code style="white-space: pre;">⁠nsims⁠</code> is set to 1E+05 = 100,000 or to 1E+06 = 1 Mio if
estimating the empiric Type I Error (<code style="white-space: pre;">⁠'alpha'⁠</code>), <em>i.e.</em>, with <code style="white-space: pre;">⁠theta0⁠</code> at
the border or outside the acceptance range <code style="white-space: pre;">⁠theta1⁠</code> ... <code style="white-space: pre;">⁠theta2⁠</code>.
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>setseed</code></td>
<td>

<p>Simulations are dependent on the starting point of the (pseudo) random number
generator. To avoid differences in power for different runs a
<code>set.seed(1234567)</code> is issued if <code style="white-space: pre;">⁠setseed=TRUE⁠</code>, the default.<br>
Set this argument to <code style="white-space: pre;">⁠FALSE⁠</code> to view the variation in power between
different runs.
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>details</code></td>
<td>

<p>If set to <code style="white-space: pre;">⁠TRUE⁠</code> the function prints the results of time measurements
of the simulation steps. Defaults to <code style="white-space: pre;">⁠FALSE⁠</code>.
</p>
</td>
</tr>
</table>
<h3>Details</h3>

<p>The calculations follow in principle the simulations as described in Potvin
<em>et al</em>.<br>
The underlying subject data are assumed to be evaluated after log-transformation.
But instead of simulating subject data, the statistics pe1, mse1 and pe2, SS2 are
simulated via their associated distributions (normal and
χ<sup>2</sup> distributions).
</p>


<h3>Value</h3>

<p>Returns an object of class <code style="white-space: pre;">⁠"pwrtsd"⁠</code> with all the input arguments and results
as components.<br>
The class <code style="white-space: pre;">⁠"pwrtsd"⁠</code>" has an S3 print method.<br>
The results are in the components:
</p>
<table>
<tr style="vertical-align: top;">
<td><code>pBE</code></td>
<td>
<p>Fraction of studies found BE.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>pBE_s1</code></td>
<td>
<p>Fraction of studies found BE in stage 1.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>pct_s2</code></td>
<td>
<p>Percentage of studies continuing to stage 2.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>nmean</code></td>
<td>
<p>Mean of n(total), aka average total sample size (<abbr><span class="acronym">ASN</span></abbr>).</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>nrange</code></td>
<td>
<p>Range (min, max) of n(total).</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>nperc</code></td>
<td>
<p>Vector of percentiles of the distribution of n(total).</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>ntable</code></td>
<td>
<p>Object of class <code style="white-space: pre;">⁠"table"⁠</code> summarizing the discrete distribution of
n(total) via its distinct values and counts of occurences of these values.<br>
This component is only given back if <code style="white-space: pre;">⁠usePE==FALSE⁠</code> or otherwise if
<code style="white-space: pre;">⁠is.finite(Nmax)⁠</code>, <em>i.e.</em>, a futility criterion is used.</p>
</td>
</tr>
</table>
<h3>Author(s)</h3>

<p>D. Labes
</p>


<h3>References</h3>

<p>Potvin D, DiLiberti CE, Hauck WW, Parr AF, Schuirmann DJ, Smith RA. <em>Sequential design approaches for bioequivalence studies with crossover designs.</em><br>
Pharm Stat. 2008; 7(4):245–62. doi: <a href="https://doi.org/10.1002/pst.294">10.1002/pst.294</a>
</p>
<p>Montague TH, Potvin D, DiLiberti CE, Hauck WW, Parr AF, Schuirmann DJ. <em>Additional results for ‘Sequential design approaches for bioequivalence studies with crossover designs’.</em><br>
Pharm Stat. 2011; 11(1):8–13. doi: <a href="https://doi.org/10.1002/pst.483">10.1002/pst.483</a>
</p>
<p>Fuglsang A. <em>Controlling type I errors for two-stage bioequivalence study designs.</em><br>
Clin Res Reg Aff. 2011; 28(4):100–5. doi: <a href="https://doi.org/10.3109/10601333.2011.631547">10.3109/10601333.2011.631547</a>
</p>
<p>Fuglsang A. <em>Sequential Bioequivalence Trial Designs with Increased Power and
Controlled Type I Error Rates.</em><br>
AAPS J. 2013; 15(3):659–61. doi: <a href="https://doi.org/10.1208/s12248-013-9475-5">10.1208/s12248-013-9475-5</a>
</p>
<p>Fuglsang A. <em>Futility Rules in Bioequivalence Trials with Sequential Designs.</em><br>
AAPS J. 2014; 16(1):79–82. doi: <a href="https://doi.org/10.1208/s12248-013-9540-0">10.1208/s12248-013-9540-0</a>
</p>
<p>Schütz H. <em>Two-stage designs in bioequivalence trials.</em><br>
Eur J Clin Pharmacol. 2015; 71(3):271–81. doi: <a href="https://doi.org/10.1007/s00228-015-1806-2">10.1007/s00228-015-1806-2</a>
</p>
<p>Kieser M, Rauch G. <em>Two-stage designs for cross-over bioequivalence trials.</em><br>
Stat Med. 2015; 34(16):2403–16. doi: <a href="https://doi.org/10.1002/sim.6487">10.1002/sim.6487</a>
</p>
<p>Zheng Ch, Zhao L, Wang J. <em>Modifications of sequential designs in bioequivalence trials.</em><br>
Pharm Stat. 2015; 14(3):180–8. doi: <a href="https://doi.org/10.1002/pst.1672">10.1002/pst.1672</a>
</p>


<h3>See Also</h3>

<p><code>power.tsd.p</code> for analogous calculations for 2-group parallel
design.<br><code>power.tsd.fC</code> for analogous calculations with futility check
based on point estimate of stage 1.
</p>


<h3>Examples</h3>

<pre><code class="language-R"># using all the defaults and 24 subjects in stage 1, CV of 25%
power.tsd(n1=24, CV=0.25)
# computation time ~ 1 sec
#
# as above, but save results for further use
res &lt;- power.tsd(n1=24, CV=0.25)
## Not run: 
# representation of the discrete distribution of n(total)
# via plot method of object with class "table" which creates a
# 'needle' plot
plot(res$ntable/sum(res$ntable), ylab="Density",
     xlab=expression("n"[total]), las=1,
     main=expression("Distribution of n"[total]))
#
# If you prefer a histogram instead (IMHO, not the preferred plot):
# reconstruct the ntotal values from the ntable
ntot &lt;- rep.int(as.integer(names(res$ntable)),
                times=as.integer(res$ntable))
# annotated histogram
hist(ntot, freq=FALSE, breaks=res$nrange[2]-res$nrange[1],
     xlab=expression("n"[total]), las=1,
     main=expression("Histogram of n"[total]))
abline(v=c(res$nmean, res$nperc[["50%"]]), lty=c(1, 3))
legend("topright", box.lty=0, legend=c("mean", "median"),
       lty=c(1, 3), cex=0.9)
## End(Not run)
</code></pre>


</div>