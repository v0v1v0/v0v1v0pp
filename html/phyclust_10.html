<div class="container">

<table style="width: 100%;"><tr>
<td>.EMControl</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>EM Control Generator</h2>

<h3>Description</h3>

<p>Generate an EM control (<code>.EMC</code>) controlling the options,
methods, conditions and models of EM algorithms.
As <code>.EMC</code>, this function generate a default template.
One can either modify <code>.EMC</code> or employ this function to
control EM algorithms.
</p>


<h3>Usage</h3>

<pre><code class="language-R">.EMControl(exhaust.iter = 1, fixed.iter = 5,
    short.iter = 100, EM.iter = 1000,
    short.eps = 1e-2, EM.eps = 1e-6,
    cm.reltol = 1e-8, cm.maxit = 5000,
    nm.abstol.Mu.given.QA = 1e-8, nm.reltol.Mu.given.QA = 1e-8,
    nm.maxit.Mu.given.QA = 500,
    nm.abstol.QA.given.Mu = 1e-8, nm.reltol.QA.given.Mu = 1e-8,
    nm.maxit.QA.given.Mu = 5000,
    est.non.seg.site = FALSE, max.init.iter = 50,
    init.procedure = .init.procedure[1],
    init.method = .init.method[1],
    substitution.model = .substitution.model$model[1],
    edist.model = .edist.model[1], identifier = .identifier[1],
    code.type = .code.type[1], em.method = .em.method[1],
    boundary.method = .boundary.method[1], min.n.class = 1,
    se.type = FALSE, se.model = .se.model[1], se.constant = 1e-2)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>exhaust.iter</code></td>
<td>
<p>number of iterations for "exhaustEM", default = 1.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>fixed.iter</code></td>
<td>
<p>number of iterations for "RndpEM", default = 5.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>short.iter</code></td>
<td>
<p>number of short-EM steps, default = 100.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>EM.iter</code></td>
<td>
<p>number of long-EM steps, default = 1000.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>short.eps</code></td>
<td>
<p>tolerance of short-EM steps, default = 1e-2.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>EM.eps</code></td>
<td>
<p>tolerance of long-EM steps, default = 1e-6.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>cm.reltol</code></td>
<td>
<p>relative tolerance for a CM step, default = 1e-8</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>cm.maxit</code></td>
<td>
<p>maximum number iteration for a CM step, default = 5000.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>nm.abstol.Mu.given.QA</code></td>
<td>
<p>see ‘Details’, default = 1e-8</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>nm.reltol.Mu.given.QA</code></td>
<td>
<p>see ‘Details’, default = 1e-8</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>nm.maxit.Mu.given.QA</code></td>
<td>
<p>see ‘Details’, default = 500.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>nm.abstol.QA.given.Mu</code></td>
<td>
<p>see ‘Details’, default = 1e-8</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>nm.reltol.QA.given.Mu</code></td>
<td>
<p>see ‘Details’, default = 1e-8</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>nm.maxit.QA.given.Mu</code></td>
<td>
<p> see ‘Details’, default = 5000.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>est.non.seg.site</code></td>
<td>
<p>estimate non-segregation sites, default = FALSE.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>max.init.iter</code></td>
<td>
<p>maximum number of initialization iteration, default = 50.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>init.procedure</code></td>
<td>
<p>initialization procedure, default = "exhaustEM".</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>init.method</code></td>
<td>
<p>initialization method, default = "randomMu".</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>substitution.model</code></td>
<td>
<p>substitution model, default = "JC69".</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>edist.model</code></td>
<td>
<p>evolution distance, default = <code>D_J69</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>identifier</code></td>
<td>
<p>identifier, default = "EE".</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>code.type</code></td>
<td>
<p>code type, default = "NUCLEOTIDE".</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>em.method</code></td>
<td>
<p>EM method, default = "EM".</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>boundary.method</code></td>
<td>
<p>boundary method, default = <code>ADJUST</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>min.n.class</code></td>
<td>
<p>minimum number of sequences in a cluster, default = 1.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>se.type</code></td>
<td>
<p>sequencing error type, default = FALSE.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>se.model</code></td>
<td>
<p>sequencing error model, default = "CONVOLUTION".</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>se.constant</code></td>
<td>
<p>constrained constant, default = 1e-2.</p>
</td>
</tr>
</table>
<h3>Details</h3>

<p><code>exhaust.iter</code>, <code>fixed.iter</code>, <code>short.iter</code>, and
<code>short.eps</code> are used to control the iterations of initialization
procedures and methods.
</p>
<p><code>EM.iter</code> and <code>EM.eps</code> are used to control the EM iterations.
</p>
<p><code>cm.reltol</code> and <code>cm.maxit</code> are used to control the ECM
iterations.
</p>
<p>Arguments starting with <code>nm.</code> are options for the Nelder-Mead
method as in <code>optim</code>. The C codes of Nelder-Mead are modified
from the R math library and the options are all followed.
<code>abstol</code> and <code>reltol</code> are for absolute and relative tolerances. 
<code>Mu.given.QA</code> is for maximizing the profile function of
<code class="reqn">\mu_k</code> given <code class="reqn">Q_k</code>, and
<code>QA.given.Mu</code> is for maximizing the profile function of
<code class="reqn">Q_k</code> given <code class="reqn">\mu_k</code>.
</p>
<p><code>est.non.seg.site</code> indicates whether to estimate the states of
center sequences. If FALSE, the states will be fixed as the
non segregating sites. Usually, there is no need to estimate.
</p>
<p><code>max.init.iter</code> is for certain initialization methods, e.g.
<code>randomNJ</code> and <code>K-Medoids</code> need few tries to obtain an
appropriate initial state.
</p>
<p><code>init.procedure</code> and <code>init.method</code> are for initializations.
</p>
<p><code>min.n.class</code> is the minimum number of sequences in a cluster to
avoid bad initialization state and degenerated clusters.
</p>
<p><code>se.type</code>, <code>se.model</code>, and <code>se.constant</code> which are used only
for sequencing error models and only for nucleotide data without labels.
</p>


<h3>Value</h3>

<p>This function returns a list as <code>.EMC</code>. 
</p>
<p>The sequencing error controls are stored in
<code>se.type</code>, <code>se.model</code>, and <code>se.constant</code>, for
sequencing error type, model, and constrained constant of errors,
respectively.
</p>


<h3>Author(s)</h3>

<p>Wei-Chen Chen <a href="mailto:wccsnow@gmail.com">wccsnow@gmail.com</a>
</p>


<h3>References</h3>

<p>Phylogenetic Clustering Website:
<a href="https://snoweye.github.io/phyclust/">https://snoweye.github.io/phyclust/</a>
</p>


<h3>See Also</h3>

<p><code>.show.option</code>,
<code>.EMC</code>,
<code>.boundary.method</code>,
<code>.code.type</code>,
<code>.edist.model</code>,
<code>.em.method</code>,
<code>.identifier</code>,
<code>.init.method</code>,
<code>.init.procedure</code>,
<code>.substitution.model</code>,
<code>optim</code>,
<code>phyclust</code>,
<code>phyclust.se</code>.
</p>


<h3>Examples</h3>

<pre><code class="language-R">## Not run: 
library(phyclust, quiet = TRUE)

# The same as .EMC
.EMControl()

# Except code.type, all others are the same as .EMC
.EMControl(code.type = "SNP")
.EMControl(code.type = .code.type[2])

## End(Not run)
</code></pre>


</div>