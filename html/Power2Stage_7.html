<div class="container">

<table style="width: 100%;"><tr>
<td>power.tsd.GS</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>
Power calculation for non-adaptive group sequential (2-stage) BE studies
</h2>

<h3>Description</h3>

<p>This function calculates the ‘empiric’ power of group sequential
2-stage <abbr><span class="acronym">BE</span></abbr> in 2×2 crossover designs via simulations.<br>
The number of subjects in both stages has to be prespecified (non-adaptive).
</p>


<h3>Usage</h3>

<pre><code class="language-R">power.tsd.GS(alpha = c(0.0294, 0.0294), n, CV, theta0, theta1, theta2,
             fCrit = c("CI", "PE"), fClower, fCupper, nsims, setseed = TRUE,
             details = FALSE)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>alpha</code></td>
<td>

<p>Vector of the two nominal alpha values to be used in the
100(1–2α)
confidence interval calculations in the two stages.<br>
Use something like package <code style="white-space: pre;">⁠ldbounds⁠</code> for choosing the nominal alphas.
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>n</code></td>
<td>

<p>Vector of the two sample sizes in stage 1
and stage 2. <code style="white-space: pre;">⁠n(total)⁠</code> is <code style="white-space: pre;">⁠n[1]+n[2]⁠</code>
if a second stage is necessary. Otherwise it is <code style="white-space: pre;">⁠n[1]⁠</code>.
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>CV</code></td>
<td>

<p>Coefficient of variation of the intra-subject variability
(use <em>e.g.</em>, 0.3 for 30%).
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>theta0</code></td>
<td>

<p>Assumed ratio of geometric means (T/R) for simulations. If missing,
defaults to 0.95.
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>theta1</code></td>
<td>

<p>Lower bioequivalence limit. Defaults to 0.80.
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>theta2</code></td>
<td>

<p>Upper bioequivalence limit. Defaults to 1.25.
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>fCrit</code></td>
<td>

<p>Futility criterion.<br>
If set to <code style="white-space: pre;">⁠"PE"⁠</code> the study stops after
stage 1 if not <abbr><span class="acronym">BE</span></abbr> and if the point
estimate (<abbr><span class="acronym">PE</span></abbr>) of stage 1 evaluation
is outside the range defined in the next two  arguments <code style="white-space: pre;">⁠"fClower"⁠</code> and
<code style="white-space: pre;">⁠"fCupper"⁠</code>.<br>
If set to <code style="white-space: pre;">⁠"CI"⁠</code> the study stops after stage 1
if not <abbr><span class="acronym">BE</span></abbr> and if the 90% confidence interval of
stage 1 evaluation is outside the range
defined in the next two arguments.<br>
Defaults to <code style="white-space: pre;">⁠"CI"⁠</code>.
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>fClower</code></td>
<td>

<p>Lower limit of the futility criterion. Defaults to <code style="white-space: pre;">⁠0⁠</code> if missing,
<em>i.e.</em>, no futility criterion.
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>fCupper</code></td>
<td>

<p>Upper limit of the futility criterion. Defaults to <code style="white-space: pre;">⁠1/fClower⁠</code> if missing.
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>nsims</code></td>
<td>

<p>Number of studies to simulate.<br>
If missing, <code style="white-space: pre;">⁠nsims⁠</code> is set to 1E+05 = 100,000 or to 1E+06 = 1 Mio if
estimating the empiric Type I Error (<code style="white-space: pre;">⁠'alpha'⁠</code>), <em>i.e.</em>, with <code style="white-space: pre;">⁠theta0⁠</code>
at the border or outside the acceptance range <code style="white-space: pre;">⁠theta1⁠</code> ... <code style="white-space: pre;">⁠theta2⁠</code>.
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>setseed</code></td>
<td>

<p>Simulations are dependent on the starting point of the (pseudo) random number
generator. To avoid differences in power for different runs a
<code>set.seed(1234567)</code> is issued if <code style="white-space: pre;">⁠setseed=TRUE⁠</code>, the default.<br>
Set this argument to <code style="white-space: pre;">⁠FALSE⁠</code> to view the variation in power between
different runs.
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>details</code></td>
<td>

<p>If set to <code style="white-space: pre;">⁠TRUE⁠</code> the function prints the results of time measurements
of the simulation steps. Defaults to <code style="white-space: pre;">⁠FALSE⁠</code>.
</p>
</td>
</tr>
</table>
<h3>Details</h3>

<p>The calculations follow in principle the simulations as described in Potvin
<em>et al.</em> for adaptive designs, but with no interim power inspection and
pre-specified (fixed) number of subjects in stage 2.<br>
The underlying subject data are assumed to be evaluated after log-transformation.
But instead of simulating subject data, the statistics pe1, mse1 and pe2, SS2 are
simulated via their associated distributions (normal and
χ<sup>2</sup> distributions).
</p>


<h3>Value</h3>

<p>Returns an object of class <code style="white-space: pre;">⁠"pwrtsd"⁠</code> with all the input arguments and results
as components.<br>
The class <code style="white-space: pre;">⁠"pwrtsd"⁠</code> has a S3 print method.<br>
The results are in the components:
</p>
<table>
<tr style="vertical-align: top;">
<td><code>pBE</code></td>
<td>
<p>Fraction of studies found BE.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>pBE_s1</code></td>
<td>
<p>Fraction of studies found BE in stage 1.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>pct_s2</code></td>
<td>
<p>Percentage of studies continuing to stage 2.</p>
</td>
</tr>
</table>
<h3>Note</h3>

<p>The code is reasonable fast. 1E6 sims take ~ 1 sec on my machine.
Even 1E7 sims are meanwhile possible without too much beer. :-)<br><br></p>


<h3>Author(s)</h3>

<p>D. Labes
</p>


<h3>References</h3>

<p>Gould AL. <em>Group sequential extensions of a standard bioequivalence testing procedure.</em><br>
J Pharmacokin Biopharm. 1995; 23(1):57–86 doi: <a href="https://doi.org/10.1007/BF02353786">10.1007/BF02353786</a>
</p>
<p>Patterson SD, Jones B. <em>Bioequivalence and Statistics in Clinical Pharmacology.</em><br>
Boca Raton: CRC Press; 2<sup>nd</sup> edition 2016. Chapter 5.6 Optional Designs.
</p>
<p>Schütz H. <em>Two-stage designs in bioequivalence trials.</em><br>
Eur J Clin Pharmacol. 2015; 71(3):271–81. doi: <a href="https://doi.org/10.1007/s00228-015-1806-2">10.1007/s00228-015-1806-2</a>
</p>
<p>Kieser M, Rauch G. <em>Two-stage designs for cross-over bioequivalence trials.</em><br>
Stat Med. 2015; 34(16):2403–16. doi: <a href="https://doi.org/10.1002/sim.6487">10.1002/sim.6487</a>
</p>
<p>Zheng Ch, Zhao L, Wang J. <em>Modifications of sequential designs in bioequivalence trials.</em><br>
Pharm Stat. 2015; 14(3):180–8. doi: <a href="https://doi.org/10.1002/pst.1672">10.1002/pst.1672</a>
</p>


<h3>See Also</h3>

<p><code>power.tsd</code> and <code>power.tsd.p</code> for adaptive sequential designs.
</p>


<h3>Examples</h3>

<pre><code class="language-R"># using the Pocock alpha settings and no futility rule
# (defaults), a CV of 20% and 12 subjects in both stages,
# midway interim
power.tsd.GS(CV=0.2, n=c(12,12))
</code></pre>


</div>