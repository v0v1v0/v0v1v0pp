<div class="container">

<table style="width: 100%;"><tr>
<td>haploNet</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>Haplotype Networks</h2>

<h3>Description</h3>

<p><code>haploNet</code> computes a haplotype network. There is a plot method
and two conversion functions towards other packages.
</p>


<h3>Usage</h3>

<pre><code class="language-R">haploNet(h, d = NULL, getProb = TRUE)
## S3 method for class 'haploNet'
print(x, ...)
## S3 method for class 'haploNet'
plot(x, size = 1, col, bg, col.link, lwd, lty,
     shape = "circles", pie = NULL, labels, font, cex, col.lab, scale.ratio,
     asp = 1, legend = FALSE, fast = FALSE, show.mutation,
     threshold = c(1, 2), xy = NULL, ...)
## S3 method for class 'haploNet'
as.network(x, directed = FALSE, altlinks = TRUE, ...)
## S3 method for class 'haploNet'
as.igraph(x, directed = FALSE, use.labels = TRUE,
        altlinks = TRUE, ...)
## S3 method for class 'haploNet'
as.phylo(x, quiet, ...)
## S3 method for class 'haploNet'
as.evonet(x, ...)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>h</code></td>
<td>
<p>an object of class <code>"haplotype"</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>d</code></td>
<td>
<p>an object giving the distances among haplotypes (see
details).</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>getProb</code></td>
<td>
<p>a logical specifying whether to calculate Templeton's
probabilities (see details).</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>x</code></td>
<td>
<p>an object of class <code>"haploNet"</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>size</code></td>
<td>
<p>a numeric vector giving the diameter of the circles
representing the haplotypes: this is in the same unit than the links
and eventually recycled.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>col</code></td>
<td>
<p>a character vector specifying the colours of the circles;
eventually recycled.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>bg</code></td>
<td>
<p>a character vector (or a function) specifying either the
colours of the background of the symbols (if <code>pie = NULL</code>), or
the colours of the slices of the pies (could be a function);
eventually recycled.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>col.link</code></td>
<td>
<p>a character vector specifying the colours of the links;
eventually recycled.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>lwd</code></td>
<td>
<p>a numeric vector giving the width of the links; eventually
recycled.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>lty</code></td>
<td>
<p>idem for the line types.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>shape</code></td>
<td>
<p>the symbol shape used for the haplotypes (eventually
recycled): <code>"circles"</code>, <code>"squares"</code>, <code>"diamonds"</code>
(can be abbreviated).</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>pie</code></td>
<td>
<p>a matrix used to draw pie charts for each haplotype; its
number of rows must be equal to the number of haplotypes.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>labels</code></td>
<td>
<p>a logical specifying whether to identify the haplotypes
with their labels (the default).</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>font</code></td>
<td>
<p>the font used for these labels (bold by default); must be
an integer between 1 and 4.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>cex</code></td>
<td>
<p>a numerical specifying the character expansion of the
labels.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>col.lab</code></td>
<td>
<p>the color of the labels.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>scale.ratio</code></td>
<td>
<p>the ratio of the scale of the links representing
the number of steps on the scale of the circles representing the
haplotypes. It may be needed to give a value greater than one to
avoid overlapping circles.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>asp</code></td>
<td>
<p>the aspect ratio of the plot. Do not change the default
unless you want to distort your network.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>legend</code></td>
<td>
<p>a logical specifying whether to draw the legend, or a
vector of length two giving the coordinates where to draw the
legend; <code>FALSE</code> by default. If <code>TRUE</code>, the user is asked
to click where to draw the legend.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>fast</code></td>
<td>
<p>a logical specifying whether to optimize the spacing of
the circles; <code>FALSE</code> by default.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>show.mutation</code></td>
<td>
<p>an integer value: if 0, nothing is drawn on the
links; if 1, the mutations are shown with small segments on the
links; if 2, they are shown with small dots; if 3, the number of
mutations are printed on the links.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>threshold</code></td>
<td>
<p>a numeric vector with two values (or 0) giving the
lower and upper numbers of mutations for alternative links to be
displayed. If <code>threshold = 0</code>, alternative links are not drawn
at all.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>directed</code></td>
<td>
<p>a logical specifying whether the network is directed
(<code>FALSE</code> by default).</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>use.labels</code></td>
<td>
<p>a logical specifying whether to use the original
labels in the returned network.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>altlinks</code></td>
<td>
<p>whether to output the alternative links when
converting to another class; <code>TRUE</code> by default.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>quiet</code></td>
<td>
<p>whether to give a warning when reticulations are dropped
when converting a network into a tree.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>xy</code></td>
<td>
<p>the coordinates of the nodes (see <code>replot</code>).</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>...</code></td>
<td>
<p>further arguments passed to <code>plot</code>.</p>
</td>
</tr>
</table>
<h3>Details</h3>

<p>By default, the haplotype network is built using an infinite site
model (i.e., uncorrected or Hamming distance) of DNA sequences and
pairwise deletion of missing data (see <code>dist.dna</code>).
Users may specify their own distance with the argument <code>d</code>. There
is no check of labels, so the user must make sure that the distances
are ordered in the same way than the haplotypes.
</p>
<p>The probabilities calculated with Templeton et al.'s (1992) method may
give non-finite values with very divergent sequences, resulting in an
error from <code>haploNet</code>. If this happens, it may be better to use
<code>getProb = FALSE</code>.
</p>
<p>If two haplotypes are very different, <code>haploNet</code> will likely fail
(error during integration due to non-finite values).
</p>


<h3>Value</h3>

<p><code>haploNet</code> returns an object of class <code>"haploNet"</code> which is
a matrix where each row represents a link in the network, the first
and second columns give the numbers of the linked haplotypes, the
third column, named <code>"step"</code>, gives the number of steps in this
link, and the fourth column, named <code>"Prob"</code>, gives the
probability of a parsimonious link as given by Templeton et
al. (1992). There are three additional attributes: <code>"freq"</code>, the
absolute frequencies of each haplotype, <code>"labels"</code>, their labels,
and <code>"alter.links"</code>, the alternative links of the network.
</p>
<p><code>as.network</code> and <code>as.igraph</code> return objects of the
appropriate class.
</p>


<h3>Note</h3>

<p>Plotting haplotype networks is a difficult task. There is a vignette
in <span class="pkg">pegas</span> (see <code>vignette("PlotHaploNet")</code>) giving some
information on this isseu. You may also see two posts on r-sig-genetics
(July 2022) that give some tricks in the situation when one haplotype
is abundant and the others are in low frequencies (the symbols are
likely to overlap a lot by default):
</p>
<p><a href="https://stat.ethz.ch/pipermail/r-sig-genetics/2022-July/000237.html">https://stat.ethz.ch/pipermail/r-sig-genetics/2022-July/000237.html</a>
</p>
<p><a href="https://stat.ethz.ch/pipermail/r-sig-genetics/2022-July/000238.html">https://stat.ethz.ch/pipermail/r-sig-genetics/2022-July/000238.html</a>
</p>
<p>The first post explains how to use the package <span class="pkg">network</span> in
combination with <span class="pkg">pegas</span>, and the second one gives a trick that
works with <span class="pkg">pegas</span> only for a similar result.
</p>


<h3>Author(s)</h3>

<p>Emmanuel Paradis, Klaus Schliep</p>


<h3>References</h3>

<p>Templeton, A. R., Crandall, K. A. and Sing, C. F. (1992) A cladistic
analysis of phenotypic association with haplotypes inferred from
restriction endonuclease mapping and DNA sequence data. III. Cladogram
estimation. <em>Genetics</em>, <b>132</b>, 619â€“635.
</p>


<h3>See Also</h3>

<p><code>haplotype</code>, <code>haploFreq</code>, <code>replot</code>,
<code>diffHaplo</code>, <code>mst</code>, <code>mjn</code>
</p>


<h3>Examples</h3>

<pre><code class="language-R">## generate some artificial data from 'woodmouse':
data(woodmouse)
x &lt;- woodmouse[sample(15, size = 110, replace = TRUE), ]
h &lt;- haplotype(x)
(net &lt;- haploNet(h))
plot(net)
## symbol sizes equal to haplotype sizes:
plot(net, size = attr(net, "freq"), fast = TRUE)
plot(net, size = attr(net, "freq"))
plot(net, size = attr(net, "freq"), scale.ratio = 2, cex = 0.8)
</code></pre>


</div>