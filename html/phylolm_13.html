<div class="container">

<table style="width: 100%;"><tr>
<td>mace</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>
Multi-task learning for ancestral state estimation.
</h2>

<h3>Description</h3>

<p>Estimate the ancestral states of multiple traits simultaneously using a regularized maximum likelihood objective.
</p>


<h3>Usage</h3>

<pre><code class="language-R">mace(trait, phy, lambda = NULL)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>trait</code></td>
<td>
<p>a matrix of trait values. Each row is one species and each column is a trait.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>phy</code></td>
<td>
<p>a phylogenetic tree of type phylo with branch lengths.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>lambda</code></td>
<td>
<p>regularizer parameter.</p>
</td>
</tr>
</table>
<h3>Details</h3>

<p>Traits are assumed to evolve according to the Brownian motion model.
</p>


<h3>Value</h3>

<p>a numeric vector of estimated ancestral states.
</p>


<h3>Note</h3>

<p>The default choice for <code>lambda</code> was proposed by Ho et al. (2019).
</p>


<h3>Author(s)</h3>

<p>Lam Si Tung Ho
</p>


<h3>References</h3>

<p>Ho, Lam Si Tung, Vu Dinh, and Cuong V. Nguyen. "Multi-task learning improves ancestral state reconstruction." Theoretical Population Biology 126 (2019): 33-39.
</p>


<h3>Examples</h3>

<pre><code class="language-R">m = 3
anc = c(0, 8, 16)
sig2 = c(1, 1, 2)
tree = rtree(50)

trait = rTrait(n = 1, phy = tree, model = "BM",
               parameters=list(ancestral.state = anc[1], sigma2 = sig2[1]))
for (i in 2:m) {
  trait = cbind(trait,rTrait(n = 1, phy = tree, model = "BM",
                             parameters=list(ancestral.state = anc[i], sigma2 = sig2[i])))
}
res = mace(trait, tree)
print(res)

</code></pre>


</div>