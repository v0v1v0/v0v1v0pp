<div class="container">

<table style="width: 100%;"><tr>
<td>ptwgrid</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>Calculate RMS or WCC values on a grid</h2>

<h3>Description</h3>

<p>Calculates values of the chosen optimization criterion (RMS
or WCC) on a grid defined by the coefficients of the warping
function.</p>


<h3>Usage</h3>

<pre><code class="language-R">ptwgrid(ref, samp, selected.traces,
	coef.mins, coef.maxs, coef.lengths, 
	optim.crit = c("WCC", "RMS"), 
	smooth.param = 1e05, 
	trwdth = 20)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>ref</code></td>
<td>
<p>reference. Either a vector (containing one reference
signal) or a matrix (one reference per row). If
more than one reference is specified, the number of reference
signals must equal the number of sample signals</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>samp</code></td>
<td>
<p>sample. A vector (containing one sample signal) or a
matrix (one sample per row). If
more than one sample is specified, the number of sample
signals must equal the number of reference signals</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>selected.traces</code></td>
<td>
<p>optional vector containing the row numbers to
use from <code>ref</code> (if more than one reference signal is specified)
and <code>samp</code></p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>coef.mins</code></td>
<td>
<p>a vector containing the respective minimal values 
of coefficients for the grid. The first number is the minimal 
zeroth-order coefficient (i.e., a constant shift); further numbers 
indicate the minimal linear, quadratic, ... stretches </p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>coef.maxs</code></td>
<td>
<p>a vector containing the maximal values of 
coefficients for the grid</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>coef.lengths</code></td>
<td>
<p>a vector of the same length as coef.maxs and 
coef.mins containing the number of steps in which to vary the 
respective coefficients between their minimum and maximum value</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>optim.crit</code></td>
<td>
<p>either <code>"WCC"</code> or <code>"RMS"</code>. In both cases,
the optimal value of the alignment leads to a value of 0. For "WCC",
this means that <code>1 - WCC</code> is optimized rather than <code>WCC</code>
(where the optimal value equals 1)</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>smooth.param</code></td>
<td>
<p>smoothing parameter for smoothing the reference
and sample when <code>optim.crit</code> equals <code>"RMS"</code>. If no
smoothing is required, set this to 0</p>
</td>
</tr>
</table>
<p>.
</p>
<table><tr style="vertical-align: top;">
<td><code>trwdth</code></td>
<td>
<p>the width of the triangle in the WCC criterion during
the optimization, given as a number of data points. Default: 20</p>
</td>
</tr></table>
<h3>Details</h3>

<p>In contrast to ptw, only the three situations leading to one 
warping function are distinguished here:
</p>

<ol>
<li>
<p> One sample and one reference;
</p>
</li>
<li>
<p> Several samples, warped to an equal number of references
(pair-wise);
</p>
</li>
<li>
<p> Several samples, warped to a single reference.
</p>
</li>
</ol>
<p>Which situation is applicable is determined from the dimensions of 
<code>ref</code> and <code>samp</code>.
</p>


<h3>Value</h3>

<p>An array of dimension <code>length(coef.mins)</code> and maximal indices 
per dimension specified by <code>coef.lengths</code></p>


<h3>Author(s)</h3>

<p>Tom Bloemberg, Jan Gerretzen, Ron Wehrens</p>


<h3>See Also</h3>

<p><code>ptw</code>
</p>


<h3>Examples</h3>

<pre><code class="language-R">  ## Not run: 
  data(gaschrom)
  mygrid &lt;- ptwgrid(gaschrom[1,], gaschrom[16,],
                    coef.mins = c(-10, .9), coef.max = c(10, 1.1),
                    coef.lengths = c(21, 21))
  image(seq(-10, 10, length = 21),
        seq(.9, 1.1, length = 21),
        mygrid)

## End(Not run)
</code></pre>


</div>