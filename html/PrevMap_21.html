<div class="container">

<table style="width: 100%;"><tr>
<td>glgm.LA</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>Maximum Likelihood estimation for generalised linear geostatistical models via the Laplace approximation</h2>

<h3>Description</h3>

<p>This function performs the Laplace method for maximum likelihood estimation of a generalised linear geostatistical model.
</p>


<h3>Usage</h3>

<pre><code class="language-R">glgm.LA(
  formula,
  units.m = NULL,
  coords,
  times = NULL,
  data,
  ID.coords = NULL,
  kappa,
  kappa.t = 0.5,
  fixed.rel.nugget = NULL,
  start.cov.pars,
  method = "nlminb",
  messages = TRUE,
  family,
  return.covariance = TRUE
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>formula</code></td>
<td>
<p>an object of class <code>formula</code> (or one that can be coerced to that class): a symbolic description of the model to be fitted.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>units.m</code></td>
<td>
<p>an object of class <code>formula</code> indicating the binomial denominators in the data.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>coords</code></td>
<td>
<p>an object of class <code>formula</code> indicating the spatial coordinates in the data.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>times</code></td>
<td>
<p>an object of class <code>formula</code> indicating the times in the data, used in the spatio-temporal model.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>data</code></td>
<td>
<p>a data frame containing the variables in the model.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>ID.coords</code></td>
<td>
<p>vector of ID values for the unique set of spatial coordinates obtained from <code>create.ID.coords</code>. These must be provided if, for example, spatial random effects are defined at household level but some of the covariates are at individual level. <b>Warning</b>: the household coordinates must all be distinct otherwise see <code>jitterDupCoords</code>. Default is <code>NULL</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>kappa</code></td>
<td>
<p>fixed value for the shape parameter of the Matern covariance function.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>kappa.t</code></td>
<td>
<p>fixed value for the shape parameter of the Matern covariance function in the separable double-Matern spatio-temporal model.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>fixed.rel.nugget</code></td>
<td>
<p>fixed value for the relative variance of the nugget effect; <code>fixed.rel.nugget=NULL</code> if this should be included in the estimation. Default is <code>fixed.rel.nugget=NULL</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>start.cov.pars</code></td>
<td>
<p>a vector of length two with elements corresponding to the starting values of <code>phi</code> and the relative variance of the nugget effect <code>nu2</code>, respectively, that are used in the optimization algorithm. If <code>nu2</code> is fixed through <code>fixed.rel.nugget</code>, then <code>start.cov.pars</code> represents the starting value for <code>phi</code> only.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>method</code></td>
<td>
<p>method of optimization. If <code>method="BFGS"</code> then the <code>maxBFGS</code> function is used; otherwise <code>method="nlminb"</code> to use the <code>nlminb</code> function. Default is <code>method="BFGS"</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>messages</code></td>
<td>
<p>logical; if <code>messages=TRUE</code> then status messages are printed on the screen (or output device) while the function is running. Default is <code>messages=TRUE</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>family</code></td>
<td>
<p>character, indicating the conditional distribution of the outcome. This should be <code>"Gaussian"</code>, <code>"Binomial"</code> or <code>"Poisson"</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>return.covariance</code></td>
<td>
<p>logical; if <code>return.covariance=TRUE</code> then a numerical estimation of the covariance function for the model parameters is returned. Default is <code>return.covariance=TRUE</code>.</p>
</td>
</tr>
</table>
<h3>Details</h3>

<p>This function performs parameter estimation for a generealized linear geostatistical model. Conditionally on a zero-mean stationary Gaussian process <code class="reqn">S(x)</code> and mutually independent zero-mean Gaussian variables <code class="reqn">Z</code> with variance <code>tau2</code>, the observations <code>y</code> are generated from a GLM
with link function <code class="reqn">g(.)</code> and linear predictor
</p>
<p style="text-align: center;"><code class="reqn">\eta = d'\beta + S(x) + Z,</code>
</p>

<p>where <code class="reqn">d</code> is a vector of covariates with associated regression coefficients <code class="reqn">\beta</code>. The Gaussian process <code class="reqn">S(x)</code> has isotropic Matern covariance function (see <code>matern</code>) with variance <code>sigma2</code>, scale parameter <code>phi</code> and shape parameter <code>kappa</code>.
The shape parameter is treated as fixed. The relative variance of the nugget effect, <code>nu2=tau2/sigma2</code>, can also be fixed through the argument <code>fixed.rel.nugget</code>; if <code>fixed.rel.nugget=NULL</code>, then the relative variance of the nugget effect is also included in the estimation.
</p>
<p><b>Laplace Approximation</b>
The Laplace approximation (LA) method uses a second-order Taylor expansion of the integrand expressing the likelihood function. The resulting approximation of the likelihood is then maximized by a numerical optimization as defined through the argument <code>method</code>.
</p>
<p><b>Using a two-level model to include household-level and individual-level information.</b>
When analysing data from household sruveys, some of the avilable information information might be at household-level (e.g. material of house, temperature) and some at individual-level (e.g. age, gender). In this case, the Gaussian spatial process <code class="reqn">S(x)</code> and the nugget effect <code class="reqn">Z</code> are defined at hosuehold-level in order to account for extra-binomial variation between and within households, respectively.
</p>


<h3>Value</h3>

<p>An object of class "PrevMap".
The function <code>summary.PrevMap</code> is used to print a summary of the fitted model.
The object is a list with the following components:
</p>
<p><code>estimate</code>: estimates of the model parameters; use the function <code>coef.PrevMap</code> to obtain estimates of covariance parameters on the original scale.
</p>
<p><code>covariance</code>: covariance matrix of the MCML estimates.
</p>
<p><code>log.lik</code>: maximum value of the log-likelihood.
</p>
<p><code>y</code>: binomial observations.
</p>
<p><code>units.m</code>: binomial denominators.
</p>
<p><code>D</code>: matrix of covariates.
</p>
<p><code>coords</code>: matrix of the observed sampling locations.
</p>
<p><code>times</code>: vector of the time points used in a spatio-temporal model.
</p>
<p><code>method</code>: method of optimization used.
</p>
<p><code>ID.coords</code>: set of ID values defined through the argument <code>ID.coords</code>.
</p>
<p><code>kappa</code>: fixed value of the shape parameter of the Matern function.
</p>
<p><code>kappa.t</code>: fixed value for the shape parameter of the Matern covariance function in the separable double-Matern spatio-temporal model.
</p>
<p><code>fixed.rel.nugget</code>: fixed value for the relative variance of the nugget effect.
</p>
<p><code>call</code>: the matched call.
</p>


<h3>Author(s)</h3>

<p>Emanuele Giorgi <a href="mailto:e.giorgi@lancaster.ac.uk">e.giorgi@lancaster.ac.uk</a>
</p>
<p>Peter J. Diggle <a href="mailto:p.diggle@lancaster.ac.uk">p.diggle@lancaster.ac.uk</a>
</p>


<h3>References</h3>

<p>Diggle, P.J., Giorgi, E. (2019). <em>Model-based Geostatistics for Global Public Health.</em> CRC/Chapman &amp; Hall.
</p>
<p>Giorgi, E., Diggle, P.J. (2017). <em>PrevMap: an R package for prevalence mapping.</em> Journal of Statistical Software. 78(8), 1-29. doi: 10.18637/jss.v078.i08
</p>
<p>Christensen, O. F. (2004). <em>Monte carlo maximum likelihood in model-based geostatistics.</em> Journal of Computational and Graphical Statistics 13, 702-718.
</p>
<p>Higdon, D. (1998). <em>A process-convolution approach to modeling temperatures in the North Atlantic Ocean.</em> Environmental and Ecological Statistics 5, 173-190.
</p>


<h3>See Also</h3>

<p><code>Laplace.sampling</code>, <code>Laplace.sampling.lr</code>, <code>summary.PrevMap</code>, <code>coef.PrevMap</code>, <code>matern</code>, <code>matern.kernel</code>,  <code>control.mcmc.MCML</code>, <code>create.ID.coords</code>.
</p>


</div>