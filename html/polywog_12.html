<div class="container">

<table style="width: 100%;"><tr>
<td>predVals</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>Easy computation of fitted values</h2>

<h3>Description</h3>

<p>User-friendly generation of fitted values and their confidence intervals
from models of class <code>"polywog"</code>, using the "observed-value approach"
advocated by Hanmer and Kalkan (2013).
</p>


<h3>Usage</h3>

<pre><code class="language-R">predVals(model, xvars, data = model$model, xlims = list(), n = 100,
  interval = TRUE, level = 0.95, maxrows = 10000, report = FALSE,
  .parallel = FALSE, ...)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>model</code></td>
<td>
<p>a fitted model of class <code>"polywog"</code>, typically the output
of <code>polywog</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>xvars</code></td>
<td>
<p>a character vector containing names of raw input variables
(from <code>model$varNames</code>).  Partial matches are allowed.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>data</code></td>
<td>
<p>data frame to treat as the observed sample (defaults to the
data used to fit the supplied model)</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>xlims</code></td>
<td>
<p>named list of limits for the evaluation grid for each
continuous variable in <code>xvars</code>.  If not given, the variable's observed
range is used.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>n</code></td>
<td>
<p>number of grid points at which to evaluate each continuous variable
in <code>xvars</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>interval</code></td>
<td>
<p>logical: whether to compute bootstrap confidence intervals
for each fitted value.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>level</code></td>
<td>
<p>confidence level for the intervals.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>maxrows</code></td>
<td>
<p>maximum number of rows of output.  Used to prevent accidental
memory overruns when <code>xvars</code> contains more than two continuous
variables.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>report</code></td>
<td>
<p>logical: whether to print a status bar.  Not available if
<code>.parallel = TRUE</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>.parallel</code></td>
<td>
<p>logical: whether to perform bootstrap iterations in
parallel using <code>foreach</code>.  See the "Details" section of
the <code>bootPolywog</code> documentation page for more on parallel
computation.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>...</code></td>
<td>
<p>other arguments, currently ignored</p>
</td>
</tr>
</table>
<h3>Details</h3>

<p><code>predVals</code> allows users to examine the estimated effects of input
variables on the expected outcome using the coefficients returned by
<code>polywog</code>.  The procedure is designed so that, for a preliminary
analysis, the user can simply specify the fitted model and the independent
variable of interest, and quickly obtain predicted values.
</p>
<p>The predicted values are generated according to Hanmer and Kalkan's (2013)
observed-value approach, which takes the form of a nested loop.  When
<code>xvars</code> contains a single variable <code class="reqn">X_m</code>, the procedure is as
follows:
</p>

<ol><li>
<p> For each level <code class="reqn">x</code> of <code class="reqn">X_m</code> in <code>data</code> (if <code class="reqn">X_m</code>
is discrete) or each element <code class="reqn">x</code> of a grid over the range of <code class="reqn">X_m</code>
in <code>data</code> (if <code class="reqn">X_m</code> is continuous):
</p>

<ol>
<li>
<p> For each observation <code class="reqn">i</code> of <code>data</code>:
</p>

<ol>
<li>
<p> Set <code class="reqn">X_{mi} = x</code>, while holding all other variables
<code class="reqn">X_{-mi}</code> at their observed levels
</p>
</li>
<li>
<p> Compute the predicted value of <code class="reqn">Y_i</code> for the modified
observation <code class="reqn">i</code>, using the estimated model coefficients (as in
<code>predict.polywog</code>)
</p>
</li>
</ol>
</li>
<li>
<p> The predicted value of <code class="reqn">Y</code> given <code class="reqn">X_m = x</code> is the average of
the predictions computed in the previous step
</p>
</li>
</ol>
</li></ol>
<p>This observed-value approach provides a better estimate of population
average effects for nonlinear models than does the traditional approach,
which is to vary <code class="reqn">X_m</code> across its levels/range while holding each
other covariate to its mean or median in <code>data</code> (Hanmer and Kalkan
2013).
</p>
<p>When <code>xvars</code> consists of multiple variables <code class="reqn">X_1, \ldots,
X_M</code>, the <code>predVals</code> procedure is the same, except the
outer loop is over every <em>combination</em> of their levels in
<code>data</code>.
</p>
<p>All confidence intervals are generated via the bootstrap.  Specifically,
<code>predVals</code> repeats the above procedure for each set of bootstrap
coefficients and computes order statistics of the resulting set of
averages (for each combination of levels of <code>xvars</code>).  If
<code>model</code> does not have a <code>boot.matrix</code> element (see
<code>bootPolywog</code>), confidence intervals will not be computed.
</p>


<h3>Value</h3>

<p>A data frame containing the fitted values and confidence intervals
(if requested) for each combination of covariate values.
</p>
<p>The returned data frame also inherits from class <code>"preplot.polywog"</code>.
This is used by <code>plot.polywog</code>, which calls <code>predVals</code> to
compute the values to plot.
</p>


<h3>Author(s)</h3>

<p>Brenton Kenkel and Curtis S. Signorino
</p>


<h3>References</h3>

<p>Michael J. Hanmer and Kerem Ozan Kalkan.  2013.  "Behind the Curve:
Clarifying the Best Approach to Calculating Predicted Probabilities and
Marginal Effects from Limited Dependent Variable Models."  <em>American
Journal of Political Science</em> 57(1):263â€“277.
</p>


<h3>See Also</h3>

<p><code>predict.polywog</code> for more flexible (but less
user-friendly) computation of fitted values.  <code>plot.polywog</code> for
plotting fitted values and their confidence intervals.
</p>


<h3>Examples</h3>

<pre><code class="language-R">## Using occupational prestige data
data(Prestige, package = "carData")
Prestige &lt;- transform(Prestige, income = income / 1000)

## Fit a polywog model with bootstrap iterations
## (note: using low convergence threshold to shorten computation time of the
## example, *not* recommended in practice!)
set.seed(22)
fit1 &lt;- polywog(prestige ~ education + income + type,
                data = Prestige,
                degree = 2,
                boot = 5,
                thresh = 1e-4)

## Predicted prestige across occupational categories
predVals(fit1, "type")

## Predicted prestige by education
predVals(fit1, "education", n = 10)

## Plotting
pred_income &lt;- predVals(fit1, "income", n = 10)
plot(pred_income)
</code></pre>


</div>