<div class="container">

<table style="width: 100%;"><tr>
<td>axis_geo</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>Add an axis with a geological timescale</h2>

<h3>Description</h3>

<p><code>axis_geo</code> behaves similarly to <code>axis</code> in that it
adds an axis to the specified side of a base R plot. The main difference is
that it also adds a geological timescale between the plot and the axis. The
default scale includes international epochs from the the Geological Timescale
2020 (<code>GTS2020</code>). However, international stages, periods, eras,
and eons are also available. Interval data hosted by
<a href="https://macrostrat.org">Macrostrat</a> are also available (see
<code>time_bins</code>). A custom interval dataset can also be used (see
Details below). The appearance of the axis is highly customisable (see Usage
below), with the intent that plots will be publication-ready.
</p>


<h3>Usage</h3>

<pre><code class="language-R">axis_geo(
  side = 1,
  intervals = "epoch",
  height = 0.05,
  fill = NULL,
  lab = TRUE,
  lab_col = NULL,
  lab_size = 1,
  rot = 0,
  abbr = TRUE,
  center_end_labels = TRUE,
  skip = c("Quaternary", "Holocene", "Late Pleistocene"),
  bord_col = "black",
  lty = par("lty"),
  lwd = par("lwd"),
  bkgd = "grey90",
  neg = FALSE,
  exact = FALSE,
  round = FALSE,
  tick_at = NULL,
  tick_labels = TRUE,
  phylo = FALSE,
  root.time = NULL,
  ...
)

axis_geo_phylo(...)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>side</code></td>
<td>
<p><code>integer</code>. Which side to add the axis to (<code>1</code>: bottom,
the default; <code>2</code>: left; <code>3</code>: top; <code>4</code>: right).</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>intervals</code></td>
<td>
<p>The interval information to use to plot the axis: either A)
a <code>character</code> string indicating a rank of intervals from the built-in
<code>GTS2020</code>, B) a <code>character</code> string indicating a
<code>data.frame</code> hosted by <a href="https://macrostrat.org">Macrostrat</a> (see
<code>time_bins</code>), or C) a custom <code>data.frame</code> of time interval
boundaries (see Details). A list of strings or data.frames can be supplied
to add multiple time scales to the same side of the plot (see Details).</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>height</code></td>
<td>
<p><code>numeric</code>. The relative height (or width if <code>side</code> is
<code>2</code> or <code>4</code>) of the scale. This is relative to the height (if
<code>side</code> is <code>1</code> or <code>3</code>) or width (if <code>side</code> is <code>2</code>
or <code>4</code>) of the plot.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>fill</code></td>
<td>
<p><code>character</code>. The fill colour of the boxes. The default is to
use the <code>colour</code> or <code>color</code> column included in <code>intervals</code>.
If a custom dataset is provided with <code>intervals</code> without a
<code>colour</code> or <code>color</code> column and without specifying <code>fill</code>, a
greyscale will be used. Custom fill colours can be provided with this
option (overriding the <code>colour</code> or <code>color</code> column) and will be
recycled if/as necessary.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>lab</code></td>
<td>
<p><code>logical</code>. Should interval labels be included?</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>lab_col</code></td>
<td>
<p><code>character</code>. The colour of the labels. The default is to
use the <code>font</code> or <code>lab_color</code> column included in
<code>intervals</code>. If a custom dataset is provided with <code>intervals</code>
without a <code>font</code> or <code>lab_color</code> column and without
specifying <code>lab_col</code>, all labels will be black. Custom label colours
can be provided with this option (overriding the <code>font</code> or
<code>lab_color</code> column) and will be recycled if/as necessary.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>lab_size</code></td>
<td>
<p><code>numeric</code>. The size of the labels (see <code>cex</code> in
<code>graphics parameters</code>).</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>rot</code></td>
<td>
<p><code>numeric</code>. The amount of counter-clockwise rotation to add to
the labels (in degrees). Note, labels for axes added to the left or right
sides are already rotated 90 degrees.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>abbr</code></td>
<td>
<p><code>logical</code>. Should labels be abbreviated? This only works
if the data has an <code>abbr</code> column, otherwise the <code>name</code> column
will be used regardless of this setting.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>center_end_labels</code></td>
<td>
<p><code>logical</code>. Should labels be centered within the
visible range of intervals at the ends of the axis?</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>skip</code></td>
<td>
<p>A <code>character</code> vector of interval names indicating which
intervals should not be labeled. If <code>abbr</code> is <code>TRUE</code>, this can
also include interval abbreviations. Quaternary, Holocene, and Late
Pleistocene are skipped by default. Set to NULL if this is not desired.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>bord_col</code></td>
<td>
<p><code>character</code>. The border colour of the interval boxes.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>lty</code></td>
<td>
<p><code>character</code>. Line type (see <code>lty</code> in
<code>graphics parameters</code>). This value (or the last
value if this is a list) will also be passed to
<code>axis</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>lwd</code></td>
<td>
<p><code>numeric</code>. Line width (see <code>lwd</code> in
<code>graphics parameters</code>).</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>bkgd</code></td>
<td>
<p><code>character</code>. The colour of the background of the scale
when no intervals are being shown.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>neg</code></td>
<td>
<p><code>logical</code>. Set this to <code>TRUE</code> if your x-axis is using
negative values. If the entire axis is already negative, this will be set
to <code>TRUE</code> for you.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>exact</code></td>
<td>
<p><code>logical</code>. Set this to <code>TRUE</code> if you want axis tick
marks and numeric tick labels placed at the interval boundaries. If
<code>TRUE</code>, this overrides <code>tick_at</code> and <code>tick_labels</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>round</code></td>
<td>
<p><code>integer</code>. Number of decimal places to which exact axis
labels should be rounded (using <code>round</code>). If no value is
specified, the exact values will be used. Trailing zeros are always
removed. <code>tick_at</code> and <code>tick_labels</code> can be used to include
labels with trailing zeros.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>tick_at</code></td>
<td>
<p>A <code>numeric</code> vector specifying custom points at which tick
marks are to be drawn on the axis. If specified, this is passed directly to
<code>axis</code>. If <code>phylo</code> is <code>TRUE</code>, these values
are converted as necessary for the phylogenetic axis limits. If this is set
to <code>NULL</code> (the default) tick mark locations are computed automatically
(see <code>axTicks</code>).</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>tick_labels</code></td>
<td>
<p>Either a) a <code>logical</code> value specifying whether
(numerical) annotations should be made at the tick marks specified by
<code>tick_at</code>, or b) a custom <code>character</code> or <code>expression</code> vector
of labels to be placed at the tick marks. If <code>tick_at</code> is specified,
this argument is passed directly to <code>axis</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>phylo</code></td>
<td>
<p><code>logical</code>. Is the base plot a phylogeny generated by
<code>plot.phylo</code>, <code>plotTree</code>,
<code>plotSimmap</code>, etc?</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>root.time</code></td>
<td>
<p><code>numeric</code>. If <code>phylo</code> is <code>TRUE</code>, this is the
time assigned to the root node of the tree. By default, this is taken from
the <code>root.time</code> element of the plotted tree.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>...</code></td>
<td>
<p>Further arguments that are passed directly to
<code>axis</code>.</p>
</td>
</tr>
</table>
<h3>Details</h3>

<p>If a custom <code>data.frame</code> is provided (with <code>intervals</code>), it should
consist of at least 3 columns of data. See <code>GTS2020</code> for an
example.
</p>

<ul>
<li>
<p> The <code>interval_name</code> column (<code>name</code> is also allowed) lists
the names of each time interval. These will be used as labels if no
abbreviations are provided.
</p>
</li>
<li>
<p> The <code>max_ma</code> column (<code>max_age</code> is also allowed) lists the
oldest boundary of each time interval. Values should always be
positive.
</p>
</li>
<li>
<p> The <code>min_ma</code> column (<code>min_age</code> is also allowed) lists the
youngest boundary of each time interval. Values should always be
positive.
</p>
</li>
<li>
<p> The <code>abbr</code> column is optional and lists abbreviations that may
be used as labels.
</p>
</li>
<li>
<p> The <code>colour</code> column (<code>color</code> is also allowed) is also
optional and lists a colour for the background for each time interval
(see the Color Specification section
<code>here</code>).
</p>
</li>
<li>
<p> The <code>font</code> (<code>lab_color</code> is also allowed) column is
also optional and lists a colour for the label for each time interval
(see the Color Specification section
<code>here</code>).
</p>
</li>
</ul>
<p><code>intervals</code> may also be a list if multiple time scales should be added
to a single side of the plot. In this case, <code>height</code>, <code>fill</code>,
<code>lab</code>, <code>lab_col</code>, <code>lab_size</code>, <code>rot</code>, <code>abbr</code>,
<code>center_end_labels</code>, <code>skip</code>, <code>bord_col</code>, <code>lty</code>, and
<code>lwd</code> can also be lists. If these lists are not as long as
<code>intervals</code>, the elements will be recycled. If individual values
(or vectors, e.g. for <code>skip</code>) are used for these parameters, they will
be applied to all time scales (and recycled as necessary). If multiple scales
are requested they will be added sequentially outwards starting from the plot
border. The axis will always be placed on the outside of the last scale.
</p>
<p>If you would like to use intervals from the Geological Time Scale 2012
(<code>GTS2012</code>), you can use <code>time_bins</code> and supply the
returned <code>data.frame</code> to the <code>intervals</code> argument.
</p>
<p><code>axis_geo_phylo(...)</code> is shorthand for
<code>axis_geo(..., phylo = TRUE)</code>.
</p>


<h3>Value</h3>

<p>No return value. Function is used for its side effect, which is to
add an axis of the geological timescale to an already existing plot.
</p>


<h3>Authors</h3>

<p>William Gearty &amp; Kilian Eichenseer
</p>


<h3>Reviewer</h3>

<p>Lewis A. Jones
</p>


<h3>Examples</h3>

<pre><code class="language-R"># track user par
oldpar &lt;- par(no.readonly = TRUE)
# single scale on bottom
par(mar = c(6.1, 4.1, 4.1, 2.1)) # modify margin
plot(0:100, axes = FALSE, xlim = c(100, 0), ylim = c(100, 0),
     xlab = NA, ylab = "Depth (m)")
box()
axis(2)
axis_geo(side = 1, intervals = "period")
# the line argument here depends on the absolute size of the plot
title(xlab = "Time (Ma)", line = 4)

# stack multiple scales, abbreviate only one set of labels
par(mar = c(7.1, 4.1, 4.1, 2.1)) # further expand bottom margin
plot(0:100, axes = FALSE, xlim = c(100, 0), ylim = c(100, 0),
     xlab = NA, ylab = "Depth (m)")
box()
axis(2)
axis_geo(side = 1, intervals = list("epoch", "period"),
    abbr = list(TRUE, FALSE))
# the line argument here depends on the absolute size of the plot
title(xlab = "Time (Ma)", line = 6)

# scale with MacroStrat intervals
par(mar = c(6.1, 4.1, 4.1, 2.1)) # modify margin
plot(0:30, axes = FALSE, xlim = c(30, 0), ylim = c(30, 0),
     xlab = NA, ylab = "Depth (m)")
box()
axis(2)
axis_geo(side = 1, intervals = "North American land mammal ages")
# the line argument here depends on the absolute size of the plot
title(xlab = "Time (Ma)", line = 4)

# scale with custom intervals
intervals &lt;- data.frame(min_ma = c(0, 10, 25, 32),
                        max_ma = c(10, 25, 32, 40),
                        interval_name = c("A", "B", "C", "D"))
par(mar = c(6.1, 4.1, 4.1, 2.1)) # modify margin
plot(0:40, axes = FALSE, xlim = c(40, 0), ylim = c(40, 0),
     xlab = NA, ylab = "Depth (m)")
box()
axis(2)
axis_geo(side = 1, intervals = intervals)
# the line argument here depends on the absolute size of the plot
title(xlab = "Time (Ma)", line = 4)


# scale with phylogeny
library(phytools)
data(mammal.tree)
plot(mammal.tree)
axis_geo_phylo()
title(xlab = "Time (Ma)", line = 4)


# scale with fossil phylogeny
library(paleotree)
data(RaiaCopesRule)
plot(ceratopsianTreeRaia)
axis_geo_phylo()
title(xlab = "Time (Ma)", line = 4)

# reset user par
par(oldpar)

</code></pre>


</div>