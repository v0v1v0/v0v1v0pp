<div class="container">

<table style="width: 100%;"><tr>
<td>visualiseHaplo</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>Visualise haplotypes in certain individuals in a certain region</h2>

<h3>Description</h3>

<p>Function to visualise the haplotypes of a certain region in certain individuals
</p>


<h3>Usage</h3>

<pre><code class="language-R">visualiseHaplo(
  IBD_list,
  display_by = c("phenotype", "name"),
  linkage_group = NULL,
  Phenotype.df = NULL,
  genotype.ID = NULL,
  trait.ID = NULL,
  pheno_range = NULL,
  cM_range = "all",
  highlight_region = NULL,
  select_offspring = NULL,
  recombinant_scan = NULL,
  allele_fish = NULL,
  presence_threshold = 0.95,
  xlabl = TRUE,
  ylabl = TRUE,
  mainTitle = NULL,
  multiplot = NULL,
  append = FALSE,
  colPal = c("white", "navyblue", "darkred"),
  hap.wd = 0.4,
  recombination_data = NULL,
  reset_par = TRUE,
  log = NULL
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>IBD_list</code></td>
<td>
<p>List of IBD probabilities</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>display_by</code></td>
<td>
<p>Option to display a subset of the population's haplotypes either by <code>"phenotype"</code> or <code>"name"</code>.
If <code>"phenotype"</code> is supplied, then <code>Phenotype.df</code>,<code>genotype.ID</code>,<code>trait.ID</code> and <code>pheno_range</code> must also be specified.
if <code>"name"</code> is supplied, then <code>select_offspring</code> must be specified.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>linkage_group</code></td>
<td>
<p>Numeric identifier of the linkage group being examined, based on the order of <code>IBD_list</code>.
Only a single linkage group is allowed. If <code>IBD_list</code> corresponds to a single linkage group, default value
of <code>NULL</code> will suffice</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>Phenotype.df</code></td>
<td>
<p>A data.frame containing phenotypic values, which can be used to select a subset of the population
to visualise (with extreme phenotypes for example). By default <code>NULL</code>, in which case a subset of the
population may be selected using the <code>select_offspring</code> argument.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>genotype.ID</code></td>
<td>
<p>The colname of <code>Phenotype.df</code> that contains the population identifiers (F1 names) (must be a colname of <code>Phenotype.df</code>)</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>trait.ID</code></td>
<td>
<p>The colname of <code>Phenotype.df</code> that contains the response variable to use in the model (must be a colname of <code>Phenotype.df</code>)</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>pheno_range</code></td>
<td>
<p>Vector of numeric bounds of the phenotypic scores to include (offspring selection).</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>cM_range</code></td>
<td>
<p>Vector of numeric bounds of the genetic region to be explored. If none are specified, the default of <code>"all"</code> means all cM positions will be included.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>highlight_region</code></td>
<td>
<p>Option to hightlight a particular genetic region on the plot; can be a single position or a vector of 2 positions. By default <code>NULL</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>select_offspring</code></td>
<td>
<p>Vector of offspring identifiers to visualise, must be supplied if <code>display_by</code> = <code>"name"</code>. Specifying <code>"all"</code> will result in
all offspring haplotypes being visualised.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>recombinant_scan</code></td>
<td>
<p>Vector of homologue numbers between which to search for recombinant offspring in the visualised region and selected individuals.
By default <code>NULL</code>, in which case no search is preformed.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>allele_fish</code></td>
<td>
<p>Vector of homologue numbers of interest, for which to search for offspring that carry these homologues (in the visualised
region). By default <code>NULL</code>, in which case no search ("fishing") is performed.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>presence_threshold</code></td>
<td>
<p>Numeric. The minimum probability used to declare presence of a homologue in an individual. This is only needed if a <code>recombinant_scan</code> is
performed. By default a value of 0.95 is used. When searching for recombinants, this value is also used to denote the proportion of loci carrying the required number
of homologues (i.e. by default 95 per cent of loci should have between 0.95 and 1.1 copies of the specified recombinant homologues).</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>xlabl</code></td>
<td>
<p>Logical, by default <code>TRUE</code>. Should an x-axis label be used?</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>ylabl</code></td>
<td>
<p>Logical, by default <code>TRUE</code>. Should a y-axis label be used?</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>mainTitle</code></td>
<td>
<p>Option to override default plot titles with a (vector of) captions. By default <code>NULL</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>multiplot</code></td>
<td>
<p>Vector of integers. By default <code>NULL</code> so haplotypes are plotted singly;
otherwise a vector specifying the number of rows and columns in the plot layout.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>append</code></td>
<td>
<p>Option to allow user to append new plots to spaces generated by <code>multiplot</code>, otherwise these are
filled with blank plots. By default <code>FALSE</code>. If <code>TRUE</code>, then a large enough <code>multiplot</code> grid should be
generated to make this option meaningful.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>colPal</code></td>
<td>
<p>Colour palette to use in the visualisation (best to provide 3 colours).</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>hap.wd</code></td>
<td>
<p>The width of the haplotype tracks to be plotted, generally recommended to be about 0.4 (default value)</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>recombination_data</code></td>
<td>
<p>List object as returned by the function <code>count_recombinations</code>. By default <code>NULL</code>, 
in which case no overlay of predicted recombination events is performed. However, it can be useful
to visualise predicted recombination events, particularly as this might help inform the choice of argument <code>plausible_pairing_prob</code>
of that function. See <code>count_recombinations</code> for more details.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>reset_par</code></td>
<td>
<p>By default <code>TRUE</code>, reset par on exit.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>log</code></td>
<td>
<p>Character string specifying the log filename to which standard output should be written. If <code>NULL</code> log is send to stdout.</p>
</td>
</tr>
</table>
<h3>Value</h3>

<p>If <code>recombinant_scan</code> vector is supplied, a vector of recombinant offspring ID in the region of interest (otherwise <code>NULL</code>).
</p>


<h3>Examples</h3>

<pre><code class="language-R">data("IBD_4x")
visualiseHaplo(IBD_list = IBD_4x,
               display_by = "name",
               linkage_group = 1,
               select_offspring = "all",
               multiplot = c(3,3))
</code></pre>


</div>