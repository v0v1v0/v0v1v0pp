<div class="container">

<table style="width: 100%;"><tr>
<td>bfactor_to_prob</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>Turn Bayes Factors Into Posterior Probabilities</h2>

<h3>Description</h3>

<p>Update the prior probabilities of models/hypotheses to posterior probabilities using Bayes factors.
</p>


<h3>Usage</h3>

<pre><code class="language-R">bfactor_to_prob(bf, prior_prob = 0.5)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>bf</code></td>
<td>
<p>A numeric vector of non-negative values.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>prior_prob</code></td>
<td>
<p>A numeric vector with values in the [0,1] interval. If <code>length(bf) == 1</code> then <code>prior_prob</code> can be of any positive <code>length</code>, but if <code>length(bf) &gt; 1</code> then the <code>length</code> of <code>prior_prob</code> can only be <code>1</code> or equal to the <code>length</code> of <code>bf</code>.</p>
</td>
</tr>
</table>
<h3>Details</h3>

<p><code>bfactor_to_prob</code> computes the posterior probability of the null hypothesis using the following equation from Berger and Delampady (1987): </p>
<p style="text-align: center;"><code class="reqn">P(\textrm{null} \, \textrm{hypothesis}|\textrm{data}) = \left(1 + \frac{1 - {null\_prob}}{null\_prob} \times \frac{1}{bf}\right)^{-1}</code>
</p>
<p> where <code>bf</code> is a Bayes factor if favor of the null hypothesis and <code>prior_prob</code> is the prior probability of the null hypothesis. The alternative hypothesis has prior probability <code>1 - prior_prob</code> and posterior probability <code>1 - bfactor_to_prob(bf, prior_prob)</code>.
</p>
<p>The <code>prior_prob</code> argument is optional and is set to 0.5 by default, implying prior equiprobability of hypotheses. <code>prior_prob</code> can only be of <code>length</code> equal to <code>length(bf)</code>, in which case each prior probability in <code>prior_prob</code> will be updated using the corresponding element of <code>bf</code>, or of <code>length</code> <code>1</code>, in which case it will be recycled (if <code>length(bf) &gt; 1</code>) and each element of <code>bf</code> will update the same <code>prior_prob</code> value.
</p>


<h3>Value</h3>

<p>If <code>length(bf) &gt; 1</code> then <code>bfactor_to_prob</code> returns a numeric vector with the same <code>length</code> as <code>bf</code>, otherwise it returns a numeric vector with the same <code>length</code> as <code>prior_prob</code>.
</p>


<h3>References</h3>

<p>Berger JO, Delampady M (1987).
“Testing precise hypotheses.”
<em>Statistical Science</em>, <b>2</b>(3), 317–335.
</p>


<h3>See Also</h3>


<ul>
<li> <p><code>bfactor_interpret</code> and <code>bfactor_interpret_kr</code> for the interpretation of Bayes factors.
</p>
</li>
<li> <p><code>bfactor_log_interpret</code> and <code>bfactor_log_interpret_kr</code> for the interpretation of the logarithms of Bayes factors.
</p>
</li>
<li> <p><code>bcal</code> for a p-value calibration that returns lower bounds on Bayes factors in favor of point null hypotheses.
</p>
</li>
<li> <p><code>pcal</code> for a p-value calibration that returns lower bounds on the posterior probabilities of point null hypotheses.
</p>
</li>
</ul>
<h3>Examples</h3>

<pre><code class="language-R"># With a Bayes factor that is indifferent between the null and the alternative hypotheses:
bfactor_to_prob(1)

# Same as above but the null hypothesis has high prior probability:
bfactor_to_prob(1, .99)

# Posterior probability of the null as a function of different prior probabilities:
bfactor_to_prob(1, seq(.5, 1, .1))

# With Bayes factors that favor the null hypothesis:
round(bfactor_to_prob(seq(2, 50, 2.5)), 3)

# Same as above but the null hypothesis has low prior probability:
round(bfactor_to_prob(seq(2, 50, 2.5), prior_prob = .01), 3)

# Posterior probabilities obtained with Bayes factors that favor the alternative hypothesis:
round(bfactor_to_prob(seq(0, 1, .05)), 3)

# Same as above but the null hypothesis has high prior probability:
round(bfactor_to_prob(seq(0, 1, .05), prior_prob = .99), 3)

# Application: chi-squared goodness-of-fit test,
# lower bound on the posterior probability of the null hypothesis:
x &lt;- matrix(c(12, 41, 25, 33), ncol = 2)
bfactor_to_prob(bcal(chisq.test(x)[["p.value"]]), prior_prob = .9)

</code></pre>


</div>