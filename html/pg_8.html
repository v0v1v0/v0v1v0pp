<div class="container">

<table style="width: 100%;"><tr>
<td>rpg_scalar</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>Sample from the Polya Gamma distribution PG(h, z)</h2>

<h3>Description</h3>

<p>Chooses the most efficient implemented method to sample from a Polya Gamma
distribution. Details on algorithm selection presented below.
</p>


<h3>Usage</h3>

<pre><code class="language-R">rpg_scalar(h, z)

rpg_vector(n, h, z)

rpg_hybrid(h, z)

rpg_gamma(h, z, trunc = 1000L)

rpg_devroye(h, z)

rpg_sp(h, z)

rpg_normal(h, z)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>h</code></td>
<td>
<p><code>integer</code> values corresponding to the "shape" parameter.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>z</code></td>
<td>
<p><code>numeric</code> values corresponding to the "scale" parameter.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>n</code></td>
<td>
<p>The number of samples to taken from a PG(h, z). Used only by
the vector sampler.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>trunc</code></td>
<td>
<p>Truncation cut-off. Only used by the gamma sampler.</p>
</td>
</tr>
</table>
<h3>Details</h3>

<p>The following sampling cases are enabled:
</p>

<ul>
<li> <p><code>h &gt; 170</code>: Normal approximation method
</p>
</li>
<li> <p><code>h &gt; 13</code>: Saddlepoint approximation method
</p>
</li>
<li> <p><code>h = 1</code> or <code>h = 2</code>: Devroye method
</p>
</li>
<li> <p><code>h &gt; 0</code>: Sum of Gammas method.
</p>
</li>
<li> <p><code>h &lt; 0</code>: Result is automatically set to zero.
</p>
</li>
</ul>
<h3>Value</h3>

<p>A single <code>numeric</code> value.
</p>


<h3>Examples</h3>

<pre><code class="language-R"># Fixed parameter distribution simulation ----

## Parameters  ----
h = 1; z = .5

## Sample only one value  ----
single_value = rpg_scalar(h, z)
single_value

## Attempt distribution recovery  ----
vector_of_pg_samples = rpg_vector(1e6, h, z)

head(vector_of_pg_samples)
length(vector_of_pg_samples)

## Obtain the empirical results   ----
empirical_mean = mean(vector_of_pg_samples)
empirical_var = var(vector_of_pg_samples)

## Take the theoretical values ----
theoretical_mean = pg_mean(h, z)
theoretical_var = pg_var(h, z)

## Form a comparison table ----

# empirically sampled vs. theoretical values
rbind(c(empirical_mean, theoretical_mean),
      c(empirical_var, theoretical_var))

# Varying distribution parameters ----

## Generate varying parameters ----
u_h = 20:100
u_z = 0.5*u_h

## Sample from varying parameters ----
x = rpg_hybrid(u_h, u_z)
</code></pre>


</div>