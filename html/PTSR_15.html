<div class="container">

<table style="width: 100%;"><tr>
<td>ptsr.sim</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>Function to simulate a PTSR model</h2>

<h3>Description</h3>

<p>Function to simulate a PTSR model
</p>


<h3>Usage</h3>

<pre><code class="language-R">ptsr.sim(n = 1, burn = 0, xreg = NULL, xregar = TRUE, varphi = 1,
  alpha = 0, beta = NULL, phi = NULL, theta = NULL,
  seed = stats::runif(1, 1000, 10000), rdist = r.gamma, link1 = "log",
  link2 = "identity", g1 = NULL, g1.inv = NULL, g2 = NULL)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>n</code></td>
<td>
<p>a strictly positive integer. The sample size of yt (after burn-in).
Default is 1.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>burn</code></td>
<td>
<p>a non-negative integer. length of "burn-in" period. Default is 0.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>xreg</code></td>
<td>
<p>optionally, a vector or matrix of external regressors.
For simulation purposes, the length of xreg must be <code>n+burn</code>.
Default is <code>NULL</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>xregar</code></td>
<td>
<p>logical, if <code>FALSE</code>, the regressors are not included in the
AR component of the model. Default is <code>TRUE</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>varphi</code></td>
<td>
<p>non-negative parameter. Default is 1.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>alpha</code></td>
<td>
<p>a numeric value corresponding to the intercept.  Default is 0.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>beta</code></td>
<td>
<p>optionally, a vector of coefficients corresponding to the
regressors in <code>xreg</code>. Default is <code>NULL</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>phi</code></td>
<td>
<p>optionally, for the simulation function this must be a vector
of size <code class="reqn">p</code>, corresponding to the autoregressive coefficients
(including the ones that are zero), where <code class="reqn">p</code> is the AR order.
Default is <code>NULL</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>theta</code></td>
<td>
<p>optionally, for the simulation function this must be a vector
of size <code class="reqn">q</code>, corresponding to the moving average coefficients
(including the ones that are zero), where <code class="reqn">q</code> is the MA order.
Default is <code>NULL</code>.
that <code class="reqn">g_2(y_t) = 0</code>, for <code class="reqn">t &lt; 1</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>seed</code></td>
<td>
<p>optionally, an integer which gives the value of the fixed
seed to be used by the random number generator. If missing, a random integer
is chosen uniformly from 1,000 to 10,000.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>rdist</code></td>
<td>
<p>function, the random number generator to be used</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>link1</code></td>
<td>
<p>character indicating which link must be used for <code class="reqn">\mu_t</code>.  See <code>ptsr.link</code> for available links. Default is ‘log’.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>link2</code></td>
<td>
<p>character indicating which link must be used for <code class="reqn">y_t</code> in the AR recursion.  See <code>ptsr.link</code> for available links. Default is ‘identity’.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>g1</code></td>
<td>
<p>optionally, a link function to be used  for <code class="reqn">\mu_t</code>. Default is <code>NULL</code>, so that it is calculated internally, using <code>link1</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>g1.inv</code></td>
<td>
<p>optionally, a the inverse link function to be used  for <code class="reqn">\eta_t</code>. It must the the ivnerse of <code>g1</code>. Default is <code>NULL</code>, so that it is calculated internally, using <code>link1</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>g2</code></td>
<td>
<p>optionally, a link function to be used  for <code class="reqn">y_t</code>. Default is <code>NULL</code>, so that it is calculated internally, using <code>link2</code>.</p>
</td>
</tr>
</table>
<h3>Details</h3>

<p>The function <code>ptsr.sim</code> generates a random sample from a positive time
series regression model, with a given distribution.
</p>


<h3>Value</h3>

<p>Returns a list with the following components
</p>

<ul>
<li> <p><code>yt</code>: the simulated time series
</p>
</li>
<li> <p><code>mut</code>: the conditional mean
</p>
</li>
<li> <p><code>etat</code>: the linear predictor <code class="reqn">g(\mu_t)</code>
</p>
</li>
<li> <p><code>error</code>: the error term.
</p>
</li>
</ul>
<h3>Examples</h3>

<pre><code class="language-R">
#-------------------------------------------------------------------
# Generating a sample of a Gamma-ARMA(1,1) model with no regressors
#-------------------------------------------------------------------

simu = ptsr.sim(n = 300, burn = 50,
                varphi = 20, alpha = 0,
                phi = 0.35, theta = 0.2,
                seed = 1234, rdist = r.gamma,
                link1 = "log", link2 = "log")

names(simu)
plot.ts(simu$yt)
lines(simu$mut, col= "red")

</code></pre>


</div>