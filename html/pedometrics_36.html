<div class="container">

<table style="width: 100%;"><tr>
<td>stepVIF</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>Variable selection using the (generalized) variance-inflation factor (VIF)</h2>

<h3>Description</h3>

<p>This function takes a linear model and selects the subset of predictor variables that meet a
user-specific collinearity threshold measured by the (generalized) variance-inflation factor
(VIF).
</p>


<h3>Usage</h3>

<pre><code class="language-R">stepVIF(model, threshold = 10, verbose = FALSE)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>model</code></td>
<td>
<p>Linear model (object of class 'lm') containing collinear predictor variables.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>threshold</code></td>
<td>
<p>Positive number defining the maximum allowed VIF. Defaults to <code>threshold = 10</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>verbose</code></td>
<td>
<p>Logical indicating if iteration results should be printed. Defaults to
<code>verbose = FALSE</code>.</p>
</td>
</tr>
</table>
<h3>Details</h3>

<p><code>stepVIF</code> starts computing the VIF of all predictor variables in the linear model. If the linear
model contains categorical predictor variables, generalized variance-inflation factors (GVIF)
(Fox and Monette, 1992), are calculated instead using <code>car::vif()</code>. GVIF is interpretable as the
inflation in size of the confidence ellipse or ellipsoid for the coefficients of the predictor
variable in comparison with what would be obtained for orthogonal, uncorrelated data. Since
categorical predictors have more than one degree of freedom, <em>df</em>, the confidence ellipsoid will
have <em>df</em> dimensions, and GVIF will need to be adjusted so that it can be comparable across
predictor variables. The adjustment is made using the following equation:
</p>
<p><code class="reqn">GVIF^{1/(2\times df)}</code>
</p>
<p>The next step consists of evaluating if any of the predictor variables has a (G)VIF larger than
the specified threshold, the function default being <code>threshold = 10</code>. For, GVIF^(1/(2*df)), the
threshold will be <code>sqrt(threshold)</code>.
</p>
<p>If there is only one predictor variable that does not meet the VIF threshold, it is automatically
removed from the model and no further processing occurs. When there are two or more predictor
variables that do not meet the (G)VIF threshold, <code>stepVIF()</code> fits a linear model
between each of them and the dependent variable. The predictor variable with the lowest adjusted
coefficient of determination is dropped from the model and new coefficients are calculated,
resulting in a new linear model.
</p>
<p>This process lasts until all predictor variables included in the new model meet the (G)VIF
threshold.
</p>
<p>Nothing is done if all predictor variables have a (G)VIF value lower that the threshold, and
<code>stepVIF()</code> returns the original linear model.
</p>


<h3>Value</h3>

<p>A linear model (object of class 'lm') with low collinearity.
</p>


<h3>Dependencies</h3>

<p>The <strong>car</strong> package, provider of functions to accompany Fox and Weisberg's An R Companion to
Applied Regression, is required for <code>plotHist()</code> to work. The development version of
the <strong>car</strong> package is available on <a href="https://r-forge.r-project.org/projects/car/">https://r-forge.r-project.org/projects/car/</a> while its old
versions are available on the CRAN archive at
<a href="https://cran.r-project.org/src/contrib/Archive/car/">https://cran.r-project.org/src/contrib/Archive/car/</a>.
</p>


<h3>Note</h3>

<p>More on the use of GVIF to measure the collinearity in linear models containing categorical
predictor variables can be found on
<a href="https://stats.stackexchange.com/questions/70679/">StackExchange</a>.
</p>


<h3>Author(s)</h3>

<p>Alessandro Samuel-Rosa <a href="mailto:alessandrosamuelrosa@gmail.com">alessandrosamuelrosa@gmail.com</a>
</p>


<h3>References</h3>

<p>Fox, J. and Monette, G. (1992) Generalized collinearity diagnostics. <em>JASA</em>, 87, 178–183.
</p>
<p>Fox, J. (2008) <em>Applied Regression Analysis and Generalized Linear Models</em>, Second Edition. Sage.
</p>
<p>Fox, J. and Weisberg, S. (2011) <em>An R Companion to Applied Regression</em>, Second Edition. Thousand
Oaks: Sage.
</p>
<p>Hair, J. F., Black, B., Babin, B. and Anderson, R. E. (2010) <em>Multivariate data analysis</em>. New
Jersey: Pearson Prentice Hall.
</p>
<p>Venables, W. N. and Ripley, B. D. (2002) <em>Modern Applied Statistics with S</em>. Fourth edition.
Springer.
</p>
<p>A. Samuel-Rosa, G. B. M. Heuvelink, G. de Mattos Vasques, and L. H. C. dos Anjos, Do more
detailed environmental covariates deliver more accurate soil maps?, <em>Geoderma</em>, vol. 243–244,
pp. 214–227, May 2015, doi: 10.1016/j.geoderma.2014.12.017.
</p>


<h3>See Also</h3>

<p><code>MASS::stepAIC()</code>
</p>


<h3>Examples</h3>

<pre><code class="language-R">if (require(car)) {
  fit &lt;- lm(prestige ~ income + education + type, data = Duncan)
  fit &lt;- stepVIF(fit, threshold = 10, verbose = TRUE)
}
</code></pre>


</div>