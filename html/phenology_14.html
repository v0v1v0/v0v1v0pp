<div class="container">

<table style="width: 100%;"><tr>
<td>fitCF_MHmcmc</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>Run the Metropolis-Hastings algorithm for ECFOCF data</h2>

<h3>Description</h3>

<p>Run the Metropolis-Hastings algorithm for RMU.data.<br>
The number of iterations is n.iter+n.adapt+1 because the initial likelihood is also displayed.<br>
I recommend thin=1 because the method to estimate SE uses resampling.<br>
As initial point is maximum likelihood, n.adapt = 0 is a good solution.<br>
The parameters intermediate and filename are used to save intermediate results every 'intermediate' iterations (for example 1000). Results are saved in a file of name filename.<br>
The parameter previous is used to indicate the list that has been save using the parameters intermediate and filename. It permits to continue a mcmc search.<br>
These options are used to prevent the consequences of computer crash or if the run is very very long and computer processes at time limited.<br></p>


<h3>Usage</h3>

<pre><code class="language-R">fitCF_MHmcmc(
  result = stop("An output from fitCF() must be provided"),
  n.iter = 10000,
  parametersMCMC = stop("A parameter set from fitCF_MHmcmc_p() must be provided"),
  n.chains = 1,
  n.adapt = 0,
  thin = 1,
  adaptive = FALSE,
  adaptive.lag = 500,
  adaptive.fun = function(x) {
     ifelse(x &gt; 0.234, 1.3, 0.7)
 },
  trace = FALSE,
  traceML = FALSE,
  intermediate = NULL,
  filename = "intermediate.Rdata",
  previous = NULL
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>result</code></td>
<td>
<p>An object obtained after a SearchR fit</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>n.iter</code></td>
<td>
<p>Number of iterations for each step</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>parametersMCMC</code></td>
<td>
<p>A set of parameters used as initial point for searching with information on priors</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>n.chains</code></td>
<td>
<p>Number of replicates</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>n.adapt</code></td>
<td>
<p>Number of iterations before to store outputs</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>thin</code></td>
<td>
<p>Number of iterations between each stored output</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>adaptive</code></td>
<td>
<p>Should an adaptive process for SDProp be used</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>adaptive.lag</code></td>
<td>
<p>Lag to analyze the SDProp value in an adaptive content</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>adaptive.fun</code></td>
<td>
<p>Function used to change the SDProp</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>trace</code></td>
<td>
<p>TRUE or FALSE or period, shows progress</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>traceML</code></td>
<td>
<p>TRUE or FALSE to show ML</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>intermediate</code></td>
<td>
<p>Period for saving intermediate result, NULL for no save</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>filename</code></td>
<td>
<p>If intermediate is not NULL, save intermediate result in this file</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>previous</code></td>
<td>
<p>Previous result to be continued. Can be the filename in which intermediate results are saved.</p>
</td>
</tr>
</table>
<h3>Details</h3>

<p>fitCF_MHmcmc runs the Metropolis-Hastings algorithm for ECFOCF (Bayesian MCMC)
</p>


<h3>Value</h3>

<p>A list with resultMCMC being mcmc.list object, resultLnL being likelihoods and parametersMCMC being the parameters used
</p>


<h3>Author(s)</h3>

<p>Marc Girondot <a href="mailto:marc.girondot@gmail.com">marc.girondot@gmail.com</a>
</p>


<h3>See Also</h3>

<p>Other Model of Clutch Frequency: 
<code>ECFOCF_f()</code>,
<code>ECFOCF_full()</code>,
<code>TableECFOCF()</code>,
<code>fitCF()</code>,
<code>fitCF_MHmcmc_p()</code>,
<code>generateCF()</code>,
<code>lnLCF()</code>,
<code>logLik.ECFOCF()</code>,
<code>plot.ECFOCF()</code>,
<code>plot.TableECFOCF()</code>
</p>


<h3>Examples</h3>

<pre><code class="language-R">## Not run: 
library("phenology")
data(MarineTurtles_2002)
ECFOCF_2002 &lt;- TableECFOCF(MarineTurtles_2002)

# Paraetric model for clutch frequency
o_mu1p1_CFp &lt;- fitCF(x = c(mu = 2.1653229641404539, 
                 sd = 1.1465246643327098, 
                 p = 0.25785366120357966), 
                 fixed.parameters=NULL, 
                 data=ECFOCF_2002, hessian = TRUE)
                           
pMCMC &lt;- fitCF_MHmcmc_p(result=o_mu1p1_CFp, accept=TRUE)
fitCF_MCMC &lt;- fitCF_MHmcmc(result = o_mu1p1_CFp, n.iter = 1000, 
                           parametersMCMC = pMCMC, n.chains = 1, n.adapt = 0, 
                           adaptive=TRUE, 
                           thin = 1, trace = TRUE)
                           
plot(fitCF_MCMC, parameters="mu")
plot(fitCF_MCMC, parameters="sd")
plot(fitCF_MCMC, parameters="p", xlim=c(0, 0.5), breaks=seq(from=0, to=0.5, by=0.05))
plot(fitCF_MCMC, parameters="p", transform = invlogit, xlim=c(0, 1), 
     breaks=c(seq(from=0, to=1, by=0.05)))


## End(Not run)
</code></pre>


</div>