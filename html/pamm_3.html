<div class="container">

<table style="width: 100%;"><tr>
<td>PAMM</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>Simulation function to assess power of mixed models</h2>

<h3>Description</h3>

<p>Given a specific varaince-covariance structure for random
effect, the function simulate different group size and assess p-values and power of
random intercept and random slope
</p>


<h3>Usage</h3>

<pre><code class="language-R">PAMM(
  numsim,
  group,
  repl,
  randompart,
  fixed = c(0, 1, 0),
  n.X = NA,
  autocorr.X = 0,
  X.dist = "gaussian",
  intercept = 0,
  heteroscedasticity = c("null"),
  ftype = "lmer",
  mer.sim = FALSE
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>numsim</code></td>
<td>
<p>number of simulation for each step</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>group</code></td>
<td>
<p>number of group. Could be specified as a vector</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>repl</code></td>
<td>
<p>number of replicates per group . Could be specified as a vector</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>randompart</code></td>
<td>
<p>vector of lenght 4 or 5, with 1: variance component
of intercept, VI; 2: variance component of slope, VS; 3: residual
variance, VR; 4: relation between random intercept and random
slope; 5: "cor" or "cov" determine if the relation 4 between I ans S is a correlation or a covariance. Default: <code>"cor"</code></p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>fixed</code></td>
<td>
<p>vector with mean, variance and estimate of fixed effect to simulate. Default: <code>c(0, 1, 0)</code></p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>n.X</code></td>
<td>
<p>number of different values to simulate for the fixed effect (covariate).
If <code>NA</code>, all values of X are independent between groups. If the value specified
is equivalent to the number of replicates per group, <code>repl</code>, then all groups
are observed for the same values of the covariate.  Default: <code>NA</code></p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>autocorr.X</code></td>
<td>
<p>correlation between two successive covariate value for a group. Default: <code>0</code></p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>X.dist</code></td>
<td>
<p>specify the distribution of the fixed effect. Only "gaussian" (normal distribution) and
"unif" (uniform distribution) are accepted actually. Default: <code>"gaussian"</code></p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>intercept</code></td>
<td>
<p>a numeric value giving the expected intercept value. Default:0</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>heteroscedasticity</code></td>
<td>
<p>a vector specifying heterogeneity in residual variance
across X. If <code>c("null")</code> residual variance is homogeneous across X. If
<code>c("power",t1,t2)</code> models heterogeneity with a constant plus power variance function.
Letting <code class="reqn">v</code> denote the variance covariate and <code class="reqn">\sigma^2(v)</code>
denote the variance function evaluated at <code class="reqn">v</code>, the constant plus power
variance function is defined as <code class="reqn">\sigma^2(v) = (\theta_1 + |v|^{\theta_2})^2</code>,
where <code class="reqn">\theta_1,\theta_2</code> are the variance function coefficients.
If <code>c("exp",t)</code>,models heterogeneity with an
exponential variance function. Letting <code class="reqn">v</code> denote the variance covariate and <code class="reqn">\sigma^2(v)</code>
denote the variance function evaluated at <code class="reqn">v</code>, the exponential
variance function is defined as <code class="reqn">\sigma^2(v) = e^{2 * \theta * v}</code>, where <code class="reqn">\theta</code> is the variance
function coefficient.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>ftype</code></td>
<td>
<p>character value "lmer", "lme" or "MCMCglmm" specifying the function to use to fit
the model. Actually "lmer" only is accepted</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>mer.sim</code></td>
<td>
<p>simulate the data using simulate.merMod from lme4. Faster for large sample size but not as flexible.</p>
</td>
</tr>
</table>
<h3>Details</h3>

<p>P-values for random effects are estimated using a log-likelihood ratio
test between two models with and without the effect. Power represent
the percentage of simulations providing a significant p-value for a
given random structure
</p>


<h3>Value</h3>

<p>data frame reporting estimated P-values and power with CI for random
intercept and random slope
</p>
<p>\@seealso [EAMM()], [SSF()], [plot.PAMM()]
</p>


<h3>Examples</h3>

<pre><code class="language-R">## Not run: 
ours &lt;- PAMM(numsim = 10, group = c(seq(10, 50, 10), 100),
             repl = c(3, 4, 6),
             randompart = c(0.4, 0.1, 0.5, 0.1), fixed = c(0, 1, 0.7))
plot(ours,"both")
   
## End(Not run)

</code></pre>


</div>