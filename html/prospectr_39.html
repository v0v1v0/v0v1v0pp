<div class="container">

<table style="width: 100%;"><tr>
<td>savitzkyGolay</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>Savitzky-Golay smoothing and differentiation</h2>

<h3>Description</h3>

<script id="MathJax-script" async src="../../mathjaxr/doc/mathjax/es5/tex-chtml-full.js"></script><p>Savitzky-Golay smoothing and derivative of a data matrix or vector.
</p>


<h3>Usage</h3>

<pre><code class="language-R">savitzkyGolay(X, m, p, w, delta.wav)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>X</code></td>
<td>
<p>a numeric matrix or vector to process (optionally a data frame that
can be coerced to a numerical matrix).</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>m</code></td>
<td>
<p>an integer indcating the differentiation order.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>p</code></td>
<td>
<p>an integer indicating the polynomial order.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>w</code></td>
<td>
<p>an integer indicating the window size (must be odd).</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>delta.wav</code></td>
<td>
<p>(optional) sampling interval.</p>
</td>
</tr>
</table>
<h3>Details</h3>

<p>The Savitzky-Golay algorithm fits a local polynomial regression on the signal.
It requires evenly spaced data points. Mathematically, it operates simply as
a weighted sum over a given window:
</p>
\[ x_j\ast = \frac{1}{N}\sum_{h=-k}^{k}{c_hx_{j+h}}\]
<p>where \(x_j\ast\) is the new value, \(N\) is a
normalizing coefficient, \(k\) is the gap size on each side of
\(j\) and \(c_h\) are pre-computed coefficients, that depends
on the chosen polynomial order and degree.
</p>
<p>The sampling interval specified with the <code>delta.wav</code> argument is used for
scaling and get numerically correct derivatives.
</p>
<p>The convolution function is written in C++/Rcpp for faster computations.
</p>


<h3>Author(s)</h3>

<p>Antoine Stevens and <a href="https://orcid.org/0000-0002-5369-5120">Leonardo Ramirez-Lopez</a>
</p>


<h3>References</h3>

<p>Luo, J., Ying, K., He, P., &amp; Bai, J. (2005). Properties of Savitzkyâ€“Golay
digital differentiators. Digital Signal Processing, 15(2), 122-136.
</p>
<p>Savitzky, A., and Golay, M.J.E., 1964. Smoothing and
differentiation of data by simplified least squares procedures.
Anal. Chem. 36, 1627-1639.
</p>
<p>Schafer, R. W. (2011). What is a Savitzky-Golay filter? (lecture notes). IEEE
Signal processing magazine, 28(4), 111-117.
</p>
<p>Wentzell, P.D., and Brown, C.D., 2000. Signal processing in analytical
chemistry. Encyclopedia of Analytical Chemistry, 9764-9800.
</p>


<h3>Examples</h3>

<pre><code class="language-R">data(NIRsoil)
opar &lt;- par(no.readonly = TRUE)
par(mfrow = c(2, 1), mar = c(4, 4, 2, 2))

# plot of the 10 first spectra
matplot(as.numeric(colnames(NIRsoil$spc)),
  t(NIRsoil$spc[1:10, ]),
  type = "l",
  xlab = "",
  ylab = "Absorbance"
)

mtext("Raw spectra")
NIRsoil$spc_sg &lt;- savitzkyGolay(
  X = NIRsoil$spc,
  m = 1,
  p = 3,
  w = 11,
  delta.wav = 2
)

matplot(as.numeric(colnames(NIRsoil$spc_sg)),
  t(NIRsoil$spc_sg[1:10, ]),
  type = "l",
  xlab = "Wavelength /nm",
  ylab = "1st derivative"
)

mtext("1st derivative spectra")
par(opar)
</code></pre>


</div>