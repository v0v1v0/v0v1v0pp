<div class="container">

<table style="width: 100%;"><tr>
<td>pencopula</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>Calculating penalized (conditional) copula density with penalized hierarchical B-splines</h2>

<h3>Description</h3>

<p>Calculating penalized (conditional) copula density with penalized hierarchical B-splines </p>


<h3>Usage</h3>

<pre><code class="language-R">pencopula(data,d=3,D=d,q=1,base="B-spline",max.iter=20,test.ind=FALSE,
         lambda=c(100,100),pen.order=2,data.frame=parent.frame(),cond=FALSE,
         fix.lambda=FALSE,id=NULL) 
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>data</code></td>
<td>
<p>'data' contains the data. 'data' has to be a matrix or a
data.frame. The number of columns of 'data' is p.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>d</code></td>
<td>
<p>refers to the hierachy level of the marginal hierarchical
B-spline, default is d=3.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>D</code></td>
<td>
<p>referes to the maximum hierachy level, default is D=3. If
D&lt;d, it follows D&lt;-d.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>q</code></td>
<td>
<p>degree of the marginal hierarchical B-spline.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>base</code></td>
<td>
<p>By default, the used marginal basis is a
'B-spline'. Second possible option is 'Bernstein', using a Bernstein
polynomial basis.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>max.iter</code></td>
<td>
<p>maximum number of iteration, the default is max.iter=20.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>test.ind</code></td>
<td>
<p>Default=FALSE. If test.ind=TRUE, the fitted log-likelihood of each pair-copula is evaluated. If ("log.like"/"n"&lt;0.001), where "n" is the  sample size, the program set the corresponding pair copula as independence copula. We do not use this in our simulations or applications in the article.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>lambda</code></td>
<td>
<p>p-dimensional vector of penalty parameters, the values
can be different. Default is lambda=c(100,100).</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>pen.order</code></td>
<td>
<p>The order of differences for the penalization,
default is pen.order=2.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>data.frame</code></td>
<td>
<p>reference to the data. Default reference is the parent.frame().</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>cond</code></td>
<td>
<p>Determining if a conditional copula is estimated. Default=FALSE, only suitable for p=3.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>fix.lambda</code></td>
<td>
<p>Default=FALSE, using the algorithm in the paper for estimating the optimal penalty parameter. If fix.lambda=TRUE, lambda is constant throughout the estimation.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>id</code></td>
<td>
<p>Optional, one set id to any value. Especially important for simulations, starting with several starting values for lambda.</p>
</td>
</tr>
</table>
<h3>Value</h3>

<p>Returning an object of class pencopula. The class pencopula consists of
the environment 'penden.env', which includes all calculated values of
the estimation approach.
For a fast overview of the main results, one can use the function 'print.pencopula()'.
</p>


<h3>Author(s)</h3>

<p>Christian Schellhase &lt;cschellhase@wiwi.uni-bielefeld.de&gt;</p>


<h3>References</h3>

<p>Flexible Copula Density Estimation with Penalized
Hierarchical B-Splines, Kauermann G., Schellhase C. and Ruppert, D. (2013), Scandinavian Journal of Statistics 40(4), 685-705.
</p>
<p>Estimating Non-Simplified Vine Copulas Using Penalized Splines, Schellhase, C. and Spanhel, F. (2017), Statistics and Computing.</p>


</div>