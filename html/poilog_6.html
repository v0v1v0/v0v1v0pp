<div class="container">

<table style="width: 100%;"><tr>
<td>MLE for Poisson lognormal distribution</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2> Maximum Likelihood Estimation for Poisson Lognormal Distribution </h2>

<h3>Description</h3>

<p><code>poilogMLE</code> fits the Poisson lognormal distribution to data and estimates 
parameters mean <code>mu</code> and standard deviation <code>sig</code> in the lognormal distribution
</p>


<h3>Usage</h3>

<pre><code class="language-R">poilogMLE(n, startVals = c(mu=1, sig=2), 
          nboot = 0, zTrunc = TRUE,
          method = "BFGS", control = list(maxit=1000))
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>n</code></td>
<td>
<p> A vector of counts </p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>startVals</code></td>
<td>
<p> Starting values of parameters, see details </p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>nboot</code></td>
<td>
<p> Number of parametric bootstraps, defaults to zero </p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>zTrunc</code></td>
<td>
<p> Zero-truncated distribution, defaults to TRUE </p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>method</code></td>
<td>
<p> Method to use during optimization, see details </p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>control</code></td>
<td>
<p> A list of control parameters for the optimization routine, see details </p>
</td>
</tr>
</table>
<h3>Details</h3>

<p>The function estimates parameters mean <code>mu</code> and standard deviation <code>sig</code>. 
In cases of incomplete sampling the estimate of <code>mu</code> will be confounded with the sampling
intensity (see <code>rpoilog</code>). Assuming sampling intensity <code class="reqn">\nu</code>, 
the estimates of the mean is <code class="reqn">\code{mu}+\ln(\nu)</code>. Parameter <code>sig</code> can be estimated without 
any knowledge of sampling intensity.<br>
The parameters must be given starting values for the optimization procedure (default starting values are 
used if starting values are not specified in the function call).
</p>
<p>The function uses the optimization procedures in <code>optim</code> to obtain the maximum likelihood estimate.
The <code>method</code> and <code>control</code> arguments are passed to <code>optim</code>, see the help page for this 
function for additional methods and control parameters.
</p>
<p>A zero-truncated distribution (see <code>dpoilog</code>) is assumed by default (<code>zTrunc = TRUE</code>).
In cases where the number of zeros is known the <code>zTrunc</code> argument should be set to <code>FALSE</code>.
</p>
<p>The approximate fraction of species revealed by the sample is <code class="reqn">1-q(0;\code{mu},\code{sig})</code>.
</p>
<p>Parametric bootstrapping is done by simulating new sets of observations using the  estimated parameters 
(see <code>rbipoilog</code>).
</p>


<h3>Value</h3>

<table>
<tr style="vertical-align: top;">
<td><code>par </code></td>
<td>
<p>Maximum likelihood estimates of the parameters</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>p </code></td>
<td>
<p>Approximate fraction of species revealed by the sample</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>logLval </code></td>
<td>
<p>Log likelihood of the data given the estimated parameters</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>gof </code></td>
<td>
<p>Goodness of fit measure obtained by checking the rank of logLval against logLval's obtained 
during the bootstrap procedure, (gof&lt;0.05) or (gof&gt;0.95) indicates lack of fit</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>boot </code></td>
<td>
<p>A data frame containing the bootstrap replicates of parameters and logLval</p>
</td>
</tr>
</table>
<h3>Author(s)</h3>

<p> Vidar Grotan <a href="mailto:vidar.grotan@ntnu.no">vidar.grotan@ntnu.no</a>, Steinar Engen</p>


<h3>References</h3>

<p>Bulmer, M. G. 1974. On fitting the Poisson lognormal distribution to species abundance data. Biometrics <b>30</b>, 651-660.<br>
Engen, S., R. Lande, T. Walla and P. J. DeVries. 2002. Analyzing spatial structure of communities using the two-dimensional 
Poisson lognormal species abundance model. American Naturalist <b>160</b>, 60-73.</p>


<h3>See Also</h3>

 <p><code>optim</code>, <code>dpoilog</code>, <code>rpoilog</code>  </p>


<h3>Examples</h3>

<pre><code class="language-R">### simulate observations

n &lt;- rpoilog(S=80,mu=1,sig=2)

### obtain estimates of parameters
est &lt;- poilogMLE(n)

### similar, but now with bootstrapping ###
## Not run: est &lt;- poilogMLE(n,nboot=10)

### change start values and request tracing information 
### from optimization procedure
est &lt;- poilogMLE(n,startVals=c(2,3),
                 control=list(maxit=1000,trace=1, REPORT=1))
</code></pre>


</div>