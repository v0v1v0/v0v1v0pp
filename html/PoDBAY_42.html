<div class="container">

<table style="width: 100%;"><tr>
<td>PoDParamEstimation</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>PoD curve parameters estimation</h2>

<h3>Description</h3>

<p>Function estimates the PoD curve parameters (pmax, slope, et50) using <code>PoDMLE</code> function. Number of PoD curves estimated equals to the repeatCount input parameter.
</p>
<p>The estimation is performed using provided diseased and non-diseased subject level data.
</p>


<h3>Usage</h3>

<pre><code class="language-R">PoDParamEstimation(diseasedTiters,
                   nondiseasedTiters,
                   nondiseasedGenerationCount,
                   repeatCount = 500,
                   adjustTiters = FALSE,
                   adjustFrom = log2(10),
                   adjustTo = log2(5))
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>diseasedTiters</code></td>
<td>
<p>numeric vector: all diseased titers, subject level data</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>nondiseasedTiters</code></td>
<td>
<p>numeric vector: non-diseased titers from immunogenicity subset, subject level data</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>nondiseasedGenerationCount</code></td>
<td>
<p>numeric: total number of non-diseased subjects in the clinical trial</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>repeatCount</code></td>
<td>
<p>numeric: how many times is the dataset bootstrapped and the PoD curve parameter estimation performed</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>adjustTiters</code></td>
<td>
<p>boolean: set to TRUE if titer values should be adjusted, for details see <code>PoD</code> function</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>adjustFrom</code></td>
<td>
<p>numeric: value specifying the detection limit, all values below the detection limit will be adjusted to adjustTo value</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>adjustTo</code></td>
<td>
<p>numeric: value to which titers below the detection limit will be adjusted</p>
</td>
</tr>
</table>
<h3>Details</h3>

<p>diseasedTiters: subject level titers of all diseased in the clinical trial
</p>
<p>nondiseasedTiters: subject level titers of non-diseased subjects in the immunogenicity subset
</p>
<p>There are two possible scenarios
</p>

<ul>
<li>
<p> Full: Full information about non-diseased titers is available, i.e subject level data for all non-diseased subjects from the clinical trial (nondiseasedGenerationCount = number of all non-diseased subjects in the clinical trial).
</p>
</li>
<li>
<p> Ratio or Fixed: Information about non-diseased titers is available only for the immunogenicity subset. In order to compensate for these missing titers we upsampling of this subset to the total number of non-diseased (nondiseasedGenerationCount) in the trial is needed. 
</p>
</li>
</ul>
<p>nondiseasedGenerationCount: number of all non-diseased subjects in the clinical trial
</p>
<p>NOTE: Number of estimated parameters can be lower than repeatCount as MLE does not necessary converge in all estimations; failcount (number of iterations in which MLE failed to converge) is also returned; for details see <code>MLE</code> function.
</p>
<p>Function steps
</p>

<ul>
<li>
<p> Upsample non-diseased if needed (needed for methods Ratio and Fixed) - from immunogenicity subset size (N = NondiseasedImmunogenicitySubset$N) to the whole trial size (N = nondiseasedGenerationCount). For details see <code>GenerateNondiseased</code> function.
</p>
</li>
<li>
<p> Estimate PoD curve: resultsPriorReset
</p>
</li>
<li>
<p> Reset disease status: the purpose is to estimate the confidence intervals of the PoD curve and its parameters
</p>
<p>Part of the reset disease status procedure is the non-parametric bootstrap: titers of diseased and non-diseased subjects are pooled, and associated PoDs are calculated using their titer values and estimated PoD curve. Based on the subject level probabilities (PoDs), the disease status is reestimated.
</p>
</li>
<li>
<p> Re-estimate PoD curve: new diseased and non-diseased titers are used to reestimate the PoD curve
</p>
</li>
</ul>
<h3>Value</h3>

<p>results: PoD curve parameters after resetting the disease status, named data.frame of estimated PoD curve parameters (pmax, slope, et50); see details for more information
</p>
<p>resultsPriorReset: PoD curve parameters prior to resetting the status, named data.frame of estimated PoD curve parameters (pmax, slope, et50); see details for more information
</p>
<p>failcount: number of iterations in which MLE failed to converge; see details for more information
</p>


<h3>Examples</h3>

<pre><code class="language-R">## Data preparation
data(diseased)
data(nondiseased)

## Example 1
# Creating imunogenicity subset, method = "Full"
NondiseasedImmunogenicitySubset &lt;- 
    ImmunogenicitySubset(diseased, 
                         nondiseased, 
                         method = list(name = "Full", 
                                       value = "NA"))

# Number of all non-diseased subjects in the clinical trial
nondiseasedGenerationCount &lt;- nondiseased$N

PoDParamEstimation(diseased$titers,
                   NondiseasedImmunogenicitySubset$titers,
                   nondiseasedGenerationCount,
                   repeatCount = 10)

## Example 2
# Creating imunogenicity subset, method = "Ratio", value = 4
NondiseasedImmunogenicitySubset &lt;- 
    ImmunogenicitySubset(diseased, 
                         nondiseased, 
                         method = list(name = "Ratio", 
                                       value = 4))
                                       
# Number of all non-diseased subjects in the clinical trial
nondiseasedGenerationCount &lt;- nondiseased$N

PoDParamEstimation(diseased$titers,
                   NondiseasedImmunogenicitySubset$titers,
                   nondiseasedGenerationCount,
                   repeatCount = 10)

</code></pre>


</div>