<div class="container">

<table style="width: 100%;"><tr>
<td>varls</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>Procrustean Correlation, and Variance / Covariance Matrices.</h2>

<h3>Description</h3>

<p><code>varls</code>, <code>corls</code> compute the procrustean
variance / covariance, or correlation matrices
between a set of real matrices and <code>dist</code> objects.
</p>


<h3>Usage</h3>

<pre><code class="language-R">varls(..., nrand = 100, p_adjust_method = "holm")

corls(..., nrand = 100, p_adjust_method = "holm")
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>...</code></td>
<td>
<p>the set of matrices or a <code>procmod_frame</code>
object.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>nrand</code></td>
<td>
<p>number of randomisation used to estimate the mean
covariance observed between two random matrix.
If rand is <code>NULL</code> or equal to <code>0</code>, no correction
is estimated and the raw procrustean covariances are
estimated.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>p_adjust_method</code></td>
<td>
<p>the multiple test correction method used
to adjust p values. <code>p_adjust_method</code>
belongsone of the folowing values: <code>"holm"</code>,
<code>"hochberg"</code>, <code>"hommel"</code>, <code>"bonferroni"</code>,
<code>"BH"</code>, <code>"BY"</code>, <code>"fdr"</code>,  <code>"none"</code>.
The default is,set to <code>"holm"</code>.</p>
</td>
</tr>
</table>
<h3>Details</h3>

<p>Procrustean covariance between two matrices X and Y, is defined as the sum
of the singular values of the X'Y matrix (Gower 1971; Lingoes and Schönemann 1974).
Both the X and Y matrices must have the same number of rows.
</p>
<p>The variances and covariances and correlations are corrected
to avoid over fitting (Coissac and Gonindard-Melodelima 2019).
</p>
<p>The inputs must be numeric matrices or <code>dist</code> object.
The set of input matrices can be aggregated un a
<code>procmod_frame</code>.
</p>
<p>Before computing the coefficients, matrices are projected into an
orthogonal space using the <code>ortho</code> function.
</p>
<p>The denominator n - 1 is used which gives an unbiased estimator of the
(co)variance for i.i.d. observations.
</p>


<h3>Value</h3>

<p>a <code>procmod_varls</code> object which corresponds to a numeric
matrix annotated by several attributes.
</p>
<p>The following attribute is always added:
</p>
<p>- <code>nrand</code> an integer value indicating the number of
randomisations used to estimate the mean of the random
covariance.
</p>
<p>When <code>nrand</code> is greater than 0 a couple of attributes
is added:
</p>
<p>- <code>rcovls</code> a numeric matrix containing the estimation
of the mean of the random covariance.
</p>
<p>- <code>p.value</code> a numeric matrix containing the estimations
of the p.values of tests checking that the observed
covariance is larger than the mean of the random covariance.
p.values are corrected for multiple tests according to the
method specified by the <code>p_adjust_method</code> parameter.
</p>


<h3>Author(s)</h3>

<p>Eric Coissac
</p>
<p>Christelle Gonindard-Melodelima
</p>


<h3>References</h3>


<p>Gower JC (1971).
“Statistical methods of comparing different multivariate analyses of the same data.”
<em>Mathematics in the archaeological and historical sciences</em>, 138–149.
</p>
<p>Lingoes JC, Schönemann PH (1974).
“Alternative measures of fit for the Schönemann-carroll matrix fitting algorithm.”
<em>Psychometrika</em>, <b>39</b>(4), 423–427.
</p>
<p>Coissac E, Gonindard-Melodelima C (2019).
“Assessing the shared variation among high-dimensional data matrices: a modified version of the Procrustean correlation coefficient.”
<em>in prep</em>.

</p>


<h3>See Also</h3>

<p><code>p.adjust</code>
</p>


<h3>Examples</h3>

<pre><code class="language-R"># Build Three matrices of 3 rows.
A &lt;- simulate_matrix(10,3)
B &lt;- simulate_matrix(10,5)
C &lt;- simulate_correlation(B,10,r2=0.6)

# Computes the variance covariance matrix
varls(A = A, B = B, C = C)

data = procmod_frame(A = A, B = B, C = C)
varls(data)

# Computes the correlation matrix
corls(data, nrand = 100)

</code></pre>


</div>