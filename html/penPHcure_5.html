<div class="container">

<table style="width: 100%;"><tr>
<td>penPHcure.simulate</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>Simulation of a PH cure model with time-varying covariates</h2>

<h3>Description</h3>

<p>This function allows to simulate data from a PH cure model with time-varying covariates:
</p>

<ul>
<li>
<p> the event-times are generated on a continuous scale from a piecewise exponential distribution conditional on time-varying covariates and regression coefficients <code>beta0</code>, using a method similar to the one described in <em>Hendry (2014)</em>. The time varying covariates are constant in the intervals <code class="reqn">(s_{j-1},s_j]</code>, for <code class="reqn">j=1,,,,J</code>.
</p>
</li>
<li>
<p> the censoring times are generated from an exponential distribution truncated above <code class="reqn">s_J</code>;
</p>
</li>
<li>
<p> the susceptibility indicators are generated from a logistic regression model conditional on time-invariant covariates and regression coefficients <code>b0</code>.
</p>
</li>
</ul>
<h3>Usage</h3>

<pre><code class="language-R">penPHcure.simulate(
  N = 500,
  S = seq(0.1, 5, by = 0.1),
  b0 = c(1.2, -1, 0, 1, 0),
  beta0 = c(1, 0, -1, 0),
  gamma = 1,
  lambdaC = 1,
  mean_CURE = rep(0, length(b0) - 1L),
  mean_SURV = rep(0, length(beta0)),
  sd_CURE = rep(1, length(b0) - 1L),
  sd_SURV = rep(1, length(beta0)),
  cor_CURE = diag(length(b0) - 1L),
  cor_SURV = diag(length(beta0)),
  X = NULL,
  Z = NULL,
  C = NULL
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>N</code></td>
<td>
<p>the sample size (number of individuals). By default, <code>N = 500</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>S</code></td>
<td>
<p>a numeric vector containing the end of the time intervals, in ascending order, over which the time-varying covariates are constant (the first interval start at 0). By default, <code>S = seq(0.1, 5, by=0.1)</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>b0</code></td>
<td>
<p>a numeric vector with the true coefficients in the incidence (cure) component, used to generate the susceptibility indicators. By default, <code>b0 = c(1.2,-1,0,1,0)</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>beta0</code></td>
<td>
<p>a numeric vector with the true regression coefficients in the latency (survival)  component, used to generate the event times. By default, <code>beta0 = c(1,0,-1,0)</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>gamma</code></td>
<td>
<p>a positive numeric value, parameter controlling the shape of the baseline hazard function: <code class="reqn">\lambda_0(t) = \gamma t^{\gamma-1}</code>. By default, <code>gamma = 1</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>lambdaC</code></td>
<td>
<p>a positive numeric value, parameter of the truncated exponential distribution used to generate the censoring times. By default, <code>lambdaC = 1</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>mean_CURE</code></td>
<td>
<p>a numeric vector of means for the variables used to generate the susceptibility indicators. By default, all zeros.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>mean_SURV</code></td>
<td>
<p>a numeric vector of means for the variables used to generate the event-times. By default, all zeros.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>sd_CURE</code></td>
<td>
<p>a numeric vector of standard deviations for the variables used to generate the susceptibility indicators. By default, all ones.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>sd_SURV</code></td>
<td>
<p>a numeric vector of standard deviations for the variables used to generate the event-times. By default, all ones.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>cor_CURE</code></td>
<td>
<p>the correlation matrix of the variables used to generate the susceptibility indicators. By default, an identity matrix.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>cor_SURV</code></td>
<td>
<p>the correlation matrix of the variables used to generate the event-times. By default, an identity matrix.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>X</code></td>
<td>
<p>[optional] a matrix of time-invariant covariates used to generate the susceptibility indicators, with dimension <code>N</code> by <code>length(b0)-1L</code>. By default, <code>X = NULL</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>Z</code></td>
<td>
<p>[optional] an array of time-varying covariates used to generate the censoring times, with dimension <code>length(S)</code> by <code>length(beta)</code> by <code>N</code>. By default, <code>Z = NULL</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>C</code></td>
<td>
<p>[optional] a vector of censoring times with <code>N</code> elements.  By default, <code>C = NULL</code>.</p>
</td>
</tr>
</table>
<h3>Details</h3>

<p>By default, the time-varying covariates in the latency (survival) component are generated from a multivariate normal distribution with means <code>mean_SURV</code>, standard deviations <code>sd_SURV</code> and correlation matrix <code>cor_SURV</code>. Otherwise, they can be provided by the user using the argument <code>Z</code>. In this case, the arguments <code>mean_SURV</code>, <code>sd_SURV</code> and <code>cor_SURV</code> will be ignored. 
</p>
<p>By default, the time-invariant covariates in the incidence (cure) component are generated from a multivariate normal distribution with means <code>mean_CURE</code>, standard deviations <code>sd_CURE</code> and correlation matrix <code>cor_CURE</code>. Otherwise, they can be provided by the user using the argument <code>X</code>. In this case, the arguments <code>mean_CURE</code>, <code>sd_CURE</code> and <code>cor_CURE</code> will be ignored.
</p>


<h3>Value</h3>

<p>A <code>data.frame</code> with columns:
</p>
<table>
<tr style="vertical-align: top;">
<td><code>id</code></td>
<td>
<p>unique ID number associated to each individual.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>tstart</code></td>
<td>
<p>start of the time interval.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>tstop</code></td>
<td>
<p>end of the time interval.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>status</code></td>
<td>
<p>event indicator, 1 if the event occurs or 0, otherwise.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>z.?</code></td>
<td>
<p>one or more columns of covariates used to generate the survival times.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>x.?</code></td>
<td>
<p>one or more columns of covariates used to generate the susceptibility indicator (constant over time).</p>
</td>
</tr>
</table>
<p>In addition, it contains the following attributes:
</p>
<table>
<tr style="vertical-align: top;">
<td><code>perc_cure</code></td>
<td>
<p>Percentage of individuals not susceptible to the event of interest.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>perc_cens</code></td>
<td>
<p>Percentage of censoring.</p>
</td>
</tr>
</table>
<h3>References</h3>

<p>Hendry DJ (2014).
“Data generation for the Cox proportional hazards model with time-dependent covariates: a method for medical researchers.”
<em>Statistics in Medicine</em>, <b>33</b>(3), 436-454.
doi: <a href="https://doi.org/10.1002/sim.5945">10.1002/sim.5945</a>.
</p>


<h3>Examples</h3>

<pre><code class="language-R">### Example 1:
###  - event-times generated from a Cox's PH model with unit baseline hazard
###    and time-varying covariates generated from independent standard normal 
###    distributions over the intervals (0,s_1], (s_1,s_2], ..., (s_1,s_J]. 
###  - censoring times generated from an exponential distribution truncated 
###    above s_J.
###  - covariates in the incidence (cure) component generated from independent 
###    standard normal distributions.

# Define the sample size
N &lt;- 250
# Define the time intervals for the time-varying covariates
S &lt;- seq(0.1, 5, by=0.1)
# Define the true regression coefficients (incidence and latency)  
b0 &lt;- c(1,-1,0,1,0)
beta0 &lt;- c(1,0,-1,0)
# Define the parameter of the truncated exponential distribution (censoring) 
lambdaC &lt;- 1.5
# Simulate the data
data1 &lt;- penPHcure.simulate(N = N,S = S,
                            b0 = b0,
                            beta0 = beta0,
                            lambdaC = lambdaC)

                           
### Example 2:
###  Similar to the previous example, but with a baseline hazard function 
###   defined as lambda_0(t) = 3t^2.

# Define the sample size
N &lt;- 250
# Define the time intervals for the time-varying covariates
S &lt;- seq(0.1, 5, by=0.1)
# Define the true regression coefficients (incidence and latency)  
b0 &lt;- c(1,-1,0,1,0)
beta0 &lt;- c(1,0,-1,0)
# Define the parameter controlling the shape of the baseline hazard function
gamma &lt;- 3
# Simulate the data
data2 &lt;- penPHcure.simulate(N = N,S = S,
                            b0 = b0,
                            beta0 = beta0,
                            gamma = gamma)


### Example 3:
###  Simulation with covariates in the cure and survival components generated
###   from multivariate normal (MVN) distributions with specific means, 
###   standard deviations and correlation matrices.

# Define the sample size
N &lt;- 250
# Define the time intervals for the time-varying covariates
S &lt;- seq(0.1, 5, by=0.1)
# Define the true regression coefficients (incidence and latency)  
b0 &lt;- c(-1,-1,0,1,0)
beta0 &lt;- c(1,0,-1,0)
# Define the means of the MVN distribution (incidence and latency)  
mean_CURE &lt;- c(-1,0,1,2)
mean_SURV &lt;- c(2,1,0,-1)
# Define the std. deviations of the MVN distribution (incidence and latency)  
sd_CURE &lt;- c(0.5,1.5,1,0.5)
sd_SURV &lt;- c(0.5,1,1.5,0.5)
# Define the correlation matrix of the MVN distribution (incidence and latency)  
cor_CURE &lt;- matrix(NA,4,4)
for (p in 1:4)
  for (q in 1:4)
    cor_CURE[p,q] &lt;- 0.8^abs(p - q)
cor_SURV &lt;- matrix(NA,4,4)
for (p in 1:4)
  for (q in 1:4)
    cor_SURV[p,q] &lt;- 0.8^abs(p - q)
# Simulate the data
data3 &lt;- penPHcure.simulate(N = N,S = S,
                            b0 = b0,
                            beta0 = beta0,
                            mean_CURE = mean_CURE,
                            mean_SURV = mean_SURV,
                            sd_CURE = sd_CURE,
                            sd_SURV = sd_SURV,
                            cor_CURE = cor_CURE,
                            cor_SURV = cor_SURV)


### Example 4:
###  Simulation with covariates in the cure and survival components from a 
###   data generating process specified by the user. 

# Define the sample size
N &lt;- 250
# Define the time intervals for the time-varying covariates
S &lt;- seq(0.1, 5, by=0.1)
# Define the true regression coefficients (incidence and latency)  
b0 &lt;- c(1,-1,0,1,0)
beta0 &lt;- c(1,0,-1,0)
# As an example, we simulate data with covariates following independent
#  standard uniform distributions. But the user could provide random draws 
#  from any other distribution. Be careful!!! X should be a matrix of size 
#  N x length(b0) and Z an array of size length(S) x length(beta0) x N.
X &lt;- matrix(runif(N*(length(b0)-1)),N,length(b0)-1)
Z &lt;- array(runif(N*length(S)*length(beta0)),c(length(S),length(beta0),N))
data4 &lt;- penPHcure.simulate(N = N,S = S,
                            b0 = b0,
                            beta0 = beta0,
                            X = X,
                            Z = Z)


### Example 5:
###  Simulation with censoring times from a data generating process 
###   specified by the user

# Define the sample size
N &lt;- 250
# Define the time intervals for the time-varying covariates
S &lt;- seq(0.1, 5, by=0.1)
# Define the true regression coefficients (incidence and latency)  
b0 &lt;- c(1,-1,0,1,0)
beta0 &lt;- c(1,0,-1,0)
# As an example, we simulate data with censoring times following
#  a standard uniform distribution between 0 and S_J.
#  Be careful!!! C should be a numeric vector of length N.
C &lt;- runif(N)*max(S)
data5 &lt;- penPHcure.simulate(N = N,S = S,
                            b0 = b0,
                            beta0 = beta0,
                            C = C)
                           
</code></pre>


</div>