<div class="container">

<table style="width: 100%;"><tr>
<td>designTree</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>Compute a design matrix or non-negative LS</h2>

<h3>Description</h3>

<p><code>nnls.tree</code> estimates the branch length using non-negative least
squares given a tree and a distance matrix.  <code>designTree</code> and
<code>designSplits</code> compute design matrices for the estimation of edge
length of (phylogenetic) trees using linear models.  For larger trees a
sparse design matrix can save a lot of memory. 
computes a contrast matrix if the method is "rooted".
</p>


<h3>Usage</h3>

<pre><code class="language-R">designTree(tree, method = "unrooted", sparse = FALSE, tip.dates = NULL,
  calibration = NULL, ...)

nnls.tree(dm, tree, method = c("unrooted", "ultrametric", "tipdated"),
  rooted = NULL, trace = 1, weight = NULL, balanced = FALSE,
  tip.dates = NULL)

nnls.phylo(x, dm, method = "unrooted", trace = 0, ...)

nnls.splits(x, dm, trace = 0, eps = 1e-08)

nnls.networx(x, dm, eps = 1e-08)

designSplits(x, splits = "all", ...)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>tree</code></td>
<td>
<p>an object of class <code>phylo</code></p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>method</code></td>
<td>
<p>compute an "unrooted", "ultrametric" or "tipdated" tree.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>sparse</code></td>
<td>
<p>return a sparse design matrix.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>tip.dates</code></td>
<td>
<p>a named vector of sampling times associated to the tips of
the tree.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>calibration</code></td>
<td>
<p>a named vector of calibration times associated to nodes of
the tree.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>...</code></td>
<td>
<p>further arguments, passed to other methods.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>dm</code></td>
<td>
<p>a distance matrix.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>rooted</code></td>
<td>
<p>compute a "ultrametric" or "unrooted" tree (better use method).</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>trace</code></td>
<td>
<p>defines how much information is printed during optimization.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>weight</code></td>
<td>
<p>vector of weights to be used in the fitting process.
Weighted least squares is used with weights w, i.e., sum(w * e^2) is
minimized.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>balanced</code></td>
<td>
<p>use weights as in balanced fastME</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>x</code></td>
<td>
<p>number of taxa.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>eps</code></td>
<td>
<p>minimum edge length (default s 1e-8).</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>splits</code></td>
<td>
<p>one of "all", "star".</p>
</td>
</tr>
</table>
<h3>Value</h3>

<p><code>nnls.tree</code> return a tree, i.e. an object of class
<code>phylo</code>.  <code>designTree</code> and <code>designSplits</code> a matrix, possibly
sparse.
</p>


<h3>Author(s)</h3>

<p>Klaus Schliep <a href="mailto:klaus.schliep@gmail.com">klaus.schliep@gmail.com</a>
</p>


<h3>See Also</h3>

<p><code>fastme</code>, <code>rtt</code>,
<code>distanceHadamard</code>,
<code>splitsNetwork</code>, <code>upgma</code>
</p>


<h3>Examples</h3>

<pre><code class="language-R">
example(NJ)
dm &lt;-  as.matrix(dm)
y &lt;- dm[lower.tri(dm)]
X &lt;- designTree(tree)
lm(y~X-1)
# avoids negative edge weights
tree2 &lt;- nnls.tree(dm, tree)

</code></pre>


</div>