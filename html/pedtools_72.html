<div class="container">

<table style="width: 100%;"><tr>
<td>inbreedingLoops</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>Pedigree loops</h2>

<h3>Description</h3>

<p>Functions for identifying, breaking and restoring loops in pedigrees.
</p>


<h3>Usage</h3>

<pre><code class="language-R">inbreedingLoops(x)

breakLoops(x, loopBreakers = NULL, verbose = TRUE, errorIfFail = TRUE)

tieLoops(x, verbose = TRUE)

findLoopBreakers(x)

findLoopBreakers2(x, errorIfFail = TRUE)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>x</code></td>
<td>
<p>a <code>ped()</code> object.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>loopBreakers</code></td>
<td>
<p>either NULL (resulting in automatic selection of loop
breakers) or a numeric containing IDs of individuals to be used as loop
breakers.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>verbose</code></td>
<td>
<p>a logical: Verbose output or not?</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>errorIfFail</code></td>
<td>
<p>a logical: If TRUE an error is raised if the loop breaking
is unsuccessful. If FALSE, the pedigree is returned unchanged.</p>
</td>
</tr>
</table>
<h3>Details</h3>

<p>Pedigree loops are usually handled (by pedtools and related packages) under
the hood - using the functions described here - without need for explicit
action from end users. When a ped object <code>x</code> is created, an internal routine
detects if the pedigree contains loops, in which case <code>x$UNBROKEN_LOOPS</code> is
set to TRUE.
</p>
<p>In cases with complex inbreeding, it can be instructive to plot the pedigree
after breaking the loops. Duplicated individuals are plotted with appropriate
labels (see examples).
</p>
<p>The function <code>findLoopBreakers</code> identifies a set of individuals breaking all
inbreeding loops, but not marriage loops. These require more machinery for
efficient detection, and pedtools does this is a separate function,
<code>findLoopBreakers2</code>, utilizing methods from the <code>igraph</code> package. Since this
is rarely needed for most users, <code>igraph</code> is not imported when loading
pedtools, only when <code>findLoopBreakers2</code> is called.
</p>
<p>In practice, <code>breakLoops</code> first calls <code>findLoopBreakers</code> and breaks at the
returned individuals. If the resulting ped object still has loops,
<code>findLoopBreakers2</code> is called to break any marriage loops.
</p>


<h3>Value</h3>

<p>For <code>breakLoops</code>, a <code>ped</code> object in which the indicated loop breakers
are duplicated. The returned object will also have a non-null
<code>loopBreakers</code> entry, namely a matrix with the IDs of the original loop
breakers in the first column and the duplicates in the second. If loop
breaking fails, then depending on <code>errorIfFail</code> either an error is raised,
or the input pedigree is returned, still containing unbroken loops.
</p>
<p>For <code>tieLoops</code>, a <code>ped</code> object in which any duplicated individuals (as
given in the <code>x$LOOP_BREAKERS</code> entry) are merged. For any ped object <code>x</code>,
the call <code>tieLoops(breakLoops(x))</code> should return <code>x</code>.
</p>
<p>For <code>inbreedingLoops</code>, a list containing all inbreeding loops (not marriage
loops) found in the pedigree. Each loop is represented as a list with
elements <code>top</code>, <code>bottom</code>, <code>pathA</code> (individuals forming a path from top to
bottom) and <code>pathB</code> (creating a different path from top to bottom, with no
individuals in common with <code>pathA</code>). Note that the number of loops reported
here counts all closed paths in the pedigree and will in general be larger
than the genus of the underlying graph.
</p>
<p>For <code>findLoopBreakers</code> and <code>findLoopBreakers2</code>, a numeric vector of
individual ID's.
</p>


<h3>Author(s)</h3>

<p>Magnus Dehli Vigeland
</p>


<h3>Examples</h3>

<pre><code class="language-R">
x = cousinPed(1, child = TRUE)
plot(breakLoops(x))

# Pedigree with marriage loop: Double first cousins
if(requireNamespace("igraph", quietly = TRUE)) {
  y = doubleCousins(1, 1, child = TRUE)
  findLoopBreakers(y) # --&gt; 9
  findLoopBreakers2(y) # --&gt; 7 and 9
  y2 = breakLoops(y)
  plot(y2)

  # Or loop breakers chosen by user
  y3 = breakLoops(y, 6:7)
  plot(y3)
}

</code></pre>


</div>