<div class="container">

<table style="width: 100%;"><tr>
<td>anc.Bayes</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>Bayesian ancestral character estimation</h2>

<h3>Description</h3>

<p>This function uses Bayesian MCMC to sample from the posterior distribution for the states at internal nodes in the tree.
</p>


<h3>Usage</h3>

<pre><code class="language-R">anc.Bayes(tree, x, ngen=10000, control=list(), ...)
## S3 method for class 'anc.Bayes'
plot(x, ...)
## S3 method for class 'anc.Bayes'
density(x, ...)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>tree</code></td>
<td>
<p>an object of class <code>"phylo"</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>x</code></td>
<td>
<p>a vector of tip values for species; <code>names(x)</code> should be the species names. In the case of the <code>plot</code> and <code>density</code> methods, an object of class <code>"anc.Bayes"</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>ngen</code></td>
<td>
<p>a integer indicating the number of generations for the MCMC.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>control</code></td>
<td>
<p>a list of control parameters containing the following elements: <code>sig2</code>: starting value for <code class="reqn">\sigma^2</code> (BM rate); <code>a</code>: starting for the state at the root node; <code>y</code>: starting values for the states at all internal nodes excluding the root (should be labeled with node numbers); <code>pr.mean</code>: means for the prior distributions in the following order - <code>sig2</code>, <code>a</code>, <code>y</code>, note that the prior probability distribution is exponential for <code>sig2</code> and normal for <code>a</code> and <code>y</code>; <code>pr.var</code>: variances on the prior distributions, same order as <code>pr.mean</code> (but the variance is not used for <code>sig2</code>); <code>prop</code>: variances on the normal proposal distributions in the same order as <code>pr.mean</code>; <code>sample</code>: sample frequency from the MCMC.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>...</code></td>
<td>
<p>optional arguments, including to be passed to <code>plot</code> and <code>density</code> methods.</p>
</td>
</tr>
</table>
<h3>Details</h3>

<p><code>plot.anc.Bayes</code> generates a likelihood profile plot of the MCMC by default, but can also create a profile plot for any of the sampled variables by using the optional argument <code>what</code>. For instance, <code>what=40</code> (or, equivalently, <code>what="40"</code>) will create a profile plot of the MCMC for node <code>40</code>. Additional arguments are passed to <code>plot</code>.
</p>
<p><code>density.anc.Bayes</code> computes a posterior density from the MCMC sample. Like <code>plot.anc.Bayes</code> takes the optional argument <code>what</code>, but unlike <code>plot.anc.Bayes</code> computes the posterior density for the root node by default. The object computed by this function is of class <code>"density"</code> and can be visualized using <code>plot.density</code>. Burn-in (in generations) can be set using the optional argument <code>burnin</code>, otherwise it will be assumed to be 20
</p>
<p>The <code>print</code> and <code>summary</code> methods for this object class also return (invisibly) a vector of estimated ancestral states based on a user-supplied burn-in (or 20% of the number of generations of MCMC, if no burn-in is provided). Burn-in can be specified with the optional argument <code>burnin</code>.
</p>


<h3>Value</h3>

<p><code>anc.Bayes</code> returns an object of class <code>"anc.Bayes"</code> including at least two components: 
</p>
<table>
<tr style="vertical-align: top;">
<td><code>mcmc</code></td>
<td>
<p>a data frame with rows <code>ngen/sample+1</code> containing the posterior sample and likelihoods.  Matrix columns are labeled either <code>sig2</code> or by the node number of the internal node.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>tree</code></td>
<td>
<p>our input phylogeny.</p>
</td>
</tr>
</table>
<h3>Author(s)</h3>

<p>Liam Revell <a href="mailto:liam.revell@umb.edu">liam.revell@umb.edu</a></p>


<h3>References</h3>

<p>Revell, L. J. (2024) phytools 2.0: an updated R ecosystem for phylogenetic comparative methods (and other things). <em>PeerJ</em>, <b>12</b>, e16505.
</p>


<h3>See Also</h3>

<p><code>ace</code>, <code>anc.ML</code>, <code>anc.trend</code>, <code>evol.rate.mcmc</code>, <code>fastAnc</code>
</p>


<h3>Examples</h3>

<pre><code class="language-R">## set seed
set.seed(77)
## load data from Garland et al. (1992)
data(mammal.tree)
data(mammal.data)
## extract character of interest
ln.bodyMass&lt;-log(setNames(mammal.data$bodyMass,
    rownames(mammal.data)))
## run MCMC (should be run at least 1e6 generations)
mcmc&lt;-anc.Bayes(mammal.tree,ln.bodyMass,
    ngen=50000)
print(mcmc,printlen=20) ## estimates
par(mfrow=c(2,1))
plot(mcmc,bty="l",main="Likelihood-profile from MCMC",
    font.main=3) ## likelihood-profile
plot(density(mcmc,what=Ntip(mammal.tree)+1,
    burnin=20000),bty="l",
    main="Posterior density for root state of log(body mass)",
    font.main=3)
par(mfrow=c(1,1)) ## reset par to default
</code></pre>


</div>