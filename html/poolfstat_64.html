<div class="container">

<table style="width: 100%;"><tr>
<td>graph.params-class</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>S4 class to represent a population tree or admixture graph and its underlying parameter.</h2>

<h3>Description</h3>

<p>S4 class to represent a population tree or admixture graph and its underlying parameter.
</p>


<h3>Details</h3>

<p>The graph is specified by a three column (character) matrix giving for each edge (whether admixed or not) to i) the child node; ii) the parent node; iii) the admixture proportion. For non-admixed edge, the third column must be blank. An admixed node should be referred two times as a child node with two different parent node and two different admixture proportions coded as alpha and (1-alpha) (parentheses are mandatory) if alpha is the name of the parameter for admixture proportion. The dot.graph element allows to plot the graph using grViz() from the DiagrammeR package or with the dot program after writing the files (e.g., dot -Tpng inputgraph.dot in terminal). Note that the dot file may be customized (e.g., to change leave color, parameter names...).
</p>


<h3>Slots</h3>


<dl>
<dt><code>graph</code></dt>
<dd>
<p>The graph in 3 column format (see details)</p>
</dd>
<dt><code>dot.graph</code></dt>
<dd>
<p>The graph in dot format</p>
</dd>
<dt><code>is.admgraph</code></dt>
<dd>
<p>If FALSE the graph is binary tree (i.e., no admixture events), if TRUE the graph is an admixture graph</p>
</dd>
<dt><code>n.leaves</code></dt>
<dd>
<p>Number of leaves of the graph</p>
</dd>
<dt><code>leaves</code></dt>
<dd>
<p>Name of the leaves</p>
</dd>
<dt><code>root.name</code></dt>
<dd>
<p>Name of the root</p>
</dd>
<dt><code>n.nodes</code></dt>
<dd>
<p>Number of nodes (including root)</p>
</dd>
<dt><code>nodes.names</code></dt>
<dd>
<p>Name of the nodes</p>
</dd>
<dt><code>n.edges</code></dt>
<dd>
<p>Number of edges (including admixture edges)</p>
</dd>
<dt><code>edges.names</code></dt>
<dd>
<p>Names of the edges (coded as "Parent node Name"&lt;-&gt;"Child node Name")</p>
</dd>
<dt><code>n.adm.nodes</code></dt>
<dd>
<p>Number of admixed nodes (=0 if is.admgraph=FALSE). This is also the number of admixed parameters since only two-ways admixture are assumed for a given node</p>
</dd>
<dt><code>adm.params.names</code></dt>
<dd>
<p>Names of the admixed parameters</p>
</dd>
<dt><code>graph.matrix</code></dt>
<dd>
<p>The graph incidence matrix consisting of n.leaves rows and n.edges columns. The elements of the matrix are the weights of each edge (in symbolic representation) for the different possible paths from the leaves to the graph root.</p>
</dd>
<dt><code>root.edges.idx</code></dt>
<dd>
<p>Indexes of the graph.matrix columns associated to the (two) edges connected to the root</p>
</dd>
<dt><code>f2.target</code></dt>
<dd>
<p>The (n.leaves-1) stats F2 involving popref (i.e., of the form F2(popref;pop))</p>
</dd>
<dt><code>f2.target.pops</code></dt>
<dd>
<p>A matrix of (n.leaves-1) rows and 2 columns containing the names of populations of the F2 stats. The first column is by construction always popref. The order is the same as in f2.target</p>
</dd>
<dt><code>f3.target</code></dt>
<dd>
<p>The (n.leaves-1)(n.leaves-2)/2 stats F3 involving popref as a target (i.e., of the form F3(popref;popA,popB))</p>
</dd>
<dt><code>f3.target.pops</code></dt>
<dd>
<p>A matrix of (n.leaves-1)(n.leaves-2)/2 rows and 3 columns containing the name of popref in the first column and the names of the two populations involved in the F3 stats. The order is the same as in f3.target</p>
</dd>
<dt><code>popref</code></dt>
<dd>
<p>The name of the reference population defining the fstats basis</p>
</dd>
<dt><code>f.Qmat</code></dt>
<dd>
<p>A square matrix of rank n.leaves(n.leaves-1)/2 corresponding to the error covariance matrix of the F2 and F3 estimates</p>
</dd>
<dt><code>Het</code></dt>
<dd>
<p>Estimated leave heterozygosities (if present in the fstats object)</p>
</dd>
</dl>
<h3>See Also</h3>

<p>To generate graph.params object, see <code>generate.graph.params</code>. The object may be used to estimate graph parameters with the function <code>fit.graph</code> or to generate files for the qpGraph software with <code>graph.params2qpGraphFiles</code>. See also <code>graph.params2symbolic.fstats</code> to obtain symbolic representation of Fstats from the matrix "Omega".
</p>


</div>