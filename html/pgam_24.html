<div class="container">

<table style="width: 100%;"><tr>
<td>pgam.likelihood</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>Likelihood function to be maximized</h2>

<h3>Description</h3>

<p>This is the log-likelihood function that is passed to <code>optim</code> for likelihood maximization.
</p>


<h3>Usage</h3>

<pre><code class="language-R">pgam.likelihood(par, y, x, offset, fperiod, env = parent.frame())
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>par</code></td>
<td>
<p>vector of parameters to be optimized</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>y</code></td>
<td>
<p>observed time series which is the response variable of the model</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>x</code></td>
<td>
<p>observed explanatory variables for parametric fit</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>offset</code></td>
<td>
<p>model offset. Just like in GLM</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>fperiod</code></td>
<td>
<p>vector of seasonal factors to be passed to <code>pgam.par2psi</code></p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>env</code></td>
<td>
<p>the caller environment for log-likelihood value to be stored</p>
</td>
</tr>
</table>
<h3>Details</h3>

<p>Log-likelihood function of hyperparameters <code class="reqn">\omega</code> and <code class="reqn">\beta</code> is given by
</p>
<p style="text-align: center;"><code class="reqn">\log L\left(\omega,\beta\right)=\sum_{t=\tau+1}^{n}{\log \Gamma\left(a_{t|t-1}+y_{t}\right)-\log y_{t}!-\log \Gamma\left(a_{t|t-1}\right)+a_{t|t-1}\log b_{t|t-1}-\left(a_{t|t-1}+y_{t}\right)\log \left(1+b_{t|t-1}\right)}</code>
</p>

<p>where <code class="reqn">a_{t|t-1}</code> and <code class="reqn">b_{t|t-1}</code> are estimated as it is shown in <code>pgam.filter</code>.
</p>


<h3>Value</h3>

<p>List containing log-likelihood value, optimum linear predictor and the gamma parameters vectors.</p>


<h3>Note</h3>

<p>This function is not intended to be called directly.
</p>


<h3>Author(s)</h3>

<p>Washington Leite Junger <a href="mailto:wjunger@ims.uerj.br">wjunger@ims.uerj.br</a> and Antonio Ponce de Leon <a href="mailto:ponce@ims.uerj.br">ponce@ims.uerj.br</a>
</p>


<h3>References</h3>

<p>Harvey, A. C., Fernandes, C. (1989) Time series models for count data or qualitative observations. Journal of Business and Economic Statistics, 7(4):407â€“417
</p>
<p>Harvey, A. C. (1990) Forecasting, structural time series models and the Kalman Filter. Cambridge, New York
</p>
<p>Junger, W. L. (2004) Semiparametric Poisson-Gamma models: a roughness penalty approach. MSc Dissertation. Rio de Janeiro, PUC-Rio, Department of Electrical Engineering. 
</p>


<h3>See Also</h3>

<p><code>pgam</code>, <code>pgam.filter</code>, <code>pgam.fit</code></p>


</div>