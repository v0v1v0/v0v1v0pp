<div class="container">

<table style="width: 100%;"><tr>
<td>WVC_pls</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>Weighted Variable Contribution in PLS (WVC-PLS)</h2>

<h3>Description</h3>

<p>This implements the PLS-WVC2 component dependent version of WVC from Lin et al., i.e.,
using Equations 14, 16 and 19. The 
implementation is used in T. Mehmood, S. Sæbø, K.H. Liland, Comparison of variable selection methods in partial least
squares regression, Journal of Chemometrics 34 (2020) e3226. However, there is a mistake
in the notation in Mehmood et al. exchanging the denominator of Equation 19 (w'X'Xw) with (w'X'Yw).
</p>


<h3>Usage</h3>

<pre><code class="language-R">WVC_pls(y, X, ncomp, normalize = FALSE, threshold = NULL)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>y</code></td>
<td>
<p>Vector of responses.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>X</code></td>
<td>
<p>Matrix of predictors.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>ncomp</code></td>
<td>
<p>Number of components.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>normalize</code></td>
<td>
<p>Divide WVC vectors by maximum value.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>threshold</code></td>
<td>
<p>Set loading weights smaller than threshold to 0 and recompute component.</p>
</td>
</tr>
</table>
<h3>Value</h3>

<p>loading weights, loadings, regression coefficients, scores and Y-loadings
plus the WVC weights.
</p>


<h3>References</h3>

<p>Variable selection in partial least squares with the weighted variable contribution to the first singular value of the covariance matrix,
Weilu Lin, Haifeng Hang, Yingping Zhuang, Siliang Zhang, Chemometrics and Intelligent Laboratory Systems 183 (2018) 113–121.
</p>


<h3>Examples</h3>

<pre><code class="language-R">library(pls)
data(mayonnaise, package = "pls")
wvc &lt;- WVC_pls(factor(mayonnaise$oil.type), mayonnaise$NIR, 10)
wvcNT &lt;- WVC_pls(factor(mayonnaise$oil.type), mayonnaise$NIR, 10, TRUE, 0.5)
old.par &lt;- par(mfrow=c(3,1), mar=c(2,4,1,1))
matplot(t(mayonnaise$NIR), type='l', col=1, ylab='intensity')
matplot(wvc$W[,1:3], type='l', ylab='W')
matplot(wvcNT$W[,1:3], type='l', ylab='W, thr.=0.5')
par(old.par)

</code></pre>


</div>