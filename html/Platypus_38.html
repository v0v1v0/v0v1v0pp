<div class="container">

<table style="width: 100%;"><tr>
<td>VDJ_expand_aberrants</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>Expand the aberrant cells in a VDJ dataframe by converting them into additional rows</h2>

<h3>Description</h3>

<p>Expand the aberrant cells in a VDJ dataframe by converting them into additional rows. Aberrant cells consist of cells with more than 1 VDJ or VJ chain.
</p>


<h3>Usage</h3>

<pre><code class="language-R">VDJ_expand_aberrants(
  VDJ,
  chain.to.expand,
  add.barcode.prefix,
  additional.VDJ.features,
  additional.VJ.features,
  add.CDR3aa,
  add.expanded.number,
  recalculate.clonotype.frequency
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>VDJ</code></td>
<td>
<p>VDJ or VDJ.GEX.matrix[[1]] object, as obtained from the VDJ_GEX_matrix function in Platypus.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>chain.to.expand</code></td>
<td>
<p>string, 'VDJ' to expand VDJ aberrants, 'VJ' to expand VJ aberrants, 'VDJ.VJ' for both.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>add.barcode.prefix</code></td>
<td>
<p>boolean - if T, a new barcode will be added for each expanded aberrant.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>additional.VDJ.features</code></td>
<td>
<p>vector of strings - VDJ_expand_aberrants will only expand across the sequence columns of VDJ. If you have additional columns with aberrant cell features (e.g., both 'yes' and 'no' binders for a single sequence), where the aberrants are VDJ-specific, include them here.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>additional.VJ.features</code></td>
<td>
<p>vector of strings - VDJ_expand_aberrants will only expand across the sequence columns of VDJ. If you have additional columns with aberrant cell features (e.g., both 'yes' and 'no' binders for a single sequence), where the aberrants are VJ-specific, include them here.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>add.CDR3aa</code></td>
<td>
<p>boolean - if T, will create a new column 'CDR3aa' with pasted VDJ_cdr3s_aa and VJ_cdr3s_aa.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>add.expanded.number</code></td>
<td>
<p>boolean - if T, will add the number of new cells resulting from an aberrant one.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>recalculate.clonotype.frequency</code></td>
<td>
<p>boolean - if T, will recalculate the clonotype frequencies for the resulting, expanded VDJ.</p>
</td>
</tr>
</table>
<h3>Value</h3>

<p>Returns a VDJ format dataframe in which cells with more than one VDJ or VJ chain are split into multiple rows each containing only one VDJ VJ chain combination.
</p>


<h3>Examples</h3>

<pre><code class="language-R">VDJ_expand_aberrants(VDJ = Platypus::small_vgm[[1]],
chain.to.expand='VDJ.VJ',
add.barcode.prefix=TRUE, recalculate.clonotype.frequency=FALSE)

</code></pre>


</div>