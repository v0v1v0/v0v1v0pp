<div class="container">

<table style="width: 100%;"><tr>
<td>wsph</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>
Spherize/Whiten data with observational weights
</h2>

<h3>Description</h3>

<p>This function performs PCA sphering/whitening transformation on data with observational weights.
</p>


<h3>Usage</h3>

<pre><code class="language-R">wsph(data,weight)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>data</code></td>
<td>

<p>A data matrix (of class matrix, or data.frame) containing only entries of class numeric.
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>weight</code></td>
<td>
<p>Vector of length nrow(data) of weights for each observation in the dataset. Must be of class numeric or integer or table. If NULL, the default value is a vector of 1 with length nrow(data), i.e., weights equal 1 for all observations.
</p>
</td>
</tr>
</table>
<h3>Details</h3>

<p>This function performs PCA sphering/whitening transformation on data with observational weights. Specifically, weighted sample mean and weighted sample covariance matrix are firstly calculated. Next, data are centered with weights, and spectral decomposition of the weighted covariance matrix is conducted to obtain its eigenvalues and eigenvectors. Based on them, the PCA sphering/whitening transformation is performed to obtain a spherized data matrix considering the observational weights. The spherized data matrix has a zero weighted mean for each column, and a weighted covariance that equals identity matrix.
</p>


<h3>Value</h3>

<p>A list containing the following components:
</p>
<table>
<tr style="vertical-align: top;">
<td><code>data_wsph</code></td>
<td>
<p>The spherized data matrix that has a zero weighted mean for each column, and a weighted covariance that equals identity matrix.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>data_wcen</code></td>
<td>
<p>The centered data matrix that has a zero weighted mean for each column. It's obtained by extracting the weighted sample mean from the original data matrix.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>wmean</code></td>
<td>
<p>Vector of length ncol(data). It's the weighted sample mean of the original data matrix.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>wcov</code></td>
<td>
<p>Matrix of size ncol(data) by ncol(data). It's the weighted sample covariance matrix of the original data matrix.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>wsph_proj</code></td>
<td>
<p>Matrix of size ncol(data) by ncol(data). It's the sphering/whitening matrix for the transformation. The spherized data matrix <code>data_wsph</code> is obtained by multiplying the centered data matrix with weights <code>data_wcen</code> with this sphering/whitening matrix. </p>
</td>
</tr>
</table>
<h3>Author(s)</h3>

<p>Yajie Duan, Javier Cabrera
</p>


<h3>References</h3>

<p>Cabrera, J., &amp; McDougall, A. (2002). Statistical consulting. Springer Science &amp; Business Media.
</p>


<h3>Examples</h3>

<pre><code class="language-R">
 dataset = matrix(rnorm(300),100,3)

 # assign random weights to observations
 weight = sample(1:20,100,replace = TRUE)

 # spherize the dataset with observational weights
 res = wsph(dataset,weight)

 # spherized data matrix considering the observation weights
 res$data_wsph

 # The spherzied data matrix has a zero weighted sample mean for each column
 1/sum(weight)*t(as.matrix(weight))%*%as.matrix(res$data_wsph)

 # The spherzied data matrix has a weighted covariance that equals identity matrix
 1/sum(weight)*t(as.matrix(res$data_wsph))%*%diag(weight)%*%as.matrix(res$data_wsph)

</code></pre>


</div>