<div class="container">

<table style="width: 100%;"><tr>
<td>pacotestRvineSingleCopula</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>
Testing for a Single (j-1)-th Order Partial Copula in a R-Vine Copula
</h2>

<h3>Description</h3>

<p>The function can be used to test a single copula in a R-vine copula to be a (j-1)-th order partial copula.
To apply the function one needs to provide the data and a specified/estimated R-vine copula model in form of a RVineMatrix from the VineCopula-package.
Additionally, a pacotest options list, which can be generated with the <code>pacotestset</code> function, needs to be provided.
</p>


<h3>Usage</h3>

<pre><code class="language-R">pacotestRvineSingleCopula(data, RVM, pacotestOptions, tree, copulaNumber)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>data</code></td>
<td>

<p>A (n x d) matrix (or data frame) of [0,1] data (i.e. uniform margins).
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>RVM</code></td>
<td>

<p>An RVineMatrix object (VineCopula-package) which includes the structure, the pair-copula families and parameters of an R-vine copula.
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>pacotestOptions</code></td>
<td>

<p>A options list generated by the <code>pacotestset</code> function or the test type as string, i.e., <code>CCC</code> or <code>VI</code>.
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>tree</code></td>
<td>

<p>The tree number (j&gt;=2) of the copula which should be tested to be a (j-1)-th order partial copula.
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>copulaNumber</code></td>
<td>

<p>The number (1&lt;= copulaNumber &lt;= j-1) of the copula in the normalized RVineMatrix which should be tested to be a (j-1)-th order partial copula.
</p>
</td>
</tr>
</table>
<h3>Value</h3>

<p>A list which can, depending on the chosen test, consist of the following elements:
</p>
<table>
<tr style="vertical-align: top;">
<td><code>pValue</code></td>
<td>

<p>The p-value of the test.
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>testStat</code></td>
<td>

<p>The value of the test statistic.
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>decisionTree</code></td>
<td>

<p>The decision tree used to partition the support Lmabda0 of the conditioning variable W. It is provided as a list consisting of three nodes (<code>CentralNode</code>, <code>LeftNode</code> and <code>RightNode</code>) represented as lists and the variable <code>LeavesForFinalComparison</code>. Each node consists of the <code>Variable</code> used to perform the split, the corresponding <code>Quantile</code> and <code>Threshold</code>.
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>S</code></td>
<td>

<p>The bootstrapped values of the test statistic (only for the test type <code>VI</code>).
</p>
</td>
</tr>
</table>
<h3>Author(s)</h3>

<p>Malte S. Kurz
</p>


<h3>References</h3>

<p>Kurz, M. S. and F. Spanhel (2022), "Testing the simplifying assumption in high-dimensional vine copulas", Electronic Journal of Statistics 16 (2), pp. 5226-5276.
</p>
<p>Spanhel, F. and M. S. Kurz (2019), "Simplified vine copula models: Approximations based on the simplifying assumption", Electronic Journal of Statistics 13 (1), pp. 1254-1291.
</p>


<h3>See Also</h3>

<p><code>pacotest-package</code>, <code>pacotest</code>, <code>pacotestset</code>, <code>pacotestRvineSeq</code>
</p>


<h3>Examples</h3>

<pre><code class="language-R"># Sample data and R-vine copula selection are taken
# from the documentation of RVineStructureSelect
# of the VineCopula package.

# Obtain sample data
data(daxreturns, package ="VineCopula")
dataSet = daxreturns[1:750,1:4]

# Specify an R-vine copula model
# (can be obtained by calling: RVM = VineCopula::RVineStructureSelect(dataSet))
vineStructure = matrix(c(3,4,1,2,0,2,4,1,0,0,1,4,0,0,0,4),4,4)
families = matrix(c(0,5,2,2,0,0,2,14,0,0,0,14,0,0,0,0),4,4)
par = matrix(c(0,0.8230664,0.1933472,0.6275062,
             0,0,0.2350109,1.6619945,
             0,0,0,1.599363,
             0,0,0,0),4,4)
par2 = matrix(c(0,0,11.757700,4.547847,
             0,0,17.15717,0,
             0,0,0,0,0,0,0,0),4,4)
RVM = VineCopula::RVineMatrix(vineStructure, families, par, par2)

# Specify a pacotestOptions list:
# For illustrating the functioning of the decision tree,
# grouped scatterplots and a decision tree plot are activated.
pacotestOptions = pacotestset(testType='CCC',
                               groupedScatterplots = TRUE,
                               decisionTreePlot = TRUE)

# Test for a 2-nd order partial copula
# corresponding to the variables BAYN.DE,BMW.DE
# and conditioning set ALV.DE,BAS.DE
tree = 3
copulaNumber = 1

pacotestResultList = pacotestRvineSingleCopula(dataSet, RVM,
                                                pacotestOptions, tree, copulaNumber)
</code></pre>


</div>