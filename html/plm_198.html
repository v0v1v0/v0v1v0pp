<div class="container">

<table style="width: 100%;"><tr>
<td>pvcm</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>Variable Coefficients Models for Panel Data</h2>

<h3>Description</h3>

<p>Estimators for random and fixed effects models with variable coefficients.
</p>


<h3>Usage</h3>

<pre><code class="language-R">pvcm(
  formula,
  data,
  subset,
  na.action,
  effect = c("individual", "time"),
  model = c("within", "random"),
  index = NULL,
  ...
)

## S3 method for class 'pvcm'
summary(object, ...)

## S3 method for class 'summary.pvcm'
print(
  x,
  digits = max(3, getOption("digits") - 2),
  width = getOption("width"),
  ...
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>formula</code></td>
<td>
<p>a symbolic description for the model to be estimated,</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>data</code></td>
<td>
<p>a <code>data.frame</code>,</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>subset</code></td>
<td>
<p>see <code>lm</code>,</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>na.action</code></td>
<td>
<p>see <code>lm</code>,</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>effect</code></td>
<td>
<p>the effects introduced in the model: one of
<code>"individual"</code>, <code>"time"</code>,</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>model</code></td>
<td>
<p>one of <code>"within"</code>, <code>"random"</code>,</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>index</code></td>
<td>
<p>the indexes, see <code>pdata.frame()</code>,</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>...</code></td>
<td>
<p>further arguments.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>object, x</code></td>
<td>
<p>an object of class <code>"pvcm"</code>,</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>digits</code></td>
<td>
<p>digits,</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>width</code></td>
<td>
<p>the maximum length of the lines in the print output,</p>
</td>
</tr>
</table>
<h3>Details</h3>

<p><code>pvcm</code> estimates variable coefficients models. Individual or time
effects are introduced, respectively, if <code>effect = "individual"</code>
(default) or <code>effect = "time"</code>.
</p>
<p>Coefficients are assumed to be fixed if <code>model = "within"</code>, i.e., separate
pooled OLS models are estimated per individual (<code>effect = "individual"</code>)
or per time period (<code>effect = "time"</code>). Coefficients are assumed to be
random if <code>model = "random"</code> and the model by
Swamy (1970) is estimated; it is a generalized least
squares model which uses the results of the OLS models estimated per
individual/time dimension (coefficient estimates are weighted averages of the
single OLS estimates with weights inversely proportional to the
variance-covariance matrices). The corresponding unbiased single coefficients,
variance-covariance matrices, and standard errors of the random coefficients
model are available in the returned object (see <em>Value</em>).
</p>
<p>A test for parameter stability (homogeneous coefficients) of the random
coefficients model is printed in the model's summary and is available in the
returned object (see <em>Value</em>).
</p>
<p><code>pvcm</code> objects have <code>print</code>, <code>summary</code> and <code>print.summary</code> methods.
</p>


<h3>Value</h3>

<p>An object of class <code>c("pvcm", "panelmodel")</code>, which has the
following elements:
</p>
<table>
<tr style="vertical-align: top;">
<td><code>coefficients</code></td>
<td>
<p>the vector (numeric) of coefficients (or data frame for
fixed effects),</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>residuals</code></td>
<td>
<p>the vector (numeric) of residuals,</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>fitted.values</code></td>
<td>
<p>the vector of fitted values,</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>vcov</code></td>
<td>
<p>the covariance matrix of the coefficients (a list for
fixed effects model (<code>model = "within"</code>)),</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>df.residual</code></td>
<td>
<p>degrees of freedom of the residuals,</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>model</code></td>
<td>
<p>a data frame containing the variables used for the
estimation,</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>call</code></td>
<td>
<p>the call,</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>args</code></td>
<td>
<p>the arguments of the call,</p>
</td>
</tr>
</table>
<p>random coefficients model only (<code>model = "random"</code>):
</p>
<table>
<tr style="vertical-align: top;">
<td><code>Delta</code></td>
<td>
<p>the estimation of the covariance matrix of the coefficients,</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>single.coefs</code></td>
<td>
<p>matrix of unbiased coefficients of single estimations,</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>single.vcov</code></td>
<td>
<p>list of variance-covariance matrices for <code>single.coefs</code>,</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>single.std.error</code></td>
<td>
<p>matrix of standard errors of <code>single.coefs</code>,</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>chisq.test</code></td>
<td>
<p>htest object: parameter stability test (homogeneous
coefficients),</p>
</td>
</tr>
</table>
<p>separate OLS estimations only (<code>model = "within"</code>):
</p>
<table><tr style="vertical-align: top;">
<td><code>std.error</code></td>
<td>
<p>a data frame containing standard errors for all
coefficients for each single regression.</p>
</td>
</tr></table>
<h3>Author(s)</h3>

<p>Yves Croissant, Kevin Tappe
</p>


<h3>References</h3>

<p>Swamy PAVB (1970).
“Efficient Inference in a Random Coefficient Regression Model.”
<em>Econometrica</em>, <b>38</b>, 311–323.
</p>
<p>Swamy PAVB (1971).
<em>Statistical Inference in Random Coefficient Regression Models</em>.
Springer.
</p>
<p>Greene WH (2018).
<em>Econometric Analysis</em>, 8th edition.
Prentice Hall.
</p>
<p>Poi BP (2003).
“From the help desk: Swamy’s random-coefficients model.”
<em>Stata Journal</em>, <b>3</b>(3), 302–308.
</p>
<p>Kleiber C, Zeileis A (2010).
“The Grunfeld Data at 50.”
<em>German Economic Review</em>, <b>11</b>, 404-417.
<a href="https://doi.org/10.1111/j.1468-0475.2010.00513.x">https://doi.org/10.1111/j.1468-0475.2010.00513.x</a>.
</p>


<h3>Examples</h3>

<pre><code class="language-R">
data("Produc", package = "plm")
zw &lt;- pvcm(log(gsp) ~ log(pcap) + log(pc) + log(emp) + unemp, data = Produc, model = "within")
zr &lt;- pvcm(log(gsp) ~ log(pcap) + log(pc) + log(emp) + unemp, data = Produc, model = "random")

## replicate Greene (2018), p. 452, table 11.22/(2012), p. 419, table 11.14
summary(pvcm(log(gsp) ~ log(pc) + log(hwy) + log(water) + log(util) + log(emp) + unemp, 
             data = Produc, model = "random"))
             
## replicate Poi (2003) (need data adjustment, remaining tiny diffs are due 
## Poi's data set having more digits, not justified by the original Grunfeld data)
data(Grunfeld) # need firm = 1, 4, 3, 8, 2
Gr.Poi.2003 &lt;- Grunfeld[c(1:20, 61:80, 41:60, 141:160, 21:40), ]
Gr.Poi.2003$firm &lt;- rep(1:5, each = 20)
Gr.Poi.2003[c(86, 98), "inv"] &lt;- c(261.6, 645.2)
Gr.Poi.2003[c(92), "capital"] &lt;- c(232.6)

mod.poi &lt;- pvcm(inv ~ value + capital, data = Gr.Poi.2003, model = "random")
summary(mod.poi)
print(mod.poi$single.coefs)
print(mod.poi$single.std.err)

## Not run: 
# replicate Swamy (1971), p. 166, table 5.2
data(Grunfeld, package = "AER") # 11 firm Grunfeld data needed from package AER
gw &lt;- pvcm(invest ~ value + capital, data = Grunfeld, index = c("firm", "year"))
# close replication of Swamy (1970), (7.4) [remaining diffs likely due to less 
# precise numerical methods in the 1970, as supposed in Kleiber/Zeileis (2010), p. 9]
gr &lt;- pvcm(invest ~ value + capital, data = Grunfeld, index = c("firm", "year"), model = "random")

## End(Not run)

</code></pre>


</div>