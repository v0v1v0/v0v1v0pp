<div class="container">

<table style="width: 100%;"><tr>
<td>transf.branch.lengths</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>Creates a tree with branch lengths to represent the 3-point structure of a covariance matrix</h2>

<h3>Description</h3>

<p>Creates a phylogenetic tree with branch lengths and a diagonal matrix to represent a (generalized) 3-point structured covariance matrix from a trait evolution model on a known tree.</p>


<h3>Usage</h3>

<pre><code class="language-R">transf.branch.lengths(phy, model = c("BM", "OUrandomRoot",
       "OUfixedRoot", "lambda", "kappa", "delta", "EB", "trend"),
       parameters = NULL, check.pruningwise = TRUE,
       check.ultrametric=TRUE, D=NULL, check.names = TRUE)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>phy</code></td>
<td>
<p>a phylogenetic tree of type phylo with branch lengths.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>model</code></td>
<td>
<p>a phylogenetic model. Default is "BM", for Brownian motion. Alternatives are "OU", "lambda", "kappa", "delta", "EB" and "trend".</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>parameters</code></td>
<td>
<p>List of parameters for the model (see Note).</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>check.pruningwise</code></td>
<td>
<p>if FALSE, the tree is assumed to be in pruningwise order.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>check.ultrametric</code></td>
<td>
<p>if FALSE, the tree is assumed to be
ultrametric and <code>D</code> needs to be provided. This is used for the
OU transformations only.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>D</code></td>
<td>
<p>vector of ajustments for the external edge lengths, to make
the tree ultrametric. Used for the OU transformations only.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>check.names</code></td>
<td>
<p><code>D</code> needs to have names that match tip labels
unless check.names=FALSE, in which case the elements in <code>D</code> are
assumed to come in the same order as tip labels in the tree.</p>
</td>
</tr>
</table>
<h3>Details</h3>

<p>Possible phylogenetic models are the Brownian motion model (BM), the
Ornstein-Uhlenbeck model (OU), Pagel's lambda model (lambda), Pagel's
kappa model (kappa), Pagel's delta model (delta), the early burst model
(EB), and the Brownian motion with a trend (trend). Edge lengths are
unchanged under BM and the trend model.
Under the kappa model, each branch length <code class="reqn">\ell</code> is transformed
to <code class="reqn">\ell^\kappa</code>. 
If the time from the root to a node is <code class="reqn">t</code> in <code>phy</code>,
it is transformed to
<code class="reqn"> T * (t/T)^\delta</code> 
under the delta model, where <code class="reqn">T</code> is the maximum root-to-tip
distance. The transformed tree has the same <code class="reqn">T</code>. 
Under EB, <code class="reqn">t</code> is transformed to 
<code class="reqn">(e^{\mathrm{rate}*t}-1)/\mathrm{rate}</code>, 
which is very close to <code class="reqn">t</code> (i.e. to the BM model)
when <code>rate</code> is close to 0. 
Under the lambda model, the time <code class="reqn">t</code> from the
root to a node is transformed to 
<code class="reqn">\lambda t</code> for an internal node and
is unchanged for a tip. 
Under "OUrandomRoot", <code class="reqn">t</code> is transformed to 
<code class="reqn">\exp(-2\alpha (T-t))</code>, 
where <code class="reqn">T</code> is now the mean root-to-tip distance. 
Under "OUfixedRroot", <code class="reqn">t</code> is transformed to 
<code class="reqn">\exp(-2\alpha (T-t))(1-\exp(-2 \alpha t))</code>. 
Under the OU models, <code>diagWeight</code> contains <code class="reqn">\exp(\alpha
  D_i)</code> for tip <code class="reqn">i</code>, where <code class="reqn">D_i</code> is the extra
length added to tip <code class="reqn">i</code> to make the tree ultrametric.
</p>


<h3>Value</h3>

<table>
<tr style="vertical-align: top;">
<td><code>tree</code></td>
<td>
<p>a rooted tree with a root edge and transformed branch lengths.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>diagWeight</code></td>
<td>
<p>a vector containing the diagonal elements of the
diagonal matrix  for the generalized 3-point structure.</p>
</td>
</tr>
</table>
<h3>Note</h3>

<p>The default choice for the parameters are as follows: <code>alpha=0</code> for
the selection strength in the OU model, <code>lambda=1</code>, <code>kappa=1</code>,
<code>delta=1</code>, <code>rate=0</code> for the EB model, <code>sigma2_error=0</code> for the variance of measurement errors. These default choices
correspond to the BM model.
</p>
<p>Edges in the output tree are in pruningwise order.
</p>
<p>If <code>model="BM"</code> or <code>model="trend"</code>, the output tree is the same as the
input tree except that the output tree is in pruningwise order.
</p>


<h3>Author(s)</h3>

<p>Lam Si Tung Ho</p>


<h3>References</h3>

<p>Ho, L. S. T. and Ane, C. <em>A linear-time algorithm for Gaussian
and non-Gaussian trait evolution models</em>. Systematic Biology <b>63</b>(3):397-408.
</p>


<h3>See Also</h3>

<p><code>three.point.compute</code>.
</p>


<h3>Examples</h3>

<pre><code class="language-R">set.seed(123456)
tre1 = rcoal(10)
tre2 = transf.branch.lengths(phy=tre1, model="OUrandomRoot",
                             parameters = list(alpha=1))
par(mfrow = c(2,1))
plot(tre1)
plot(tre2$tree,root.edge=TRUE)
</code></pre>


</div>