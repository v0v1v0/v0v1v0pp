<div class="container">

<table style="width: 100%;"><tr>
<td>pwepowerfindt</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>Calculating the timepoint where a certain power of the specified test statistics is obtained</h2>

<h3>Description</h3>

<p>This will calculate the timepoint where a certain power of the specified test statistics is obtained accouting for staggered entry, delayed treatment effect,  treatment crossover and loss to follow-up.</p>


<h3>Usage</h3>

<pre><code class="language-R">pwepowerfindt(power=0.9,alpha=0.05,twosided=1,tupp=5,tlow=1,taur=1.2,
                     u=c(1/taur,1/taur),ut=c(taur/2,taur),pi1=0.5,
                     rate11=c(1,0.5),rate21=rate11,rate31=c(0.7,0.4),
                     rate41=rate21,rate51=rate21,ratec1=c(0.5,0.6),
                     rate10=rate11,rate20=rate10,rate30=rate31,
                     rate40=rate20,rate50=rate20,ratec0=c(0.6,0.5),
                     tchange=c(0,1),type1=1,type0=1,
                     rp21=0.5,rp20=0.5,eps=1.0e-2,veps=1.0e-2,
                     epsbeta=1.0e-04,iterbeta=25,
                     n=1000,testtype=1,maxiter=20,itereps=0.001)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>power</code></td>
<td>
<p>the desired power</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>alpha</code></td>
<td>
<p>type-1 error</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>twosided</code></td>
<td>
<p>twoside test or not</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>tupp</code></td>
<td>
<p>an upper time point where the power should be larger than <code>power</code></p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>tlow</code></td>
<td>
<p>a lower time point where the power should be smaller than <code>power</code></p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>taur</code></td>
<td>
<p>recruitment time</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>u</code></td>
<td>
<p>Piecewise constant recuitment rate</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>ut</code></td>
<td>
<p>Recruitment intervals</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>pi1</code></td>
<td>
<p>Allocation probability for the treatment group</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>rate11</code></td>
<td>
<p>Hazard before crossover for the treatment group</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>rate21</code></td>
<td>
<p>Hazard after crossover for the treatment group</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>rate31</code></td>
<td>
<p>Hazard for time to crossover for the treatment group</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>rate41</code></td>
<td>
<p>Hazard after crossover for the treatment group for complex case</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>rate51</code></td>
<td>
<p>Hazard after crossover for the treatment group for complex case</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>ratec1</code></td>
<td>
<p>Hazard for time to censoring for the treatment group</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>rate10</code></td>
<td>
<p>Hazard before crossover for the control group</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>rate20</code></td>
<td>
<p>Hazard after crossover for the control group</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>rate30</code></td>
<td>
<p>Hazard for time to crossover for the control group</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>rate40</code></td>
<td>
<p>Hazard after crossover for the control group for complex case</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>rate50</code></td>
<td>
<p>Hazard after crossover for the control group for complex case</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>ratec0</code></td>
<td>
<p>Hazard for time to censoring for the control group</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>tchange</code></td>
<td>
<p>A strictly increasing sequence of time points at which the event rates changes. The first element of tchange                 must be zero. It must have the same length as <code>rate11</code>, <code>rate21</code>, <code>rate31</code>, etc.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>type1</code></td>
<td>
<p>Type of crossover in the treatment group</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>type0</code></td>
<td>
<p>Type of crossover in the control group</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>rp21</code></td>
<td>
<p>re-randomization prob in the treatment group</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>rp20</code></td>
<td>
<p>re-randomization prob in the control group</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>eps</code></td>
<td>
<p>error tolerence</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>veps</code></td>
<td>
<p>error tolenrence for calculating variance</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>epsbeta</code></td>
<td>
<p>error tolerance for calculating overall log HR</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>iterbeta</code></td>
<td>
<p>maximum number of iterations for calculating overall log HR</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>n</code></td>
<td>
<p>total number of subjects</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>testtype</code></td>
<td>
<p>test statistics, =1 log-rank;=2 Cox model; =3 log-rank with robust variance</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>maxiter</code></td>
<td>
<p>maximum number of bi-section iterations</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>itereps</code></td>
<td>
<p>error tolerance of <code>power</code></p>
</td>
</tr>
</table>
<h3>Details</h3>

<p>The hazard functions corresponding to <code>rate11</code>,...,<code>rate51</code>,<code>ratec1</code>, <code>rate10</code>,...,<code>rate50</code>,<code>ratec0</code> are all piecewise constant function taking the form  <code class="reqn">\lambda(t)=\sum_{j=1}^m \lambda_j I(t_{j-1}\le t&lt;t_j)</code>, where <code class="reqn">\lambda_1,\ldots,\lambda_m</code> are the corresponding elements of the rates and <code class="reqn">t_0,\ldots,t_{m-1}</code> are the corresponding elements of <cite>tchange</cite>, <code class="reqn">t_m=\infty</code>. Note that all the rates must have the same <code>tchange</code>.
</p>


<h3>Value</h3>

<table>
<tr style="vertical-align: top;">
<td><code>testtype</code></td>
<td>
<p>type of statistic, =1 log-rank;=2 Cox model; =3 log-rank with robust variance</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>time</code></td>
<td>
<p>time calculated when the iterations stop</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>power</code></td>
<td>
<p>the power at <code>time</code></p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>err</code></td>
<td>
<p>distance from the desired power</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>k</code></td>
<td>
<p>number of bi-section iterations performed</p>
</td>
</tr>
</table>
<h3>Note</h3>

<p>Version 1.0 (7/19/2016)</p>


<h3>Author(s)</h3>

<p>Xiaodong Luo</p>


<h3>References</h3>

<p>Luo, et al. (2017)
</p>


<h3>See Also</h3>

<p><code>pwe</code>,<code>rpwe</code>,<code>qpwe</code>,<code>ovbeta</code>,<code>innervar</code></p>


<h3>Examples</h3>

<pre><code class="language-R">t&lt;-seq(3,6,by=1)
taur&lt;-1.2
u&lt;-c(1/taur,1/taur)
ut&lt;-c(taur/2,taur)
r11&lt;-c(0.2,0.1)
r21&lt;-r11
r31&lt;-c(0.03,0.02)
r41&lt;-r51&lt;-r21
rc1&lt;-c(0.01,0.02)
r10&lt;-c(0.2,0.2)
r20&lt;-r10
r30&lt;-c(0.02,0.01)
r40&lt;-r50&lt;-r20
rc0&lt;-c(0.02,0.01)
getpower&lt;-pwepower(t=t,alpha=0.05,twosided=1,taur=taur,u=u,ut=ut,pi1=0.5,
                   rate11=r11,rate21=r21,rate31=r31,rate41=r41,rate51=r51,ratec1=rc1,
                   rate10=r10,rate20=r20,rate30=r30,rate40=r40,rate50=r50,ratec0=rc0,
                   tchange=c(0,1),type1=1,type0=1,n=1000)
###powers at each time point
cbind(t,getpower$power[,1:3])

###90% power should be in (3,3.5)
getpwtime&lt;-pwepowerfindt(power=0.9,alpha=0.05,twosided=1,tupp=3.5,tlow=3,taur=taur,
        u=u,ut=ut,pi1=0.5,rate11=r11,rate21=r21,rate31=r31,rate41=r41,rate51=r51,ratec1=rc1,
        rate10=r10,rate20=r20,rate30=r30,rate40=r40,rate50=r50,ratec0=rc0,
        tchange=c(0,1),type1=1,type0=1,n=1000,testtype=1,maxiter=30)
getpwtime
</code></pre>


</div>