<div class="container">

<table style="width: 100%;"><tr>
<td>loglikef</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>
Calculation of the logarithm of likelihood function (using Fourier representation)
</h2>

<h3>Description</h3>

<p>Procedure <code>loglikef</code> computes the logarithm of likelihood function from the PARMA
sequence <code>x</code> for matrices
<code>phi</code> (of size <code class="reqn">T \times p</code>) and <code>theta</code> (of size <code class="reqn">T \times (q+1)</code>)
inputed in their Fourier representation as <code>a</code> and <code>b</code>, respectively.
</p>


<h3>Usage</h3>

<pre><code class="language-R">loglikef(ab, x, conpars)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>ab</code></td>
<td>

<p>matrix <code>[a,b]</code> taken as a vector, where<br><code>a</code> is Fourier representation of <code>phi</code>
(use <code>phi=ab2phth(a)</code> to recover <code>phi</code>),<br><code>b</code> is Fourier representation of <code>theta</code>
(use <code>del=ab2phth(b[,1])</code> to recover <code>del</code> and 
<code>theta=ab2phth(b[,2:q+1])</code> to recover <code>theta</code>).<br>
Vector <code>ab</code> contains only non-zero coefficients form <code>a</code> and <code>b</code>.
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>x</code></td>
<td>

<p>input time series.
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>conpars</code></td>
<td>

<p>vector of parameters <code>[T,p,q,naf,nbf,del_mask,iaf,ibf,stype]</code>:<br><code>T_t</code> period of PC-T structure,<br><code>p, q</code> maximum PAR and PMA order, respectively,<br><code>naf, nbf</code> total active coefficients in <code>a</code> and <code>b</code>, respectively,<br><code>del_mask</code> vector of length <code>T</code> (it will be used in the future, so far the user should set <code>del_mask=matrix(1,T,1)</code>),<br><code>iaf, ibf</code> linear indexes of active coefficients in <code>a</code> and <code>b</code>, respectively,<br><code>stype</code>  numeric parameter connected with covariance matrix computation, so far should be equal to 0 to use procedure 
<code>R_w_ma</code> (see <code>R_w_ma</code> description). In the future also other values of <code>stype</code> will be available for 
full covariance matrix computation. 
</p>
</td>
</tr>
</table>
<h3>Details</h3>

<p>This method of computation of logarithm of likelihood function makes use of the representation of the periodically varying parameters by Fourier series. 
This alternative parametrization of PARMA system, introduced by 
Jones and Breslford, can sometimes substantially reduce the number of parameters required to represent PARMA system. Mapping between  <code>phi</code> and <code>theta</code> coefficients
and <code>a</code> and <code>b</code> coefficients is one-to-one, so first
logarithm of likelihood is computed for transformed coefficients and then these coefficients are transformed to <code>phi</code> and <code>theta</code>. 
Fourier series parametrization permits us 
to reduce the total number of parameters by constraining some frequencies to have zero amplitude. Then the code  includes
the computation of covariance matrix from the parameters <code>phi</code>, <code>del</code>, <code>theta</code>.
Since the inverse of the computed covariance is needed for computing the likelihood, and it is sometimes ill conditioned (or even singular), the condition is improved by removing rows and columns corresponding to very small eigenvalues. This corresponds to removing input data that is highly linearly dependent on the remaining input data. The procedure contains a threshold ZTHRS (which current value is <code>10*eps</code>) that governs the discarding of rows and column corresponding to small eigenvalues (these are determined by a Cholesky decomposition). Any eigenvalue smaller than the threshold has its row and column deleted from the matrix. Then the 
inverse and the likelihood are computed from the reduced rank covariance matrix.
</p>


<h3>Value</h3>

<p>negative value of the logarithm of likelihood function: <code>y</code>.
</p>


<h3>Note</h3>

<p>In the <code>loglikef</code> procedure, motivated by the possibility of deficient rank sequences, we made a variant of the Cholesky decomposition. In proposed approach upper traingular
matrix eliminates data points that are lineary dependant on previous ones and removes their consideration in the likelihood value calculation. As a consequence data vector
is reduced so that covariance matrix is positive definite and problem of non-invertible covariance matrix is avoided.<br>
This function is used in <code>parmaf</code> procedure, thus for more details please look also at <code>parmaf</code> code.
</p>


<h3>Author(s)</h3>

<p>Harry Hurd 
</p>


<h3>References</h3>

<p>Box, G. E. P., Jenkins, G. M., Reinsel, G. (1994), Time Series Analysis, 3rd Ed., Prentice-Hall, Englewood Cliffs, NJ.
<br><br>
Brockwell, P. J., Davis, R. A., (1991), Time Series: Theory and Methods, 2nd Ed., Springer: New York.
<br><br>
Jones, R., Brelsford, W., (1967), Time series with periodic structure, Biometrika 54, 403-408.
<br><br>
Makagon, A., (1999), Theoretical prediction of periodically correlated sequences, Probability and Mathematical Statistics 19 (2), 287-322.
<br><br>
Sakai, H., (1989), On the spectral density matrix of a periodic ARMA process, J. Time Series Analysis, v. 12, no. 2, pp. 73-82.
<br><br>
Vecchia, A., (1985), Maximum Likelihood Estimation for Periodic Autoregressive Moving Average Models, Technometrics, v. 27, pp.375-384.
</p>


<h3>See Also</h3>

<p><code>R_w_ma</code>,  <code>parmaresid</code>, <code>parmaf</code>
</p>


</div>