<div class="container">

<table style="width: 100%;"><tr>
<td>parsimonyNumber</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>Number of equivalent parsimonious allocations.</h2>

<h3>Description</h3>

<p><code>parsimonyNumber</code> aims at finding the number of equivalent allocations of
the shifts on the tree, i.e allocations that are parsimonious and compatible
with a given clustering of the tips.
</p>


<h3>Usage</h3>

<pre><code class="language-R">parsimonyNumber(phylo, clusters = rep(1, length(phylo$tip.label)))
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>phylo</code></td>
<td>
<p>phylogenetic tree, class <code>phylo</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>clusters</code></td>
<td>
<p>the vector of the clusters of the tips. Default to all the tips
in one single cluster.</p>
</td>
</tr>
</table>
<h3>Details</h3>

<p>This function does a recursion up the tree.
The function <code>extract.parsimonyNumber</code> gives the result sought for
any subtree.
The matrix of costs of the states (number of shifts) is also required, it is
computed by function <code>parsimonyCost</code>.
</p>


<h3>Value</h3>

<p>an object of S3 class "<code>parsimonyNumber</code>" with:
</p>

<dl>
<dt>nbrReconstructions</dt>
<dd>
<p>a (ntaxa + Nnode) x (nclus)
matrix of locally parsimonious solutions starting from a cluster k at a
given node</p>
</dd>
<dt>costReconstructions</dt>
<dd>
<p>an object of class "<code>parsimonyCost</code>",
result of function <code>parsimonyCost</code>.</p>
</dd>
</dl>
<h3>See Also</h3>

<p><code>extract.parsimonyNumber</code>, <code>parsimonyCost</code>, 
<code>enumerate_parsimony</code>, <code>partitionsNumber</code>,
<code>equivalent_shifts</code>
</p>


<h3>Examples</h3>

<pre><code class="language-R">tree &lt;- read.tree(text="(((0,1),2),2);")
plot(tree); nodelabels()
clusters &lt;- c(0, 1, 2, 2)
n_sols &lt;- parsimonyNumber(tree, clusters)
n_sols

## Extract the number of parsimonious solutions at the root
extract(n_sols)

## Extract the cost of the solutions from the root
extract(n_sols, what = "cost")
extract(parsimonyCost(tree, clusters)) # same, more efficient

## Extract for the sub-tree below node 7
extract(n_sols, 7) # Result: 2 (the ancestral state is either "0" or "1"). 

</code></pre>


</div>