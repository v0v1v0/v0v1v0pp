<div class="container">

<table style="width: 100%;"><tr>
<td>rotatePolys</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>
Rotate Polygons and Events
</h2>

<h3>Description</h3>

<p>Rotate a PolySet (or an EventData set) clockwise by a specified angle around a fixed point.
</p>


<h3>Usage</h3>

<pre><code class="language-R">rotatePolys(polys, angle=40, centroid=c(500,5700),
   proj.out, zone, xlim=c(-135,-121.5), ylim=c(47,56),
   plot=FALSE, keep.extra=FALSE, ...)

rotateEvents(data, angle=40, centroid=c(500,5700),
   proj.out, zone, plot=FALSE, keep.extra=FALSE, ...)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>polys</code></td>
<td>
<p><code>PolySet</code> – data frame with fields <code>'PID'</code>, <code>'SID'</code>, <code>'POS'</code>, <code>'X'</code>, <code>'Y'</code>,
and attribute <code>'projection'</code> set to either <code>"LL"</code> or <code>"UTM"</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>data</code></td>
<td>
<p><code>EventData</code> – data frame with fields <code>'EID'</code>, <code>'POS'</code>, <code>'X'</code>, <code>'Y'</code>,
and attribute <code>'projection'</code> set to either <code>"LL"</code> or <code>"UTM"</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>angle</code></td>
<td>
<p><code>numeric</code> – angle between 0 and 360 degrees for map rotation in a clockwise direction.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>centroid</code></td>
<td>
<p><code>numeric</code> – fixed UTM point, specified in km, around which the map will be rotated.
Rotation is performed in UTM space regardless of the input and output projections.
If user specifies <code>'NULL'</code> or <code>'NA'</code>, the centroid of the map will be used.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>proj.out</code></td>
<td>
<p><code>character</code> – desired output projection, where choices are <code>'LL'</code> or <code>'UTM'</code>.
If <code>'proj.out'</code> is not specified, the output projection will be the same as the projection of the input object.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>zone</code></td>
<td>
<p><code>numeric</code> – UTM zone used for rotation; if not supplied, the zone is set to 9.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>xlim</code></td>
<td>
<p><code>numeric</code> – two-element vector specifying the limits of X using units (degrees or km) that match the input projection.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>ylim</code></td>
<td>
<p><code>numeric</code> – two-element vector specifying the limits of Y using units (degrees or km) that match the input projection.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>plot</code></td>
<td>
<p><code>logical</code> – if <code>TRUE</code>, plot the results of the rotation.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>keep.extra</code></td>
<td>
<p><code>logical</code> – if <code>TRUE</code>, keep the coordinates of initial and intermediate steps in the rotation process
in addition to the final rotated coordinates of the desired projection.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>...</code></td>
<td>
<p><code>dots</code> – additional arguments for <code>'plotMap'</code> (in <code>'rotatePolys'</code>) or <code>'plotPoints'</code> (in <code>'rotateEvents'</code>).</p>
</td>
</tr>
</table>
<h3>Details</h3>

<p>Map rotation returns coordinates that are no longer meaningful with respect to the original coordinate system.
When displaying rotated maps, the user might wish to turn off axis labels using <code>xaxt="n"</code> and <code>yaxt="n"</code>.
</p>


<h3>Value</h3>

<p>Rotated PolySet or EventData set where <code>'X'</code> and <code>'Y'</code> are the rotated coordinates in the projection specified by <code>'proj.out'</code>.
The returned object has an attribute list object named <code>'rotation'</code> that contains:
</p>

<ul>
<li> <p><code>angle</code> – angle of clockwise rotation in degrees
</p>
</li>
<li> <p><code>radian</code> – angle of rotation in radians: <code>pi * (-angle)/180</code>
</p>
</li>
<li> <p><code>centroid</code> – fixed point in UTM coordinates (km) around which map is rotated in UTM projection
</p>
</li>
<li> <p><code>R</code> – <a href="https://academo.org/demos/rotation-about-point/">rotation matrix</a> (2-dimensional)
</p>
</li>
<li> <p><code>xylim</code> – list object to keep track of <code>'xlim'</code>, <code>'ylim'</code> and a bounding box <code>'xybox'</code>.
</p>
</li>
<li> <p><code>projection</code> – projection of the rotated PolySet or EventData set
</p>
</li>
<li> <p><code>zone</code> – zone of the rotated PolySet or EventData set
</p>
</li>
</ul>
<p>When <code>keep.extra=TRUE</code>, the returned object will contain additional fields calculated by the rotational algorithm:
</p>

<ul>
<li> <p><code>(X0,Y0)</code> – original coordinates of the input PolySet | EventData set
</p>
</li>
<li> <p><code>(uX0,uY0)</code> – original coordinates converted to UTM (only if original projection is <code>'LL'</code>)
</p>
</li>
<li> <p><code>(aX,aY)</code> – UTM coordinates adjusted by subtracting the UTM centroid
</p>
</li>
<li> <p><code>(tX,tY)</code> – adjusted UTM coordinates transformed by multiplying the rotational matrix
</p>
</li>
<li> <p><code>(rX,rY)</code> – rotated UTM coordinates re-centered by adding the UTM centroid
</p>
</li>
</ul>
<p>Note:<br>
If <code>proj.out="UTM"</code>, the coordinates <code>c(rX, rY)</code> are used as the final rotated coordinates.
If <code>proj.out="LL"</code>, the coordinates <code>c(rX, rY)</code> are transformed back into projection <code>'LL'</code> as the final rotated coordinates.
</p>
<p>Additionally, <code>'xylim'</code> in the <code>'rotation'</code> list attribute contains intermediary bounding box objects.
For instance, if the input PolySet | EventData object has projection <code>'LL'</code>, the <code>'xylim'</code> object contains:
</p>

<ul>
<li> <p><code>LL</code> – original <code>(X,Y)</code> limits (<code>'xlim'</code>, <code>'ylim'</code>, <code>'xybox'</code>)
</p>
</li>
<li> <p><code>UTM</code> – original <code>(X,Y)</code> limits transformed to UTM coordinates
</p>
</li>
<li> <p><code>rot</code> – rotated UTM <code>(X,Y)</code> limits
</p>
</li>
<li> <p><code>out</code> – final projection <code>(X,Y)</code> limits
</p>
</li>
</ul>
<h3>Note</h3>

<p>The map rotation algorithm is not heavily tested at this time.
Report any issues to the package maintainer.
</p>


<h3>Author(s)</h3>

<p><a href="mailto:rowan.haigh@dfo-mpo.gc.ca">Rowan Haigh</a>, Program Head – Offshore Rockfish<br>
Pacific Biological Station (PBS), Fisheries &amp; Oceans Canada (DFO), Nanaimo BC<br><em>locus opus</em>: Institute of Ocean Sciences (IOS), Sidney BC<br>
Last modified <code>Rd: 2019-03-14</code>
</p>


<h3>References</h3>

<p><a href="https://academo.org/demos/rotation-about-point/">Academo – 2D Rotation about a point</a>
</p>
<p><a href="https://en.wikipedia.org/wiki/Rotation_matrix">Wikipedia – Rotation matrix</a>
</p>


<h3>See Also</h3>

<p>In package <span class="pkg">PBSmapping</span>:<br><code>as.PolySet</code> in PolySet,
<code>clipPolys</code>,
<code>nepacLL</code>,
<code>plotMap</code>,
<code>plotPoints</code>,
<code>refocusWorld</code>,
<code>surveyData</code>
</p>


</div>