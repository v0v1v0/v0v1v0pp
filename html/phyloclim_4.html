<div class="container">

<table style="width: 100%;"><tr>
<td>anc.clim</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>
Estimation of Ancestral Climatic Tolerances
</h2>

<h3>Description</h3>

<p>This function implements a nonparametric approach to estimate ancestral climatic tolerances proposed by Evans et al. (2009), using <code>ace</code> from the <code>ape</code> package. 
</p>


<h3>Usage</h3>

<pre><code class="language-R">anc.clim(target, posterior = NULL, pno, n = 100, method = "GLS")
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>target</code></td>
<td>
<p>An object of class <code>"phylo"</code>; a best estimate  (e.g., ML estimate) of topology on which to summarize mean estimated climatic tolerances, must be ultrametric.
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>posterior</code></td>
<td>
<p>An object of class <code>"multiPhylo"</code> containing a sample of ultrametric trees from the posterior distribution of a Bayesian tree search to be used for reconstruction of ancestral climatic tolerances. <code>posterior = NULL</code> (the default) means that reconstruction uses <code>target</code> instead.
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>pno</code></td>
<td>
<p>A data frame containing predicted niche occupancy (PNO) profiles, produced e.g. with <code>pno</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>n</code></td>
<td>
<p>An integer: The PNO profile given by <code>pno</code> argument will be resamples <code>n</code> times.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>method</code></td>
<td>
<p>A character string specifying the method used for estimation. Two choices are possible: <code>"ML"</code> or <code>"GLS"</code> (see <code>ace</code> for details).
</p>
</td>
</tr>
</table>
<h3>Value</h3>

<p>A list containing three elements:
</p>
<table>
<tr style="vertical-align: top;">
<td><code>tree</code></td>
<td>
<p>An object of class <code>"phylo"</code>, the <code>target</code> tree used in the estimation.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>means</code></td>
<td>
<p>A vector containing the means of estimated ancestral climatic tolerances. The elements of <code>means</code> are in the same order as node numbers in element <code>tree</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>central.density</code></td>
<td>
<p>A matrix, which for each of the terminal nodes in <code>tree</code> contains the minimum and the maximum of the 80 percent density interval of climatic tolerances (as sampled from the PNO).</p>
</td>
</tr>
</table>
<h3>Author(s)</h3>

<p>Christoph Heibl</p>


<h3>References</h3>

<p>Evans, M. E. K., S. A. Smith, R. S. Flynn, and M. J. Donoghue. 2009. Climate, niche evolution,
and diversification of the 'bird-cage evening primroses' (<em>Oenothera</em>, sections <em>Anogra</em> and 
<em>Kleinia</em>). <em>Am. Nat.</em> <b>173</b>: 225-240.
</p>


<h3>See Also</h3>

<p><code>pno</code>, 
<code>plotAncClim</code>
</p>


<h3>Examples</h3>

<pre><code class="language-R"># load phylogeny and PNOs of Oxalis sect. Palmatifoliae
data(tree)
data(PNO)

# choose summer precipitation for analysis
clim &lt;- PNO$PrecipitationWarmestQuarter

# estimate ancestral tolerances
ac &lt;- anc.clim(target = tree, pno = clim, n = 100)

# visualize results
plotAncClim(ac, ylab = "Precipitation of warmest quarter (mm)")
</code></pre>


</div>