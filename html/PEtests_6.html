<div class="container">

<table style="width: 100%;"><tr>
<td>covtest.pe.comp</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>Two-sample PE covariance test for high-dimensional data via PE component</h2>

<h3>Description</h3>

<p>This function implements the two-sample PE covariance test via the
construction of the PE component. Let <code class="reqn">T_{LC}/\hat\sigma_{T_{LC}}</code>
denote the <code class="reqn">l_2</code>-norm-based covariance test statistic
(see <code>covtest.lc</code> for details).
The PE component is constructed by
</p>
<p style="text-align: center;"><code class="reqn">J_c=\sqrt{p}\sum_{i=1}^p\sum_{j=1}^p T_{ij}\widehat\xi^{-1/2}_{ij}
\mathcal{I}\{ \sqrt{2}T_{ij}\widehat\xi^{-1/2}_{ij} +1 &gt;  \delta_{cov} \}, </code>
</p>

<p>where <code class="reqn">\delta_{cov}</code> is a threshold for the screening procedure,
recommended to take the value of <code class="reqn">\delta_{cov}=4\log(\log (n_1+n_2))\log p</code>.
The explicit forms of <code class="reqn">T_{ij}</code> and <code class="reqn">\widehat\xi_{ij}</code>
can be found in Section 3.2 of Yu et al. (2022).
The PE covariance test statistic is defined as
</p>
<p style="text-align: center;"><code class="reqn">T_{PE}=T_{LC}/\hat\sigma_{T_{LC}}+J_c.</code>
</p>

<p>With some regularity conditions, under the null hypothesis
<code class="reqn">H_{0c}: \mathbf{\Sigma}_1 = \mathbf{\Sigma}_2</code>,
the test statistic <code class="reqn">T_{PE}</code> converges in distribution to
a standard normal distribution as <code class="reqn">n_1, n_2, p \rightarrow \infty</code>.
The asymptotic <code class="reqn">p</code>-value is obtained by
</p>
<p style="text-align: center;"><code class="reqn">p\text{-value}=1-\Phi(T_{PE}),</code>
</p>

<p>where <code class="reqn">\Phi(\cdot)</code> is the cdf of the standard normal distribution.
</p>


<h3>Usage</h3>

<pre><code class="language-R">covtest.pe.comp(dataX,dataY,delta=NULL)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>dataX</code></td>
<td>
<p>an <code class="reqn">n_1</code> by <code class="reqn">p</code> data matrix</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>dataY</code></td>
<td>
<p>an <code class="reqn">n_2</code> by <code class="reqn">p</code> data matrix</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>delta</code></td>
<td>
<p>a scalar; the thresholding value used in the construction of
the PE component. If not specified, the function uses a default value
<code class="reqn">\delta_{cov}=4\log(\log (n_1+n_2))\log p</code>.</p>
</td>
</tr>
</table>
<h3>Value</h3>

<p><code>stat</code> the value of test statistic
</p>
<p><code>pval</code> the p-value for the test.
</p>


<h3>References</h3>

<p>Yu, X., Li, D., Xue, L., and Li, R. (2022). Power-enhanced simultaneous test
of high-dimensional mean vectors and covariance matrices with application
to gene-set testing. <em>Journal of the American Statistical Association</em>,
(in press):1â€“14.
</p>


<h3>Examples</h3>

<pre><code class="language-R">n1 = 100; n2 = 100; pp = 500
set.seed(1)
X = matrix(rnorm(n1*pp), nrow=n1, ncol=pp)
Y = matrix(rnorm(n2*pp), nrow=n2, ncol=pp)
covtest.pe.comp(X,Y)
</code></pre>


</div>