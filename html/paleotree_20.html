<div class="container">

<table style="width: 100%;"><tr>
<td>cladogeneticTraitCont</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>Simulate Cladogenetic Trait Evolution</h2>

<h3>Description</h3>

<p>This function simulates trait evolution at each speciation/branching event
in a matrix output from <code>simFossilRecord</code>, after transformation with
<code>fossilRecord2fossilTaxa</code>.
</p>


<h3>Usage</h3>

<pre><code class="language-R">cladogeneticTraitCont(taxa, rate = 1, meanChange = 0, rootTrait = 0)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>taxa</code></td>
<td>
<p>A five-column matrix of taxonomic data, as output by
<code>fossilRecord2fossilTaxa</code> after simulation with <code>simFossilRecord</code>
(or via the deprecated function <code>simFossilTaxa</code>)</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>rate</code></td>
<td>
<p>rate of trait change; variance of evolutionary change
distribution per speciation event</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>meanChange</code></td>
<td>
<p>Mean change per speciation event. Default is 0; change to
simulate 'active' speciational trends, where the expected change at each
speciational event is non-zero.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>rootTrait</code></td>
<td>
<p>The trait value of the first taxon in the dataset; set to 0
by default.</p>
</td>
</tr>
</table>
<h3>Details</h3>

<p>This function simulates continuous trait evolution where change occurs under
a Brownian model, but only at events that create new distinct morphotaxa
(i.e. species as recognized in the fossil record), either branching events
or anagenesis (pseudospeciation). These are the types of morphological
differentiation which can be simulated in the function <code>simFossilRecord</code>. This
is sometimes referred to as cladogenetic or speciation trait evolution and
is related to Punctuated Equilibrium theory. Anagenetic shifts are not
cladogenetic events per se (no branching!), so perhaps the best way to this
of this function is it allows traits to change anytime <code>simFossilRecord</code> created
a new 'morphotaxon' in a simulation.
</p>
<p>Importantly, trait changes only occur at the base of 'new' species, thus
allowing cladogenetic trait evolution to be asymmetrical at branching
points: i.e. only one branch actually changes position in trait-space, as
expected under a budding cladogenesis model. This distinction is important
as converting the taxa matrix to a phylogeny and simulating the trait
changes under a 'speciational' tree-transformation would assume that
divergence occurred on both daughter lineages at each node. (This has been
the standard approach for simulating cladogenetic trait change on trees).
</p>
<p>Cryptic taxa generated with <code>prop.cryptic</code> in <code>simFossilRecord</code> will not differ at
all in trait values. These species will all be identical.
</p>
<p>See this link for additional details:
</p>
<p><a href="https://nemagraptus.blogspot.com/2012/03/simulating-budding-cladogenetictrait.html">https://nemagraptus.blogspot.com/2012/03/simulating-budding-cladogenetictrait.html</a>
</p>


<h3>Value</h3>

<p>Returns a vector of trait values for each taxon, with value names
being the taxa IDs (column 1 of the input) with a 't' pasted (as with <code>rtree</code>
in the <code>ape</code> library).
</p>


<h3>Author(s)</h3>

<p>David W. Bapst
</p>


<h3>See Also</h3>

<p><code>simFossilRecord</code>,
</p>
<p>This function is similar to Brownian motion simulation functions such as
<code>rTraitCont</code> in ape, <code>sim.char</code> in geiger and <code>fastBM</code> in
phytools.
</p>
<p>See also <code>unitLengthTree</code> in this package and
<code>speciationalTree</code> in the package geiger. These are tree transformation
functions; together with BM simulation functions, they would be expected to
have a similar effect as this function (when cladogenesis is 'bifurcating'
and not 'budding'; see above).
</p>


<h3>Examples</h3>

<pre><code class="language-R">
 

set.seed(444)
record &lt;- simFossilRecord(
   p = 0.1, q = 0.1, 
   nruns = 1,
   nTotalTaxa = c(30, 1000), 
   plot = TRUE)
taxa &lt;- fossilRecord2fossilTaxa(record)
trait &lt;- cladogeneticTraitCont(taxa)
tree &lt;- taxa2phylo(taxa)
plotTraitgram(trait, tree,
   conf.int = FALSE)

#with cryptic speciation
record &lt;- simFossilRecord(
   p = 0.1, q = 0.1, 
   prop.cryptic = 0.5, 
   nruns = 1, 
   nTotalTaxa = c(30, 1000), 
   plot = TRUE)
taxa &lt;- fossilRecord2fossilTaxa(record)
trait &lt;- cladogeneticTraitCont(taxa)
tree &lt;- taxa2phylo(taxa)
plotTraitgram(trait, tree,
   conf.int = FALSE)


</code></pre>


</div>