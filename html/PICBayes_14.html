<div class="container">

<table style="width: 100%;"><tr>
<td>clusterPIC_Z_DP</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>Mixed effects PH model for clustered partly interval-censored data</h2>

<h3>Description</h3>

<p>Fit a Bayesian semiparametric mixed effects PH model for clustered partly 
interval-censored data with random effects for one or more predictors. 
Each random effect follows a DP mixture distribution.</p>


<h3>Usage</h3>

<pre><code class="language-R">clusterPIC_Z_DP(L, R, y, xcov, IC, scale.designX, scaled, zcov, area, binary, I, order, 
knots, grids, a_eta, b_eta, a_ga, b_ga, a_alpha, b_alpha, H, 
a_tau_star, b_tau_star, beta_iter, phi_iter, beta_cand, phi_cand, 
beta_sig0, x_user, total, burnin, thin, conf.int, seed)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>L</code></td>
<td>
<p>The vector of left endpoints of the observed time intervals.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>R</code></td>
<td>
<p>The vector of right endponts of the observed time intervals.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>y</code></td>
<td>
<p>The vector of censoring indicator: 0=left-censored, 1=interval-censored, 
2=right-censored, 3=exact.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>xcov</code></td>
<td>
<p>The covariate matrix for the p predictors.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>IC</code></td>
<td>
<p>The vector of general interval-censored indicator: 
1=general interval-censored, 0=exact.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>scale.designX</code></td>
<td>
<p>The TRUE or FALSE indicator of whether or not to scale the design matrix X.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>scaled</code></td>
<td>
<p>The vector indicating whether each covariate is to be scaled: 1=to be scaled, 0=not.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>zcov</code></td>
<td>
<p>The design matrix for the q random effects.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>area</code></td>
<td>
<p>The vector of cluster ID.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>binary</code></td>
<td>
<p>The vector indicating whether each covariate is binary.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>I</code></td>
<td>
<p>The number of clusters.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>order</code></td>
<td>
<p>The degree of basis I-splines: 1=linear, 2=quadratic, 3=cubic, etc.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>knots</code></td>
<td>
<p>A sequence of knots to define the basis I-splines.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>grids</code></td>
<td>
<p>A sequence of points at which baseline survival function is to be estimated.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>a_eta</code></td>
<td>
<p>The shape parameter of Gamma prior for <code>gamma_l</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>b_eta</code></td>
<td>
<p>The rate parameter of Gamma prior for <code>gamma_l</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>a_ga</code></td>
<td>
<p>The shape parameter of Gamma prior for <code>e^{beta_r}</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>b_ga</code></td>
<td>
<p>The rate parameter of Gamma prior for <code>e^{beta_r}</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>a_alpha</code></td>
<td>
<p>The shape parameter of Gamma prior for <code>alpha</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>b_alpha</code></td>
<td>
<p>The rate parameter of Gamma prior for <code>alpha</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>H</code></td>
<td>
<p>The number of distinct components in DP mixture prior under blocked Gibbs sampler.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>a_tau_star</code></td>
<td>
<p>The shape parameter of <code>G_0</code> in DP mixture prior.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>b_tau_star</code></td>
<td>
<p>The rate parameter of <code>G_0</code> in DP mixture prior.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>beta_iter</code></td>
<td>
<p>The number of initial iterations in the Metropolis-Hastings sampling for <code>beta_r</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>phi_iter</code></td>
<td>
<p>The number of initial iterations in the Metropolis-Hastings sampling for <code>phi_i</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>beta_cand</code></td>
<td>
<p>The sd of the proposal normal distribution in the initial MH sampling for <code>beta_r</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>phi_cand</code></td>
<td>
<p>The sd of the proposal normal distribution in the initial MH sampling for <code>phi_i</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>beta_sig0</code></td>
<td>
<p>The sd of the prior normal distribution for <code>beta_r</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>x_user</code></td>
<td>
<p>The user-specified covariate vector at which to estimate survival function(s).</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>total</code></td>
<td>
<p>The number of total iterations.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>burnin</code></td>
<td>
<p>The number of burnin.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>thin</code></td>
<td>
<p>The frequency of thinning.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>conf.int</code></td>
<td>
<p>The confidence level of the CI for <code>beta_r</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>seed</code></td>
<td>
<p>A user-specified random seed.</p>
</td>
</tr>
</table>
<h3>Details</h3>

<p>The mixed effects PH model is:
</p>
<p><code>h(t_{ij}|x_{ij},z_{i})=h_{0}(t_{ij})exp(beta'x_{ij}+phi_{i}'z_{i})</code>,
</p>
<p>for the jth subject in the ith cluster.
</p>
<p>Each of the q random effects is sampled using MH algorithm separately.
</p>


<h3>Value</h3>

<p>a list containing the following elements:
</p>
<table>
<tr style="vertical-align: top;">
<td><code>N</code></td>
<td>
<p>The sample size.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>parbeta</code></td>
<td>
<p>A <code>total</code> by <code>p</code> matrix of MCMC draws of <code>beta_r</code>, r=1, ..., p.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>parsurv0</code></td>
<td>
<p>A <code>total</code> by <code>length(grids)</code> matrix, each row contains the baseline survival at <code>grids</code> from one iteration.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>parsurv</code></td>
<td>
<p>A <code>total</code> by <code>length(grids)*G</code> matrix, each row contains the survival at <code>grids</code> from one iteration. 
G is the number of sets of user-specified covariate values.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>paralpha</code></td>
<td>
<p>A <code>total</code> by <code>q</code> vector of MCMC draws of <code>alpha</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>coef</code></td>
<td>
<p>A vector of regression coefficient estimates.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>coef_ssd</code></td>
<td>
<p>A vector of sample standard deviations of regression coefficient estimates.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>coef_ci</code></td>
<td>
<p>The credible intervals for the regression coefficients.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>S0_m</code></td>
<td>
<p>The estimated baseline survival at <code>grids</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>S_m</code></td>
<td>
<p>The estimated survival at <code>grids</code> with user-specified covariate values <code>x_user</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>grids</code></td>
<td>
<p>The sequance of points where baseline survival function is estimated.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>DIC</code></td>
<td>
<p>Deviance information criterion.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>NLLK</code></td>
<td>
<p>Negative log pseudo-marginal likelihood.</p>
</td>
</tr>
</table>
<h3>Author(s)</h3>

<p>Chun Pan</p>


<h3>Examples</h3>

<pre><code class="language-R"># Number of iterations set to very small for CRAN automatic testing
data(da4)
J=rep(1,nrow(da4))
zcov=cbind(J,da4[,4])
try8&lt;-PICBayes(formula=Surv(L,R,type='interval2')~x1+x2,data=data.frame(da4),
model='clusterPIC_Z_DP',IC=da4[,7],scale.designX=TRUE,scaled=c(1,0),zcov=zcov,
area=da4[,6],binary=c(0,1),I=25,order=3,knots=c(0,2,6,max(da4[,1:2],na.rm=TRUE)+1),
grids=seq(0.1,10.1,by=0.1),a_eta=1,b_eta=1,a_ga=1,b_ga=1,a_alpha=1,b_alpha=1,H=5,
a_tau_star=1,b_tau_star=1,beta_iter=11,phi_iter=11,beta_cand=1,phi_cand=1,
beta_sig0=10,x_user=NULL,total=20,burnin=10,thin=1,conf.int=0.95,seed=1)
</code></pre>


</div>