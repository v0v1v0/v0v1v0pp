<div class="container">

<table style="width: 100%;"><tr>
<td>twoby2Calibrate</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>
Minimum Bayes factors and p-values from Fisher's exact test for 2x2 contingency tables

</h2>

<h3>Description</h3>

<p>Computes a sample-size adjusted lower bound on the Bayes factor
(for the point null hypothesis against the alternative) 
for the given 2x2 contingency table.
Also returns p-values from Fisher's exact test
(different versions in the two-sided case) and less conservative
alternatives such as a mid p-value (see Details for more information).

</p>


<h3>Usage</h3>

<pre><code class="language-R">twoby2Calibrate(x, type="two.sided", alternative="normal", 
                direction=NULL, transform.bf="id")
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>x</code></td>
<td>
<p>a 2x2 contingency table in matrix form

</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>type</code></td>
<td>

<p>either <code>"one.sided"</code> or <code>"two.sided"</code>.
Defaults to <code>"two.sided"</code>.
Specifies if Fisher's exact test (and the corresponding p-value) is one-sided or two-sided.
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>alternative</code></td>
<td>

<p>either <code>"simple"</code> or <code>"normal"</code>.
Defaults to <code>"normal"</code>.
Specifies the alternative hypotheses for the (log) odds ratio to consider
for two-sided tests.
Is ignored if <code>type="one.sided"</code>
(in this case only simple alternatives are available).

</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>direction</code></td>
<td>

<p>either <code>"greater"</code>, <code>"less"</code> or <code>NULL</code>.
Defaults to <code>NULL</code>.
Specifies the direction of the alternative for one-sided tests: <code>"greater"</code> corresponds
to an odds ratio &gt; 1 and <code>"less"</code> to an odds ratio &lt; 1.
Is ignored if <code>type="two.sided"</code>.
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>transform.bf</code></td>
<td>

<p>either <code>"id"</code>, <code>"log"</code>, <code>"log2"</code>  or <code>"log10"</code>.
Defaults to <code>"id"</code>.
Specifies how to transform the lower bound on the Bayes factor.
<code>"id"</code> corresponds to no transformation.
<code>"log"</code> refers to the natural logarithm, <code>"log2"</code> to the logarithm
to the base 2 and <code>"log10"</code> to the logarithm
to the base 10.
</p>
</td>
</tr>
</table>
<h3>Details</h3>

<p>If <code>type="two.sided"</code>,
the point null hypothesis that the odds ratio is 1 is tested
against
specific two-sided alternatives:
<code>alternative="simple"</code> considers all two-point distributions symmetric around 0 for
the log odds ratio.
<code>alternative="normal"</code> assumes a local normal prior distribution (a so-called g-prior) centered around 0
for the log odds ratio.  
</p>
<p>In the one-sided case (<code>type="one.sided"</code>), <code>direction="less"</code> tests the alternative that the odds ratio is
less than 1 and considers simple point alternatives in that direction
to compute the lower bound on the Bayes factor.
<code>"greater"</code> does the same for the alternative that the odds ratio is
larger than 1.
</p>
<p>The calibration obtained with <code>type="two.sided", alternative="normal"</code> is based on
the methodology proposed in Li &amp; Clyde (2018) 
and yields an (approximate) lower bound on the Bayes factor
in closed form.
All the other lower bounds on the Bayes factor
are computed by numerical optimization.
For <code>type="two.sided"</code>,
the two calibrations are described in Ott &amp; Held (2019).
</p>
<p>For one-sided alternatives, the following p-value and 2 related quantities are computed:
</p>

<ul>
<li> <p><code>p.fi</code>   is the one-sided p-value from Fisher's exact test.
</p>
</li>
<li> <p><code>p.mid</code> is a "mid" p-value. It is obtained by subtracting half of the
probability mass of the observed table from <code>p.fi</code>.
</p>
</li>
<li> <p><code>p.lie</code> is a Bayesian posterior probability. 
If <code>direction="greater"</code>, it is the posterior probability that the odds ratio
exceeds 1 given the observed table under the assumption of uniform priors on the
success probabilities for the two groups.
If <code>direction="less"</code>, it is the posterior probability that the odds ratio
does not exceed 1 given the observed table under the same priors.
</p>
</li>
</ul>
<p>For two-sided alternatives, the following 3 p-values and 2 related quantities are computed:
</p>

<ul>
<li> <p><code>p.pb</code>   is the "probability-based" p-value (the classical choice), 
defined as the sum
of the probabilities of all tables which are at most a likely as the observed table and
have the same marginals.
</p>
</li>
<li> <p><code>p.ce</code>  is the "central" p-value, which is twice the minimum one-sided p-value
(from Fisher's exact test),
bounded by 1.
</p>
</li>
<li> <p><code>p.bl</code> is "Blaker's" p-value, which is the minimum one-sided p-value
(from Fisher's exact test)
plus the largest tail probability from the other tail of the distribution that
does not exceed that minimum.
</p>
</li>
<li> <p><code>p.mid</code> is a "mid" p-value. It is the mid-p modification of the central p-value, 
i.e. it equals twice the minimum
one-sided mid p-value. 
</p>
</li>
<li> <p><code>p.lie</code> is a two-sided version of the posterior probability
for the one-sided test. 
Let p.lie.os be the one-sided posterior probability that the odds ratio does not exceed 1
given the observed table,
as returned by the one-sided test with <code>direction="less"</code>.
Then <code>p.lie</code> = 2 min{p.lie.os, 1-p.lie.os}.
</p>
</li>
</ul>
<p>For one-sided alternatives,
the posterior probability <code>p.lie</code> was already studied in Liebermeister (1877)
and its frequentist properties are investigated in Seneta &amp; Phipps (2001).
</p>
<p>For two-sided alternatives, the 3 p-values from Fisher's exact test are defined in equations (2.24)-(2.26)
in Kateri (2014) and computed using the function <code>exact2x2()</code> in the 
package <code>exact2x2</code>.
The "mid" p-value is described in Rothman &amp; Greenland (1998, pp. 222-223).
The Bayesian significance measure <code>p.lie</code> is proposed in Ott &amp; Held (2019)
as a modification of the corresponding one-sided significance measure.
</p>


<h3>Value</h3>

<p>A list of the following two elements:
</p>
<table>
<tr style="vertical-align: top;">
<td><code>minBF </code></td>
<td>
<p>the lower bound on the Bayes factor</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>p.value </code></td>
<td>
<p>A vector of 3 one-sided p-values/significance measures
for one-sided tests, <br>
namely first the p-value <code>p.fi</code> from Fisher's exact test,
second the corresponding mid p-value <code>p.mid</code> and 
third the Bayesian posterior probability <code>p.lie</code>
(see Details for more information).
</p>
<p>A vector of 5 two-sided p-values/significance measures
for two-sided tests: 
The first three p-values
<code>p.pb</code>, <code>p.ce</code> and <code>p.bl</code> (see Details for the definitions) correspond to
two-sided p-values from Fisher's exact test.
The 4th quantity <code>p.mid</code> is a mid p-value, namely the mid-p modification of the second p-value <code>p.ce</code>.
The last element <code>p.lie</code> is a Bayesian significance measure
(see Details for additional information).</p>
</td>
</tr>
</table>
<h3>Warning</h3>

<p>For 2x2 tables with entries equal to 0,
the minimum Bayes factor is either not defined <br>
(for <code>alternative="normal"</code>) or 
the underlying numerical optimization is unstable <br>
(for <code>alternative="simple"</code>).
A warning is displayed in such cases and <code>minBF=NA</code>
is returned,
but the different p-values/significance measures 
are still available.
</p>


<h3>References</h3>

<p>Li, Y. and Clyde, M. A. (2018). Mixtures of g-priors in generalized linear models. 
<em>Journal of the American Statistical Association</em>, <b>113</b>:524, 1828–1845. 
<a href="https://doi.org/10.1080/01621459.2018.1469992">https://doi.org/10.1080/01621459.2018.1469992</a>
</p>
<p>Liebermeister, C. (1877). Ueber Wahrscheinlichkeitsrechnung in Anwendung auf therapeutische Statistik. Sammlung klinischer Vortraege. <em>Innere Medizin</em>, <b>110</b>(31–64), 935–
962.
</p>
<p>Kateri, M. (2014). Contingency Table Analysis - Methods and Implementation using R.
Statistics for Industry and Technology. Birkhaeuser.
</p>
<p>Ott, M. and Held, L. (2019). Bayesian calibration of p-values from Fisher's
exact test. <em>International Statistical Review</em> <b>87</b>(2), 285–305.
<a href="https://doi.org/10.1111/insr.12307">https://doi.org/10.1111/insr.12307</a>
</p>
<p>Rothman, K. J. and Greenland, S. (1998). Modern Epidemiology. 2nd ed. Lippincott-Raven.
</p>
<p>Seneta, E. and Phipps, M. C. (2001). On the comparison of two observed frequencies.
<em>Biometrical Journal</em>, <b>43</b>(1), 23–43.

</p>


<h3>See Also</h3>

<p>For computation of p-values:
<code>exact2x2</code> in package exact2x2.

</p>


<h3>Examples</h3>

<pre><code class="language-R">tab &lt;- matrix(c(1,15,5,10), nrow=2, byrow=TRUE)
# different minimum Bayes factors
twoby2Calibrate(x=tab, type="one.sided", direction="greater")$minBF
twoby2Calibrate(x=tab, type="one.sided", direction="less")$minBF
twoby2Calibrate(x=tab, type="two.sided", alternative="simple")$minBF
twoby2Calibrate(x=tab)$minBF
# one-sided p-values
twoby2Calibrate(x=tab, type="one.sided", direction="greater")$p.value
twoby2Calibrate(x=tab, type="one.sided", direction="less")$p.value
# two-sided p-values
twoby2Calibrate(x=tab)$p.value
</code></pre>


</div>