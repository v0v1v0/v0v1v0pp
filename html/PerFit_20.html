<div class="container">

<table style="width: 100%;"><tr>
<td>PerFit-package</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>
Person Fit
</h2>

<h3>Description</h3>

<p>Person fit consists of a set of techniques aimed at detecting unusual responses to tests or questionnaires. There are several person-fit statistics available in the literature, see Karabatsos (2003) and Meijer and Sijtsma (2001) for comprehensive reviews. Both dichotomous and polytomous types of items are considered. This R-package outputs the values of the chosen person-fit statistic, the IDs of the respondents that were flagged, and plots the sample distribution of the scores of the person-fit statistic. Nonparametric person response functions (Sijtsma and Meijer, 2001) may also be requested in order to help interpreting individual answering behaviors (dichotomous data only).
</p>


<h3>Details</h3>


<table>
<tr>
<td style="text-align: left;">
Package: </td>
<td style="text-align: left;"> PerFit</td>
</tr>
<tr>
<td style="text-align: left;">
Type: </td>
<td style="text-align: left;"> Package</td>
</tr>
<tr>
<td style="text-align: left;">
Title: </td>
<td style="text-align: left;"> Person Fit</td>
</tr>
<tr>
<td style="text-align: left;">
Version: </td>
<td style="text-align: left;"> 1.4.6</td>
</tr>
<tr>
<td style="text-align: left;">
Date: </td>
<td style="text-align: left;"> 2021-10-14</td>
</tr>
<tr>
<td style="text-align: left;">
Author: </td>
<td style="text-align: left;"> Jorge N. Tendeiro</td>
</tr>
<tr>
<td style="text-align: left;">
Maintainer: </td>
<td style="text-align: left;"> Jorge N. Tendeiro &lt;tendeiro@hiroshima-u.ac.jp&gt;</td>
</tr>
<tr>
<td style="text-align: left;">
Description: </td>
<td style="text-align: left;"> Several person-fit statistics 
  (PFSs; Meijer and Sijtsma, 2001, &lt;doi:10.1177/01466210122031957&gt;) 
  are offered. These statistics allow assessing whether
  individual response patterns to tests or questionnaires are (im)plausible given 
  the other respondents in the sample or given a specified item response theory model. Some PFSs apply to 
  dichotomous data, such as the likelihood-based PFSs (lz, lz*) and the group-based PFSs 
  (personal biserial correlation, caution index, (normed) number of Guttman errors, 
  agreement/disagreement/dependability statistics, U3, ZU3, NCI, Ht). PFSs suitable to polytomous data include
  extensions of lz, U3, and (normed) number of Guttman errors. </td>
</tr>
<tr>
<td style="text-align: left;">
Imports: </td>
<td style="text-align: left;"> stats, graphics, fda, Hmisc, irtoys, MASS, Matrix</td>
</tr>
<tr>
<td style="text-align: left;">
Depends: </td>
<td style="text-align: left;"> ltm, mirt</td>
</tr>
<tr>
<td style="text-align: left;">
License: </td>
<td style="text-align: left;"> GPL (&gt;=2)</td>
</tr>
<tr>
<td style="text-align: left;">
RoxygenNote: </td>
<td style="text-align: left;"> 7.1.1</td>
</tr>
<tr>
<td style="text-align: left;">
</td>
</tr>
</table>
<p>Index of help topics:
</p>
<pre>
A.KB                    Agreement, disagreement, and dependability
                        statistics
Cstar                   C.Sato, Cstar person-fit statistics
G                       Number of Guttman errors
Gpoly                   Number of Guttman errors for polytomous items
Ht                      Ht person-fit statistic
InadequacyData          The NPV-J inadequacy scale data
IntelligenceData        Intelligence data (number completion)
NCI                     NCI person-fit statistic
PRFplot                 Person response function (PRF)
PerFit-package          Person Fit
PerFit.PFS              Compute several person-fit statistics
PerFit.SE               Compute standard errors for person fit
                        statistics
PhysFuncData            The SF-36 physical functioning data
U3                      U3, ZU3 person-fit statistics
U3poly                  U3poly person-fit statistic
cutoff                  Compute a cutoff value given the scores of a
                        person-fit statistic
flagged.resp            Find (potentially) aberrant response patterns
lz                      lz and lzstar person-fit statistics
lzpoly                  lzpoly person-fit statistic
plot.PerFit             Plot method for objects of class "PerFit"
print.PerFit            Print method for objects of class "PerFit"
r.pbis                  Personal biserial statistic
summary.PerFit          Summary method for objects of class "PerFit"
</pre>
<p>The <span class="pkg">PerFit</span> package contains several person-fit functions. The goal is to detect response vectors that seem to be strange in terms of the sample of respondents or in terms to an item response theory (IRT) model.
</p>
<p>There are many person-fit statistics available in the literature. Statistics are typically categorized according to the type of items (Dicho = dichotomous, Poly = polytomous) and the type of IRT model (NParam=nonparametric, Param=parametric) that they apply to. The current version of <span class="pkg">PerFit</span> includes the following statistics:
</p>

<table>
<tr>
<td style="text-align: left;">
<b>Person-fit statistic (R function)</b>  </td>
<td style="text-align: left;"> <b>Reference</b>      </td>
<td style="text-align: center;"> <b>Type item</b> </td>
<td style="text-align: center;"> <b>Type IRT model</b>
</td>
</tr>
<tr>
<td style="text-align: left;">
<code>r.pbis</code>        </td>
<td style="text-align: left;"> Donlon and Fisher (1968)             </td>
<td style="text-align: center;"> Dicho            </td>
<td style="text-align: center;"> NParam</td>
</tr>
<tr>
<td style="text-align: left;">
<code>C.Sato</code>        </td>
<td style="text-align: left;"> Sato (1975)                          </td>
<td style="text-align: center;"> Dicho            </td>
<td style="text-align: center;"> NParam</td>
</tr>
<tr>
<td style="text-align: left;">
<code>G</code>, <code>Gnormed</code> </td>
<td style="text-align: left;"> van der Flier (1977), Meijer (1994)  </td>
<td style="text-align: center;"> Dicho            </td>
<td style="text-align: center;"> NParam</td>
</tr>
<tr>
<td style="text-align: left;">
<code>A.KB</code>, <code>D.KB</code>, <code>E.KB</code> </td>
<td style="text-align: left;"> Kane and Brennan (1980) </td>
<td style="text-align: center;"> Dicho </td>
<td style="text-align: center;"> NParam</td>
</tr>
<tr>
<td style="text-align: left;">
<code>U3</code>, <code>ZU3</code> </td>
<td style="text-align: left;"> van der Flier (1980, 1982)           </td>
<td style="text-align: center;"> Dicho            </td>
<td style="text-align: center;"> NParam</td>
</tr>
<tr>
<td style="text-align: left;">
<code>Cstar</code>         </td>
<td style="text-align: left;"> Harnisch and Linn (1981)             </td>
<td style="text-align: center;"> Dicho            </td>
<td style="text-align: center;"> NParam</td>
</tr>
<tr>
<td style="text-align: left;">
<code>NCI</code>           </td>
<td style="text-align: left;"> Tatsuoka and Tatsuoaka (1982, 1983)  </td>
<td style="text-align: center;"> Dicho            </td>
<td style="text-align: center;"> NParam</td>
</tr>
<tr>
<td style="text-align: left;">
<code>lz</code>            </td>
<td style="text-align: left;"> Drasgow, Levine, and Williams (1985) </td>
<td style="text-align: center;"> Dicho            </td>
<td style="text-align: center;"> Param</td>
</tr>
<tr>
<td style="text-align: left;">
<code>lzpoly</code>        </td>
<td style="text-align: left;"> Drasgow, Levine, and Williams (1985) </td>
<td style="text-align: center;"> Poly             </td>
<td style="text-align: center;"> Param</td>
</tr>
<tr>
<td style="text-align: left;">
<code>Ht</code>            </td>
<td style="text-align: left;"> Sijtsma (1986)                       </td>
<td style="text-align: center;"> Dicho            </td>
<td style="text-align: center;"> NParam</td>
</tr>
<tr>
<td style="text-align: left;">
<code>Gpoly</code>        </td>
<td style="text-align: left;"> Molenaar (1991)                      </td>
<td style="text-align: center;"> Poly             </td>
<td style="text-align: center;"> NParam</td>
</tr>
<tr>
<td style="text-align: left;">
<code>Gnormed.poly</code> </td>
<td style="text-align: left;"> Molenaar (1991), Emons (2008)        </td>
<td style="text-align: center;"> Poly             </td>
<td style="text-align: center;"> NParam</td>
</tr>
<tr>
<td style="text-align: left;">
<code>lzstar</code>        </td>
<td style="text-align: left;"> Snijders (2001)                      </td>
<td style="text-align: center;"> Dicho            </td>
<td style="text-align: center;"> Param</td>
</tr>
<tr>
<td style="text-align: left;">
<code>U3poly</code>        </td>
<td style="text-align: left;"> Emons (2008)                         </td>
<td style="text-align: center;"> Poly             </td>
<td style="text-align: center;"> NParam</td>
</tr>
<tr>
<td style="text-align: left;">
</td>
</tr>
</table>
<p>All functions above have an output of class <code>PerFit</code>.
</p>
<p>The package provides other functions that help analyzing the data when conducting person-fit analyses:
</p>

<table>
<tr>
<td style="text-align: left;">
<b>Function</b>                           </td>
<td style="text-align: left;"> <b>Description</b>
</td>
</tr>
<tr>
<td style="text-align: left;">
<code>cutoff</code>                      </td>
<td style="text-align: left;"> Estimate cutoff values for the person-fit statistics, to be used as decision rules.</td>
</tr>
<tr>
<td style="text-align: left;">
<code>flagged.resp</code>                </td>
<td style="text-align: left;"> Identify which respondents were flagged according to the chosen cutoff.</td>
</tr>
<tr>
<td style="text-align: left;">
<code>plot</code> (class <code>PerFit</code>)  </td>
<td style="text-align: left;"> Plot the distribution of person-fit scores with the cutoff superimposed.</td>
</tr>
<tr>
<td style="text-align: left;">
<code>PRFplot</code>                     </td>
<td style="text-align: left;"> Plot the nonparametric person response function (Sijtsma and Meijer, 2001).
</td>
</tr>
</table>
<p>More person-fit statistics will be added to the package in future updates.
</p>
<p><b>Versions</b>
</p>

<ul>
<li>
<p> Version 1.0 (April 2014)
</p>
</li>
<li>
<p> Version 1.1 (May 2014)
</p>
<p>Functions <code>plot.PerFit</code> and <code>PRFplot</code> now allow the user to edit the axes labels and the titles.
</p>
</li>
<li>
<p> Version 1.2 (August 2014)
</p>
<p>Some output values of some functions were renamed for the sake of consistency. The package documentation was adapted accordingly.
</p>
</li>
<li>
<p> Version 1.3 (March 2015)
</p>
<p>The package underwent a major revision:
</p>

<ul>
<li>
<p> Class <code>PerFit</code> now consists of a list with 12 objects.
</p>
</li>
<li>
<p> New methods for objects of class <code>PerFit</code> were added (<code>summary</code>, <code>print</code>).
</p>
</li>
<li>
<p> Routines accomodating for missing values were added.
</p>
</li>
<li>
<p> Function <code>cutoff</code> was updated. Now, model-fitting item response patterns are generated in order to find the cutoff value.
</p>
</li>
<li>
<p> Function <code>plot.PerFit</code> now allows displaying a bootstrap percentile confidence interval for the cutoff statistic, as well as ticks marking the flagged respondents.
</p>
</li>
<li>
<p> Person response functions are now approximated by functional data objects computed by means of the <code>fda</code> package. The functional data objects are returned to the user.
</p>
</li>
<li>
<p> Standard errors for the person-fit statistics are now available (see function <code>PerFit.SE</code>).
</p>
</li>
<li>
<p> Many control checks were added throughout the entire code.
</p>
</li>
</ul>
</li>
<li>
<p> Version 1.4 (July 2015)
</p>

<ul>
<li>
<p> The default missing values approach is now pairwise elimination. The imputation methods introduced with version 1.3.1 are still available.
</p>
</li>
<li>
<p> A bug was removed from function <code>lzpoly()</code> (many thanks to Marco Bressan for spotting it!).
</p>
</li>
<li>
<p> The PerFit-package.Rd file was updated (version 1.4.2).
</p>
</li>
<li>
<p> A bug in function <code>U3poly</code> was fixed (version 1.4.3, October 2018). All credit goes to Marek Muszynski for spotting the issue.
</p>
</li>
<li>
<p> Recent changes to base plot() broke function <code>PRFplot()</code>. This was now fixed (version 1.4.4, January 2021). I thank Julie Webbs for pointing this out.
</p>
</li>
<li>
<p> Version 1.4.5, February 2021: Updated affiliation.
</p>
</li>
<li>
<p> Version 1.4.6, October 2021: Updated internal function <code>estIP.poly()</code> to properly manage cases where users supply item and/or person parameters.
</p>
</li>
</ul>
</li>
</ul>
<h3>Author(s)</h3>

<p>Jorge N. Tendeiro
</p>
<p>Maintainer: Jorge N. Tendeiro &lt;tendeiro@hiroshima-u.ac.jp&gt;
</p>


<h3>References</h3>

<p>Donlon, T. F., and Fischer, F. E. (1968) An index of an individual's agreement with group-defined item difficulties. <em>Educational and Psychological Measurement</em>, <b>28(1)</b>, 105–113.
</p>
<p>Drasgow, F., Levine, M. V., and Williams, E. A. (1985) Appropriateness measurement with polychotomous item response models and standardized indices. <em>British Journal of Mathematical and Statistical Psychology</em>, <b>38(1)</b>, 67–86.
</p>
<p>Emons, W. M. (2008) Nonparametric person-fit analysis of polytomous item scores. <em>Applied Psychological Measurement</em>, <b>32(3)</b>, 224–247. 
</p>
<p>Harnisch, D. L., and Linn, R. L. (1981) Analysis of item response patterns: Questionable test data and dissimilar curriculum practices. <em>Journal of Educational Measurement</em>, <b>18(3)</b>, 133–146.
</p>
<p>Kane, M. T., and Brennan, R. L. (1980) Agreement coefficients as indices of dependability for domain-referenced tests. <em>Applied Psychological Measurement</em>, <b>4(1)</b>, 105–126.
</p>
<p>Karabatsos, G. (2003) Comparing the Aberrant Response Detection Performance of Thirty-Six Person-Fit Statistics. <em>Applied Measurement In Education</em>, <b>16(4)</b>, 277–298.
</p>
<p>Meijer, R. R. (1994) The number of Guttman errors as a simple and powerful person-fit statistic. <em>Applied Psychological Measurement</em>, <b>18(4)</b>, 311–314.
</p>
<p>Meijer, R. R., and Sijtsma, K. (2001) Methodology review: Evaluating person fit. <em>Applied Psychological Measurement</em>, <b>25(2)</b>, 107–135.
</p>
<p>Molenaar, I. W. (1991) A weighted Loevinger H-coefficient extending Mokken scaling to multicategory items. <em>Kwantitatieve Methoden</em>, <b>12(37)</b>, 97–117.
</p>
<p>Sato, T. (1975) <em>The construction and interpretation of S-P tables.</em> Tokyo: Meiji Tosho.
</p>
<p>Sijtsma, K. (1986) A coefficient of deviance of response patterns. <em>Kwantitatieve Methoden</em>, <b>7</b>, 131–145.
</p>
<p>Sijtsma, K., and Meijer, R. R. (2001) The person response function as a tool in person-fit research. <em>Psychometrika</em>, <b>66(2)</b>, 191–207. 
</p>
<p>Snijders, T. B. (2001) Asymptotic null distribution of person fit statistics with estimated person parameter. <em>Psychometrika</em>, <b>66(3)</b>, 331–342. 
</p>
<p>Tatsuoka, K. K., and Tatsuoka, M. M. (1982) Detection of aberrant response patterns and their effect on dimensionality. <em>Journal of Educational Statistics</em>, <b>7(3)</b>, 215–231.
</p>
<p>Tatsuoka, K. K., and Tatsuoka, M. M. (1983) Spotting erroneous rules of operation by the individual consistency index. <em>Journal of Educational Measurement</em>, <b>20(3)</b>, 221–230.
</p>
<p>Tendeiro, J. N., Meijer, R. R., and Niessen, A. S. M. (2016). PerFit: An R Package for Person-Fit Analysis in IRT. <em>Journal of Statistical Software</em>, <b>74(5)</b>, 1–27.
</p>
<p>van der Flier, H. (1977) Environmental factors and deviant response patterns. In Y. H. Poortinga (Ed.), <em>Basic problems in cross-cultural psychology.</em> Amsterdam: The Netherlands.
</p>
<p>van der Flier, H. (1980) <em>Vergelijkbaarheid van individuele testprestaties</em> [Comparability of individual test performance]. Lisse: The Netherlands.
</p>
<p>van der Flier, H. (1982) Deviant response patterns and comparability of test scores. <em>Journal of Cross-Cultural Psychology</em>, <b>13(3)</b>, 267–298.
</p>


<h3>Examples</h3>

<pre><code class="language-R">
# Load the inadequacy scale data (dichotomous item scores):
data(InadequacyData)

# As an example, compute the Ht person-fit scores:
Ht.out &lt;- Ht(InadequacyData)
# Ht.out$PFscores

# Compute the cutoff value at 1% level:
set.seed(124) # To fix the random seed generator.
Ht.cut &lt;- cutoff(Ht.out, Blvl=.01)

# Plot the sample distribution of the Ht scores with the above cutoff superimposed:
plot(Ht.out, cutoff.obj=Ht.cut)

# Determine which respondents were flagged by Ht at 1% level:
flagged.resp(Ht.out, cutoff.obj=Ht.cut, scores=FALSE)
# Flagged respondents: 30, 37, 46, 49,...

# Plot the person response function of respondent 30 (flagged as aberrant):
Resp30 &lt;- PRFplot(InadequacyData, respID=30)
# Plot the person response function of respondent 35 (not flagged as aberrant):
Resp35 &lt;- PRFplot(InadequacyData, respID=35)
</code></pre>


</div>