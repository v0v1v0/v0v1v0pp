<div class="container">

<table style="width: 100%;"><tr>
<td>invert.pmultinom</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>Calculate the sample size such that the probability of a result is a given amount.</h2>

<h3>Description</h3>

<p>Calculate the sample size such that the probability of a result is a given amount.
</p>


<h3>Usage</h3>

<pre><code class="language-R">invert.pmultinom(lower = -Inf, upper = Inf, probs, target.prob, method)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>lower</code></td>
<td>
<p>Vector of lower bounds. Lower bounds are excluded</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>upper</code></td>
<td>
<p>Vector of upper bounds. Upper bounds are included</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>probs</code></td>
<td>
<p>Cell probabilities</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>target.prob</code></td>
<td>
<p>The probability of the event, at the output sample size.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>method</code></td>
<td>
<p>Method used for computation. Only method currently implemented is "exact"</p>
</td>
</tr>
</table>
<h3>Details</h3>

<p>If only lower is given, then the result is the smallest size such that
pmultinom(lower=lower, size=size, probs=probs) &gt;= target.prob. If only upper
is given, then the result is the smallest size such that
pmultinom(upper=upper, size=size, probs=probs) &lt;= target.prob. Behavior when
both lower and upper are given is not yet implemented.
</p>


<h3>Value</h3>

<p>The sample size parameter at which the the target probability of the given event is achieved.
</p>


<h3>References</h3>

<p>Casasent, A. K., Schalck, A., Gao, R., Sei, E., Long, A., Pangburn, W., ... &amp; Navin, N. E. (2018). Multiclonal Invasion in Breast Tumors Identified by Topographic Single Cell Sequencing. Cell. doi:10.1016/j.cell.2017.12.007
</p>


<h3>See Also</h3>

<p><code>pmultinom</code>
</p>


<h3>Examples</h3>

<pre><code class="language-R"># How many cells must be sequenced to have a 95% chance of
# observing at least 2 from each subclone of a tumor? (Data
# from Casasent et al (2018); see vignette("pmultinom") for
# details of this example)

# Input: 
ncells &lt;- 204
subclone.freqs &lt;- c(43, 20, 82, 17, 5, 37)/ncells
target.number &lt;- c(2, 2, 2, 2, 2, 0)
lower.bound &lt;- target.number - 1
invert.pmultinom(lower=lower.bound, probs=subclone.freqs,
                 target.prob=.95, method="exact")
# Output:
# [1] 192

</code></pre>


</div>