<div class="container">

<table style="width: 100%;"><tr>
<td>buildModelSeries</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>Build a series of linear models using automated variable selection</h2>

<h3>Description</h3>

<p>Build a series of linear models with <code>stats::lm()</code> using one or more automated variable
selection methods implemented in the functions <code>stepVIF()</code> and <code>MASS::stepAIC()</code>.
</p>


<h3>Usage</h3>

<pre><code class="language-R">buildModelSeries(
  formula,
  data,
  vif = FALSE,
  vif.threshold = 10,
  vif.verbose = FALSE,
  aic = FALSE,
  aic.direction = "both",
  aic.trace = FALSE,
  aic.steps = 5000,
  ...
)

buildMS(
  formula,
  data,
  vif = FALSE,
  vif.threshold = 10,
  vif.verbose = FALSE,
  aic = FALSE,
  aic.direction = "both",
  aic.trace = FALSE,
  aic.steps = 5000,
  ...
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>formula</code></td>
<td>
<p>A list containing one or several model formulas (a symbolic description of the
model to be fitted).</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>data</code></td>
<td>
<p>Data frame containing the variables in the model formulas.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>vif</code></td>
<td>
<p>Logical for performing backward variable selection using the Variance-Inflation Factor
(VIF). Defaults to <code>vif = FALSE</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>vif.threshold</code></td>
<td>
<p>Numeric value setting the maximum acceptable VIF value. Defaults to
<code>vif.threshold = 10</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>vif.verbose</code></td>
<td>
<p>Logical for printing iteration results of backward variable selection using
the VIF. Defaults to <code>vif.verbose = FALSE</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>aic</code></td>
<td>
<p>Logical for performing variable selection using Akaike's Information Criterion (AIC).
Defaults to <code>aic = FALSE</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>aic.direction</code></td>
<td>
<p>Character string setting the direction of variable selection when using AIC,
with options <code>"both"</code> (default), <code>"forward"</code>, and <code>"backward"</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>aic.trace</code></td>
<td>
<p>Logical for printing iteration results of variable selection using the AIC.
Defaults to <code>aic.trace = FALSE</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>aic.steps</code></td>
<td>
<p>Integer value setting the maximum number of steps to be considered for variable
selection using the AIC. Defaults to <code>aic.steps = 5000</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>...</code></td>
<td>
<p>Further arguments passed to <code>MASS::stepAIC()</code>.</p>
</td>
</tr>
</table>
<h3>Details</h3>

<p><code>buildModelSeries()</code> was devised to deal with a list of linear model formulas. The
main objective is to bring together several functions commonly used when building linear models,
such as automated variable selection. In the current implementation, variable selection can be
done using <code>stepVIF()</code> or <code>MASS::stepAIC()</code> or both.
<code>stepVIF()</code> is a backward variable selection procedure, while <code>MASS::stepAIC()</code>
supports backward, forward, and bidirectional variable selection. For more information about
these functions, please visit their respective help pages.
</p>
<p>An important feature of <code>buildModelSeries()</code> is that it records the initial number
of candidate predictor variables and observations offered to the model, and adds this information
as an attribute to the final selected model. Such feature was included because variable selection
procedures result biased linear models (too optimistic), and the effective number of degrees of
freedom is close to the number of candidate predictor variables initially offered to the model
(Harrell, 2001). With the initial number of candidate predictor variables and observations
offered to the model, one can calculate penalized or adjusted measures of model performance. For
models built using <code>buildModelSeries()</code>, this can be done using
<code>statsModelSeries()</code>.
</p>
<p>Some important details should be clear when using <code>buildModelSeries()</code>:
</p>

<ul>
<li>
<p> this function was originally devised to deal with a list of formulas, but can also be used with
a single formula;
</p>
</li>
<li>
<p> in the current implementation, <code>stepVIF()</code> runs before <code>MASS::stepAIC()</code>;
</p>
</li>
<li>
<p> function arguments imported from <code>MASS::stepAIC()</code> and <code>stepVIF()</code> were named as
in the original functions, and received a prefix (<code>aic</code> or <code>vif</code>) to help the user identifying
which function is affected by a given argument without having to go check the documentation.
</p>
</li>
</ul>
<h3>Value</h3>

<p>A list containing the fitted linear models.
</p>


<h3>TODO</h3>

<p>Add option to set the order in which <code>MASS::stepAIC()</code> and <code>stepVIF()</code> are run.
</p>


<h3>Dependencies</h3>

<p>The <strong>MASS</strong> package, provider of support functions and datasets for Venables and Ripley's Modern
Applied Statistics with S, is required for <code>buildModelSeries()</code> to work. The
development version of the <strong>MASS</strong> package is available on
<a href="https://www.stats.ox.ac.uk/pub/MASS4/">https://www.stats.ox.ac.uk/pub/MASS4/</a> while its old versions are available on the CRAN archive
at <a href="https://cran.r-project.org/src/contrib/Archive/MASS/">https://cran.r-project.org/src/contrib/Archive/MASS/</a>.
</p>


<h3>Author(s)</h3>

<p>Alessandro Samuel-Rosa <a href="mailto:alessandrosamuelrosa@gmail.com">alessandrosamuelrosa@gmail.com</a>
</p>


<h3>References</h3>

<p>Harrell, F. E. (2001) <em>Regression modelling strategies: with applications to linear models,
logistic regression, and survival analysis.</em> First edition. New York: Springer.
</p>
<p>Venables, W. N. and Ripley, B. D. (2002) <em>Modern applied statistics with S.</em> Fourth edition.
New York: Springer.
</p>
<p>A. Samuel-Rosa, G. B. M. Heuvelink, G. de Mattos Vasques, and L. H. C. dos Anjos, Do more
detailed environmental covariates deliver more accurate soil maps?, <em>Geoderma</em>, vol. 243–244,
pp. 214–227, May 2015, doi: 10.1016/j.geoderma.2014.12.017.
</p>


<h3>See Also</h3>

<p><code>stepVIF()</code>, <code>statsMS()</code>
</p>


<h3>Examples</h3>

<pre><code class="language-R">if (interactive()) {
  # based on the second example of MASS::stepAIC()
  library("MASS")
  cpus1 &lt;- cpus
  for(v in names(cpus)[2:7])
    cpus1[[v]] &lt;- cut(cpus[[v]], unique(stats::quantile(cpus[[v]])),
                      include.lowest = TRUE)
  cpus0 &lt;- cpus1[, 2:8]  # excludes names, authors' predictions
  cpus.samp &lt;- sample(1:209, 100)
  cpus.form &lt;- list(formula(log10(perf) ~ syct + mmin + mmax + cach + chmin +
                    chmax + perf),
                    formula(log10(perf) ~ syct + mmin + cach + chmin + chmax),
                    formula(log10(perf) ~ mmax + cach + chmin + chmax + perf))
  data &lt;- cpus1[cpus.samp,2:8]
  cpus.ms &lt;- buildModelSeries(cpus.form, data, vif = TRUE, aic = TRUE)
}
</code></pre>


</div>