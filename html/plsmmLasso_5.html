<div class="container">

<table style="width: 100%;"><tr>
<td>plsmm_lasso</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>Fit a high-dimensional PLSMM</h2>

<h3>Description</h3>

<p>Fits a partial linear semiparametric mixed effects model (PLSMM) via penalized maximum likelihood.
</p>


<h3>Usage</h3>

<pre><code class="language-R">plsmm_lasso(
  x,
  y,
  series,
  t,
  name_group_var = NULL,
  bases,
  gamma,
  lambda,
  timexgroup,
  criterion,
  nonpara = FALSE,
  cvg_tol = 0.001,
  max_iter = 100,
  verbose = FALSE
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>x</code></td>
<td>
<p>A matrix of predictor variables.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>y</code></td>
<td>
<p>A continuous vector of response variable.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>series</code></td>
<td>
<p>A variable representing different series or groups in the data modeled as a random intercept.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>t</code></td>
<td>
<p>A numeric vector indicating the timepoints.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>name_group_var</code></td>
<td>
<p>A character string specifying the name of the grouping variable in the <code>x</code> matrix.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>bases</code></td>
<td>
<p>A matrix of bases functions.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>gamma</code></td>
<td>
<p>The regularization parameter for the nonlinear effect of time.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>lambda</code></td>
<td>
<p>The regularization parameter for the fixed effects.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>timexgroup</code></td>
<td>
<p>Logical indicating whether to use a time-by-group interaction.
If <code>TRUE</code>, each group in <code>name_group_var</code> will have its own estimate of the time effect.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>criterion</code></td>
<td>
<p>The information criterion to be computed. Options are "BIC", "BICC", or "EBIC".</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>nonpara</code></td>
<td>
<p>Logical. If TRUE, the <code>criterion</code> is computed using both the coefficients of the fixed-effects and the coefficients of the nonlinear function. If FALSE, only the coefficients of the fixed-effects are used.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>cvg_tol</code></td>
<td>
<p>Convergence tolerance for the algorithm.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>max_iter</code></td>
<td>
<p>Maximum number of iterations allowed for convergence.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>verbose</code></td>
<td>
<p>Logical indicating whether to print convergence details at each iteration. Default is <code>FALSE</code>.</p>
</td>
</tr>
</table>
<h3>Details</h3>

<p>This function fits a PLSMM with a lasso penalty on the fixed effects
and the coefficient associated with the bases functions. It uses the Expectation-Maximization (EM) algorithm
for estimation. The bases functions represent a nonlinear effect of time.
</p>
<p>The model includes a random intercept for each level of the variable specified by <code>series</code>. Additionally, if <code>timexgroup</code> is
set to <code>TRUE</code>, the model includes a time-by-group interaction, allowing each group of <code>name_group_var</code> to have its own estimate
of the nonlinear function, which can capture group-specific nonlinearities over time. If <code>name_group_var</code> is set to <code>NULL</code> only
one nonlinear function for the whole data is being used
</p>
<p>The algorithm iteratively updates the estimates until convergence or until the maximum number of iterations is reached.
</p>


<h3>Value</h3>

<p>A list containing the following components:
</p>
<table>
<tr style="vertical-align: top;">
<td><code>lasso_output</code></td>
<td>
<p>A list with the fitted values for the fixed effect and nonlinear effect. The estimated coeffcients for the fixed effects and nonlinear effect. The indices of the used bases functions.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>se</code></td>
<td>
<p>Estimated standard deviation of the residuals.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>su</code></td>
<td>
<p>Estimated standard deviation of the random intercept.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>out_phi</code></td>
<td>
<p>Data frame containing the estimated individual random intercept.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>ni</code></td>
<td>
<p>Number of timepoitns per observations.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>hyperparameters</code></td>
<td>
<p>Data frame with lambda and gamma values.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>converged</code></td>
<td>
<p>Logical indicating if the algorithm converged.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>crit</code></td>
<td>
<p>Value of the selected information criterion.</p>
</td>
</tr>
</table>
<h3>Examples</h3>

<pre><code class="language-R">
set.seed(123)
data_sim &lt;- simulate_group_inter(
  N = 50, n_mvnorm = 3, grouped = TRUE,
  timepoints = 3:5, nonpara_inter = TRUE,
  sample_from = seq(0, 52, 13), 
  cos = FALSE, A_vec = c(1, 1.5)
)
sim &lt;- data_sim$sim
x &lt;- as.matrix(sim[, -1:-3])
y &lt;- sim$y
series &lt;- sim$series
t &lt;- sim$t
bases &lt;- create_bases(t)
lambda &lt;- 0.0046
gamma &lt;- 0.00000001
plsmm_output &lt;- plsmm_lasso(x, y, series, t,
  name_group_var = "group", bases$bases,
  gamma = gamma, lambda = lambda, timexgroup = TRUE,
  criterion = "BIC"
)
# fixed effect coefficients
plsmm_output$lasso_output$theta

# fixed effect fitted values
plsmm_output$lasso_output$x_fit

# nonlinear functions coefficients
plsmm_output$lasso_output$alpha

# nonlinear functions fitted values
plsmm_output$lasso_output$out_f

# standard deviation of residuals
plsmm_output$se

# standard deviation of random intercept
plsmm_output$su

# series specific random intercept
plsmm_output$out_phi
</code></pre>


</div>