<div class="container">

<table style="width: 100%;"><tr>
<td>expected.pd</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2> Expected PD, PD Variance, and Edge Abundance Distribution of a phylogeny </h2>

<h3>Description</h3>

<p> Calculates the expected phylogenetic diversity (Faith's PD) and variance of PD under binomial sampling with a fixed probability of each tip being sampled, and the Edge-length Abundance Distribution of a phylogeny. </p>


<h3>Usage</h3>

<pre><code class="language-R">expected.pd(phy)
variance.pd(phy, upper.bound=TRUE)
ead(phy)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>phy</code></td>
<td>
<p> phylo object </p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>upper.bound</code></td>
<td>
<p> Calculate upper bound of PD variance? (default = TRUE) </p>
</td>
</tr>
</table>
<h3>Details</h3>

<p>The function <code>expected.pd</code> calculates the expected phylogenetic diversity (Faith's PD - total branch length) for all subsets of a phylogeny, based on an analytic solution for expected PD.
</p>
<p>The function <code>variance.pd</code> additionally calculates the variance of expected PD for all subsets of a phylogeny, based on an analytic solution for expected PD. If argument upper.bound=TRUE, a fast solution for the upper bound of the variance is returned. Otherwise, the exact solution for the variance is returned. Note that the exact solution is much slower than the upper bound solution.
</p>
<p>The function <code>ead</code> calculates the edge abundance distribution (EAD), the length of edges with different numbers of descendant tips.
</p>


<h3>Value</h3>

<table>
<tr style="vertical-align: top;">
<td><code>n</code></td>
<td>
<p> Expected Number of tips sampled </p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>expected.pd</code></td>
<td>
<p> Expected PD for a given n </p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>variance.pd</code></td>
<td>
<p> Variance of PD for a given n </p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>num.children</code></td>
<td>
<p> Number of tips descended from an edge </p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>edge.length</code></td>
<td>
<p> Total phylogenetic edge length for a given number of tips descended from an edge </p>
</td>
</tr>
</table>
<h3>Author(s)</h3>

<p> Steven Kembel &lt;steve.kembel@gmail.com&gt; and James O'Dwyer &lt;jodwyer@santafe.edu&gt; </p>


<h3>References</h3>

<p> J.P. O'Dwyer, S.W. Kembel, and J.L. Green. 2012. Phylogenetic Diversity Theory Sheds Light on the Structure of Microbial Communities. PLoS Comput Biol 8(12): e1002832. </p>


<h3>See Also</h3>

 <p><code>pd</code> </p>


<h3>Examples</h3>

<pre><code class="language-R">randtree &lt;- rcoal(300)
randtree.pd.ub &lt;- variance.pd(randtree, upper.bound=TRUE)
randtree.pd.exact &lt;- variance.pd(randtree, upper.bound=FALSE)
plot(expected.pd(randtree), xlab="Number of tips",
    ylab="Phylogenetic diversity (PD)", type="l", log="xy")
lines(randtree.pd.exact$expected.pd+1.96*sqrt(randtree.pd.exact$variance.pd), lty=2)
lines(randtree.pd.exact$expected.pd-1.96*sqrt(randtree.pd.exact$variance.pd), lty=2)
lines(randtree.pd.ub$expected.pd+1.96*sqrt(randtree.pd.ub$variance.pd), lty=3)
lines(randtree.pd.ub$expected.pd-1.96*sqrt(randtree.pd.ub$variance.pd), lty=3)
legend("bottomright", lty=c(1,2,3), legend=c("Expected PD",
    "95 percent CI (exact)","95 percent CI (upper bound)"))
</code></pre>


</div>