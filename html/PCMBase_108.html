<div class="container">

<table style="width: 100%;"><tr>
<td>PCMSim</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>Simulation of a phylogenetic comparative model on a tree</h2>

<h3>Description</h3>

<p>Generate trait data on a tree according to a multivariate stochastic
model with one or several regimes
</p>


<h3>Usage</h3>

<pre><code class="language-R">PCMSim(
  tree,
  model,
  X0,
  SE = matrix(0, PCMNumTraits(model), PCMTreeNumTips(tree)),
  metaI = PCMInfo(X = NULL, tree = tree, model = model, SE = SE, verbose = verbose),
  verbose = FALSE
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>tree</code></td>
<td>
<p>a phylo object specifying a rooted tree.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>model</code></td>
<td>
<p>an S3 object specifying the model (see Details).</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>X0</code></td>
<td>
<p>a numeric vector of length k (the number of traits) specifying the
trait values at the root of the tree.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>SE</code></td>
<td>
<p>a k x N matrix specifying the standard error for each measurement in
X. Alternatively, a k x k x N cube specifying an upper triangular k x k
factor of the variance covariance matrix for the measurement error
for each node i=1, ..., N.
Default: <code>matrix(0.0, PCMNumTraits(model), PCMTreeNumTips(tree))</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>metaI</code></td>
<td>
<p>a named list containing meta-information about the data and the
model.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>verbose</code></td>
<td>
<p>a logical indicating if informative messages should be written
during execution.</p>
</td>
</tr>
</table>
<h3>Details</h3>

<p>Internally, this function uses the <code>PCMCond</code> implementation
for the given model class.
</p>


<h3>Value</h3>

<p>numeric M x k matrix of values at all nodes of the tree, i.e. root,
internal and tip, where M is the number of nodes: <code>M=dim(tree$edge)[1]+1</code>,
with indices from 1 to N=length(tree$tip.label) corresponding to tips, N+1
corresponding to the root and bigger than N+1 corresponding to internal nodes.
The function will fail in case that the length of the argument vector X0 differs
from the number of traits specified in <code>metaI$k</code>. Error message:
"PCMSim:: X0 must be of length ...".
</p>


<h3>See Also</h3>

<p><code>PCMLik</code> <code>PCMInfo</code> <code>PCMCond</code>
</p>


<h3>Examples</h3>

<pre><code class="language-R">N &lt;- 10
L &lt;- 100.0
tr &lt;- ape::stree(N)
tr$edge.length &lt;- rep(L, N)
for(epoch in seq(1, L, by = 1.0)) {
  tr &lt;- PCMTreeInsertSingletonsAtEpoch(tr, epoch)
}

model &lt;- PCMBaseTestObjects$model_MixedGaussian_ab

PCMTreeSetPartRegimes(tr, c(`11` = 'a'), setPartition = TRUE)

set.seed(1, kind = "Mersenne-Twister", normal.kind = "Inversion")
X &lt;- PCMSim(tr, model, X0 = rep(0, 3))


</code></pre>


</div>