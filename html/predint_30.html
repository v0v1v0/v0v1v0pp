<div class="container">

<table style="width: 100%;"><tr>
<td>qp_pi</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>Simple uncalibrated prediction intervals for quasi-Poisson data</h2>

<h3>Description</h3>

<p><code>qp_pi()</code> is a helper function that is internally called by  <code>quasi_pois_pi()</code>. It
calculates simple uncalibrated prediction intervals for Poisson
data with constant overdispersion (quasi-Poisson assumption).
</p>


<h3>Usage</h3>

<pre><code class="language-R">qp_pi(
  newoffset,
  histoffset,
  lambda,
  phi,
  q = qnorm(1 - 0.05/2),
  alternative = "both",
  newdat = NULL,
  histdat = NULL,
  algorithm = NULL
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>newoffset</code></td>
<td>
<p>number of experimental units in the future clusters</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>histoffset</code></td>
<td>
<p>number of experimental units in the historical clusters</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>lambda</code></td>
<td>
<p>overall Poisson mean</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>phi</code></td>
<td>
<p>dispersion parameter</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>q</code></td>
<td>
<p>quantile used for interval calculation</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>alternative</code></td>
<td>
<p>either "both", "upper" or "lower"
<code>alternative</code> specifies, if a prediction interval or
an upper or a lower prediction limit should be computed</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>newdat</code></td>
<td>
<p>additional argument to specify the current data set</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>histdat</code></td>
<td>
<p>additional argument to specify the historical data set</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>algorithm</code></td>
<td>
<p>used to define the algorithm for calibration if called via
<code>quasi_pois_pi()</code>. This argument is not of interest for the calculation
of simple uncalibrated intervals</p>
</td>
</tr>
</table>
<h3>Details</h3>

<p>This function returns a simple uncalibrated prediction interval
</p>
<p style="text-align: center;"><code class="reqn">[l,u]_m = n^*_m \hat{\lambda} \pm q \sqrt{n^*_m \hat{\phi} \hat{\lambda} +
 \frac{n^{*2}_m \hat{\phi} \hat{\lambda}}{\sum_h n_h}}</code>
</p>

<p>with <code class="reqn">n^*_m</code> as the number of experimental units in the <code class="reqn">m=1, 2, ... , M</code> future clusters,
<code class="reqn">\hat{\lambda}</code> as the estimate for the Poisson mean obtained from the
historical data, <code class="reqn">\hat{\phi}</code> as the estimate for the dispersion parameter
and <code class="reqn">n_h</code> as the number of experimental units per historical cluster. <br></p>
<p>The direct application of this uncalibrated prediction interval to real life data
is not recommended. Please use the <code>quasi_pois_pi_pi()</code> functions for real life applications.
</p>


<h3>Value</h3>

<p><code>qp_pi</code> returns an object of class <code>c("predint", "quasiPoissonPI")</code>.
</p>


<h3>Examples</h3>

<pre><code class="language-R"># Prediction interval
qp_pred &lt;- qp_pi(newoffset=3, lambda=3, phi=3, histoffset=1:9, q=qnorm(1-0.05/2))
summary(qp_pred)

</code></pre>


</div>