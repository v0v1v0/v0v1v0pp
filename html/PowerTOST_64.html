<div class="container">

<table style="width: 100%;"><tr>
<td>sampleN.2TOST</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>
Sample size based on power of two TOSTs
</h2>

<h3>Description</h3>

<p>Estimates the necessary sample size to have at least a given power when two
parameters are tested simultaneously.
</p>


<h3>Usage</h3>

<pre><code class="language-R">sampleN.2TOST(alpha = c(0.05, 0.05), targetpower = 0.8, logscale = TRUE, 
              theta0, theta1, theta2, CV, rho, design = "2x2", setseed = TRUE,
              robust = FALSE, print = TRUE, details = FALSE, imax = 100,
              nsims = 1e+05)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>alpha</code></td>
<td>

<p>Vector; contains one-sided significance level for each of the two TOSTs.<br>
For one TOST, by convention mostly set to 0.05.
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>targetpower</code></td>
<td>

<p>Power to achieve at least. Must be &gt;0 and &lt;1.<br>
Typical values are 0.8 or 0.9.
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>logscale</code></td>
<td>

<p>Should the data used on log-transformed or on original scale? <code style="white-space: pre;">⁠TRUE⁠</code> (default) or <code style="white-space: pre;">⁠FALSE⁠</code>.
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>theta0</code></td>
<td>

<p>Vector; contains ‘true’ assumed T/R ratio for each of the two TOSTs.<br>
In case of <code>logscale=TRUE</code> each element must be given as ratio,<br>
otherwise as difference to 1. See examples.<br>
Defaults to <code>c(0.95, 0.95)</code> if <code>logscale=TRUE</code> or to 
<code>c(0.05, 0.05)</code> if <code>logscale=FALSE</code>.
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>theta1</code></td>
<td>

<p>Vector; contains lower bioequivalence limit for each of the two TOSTs.<br>
In case of <code>logscale=TRUE</code> it is given as ratio, otherwise as diff. to 1.<br>
Defaults to <code>c(0.8, 0.8)</code> if <code>logscale=TRUE</code> or to <code>c(-0.2, -0.2)</code>
if <code>logscale=FALSE</code>.
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>theta2</code></td>
<td>

<p>Vector; contains upper bioequivalence limit for each of the two TOSTs.<br>
If not given <code style="white-space: pre;">⁠theta2⁠</code> will be calculated as <code>1/theta1</code> if <code>logscale=TRUE</code><br>
or as <code style="white-space: pre;">⁠-theta1⁠</code> if <code>logscale=FALSE</code>.
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>CV</code></td>
<td>

<p>Vector of coefficient of variations (given as as ratio, <em>e.g.</em>, 0.2 for 20%).<br>
In case of cross-over studies this is the within-subject CV, <br>
in case of a parallel-group design the CV of the total variability.<br>
In case of <code>logscale=FALSE</code> CV is assumed to be the respective standard 
deviation.
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>rho</code></td>
<td>

<p>Correlation between the two PK metrics (<em>e.g.</em>, AUC and Cmax) under consideration.
This is defined as correlation between the estimator of the treatment difference of
PK metric one and the estimator of the treatment difference of PK metric two. Has to be within {–1, +1}.
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>design</code></td>
<td>

<p>Character string describing the study design.<br>
See <code>known.designs()</code> for designs covered in this package.
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>setseed</code></td>
<td>

<p>Logical; if <code style="white-space: pre;">⁠TRUE⁠</code>, the default, a seed of 1234567 is set.
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>robust</code></td>
<td>

<p>Defaults to <code style="white-space: pre;">⁠FALSE⁠</code>. With that value the usual degrees of freedom will be used.<br>
Set to <code style="white-space: pre;">⁠TRUE⁠</code> will use the degrees of freedom according to the ‘robust’ evaluation
(aka Senn’s basic estimator). These degrees of freedom are calculated as <code>n-seq</code>.<br>
See <code>known.designs()$df2</code> for designs covered in this package.<br>
Has only effect for higher-order crossover designs.
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>print</code></td>
<td>

<p>If <code>TRUE</code> (default) the function prints its results.<br> 
If <code>FALSE</code> only the result list will be returned. 
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>details</code></td>
<td>

<p>If <code>TRUE</code> the design characteristics and the steps during
sample size calculations will be shown.<br> 
Defaults to <code>FALSE</code>.
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>imax</code></td>
<td>

<p>Maximum number of steps in sample size search. <br> 
Defaults to 100.
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>nsims</code></td>
<td>

<p>Number of studies to simulate. Defaults to 100,000 = 1E5.
</p>
</td>
</tr>
</table>
<h3>Details</h3>

<p>The sample size is estimated via iterative evaluation of power of the two TOSTs.<br>
Start value for the sample size search is taken from a large sample approximation
(one TOST) according to Zhang, modified.<br>
The sample size is bound to 4 as minimum.<br><br>
The estimated sample size gives always the <em>total</em> number of subjects (not subject/sequence in crossovers or subjects/group in parallel designs – like in some other software packages).
</p>


<h3>Value</h3>

<p>A list with the input and results will be returned.<br>
The element name <code>"Sample size"</code> contains the total sample size.
</p>


<h3>Warning</h3>

<p>The function does not vectorize properly.<br>
If you need sample sizes with varying CVs, use f.i. for-loops or the apply-family.
</p>


<h3>Note</h3>

<p>If both <code>theta0</code> are near the acceptance limits then the starting value may not
be a good approximation resulting in a lot of iteration steps; <code>imax</code> may need
to be increased to obtain the required sample size.<br><br></p>


<h3>Author(s)</h3>

<p>B. Lang, D. Labes
</p>


<h3>References</h3>

<p>Phillips KF. <em>Power for Testing Multiple Instances of the Two One-Sided Tests Procedure.</em> Int J Biostat. 2009;5(1):Article 15.
</p>
<p>Hua SY, Xu S, D’Agostino RB Sr. <em>Multiplicity adjustments in testing for bioequivalence.</em> Stat Med. 2015;34(2):215–31. <a href="https://doi.org/10.1002/sim.6247">doi:10.1002/sim.6247</a>
</p>
<p>Lang B, Fleischer F. <em>Letter to the Editor: Comments on ‘Multiplicity adjustments in testing for bioequivalence’.</em> Stat Med. 2016;35(14):2479–80. <a href="https://doi.org/10.1002/sim.6488">doi:10.1002/sim.6488</a>
</p>
<p>Zhang P. <em>A Simple Formula for Sample Size Calculation in Equivalence Studies.</em> J Biopharm Stat. 2003;13(3):529–538. <a href="https://doi.org/10.1081/BIP-120022772">doi:10.1081/BIP-120022772</a>
</p>


<h3>See Also</h3>

<p><code>power.2TOST, known.designs</code>
</p>


<h3>Examples</h3>

<pre><code class="language-R"># Sample size for 2x2x2 cross-over design, intra-subject CV = 30% and assumed
# ratios of 0.95 for both parameters, and correlation 0.9 between parameters
# (using all the other default values)
# Should give n=44 with power=0.80879
sampleN.2TOST(theta0 = rep(0.95, 2), CV = rep(0.3, 2), rho = 0.9)

# Sample size for a parallel group design,
# evaluation on the original (untransformed) scale
# BE limits 80 ... 120% = -20% ... +20% of reference,
# assumed true BE ratio 0.95% = -5% to reference mean for both parameters,
# total CV=20% for both parameters, and correlation 0.9 between parameters
# should give n=52 with power=0.80094
sampleN.2TOST(logscale=FALSE, theta0 = rep(-0.05, 2), CV = c(0.2, 0.2), 
              rho = 0.9, design = "parallel")
</code></pre>


</div>