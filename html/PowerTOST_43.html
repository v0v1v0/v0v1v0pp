<div class="container">

<table style="width: 100%;"><tr>
<td>power.2TOST</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>
Power for two simultaneous TOST procedures
</h2>

<h3>Description</h3>

<p>Calculates the exact power of two simultaneous TOST procedures (where
the two parameters of the two TOSTs are correlated with some correlation)
for various study designs used in BE studies 
</p>


<h3>Usage</h3>

<pre><code class="language-R">power.2TOST(alpha = c(0.05, 0.05), logscale = TRUE, theta0, theta1, theta2,  
            CV, n, rho, design = "2x2", robust = FALSE, nsims, setseed = TRUE,
            details = FALSE)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>alpha</code></td>
<td>

<p>Vector; contains one-sided significance level for each of the two TOSTs.<br>
For one TOST, by convention mostly set to 0.05.
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>logscale</code></td>
<td>

<p>Should the data used on log-transformed (<code>TRUE</code>, default) or on original
scale (<code>FALSE</code>)?
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>theta1</code></td>
<td>

<p>Vector; contains lower bioequivalence limit for each of the two TOSTs.<br>
In case of <code>logscale=TRUE</code> it is given as ratio, otherwise as diff. to 1.<br>
Defaults to <code>c(0.8, 0.8)</code> if <code>logscale=TRUE</code> or to <code>c(-0.2, -0.2)</code>
if <code>logscale=FALSE</code>.
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>theta2</code></td>
<td>

<p>Vector; contains upper bioequivalence limit for each of the two TOSTS.<br>
If not given theta2 will be calculated as <code>1/theta1</code> if <code>logscale=TRUE</code><br>
or as <code>-theta1</code> if <code>logscale=FALSE</code>.
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>theta0</code></td>
<td>

<p>Vector; contains ‘true’ assumed bioequivalence ratio for each of the two TOSTs.<br>
In case of <code>logscale=TRUE</code> each element must be given as ratio,<br>
otherwise as difference to 1. See examples.<br>
Defaults to <code>c(0.95, 0.95)</code> if <code>logscale=TRUE</code> or to 
<code>c(0.05, 0.05)</code> if <code>logscale=FALSE</code>.
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>CV</code></td>
<td>

<p>Vector of coefficient of variations (given as as ratio, <em>e.g.</em>, 0.2 for 20%).<br>
In case of cross-over studies this is the within-subject CV,<br>
in case of a parallel-group design the CV of the total variability.<br>
In case of <code>logscale=FALSE</code> CV is assumed to be the respective standard 
deviation.
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>n</code></td>
<td>

<p>Number of subjects under study.<br>
Is total number if given as scalar, else number of subjects in the (sequence) 
groups. In the latter case the length of <code>n</code> vector has to be equal to the 
number of (sequence) groups.
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>rho</code></td>
<td>

<p>Correlation between the two PK metrics (<em>e.g.</em>, AUC and Cmax) under consideration.
This is defined as correlation between the estimator of the treatment difference of
PK metric one and the estimator of the treatment difference of PK metric two. Has to be within {–1, +1}.
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>design</code></td>
<td>

<p>Character string describing the study design.<br>
See <code>known.designs()</code> for designs covered in this package.
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>robust</code></td>
<td>

<p>Defaults to <code>FALSE</code>. With that value the usual degrees of freedom will be used.<br>
Setting to <code>TRUE</code> will use the degrees of freedom according to the ‘robust’ 
evaluation (aka Senn’s basic estimator). These degrees of freedom are calculated as <code>n-seq</code>.<br>
See <code>known.designs()$df2</code> for designs covered in this package.<br>
Has only effect for higher-order crossover designs.
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>nsims</code></td>
<td>

<p>Number of studies to simulate. Defaults to 1E5.
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>setseed</code></td>
<td>

<p>Logical; if <code>TRUE</code>, the default, a seed of 1234567 is set.
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>details</code></td>
<td>

<p>Logical; if <code>TRUE</code>, run time will be printed. Defaults to <code>FALSE</code>.
</p>
</td>
</tr>
</table>
<h3>Details</h3>

<p>Calculations are based on simulations and follow the distributional
properties as described in Phillips. This is in contrast to the calculations
via the 4-dimensional non-central <em>t</em>-distribution as described in Hua <em>et al.</em>
which was implemented in versions up to 1.4-6.<br><br>
The formulas cover balanced and unbalanced studies w.r.t (sequence) groups.<br><br>
In case of parallel group design and higher order crossover designs 
(replicate crossover or crossover with more than two treatments) the calculations 
are based on the assumption of equal variances for Test and Reference products
under consideration.<br><br>
The formulas for the paired means 'design' do not take an additional correlation
parameter into account. They are solely based on the paired <em>t</em>-test 
(TOST of differences = zero).
</p>


<h3>Value</h3>

<p>Value of power.
</p>


<h3>Note</h3>

<p>If <code style="white-space: pre;">⁠n⁠</code> is given as scalar (total sample size) and this number is not 
divisible by the number of (sequence) groups of the design an unbalanced design 
with small imbalance is assumed. A corresponding message is thrown showing the 
assumed numbers of subjects in (sequence) groups.<br>
The function does not vectorize properly if design is a vector. Moreover,
<code>theta0</code> and <code>CV</code> must be of length two, thus further vectorizing is not possible.<br>
Other vector input is not tested yet.<br><br></p>


<h3>Author(s)</h3>

<p>B. Lang, D. Labes<br></p>


<h3>References</h3>

<p>Phillips KF. <em>Power for Testing Multiple Instances of the Two One-Sided Tests Procedure.</em> Int J Biostat. 2009;5(1):Article 15. 
</p>
<p>Hua SY, Xu S, D’Agostino RB Sr. <em>Multiplicity adjustments in testing for bioequivalence.</em> Stat Med. 2015;34(2):215–31. <a href="https://doi.org/10.1002/sim.6247">doi:10.1002/sim.6247</a>
</p>
<p>Lang B, Fleischer F. <em>Letter to the Editor: Comments on ‘Multiplicity adjustments in testing for bioequivalence.’</em> Stat Med. 2016;35(14):2479–80. <a href="https://doi.org/10.1002/sim.6488">doi:10.1002/sim.6488</a>
</p>


<h3>See Also</h3>

<p><code>sampleN.2TOST, known.designs</code>
</p>


<h3>Examples</h3>

<pre><code class="language-R"># Power for the 2x2x2 cross-over design with 24 subjects, intra-subject
# standard deviation of 0.3 (CV = 30.7%) and assumed ratios of 1.05 for both
# parameters, and correlation 0.75 between parameters (using all the other
# default values)
power.2TOST(theta0 = rep(1.05, 2), CV = rep(se2CV(0.3), 2),
            n = 24, rho = 0.75)
# should give: 0.38849

# Setting as before but use rho 1 and high number of simulations
# to reproduce result of power.TOST()
p1 &lt;- power.2TOST(theta0 = rep(1.05, 2), CV = rep(se2CV(0.3), 2),
                  n = 24, rho = 1, nsims=1E7)
p2 &lt;- power.TOST(theta0 = 1.05, CV = se2CV(0.3), n = 24)
all.equal(p1, p2, tolerance = 1e-04)
</code></pre>


</div>