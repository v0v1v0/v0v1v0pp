<div class="container">

<table style="width: 100%;"><tr>
<td>SamplingConv</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>Converting Sampling Estimates</h2>

<h3>Description</h3>

<p>Various functions for converting between estimates of sampling in the fossil
record.
</p>


<h3>Usage</h3>

<pre><code class="language-R">sProb2sRate(R, int.length = 1)

sRate2sProb(r, int.length = 1)

pqsRate2sProb(r, p, q, int.length = 1)

qsProb2Comp(R, q, p = NULL, mode = "budding", nrep = 10000)

qsRate2Comp(r, q)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>R</code></td>
<td>
<p>Per-interval probability of sampling a taxon at least once.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>int.length</code></td>
<td>
<p>Length of Time Intervals</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>r</code></td>
<td>
<p>Instantaneous rate of sampling (per taxon, per time-unit).</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>p</code></td>
<td>
<p>Instantaneous rate of speciation (lambda). If the underlying model assumed is
anagenetic (e.g. taxonomic change within a single lineage, 'phyletic evolution') 
with no branching of lineages, then <code>p</code> will be used as the rate of anagenetic differentiation.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>q</code></td>
<td>
<p>Instantaneous rate of extinction (mu)</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>mode</code></td>
<td>
<p>Mode of morphotaxon differentiation, based on definitions in Foote, 1996. Can be
pure cladogenetic budding (<code>"budding"</code>), 
pure cladogenetic bifurcating (<code>"bifurcating"</code>) or
pure anagenetic within-lineage change 
(<code>"anagenesis"</code>; i.e. Foote's 'phyletic change'). 
Default mode is "budding".</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>nrep</code></td>
<td>
<p>Number of repetitions to run in functions which are meant to sum over infinity.
Default is arbitrarily high.</p>
</td>
</tr>
</table>
<h3>Details</h3>

<p>This is a family of functions which all convert from some estimate of
sampling to another estimate of sampling. Some of these also require
estimates of an rate associated with taxonomic diversification, such as the
speciation (or origination) rate or extinction rate. Diversification rates used
in these functions should always be the instantaneous rates, often called
the per-capita rates by paleontologists (Foote, 2000).
</p>
<p>As with many models used in the <code>paleotree</code> library, it is generally assumed
by these functions that the fossil record of interest is composed of
discrete relatively-static taxonomic units which diversify 
typically by budding cladogenesis, and that
sampling events are rare and approximated by a Poisson model of
exponentially-distributed waiting times between sampling events. The
veracity of those assumptions is difficult to test and the sensitivity of
these analyses to relaxing those assumptions probably varies.
</p>
<p><code>sProb2sRate</code> and <code>sRate2sProb</code> give rough conversions for the probability of
sampling once per time interval 
(the variable <code>R</code> or <code>sProb</code> in this package as used in the
references below) and the instantaneous rate of sampling per lineage/time
unit (<code>sRate</code> or <code>r</code>). If you have estimates of the speciation and extinction
rate, use <code>pqsRate2sProb</code> instead for a more accurate estimate of R.
</p>
<p><code>qsProb2Comp</code> and <code>qsRate2Comp</code> are different calculations for the
probability/proportion of taxa sampled in a clade (often labeled as the variable <code>Pp</code>).
Theoretically, one could use it to extrapolate out the 'true' diversity, assuming the sampling rate
model was correct. (See Foote and Raup, 1996.)
</p>
<p>See the references below for a more detailed explanation of the methods and
formulae used. The relevant equations are generally found in the appendices
of those papers.
</p>


<h3>Value</h3>

<p>The converted sampling estimate, depending on the function used. See
details above.
</p>


<h3>Author(s)</h3>

<p>David W. Bapst, with advice from Michael Foote.
</p>


<h3>References</h3>

<p>Foote, M. 1996 On the Probability of Ancestors in the Fossil
Record. <em>Paleobiology</em> <b>22</b>(2):141–151.
</p>
<p>Foote, M. 1997 Estimating Taxonomic Durations and Preservation Probability.
<em>Paleobiology</em> <b>23</b>(3):278–300.
</p>
<p>Foote, M. 2000 Origination and extinction components of taxonomic diversity:
general problems. Pp. 74–102. In D. H. Erwin, and S. L. Wing, eds. Deep
Time: Paleobiology's Perspective. The Paleontological Society, Lawrence,
Kansas.
</p>
<p>Foote, M., and D. M. Raup. 1996 Fossil preservation and the stratigraphic
ranges of taxa. <em>Paleobiology</em> <b>22</b>(2):121–140.
</p>
<p>Solow, A. R., and W. Smith. 1997 On Fossil Preservation and the
Stratigraphic Ranges of Taxa. <em>Paleobiology</em> <b>23</b>(3):271–277.
</p>


<h3>See Also</h3>

<p><code>sampleRanges</code>, <code>make_durationFreqDisc</code>, <code>make_durationFreqCont</code>,
<code>probAnc</code>, <code>pqr2Ps</code>.
</p>


<h3>Examples</h3>

<pre><code class="language-R">
sRate2sProb(r = 0.5)
sProb2sRate(R = 0.1)
pqsRate2sProb(r = 0.5,p = 0.1,q = 0.1)

# different modes can be tried
qsProb2Comp(R = 0.1,q = 0.1,mode = "budding")
qsProb2Comp(R = 0.1,q = 0.1,mode = "bifurcating")

qsRate2Comp(r = 0.1,q = 0.1)
</code></pre>


</div>