<div class="container">

<table style="width: 100%;"><tr>
<td>glm.lambda</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2> mafc Probit Fit to Psychometric Function Profiled on Upper Asymptote </h2>

<h3>Description</h3>

<p>A wrapper for <code>glm</code> in which the deviance for the model with binomial family and link <code>probit.lambda</code> is profiled as a function of <code>lambda</code>, the upper asymptote of the psychometric function.  
</p>


<h3>Usage</h3>

<pre><code class="language-R">glm.lambda(formula, data, NumAlt = 2, lambda = seq(0, 0.1, len = 40), 
	plot.it = FALSE, ...)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>formula</code></td>
<td>
<p>a symbolic description of the model to be fit </p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>data</code></td>
<td>
<p> an optional data frame, list or environment (or object coercible by <code>as.data.frame</code> to a data frame) containing the variables in the model. If not found in data, the variables are taken from <code>environment(formula)</code>, typically the environment from which <code>glm</code> is called. </p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>NumAlt</code></td>
<td>
<p> the number of alternatives, <code>m</code> in the mafc experiment from which the data arise </p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>lambda</code></td>
<td>
<p> a sequence of values to profile for the upper asymptote of the psychometric function </p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>plot.it</code></td>
<td>
<p> logical indicating whether to plot the profile of the deviances as a function of <code>lambda</code></p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>...</code></td>
<td>
<p> further arguments passed to <code>glm</code></p>
</td>
</tr>
</table>
<h3>Details</h3>

<p>The psychometric function fit to the data is described by
</p>
<p style="text-align: center;"><code class="reqn">P(x) = 1/m + (1 -  1/m - \lambda) \Phi(x)</code>
</p>
<p> where <code class="reqn">m</code> is the number of alternatives and the lower asymptote, <code class="reqn">1 - \lambda</code> is the upper asymptote and <code class="reqn">\Phi</code> is the cumulative normal function.
</p>


<h3>Value</h3>

<p>returns an object of class ‘lambda’ which inherits from classes ‘glm’ and ‘lm’.  It only differs from an object of class ‘glm’ in including two additional components, <code>lambda</code>, giving the estimated minimum of the profile by fitting a quadratic to the profile and a data frame containing the profiled deviance values for each value of <code>lambda</code> tested.  The degrees of freedom are reduced by 1 to take into account the estimation of <code>lambda</code>.
</p>


<h3>Note</h3>

<p> If the minimum occurs outside the interval examined, an error might occur.  In any case, re-running the function with a new range of <code>lambda</code> that includes the minimum should work.  if the plotted profile indicates that the fitted quadratic does not describe well the profile at the minimum, refitting with a more restricted range of <code>lambda</code> is recommended.
</p>


<h3>Author(s)</h3>

<p> Ken Knoblauch</p>


<h3>References</h3>

<p> Wichmann, F. A. and Hill, N. J. (2001) The psychometric function: I.Fitting, sampling, and goodness of fit. Percept Psychophys., 63(8), 1293–1313.
</p>
<p>Yssaad-Fesselier, R. and Knoblauch, K. (2006) Modeling psychometric
functions in R. <em> Behav Res Methods.</em>,  <b>38(1)</b>, 28–41. (for examples
with <code>gnlr</code>).	
</p>


<h3>See Also</h3>

 <p><code>mafc</code>, <code>glm</code>, <code>probit.lambda</code>, <code>family</code></p>


<h3>Examples</h3>

<pre><code class="language-R">b &lt;- 3.5
g &lt;- 1/3
d &lt;- 0.025
a &lt;- 0.04
p &lt;- c(a, b, g, d)
num.tr &lt;- 160
cnt &lt;- 10^seq(-2, -1, length = 6) # contrast levels

#simulated Weibull-Quick observer responses
set.seed(12161952)
truep &lt;- g + (1 - g - d) * pweibull(cnt, b, a)
ny &lt;- rbinom(length(cnt), num.tr, truep)
nn &lt;- num.tr - ny
phat &lt;- ny/(ny + nn)
resp.mat &lt;- matrix(c(ny, nn), ncol = 2)

## First with upper asymptote at 1
dd.glm &lt;- glm(resp.mat ~ cnt, family = binomial(mafc.probit(3)))
summary(dd.glm)
dd.lam &lt;- glm.lambda(resp.mat ~ cnt, NumAlt = 3, lambda = seq(0, 0.03, 
	len = 100), plot.it = TRUE)
summary(dd.lam)
## can refine interval, but doesn't change result much
dd.lam2 &lt;- glm.lambda(resp.mat ~ cnt, NumAlt = 3, 
	lambda = seq(dd.lam$lambda/sqrt(2), dd.lam$lambda*sqrt(2), 
	len = 100), plot.it = TRUE)
summary(dd.lam2)
## Compare fits w/ and w/out lambda
anova(dd.glm, dd.lam2, test = "Chisq")

plot(cnt, phat, log = "x", cex = 1.5, ylim = c(0, 1))
pcnt &lt;- seq(0.01, 0.1, len = 100)
lines(pcnt, predict(dd.glm, data.frame(cnt = pcnt),
                    type = "response"), lwd = 2)
lines(pcnt, predict(dd.lam, data.frame(cnt = pcnt),
                    type = "response"), lwd = 2, lty = 2)

</code></pre>


</div>