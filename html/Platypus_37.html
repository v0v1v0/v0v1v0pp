<div class="container">

<table style="width: 100%;"><tr>
<td>VDJ_dynamics</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>Tracks a specific VDJ column across multiple samples/timepoints.</h2>

<h3>Description</h3>

<p>Track a VDJ column across multiple samples or timepoints. Tracking consists of creating a per sample/timepoint dataframe of unique values for the VDJ column and their respective counts inside that timepoints/repertoire. Also creates alluvial plots to show the temporal dynamics of the tracked elements.
</p>


<h3>Usage</h3>

<pre><code class="language-R">VDJ_dynamics(
  VDJ,
  columns.to.track,
  starting.point.repertoire,
  track.all.elements,
  track.only.common,
  max.elements.to.track,
  specific.elements.to.track,
  additional.grouping.column,
  max.additional.groups,
  specific.additional.groups,
  timepoints.column,
  proportions.level,
  output.format,
  ignore.legend
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>VDJ</code></td>
<td>
<p>VDJ or VDJ.GEX.matrix[[1]] object, as obtained from the VDJ_GEX_matrix function in Platypus.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>columns.to.track</code></td>
<td>
<p>string or list of strings - VDJ column with values to track (e.g., 'VDJ_cgene' will track the changes in isotype counts/proportions across multiple timepoints, defined by the timepoints.column). If two columns are provided and tracked, then a new values will be created by combining the values from each column.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>starting.point.repertoire</code></td>
<td>
<p>string or integer - the repertoire from which to start tracking (1 = will start at the first repertoire, 's3' will start at repertoire 's3').</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>track.all.elements</code></td>
<td>
<p>boolean - if T (and track.only.common=F), it will track all elements across all repertoires/timepoints.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>track.only.common</code></td>
<td>
<p>boolean - if T (and track.all.elements=F), it will only track the common elements across all repertoires/timepoints.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>max.elements.to.track</code></td>
<td>
<p>integer or NULL - the maximum number of elements to track (elements are first sorted by frequency/abundance). If NULL, it will track all elements.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>specific.elements.to.track</code></td>
<td>
<p>vector of strings or NULL - specific elements we want tracked. If NULL, all elements will be tracked.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>additional.grouping.column</code></td>
<td>
<p>string or 'none' - VDJ column for calculating the frequency/counts of elements on a per-group level. If output.format='plot', each unique group will have its own bar plot of timepoints/repertoires (x axis) and feature counts (y axis). If NULL, no additional grouping will be done.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>max.additional.groups</code></td>
<td>
<p>integer or NULL - the maximum number of additional groups to consider (groups are first ordered by their frequency = total number of cells in that group in the VDJ matrix). If NULL, all groups will be considered.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>specific.additional.groups</code></td>
<td>
<p>vector of strings or NULL - specific grouping factors we want to consider. If NULL, all grouping factors will be considered.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>timepoints.column</code></td>
<td>
<p>string - VDJ column with either timepoints or repertoires across which we want to track our elements (usually 'sample_id').</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>proportions.level</code></td>
<td>
<p>string - 'absolute.counts' for absolute counts, 'group' for per group proportions, 'repertoire' for per repertoire/timepoint proportions.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>output.format</code></td>
<td>
<p>string - 'plot' for alluvial barplots, 'df' for count/proportions dataframes of the tracked elements.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>ignore.legend</code></td>
<td>
<p>boolean - if T, the legend will not be included in the resulting ggplot object.</p>
</td>
</tr>
</table>
<h3>Value</h3>

<p>Either a count dataframe of the tracked elements across multiple timepoints/repertoires, or alluvial barplot.
</p>


<h3>Examples</h3>

<pre><code class="language-R">VDJ_dynamics(VDJ = Platypus::small_vgm[[1]],
columns.to.track='clonotype_id', starting.point.repertoire=1,
max.elements.to.track=10, timepoints.column='sample_id',
output.format='plot')

</code></pre>


</div>