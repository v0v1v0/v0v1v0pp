<div class="container">

<table style="width: 100%;"><tr>
<td>mapPLMIX</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>MAP estimation for a Bayesian mixture of Plackett-Luce models</h2>

<h3>Description</h3>

<p>Perform MAP estimation via EM algorithm for a Bayesian mixture of Plackett-Luce models fitted to partial orderings.
</p>


<h3>Usage</h3>

<pre><code class="language-R">mapPLMIX(pi_inv, K, G, init = list(p = NULL, omega = NULL),
  n_iter = 1000, hyper = list(shape0 = matrix(1, nrow = G, ncol = K),
  rate0 = rep(0, G), alpha0 = rep(1, G)), eps = 10^(-6),
  centered_start = FALSE, plot_objective = FALSE)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>pi_inv</code></td>
<td>
<p>An object of class <code>top_ordering</code>, collecting the numeric <code class="reqn">N</code><code class="reqn">\times</code><code class="reqn">K</code> data matrix of partial orderings, or an object that can be coerced with <code>as.top_ordering</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>K</code></td>
<td>
<p>Number of possible items.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>G</code></td>
<td>
<p>Number of mixture components.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>init</code></td>
<td>
<p>List of named objects with initialization values: <code>p</code> is a numeric <code class="reqn">G</code><code class="reqn">\times</code><code class="reqn">K</code> matrix of component-specific support parameters; <code>omega</code> is a numeric vector of <code class="reqn">G</code> mixture weights. If starting values are not supplied (<code>NULL</code>), they are randomly generated with a uniform distribution. Default is <code>NULL</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>n_iter</code></td>
<td>
<p>Maximum number of EM iterations.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>hyper</code></td>
<td>
<p>List of named objects with hyperparameter values for the conjugate prior specification: <code>shape0</code> is a numeric <code class="reqn">G</code><code class="reqn">\times</code><code class="reqn">K</code> matrix of shape hyperparameters; <code>rate0</code> is a numeric vector of <code class="reqn">G</code> rate hyperparameters; <code>alpha0</code> is a numeric vector of <code class="reqn">G</code> Dirichlet hyperparameters. Default is noninformative (flat) prior setting.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>eps</code></td>
<td>
<p>Tolerance value for the convergence criterion.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>centered_start</code></td>
<td>
<p>Logical: whether a random start whose support parameters and weights should be centered around the observed relative frequency that each item has been ranked top. Default is <code>FALSE</code>. Ignored when <code>init</code> is not <code>NULL</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>plot_objective</code></td>
<td>
<p>Logical: whether the objective function (that is the kernel of the log-posterior distribution) should be plotted. Default is <code>FALSE</code>.</p>
</td>
</tr>
</table>
<h3>Details</h3>

<p>Under noninformative (flat) prior setting, the EM algorithm for MAP estimation corresponds to the EMM algorithm described by Gormley and Murphy (2006) to perform frequentist inference. In this case, the MAP solution coincides with the MLE and the output vectors <code>log_lik</code> and <code>objective</code> coincide as well.
</p>
<p>The <code>mapPLMIX</code> function performs the MAP procedure with a single starting value. To address the issue of local maxima in the posterior distribution, see the <code>mapPLMIX_multistart</code> function.
</p>


<h3>Value</h3>

<p>A list of S3 class <code>mpPLMIX</code> with named elements:
</p>
<table>
<tr style="vertical-align: top;">
<td><code>W_map</code></td>
<td>
<p> Numeric vector with the MAP estimates of the <code class="reqn">G</code> mixture weights.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>P_map</code></td>
<td>
<p> Numeric <code class="reqn">G</code><code class="reqn">\times</code><code class="reqn">K</code> matrix with the MAP estimates of the component-specific support parameters.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>z_hat</code></td>
<td>
<p> Numeric <code class="reqn">N</code><code class="reqn">\times</code><code class="reqn">G</code> matrix of estimated posterior component membership probabilities.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>class_map</code></td>
<td>
<p> Numeric vector of <code class="reqn">N</code> mixture component memberships based on MAP allocation from the <code>z_hat</code> matrix.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>log_lik</code></td>
<td>
<p> Numeric vector of the log-likelihood values at each iteration.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>objective</code></td>
<td>
<p> Numeric vector of the objective function values (that is the kernel of the log-posterior distribution) at each iteration.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>max_objective</code></td>
<td>
<p> Maximized objective function value.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>bic</code></td>
<td>
<p> BIC value (only for the default flat priors, otherwise <code>NULL</code>).</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>conv</code></td>
<td>
<p> Binary convergence indicator: 1 = convergence has been achieved, 0 = otherwise.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>call</code></td>
<td>
<p> The matched call.</p>
</td>
</tr>
</table>
<h3>Author(s)</h3>

<p>Cristina Mollica and Luca Tardella
</p>


<h3>References</h3>

<p>Mollica, C. and Tardella, L. (2017). Bayesian Plackett-Luce mixture models for partially ranked data. <em>Psychometrika</em>, <b>82</b>(2), pages 442–458, ISSN: 0033-3123, DOI: 10.1007/s11336-016-9530-0.
</p>
<p>Gormley, I. C. and Murphy, T. B. (2006). Analysis of Irish third-level college applications data. <em>Journal of the Royal Statistical Society: Series A</em>, <b>169</b>(2), pages 361–379, ISSN: 0964-1998, DOI: 10.1111/j.1467-985X.2006.00412.x.
</p>


<h3>See Also</h3>

<p><code>mapPLMIX_multistart</code>
</p>


<h3>Examples</h3>

<pre><code class="language-R">
data(d_carconf)
MAP &lt;- mapPLMIX(pi_inv=d_carconf, K=ncol(d_carconf), G=3, n_iter=400*3)
str(MAP)
MAP$P_map
MAP$W_map

</code></pre>


</div>