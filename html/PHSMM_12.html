<div class="container">

<table style="width: 100%;"><tr>
<td>w2nHSMM</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>Parameter transformation from working to natural parameters</h2>

<h3>Description</h3>

<p>Transforms unconstraint HSMM working parameters back into (constraint) natural parameters. Not intended to be run by the user (internal function, called by the functions <code>pmleHSMM</code> and <code>npllHSMM</code>).
</p>


<h3>Usage</h3>

<pre><code class="language-R">w2nHSMM(N, parvect, R_vec, y_dist=c("norm","gamma","pois","bern"),
      stationary=TRUE, p_ref=2)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>N</code></td>
<td>
<p>number of states of the HSMM, integer greater than 1.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>parvect</code></td>
<td>
<p>vector of unconstraint working parameter as obtained by the function <code>n2wHSMM</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>R_vec</code></td>
<td>
<p>vector of length <code>N</code> containing the lengths of the unstructured starts of the dwell-time distributions.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>y_dist</code></td>
<td>
<p>character determining the class of state-dependent distributions used to model the observations. Supported values are <code>"norm"</code> (normal distribution), <code>"gamma"</code> (gamma distribution), <code>"pois"</code> (Poisson distribution) and <code>"bern"</code> (Bernoulli distribution).</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>stationary</code></td>
<td>
<p>Logical, if <code>TRUE</code> (default), stationarity is assumed, if <code>FALSE</code>, the underlying state-sequence is assumed to enter a new state at time t=1.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>p_ref</code></td>
<td>
<p>positive integer determining the reference dwell-time probability used for the multinomial logit parameter transformation. Default value is 2. Only needs to be changed if the dwell-time probability for dwell time r=2 is estimated very close to zero in order to avoid numerical problems.</p>
</td>
</tr>
</table>
<h3>Details</h3>

<p>The function reverses the transformation of the function <code>n2wHSMM</code> and back-transforms the unconstraint parameters into the constraint natural parameters. Note that if <code>y_dist="gamma"</code>, <code>mu</code> and <code>sigma</code> do not include the mean values and standard deviations, but the shape and rate parameters as required by the density functions <code>dgamma</code> and <code>pgamma</code>. The mean and standard deviations are then assigned to <code>mu2</code> and <code>sigma2</code>.
</p>


<h3>Value</h3>

<p>A list containing the natural parameters
</p>
<table>
<tr style="vertical-align: top;">
<td><code>p_list</code></td>
<td>
<p>list containing the dwell-time distribution vectors for each state. Each of the <code>N</code> vectors contains the state dwell-time probabilities for the unstructured start and, as last element, the probability mass captured in the geometric tail. Thus, each vector sums to one.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>mu</code></td>
<td>
<p>vector of length <code>N</code>. For <code>y_dist="norm"</code> and <code>y_dist="pois"</code>, it contains the state-dependent mean values, for <code>y_dist="gamma"</code>, it contains the state-dependent shape parameters, and for <code>y_dist="bern"</code>, it contains the state-dependent probabilities.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>sigma</code></td>
<td>
<p>vector of length <code>N</code> containing the state-dependent standard deviations if <code>y_dist="norm"</code> and the state-dependent rates if <code>y_dist="gamma"</code>. <code>NULL</code> otherwise.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>omega</code></td>
<td>
<p>conditional transition probability matrix of the HSMM.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>delta</code></td>
<td>
<p>equilibrium distribution if <code>stationary=TRUE</code>, initial distribution of length N if <code>stationary=FALSE</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>d_r</code></td>
<td>
<p>list containing the dwell-time probabilities of the unstructured starts.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>Gamma</code></td>
<td>
<p>transition probability matrix of the HMM which represents the HSMM.</p>
</td>
</tr>
</table>
<h3>Examples</h3>

<pre><code class="language-R"># natural parameters for 2-state HSMM with state-dependent normal distributions
p_list0&lt;-list() # list of dwell-time distribution vectors,
                # vector elements must sum to one
p_list0[[1]]&lt;-c(dgeom(0:9,0.2),1-pgeom(9,0.2))
p_list0[[2]]&lt;-c(dgeom(0:9,0.1),1-pgeom(9,0.1))
mu0&lt;-c(-10,10) # mean values
sigma0&lt;-c(3,5) # standard deviations
# parameter transformation:
parvect&lt;-n2wHSMM(N=2,p_list=p_list0,mu=mu0,sigma=sigma0,y_dist='norm',stationary=TRUE)
# back-transformation:
npar&lt;-w2nHSMM(N=2,parvect=parvect,R_vec=sapply(p_list0,length)-1,y_dist='norm')
</code></pre>


</div>