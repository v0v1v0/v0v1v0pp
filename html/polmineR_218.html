<div class="container">

<table style="width: 100%;"><tr>
<td>kwic-class</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>S4 kwic class</h2>

<h3>Description</h3>

<p>S4 class for organizing information for kwic/concordance output. A set of
standard generics (<code>show</code>, <code>as.character</code>, <code>as.data.frame</code>,
<code>length</code>, <code>sample</code>, <code>subset</code>) as well as indexing is implemented to process
kwic class objects (see 'Usage'). See section 'Details' for the
<code>enrich</code>, <code>view</code> and <code>knit_print</code> methods.
</p>


<h3>Usage</h3>

<pre><code class="language-R">## S4 method for signature 'kwic'
get_corpus(x)

## S4 method for signature 'kwic'
count(.Object, p_attribute = "word")

## S4 method for signature 'kwic'
as.DocumentTermMatrix(x, p_attribute, verbose = TRUE, ...)

## S4 method for signature 'kwic'
as.TermDocumentMatrix(x, p_attribute, verbose = TRUE, ...)

## S4 method for signature 'kwic'
show(object)

## S4 method for signature 'kwic'
knit_print(x, options = knitr::opts_chunk)

## S4 method for signature 'kwic'
as.character(x, fmt = "&lt;i&gt;%s&lt;/i&gt;")

## S4 method for signature 'kwic,ANY,ANY,ANY'
x[i]

## S4 method for signature 'kwic'
subset(x, ...)

## S4 method for signature 'kwic'
as.data.frame(x)

## S4 method for signature 'kwic'
length(x)

## S4 method for signature 'kwic'
sample(x, size)

## S4 method for signature 'kwic_bundle'
merge(x)

## S4 method for signature 'kwic'
enrich(.Object, s_attributes = NULL, extra = NULL, table = FALSE, ...)

## S4 method for signature 'kwic'
format(
  x,
  node_color = "blue",
  align = TRUE,
  extra_color = "grey",
  lineview = getOption("polmineR.lineview")
)

## S4 method for signature 'kwic'
view(.Object)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>x</code></td>
<td>
<p>A <code>kwic</code> class object.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>.Object</code></td>
<td>
<p>A <code>kwic</code> class object.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>p_attribute</code></td>
<td>
<p>A length-one <code>character</code> vector supplying a p-attribute.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>verbose</code></td>
<td>
<p>A <code>logical</code> value, whether to output debugging messages.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>...</code></td>
<td>
<p>Used for backwards compatibility.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>object</code></td>
<td>
<p>A <code>kwic</code> class object.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>options</code></td>
<td>
<p>Chunk options.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>fmt</code></td>
<td>
<p>A format string passed into <code>sprintf</code> to format the node of a
KWIC display.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>i</code></td>
<td>
<p>Single integer value, the kwic line for which the fulltext shall be
inspected.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>size</code></td>
<td>
<p>An <code>integer</code>, subset size for sampling.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>s_attributes</code></td>
<td>
<p>Character vector of s-attributes with metainformation.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>extra</code></td>
<td>
<p>An <code>integer</code> value, number of extra tokens to the left and
to the right of the windows of tokens to the left and right of a query
match that are decoded to be displayed in a kwic output to facilitate
interpretation.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>table</code></td>
<td>
<p>Logical, whether to turn cpos <code>data.table</code> into
<code>data.table</code> in slot <code>stat</code> for output.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>node_color</code></td>
<td>
<p>If not <code>NULL</code>, the html color of the node. If
supplied, the node will be wrapped in respective html tags.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>align</code></td>
<td>
<p>A <code>logical</code> value for preparing kwic output. If
<code>TRUE</code>, whether the content of the columns 'left', 'node' and 'right'
will be wrapped in html div elements that will align the output right,
centered and left, respectively.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>extra_color</code></td>
<td>
<p>If extra context has been generated using <code>enrich</code>,
the html color of the additional output (defaults to 'grey').</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>lineview</code></td>
<td>
<p>A <code>logical</code> value, whether to concatenate left context,
node and right context when preparing kwic output.</p>
</td>
</tr>
</table>
<h3>Details</h3>

<p>Applying the <code>count</code>-method on a <code>kwic</code> object will return
a <code>count</code> object with the evaluation of the left and right context of
the match.
</p>
<p>The <code>knit_print()</code> method will be called by knitr to render
<code>kwic</code> objects as a DataTable  <code>htmlwidget</code> when rendering a R
Markdown document as html. It will usually be necessary to explicitly state
"render = knit_print" in the chunk options. The option
<code>polmineR.pagelength</code> controls the number of lines displayed in the
resulting <code>htmlwidget</code>. Note that including htmlwidgets in html documents
requires that pandoc is installed. To avoid an error, a formatted
<code>data.table</code> is returned by <code>knit_print()</code> if pandoc is not
available.
</p>
<p>The <code>as.character</code>-method will return a list of <code>character</code> vectors,
concatenating the columns "left", "node" and "right" of the <code>data.table</code> in
the <code>stat</code>-slot of the input <code>kwic</code>-class object. Optionally, the node can
be formatted using a format string that is passed into <code>sprintf</code>.
</p>
<p>The <code>subset</code>-method will apply <code>subset</code> to the table in the slot
<code>stat</code>, e.g. for filtering query results based on metadata (i.e.
s-attributes) that need to be present.
</p>
<p>The <code>enrich</code> method is used to generate the actual output for
the kwic method. If param <code>table</code> is <code>TRUE</code>, corpus positions
will be turned into a <code>data.frame</code> with the concordance lines. If
param <code>s_attributes</code> is a character vector with s-attributes, the
respective s-attributes will be added as columns to the table with
concordance lines.
</p>
<p>The <code>format</code>-method will return a <code>data.table</code> that can
serve as input for rendering a <code>htmlwidget</code>, for instance using
<code>DT::datatable</code> or <code>rhandsontable::rhandsontable</code>. It will
include html tags, so ensure that the rendering engine does not obfuscate
the html.
</p>


<h3>Slots</h3>


<dl>
<dt><code>metadata</code></dt>
<dd>
<p>A <code>character</code> vector with s-attributes of the metadata
that are to be displayed.</p>
</dd>
<dt><code>p_attribute</code></dt>
<dd>
<p>The p-attribute for which the context has been generated.</p>
</dd>
<dt><code>left</code></dt>
<dd>
<p>An <code>integer</code> value, words to the left of the query match.</p>
</dd>
<dt><code>right</code></dt>
<dd>
<p>An <code>integer</code> value, words to the right of the query match.</p>
</dd>
<dt><code>corpus</code></dt>
<dd>
<p>Length-one <code>character</code> vector, the CWB corpus.</p>
</dd>
<dt><code>cpos</code></dt>
<dd>
<p>A <code>data.table</code> with the columns "match_id", "cpos", "position",
"word_id", "word" and "direction".</p>
</dd>
<dt><code>stat</code></dt>
<dd>
<p>A <code>data.table</code>, a table with columns "left", "node",
"right", and metadata, if the object has been enriched.</p>
</dd>
<dt><code>encoding</code></dt>
<dd>
<p>A length-one <code>character</code> vector with the encoding of the
corpus.</p>
</dd>
<dt><code>name</code></dt>
<dd>
<p>A length-one <code>character</code> vector naming the object.</p>
</dd>
<dt><code>annotation_cols</code></dt>
<dd>
<p>A <code>character</code> vector designating the columns of
the <code>data.table</code> in the slot <code>table</code> that are annotations.</p>
</dd>
</dl>
<h3>See Also</h3>

<p>The constructor for generating kwic objects is the
<code>kwic</code> method.
</p>


<h3>Examples</h3>

<pre><code class="language-R">use("polmineR")
K &lt;- kwic("GERMAPARLMINI", "Integration")
get_corpus(K)
length(K)
K_min &lt;- K[1]
K_min &lt;- K[1:5]

# using kwic_bundle class
queries &lt;- c("oil", "prices", "barrel")
li &lt;- lapply(queries, function(q) kwic("REUTERS", query = q))
kb &lt;- as.bundle(li)

# use count-method on kwic object
coi &lt;- kwic("REUTERS", query = "oil") %&gt;%
  count(p_attribute = "word")

# features vs cooccurrences-method (identical results)
ref &lt;- count("REUTERS", p_attribute = "word") %&gt;%
  subset(word != "oil")
slot(ref, "size") &lt;- slot(ref, "size") - count("REUTERS", "oil")[["count"]]
y_features &lt;- features(coi, ref, method = "ll", included = TRUE)
y_cooc &lt;- cooccurrences("REUTERS", query = "oil")

# extract node and left and right context as character vectors
oil &lt;- kwic("REUTERS", query = "oil")
as.character(oil, fmt = NULL)
as.character(oil) # node wrapped into &lt;i&gt; tag by default
as.character(oil, fmt = "&lt;b&gt;%s&lt;/b&gt;")

# subsetting kwic objects
oil &lt;- corpus("REUTERS") %&gt;%
  kwic(query = "oil") %&gt;%
  subset(grepl("prices", right))
saudi_arabia &lt;- corpus("REUTERS") %&gt;%
  kwic(query = "Arabia") %&gt;%
  subset(grepl("Saudi", left))
int_spd &lt;- corpus("GERMAPARLMINI") %&gt;%
  kwic(query = "Integration") %&gt;%
  enrich(s_attribute = "party") %&gt;%
  subset(grepl("SPD", party))

# turn kwic object into data.frame with html tags
int &lt;- corpus("GERMAPARLMINI") %&gt;%
  kwic(query = "Integration")

as.data.frame(int) # Without further metadata

enrich(int, s_attributes = c("date", "speaker", "party")) %&gt;%
  as.data.frame()
  
# merge bundle of kwic objects into one kwic
reuters &lt;- corpus("REUTERS")
queries &lt;- c('"Saudi" "Arabia"', "oil", '"barrel.*"')
comb &lt;- lapply(queries, function(qu) kwic(reuters, query = qu)) %&gt;%
  as.bundle() %&gt;%
  merge()
 
# enrich kwic object
i &lt;- corpus("GERMAPARLMINI") %&gt;%
  kwic(query = "Integration") %&gt;%
  enrich(s_attributes = c("date", "speaker", "party"))
</code></pre>


</div>