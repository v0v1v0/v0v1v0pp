<div class="container">

<table style="width: 100%;"><tr>
<td>power.TOST</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>
Power of the classical TOST procedure
</h2>

<h3>Description</h3>

<p>Calculates the exact or approximate power of the two-one-sided t-tests (TOST)
procedure for various study designs used in BE studies.
</p>


<h3>Usage</h3>

<pre><code class="language-R">power.TOST(alpha = 0.05, logscale = TRUE, theta1, theta2, theta0, CV, n, 
           design = "2x2", method="exact", robust=FALSE)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>alpha</code></td>
<td>

<p>Significance level (one-sided). Commonly set to 0.05.
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>logscale</code></td>
<td>

<p>Should the data used on log-transformed or on original scale? <code>TRUE</code> (default) or <code>FALSE</code>.
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>theta0</code></td>
<td>

<p>‘True’ or assumed T/R ratio or difference.<br>
In case of <code>logscale=TRUE</code> it must be given as ratio T/R.<br>
If <code>logscale=FALSE</code>, the difference in means. In this case, the difference may be expressed in two ways: relative to the same (underlying) reference mean, i.e. as (T-R)/R = T/R - 1; or as difference in means T-R. Note that in the former case the units of <code>CV</code>, <code>theta1</code> and <code>theta2</code> need also be given relative to the reference mean (specified as ratio).<br>
Defaults to 0.95 if <code>logscale=TRUE</code> or to 0.05 if <code>logscale=FALSE</code>
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>theta1</code></td>
<td>

<p>Lower (bio-)equivalence limit.<br>
In case of <code>logscale=TRUE</code> it is given as ratio.<br>
If <code>logscale=FALSE</code>, the limit may be expressed in two ways:
difference of means relative to the same (underlying) reference mean or in units of the difference of means.
Note that in the former case the units of <code>CV</code>, <code>theta0</code> and <code>theta2</code> need also be given relative to the reference mean (specified as ratio).<br>
Defaults to 0.8 if <code>logscale=TRUE</code> or to -0.2 if <code>logscale=FALSE</code>.
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>theta2</code></td>
<td>

<p>Upper (bio-)equivalence limit.<br>
In case of <code>logscale=TRUE</code> it is given as ratio.
If <code>logscale=FALSE</code>, the limit may be expressed in two ways:
difference of means relative to the same (underlying) reference mean or in units of the difference of means.
Note that in the former case the units of <code>CV</code>, <code>theta0</code> and <code>theta1</code> need also be given relative to the reference mean (specified as ratio).<br>
If not given, <code>theta2</code> will be calculated as <code>1/theta1</code> if <code>logscale=TRUE</code> or as <code>-theta1</code> if <code>logscale=FALSE</code>.
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>CV</code></td>
<td>

<p>In case of <code>logscale=TRUE</code> the (geometric) coefficient of variation given as ratio.<br>
If <code>logscale=FALSE</code> the argument refers to (residual) standard deviation of the response. In this case, standard deviation may be expressed two ways: relative to a reference mean (specified as ratio sigma/muR), i.e. again as a coefficient of variation; or untransformed, i.e. as standard deviation of the response. Note that in the former case the units of <code>theta0</code>, <code>theta1</code> and <code>theta2</code> need also be given relative to the reference mean (specified as ratio).<br></p>
<p>In case of cross-over studies this is the within-subject CV, in case of a parallel-group design the CV of the total variability.
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>n</code></td>
<td>

<p>Number of subjects under study.<br>
Is total number if given as scalar, else number of subjects in the (sequence) 
groups. In the latter case the length of <code>n</code> vector has to be equal to the 
number of (sequence) groups.
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>design</code></td>
<td>

<p>Character string describing the study design.<br>
See <code>known.designs()</code> for designs covered in this package.
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>method</code></td>
<td>

<p>Method for calculation of the power.<br>  
Defaults to <code>"exact"</code> in which case the calculation is done based on formulas 
with Owen’s Q. The calculation via Owen’s Q can also be choosen with 
<code>method="owenq"</code>.<br>
Another exact method via direct integration of the bivariate non-central 
<em>t</em>-distribution may be chosen with <code>method="mvt"</code>. This may have somewhat 
lower precision compared to Owen’s Q and longer run-time.<br>
Approximate calculations can be choosen via <code>method="noncentral"</code> or 
<code>method="nct"</code> for the approximation using the non-central <em>t</em>-distribution.
With <code>method="central"</code> or <code>method="shifted"</code> the relative crude
approximation via ‘shifted’ central <em>t</em>-distribution is chosen.<br>
The strings for <code>method</code> may be abbreviated.
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>robust</code></td>
<td>

<p>Defaults to <code>FALSE</code>. With that value the usual degrees of freedom will be used.<br>
Set to <code>TRUE</code> will use the degrees of freedom according to the ‘robust’ 
evaluation (aka Senn’s basic estimator). These degrees of freedom are calculated as <code>n-seq</code>.<br>
See <code>known.designs()$df2</code> for designs covered in this package.<br>
Has only effect for higher-order crossover designs.
</p>
</td>
</tr>
</table>
<h3>Details</h3>

<p>The exact calculations of power are based on Owen’s Q-function or by direct 
integration of the bivariate non-central <em>t</em>-distribution via function
<code>pmvt</code> of package <code>mvtnorm</code>.<br>
Approximate power is implemented via the non-central <em>t</em>-distribution
or the ‘shifted’ central <em>t</em>-distribution.<br><br>
The formulas cover balanced and unbalanced studies w.r.t (sequence) groups.<br><br>
In case of parallel group design and higher order crossover designs 
(replicate crossover or crossover with more than two treatments) the calculations 
are based on the assumption of equal variances for Test and Reference products
under consideration.<br><br>
The formulas for the paired means 'design' do not take a correlation parameter 
into account. They are solely based on the paired <em>t</em>-test (TOST of differences = zero).
</p>


<h3>Value</h3>

<p>Value of power according to the input arguments.
</p>


<h3>Note</h3>

<p>Of course it is highly recommended to use the default <code>method="exact"</code> :-).<br>
There is no reason beside testing and for comparative purposes to use an 
approximation if the exact method is available.<br><br>
If <code>n</code> is given as scalar (total sample size) and this number is not 
divisible by the number of (sequence) groups of the design an unbalanced design 
with small imbalance is assumed. A corresponding message is thrown showing the 
assumed numbers of subjects in (sequence) groups.<br>
The function does not vectorize properly if design is a vector.<br>
The function vectorizes properly if CV or theta0 are vectors.<br>
Other vector input is not tested yet.<br><br>
The former function <code>power2.TOST()</code> designd to handle unbalanced studies is 
defunct since <code>power.TOST()</code> handles balanced as well as unbalanced designs.
</p>


<h3>Author(s)</h3>

<p>D. Labes, direct integration of bivariate non-central <em>t</em>-distribution by B. Lang
</p>


<h3>References</h3>

<p>Phillips KF. <em>Power of the Two One-Sided Tests Procedure in Bioequivalence.</em> J Pharmacokin Biopharm. 1990;18(2):137–44. <a href="https://doi.org/10.1007/BF01063556">doi:10.1007/BF01063556</a>
</p>
<p>Diletti D, Hauschke D, Steinijans VW. <em>Sample Size Determination for Bioequivalence Assessment by Means of 
Confidence Intervals.</em> Int J Clin Pharmacol Ther Toxicol. 1991;29(1):1–8. 
</p>


<h3>See Also</h3>

<p><code>sampleN.TOST, known.designs</code>
</p>


<h3>Examples</h3>

<pre><code class="language-R"># power for the 2x2 cross-over design with 24 subjects and CV 25%
# using all the other default values
power.TOST(CV = 0.25, n = 24)
# should give: [1] 0.7391155
# nct approximation very good for this configuration
power.TOST(CV = 0.25, n = 24, method = "nct")
# gives also: [1] 0.7391155
# shifted-central-t  approximation 
power.TOST(CV = 0.25, n = 24, method = "shifted")
# gives:      [1] 0.7328894

# power for the 2x2 cross-over study with 24 subjects, CV 25%
# and 2 drop-outs in the same sequence group (unbalanced study)
power.TOST(CV=0.25, n=c(10,12))
# should give: [1] 0.6912935
# not the same compared to the balanced setting
power.TOST(CV=0.25, n=22)
# should give: [1] 0.6953401
</code></pre>


</div>