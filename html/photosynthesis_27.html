<div class="container">

<table style="width: 100%;"><tr>
<td>fit_hydra_vuln_curve</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>Fitting hydraulic vulnerability curves</h2>

<h3>Description</h3>

<p>Fitting hydraulic vulnerability curves
</p>


<h3>Usage</h3>

<pre><code class="language-R">fit_hydra_vuln_curve(
  data,
  varnames = list(psi = "psi", PLC = "PLC"),
  start_weibull = list(a = 2, b = 2),
  title = NULL
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>data</code></td>
<td>
<p>Dataframe</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>varnames</code></td>
<td>
<p>List of variable names. varnames = list(psi = "psi",
PLC = "PLC") where psi is water potential in MPa, and PLC is percent
loss conductivity.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>start_weibull</code></td>
<td>
<p>starting values for the nls fitting routine
for the Weibull curve</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>title</code></td>
<td>
<p>Title for the output graph</p>
</td>
</tr>
</table>
<h3>Value</h3>

<p>fit_hydra_vuln_curve fits a sigmoidal function (Pammenter &amp; Van der
Willigen, 1998) linearized according to Ogle et al. (2009). Output is a list
containing the sigmoidal model in element 1 and Weibull model in element 4,
the fit parameters with 95% confidence interval for both models are in
element 2, and hydraulic parameters in element 3 (including P25, P50, P88,
P95, S50, Pe, Pmax, DSI). Px (25 to 95): water potential at which x% of
conductivity is lost. S50: slope at 50% loss of conductivity. Pe: air
entry point. Pmax: hydraulic failure threshold. DSI: drought stress interval.
Element 5 is a graph showing the fit, P50, Pe, and Pmax.
</p>


<h3>References</h3>

<p>Ogle K, Barber JJ, Willson C, Thompson B. 2009. Hierarchical statistical
modeling of xylem vulnerability to cavitation. New Phytologist 182:541-554
</p>
<p>Pammenter NW, Van der Willigen CV. 1998. A mathematical and statistical
analysis of the curves illustrating vulnerability of xylem to cavitation.
Tree Physiology 18:589-593
</p>


<h3>Examples</h3>

<pre><code class="language-R">
# Read in data
data &lt;- read.csv(system.file("extdata", "hydraulic_vulnerability.csv",
  package = "photosynthesis"
))

# Fit hydraulic vulnerability curve
fit &lt;- fit_hydra_vuln_curve(data[data$Tree == 4 &amp; data$Plot == "Control", ],
  varnames = list(
    psi = "P",
    PLC = "PLC"
  ),
  title = "Control 4"
)

# Return Sigmoidal model summary
summary(fit[[1]])

# Return Weibull model summary
summary(fit[[4]])

# Return model parameters with 95\% confidence intervals
fit[[2]]

# Return hydraulic parameters
fit[[3]]

# Return graph
fit[[5]]

# Fit many curves
fits &lt;- fit_many(
  data = data,
  varnames = list(
    psi = "P",
    PLC = "PLC"
  ),
  group = "Tree",
  funct = fit_hydra_vuln_curve
)

# To select individuals from the many fits
# Return model summary
summary(fits[[1]][[1]]) # Returns model summary

# Return sigmoidal model output
fits[[1]][[2]]

# Return hydraulic parameters
fits[[1]][[3]]

# Return graph
fits[[1]][[5]]

# Compile parameter outputs
pars &lt;- compile_data(
  data = fits,
  output_type = "dataframe",
  list_element = 3
)

# Compile graphs
graphs &lt;- compile_data(
  data = fits,
  output_type = "list",
  list_element = 5
)

</code></pre>


</div>