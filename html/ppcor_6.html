<div class="container">

<table style="width: 100%;"><tr>
<td>spcor.test</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>
Semi-partial (part) correlation for two variables given a third variable.
</h2>

<h3>Description</h3>

<p>The function <code>spcor.test</code> can calculate the pairwise semi-partial (part) correlations between two variables. In addition, it gives us the p value as well as statistic.
</p>


<h3>Usage</h3>

<pre><code class="language-R">spcor.test(x, y, z, method = c("pearson", "kendall", "spearman"))
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>x</code></td>
<td>

<p>a numeric vector.
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>y</code></td>
<td>

<p>a numeric vector.
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>z</code></td>
<td>

<p>a numeric vector.
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>method</code></td>
<td>

<p>a character string indicating which partial correlation coefficient is to be computed. One of "pearson" (default), "kendall", or "spearman" can be abbreviated.
</p>
</td>
</tr>
</table>
<h3>Details</h3>

<p>Semi-partial correlation is the correlation of two variables with variation from a third variable removed only from the second variable. When the determinant of variance-covariance matrix is numerically zero, Moore-Penrose generalized matrix inverse is used. In this case, no <code>p-value</code> and <code>statistic</code> will be provided if the number of variables are greater than or equal to the sample size.
</p>


<h3>Value</h3>

<table>
<tr style="vertical-align: top;">
<td><code>estimate</code></td>
<td>
<p>the semi-partial (part) correlation coefficient between two variables</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>p.value</code></td>
<td>
<p>the p value of the test</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>statistic</code></td>
<td>
<p>the value of the test statistic</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>n</code></td>
<td>
<p>the number of samples</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>gn</code></td>
<td>
<p>the number of given variables</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>method</code></td>
<td>
<p>the correlation method used</p>
</td>
</tr>
</table>
<h3>Note</h3>

<p>Missing values are not allowed
</p>


<h3>Author(s)</h3>

<p>Seongho Kim &lt;<a href="mailto:biostatistician.kim@gmail.com">biostatistician.kim@gmail.com</a>&gt;
</p>


<h3>References</h3>

<p>Kim, S. (2015) ppcor: An R Package for a Fast Calculation to Semi-partial Correlation Coefficients. Communications for Statistical Applications and Methods,  22(6), 665-674. 
</p>


<h3>See Also</h3>

<p><code>spcor</code>, <code>pcor</code>, <code>pcor.test</code>
</p>


<h3>Examples</h3>

<pre><code class="language-R"># data
y.data &lt;- data.frame(
				hl=c(7,15,19,15,21,22,57,15,20,18),
				disp=c(0.000,0.964,0.000,0.000,0.921,0.000,0.000,1.006,0.000,1.011),
				deg=c(9,2,3,4,1,3,1,3,6,1),
				BC=c(1.78e-02,1.05e-06,1.37e-05,7.18e-03,0.00e+00,0.00e+00,0.00e+00
              ,4.48e-03,2.10e-06,0.00e+00)
			)

# semi-partial (part) correlation between "hl" and "disp" given "deg" and "BC"
spcor.test(y.data$hl,y.data$disp,y.data[,c("deg","BC")])
spcor.test(y.data[,1],y.data[,2],y.data[,c(3:4)])
spcor.test(y.data[,1],y.data[,2],y.data[,-c(1:2)])
</code></pre>


</div>