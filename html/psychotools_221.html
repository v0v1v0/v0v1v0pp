<div class="container">

<table style="width: 100%;"><tr>
<td>gpcmodel</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>Generalized Partial Credit Model Fitting Function</h2>

<h3>Description</h3>

<p><code>gpcmodel</code> is a basic fitting function for generalized partial credit
models providing a wrapper around <code>mirt</code> and
<code>multipleGroup</code> relying on marginal maximum likelihood (MML)
estimation via the standard EM algorithm.
</p>


<h3>Usage</h3>

<pre><code class="language-R">gpcmodel(y, weights = NULL, impact = NULL, type = c("GPCM", "PCM"),
  grouppars = FALSE, vcov = TRUE, nullcats = "downcode", 
  start = NULL, method = "BFGS", maxit = 500, reltol = 1e-5, ...)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>y</code></td>
<td>
<p>item response object that can be coerced (via <code>as.matrix</code>)
to a numeric matrix with scores 0, 1, ... Typically, either
already a matrix, data frame, or dedicated object of class
<code>itemresp</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>weights</code></td>
<td>
<p>an optional vector of weights (interpreted as case
weights)</p>
</td>
</tr>
</table>
<p>.
</p>
<table>
<tr style="vertical-align: top;">
<td><code>impact</code></td>
<td>
<p>an optional <code>factor</code> allowing for grouping
the subjects (rows). If specified, a multiple-group model is fitted
to account for impact (see details below). By default, no impact is
modelled, i.e., a single-group model is used.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>type</code></td>
<td>
<p>character string, specifying the type of model to be
estimated. In addition to the default GPCM (generalized partial credit model)
it is also possible to estimate a standard PCM (partial credit model)
by marginal maximum likelihood (MML).</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>grouppars</code></td>
<td>
<p>logical. Should the estimated distributional group parameters
of a multiple group model be included in the model parameters?</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>vcov</code></td>
<td>
<p>logical or character specifying the type of variance-covariance
matrix (if any) computed for the final model. The default <code>vcov = TRUE</code>
corresponds to <code>vcov = "Oakes"</code>, see <code>mirt</code> for
further options. If set to <code>vcov = FALSE</code> (or <code>vcov = "none"</code>),
<code>vcov()</code> will return a matrix of <code>NA</code>s only.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>nullcats</code></td>
<td>
<p>character string, specifying how items with
null categories (i.e., categories not observed) should be treated. Currently
only <code>"downcode"</code> is available, i.e., all categories above a null category are
shifted down to close the observed gap(s).</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>start</code></td>
<td>
<p>an optional vector or list of starting values (see examples
below).</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>method, maxit, reltol</code></td>
<td>
<p>control parameters for the optimizer employed by
<code>mirt</code> for the EM algorithm.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>...</code></td>
<td>
<p>further arguments passed to <code>mirt</code> or
<code>multipleGroup</code>, respectively.</p>
</td>
</tr>
</table>
<h3>Details</h3>

<p><code>gpcmodel</code> provides a basic fitting function for generalized partial
credit models (GPCMs) providing a wrapper around <code>mirt</code> (and
<code>multipleGroup</code>, respectively) relying on MML estimation via
the standard EM algorithm (Bock &amp; Aitkin, 1981). Models are estimated under the
slope/intercept parametrization, see e.g. Chalmers (2012). The probability of
person <code class="reqn">i</code> falling into category <code class="reqn">x_{ij}</code> of item <code class="reqn">j</code> out of all
categories <code class="reqn">p_{j}</code> is modelled as:
</p>
<p style="text-align: center;"><code class="reqn">P(X_{ij} = x_{ij}|\theta_{i},a_{j},\boldsymbol{d_{j}}) =
  \frac{\exp{(x_{ij}a_{j}\theta_{i} + d_{jx_{ij}})}}{\displaystyle\sum_{k = 0} ^
  {p_{j}}\exp{(ka_{j}\theta_{i} + d_{jk})}}</code>
</p>

<p>Note that all <code class="reqn">d_{j0}</code> are fixed at 0. A reparametrization of the
intercepts to the classical IRT parametrization, see e.g. Muraki (1992), is
provided via <code>threshpar</code>.
</p>
<p>If an optional <code>impact</code> variable is supplied, a multiple-group model of
the following form is being fitted: Item parameters are fixed to be equal
across the whole sample. For the first group of the <code>impact</code> variable the
person parameters are fixed to follow the standard normal distribution. In the
remaining <code>impact</code> groups, the distributional parameters (mean and
variance of a normal distribution) of the person parameters are
estimated freely. See e.g. Baker &amp; Kim (2004, Chapter 11), Debelak &amp; Strobl
(2019), or Schneider et al. (2022) for further details. To improve convergence of the model fitting
algorithm, the first level of the <code>impact</code> variable should always correspond
to the largest group. If this is not the case, levels are re-ordered internally.
</p>
<p>If <code>grouppars</code> is set to <code>TRUE</code> the freely estimated distributional
group parameters (if any) are returned as part of the model parameters.
</p>
<p>Instead of the default GPCM, a standard partial credit model (PCM) can also
be estimated via MML by setting <code>type = "PCM"</code>. In this case all slopes
are restricted to be equal across all items.
</p>
<p><code>gpcmodel</code> returns an object of class <code>"gpcmodel"</code> for which
several basic methods are available, including <code>print</code>, <code>plot</code>,
<code>summary</code>, <code>coef</code>, <code>vcov</code>, <code>logLik</code>, <code>estfun</code>,
<code>discrpar</code>, <code>itempar</code>, <code>threshpar</code>, and
<code>personpar</code>.
</p>


<h3>Value</h3>

<p><code>gpcmodel</code> returns an S3 object of class <code>"gpcmodel"</code>, 
i.e., a list of the following components:
</p>
<table>
<tr style="vertical-align: top;">
<td><code>coefficients</code></td>
<td>
<p>estimated model parameters in slope/intercept parametrization,</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>vcov</code></td>
<td>
<p>covariance matrix of the model parameters,</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>data</code></td>
<td>
<p>modified data, used for model-fitting, i.e., centralized so
that the first category is zero for all items, treated null categories as
specified via argument <code>"nullcats"</code> and without observations with zero
weight,</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>items</code></td>
<td>
<p>logical vector of length <code>ncol(y)</code>, indicating
which items were used during estimation,</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>categories</code></td>
<td>
<p>list of length <code>ncol(y)</code>, containing integer
vectors starting from one to the number of categories minus one per
item,</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>n</code></td>
<td>
<p>number of observations (with non-zero weights),</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>n_org</code></td>
<td>
<p>original number of observations in <code>y</code>,</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>weights</code></td>
<td>
<p>the weights used (if any),</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>na</code></td>
<td>
<p>logical indicating whether the data contain <code>NA</code>s,</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>nullcats</code></td>
<td>
<p>currently always <code>NULL</code> as eventual items with null
categories are handled via <code>"downcode"</code>,</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>impact</code></td>
<td>
<p>either <code>NULL</code> or the supplied <code>impact</code> variable
with the levels reordered in decreasing order (if this has not been the case
prior to fitting the model),</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>loglik</code></td>
<td>
<p>log-likelihood of the fitted model,</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>df</code></td>
<td>
<p>number of estimated (more precisely, returned) model parameters,</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>code</code></td>
<td>
<p>convergence code from <code>mirt</code>,</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>iterations</code></td>
<td>
<p>number of iterations used by <code>mirt</code>,</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>reltol</code></td>
<td>
<p>convergence threshold passed to <code>mirt</code>,</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>grouppars</code></td>
<td>
<p>the logical <code>grouppars</code> value,</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>type</code></td>
<td>
<p>the <code>type</code> of model restriction specified,</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>mirt</code></td>
<td>
<p>the <code>mirt</code> object fitted internally,</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>call</code></td>
<td>
<p>original function call.</p>
</td>
</tr>
</table>
<h3>References</h3>

<p>Baker FB, Kim SH (2004).
<em>Item Response Theory: Parameter Estimation Techniques</em>.
Chapman &amp; Hall/CRC, Boca Raton.
</p>
<p>Bock RD, Aitkin M (1981).
Marginal Maximum Likelihood Estimation of Item Parameters: Application of an EM Algorithm.
<em>Psychometrika</em>, <b>46</b>(4), 443–459.
</p>
<p>Chalmers RP (2012).
mirt: A Multidimensional Item Response Theory Package for the R Environment.
<em>Journal of Statistical Software</em>, <b>48</b>(6), 1–29.
<a href="https://doi.org/10.18637/jss.v048.i06">doi:10.18637/jss.v048.i06</a>
</p>
<p>Debelak R, Strobl C (2019).
Investigating Measurement Invariance by Means of Parameter Instability Tests for 2PL and 3PL Models.
<em>Educational and Psychological Measurement</em>, <b>79</b>(2), 385–398.
<a href="https://doi.org/10.1177/0013164418777784">doi:10.1177/0013164418777784</a>
</p>
<p>Muraki E (1992).
A Generalized Partial Credit Model: Application of an EM Algorithm.
<em>Applied Psychological Measurement</em>, <b>16</b>(2), 159–176.
</p>
<p>Schneider L, Strobl C, Zeileis A, Debelak R (2022).
An R Toolbox for Score-Based Measurement Invariance Tests in IRT Models.
<em>Behavior Research Methods</em>, forthcoming.
<a href="https://doi.org/10.3758/s13428-021-01689-0">doi:10.3758/s13428-021-01689-0</a>
</p>


<h3>See Also</h3>

<p><code>pcmodel</code>, <code>rsmodel</code>, <code>nplmodel</code>,
<code>raschmodel</code>, <code>btmodel</code></p>


<h3>Examples</h3>

<pre><code class="language-R">if(requireNamespace("mirt")) {

o &lt;- options(digits = 4)

## mathematics 101 exam results
data("MathExam14W", package = "psychotools")

## generalized partial credit model
gpcm &lt;- gpcmodel(y = MathExam14W$credit)
summary(gpcm)

## how to specify starting values as a vector of model parameters
st &lt;- coef(gpcm)
gpcm &lt;- gpcmodel(y = MathExam14W$credit, start = st)
## or a list containing a vector of slopes and a list of intercept vectors
## itemwise
set.seed(0)
st &lt;- list(a = rlnorm(13, 0, 0.0625), d = replicate(13, rnorm(2, 0, 1), FALSE))
gpcm &lt;- gpcmodel(y = MathExam14W$credit, start = st)

## visualizations
plot(gpcm, type = "profile")
plot(gpcm, type = "regions")
plot(gpcm, type = "piplot")
plot(gpcm, type = "curves", xlim = c(-6, 6))
plot(gpcm, type = "information", xlim = c(-6, 6))
## visualizing the IRT parametrization
plot(gpcm, type = "curves", xlim = c(-6, 6), items = 1)
abline(v = threshpar(gpcm)[[1]])
abline(v = itempar(gpcm)[1], lty = 2)

options(digits = o$digits)
}
</code></pre>


</div>