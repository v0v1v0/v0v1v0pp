<div class="container">

<table style="width: 100%;"><tr>
<td>PivotBatchCalculator</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>R6 class that calculates the values for multiple cells in batches.</h2>

<h3>Description</h3>

<p>The 'PivotBatchCalculator' class calculates the values for multiple cells in
the pivot table in one evaluation step (per batch), instead of evaluating
every calculation once per pivot table cell.
</p>


<h3>Format</h3>

<p><code>R6Class</code> object.
</p>


<h3>Details</h3>

<p>Evaluating a set of filters and calculations repetitively for each cell is
inefficient and slow.  The Batch Calculator executes a much small number of
calculations which greatly reduces the CPU time and elapsed time required.
See the "Performance" vignette for details.
</p>


<h3>Active bindings</h3>

<div class="r6-active-bindings">

<dl>
<dt><code>batchCount</code></dt>
<dd>
<p>The number of batches generated for the pivot table.</p>
</dd>
<dt><code>calculationSummary</code></dt>
<dd>
<p>A summary of the batch compatibility for each
calculation.</p>
</dd>
<dt><code>batchSummary</code></dt>
<dd>
<p>A summary of the batches in the pivot table.</p>
</dd>
</dl>
</div>


<h3>Methods</h3>



<h4>Public methods</h4>


<ul>
<li> <p><a href="#method-PivotBatchCalculator-new"><code>PivotBatchCalculator$new()</code></a>
</p>
</li>
<li> <p><a href="#method-PivotBatchCalculator-reset"><code>PivotBatchCalculator$reset()</code></a>
</p>
</li>
<li> <p><a href="#method-PivotBatchCalculator-checkValidWorkingData"><code>PivotBatchCalculator$checkValidWorkingData()</code></a>
</p>
</li>
<li> <p><a href="#method-PivotBatchCalculator-isFiltersBatchCompatible"><code>PivotBatchCalculator$isFiltersBatchCompatible()</code></a>
</p>
</li>
<li> <p><a href="#method-PivotBatchCalculator-generateBatchesForNamedCalculationEvaluation1"><code>PivotBatchCalculator$generateBatchesForNamedCalculationEvaluation1()</code></a>
</p>
</li>
<li> <p><a href="#method-PivotBatchCalculator-generateBatchesForNamedCalculationEvaluation2"><code>PivotBatchCalculator$generateBatchesForNamedCalculationEvaluation2()</code></a>
</p>
</li>
<li> <p><a href="#method-PivotBatchCalculator-generateBatchesForCellEvaluation"><code>PivotBatchCalculator$generateBatchesForCellEvaluation()</code></a>
</p>
</li>
<li> <p><a href="#method-PivotBatchCalculator-evaluateBatches"><code>PivotBatchCalculator$evaluateBatches()</code></a>
</p>
</li>
<li> <p><a href="#method-PivotBatchCalculator-getSummaryValueFromBatch"><code>PivotBatchCalculator$getSummaryValueFromBatch()</code></a>
</p>
</li>
<li> <p><a href="#method-PivotBatchCalculator-clone"><code>PivotBatchCalculator$clone()</code></a>
</p>
</li>
</ul>
<hr>
<a id="method-PivotBatchCalculator-new"></a>



<h4>Method <code>new()</code>
</h4>

<p>Create a new 'PivotBatchCalculator' object.
</p>


<h5>Usage</h5>

<div class="r"><pre>PivotBatchCalculator$new(parentPivot = NULL)</pre></div>



<h5>Arguments</h5>

<div class="arguments">

<dl>
<dt><code>parentPivot</code></dt>
<dd>
<p>The pivot table that this 'PivotBatchCalculator'
instance belongs to.</p>
</dd>
</dl>
</div>



<h5>Returns</h5>

<p>A new 'PivotBatchCalculator' object.
</p>


<hr>
<a id="method-PivotBatchCalculator-reset"></a>



<h4>Method <code>reset()</code>
</h4>

<p>Reset the batch calculator, clearing all existing batches.
</p>


<h5>Usage</h5>

<div class="r"><pre>PivotBatchCalculator$reset()</pre></div>



<h5>Returns</h5>

<p>No return value.
</p>


<hr>
<a id="method-PivotBatchCalculator-checkValidWorkingData"></a>



<h4>Method <code>checkValidWorkingData()</code>
</h4>

<p>Run some additional checks to see whether the working data is valid.
Typically only used in development builds of the package.
</p>


<h5>Usage</h5>

<div class="r"><pre>PivotBatchCalculator$checkValidWorkingData(workingData = NULL)</pre></div>



<h5>Arguments</h5>

<div class="arguments">

<dl>
<dt><code>workingData</code></dt>
<dd>
<p>The working data to check.</p>
</dd>
</dl>
</div>



<h5>Returns</h5>

<p>No return value.
</p>


<hr>
<a id="method-PivotBatchCalculator-isFiltersBatchCompatible"></a>



<h4>Method <code>isFiltersBatchCompatible()</code>
</h4>

<p>Examines a set of filters to see whether they are compatible with batch
evaluation mode. Only filters that specify zero or one value for each
variable are compatible with batch evaluation.
</p>


<h5>Usage</h5>

<div class="r"><pre>PivotBatchCalculator$isFiltersBatchCompatible(filters = NULL)</pre></div>



<h5>Arguments</h5>

<div class="arguments">

<dl>
<dt><code>filters</code></dt>
<dd>
<p>A 'PivotFilters' object that represents a set of filters
to examine.</p>
</dd>
</dl>
</div>



<h5>Details</h5>

<p>It is not practical to make batch evaluation work where a filter
matches more than one value for a variable.  One approach might be to add
a derived column where a single value represents the multiple values, however
the combination of values could partially overlap with combinations of values
in other data groups.  Also the value that represents the "combined"
value could collide with other existing values in the column.
In summary:  Sequential mode is slower and more flexible.  Batch is faster
but stricter.  Batch mode works for regular pivot tables (i.e. most cases).
</p>



<h5>Returns</h5>

<p>'TRUE' if the filters are batch compatible, 'FALSE' otherwise.
</p>


<hr>
<a id="method-PivotBatchCalculator-generateBatchesForNamedCalculationEvaluation1"></a>



<h4>Method <code>generateBatchesForNamedCalculationEvaluation1()</code>
</h4>

<p>Generates a new batch or finds a relevant existing batch for
a named calculation and single working filters object.
</p>


<h5>Usage</h5>

<div class="r"><pre>PivotBatchCalculator$generateBatchesForNamedCalculationEvaluation1(
  dataName = NULL,
  calculationName = NULL,
  calculationGroupName = NULL,
  workingFilters = NULL
)</pre></div>



<h5>Arguments</h5>

<div class="arguments">

<dl>
<dt><code>dataName</code></dt>
<dd>
<p>The name of the data frame (as specified in
'pt$addData()').</p>
</dd>
<dt><code>calculationName</code></dt>
<dd>
<p>The name of the calculation.</p>
</dd>
<dt><code>calculationGroupName</code></dt>
<dd>
<p>The calculation group of the
calculation.</p>
</dd>
<dt><code>workingFilters</code></dt>
<dd>
<p>A 'PivotFilters' object that represents the
working filters to generate the batch for.</p>
</dd>
</dl>
</div>



<h5>Returns</h5>

<p>The name of either the batch that was created or the
relevant existing batch.
</p>


<hr>
<a id="method-PivotBatchCalculator-generateBatchesForNamedCalculationEvaluation2"></a>



<h4>Method <code>generateBatchesForNamedCalculationEvaluation2()</code>
</h4>

<p>Generates one or more batches for the named calculations and set of
working working data associated with a cell.
</p>


<h5>Usage</h5>

<div class="r"><pre>PivotBatchCalculator$generateBatchesForNamedCalculationEvaluation2(
  calculationName = NULL,
  calculationGroupName = NULL,
  workingData = NULL
)</pre></div>



<h5>Arguments</h5>

<div class="arguments">

<dl>
<dt><code>calculationName</code></dt>
<dd>
<p>The name of the calculation.</p>
</dd>
<dt><code>calculationGroupName</code></dt>
<dd>
<p>The calculation group of the
calculation.</p>
</dd>
<dt><code>workingData</code></dt>
<dd>
<p>A list containing filter and/or filter overrides.</p>
</dd>
</dl>
</div>



<h5>Details</h5>

<p>A wrapper around 'generateBatchesForNamedCalculationEvaluation1()', which
invokes this function as appropriate, depending on whether a calculation
if either of type "summary" or type "calculation".
</p>



<h5>Returns</h5>

<p>One or more batch names of either the batches that were created or
the relevant existing batches.
</p>


<hr>
<a id="method-PivotBatchCalculator-generateBatchesForCellEvaluation"></a>



<h4>Method <code>generateBatchesForCellEvaluation()</code>
</h4>

<p>Generates the batches for batch evaluation mode.
</p>


<h5>Usage</h5>

<div class="r"><pre>PivotBatchCalculator$generateBatchesForCellEvaluation()</pre></div>



<h5>Returns</h5>

<p>One or more batch names of either the batches that were created or
the relevant existing batches.
</p>


<hr>
<a id="method-PivotBatchCalculator-evaluateBatches"></a>



<h4>Method <code>evaluateBatches()</code>
</h4>

<p>Evaluate each of the batches defined in the batch calculator.
</p>


<h5>Usage</h5>

<div class="r"><pre>PivotBatchCalculator$evaluateBatches()</pre></div>



<h5>Returns</h5>

<p>The number of batches that were evaluated.
</p>


<hr>
<a id="method-PivotBatchCalculator-getSummaryValueFromBatch"></a>



<h4>Method <code>getSummaryValueFromBatch()</code>
</h4>

<p>Retrieve one calculation value from one batch, typically for the value
of one cell in a pivot table.
</p>


<h5>Usage</h5>

<div class="r"><pre>PivotBatchCalculator$getSummaryValueFromBatch(
  batchName = NULL,
  calculationName = NULL,
  calculationGroupName = NULL,
  workingFilters = NULL
)</pre></div>



<h5>Arguments</h5>

<div class="arguments">

<dl>
<dt><code>batchName</code></dt>
<dd>
<p>The name of the batch containing the calculation result.</p>
</dd>
<dt><code>calculationName</code></dt>
<dd>
<p>The name of the calculation.</p>
</dd>
<dt><code>calculationGroupName</code></dt>
<dd>
<p>The calculation group of the
calculation.</p>
</dd>
<dt><code>workingFilters</code></dt>
<dd>
<p>A 'PivotFilters' object that represents the
working filters to retrieve the value for.</p>
</dd>
</dl>
</div>



<h5>Returns</h5>

<p>A single calculation value.
</p>


<hr>
<a id="method-PivotBatchCalculator-clone"></a>



<h4>Method <code>clone()</code>
</h4>

<p>The objects of this class are cloneable with this method.
</p>


<h5>Usage</h5>

<div class="r"><pre>PivotBatchCalculator$clone(deep = FALSE)</pre></div>



<h5>Arguments</h5>

<div class="arguments">

<dl>
<dt><code>deep</code></dt>
<dd>
<p>Whether to make a deep clone.</p>
</dd>
</dl>
</div>




<h3>Examples</h3>

<pre><code class="language-R"># This class should only be created by the pivot table.
# It is not intended to be created outside of the pivot table.
</code></pre>


</div>