<div class="container">

<table style="width: 100%;"><tr>
<td>npllHSMM</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>negative penalised HSMM log-likelihood function</h2>

<h3>Description</h3>

<p>Evaluates the negative penalised log-likelihood function of the HSMM (internal function, called by the function <code>pmleHSMM</code>).
</p>


<h3>Usage</h3>

<pre><code class="language-R">npllHSMM(parvect ,N, y, R_vec, lambda, order_diff,
        y_dist=c("norm","gamma","pois","bern"),
        stationary=TRUE, T_y,  p_ref=2)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>parvect</code></td>
<td>
<p>vector of unconstraint working parameter as returned by the function <code>n2wHSMM</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>N</code></td>
<td>
<p>number of states of the HSMM, integer greater than 1.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>y</code></td>
<td>
<p>vector containing the observed time series.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>R_vec</code></td>
<td>
<p>vector of length <code>N</code> containing the lengths of the unstructured starts of the dwell-time distributions.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>lambda</code></td>
<td>
<p>vector of length <code>N</code> containing the smoothing parameter values to weight the penalty term.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>order_diff</code></td>
<td>
<p>order of the differences used for the penalty term, positive integer which does not exceed the length of the unstructured starts.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>y_dist</code></td>
<td>
<p>character determining the class of state-dependent distributions. Supported values are <code>"norm"</code> (normal distribution), <code>"gamma"</code> (gamma distribution), <code>"pois"</code> (Poisson distribution) and <code>"bern"</code> (Bernoulli distribution).</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>stationary</code></td>
<td>
<p>Logical, if <code>TRUE</code> (default), stationarity is assumed, if <code>FALSE</code>, the underlying state-sequence is assumed to enter a new state at time t=1.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>T_y</code></td>
<td>
<p>length of the observed time series.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>p_ref</code></td>
<td>
<p>positive integer determining the reference dwell-time probability used for the multinomial logit parameter transformation. Default value is 2. Only needs to be changed if the dwell-time probability for dwell time r=2 is estimated very close to zero in order to avoid numerical problems.</p>
</td>
</tr>
</table>
<h3>Details</h3>

<p>The penalised log-likelihood function relies on the exact HMM representation of the HSMM and is evaluated using the forward algorithm which is implemented in <code>C++</code> to speed up the calculation.
</p>


<h3>Value</h3>

<p>Returns the value of the negative penalised HSMM log-likelihood function for the given parameters and time series.
</p>


<h3>References</h3>

<p>Pohle, J., Adam, T. and Beumer, L.T. (2021): Flexible estimation of the state dwell-time distribution in hidden semi-Markov models. arXiv:<a href="https://arxiv.org/abs/2101.09197">https://arxiv.org/abs/2101.09197</a>.
</p>
<p>Zucchini, W., MacDonald, I.L. and Langrock, R. (2016): <em>Hidden Markov models for time series:
An introduction using R</em>. 2nd edition. Chapman &amp; Hall/CRC, Boca Raton.
</p>


<h3>Examples</h3>

<pre><code class="language-R"># 3-state gamma HSMM and hourly muskox step length
# natural parameters
p_list0&lt;-list()
p_list0[[1]]&lt;-c(dgeom(0:9,0.2),1-pgeom(9,0.2))
p_list0[[2]]&lt;-c(dgeom(0:9,0.2),1-pgeom(9,0.2))
p_list0[[3]]&lt;-c(dgeom(0:9,0.2),1-pgeom(9,0.2))
omega0&lt;-matrix(0.5,3,3)
diag(omega0)&lt;-0
mu0&lt;-c(5,100,350)
sigma0&lt;-c(3,90,300)
R_vec&lt;-sapply(p_list0,length)-1 # lengths of the unstructured starts
# working parameter vector
parvect&lt;-n2wHSMM(N=3,p_list=p_list0,mu=mu0,sigma=sigma0,
  omega=omega0,y_dist='gamma')
# evaluate the negative penalised log-likelihood function
npllHSMM(parvect,N=3,muskox$step,R_vec=R_vec,lambda=c(1000,1000,1000),
  order_diff=2,y_dist="gamma",T_y=nrow(muskox))
</code></pre>


</div>