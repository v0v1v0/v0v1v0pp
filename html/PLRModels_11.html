<div class="container">

<table style="width: 100%;"><tr>
<td>np.gof</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>
Goodness-of-Fit tests in nonparametric regression models
</h2>

<h3>Description</h3>

<p>This routine tests the equality of a nonparametric regression curve, <code class="reqn">m</code>, and a given function, <code class="reqn">m_0</code>, from a sample <code class="reqn">{(Y_i, t_i): i=1,...,n}</code>, where:
</p>
<p style="text-align: center;"><code class="reqn">Y_i= m(t_i) + \epsilon_i.</code>
</p>

<p>The unknown function <code class="reqn">m</code> is smooth, fixed equally spaced design is considered, and the random errors, <code class="reqn">{\epsilon_i}</code>, are allowed to be time series. The test statistic used for testing the null hypothesis, <code class="reqn">H0: m = m_0</code>, derives from a Cramer-von-Mises-type functional distance between a nonparametric estimator of <code class="reqn">m</code> and <code class="reqn">m_0</code>.
</p>


<h3>Usage</h3>

<pre><code class="language-R">np.gof(data = data, m0 = NULL, h.seq = NULL, w = NULL, 
estimator = "NW", kernel = "quadratic", time.series = FALSE, 
Tau.eps = NULL, h0 = NULL, lag.max = 50, p.max = 3, 
q.max = 3, ic = "BIC", num.lb = 10, alpha = 0.05)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>data</code></td>
<td>

<p><code>data[, 1]</code> contains the values of the response variable, <code class="reqn">Y</code>;
</p>
<p><code>data[, 2]</code> contains the values of the explanatory variable, <code class="reqn">t</code>.
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>m0</code></td>
<td>
<p>the considered function in the null hypothesis. If <code>NULL</code> (the default), the zero function is considered.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>h.seq</code></td>
<td>
<p>the statistic test is performed using each bandwidth in the vector <code>h.seq</code>. If <code>NULL</code> (the default), 10 equidistant values between zero and a quarter of the range of <code class="reqn">{t_i}</code> are considered.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>w</code></td>
<td>
<p>support interval of the weigth function in the test statistic. If <code>NULL</code> (the default), <code class="reqn">(q_{0.1}, q_{0.9})</code> is considered, where <code class="reqn">q_p</code> denotes the quantile of order <code class="reqn">p</code> of <code class="reqn">{t_i}</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>estimator</code></td>
<td>
<p>allows us the choice between “NW” (Nadaraya-Watson) or “LLP” (Local Linear Polynomial). The default is “NW”.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>kernel</code></td>
<td>
<p>allows us the choice between “gaussian”, “quadratic” (Epanechnikov kernel), “triweight” or “uniform” kernel. The default is “quadratic”.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>time.series</code></td>
<td>
<p>it denotes whether the data are independent (FALSE) or if data is a time series (TRUE). The default is FALSE.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>Tau.eps</code></td>
<td>
<p>it contains the sum of autocovariances associated to the random errors of the regression model. If NULL (the default), the function tries to estimate it: it fits an ARMA model (selected according to an information criterium) to the residuals from the fitted nonparametric regression model and, then, it obtains the sum of the autocovariances of such ARMA model.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>h0</code></td>
<td>
<p>if <code>Tau.eps=NULL</code>, <code>h0</code> contains the pilot bandwidth used for obtaining the residuals to construct the default for <code>Tau.eps</code>. If <code>NULL</code> (the default), a quarter of the range of <code class="reqn">{t_i}</code> is considered.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>lag.max</code></td>
<td>
<p>if <code>Tau.eps=NULL</code>, <code>lag.max</code> contains the maximum delay used to construct the default for <code>Tau.eps</code>. The default is 50.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>p.max</code></td>
<td>
<p>if <code>Tau.eps=NULL</code>, the ARMA model is selected between the models ARMA(p,q) with 0&lt;=p&lt;=<code>p.max</code> and 0&lt;=q&lt;=<code>q.max</code>. The default is 3.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>q.max</code></td>
<td>
<p>if <code>Tau.eps=NULL</code>, the ARMA model is selected between the models ARMA(p,q) with 0&lt;=p&lt;=<code>p.max</code> and 0&lt;=q&lt;=<code>q.max</code>. The default is 3.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>ic</code></td>
<td>
<p>if <code>Tau.eps=NULL</code>, <code>ic</code> contains the information criterion used to suggest the ARMA model. It allows us to choose between: "AIC", "AICC" or "BIC" (the default).</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>num.lb</code></td>
<td>
<p>if <code>Tau.eps=NULL</code>, it checks the suitability of the selected ARMA model according to the Ljung-Box test and the t-test. It uses up to <code>num.lb</code> delays in the Ljung-Box test. The default is 10.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>alpha</code></td>
<td>
<p>if <code>Tau.eps=NULL</code>, <code>alpha</code> contains the significance level which the ARMA model is checked. The default is 0.05.</p>
</td>
</tr>
</table>
<h3>Details</h3>

<p>A weight function (specifically, the indicator function <b>1</b><code class="reqn">_{[w[1] , w[2]]}</code>) is introduced in the test statistic to allow elimination (or at least significant reduction) of boundary effects from the estimate of <code class="reqn">m(t_i)</code>.
</p>
<p>If <code>Tau.eps=NULL</code> and the routine is not able to suggest an approximation for <code>Tau.eps</code>, it warns the user with a message saying that the model could be not appropriate and then it shows the results. In order to construct <code>Tau.eps</code>, the procedures suggested in Muller and Stadmuller (1988) and Herrmann <em>et al.</em> (1992) can be followed.
</p>
<p>The implemented statistic test particularizes that one in Gonzalez Manteiga and Vilar Fernandez (1995) to the case where the considered class in the null hypothesis has only one element.
</p>


<h3>Value</h3>

<p>A list with a dataframe containing:
</p>
<table>
<tr style="vertical-align: top;">
<td><code>h.seq</code></td>
<td>
<p>sequence of bandwidths used in the test statistic.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>Q.m</code></td>
<td>
<p>values of the test statistic (one for each bandwidth in <code>h.seq</code>).</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>Q.m.normalised</code></td>
<td>
<p>normalised value of Q.m.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>p.value</code></td>
<td>
<p>p-values of the corresponding statistic tests (one for each bandwidth in <code>h.seq</code>).</p>
</td>
</tr>
</table>
<p>Moreover, if <code>data</code> is a time series and <code>Tau.eps</code> is not especified:
</p>
<table>
<tr style="vertical-align: top;">
<td><code>pv.Box.test</code></td>
<td>
<p>p-values of the Ljung-Box test for the model fitted to the residuals.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>pv.t.test</code></td>
<td>
<p>p-values of the t.test for the model fitted to the residuals.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>ar.ma</code></td>
<td>
<p>ARMA orders for the model fitted to the residuals.</p>
</td>
</tr>
</table>
<h3>Author(s)</h3>

<p>German Aneiros Perez <a href="mailto:ganeiros@udc.es">ganeiros@udc.es</a>
</p>
<p>Ana Lopez Cheda <a href="mailto:ana.lopez.cheda@udc.es">ana.lopez.cheda@udc.es</a></p>


<h3>References</h3>

<p>Biedermann, S. and Dette, H. (2000) Testing linearity of regression models with dependent errors by kernel based methods. <em>Test</em> <b>9</b>, 417-438.
</p>
<p>Gonzalez-Manteiga, W. and Aneiros-Perez, G. (2003) Testing in partial linear regression models with dependent errors. <em>J. Nonparametr. Statist.</em> <b>15</b>, 93-111.
</p>
<p>Gonzalez-Manteiga, W. and Cao, R. (1993) Testing the hypothesis of a general linear model using nonparametric regression estimation. <em>Test</em> <b>2</b>, 161-188.
</p>
<p>Gonzalez Manteiga, W. and Vilar Fernandez, J. M. (1995) Testing linear regression models using non-parametric regression estimators when errors are non-independent. <em>Comput. Statist. Data Anal.</em> <b>20</b>, 521-541.
</p>
<p>Herrmann, E., Gasser, T. and Kneip, A. (1992) Choice of bandwidth for kernel regression when residuals are correlated. <em>Biometrika</em> <b>79</b>, 783-795
</p>
<p>Muller, H.G. and Stadmuller, U. (1988) Detecting dependencies in smooth regression models. <em>Biometrika</em> <b>75</b>, 639-650
</p>


<h3>See Also</h3>

<p>Other related functions are <code>np.est</code>, <code>par.gof</code> and <code>plrm.gof</code>.
</p>


<h3>Examples</h3>

<pre><code class="language-R"># EXAMPLE 1: REAL DATA
data &lt;- matrix(10,120,2)
data(barnacles1)
barnacles1 &lt;- as.matrix(barnacles1)
data[,1] &lt;- barnacles1[,1]
data &lt;- diff(data, 12)
data[,2] &lt;- 1:nrow(data)

np.gof(data)



# EXAMPLE 2: SIMULATED DATA
## Example 2a: dependent data

set.seed(1234)
# We generate the data
n &lt;- 100
t &lt;- ((1:n)-0.5)/n
m &lt;- function(t) {0.25*t*(1-t)}
f &lt;- m(t)
f.function &lt;- function(u) {0.25*u*(1-u)}

epsilon &lt;- arima.sim(list(order = c(1,0,0), ar=0.7), sd = 0.01, n = n)
y &lt;-  f + epsilon
data &lt;- cbind(y,t)

## Example 2a.1: true null hypothesis
np.gof(data, m0=f.function, time.series=TRUE)

## Example 2a.2: false null hypothesis
np.gof(data, time.series=TRUE) 

</code></pre>


</div>