<div class="container">

<table style="width: 100%;"><tr>
<td>ppval</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>
Piecewise Polynomial Structures
</h2>

<h3>Description</h3>

<p>Make or evaluate a piecewise polynomial.
</p>


<h3>Usage</h3>

<pre><code class="language-R">mkpp(x, P)

ppval(pp, xx)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>x</code></td>
<td>
<p>increasing vector of real numbers.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>P</code></td>
<td>
<p>matrix containing the coefficients of polynomials in each row.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>pp</code></td>
<td>
<p>a piecewise polynomial structure, generated by <code>mkpp</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>xx</code></td>
<td>
<p>numerical vector</p>
</td>
</tr>
</table>
<h3>Details</h3>

<p><code>pp&lt;-mkpp(x,P)</code> builds a piecewise polynomial from its breaks
<code>x</code> and coefficients <code>P</code>. <code>x</code> is a monotonically increasing
vector of length <code>L+1</code>, and <code>P</code> is an <code>L-by-k</code> matrix where 
each row contains the coefficients of the polynomial of order <code>k</code>, from 
highest to lowest exponent, on the interval <code>[x[i],x[i+1])</code>.
</p>
<p><code>ppval(pp,xx)</code> returns the values of the piecewise polynomial
<code>pp</code> at the entries of the vector <code>xx</code>. The first and last
polynomial will be extended to the left resp. right of the interval
<code>[x[1],x[L+1])</code>.
</p>


<h3>Value</h3>

<p><code>mkpp</code> will return a piecewise polynomial structure, that is a list
with components <code>breaks=x</code>, <code>pieces=P</code>, <code>order=k</code> and
<code>dim=1</code> for scalar-valued functions.
</p>


<h3>Note</h3>

<p>Matlab allows to generate vector-valued piecewise polynomials. This may be
included in later versions.
</p>


<h3>See Also</h3>

<p><code>cubicspline</code>
</p>


<h3>Examples</h3>

<pre><code class="language-R">##  Example: Linear interpolation of the sine function
xs &lt;- linspace(0, pi, 10)
ys &lt;- sin(xs)
P &lt;- matrix(NA, nrow = 9, ncol = 2)
for (i in 1:9) {
    P[i, ] &lt;- c((ys[i+1]-ys[i])/(xs[i+1]-xs[i]), ys[i])
}
ppsin &lt;- mkpp(xs, P)

## Not run: 
plot(xs, ys); grid()
x100 &lt;- linspace(0, pi, 100)
lines(x100, sin(x100), col="darkgray")
ypp &lt;- ppval(ppsin, x100)
lines(x100, ypp, col="red")

## End(Not run)
</code></pre>


</div>