<div class="container">

<table style="width: 100%;"><tr>
<td>calculate_protein_abundance</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>Label-free protein quantification</h2>

<h3>Description</h3>

<p>Determines relative protein abundances from ion quantification. Only proteins with at least
three peptides are considered for quantification. The three peptide rule applies for each
sample independently.
</p>


<h3>Usage</h3>

<pre><code class="language-R">calculate_protein_abundance(
  data,
  sample,
  protein_id,
  precursor,
  peptide,
  intensity_log2,
  min_n_peptides = 3,
  method = "sum",
  for_plot = FALSE,
  retain_columns = NULL
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>data</code></td>
<td>
<p>a data frame that contains at least the input variables.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>sample</code></td>
<td>
<p>a character column in the <code>data</code> data frame that contains the sample name.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>protein_id</code></td>
<td>
<p>a character column in the <code>data</code> data frame that contains the protein
accession numbers.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>precursor</code></td>
<td>
<p>a character column in the <code>data</code> data frame that contains precursors.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>peptide</code></td>
<td>
<p>a character column in the <code>data</code> data frame that contains peptide sequences.
This column is needed to filter for proteins with at least 3 unique peptides. This can equate
to more than three precursors. The quantification is done on the precursor level.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>intensity_log2</code></td>
<td>
<p>a numeric column in the <code>data</code> data frame that contains log2
transformed precursor intensities.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>min_n_peptides</code></td>
<td>
<p>An integer specifying the minimum number of peptides required
for a protein to be included in the analysis. The default value is 3, which means
proteins with fewer than three unique peptides will be excluded from the analysis.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>method</code></td>
<td>
<p>a character value specifying with which method protein quantities should be
calculated. Possible options include <code>"sum"</code>, which takes the sum of all precursor
intensities as the protein abundance. Another option is <code>"iq"</code>, which performs protein
quantification based on a maximal peptide ratio extraction algorithm that is adapted from the
MaxLFQ algorithm of the MaxQuant software. Functions from the
<a href="https://academic.oup.com/bioinformatics/article/36/8/2611/5697917"><code>iq</code></a> package are
used. Default is <code>"iq"</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>for_plot</code></td>
<td>
<p>a logical value indicating whether the result should be only protein intensities
or protein intensities together with precursor intensities that can be used for plotting using
<code>peptide_profile_plot()</code>. Default is <code>FALSE</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>retain_columns</code></td>
<td>
<p>a vector indicating if certain columns should be retained from the input
data frame. Default is not retaining additional columns <code>retain_columns = NULL</code>. Specific
columns can be retained by providing their names (not in quotations marks, just like other
column names, but in a vector).</p>
</td>
</tr>
</table>
<h3>Value</h3>

<p>If <code>for_plot = FALSE</code>, protein abundances are returned, if <code>for_plot = TRUE</code>
also precursor intensities are returned in a data frame. The later output is ideal for plotting
with <code>peptide_profile_plot()</code> and can be filtered to only include protein abundances.
</p>


<h3>Examples</h3>

<pre><code class="language-R">
# Create example data
data &lt;- data.frame(
  sample = c(
    rep("S1", 6),
    rep("S2", 6),
    rep("S1", 2),
    rep("S2", 2)
  ),
  protein_id = c(
    rep("P1", 12),
    rep("P2", 4)
  ),
  precursor = c(
    rep(c("A1", "A2", "B1", "B2", "C1", "D1"), 2),
    rep(c("E1", "F1"), 2)
  ),
  peptide = c(
    rep(c("A", "A", "B", "B", "C", "D"), 2),
    rep(c("E", "F"), 2)
  ),
  intensity = c(
    rnorm(n = 6, mean = 15, sd = 2),
    rnorm(n = 6, mean = 21, sd = 1),
    rnorm(n = 2, mean = 15, sd = 1),
    rnorm(n = 2, mean = 15, sd = 2)
  )
)

data

# Calculate protein abundances
protein_abundance &lt;- calculate_protein_abundance(
  data,
  sample = sample,
  protein_id = protein_id,
  precursor = precursor,
  peptide = peptide,
  intensity_log2 = intensity,
  method = "sum",
  for_plot = FALSE
)

protein_abundance

# Calculate protein abundances and retain precursor
# abundances that can be used in a peptide profile plot
complete_abundances &lt;- calculate_protein_abundance(
  data,
  sample = sample,
  protein_id = protein_id,
  precursor = precursor,
  peptide = peptide,
  intensity_log2 = intensity,
  method = "sum",
  for_plot = TRUE
)

complete_abundances

</code></pre>


</div>