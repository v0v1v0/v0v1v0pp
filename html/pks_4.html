<div class="container">

<table style="width: 100%;"><tr>
<td>blim</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>Basic Local Independence Models (BLIMs)</h2>

<h3>Description</h3>

<p>Fits a basic local independence model (BLIM) for probabilistic
knowledge structures by minimum discrepancy maximum likelihood estimation.
</p>


<h3>Usage</h3>

<pre><code class="language-R">blim(K, N.R, method = c("MD", "ML", "MDML"), R = as.binmat(N.R),
     P.K = rep(1/nstates, nstates),
     beta = rep(0.1, nitems), eta = rep(0.1, nitems),
     betafix = rep(NA, nitems), etafix = rep(NA, nitems),
     betaequal = NULL, etaequal = NULL,
     randinit = FALSE, incradius = 0,
     tol = 1e-07, maxiter = 10000, zeropad = 16)

blimMD(K, N.R, R = as.binmat(N.R),
       betafix = rep(NA, nitems), etafix = rep(NA, nitems),
       incrule = c("minimum", "hypblc1", "hypblc2"), m = 1)

## S3 method for class 'blim'
anova(object, ..., test = c("Chisq", "none"))
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>K</code></td>
<td>
<p>a state-by-problem indicator matrix representing the knowledge
structure.  An element is one if the problem is contained in the state,
and else zero.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>N.R</code></td>
<td>
<p>a (named) vector of absolute frequencies of response patterns.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>method</code></td>
<td>
<p><code>MD</code> for minimum discrepancy estimation, <code>ML</code> for
maximum likelihood estimation, <code>MDML</code> for minimum discrepancy
maximum likelihood estimation.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>R</code></td>
<td>
<p>a person-by-problem indicator matrix of unique response patterns.
Per default inferred from the names of <code>N.R</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>P.K</code></td>
<td>
<p>the vector of initial parameter values for probabilities of
knowledge states.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>beta, eta</code></td>
<td>
<p>vectors of initial parameter values for probabilities of a
careless error and a lucky guess, respectively.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>betafix, etafix</code></td>
<td>
<p>vectors of fixed error and guessing parameter values;
<code>NA</code> indicates a free parameter.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>betaequal, etaequal</code></td>
<td>
<p>lists of vectors of problem indices; each vector
represents an equivalence class: it contains the indices of problems for
which the error or guessing parameters are constrained to be equal.  (See
Examples.)</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>randinit</code></td>
<td>
<p>logical, if <code>TRUE</code> then initial parameter values are
sampled uniformly with constraints.  (See Details.)</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>incradius</code></td>
<td>
<p>include knowledge states of distance from the minimum
discrepant states less than or equal to <code>incradius</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>tol</code></td>
<td>
<p>tolerance, stopping criterion for iteration.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>maxiter</code></td>
<td>
<p>the maximum number of iterations.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>zeropad</code></td>
<td>
<p>the maximum number of items for which an incomplete
<code>N.R</code> vector is completed and padded with zeros.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>incrule</code></td>
<td>
<p>inclusion rule for knowledge states.  (See Details.)</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>m</code></td>
<td>
<p>exponent for hyperbolic inclusion rules.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>object</code></td>
<td>
<p>an object of class <code>blim</code>, typically the result of a
call to <code>blim</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>test</code></td>
<td>
<p>should the p-values of the chi-square distributions be
reported?</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>...</code></td>
<td>
<p>additional arguments passed to other methods.</p>
</td>
</tr>
</table>
<h3>Details</h3>

<p>See Doignon and Falmagne (1999) for details on the basic local independence
model (BLIM) for probabilistic knowledge structures.
</p>
<p>Minimum discrepancy (MD) minimizes the number of expected response errors
(careless errors or lucky guesses). Maximum likelihood maximizes the
likelihood, possibly at the expense of inflating the error and guessing
parameters.  Minimum discrepancy maximum likelihood (MDML) maximizes the
likelihood subject to the constraint of minimum response errors.  See Heller
and Wickelmaier (2013) for details on the parameter estimation methods.
</p>
<p>If <code>randinit</code> is <code>TRUE</code>, initial parameter values are sampled
uniformly with the constraint <code>beta + eta &lt; 1</code> (Weisstein, 2013) for
the error parameters, and with <code>sum(P.K) == 1</code> (Rubin, 1981) for the
probabilities of knowledge states. Setting <code>randinit</code> to <code>TRUE</code>
overrides any values given in the <code>P.K</code>, <code>beta</code>, and <code>eta</code>
arguments.
</p>
<p>The degrees of freedom in the goodness-of-fit test are calculated as number
of possible response patterns minus one or number of respondents, whichever
is smaller, minus number of parameters.
</p>
<p><code>blimMD</code> uses minimum discrepancy estimation only.  Apart from the
hyperbolic inclusion rules, all of its functionality is also provided by
<code>blim</code>.  It may be removed in the future.
</p>


<h3>Value</h3>

<p>An object of class <code>blim</code> having the following components:
</p>
<table>
<tr style="vertical-align: top;">
<td><code>discrepancy</code></td>
<td>
<p>the mean minimum discrepancy between response patterns
and knowledge states.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>P.K</code></td>
<td>
<p>the vector of estimated parameter values for probabilities of
knowledge states.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>beta</code></td>
<td>
<p>the vector of estimated parameter values for probabilities of
a careless error.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>eta</code></td>
<td>
<p>the vector of estimated parameter values for probabilities of a
lucky guess.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>disc.tab</code></td>
<td>
<p>the minimum discrepancy distribution.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>K</code></td>
<td>
<p>the knowledge structure.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>N.R</code></td>
<td>
<p>the vector of frequencies of response patterns.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>nitems</code></td>
<td>
<p>the number of items.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>nstates</code></td>
<td>
<p>the number of knowledge states.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>npatterns</code></td>
<td>
<p>the number of response patterns.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>ntotal</code></td>
<td>
<p>the number of respondents.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>nerror</code></td>
<td>
<p>the number of response errors.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>npar</code></td>
<td>
<p>the number of parameters.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>method</code></td>
<td>
<p>the parameter estimation method.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>iter</code></td>
<td>
<p>the number of iterations needed.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>loglik</code></td>
<td>
<p>the log-likelihood.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>fitted.values</code></td>
<td>
<p>the fitted response frequencies.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>goodness.of.fit</code></td>
<td>
<p>the goodness of fit statistic including the
likelihood ratio fitted vs. saturated model (G2), the degrees of
freedom, and the p-value of the corresponding chi-square distribution.
(See Details.)</p>
</td>
</tr>
</table>
<h3>References</h3>

<p>Doignon, J.-P., &amp; Falmagne, J.-C. (1999).
<em>Knowledge spaces</em>. Berlin: Springer.
</p>
<p>Heller, J., &amp; Wickelmaier, F. (2013).
Minimum discrepancy estimation in probabilistic knowledge structures.
<em>Electronic Notes in Discrete Mathematics</em>, <b>42</b>, 49–56.
<a href="https://doi.org/10.1016/j.endm.2013.05.145">doi:10.1016/j.endm.2013.05.145</a>
</p>
<p>Rubin, D.B. (1981). The Bayesian bootstrap.
<em>The Annals of Statistics</em>, <b>9</b>(1), 130–134.
<a href="https://doi.org/10.1214/aos/1176345338">doi:10.1214/aos/1176345338</a>
</p>
<p>Weisstein, E.W. (2013, August 29). Triangle point picking.
In <em>MathWorld – A Wolfram Web Resource</em>.
Retrieved from
<a href="https://mathworld.wolfram.com/TrianglePointPicking.html">https://mathworld.wolfram.com/TrianglePointPicking.html</a>.
</p>


<h3>See Also</h3>

<p><code>simulate.blim</code>, <code>plot.blim</code>,
<code>residuals.blim</code>, <code>logLik.blim</code>,
<code>delineate</code>, <code>jacobian</code>, <code>endm</code>,
<code>probability</code>, <code>chess</code>.
</p>


<h3>Examples</h3>

<pre><code class="language-R">data(DoignonFalmagne7)
K   &lt;- DoignonFalmagne7$K    # knowledge structure
N.R &lt;- DoignonFalmagne7$N.R  # frequencies of response patterns

## Fit basic local independence model (BLIM) by different methods
blim(K, N.R, method = "MD")    # minimum discrepancy estimation
blim(K, N.R, method = "ML")    # maximum likelihood estimation by EM
blim(K, N.R, method = "MDML")  # MDML estimation

## Parameter restrictions: beta_a = beta_b = beta_d, beta_c = beta_e
##                          eta_a =  eta_b = 0.1
m1 &lt;- blim(K, N.R, method = "ML",
           betaequal = list(c(1, 2, 4), c(3, 5)),
              etafix = c(0.1, 0.1, NA, NA, NA))
m2 &lt;- blim(K, N.R, method = "ML")
anova(m1, m2)

## See ?endm, ?probability, and ?chess for further examples.
</code></pre>


</div>