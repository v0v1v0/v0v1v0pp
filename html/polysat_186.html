<div class="container">

<table style="width: 100%;"><tr>
<td>write.POPDIST</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>
Write Genotypes to a POPDIST File
</h2>

<h3>Description</h3>

<p><code>write.POPDIST</code> uses data from a <code>"genambig"</code> object to write
a file formatted for the software POPDIST.
</p>


<h3>Usage</h3>

<pre><code class="language-R">write.POPDIST(object, samples = Samples(object),
              loci = Loci(object), file = "")
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>object</code></td>
<td>

<p>A <code>"genambig"</code> object.  <code>Ploidies</code> and <code>PopInfo</code> are
required, and if provided <code>Usatnts</code> may be used to convert alleles
to repeat number in order to represent each allele with two digits.
Locus names and <code>PopNames</code> are used in the file, but sample
names are not.
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>samples</code></td>
<td>

<p>An optional character vector of samples to use.  Must be a subset of
<code>Samples(object)</code>.
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>loci</code></td>
<td>

<p>An optional character vector of loci to use.  Must be a subset of
<code>Loci(object)</code>.
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>file</code></td>
<td>

<p>Character string.  File path to which to write.
</p>
</td>
</tr>
</table>
<h3>Details</h3>

<p>POPDIST is a program that calculates inter-population distance measures,
some of which are available for polyploid samples with allele copy
number ambiguity.  Each population must be of uniform ploidy, but
different populations may have different ploidies.
</p>
<p>Two types of warning messages may be printed by <code>write.POPDIST</code>.
The first indicates that a population contains individuals of more than
one ploidy.  In this case a file is still written, but POPDIST may not
be able to read it.  Separate populations with different ploidies are
okay.  The second type of warning indicates that an individual has more
alleles than its ploidy level.  If this occurs, alleles are randomly
removed from the genotype that is written to the file.
</p>
<p>If necessary, <code>write.POPDIST</code> converts alleles into a two-digit
format, similarly to <code>write.Tetrasat</code>.  If the value of any allele
for a given locus is greater than 99, the function first checks to see
if the locus has a <code>Usatnts</code> value greater than 1, and if so
divides all alleles by this value and rounds down.  If the locus still
has alleles with more than two digits, a multiple of 10 is subtracted
from all alleles.  A zero is placed in front of any allele with one digit.
</p>


<h3>Value</h3>

<p>A file is written but no value is returned.
</p>


<h3>Author(s)</h3>

<p>Lindsay V. Clark
</p>


<h3>References</h3>

<p>Tomiuk, J., Guldbrandtsen, B. and Loeschcke, B.  (2009)  Genetic
similarity of polyploids: a new version of the computer program POPDIST
(version 1.2.0) considers intraspecific genetic differentiation.
<em>Molecular Ecology Resources</em> <b>9</b>, 1364-1368.
</p>
<p>Guldbrandtsen, B., Tomiuk, J. and Loeschcke, B.  (2000) POPDIST version
1.1.1: A program to calculate population genetic distance and identity
measures.  <em>Journal of Heredity</em> <b>91</b>, 178â€“179.
</p>


<h3>See Also</h3>

<p><code>read.POPDIST</code>, <code>write.Tetrasat</code>,
<code>write.ATetra</code>, <code>write.SPAGeDi</code>,
<code>write.GenoDive</code>, <code>write.Structure</code>,
<code>write.GeneMapper</code>
</p>


<h3>Examples</h3>

<pre><code class="language-R"># create a "genambig" object containing the dataset
mygen &lt;- new("genambig", samples=c("a", "b", "c", "d"),
             loci=c("loc1", "loc27"))
mygen &lt;- reformatPloidies(mygen, output="sample")
Description(mygen) &lt;- "Some example data for POPDIST"
PopInfo(mygen) &lt;- c(1,1,2,2)
PopNames(mygen) &lt;- c("Old Orchard Beach", "York Beach")
Ploidies(mygen) &lt;- c(2,2,4,4)
Usatnts(mygen) &lt;- c(2,2)
Genotypes(mygen, loci="loc1") &lt;- list(c(128, 134), c(130),
                                      Missing(mygen), c(126, 128, 132))
Genotypes(mygen, loci="loc27") &lt;- list(c(209,211), c(207,217),
                                       c(207,209,215,221), c(211,223))

## Not run: 
# write the file
write.POPDIST(mygen, file="forPOPDIST.txt")

# view the file
cat(readLines("forPOPDIST.txt"), sep="\n")

## End(Not run)


</code></pre>


</div>