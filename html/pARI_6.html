<div class="container">

<table style="width: 100%;"><tr>
<td>pARIbrain</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>Permutation-based All-Resolutions Inference for brain imaging.</h2>

<h3>Description</h3>

<p>The main function for All-Resolutions Inference (ARI) method based on the critical vector constructed 
using the <code class="reqn">p</code>-values permutation distribution. The function computes simultaneous lower bounds for the number of true discoveries 
for each set of hypotheses specified in <code>ix</code> controlling family-wise error rate at level <code>alpha</code>.
</p>


<h3>Usage</h3>

<pre><code class="language-R">pARIbrain(copes, thr=NULL, mask=NULL, alpha=.05, clusters = NULL, 
alternative = "two.sided", summary_stat=c("max", "center-of-mass"),
silent=FALSE, family = "simes", delta = 0, B = 1000, rand = FALSE, 
iterative = FALSE, approx = TRUE, ncomb = 100, step.down = FALSE, max.step = 10, ...)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>copes</code></td>
<td>
<p>List of NIfTI file. The list of copes, i.e., contrasts maps, one for each subject used to compute the statistical tests.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>thr</code></td>
<td>
<p>Numeric value. Threshold used to construct the cluster map. Default to <code>NULL</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>mask</code></td>
<td>
<p>NIfTI file or character string. 3D array of logical values (i.e. <code>TRUE/FALSE</code> in/out of the brain). 
Alternatively it may be a (character) NIfTI file name. If <code>mask=NULL</code>, it is assumed that none of the voxels have to be excluded.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>alpha</code></td>
<td>
<p>Numeric value in '[0,1]'. <code class="reqn">\alpha</code> level to control the family-wise error rate. Default to 0.05.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>clusters</code></td>
<td>
<p>NIfTI file or character string. 3D array of cluster ids (0 when voxel does not belong to any cluster) or a (character) NIfTI file name. 
If <code>cluster=NULL</code> the cluster map is computed by the <code>cluster_threshold</code> function with threshold equals <code>thr</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>alternative</code></td>
<td>
<p>Character string. It refers to the alternative hypothesis, must be one of <code>"two.sided"</code> (default), <code>"greater"</code> or <code>"lower"</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>summary_stat</code></td>
<td>
<p>Character string. Choose among <code>=c("max", "center-of-mass")</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>silent</code></td>
<td>
<p>Boolean value. Default to <code>FALSE</code>. If <code>TRUE</code> the function prints the results.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>family</code></td>
<td>
<p>String character. Name of the family confidence envelope to compute the critical vector 
from <code>"simes"</code>, <code>"aorc"</code>, <code>"beta"</code>, <code>"higher.criticism"</code>, and <code>"power"</code>.
Default to "simes".</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>delta</code></td>
<td>
<p>Numeric value. <code class="reqn">\delta</code> value. Please see the reference below. Default to 0.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>B</code></td>
<td>
<p>Numeric value. Number of permutations, default to 1000.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>rand</code></td>
<td>
<p>Boolean value. Default to <code>FALSE</code>. If <code>rand = TRUE</code>, the <code class="reqn">p</code>-values are computed by <code>rowRanks</code>. Please see <code>signTest</code></p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>iterative</code></td>
<td>
<p>Boolean value. If <code>iterative = TRUE</code>, the iterative method is applied (computationally demanding). Default to <code>FALSE</code>. Please see the reference below.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>approx</code></td>
<td>
<p>Boolean value. Default to <code>TRUE</code>. If you are analyzing high dimensional data, we suggest to put <code>approx = TRUE</code> to speed up the computation time. Please see the reference below.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>ncomb</code></td>
<td>
<p>Numeric value. If <code>approx = TRUE</code>, you must decide how many random sub collections (level of approximation) considered. Default to 100.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>step.down</code></td>
<td>
<p>Boolean value. Default to <code>FALSE</code> If you want to compute the lambda calibration parameter using the step-down approach put <code>TRUE</code>. Please see the reference below.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>max.step</code></td>
<td>
<p>Numeric value. Default to 10. Maximum number of steps for the step down approach, so useful when <code>step.down = TRUE</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>...</code></td>
<td>
<p>further arguments. See <code>signTest</code>.</p>
</td>
</tr>
</table>
<h3>Value</h3>

<p>A list with elements:
</p>

<dl>
<dt>out</dt>
<dd>
<p>Data.frame containing the size, the number of false null hypotheses, the number of true null hypotheses, the lower bound for the true discovery proportion, and other statistics for each cluster.</p>
</dd>
<dt>clusters</dt>
<dd>
<p>Matrix describing the clusters analyzed.</p>
</dd>
</dl>
<h3>Author(s)</h3>

<p>Angela Andreella
</p>


<h3>References</h3>

<p>For the general framework of All-Resolutions Inference see:
</p>
<p>Goeman, Jelle J., and Aldo Solari. "Multiple testing for exploratory research." Statistical Science 26.4 (2011): 584-597.
</p>
<p>For All-Resolutions Inference for functional Magnetic Resonance Imaging data see: 
</p>
<p>Rosenblatt, Jonathan D., et al. "All-resolutions inference for brain imaging." Neuroimage 181 (2018): 786-796.
</p>
<p>For permutation-based All-Resolutions Inference see:
</p>
<p>Andreella, A., Hemerik, J., Finos, L., Weeda, W., &amp; Goeman, J. (2023). Permutation-based true discovery proportions for functional magnetic resonance imaging cluster analysis. Statistics in Medicine, 42(14), 2311-2340.
</p>


<h3>See Also</h3>

<p><code>signTest</code>, <code>lambdaOpt</code>,  <code>criticalVector</code>
</p>


<h3>Examples</h3>

<pre><code class="language-R">## Not run: 
library(remotes)
install_github("angeella/fMRIdata")
library(fMRIdata)
data(Auditory_clusterTH3_2)
data(Auditory_copes)
data(Auditory_mask)
auditory_out &lt;- pARIbrain(copes = Auditory_copes, 
clusters = Auditory_clusterTH3_2, mask = Auditory_mask, 
alpha = 0.05, silent = TRUE)
auditory_out$out

## End(Not run)
</code></pre>


</div>