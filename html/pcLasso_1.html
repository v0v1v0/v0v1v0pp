<div class="container">

<table style="width: 100%;"><tr>
<td>cv.pcLasso</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>Cross-validation for pcLasso</h2>

<h3>Description</h3>

<p>Does <code>k</code>-fold cross-validation for <code>pcLasso</code>.
</p>


<h3>Usage</h3>

<pre><code class="language-R">cv.pcLasso(x, y, w = rep(1, length(y)), ratio = NULL, theta = NULL,
  groups = vector("list", 1), family = "gaussian", nfolds = 10,
  foldid = NULL, keep = FALSE, verbose = FALSE, ...)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>x</code></td>
<td>
<p><code>x</code> matrix as in <code>pcLasso</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>y</code></td>
<td>
<p><code>y</code> matrix as in <code>pcLasso</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>w</code></td>
<td>
<p>Observation weights. Default is 1 for each observation.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>ratio</code></td>
<td>
<p>Ratio of shrinkage between the second and first principal components
in the absence of the <code class="reqn">\ell_1</code> penalty. More convenient way to specify the
strength of the quadratic penalty. A value between 0 and 1 (only 1 included).
<code>ratio = 1</code> corresponds to the lasso, 0.5-0.9 are good values to use.
Default is <code>NULL</code>. Exactly one of <code>ratio</code> or <code>theta</code> must be
specified.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>theta</code></td>
<td>
<p>Multiplier for the quadratic penalty: a non-negative real number.
<code>theta = 0</code> corresponds to the lasso, and larger <code>theta</code> gives
strong shrinkage toward the top principal components. Default is <code>NULL</code>.
Exactly one of <code>ratio</code> or <code>theta</code> must be specified.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>groups</code></td>
<td>
<p>A list describing which features belong in each group. The
length of the list should be equal to the number of groups, with
<code>groups[[k]]</code> being a vector of feature/column numbers which belong to
group k. Each feature must be assigned to at least one group. Features can
belong to more than one group. By default, all the features belong to a
single group.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>family</code></td>
<td>
<p>Response type. Either <code>"gaussian"</code> (default) for linear
regression or <code>"binomial"</code> for logistic regression.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>nfolds</code></td>
<td>
<p>Number of folds for CV (default is 10). Although <code>nfolds</code>
can be as large as the sample size (leave-one-out CV), it is not recommended
for large datasets. Smallest value allowable is <code>nfolds = 3</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>foldid</code></td>
<td>
<p>An optional vector of values between 1 and <code>nfold</code>
identifying what fold each observation is in. If supplied, <code>nfold</code> can
be missing.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>keep</code></td>
<td>
<p>If <code>keep = TRUE</code>, a prevalidated array is returned
containing fitted values for each observation at each value of lambda. This
means these fits are computed with this observation and the rest of its fold
omitted. Default is <code>FALSE</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>verbose</code></td>
<td>
<p>Print out progess along the way? Default is <code>FALSE</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>...</code></td>
<td>
<p>Other arguments that can be passed to <code>pcLasso</code>.</p>
</td>
</tr>
</table>
<h3>Details</h3>

<p>This function runs <code>pcLasso nfolds+1</code> times: the first to get the
<code>lambda</code> sequence, and the remaining <code>nfolds</code> times to compute the
fit with each of the folds omitted. The error is accumulated, and the mean
error and standard deviation over the folds is compued. Note that
<code>cv.pcLasso</code> does NOT search for values of <code>theta</code> or <code>ratio</code>.
A specific value of <code>theta</code> or <code>ratio</code> should be supplied.
</p>


<h3>Value</h3>

<p>An object of class <code>"cv.pcLasso"</code>, which is a list with the
ingredients of the cross-validation fit.
</p>
<table>
<tr style="vertical-align: top;">
<td><code>glmfit</code></td>
<td>
<p>A fitted <code>pcLasso</code> object for the full data.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>theta</code></td>
<td>
<p>Value of <code>theta</code> used in model fitting.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>lambda</code></td>
<td>
<p>The values of <code>lambda</code> used in the fits.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>nzero</code></td>
<td>
<p>If the groups overlap, the number of non-zero coefficients
in the model <code>glmfit</code> for the expanded feature space, at each value of
<code>lambda</code>. Otherwise, the number of non-zero coefficients in the model
<code>glmfit</code> for the original feature space.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>orignzero</code></td>
<td>
<p>If the groups are overlapping, this is the number of
non-zero coefficients in the model <code>glmfit</code> for the original feature
space, at each <code>lambda</code>. If groups are not overlapping, it is
<code>NULL</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>fit.preval</code></td>
<td>
<p>If <code>keep=TRUE</code>, this is the array of prevalidated
fits.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>cvm</code></td>
<td>
<p>The mean cross-validated error: a vector of length
<code>length(lambda)</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>cvse</code></td>
<td>
<p>Estimate of standard error of <code>cvm</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>cvlo</code></td>
<td>
<p>Lower curve = <code>cvm - cvsd</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>cvup</code></td>
<td>
<p>Upper curve = <code>cvm + cvsd</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>lambda.min</code></td>
<td>
<p>The value of <code>lambda</code> that gives minimum
<code>cvm</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>lambda.1se</code></td>
<td>
<p>The largest value of <code>lambda</code> such that the CV
error is within one standard error of the minimum.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>foldid</code></td>
<td>
<p>If <code>keep=TRUE</code>, the fold assignments used.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>name</code></td>
<td>
<p>Name of error measurement used for CV.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>call</code></td>
<td>
<p>The call that produced this object.</p>
</td>
</tr>
</table>
<h3>See Also</h3>

<p><code>pcLasso</code> and <code>plot.cv.pcLasso</code>.
</p>


<h3>Examples</h3>

<pre><code class="language-R">set.seed(1)
x &lt;- matrix(rnorm(100 * 20), 100, 20)
y &lt;- rnorm(100)
groups &lt;- vector("list", 4)
for (k in 1:4) {
    groups[[k]] &lt;- 5 * (k-1) + 1:5
}
cvfit1 &lt;- cv.pcLasso(x, y, groups = groups, ratio = 0.8)

# change no. of CV folds
cvfit2 &lt;- cv.pcLasso(x, y, groups = groups, ratio = 0.8, nfolds = 5)
# specify which observations are in each fold
foldid &lt;- sample(rep(seq(5), length = length(y)))
cvfit3 &lt;- cv.pcLasso(x, y, groups = groups, ratio = 0.8, foldid = foldid)

# keep=TRUE to have pre-validated fits and foldid returned
cvfit4 &lt;- cv.pcLasso(x, y, groups = groups, ratio = 0.8, keep = TRUE)

</code></pre>


</div>