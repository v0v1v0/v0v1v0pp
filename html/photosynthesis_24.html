<div class="container">

<table style="width: 100%;"><tr>
<td>fit_aq_response2</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>Fit photosynthetic light-response curves</h2>

<h3>Description</h3>

<p>We recommend using <code>fit_photosynthesis()</code> with argument <code>.photo_fun = "aq_response"</code> rather than calling this function directly.
</p>


<h3>Usage</h3>

<pre><code class="language-R">fit_aq_response2(
  .data,
  .model = "default",
  .method = "ls",
  usealpha_Q = FALSE,
  alpha_Q = 0.84,
  quiet = FALSE,
  brm_options = NULL
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>.data</code></td>
<td>
<p>A data frame containing plant ecophysiological data. See <code>required_variables()</code> for the variables required for each model.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>.model</code></td>
<td>
<p>A character string of model name to use. See <code>get_all_models()</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>.method</code></td>
<td>
<p>A character string of the statistical method to use: 'ls' for least-squares and 'brms' for Bayesian model using <code>brms::brm()</code>. Default is 'ls'.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>usealpha_Q</code></td>
<td>
<p>Flag. Should light intensity be multiplied by <code>alpha_Q</code> before fitting? Default is FALSE (i.e. assume that '.Q' is absorbed light).</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>alpha_Q</code></td>
<td>
<p>Number. Absorbance of incident light. Default value is 0.84. Ignored if <code>usealpha_Q = FALSE</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>quiet</code></td>
<td>
<p>Flag. Should messages be suppressed? Default is FALSE.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>brm_options</code></td>
<td>
<p>A list of options passed to <code>brms::brm()</code> if <code>.method = "brms"</code>. Default is NULL.</p>
</td>
</tr>
</table>
<h3>Value</h3>


<ul>
<li>
<p> If <code>.method = 'ls'</code>: an <code>stats::nls()</code> object.
</p>
</li>
<li>
<p> If <code>.method = 'brms'</code>: a <code>brms::brmsfit()</code> object.
</p>
</li>
</ul>
<h3>Note</h3>

<p>Rd fitted in this way is essentially the same as the Kok (1956) method, and
represents a respiration value in the light that may not be accurate.
Rd output should thus be interpreted more as a residual parameter to ensure
an accurate fit of the light response parameters. Model originally from
Marshall &amp; Biscoe (1980).
</p>


<h3>References</h3>

<p>Marshall B, Biscoe P. 1980. A model for C3 leaves describing the
dependence of net photosynthesis on irradiance. J Ex Bot 31:29-39
</p>


<h3>Examples</h3>

<pre><code class="language-R">

library(broom)
library(dplyr)
library(photosynthesis)

# Read in your data
dat = system.file("extdata", "A_Ci_Q_data_1.csv", package = "photosynthesis") |&gt;
  read.csv() |&gt;
  # Set grouping variable
  mutate(group = round(CO2_s, digits = 0)) |&gt;
  # For this example, round sequentially due to CO2_s set points
  mutate(group = as.factor(round(group, digits = -1)))

# Fit one light-response curve
fit = fit_photosynthesis(
  .data = filter(dat, group == 600),
  .photo_fun = "aq_response",
  .vars = list(.A = A, .Q = Qabs),
)

# The 'fit' object inherits class 'nls' and many methods can be used

## Model summary:
summary(fit)

## Estimated parameters:
coef(fit)

## 95% confidence intervals:
confint(fit)

## Tidy summary table using 'broom::tidy()'
tidy(fit, conf.int = TRUE, conf.level = 0.95)

# Fit multiple curves with **photosynthesis** and **purrr**

library(purrr)

fits = dat |&gt;
  split(~ group) |&gt;
  map(fit_photosynthesis, .photo_fun = "aq_response", .vars = list(.A = A, .Q = Qabs))



</code></pre>


</div>