<div class="container">

<table style="width: 100%;"><tr>
<td>powerNLSEM</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>powerNLSEM function</h2>

<h3>Description</h3>

<p>powerNLSEM function
</p>


<h3>Usage</h3>

<pre><code class="language-R">powerNLSEM(
  model,
  POI,
  method,
  test = "onesided",
  power_modeling_method = "probit",
  search_method = "adaptive",
  R = 2000,
  power_aim = 0.8,
  alpha = 0.05,
  alpha_power_modeling = 0.05,
  CORES = max(c(parallel::detectCores() - 2, 1)),
  verbose = TRUE,
  seed = NULL,
  ...
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>model</code></td>
<td>
<p>Model in lavaan syntax. See documentation for help and examples.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>POI</code></td>
<td>
<p>Parameter Of Interest as a vector of strings. Must be in lavaan-syntax without any spaces. Nonlinear effects should have the same ordering as in model.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>method</code></td>
<td>
<p>Method used to fit to the data. Implemented methods are <code>"LMS"</code> (Klein &amp; Moosbrugger, 2000) (requires an installation of <code>Mplus</code> and the <code>MplusAutomation</code> pacakge), <code>"UPI"</code> (Kelava &amp; Brandt, 2009, Marsh et al., 2004) for the unconstrained product indicator approach, <code>"FSR"</code> (Ng and Chan, 2020) for the naïve factor score approach, and <code>"SR"</code>, for using scale means (i.e., scale regression/path modeling).</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>test</code></td>
<td>
<p>Should the parameter be tested with a directed hypothesis (onesided) or with an undirected hypothesis (twosided, also equivalent to Wald-Test for single parameter). Default to <code>"onesided"</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>power_modeling_method</code></td>
<td>
<p>Power modeling method used to model significant parameter estimates. Default to <code>"probit"</code> indicating glm with probit link function with sqrt(n) as predictor. Alternative is <code>"logit"</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>search_method</code></td>
<td>
<p>String stating the search method. Default to <code>"adaptive"</code> (synonyme is <code>"smart"</code>). Alternative is <code>"bruteforce"</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>R</code></td>
<td>
<p>Total number of models to be fitted. Higher number results in higher precision and longer runtime. Default to 2000.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>power_aim</code></td>
<td>
<p>Minimal power value to approximate. Default to <code>.8</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>alpha</code></td>
<td>
<p>Type I-error rate for significance decision. Default to <code>.05</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>alpha_power_modeling</code></td>
<td>
<p>Type I-error rate for confidence band around predicted power rate. Used to ensure that the computed <code>N</code> keeps the desired power value (with the given Type I-error rate <code>alpha_power_modeling</code> divided by 2). If set to 1, no confidence band is used. Default to <code>.05</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>CORES</code></td>
<td>
<p>Number of cores used for parallelization. Default to number of available cores - 2.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>verbose</code></td>
<td>
<p>Logical whether progress should be printed in console. Default to <code>TRUE</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>seed</code></td>
<td>
<p>Seed for replicability. Default to <code>NULL</code>, then a seed is drawn at random, which will also be saved in the output.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>...</code></td>
<td>
<p>Additional arguments passed on to the search functions.</p>
</td>
</tr>
</table>
<h3>Value</h3>

<p>Returns an list object of class <code>powerNLSEM</code>.
</p>


<h3>References</h3>

<p>Klein, A. G., &amp; Moosbrugger, H. (2000). Maximum likelihood estimation of latent interaction effects with the LMS method. <em>Psychometrika, 65</em>(4), 457–474. <a href="https://doi.org/10.1007/BF02296338">doi:10.1007/BF02296338</a>
</p>
<p>Kelava, A., &amp; Brandt, H. (2009). Estimation of nonlinear latent structural equation models using the extended unconstrained approach. <em>Review of Psychology, 16</em>(2), 123–132.
</p>
<p>Lin, G. C., Wen, Z., Marsh, H. W., &amp; Lin, H. S. (2010). Structural equation models of latent interactions: Clarification of orthogonalizing and double-mean-centering strategies. <em>Structural Equation Modeling, 17</em>(3), 374–391. <a href="https://doi.org/10.1080/10705511.2010.488999">doi:10.1080/10705511.2010.488999</a>
</p>
<p>Little, T. D., Bovaird, J. A., &amp; Widaman, K. F. (2006). On the merits of orthogonalizing powered and product terms: Implications for modeling interactions among latent variables. <em>Structural Equation Modeling, 13</em>(4), 497–519. <a href="https://doi.org/10.1207/s15328007sem1304_1">doi:10.1207/s15328007sem1304_1</a>
</p>
<p>Marsh, H. W., Wen, Z. &amp; Hau, K. T. (2004). Structural equation models of latent interactions: Evaluation of alternative estimation strategies and indicator construction. <em>Psychological Methods, 9</em>(3), 275–300. <a href="https://doi.org/10.1037/1082-989X.9.3.275">doi:10.1037/1082-989X.9.3.275</a>
</p>
<p>Ng, J. C. K., &amp; Chan, W. (2020). Latent moderation analysis: A factor score approach. <em>Structural Equation Modeling: A Multidisciplinary Journal, 27</em>(4), 629–648. <a href="https://doi.org/10.1080/10705511.2019.1664304">doi:10.1080/10705511.2019.1664304</a>.
</p>
<p>Irmer, J. P., Klein, A. G., &amp; Schermelleh-Engel, K. (2024a). A General Model-Implied Simulation-Based Power Estimation Method for Correctly and Misspecfied Models: Applications to Nonlinear and Linear Structural Equation Models. <em>Behavior Research Methods.</em>  <a href="https://doi.org/10.31219/osf.io/pe5bj">doi:10.31219/osf.io/pe5bj</a>
</p>
<p>Irmer, J. P., Klein, A. G., &amp; Schermelleh-Engel, K. (2024b). Estimating Power in Complex Nonlinear Structural Equation Modeling Including Moderation Effects: The <code style="white-space: pre;">⁠powerNLSEM R⁠</code>-Package. <em>Behavior Research Methods.</em> <a href="https://doi.org/10.3758/s13428-024-02476-3">doi:10.3758/s13428-024-02476-3</a>
</p>


<h3>See Also</h3>

<p>For further details for specific uses see corresponding functions: <code>power_search()</code> for all inputs possible, <code>UPI()</code> for specifics for the unconstrained product indicator approach, <code>LMS()</code> for the latent moderated structural equations approach, <code>FSR()</code> for factor score approaches, <code>SR()</code> for scale regression approaches.
</p>


<h3>Examples</h3>

<pre><code class="language-R">
# write model in lavaan syntax
model &lt;- "
# measurement models
          X =~ 1*x1 + 0.8*x2 + 0.7*x3
          Y =~ 1*y1 + 0.85*y2 + 0.78*y3
          Z =~ 1*z1 + 0.9*z2 + 0.6*z3

# structural models
          Y ~ 0.3*X + .2*Z +  .2*X:Z

# residual variances
         Y~~.7975*Y
         X~~1*X
         Z~~1*Z

# covariances
         X~~0.5*Z

# measurement error variances
         x1~~.1*x1
         x2~~.2*x2
         x3~~.3*x3
         z1~~.2*z1
         z2~~.3*z2
         z3~~.4*z3
         y1~~.5*y1
         y2~~.4*y2
         y3~~.3*y3
"
# run model-implied simulation-based power estimation
# for the effects: c("Y~X", "Y~Z", "Y~X:Z")
Result_Power &lt;- powerNLSEM(model = model, POI = c("Y~X", "Y~Z", "Y~X:Z"),
                           method = "UPI", search_method = "adaptive",
                           steps = 10, power_modeling_method = "probit",
                           R = 1000, power_aim = .8, alpha = .05,
                           alpha_power_modeling = .05,
                           CORES = 1, seed = 2024)

Result_Power


</code></pre>


</div>