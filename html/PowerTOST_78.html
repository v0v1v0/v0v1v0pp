<div class="container">

<table style="width: 100%;"><tr>
<td>sampleN.TOST</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>
Sample size based on power of TOST
</h2>

<h3>Description</h3>

<p>Estimates the necessary sample size to obtain at least a target (desired) power.
</p>


<h3>Usage</h3>

<pre><code class="language-R">sampleN.TOST(alpha = 0.05, targetpower = 0.8, logscale = TRUE,
             theta0, theta1, theta2, CV, design = "2x2",
             method = "exact", robust = FALSE, print = TRUE,
             details = FALSE, imax=100)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>alpha</code></td>
<td>

<p>Significance level (one-sided). Commonly set to 0.05.
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>targetpower</code></td>
<td>

<p>Power to achieve at least. Must be &gt;0 and &lt;1.<br>
Typical values are 0.8 or 0.9.
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>logscale</code></td>
<td>

<p>Should the data used on log-transformed (<code>TRUE</code>) or on original
scale (<code>FALSE</code>)? Defaults to <code>TRUE</code>.
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>theta0</code></td>
<td>

<p>‘True’ or assumed T/R ratio or difference.<br>
In case of <code>logscale = TRUE</code> it must be given as ratio T/R.<br>
If <code>logscale = FALSE</code>, the difference in means. In this case, the difference may be expressed in two ways: relative to the same (underlying) reference mean, <em>i.e.</em>, as (T-R)/R = T/R - 1; or as difference in means T-R. Note that in the former case the units of <code>CV</code>, <code>theta1</code> and <code>theta2</code> need also be given relative to the reference mean (specified as ratio).<br>
Defaults to 0.95 if <code>logscale = TRUE</code> or to 0.05 if <code>logscale = FALSE</code>
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>theta1</code></td>
<td>

<p>Lower (bio-)equivalence limit.<br>
In case of <code>logscale = TRUE</code> it is given as ratio.<br>
If <code>logscale = FALSE</code>, the limit may be expressed in two ways:
difference of means relative to the same (underlying) reference mean or in units of the difference of means.
Note that in the former case the units of <code>CV</code>, <code>theta0</code> and <code>theta2</code> need also be given relative to the reference mean (specified as ratio).<br>
Defaults to 0.8 if <code>logscale = TRUE</code> or to -0.2 if <code>logscale = FALSE</code>.
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>theta2</code></td>
<td>

<p>Upper (bio-)equivalence limit.<br>
In case of <code>logscale = TRUE</code> it is given as ratio.
If <code>logscale = FALSE</code>, the limit may be expressed in two ways:
difference of means relative to the same (underlying) reference mean or in units of the difference of means.
Note that in the former case the units of <code>CV</code>, <code>theta0</code> and <code>theta1</code> need also be given relative to the reference mean (specified as ratio).<br>
If not given, <code>theta2</code> will be calculated as <code>1/theta1</code> if <code>logscale = TRUE</code> or as <code>-theta1</code> if <code>logscale = FALSE</code>.
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>CV</code></td>
<td>

<p>In case of <code>logscale=TRUE</code> the (geometric) coefficient of variation given as ratio.<br>
If <code>logscale=FALSE</code> the argument refers to (residual) standard deviation of the response. In this case, standard deviation may be expressed two ways: relative to a reference mean (specified as ratio sigma/muR), <em>i.e.</em>, again as a coefficient of variation; or untransformed, <em>i.e.</em>, as standard deviation of the response. Note that in the former case the units of <code>theta0</code>, <code>theta1</code> and <code>theta2</code> need also be given relative to the reference mean (specified as ratio).<br></p>
<p>In case of cross-over studies this is the within-subject CV, in case of a parallel-group design the CV of the total variability.
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>design</code></td>
<td>

<p>Character string describing the study design.<br>
See <code>known.designs()</code> for designs covered in this package.
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>method</code></td>
<td>

<p>Method for calculation of the power.<br>
Defaults to <code>"exact"</code> in which case the calculation is done based on formulas
with Owen’s Q. The calculation via Owen’s Q can also be choosen with
<code>method = "owenq"</code>.<br>
Another exact method via direct use of the bivariate non-central <em>t</em>-distribution
may be chosen with <code style="white-space: pre;">⁠method = "mvt"⁠</code>. This may have somewhat lower precision
compared to Owen’s Q and has a much longer run-time.<br>
Approximate calculations can be choosen via <code style="white-space: pre;">⁠method = "noncentral"⁠</code> or
<code style="white-space: pre;">⁠method = "nct"⁠</code> for the approximation using the non-central <em>t</em>-distribution.
With <code style="white-space: pre;">⁠method = "central"⁠</code> or <code style="white-space: pre;">⁠method = "shifted"⁠</code> the relatively crude
approximation via the ‘shifted’ central <em>t</em>-distribution is chosen.<br>
The strings for <code style="white-space: pre;">⁠method⁠</code> may be abbreviated.
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>robust</code></td>
<td>

<p>Defaults to <code>FALSE</code>. With that value the usual degrees of freedom will be used.<br>
Set to <code>TRUE</code> will use the degrees of freedom according to the ‘robust’ evaluation
(aka Senn’s basic estimator). These df are calculated as <code>n-seq</code>.<br>
See <code>known.designs()$df2</code> for designs covered in this package.<br>
Has only effect for higher-order crossover designs.
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>print</code></td>
<td>

<p>If <code>TRUE</code> (default) the function prints its results. If <code>FALSE</code> only the data frame with the results will be returned.
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>details</code></td>
<td>

<p>If <code>TRUE</code> the design characteristics and the steps during
sample size calculations will be shown. Defaults to <code>FALSE</code>.
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>imax</code></td>
<td>

<p>Maximum number of steps in sample size search.<br>
Defaults to 100. Adaption only in rare cases needed.<br></p>
</td>
</tr>
</table>
<h3>Details</h3>

<p>The sample size is estimated via iterative evaluation of power of the <abbr><span class="acronym">TOST</span></abbr> procedure.<br>
Start value for the sample size search is taken from a large sample approximation
according to Zhang, modified.<br>
The sample size is bound to 4 as minimum.<br><br>
The estimated sample size gives always the <em>total</em> number of subjects (not subject/sequence in crossovers or subjects/group in parallel designs – like in some other software packages).
</p>


<h3>Value</h3>

<p>A data frame with the input and results will be returned.<br>
The <code>Sample size</code> column contains the total sample size.
</p>


<h3>Warning</h3>

<p>The function does not vectorize properly.<br>
If you need sample sizes with varying CVs, use f.i. <code style="white-space: pre;">⁠for⁠</code>-loops or the <code style="white-space: pre;">⁠apply⁠</code>-family.
</p>


<h3>Note</h3>

<p>Of course it is highly recommended to use the default <code style="white-space: pre;">⁠method = "exact"⁠</code>. :-)<br>
There is no reason besides testing and for comparative purposes to use an
approximation if the exact method is available at no extra costs.
</p>


<h3>Author(s)</h3>

<p>D. Labes
</p>


<h3>References</h3>

<p>Phillips KF. <em>Power of the Two One-Sided Tests Procedure in Bioequivalence.</em> J Pharmacokin Biopharm. 1990;18:137–44. <a href="https://doi.org/10.1007/BF01063556">doi:10.1007/BF01063556</a>
</p>
<p>Diletti D, Hauschke D, Steinijans VW. <em>Sample Size Determination for Bioequivalence Assessment by Means of Confidence Intervals.</em> Int J Clin Pharmacol Ther Toxicol. 1991;29(1):1–8.
</p>
<p>Diletti D, Hauschke D, Steinijans VW. <em>Sample size determination: Extended tables for the multiplicative model and bioequivalence ranges of 0.9 to 1.11 and 0.7 to 1.43.</em> Int J Clin Pharmacol Ther Toxicol. 1992;30(Suppl 1):S59–62.
</p>
<p>Zhang P. <em>A Simple Formula for Sample Size Calculation in Equivalence Studies.</em> J Biopharm Stat. 2003;13(3):529–38. <a href="https://doi.org/10.1081/BIP-120022772">doi:10.1081/BIP-120022772</a>
</p>


<h3>See Also</h3>

<p><code>power.TOST, known.designs</code>
</p>


<h3>Examples</h3>

<pre><code class="language-R"># Exact calculation for a classical 2x2 cross-over (TR/RT),
# BE limits 80 ... 125%, assumed true BE ratio 0.95, intra-subject CV=30%,
# using all the default values
# should give n=40 power=0.815845
sampleN.TOST(CV = 0.3)

# Exact calculation for a parallel group design
# evaluation on the original (untransformed) scale
# BE limits 80 ... 120% = -20% ... +20% of reference,
# assumed true BE ratio 0.95% = -5% to reference mean,
# total CV=20%
# should give n=48 (total) power=0.815435
sampleN.TOST(logscale = FALSE, theta1 = -0.2, theta0 = -0.05,
             CV = 0.2, design = "parallel")

# A rather strange setting of theta0! Have a look at n.
# It would be better this is not the sample size but the running total
# of my bank account. But the first million is the hardest. ;-)
sampleN.TOST(CV = 0.2, theta0 = 0.8005)
</code></pre>


</div>