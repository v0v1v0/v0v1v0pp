<div class="container">

<table style="width: 100%;"><tr>
<td>plot_poppr_msn</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>Plot minimum spanning networks produced in poppr.</h2>

<h3>Description</h3>

<p>This function allows you to take the output of poppr.msn and bruvo.msn and 
customize the plot by labeling groups of individuals, size of nodes, and 
adjusting the palette and scale bar.
</p>


<h3>Usage</h3>

<pre><code class="language-R">plot_poppr_msn(
  x,
  poppr_msn,
  gscale = TRUE,
  gadj = 3,
  mlg.compute = "original",
  glim = c(0, 0.8),
  gweight = 1,
  wscale = TRUE,
  nodescale = 10,
  nodebase = NULL,
  nodelab = 2,
  inds = "ALL",
  mlg = FALSE,
  quantiles = TRUE,
  cutoff = NULL,
  palette = NULL,
  layfun = layout.auto,
  beforecut = FALSE,
  pop.leg = TRUE,
  size.leg = TRUE,
  scale.leg = TRUE,
  ...
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>x</code></td>
<td>
<p>a <code>genind</code>, <code>genclone</code>,
<code>genlight</code>, or <code>snpclone</code> object from
which <code>poppr_msn</code> was derived.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>poppr_msn</code></td>
<td>
<p>a <code>list</code> produced from either <code>poppr.msn</code> 
or <code>bruvo.msn</code>. This list should contain a graph, a vector of 
population names and a vector of hexadecimal color definitions for each 
population.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>gscale</code></td>
<td>
<p>"grey scale". If this is <code>TRUE</code>, this will scale the color
of the edges proportional to the observed distance, with the lines becoming
darker for more related nodes. See <code>greycurve</code> for details.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>gadj</code></td>
<td>
<p>"grey adjust". a positive <code>integer</code> greater than zero that
will serve as the exponent to the edge weight to scale the grey value to
represent that weight.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>mlg.compute</code></td>
<td>
<p>if the multilocus genotypes are set to "custom" (see 
<code>mll.custom</code> for details) in your genclone object, this will 
specify which mlg level to calculate the nodes from. See details.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>glim</code></td>
<td>
<p>"grey limit". Two numbers between zero and one. They determine 
the upper and lower limits for the <code>gray</code> function. Default is 0
(black) and 0.8 (20% black).</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>gweight</code></td>
<td>
<p>"grey weight". an <code>integer</code>. If it's 1, the grey scale
will be weighted to emphasize the differences between closely related nodes.
If it is 2, the grey scale will be weighted to emphasize the differences
between more distantly related nodes.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>wscale</code></td>
<td>
<p>"width scale". If this is <code>TRUE</code>, the edge widths will be 
scaled proportional to the inverse of the observed distance , with the 
lines becoming thicker for more related nodes.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>nodescale</code></td>
<td>
<p>a <code>numeric</code> indicating how to scale the node sizes (scales by area).</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>nodebase</code></td>
<td>
<p><strong>deprecated</strong> a <code>numeric</code> indicating what base logarithm should be
used to scale the node sizes. Defaults to 1.15. See details.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>nodelab</code></td>
<td>
<p>an <code>integer</code> specifying the smallest size of node to 
label. See details.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>inds</code></td>
<td>
<p>a <code>character</code> or <code>numeric</code> vector indicating which
samples or multilocus genotypes to label on the graph. See details.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>mlg</code></td>
<td>
<p><code>logical</code> When <code>TRUE</code>, the nodes will be labeled by
multilocus genotype. When <code>FALSE</code> (default), nodes will be labeled by
sample names.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>quantiles</code></td>
<td>
<p><code>logical</code>. When set to <code>TRUE</code> (default), the scale
bar will be composed of the quantiles from the observed edge weights. When 
set to <code>FALSE</code>, the scale bar will be composed of a smooth gradient 
from the minimum edge weight to the maximum edge weight.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>cutoff</code></td>
<td>
<p>a number indicating the longest distance to display in your 
graph. This is performed by removing edges with weights greater than this 
number.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>palette</code></td>
<td>
<p>a function or character corresponding to a specific palette 
you want to use to delimit your populations. The default is whatever 
palette was used to produce the original graph.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>layfun</code></td>
<td>
<p>a function specifying the layout of nodes in your graph. It 
defaults to <code>layout.auto</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>beforecut</code></td>
<td>
<p>if <code>TRUE</code>, the layout of the graph will be computed 
before any edges are removed with <code>cutoff</code>. If <code>FALSE</code> (Default),
the layout will be computed after any edges are removed.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>pop.leg</code></td>
<td>
<p>if <code>TRUE</code>, a legend indicating the populations will
appear in the top right corner of the graph, but will not overlap. Setting
<code>pop.leg = FALSE</code> disables this legend. See details.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>size.leg</code></td>
<td>
<p>if <code>TRUE</code>, a legend displyaing the number of samples per
node will appear either below the population legend or in the top right
corner of the graph. Setting <code>size.leg = FALSE</code> disables this legend.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>scale.leg</code></td>
<td>
<p>if <code>TRUE</code>, a scale bar indicating the distance will
appear under the graph. Setting <code>scale.leg = FALSE</code> suppresses this
bar. See details.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>...</code></td>
<td>
<p>any other parameters to be passed on to 
<code>plot.igraph</code>.</p>
</td>
</tr>
</table>
<h3>Details</h3>

<p>The previous incarnation of msn plotting in poppr simply plotted the
minimum spanning network with the legend of populations, but did not 
provide a scale bar and it did not provide the user a simple way of 
manipulating the layout or labels. This function allows the user to 
manipulate many facets of graph creation, making the creation of minimum 
spanning networks ever so slightly more user friendly. 
</p>
<p>This function must have both the source data and the output msn to work. 
The source data must contain the same population structure as the graph. 
Every other parameter has a default setting.
</p>


<h4>Parameter details</h4>

  
<ul>
<li> <p><code>inds</code> By default, the graph will label each node (circle) with
all of the samples (individuals) that are contained within that node. As
each node represents a single multilocus genotype (MLG) or individuals (n
&gt;= 1), this argument is designed to allow you to selectively label the
nodes based on query of sample name or MLG number. If the option <code>mlg
  = TRUE</code>, the multilocus genotype assignment will be used to label the node.
If you do not want to label the nodes by individual or multilocus genotype,
simply set this to a name that doesn't exist in your data.
</p>
</li>
<li> <p><code>nodescale</code> The nodes (circles) on the graph represent different
multilocus genotypes. The area of the nodes represent the number of
individuals. Setting nodescale will scale the area of the nodes.
</p>
</li>
<li> <p><code>nodelab</code> If a node is not labeled by individual, this will
label the size of the nodes greater than or equal to this value. If you
don't want to label the size of the nodes, simply set this to a very high
number.
</p>
</li>
<li> <p><code>cutoff</code> This is useful for when you want to investigate groups
of multilocus genotypes separated by a specific distance or if you have two
distinct populations and you want to physically separate them in your
network.
</p>
</li>
<li> <p><code>beforecut</code> This is an indicator useful if you want to maintain
the same position of the nodes before and after removing edges with the
<code>cutoff</code> argument. This works best if you set a seed before you run
the function.
</p>
</li>
</ul>
<h4>mlg.compute</h4>

<p>Each node on the graph represents a different multilocus genotype. 
The edges on the graph represent genetic distances that connect the
multilocus genotypes. In genclone objects, it is possible to set the
multilocus genotypes to a custom definition. This creates a problem for
clone correction, however, as it is very possible to define custom lineages
that are not monophyletic. When clone correction is performed on these
definitions, information is lost from the graph. To circumvent this, The
clone correction will be done via the computed multilocus genotypes, either
"original" or "contracted". This is specified in the <code>mlg.compute</code>
argument, above.</p>



<h4>legends</h4>

<p> To avoid drawing the legend over the graph, legends 
are separated by different plotting areas. This means that if legends are 
included, you cannot plot multiple MSNs in a single plot. The scale bar (to
be added in manually) can be obtained from <code>greycurve</code> and the
legend can be plotted with <code>legend</code>.</p>



<h3>Value</h3>

<p>the modified msn list, invisibly.
</p>


<h3>Author(s)</h3>

<p>Zhian N. Kamvar
</p>


<h3>See Also</h3>

<p><code>layout.auto</code> <code>plot.igraph</code>
<code>poppr.msn</code> <code>bruvo.msn</code> <code>greycurve</code>
<code>delete_edges</code> <code>palette</code>
</p>


<h3>Examples</h3>

<pre><code class="language-R"># Using a data set of the Aphanomyces eutieches root rot pathogen.
data(Aeut)
adist &lt;- diss.dist(Aeut, percent = TRUE)
amsn &lt;- poppr.msn(Aeut, adist, showplot = FALSE)

# Default
library("igraph") # To get all the layouts.
set.seed(500)
plot_poppr_msn(Aeut, amsn, gadj = 15)

## Not run: 

# Different layouts (from igraph) can be used by supplying the function name.
set.seed(500)
plot_poppr_msn(Aeut, amsn, gadj = 15, layfun = layout_with_kk)

# Removing link between populations (cutoff = 0.2) and labelling no individuals
set.seed(500)
plot_poppr_msn(Aeut, amsn, inds = "none", gadj = 15, beforecut = TRUE, cutoff = 0.2)

# Labelling individual #57 because it is an MLG that crosses populations
# Showing clusters of MLGS with at most 5% variation
# Notice that the Mt. Vernon population appears to be more clonal
set.seed(50) 
plot_poppr_msn(Aeut, amsn, gadj = 15, cutoff = 0.05, inds = "057")


data(partial_clone)
pcmsn &lt;- bruvo.msn(partial_clone, replen = rep(1, 10))

# You can plot using a color palette or a vector of named colors
# Here's a way to define the colors beforehand
pc_colors &lt;- nPop(partial_clone) %&gt;% 
  RColorBrewer::brewer.pal("Set2") %&gt;% 
  setNames(popNames(partial_clone))

pc_colors

# Labelling the samples contained in multilocus genotype 9
set.seed(999)
plot_poppr_msn(partial_clone, pcmsn, palette = pc_colors, inds = 9)

# Doing the same thing, but using one of the sample names as input.
set.seed(999)
plot_poppr_msn(partial_clone, pcmsn, palette = pc_colors, inds = "sim 20")

# Note that this is case sensitive. Nothing is labeled. 
set.seed(999)
plot_poppr_msn(partial_clone, pcmsn, palette = pc_colors, inds = "Sim 20")

# Something pretty
data(microbov)
mdist &lt;- diss.dist(microbov, percent = TRUE)
micmsn &lt;- poppr.msn(microbov, mdist, showplot = FALSE)

plot_poppr_msn(microbov, micmsn, palette = "terrain.colors", inds = "n", 
  quantiles = FALSE)
plot_poppr_msn(microbov, micmsn, palette = "terrain.colors", inds = "n", 
  cutoff = 0.3, quantiles = FALSE)
  
### Utilizing vectors for palettes

data(Pram)
Pram_sub &lt;- popsub(Pram, exclude = c("Nursery_CA", "Nursery_OR"))

# Creating the network for the forest
min_span_net_sub &lt;- bruvo.msn(Pram_sub, replen = other(Pram)$REPLEN, 
                              add = TRUE, loss = TRUE, showplot = FALSE, 
                              include.ties = TRUE)
                              
# Creating the network with nurseries
min_span_net     &lt;- bruvo.msn(Pram, replen = other(Pram)$REPLEN, 
                              add = TRUE, loss = TRUE, showplot = FALSE, 
                              include.ties = TRUE)

# Only forest genotypes
set.seed(70)
plot_poppr_msn(Pram,
               min_span_net_sub,
               inds = "ALL",
               mlg = TRUE,
               gadj = 9,
               nodescale = 5,
               palette = other(Pram)$comparePal,
               cutoff = NULL,
               quantiles = FALSE,
               beforecut = TRUE)

# With Nurseries
set.seed(70)
plot_poppr_msn(Pram,
               min_span_net,
               inds = "ALL",
               mlg = TRUE,
               gadj = 9,
               nodescale = 5,
               palette = other(Pram)$comparePal,
               cutoff = NULL,
               quantiles = FALSE,
               beforecut = TRUE)

## End(Not run)
</code></pre>


</div>