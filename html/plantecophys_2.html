<div class="container">

<table style="width: 100%;"><tr>
<td>Photosyn</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>Coupled leaf gas exchange model</h2>

<h3>Description</h3>

<p>A coupled photosynthesis - stomatal conductance model, based on the 
Farquhar model of photosynthesis, and a Ball-Berry type model of stomatal conductance. 
Includes options for temperature sensitivity of photosynthetic parameters, day respiration 
(optionally calculated from leaf temperature), and mesophyll conductance.
</p>


<h3>Usage</h3>

<pre><code class="language-R">Photosyn(
  VPD = 1.5,
  Ca = 400,
  PPFD = 1500,
  Tleaf = 25,
  Patm = 100,
  RH = NULL,
  gsmodel = c("BBOpti", "BBLeuning", "BallBerry", "BBdefine"),
  g1 = 4,
  g0 = 0,
  gk = 0.5,
  vpdmin = 0.5,
  D0 = 5,
  GS = NULL,
  BBmult = NULL,
  alpha = 0.24,
  theta = 0.85,
  Jmax = 100,
  Vcmax = 50,
  gmeso = NULL,
  TPU = 1000,
  alphag = 0,
  Rd0 = 0.92,
  Q10 = 1.92,
  Rd = NULL,
  TrefR = 25,
  Rdayfrac = 1,
  EaV = 58550,
  EdVC = 2e+05,
  delsC = 629.26,
  EaJ = 29680,
  EdVJ = 2e+05,
  delsJ = 631.88,
  GammaStar = NULL,
  Km = NULL,
  Ci = NULL,
  Tcorrect = TRUE,
  returnParsOnly = FALSE,
  whichA = c("Ah", "Amin", "Ac", "Aj")
)

Aci(Ci, ...)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>VPD</code></td>
<td>
<p>Vapour pressure deficit (kPa) (not needed when RH provided)</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>Ca</code></td>
<td>
<p>Atmospheric CO2 concentration (ppm)</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>PPFD</code></td>
<td>
<p>Photosynthetic photon flux density ('PAR') (mu mol m-2 s-1)</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>Tleaf</code></td>
<td>
<p>Leaf temperature (degrees C)</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>Patm</code></td>
<td>
<p>Atmospheric pressure (kPa) (but see warning below!)</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>RH</code></td>
<td>
<p>Relative humidity (in %) (not needed when VPD provided)</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>gsmodel</code></td>
<td>
<p>One of BBOpti (Medlyn et al. 2011), BBLeuning (Leuning 1995), 
BallBerry (Ball et al. 1987), or BBdefine (for full control; see Details).</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>g0, g1</code></td>
<td>
<p>Parameters of Ball-Berry type stomatal conductance models.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>gk</code></td>
<td>
<p>Optional, exponent of VPD in gs model (Duursma et al. 2013)</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>vpdmin</code></td>
<td>
<p>Below vpdmin, VPD=vpdmin, to avoid very high gs.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>D0</code></td>
<td>
<p>Parameter for the BBLeuning stomatal conductance model.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>GS</code></td>
<td>
<p>Optionally, stomatal conductance (to H2O). If provided, <code>Photosyn</code> 
calculates Ci and photosynthesis. See Details.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>BBmult</code></td>
<td>
<p>Optional, only used when <code>gsmodel = "BBdefine"</code>, see Details.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>alpha</code></td>
<td>
<p>Quantum yield of electron transport (mol mol-1)</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>theta</code></td>
<td>
<p>Shape of light response curve.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>Jmax</code></td>
<td>
<p>Maximum rate of electron transport at 25 degrees C (mu mol m-2 s-1)</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>Vcmax</code></td>
<td>
<p>Maximum carboxylation rate at 25 degrees C (mu mol m-2 s-1)</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>gmeso</code></td>
<td>
<p>Mesophyll conductance (mol m-2 s-1). If not NULL (the default), Vcmax and 
Jmax are chloroplastic rates.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>TPU</code></td>
<td>
<p>Triose-phosphate utilization rate (mu mol m-2 s-1); optional.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>alphag</code></td>
<td>
<p>Fraction of glycolate not returned to the chloroplast; parameter in 
TPU-limited photosynthesis (optional, only to be used when TPU is provided) (0 - 1)</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>Rd0</code></td>
<td>
<p>Day respiration rate at reference temperature (<code>TrefR</code>). Must be a positive value.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>Q10</code></td>
<td>
<p>Temperature sensitivity of Rd.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>Rd</code></td>
<td>
<p>Day respiration rate (mu mol m-2 s-1), optional (if not provided, calculated 
from Tleaf, Rd0, Q10 and TrefR). Must be a positive value (an error occurs when a 
negative value is supplied).</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>TrefR</code></td>
<td>
<p>Reference temperature for Rd (Celcius).</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>Rdayfrac</code></td>
<td>
<p>Ratio of Rd in the light vs. in the dark.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>EaV, EdVC, delsC</code></td>
<td>
<p>Vcmax temperature response parameters</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>EaJ, EdVJ, delsJ</code></td>
<td>
<p>Jmax temperature response parameters</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>Km, GammaStar</code></td>
<td>
<p>Optionally, provide Michaelis-Menten coefficient for Farquhar 
model, and Gammastar. If not provided, they are calculated with a built-in function 
of leaf temperature.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>Ci</code></td>
<td>
<p>Optional, intercellular CO2 concentration (ppm). If not provided, 
calculated via gs model.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>Tcorrect</code></td>
<td>
<p>If TRUE, corrects input Vcmax and Jmax for actual Tleaf (if FALSE, 
assumes the provided Vcmax and Jmax are at the Tleaf provided). <strong>Warning</strong> : since package 
version 1.4, the default parameters have been adjusted (see Details).</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>returnParsOnly</code></td>
<td>
<p>If TRUE, returns calculated Vcmax,Jmax,Km and GammaStar based on 
leaf temperature.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>whichA</code></td>
<td>
<p>Which assimilation rate does gs respond to?</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>...</code></td>
<td>
<p>Further arguments passed to <code>Photosyn</code></p>
</td>
</tr>
</table>
<h3>Details</h3>

<p>The coupled photosynthesis - stomatal conductance model finds the intersection between 
the supply of CO2 by diffusion, and the demand for CO2 by photosynthesis. See Farquhar and 
Sharkey (1982) for basic description of this type of model, Duursma (2015) for more details 
on the implementation in the <code>plantecophys</code> package, and Duursma et al. (2014) for an 
example application (that uses this implementation).
</p>
<p><strong>Photosynthesis model and temperature response</strong> - 
The model of Farquhar et al. (1980) is used to estimate the dependence of leaf net 
photosynthesis rate (ALEAF) on intercellular CO2 concentration (Ci), accounting for all 
three limitations (electron transport, carboxylation, and TPU limitation). The equations 
for the temperature response of photosynthetic parameters, including Vcmax, Jmax, 
Gammastar, and Km follow Medlyn et al. (2002). However, <strong>note that the default 
temperature response parameter values are not taken from Medlyn, and likely will have to 
be adjusted for your situation</strong>. <strong>Warning</strong> : since package version 1.4, the default 
parameters have been adjusted. The new parameter values (EaV, EdVJ, delSJ, etc.) were based 
on a comprehensive literature review. See vignette("new_T_responses") or the article on 
remkoduursma.github.io/plantecophys.
</p>
<p>#'  By default, the <code>Photosyn</code> function returns the hyperbolic minimum of Vcmax and 
Jmax-limited photosynthetic rates, as well as the hyperbolic minimum of Jmax-limited and 
TPU-limited rates. This approach avoids the discontinuity at the transition between the 
two rates (thus allowing use of <code>Photosyn</code> and <code>fitaci</code> in optimization or 
fitting routines). The individual rates (Ac, Aj and Ap) are also returned as output 
should they be needed. Note that those rates are output as gross photosynthetic rates 
(leaf respiration has to be subtracted to give net leaf photosynthesis).
</p>
<p><strong>Coupled leaf gas exchange</strong>
When Ci is not provided, Ci is calculated from the intersection between the 'supply' and 
'demand', where 'demand' is given by the Farquhar model of photosynthesis (A=f(Ci)), and 
supply by the stomatal conductance. The latter is, by default, estimated using the 
stomatal conductance model of Medlyn et al. (2011), but two other models are provided 
as well (Ball-Berry and Leuning, see <code>gsmodel</code> argument). Otherwise, stomatal 
conductance may be directly provided via the <code>GS</code> argument. 
</p>
<p><strong>Stomatal conductance models</strong> -  
At the moment, three stomatal conductance models are implemented. The 'BBOpti' model 
is a slightly more general form of the model of Medlyn et al. 2011 (see Duursma et al. 
2013). It is given by (in notation of the parameters and output 
variables of <code>Photosyn</code>),
</p>
<p style="text-align: center;"><code class="reqn">GS = g0 + 1.6*(1 + g1/D^(1-gk))*ALEAF/CA</code>
</p>

<p>where <code>gk = 0.5</code> if stomata behave optimally (cf. Medlyn et al. 2011).
</p>
<p>The 'BBLeuning' model is that of Leuning (1995). It is given by,
</p>
<p style="text-align: center;"><code class="reqn">GS = g0 + g1*ALEAF/(Ca * (1 + VPD/D0))</code>
</p>

<p>Note that this model also uses the g1 parameter, but it needs to be set to 
a much higher value to be comparable in magnitude to the BBOpti model.
</p>
<p>The 'BallBerry' model is that of Ball et al. (1987). It is given by,
</p>
<p style="text-align: center;"><code class="reqn">GS = g0 + g1*RH*ALEAF/Ca</code>
</p>

<p>Where RH is relative humidity. Again, the g1 value is not comparable to that 
used in the previous two models.
</p>
<p>Finally, <code>Photosyn</code> provides a very flexible Ball-Berry model, where 
the multiplier has to be specified by the user, the model is:
</p>
<p style="text-align: center;"><code class="reqn">GS = g0 + BBmult*ALEAF</code>
</p>

<p>This interface can be used to quickly simulate what happens if stomata do 
not respond to humidity at all (in which case BBmult=g1/Ca, or ca. 5/400), or 
to use the Tuzet model of stomatal conductance inside another model that provides 
the leaf water potential function.
</p>
<p>For the full numerical solution to the Cowan-Farquhar optimization, use 
the <code>FARAO</code> function (which was used in Medlyn et al. 2011 for 
comparison to the approximation there presented). See Duursma (2015) for more details.
</p>
<p><strong>Mesophyll conductance</strong> - 
</p>
<p>If the mesophyll conductance <code>gmeso</code> is provided as an input, it is assumed 
that Vcmax and Jmax are the chloroplastic rates, and leaf photosynthesis is 
calculated following the equations from Ethier and Livingston (2004). When very 
low mesophyll conductance rates are input, the model may return poor solutions 
(and sometimes they may not exist).
</p>
<p><strong>Simulating A-Ci curves</strong>
</p>
<p>If Ci is provided as an input, this function calculates an A-Ci curve. For 
example, you may do <code>Photosyn(Ci=300)</code>, for which the function <code>Aci</code> 
is included as a shortcut (<code>Aci(300)</code>).
</p>
<p><strong>Atmospheric pressure</strong> - 
</p>
<p>A correction for atmospheric pressure (Patm) is implemented in <code>fitaci</code>, 
but <strong>not in Photosyn</strong>. In <code>fitaci</code>, the necessary corrections are applied 
so that estimated Vcmax and Jmax are expressed at standard pressure (Patm=100kPa). 
In Photosyn, however, the corrections are much more complicated and tend to be very 
small, because effects of Patm on partial pressures are largely offset by increases 
in diffusivity (Terashima et al. 1995, Gale 1973). 
</p>
<p>Note that Patm is an argument to the Photosyn function, but it only affects 
calculations of Km and GammaStar (as used by fitaci), and transpiration rate. 
Setting only Patm <strong>does not correct for atmospheric pressure effects on 
photosynthesis rates</strong>.
</p>
<p>The simulation of limitation of the photosynthetic rate to triose-phosphate 
utilization follows details in Ellsworth et al. (2015), their Eq. 7. Note that 
the parameter <code>alphag</code> is set to zero by default.
</p>


<h3>Value</h3>

<p>Returns a dataframe.
</p>


<h3>References</h3>

<p>Duursma, R.A., Payton, P., Bange, M.P., Broughton, K.J., Smith, R.A., Medlyn, B.E., Tissue, 
D. T., 2013,  Near-optimal response of instantaneous transpiration efficiency to vapour 
pressure deficit, temperature and [CO2] in cotton (Gossypium hirsutum L.). Agricultural 
and Forest Meteorology 168 : 168 - 176.
</p>
<p>Duursma, R.A., Barton, C.V.M., Lin, Y.-S., Medlyn, B.E., Eamus, D., Tissue, D.T., Ellsworth, 
D.S., McMurtrie, R.E., 2014. The peaked response of transpiration rate to vapour pressure 
deficit in field conditions can be explained by the temperature optimum of photosynthesis.
Agricultural and Forest Meteorology 189 - 190, 2-10. doi:10.1016/j.agrformet.2013.12.007
</p>
<p>Duursma, R.A., 2015. Plantecophys - An R Package for Analysing and Modelling Leaf Gas 
Exchange Data. PLoS ONE 10, e0143346. doi:10.1371/journal.pone.0143346
</p>
<p>Ellsworth, D.S., Crous, K.Y., Lambers, H., Cooke, J., 2015. Phosphorus recycling in 
photorespiration maintains high photosynthetic capacity in woody species. Plant Cell 
Environ 38, 1142-1156. doi:10.1111/pce.12468
</p>
<p>Ethier, G. and N. Livingston. 2004. On the need to incorporate sensitivity to CO2 
transfer conductance into the Farquhar von Caemmerer Berry leaf photosynthesis model. 
Plant, Cell &amp; Environment. 27:137-153.
</p>
<p>Farquhar, G.D., S. Caemmerer and J.A. Berry. 1980. A biochemical model of photosynthetic 
CO2 assimilation in leaves of C3 species. Planta. 149:78-90.
</p>
<p>Farquhar, G. D., &amp; Sharkey, T. D. (1982). Stomatal conductance and photosynthesis. 
Annual review of plant physiology, 33(1), 317-345.
</p>
<p>Gale, J., 1972. Availability of Carbon Dioxide for Photosynthesis at High Altitudes: 
Theoretical Considerations. Ecology 53, 494-497. doi:10.2307/1934239
</p>
<p>Leuning, R. 1995. A critical-appraisal of a combined stomatal-photosynthesis model for 
C-3 plants. Plant Cell and Environment. 18:339-355.
</p>
<p>Medlyn, B.E., E. Dreyer, D. Ellsworth, M. Forstreuter, P.C. Harley, M.U.F. Kirschbaum, 
X. Le Roux, P. Montpied, J. Strassemeyer, A. Walcroft, K. Wang and D. Loustau. 2002. 
Temperature response of parameters of a biochemically based model of photosynthesis. 
II. A review of experimental data. Plant Cell and Environment. 25:1167-1179.
</p>
<p>Medlyn, B.E., R.A. Duursma, D. Eamus, D.S. Ellsworth, I.C. Prentice, C.V.M. Barton, 
K.Y. Crous, P. De Angelis, M. Freeman and L. Wingate. 2011. Reconciling the optimal 
and empirical approaches to modelling stomatal conductance. Global Change Biology. 
17:2134-2144.
</p>
<p>Terashima, I., Masuzawa, T., Ohba, H., Yokoi, Y., 1995. Is photosynthesis suppressed at 
higher elevations due to low CO2 pressure? Ecology 76, 2663-2668. doi:10.2307/2265838
</p>


<h3>See Also</h3>

<p><code>FARAO</code>, <code>fitaci</code>, <code>AciC4</code>
</p>


<h3>Examples</h3>

<pre><code class="language-R"># Run the coupled leaf gas exchange model, set only a couple of parameters
Photosyn(VPD=2, g1=4, Ca=500)

# It is easy to set multiple values for inputs (and these can be mixed with single inputs);
r &lt;- Photosyn(VPD=seq(0.5, 4, length=25), Vcmax=50, Jmax=100)
with(r, plot(VPD, ALEAF, type='l'))

# Set the mesophyll conductance
run1 &lt;- Photosyn(PPFD=seq(50,1000,length=25), gmeso=0.15, Vcmax=40, Jmax=85)
with(run1, plot(PPFD, GS, type='l'))

# Run A-Ci curve only (provide Ci instead of calculating it).
arun1 &lt;- Aci(Ci=seq(50, 1200, length=101), Vcmax=40, Jmax=85)
arun2 &lt;- Aci(Ci=seq(50, 1200, length=101), Vcmax=30, Jmax=70)
with(arun1, plot(Ci, ALEAF, type='l'))
with(arun2, points(Ci, ALEAF, type='l', lty=5))

# Find the intersection between supply of CO2 and demand for CO2 (cf. Farquhar and Sharkey 1982).

# Set some parameters
gs &lt;- 0.2  # stomatal conductance to H2O
Ca &lt;- 400  # ambient CO2
gctogw &lt;- 1.57  # conversion
gc &lt;- gs / gctogw  # stomatal conductance to CO2

# Demand curve (Farquhar model)
p &lt;- Aci(seq(60,500,length=101), Ca=400)

# Provide stomatal conductance as input, gives intersection point.
g &lt;- Photosyn(GS=gs, Ca=Ca)

# Intersection point visualized
par(yaxs="i")
with(p, plot(Ci, ALEAF, type='l', ylim=c(0,max(ALEAF))))
with(g, points(Ci, ALEAF, pch=19, col="red"))
abline(gc * Ca, -gc, lty=5)

legend("topleft", c(expression("Demand:"~~A==f(C[i])),
                    expression("Supply:"~~A==g[c]*(C[a]-C[i])),
                    "Operating point"),
       lty=c(1,5,-1),pch=c(-1,-1,19),
       col=c("black","black","red"),
       bty='n', cex=0.9)
</code></pre>


</div>