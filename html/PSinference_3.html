<div class="container">

<table style="width: 100%;"><tr>
<td>Inddist</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>Independence Empirical Distribution</h2>

<h3>Description</h3>

<p>This function calculates the empirical distribution of the pivotal random
variable that can be used to perform inferential procedures and
test the independence of two subsets of variables based on the
released Single Synthetic data generated under Plug-in Sampling, assuming
that the original dataset is normally distributed.
</p>


<h3>Usage</h3>

<pre><code class="language-R">Inddist(part, nsample, pvariates, iterations)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>part</code></td>
<td>
<p>Number of variables in the first subset.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>nsample</code></td>
<td>
<p>Sample size.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>pvariates</code></td>
<td>
<p>Number of variables.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>iterations</code></td>
<td>
<p>Number of iterations for simulating values from the distribution and finding the quantiles. Default is <code>10000</code>.</p>
</td>
</tr>
</table>
<h3>Details</h3>

<p>We define
</p>
<p style="text-align: center;"><code class="reqn">T_3^\star =
\frac{|\boldsymbol{S}^{\star}|}
{|\boldsymbol{S}^{\star}_{11}||\boldsymbol{S}^{\star}_{22}|}</code>
</p>

<p>where <code class="reqn">\boldsymbol{S}^\star = \sum_{i=1}^n (v_i - \bar{v})(v_i - \bar{v})^{\top}</code>,
<code class="reqn">v_i</code> is the <code class="reqn">i</code>th observation of the synthetic dataset,
considering <code class="reqn">\boldsymbol{S}^\star</code> partitioned as
</p>
<p style="text-align: center;"><code class="reqn">\boldsymbol{S}^{\star}=\left[\begin{array}{lll}
\boldsymbol{S}^{\star}_{11}&amp; \boldsymbol{S}^{\star}_{12}\\
\boldsymbol{S}^{\star}_{21} &amp; \boldsymbol{S}^{\star}_{22}
\end{array}\right].</code>
</p>

<p>Under the assumption that <code class="reqn">\boldsymbol{\Sigma}_{12} = \boldsymbol{0}</code>,
its distribution is stochastic equivalent to
</p>
<p style="text-align: center;"><code class="reqn">\frac{|\boldsymbol{\Omega}|}{|\boldsymbol{\Omega}_{11}||\boldsymbol{\Omega}_{22}|}</code>
</p>

<p>where <code class="reqn">\boldsymbol{\Omega} \sim \mathcal{W}_p(n-1, \frac{\boldsymbol{W}}{n-1})</code>,
<code class="reqn">\boldsymbol{W} \sim \mathcal{W}_p(n-1, \mathbf{I}_p)</code> and
<code class="reqn">\boldsymbol{\Omega}</code> partitioned in the same way as
<code class="reqn">\boldsymbol{S}^{\star}</code>.
To test <code class="reqn">\mathcal{H}_0: \boldsymbol{\Sigma}_{12} = \boldsymbol{0}</code>,
compute the value of <code class="reqn">T_{3}^\star</code>, <code class="reqn">\widetilde{T_{3}^\star}</code>,
with the observed values and reject the null hypothesis if
<code class="reqn">\widetilde{T_{3}^\star}&lt;t^\star_{3,\alpha}</code> for
<code class="reqn">\alpha</code>-significance level, where <code class="reqn">t^\star_{3,\gamma}</code> is the
<code class="reqn">\gamma</code>th percentile of <code class="reqn">T_3^\star</code>.
</p>


<h3>Value</h3>

<p>a vector of length <code>iterations</code> that recorded the empirical distribution's values.
</p>


<h3>References</h3>

<p>Klein, M., Moura, R. and Sinha, B. (2021). Multivariate Normal Inference based on Singly Imputed Synthetic Data under Plug-in Sampling. Sankhya B 83, 273â€“287.
</p>


<h3>Examples</h3>

<pre><code class="language-R">#generate original data with two independent subsets of variables
library(MASS)
n_sample = 100
p = 4
mu &lt;- c(1,2,3,4)
Sigma = matrix(c(1,   0.5,   0,     0,
                 0.5,   2,   0,     0,
                 0,     0,   3,   0.2,
                 0,     0,   0.2,   4), nr = 4, nc = 4, byrow = TRUE)
df = mvrnorm(n_sample, mu = mu, Sigma = Sigma)
# generate synthetic data
df_s = simSynthData(df)

#Decompose Sstar in 4 parts
part = 2

Sstar = cov(df_s)
Sstar_11 = partition(Sstar,nrows = part, ncol = part)[[1]]
Sstar_12 = partition(Sstar,nrows = part, ncol = part)[[2]]
Sstar_21 = partition(Sstar,nrows = part, ncol = part)[[3]]
Sstar_22 = partition(Sstar,nrows = part, ncol = part)[[4]]

#Compute observed T3_star
T3_obs = det(Sstar)/(det(Sstar_11)*det(Sstar_22))

alpha = 0.05

# colect the quantile from the distribution assuming independence between the two subsets
T3 &lt;- Inddist(part = part, nsample = n_sample, pvariates = p, iterations = 10000)
q5 &lt;- quantile(T3, alpha)

T3_obs &lt; q5 #False means that we don't have statistical evidences to reject independence
print(T3_obs)
print(q5)
# Note that the value of the observed T3_obs is close to one as expected
</code></pre>


</div>