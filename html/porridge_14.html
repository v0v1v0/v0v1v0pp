<div class="container">

<table style="width: 100%;"><tr>
<td>ridgeGLM</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>
Ridge estimation of generalized linear models.
</h2>

<h3>Description</h3>

<p>Function that evaluates the targeted ridge estimator of the regression parameter of generalized linear models. 
</p>


<h3>Usage</h3>

<pre><code class="language-R">ridgeGLM(Y, X, U=matrix(ncol=0, nrow=length(Y)), lambda, 
         lambdaG=0, Dg=matrix(0, ncol=ncol(X), nrow=ncol(X)), 
         target=rep(0, ncol(X)), model="linear", 
         minSuccDiff=10^(-10), maxIter=100)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>Y</code></td>
<td>
<p>           A <code>numeric</code> being the response vector. </p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>X</code></td>
<td>
<p>           The design <code>matrix</code> of the penalized covariates. The number of rows should match the number of elements of <code>Y</code>. </p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>U</code></td>
<td>
<p>           The design <code>matrix</code> of the unpenalized covariates. The number of rows should match the number of elements of <code>Y</code>. </p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>lambda</code></td>
<td>
<p>      A positive <code>numeric</code> that is the ridge penalty parameter. </p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>lambdaG</code></td>
<td>
<p>     A positive <code>numeric</code> that is the generalized ridge penalty parameter. </p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>Dg</code></td>
<td>
<p>          A non-negative definite <code>matrix</code> of the unscaled generalized ridge penalty. </p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>target</code></td>
<td>
<p>      A <code>numeric</code> towards which the estimate is shrunken. </p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>model</code></td>
<td>
<p>       A <code>character</code>, either <code>"linear"</code> and <code>"logistic"</code> (a reference to the models currently implemented), indicating which generalized linear model model instance is to be fitted. </p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>minSuccDiff</code></td>
<td>
<p> A <code>numeric</code>, the minimum distance between the loglikelihoods of two successive iterations to be achieved. Used only if <code>model="logistic"</code>. </p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>maxIter</code></td>
<td>
<p>     A <code>numeric</code> specifying the maximum number of iterations. Used only if <code>model="logistic"</code>. </p>
</td>
</tr>
</table>
<h3>Details</h3>

<p>This function finds the maximizer of the following penalized loglikelihood: <code class="reqn"> \mathcal{L}( \mathbf{Y}, \mathbf{X}, \mathbf{U}; \boldsymbol{\beta}, \boldsymbol{\gamma}) - \frac{1}{2} \lambda \| \boldsymbol{\beta}  - \boldsymbol{\beta}_0 \|_2^2 - \frac{1}{2} \lambda_g ( \boldsymbol{\beta}  - \boldsymbol{\beta}_0 )^\top \Delta_g ( \boldsymbol{\beta}  - \boldsymbol{\beta}_0 )</code>, with loglikelihood <code class="reqn">\mathcal{L}( \mathbf{Y}, \mathbf{X}; \boldsymbol{\beta})</code>, response <code class="reqn">\mathbf{Y}</code>, design matrices <code class="reqn">\mathbf{X}</code> and <code class="reqn">\mathbf{U}</code>, regression parameters <code class="reqn">\boldsymbol{\beta}</code> and <code class="reqn">\boldsymbol{\gamma}</code>, penalty parameter <code class="reqn">\lambda</code>, shrinkage target <code class="reqn">\boldsymbol{\beta}_0</code>, and generalized ridge penalty matrix <code class="reqn">\Delta_g</code>. For more details, see van Wieringen, Binder (2020) and Lettink et al. (2022).
</p>


<h3>Value</h3>

<p>A <code>numeric</code>, the generalized ridge estimate of the regression parameter. If a nonempty <code class="reqn">\mathbf{U}</code> is supplied, the first few elements are the unpenalized effect estimates of the covariates that comprise this design matrix.
</p>


<h3>Note</h3>

<p>The penalized IRLS (Iterative Reweighted Least Squares) algorithm for the evaluation of the generalized ridge logistic regression estimator may fail to converge for small penalty parameter values in combination with a nonzero shrinkage target. 
</p>


<h3>Author(s)</h3>

<p>W.N. van Wieringen.
</p>


<h3>References</h3>

<p>van Wieringen, W.N. Binder, H. (2022), "Sequential learning of regression models by penalized estimation", <em>submitted</em>.
</p>
<p>Lettink, A., Chinapaw, M.J.M., van Wieringen, W.N. (2022), "Two-dimensional fused targeted ridge regression for health indicator prediction from accelerometer data", <em>submitted</em>.
</p>


<h3>Examples</h3>

<pre><code class="language-R"># set the sample size
n &lt;- 50

# set the true parameter
betas &lt;- (c(0:100) - 50) / 20

# generate covariate data
X &lt;- matrix(rnorm(length(betas)*n), nrow=n)

# sample the response
probs &lt;- exp(tcrossprod(betas, X)[1,]) / (1 + exp(tcrossprod(betas, X)[1,]))
Y     &lt;- numeric()
for (i in 1:n){
    Y &lt;- c(Y, sample(c(0,1), 1, prob=c(1-probs[i], probs[i])))
}

# set the penalty parameter
lambda &lt;- 3

# estimate the logistic regression parameter
bHat &lt;- ridgeGLM(Y, X, lambda=lambda, target=betas/2, model="logistic")
</code></pre>


</div>