<div class="container">

<table style="width: 100%;"><tr>
<td>phylepic</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>Combine metadata (a line list) with a phylogenetic tree</h2>

<h3>Description</h3>

<p>Some checks are performed to catch issues where the metadata and tree tips
don't match up. Any columns in <code>metadata</code> that are factors have all levels
that do not appear in the data dropped.
</p>


<h3>Usage</h3>

<pre><code class="language-R">phylepic(
  tree,
  metadata,
  name,
  date,
  unmatched_tips = c("error", "drop", "keep")
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>tree</code></td>
<td>
<p>An object convertible to a <code>tbl_graph</code>. This will usually be a
"phylo" object, but see tidygraph::tbl_graph for more details.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>metadata</code></td>
<td>
<p>A data frame.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>name</code></td>
<td>
<p>Column in <code>metadata</code> that corresponds to the tree's tip labels
(tidy-eval).</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>date</code></td>
<td>
<p>Column in <code>metadata</code> that contains the date data (class "Date")
for the tips (tidy-eval).</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>unmatched_tips</code></td>
<td>
<p>Action to take when <code>tree</code> contains tip labels that
do not appear in <code>name</code>. <code>"error"</code> aborts with an error message, <code>"drop"</code>
drops unmatched tips from <code>tree</code>, <code>"keep"</code>.</p>
</td>
</tr>
</table>
<h3>Details</h3>

<p>To reduce surprises when matching <code>metadata</code> and <code>tree</code>, by default an error
occurs when there are tree tips that do not have associated metadata. On the
other hand, it it expected that <code>metadata</code> might contain rows that do not
correspond to the tips in <code>tree</code>.
</p>
<p>This often means that <code>factor</code> columns from <code>metadata</code> will contain levels
that do not appear at all in the tree. For plotting,
<code>ggplot2::discrete_scale</code> normally solves this with <code>drop = TRUE</code>, however
this can lead to inconsistencies when sharing the same scale across multiple
phylepic panels. <code>phylepic()</code> drops unused levels in all factors so that
scales can use <code>drop = FALSE</code> for consistency.
</p>


<h3>Value</h3>

<p>An object of class "phylepic".
</p>


<h3>Examples</h3>

<pre><code class="language-R">library(ape)

tree &lt;- read.tree(system.file("enteric.newick", package = "phylepic"))
metadata &lt;- read.csv(
  system.file("enteric_metadata.csv", package = "phylepic")
)
phylepic(tree, metadata, name, as.Date(collection_date))
</code></pre>


</div>