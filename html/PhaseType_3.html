<div class="container">

<table style="width: 100%;"><tr>
<td>phtMCMC</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>MCMC for dense Phase-type models</h2>

<h3>Description</h3>

<p>Markov-chain Monte Carlo (MCMC) sampler for Bayesian inference on Phase-type models where data consist solely of time to entering the absorbing state (Bladt et al., 2003).
</p>
<p>Consider an m+1 state continuous-time Markov chain (CTMC) where the final (m+1 st) state is absorbing.  Then, given data consisting of first passage times to the last state, this function performs Bayesian inference on the rate parameters of the latent continuous-time Markov chain where the generator is assumed to be dense and all rates independent.
</p>


<h3>Usage</h3>

<pre><code class="language-R">phtMCMC(x, states, beta, nu, zeta, n, mhit=1, resume=NULL, silent=FALSE)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>x</code></td>
<td>

<p>a vector of absorption times (or times at which censoring occurs).
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>states</code></td>
<td>

<p>an integer describing how many states (ie what dimension) the fitted Phase-type's generator should be.
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>beta</code></td>
<td>

<p>a vector of length m representing the Dirichlet prior on the starting state of the latent continuous-time Markov chain.  Entries should sum to 1.
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>nu</code></td>
<td>

<p>a list of the Gamma shape hyper-parameters for the prior of each parameter in the continuous-time Markov chain.  These should match the dense generator matrix filled <b>column-wise</b>.
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>zeta</code></td>
<td>

<p>a list of the Gamma reciprocal scale hyper-parameters for the prior of each parameter in the continuous-time Markov chain.  These should match the dense generator matrix, with one zeta value <b>per row</b>.
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>n</code></td>
<td>

<p>the total number of MCMC iterations to compute.
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>mhit</code></td>
<td>

<p>the number of Metropolis-Hastings iterations to perform when sampling the latent process.
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>resume</code></td>
<td>

<p><code>NULL</code> indicates a new chain is to be sampled.  Otherwise, passing in an object of class <code>phtMCMC</code> (as returned by a call to this function) picks up a previously run MCMC chain at its end an continues for another <code>n</code> iterations.
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>silent</code></td>
<td>

<p>setting to <code>TRUE</code> suppresses the feedback about current iteration.  Highly recommended for batch files or else output fills with unnecessary iteration updates.
</p>
</td>
</tr>
</table>
<h3>Details</h3>

<p>Usage of this function effectively involves specification of the number of states for the CTMC generator matrix, the parameter priors in Gamma form and providing absorption time data.
</p>
<p>If you want to specify structure on your generator (for example, to model a stochastic process about which some underlying mechanism is known), then consider using <code>phtMCMC2</code> instead.  This function is best illustrated by the example below which is <a href="https://www.louisaslett.com/PhaseType/">more fully discussed on this webpage</a>.
</p>


<h3>Value</h3>

<p><code>phtMCMC</code> returns an object of class <code>"phtMCMC"</code>.
</p>
<p>An object of class <code>"phtMCMC"</code> is a list containing at least the following components:
</p>
<table>
<tr style="vertical-align: top;">
<td><code>samples</code></td>
<td>
<p>an object of class <code>"mcmc"</code> containing the MCMC samples for each parameter in the model.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>data</code></td>
<td>
<p>a vector containing the original data used in the inference.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>vars</code></td>
<td>
<p>a list of the distinct variable names in the CTMC generator.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>TT</code></td>
<td>
<p>the naming scheme for the generator which was fitted.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>beta</code></td>
<td>
<p>the Dirichlet prior probability mass function on the starting states.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>nu</code></td>
<td>
<p>a list of the prior nu hyper-parameters used when phtMCMC2 was called.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>zeta</code></td>
<td>
<p>a list of the prior zeta hyper-parameters used when phtMCMC2 was called.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>iterations</code></td>
<td>
<p>the number of MCMC iterations contained in the object.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>MHit</code></td>
<td>
<p>the number of iterations used if <code>method="MHRS"</code></p>
</td>
</tr>
</table>
<h3>Note</h3>

<p>Please feel free to email <a href="mailto:louis.aslett@durham.ac.uk">louis.aslett@durham.ac.uk</a> with any queries or if you encounter errors when running this function.
</p>


<h3>Author(s)</h3>

<p>Louis J.M. Aslett <a href="mailto:louis.aslett@durham.ac.uk">louis.aslett@durham.ac.uk</a> (<a href="https://www.louisaslett.com/">https://www.louisaslett.com/</a>)
</p>


<h3>References</h3>

<p>Bladt, M., Gonzalez, A. and Lauritzen, S. L. (2003), ‘The estimation of Phase-type related functionals using Markov chain Monte Carlo methods’, <em>Scandinavian Actuarial Journal</em> 2003(4), 280-300.
</p>


<h3>See Also</h3>

<p><code>phtMCMC2</code>
</p>


<h3>Examples</h3>

<pre><code class="language-R"># Some pre-simulated absorption times
x &lt;- c(1.45353415045187, 1.85349532001349, 2.01084961814576, 0.505725921290172,
1.56252630012213, 3.41158665930278, 1.52674487509487, 4.3428662377235,
8.03208018151311, 2.41746547476986, 0.38828086509283, 2.61513815012196,
3.39148865480856, 1.82705817807965, 1.42090953713845, 0.851438991331866,
0.0178808867191894, 0.632198596390046, 0.959910259815998, 1.83344199966323)

# Prior on starting state
dirpi &lt;- c(1, 0, 0)
# Gamma prior: shape hyperparameters (one per matrix element, columnwise)
nu &lt;- c(24, 24, 1, 180, 1, 24, 180, 1, 24)
# Gamma prior: reciprocal scale hyperparameters (one per matrix row)
zeta &lt;- c(16, 16, 16)
# Define dimension of model to fit
n &lt;- 3
# Perform 20 MCMC iterations (fix inner Metropolis-Hastings to one iteration
# since starts in stationarity here).  Do more in practice!
res &lt;- phtMCMC(x, n, dirpi, nu, zeta, 6, mhit=1)
print(res)

plot(res)

</code></pre>


</div>