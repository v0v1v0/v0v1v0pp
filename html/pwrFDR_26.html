<div class="container">

<table style="width: 100%;"><tr>
<td>pwrFDR.grid</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>
Evaluate <code>pwrFDR</code> on a grid.
</h2>

<h3>Description</h3>

<p>Function for evaluating <code>pwrFDR</code> on a factorial design of
possible parameters.
</p>


<h3>Usage</h3>

<pre><code class="language-R">  pwrFDR.grid(effect.size, n.sample, r.1, alpha, delta, groups, N.tests,
              average.power, tp.power, lambda, type, grpj.per.grp1,
              FDP.control.method, control)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>effect.size</code></td>
<td>

<p>A vector of effect sizes to be looped over. The effect size
(mean over standard deviation) for test statistics having non-zero
means. Assumed to be a constant (in magnitude) over non-zero mean
test statistics.
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>n.sample</code></td>
<td>

<p>A vector of sample sizes to be looped over. The sample size is the
number of experimental replicates. Required for calculation of power
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>r.1</code></td>
<td>

<p>A vector of mixing proportions to be looped over. The mixing
proportion is the proportion of simultaneous tests that are
non-centrally located 
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>alpha</code></td>
<td>

<p>The false discovery rate (in the BH case) or the upper bound on the
probability that the FDP exceeds delta (BHCLT and Romano case)
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>delta</code></td>
<td>

<p>If the "FDP.control.method" is set to 'Romano' or 'BHCLT', then this
optional argument can be set to the exceedance thresh-hold in
defining the FDP-tp: <code class="reqn">P\{ FDP &gt; \delta \} &lt; \alpha</code>. The default
value is <code class="reqn">\alpha</code>.
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>groups</code></td>
<td>

<p>The number of experimental groups to compare. Must be integral and
&gt;=1. The default value is 2.
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>N.tests</code></td>
<td>

<p>The number of simultaneous hypothesis tests. 
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>average.power</code></td>
<td>

<p>The desired average power. Calculation of sample size, effect size
mixing proportion or alpha requires specification of either
'average.power' or 'tp.power'.
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>tp.power</code></td>
<td>

<p>The desired tp-power (see <code>pwrFDR</code> documentation).
Calculation of sample size, effect size mixing proportion or alpha
requires specification of either 'average.power' or 'tp.power'.
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>lambda</code></td>
<td>

<p>The tp-power threshold, required when calculating the tp-power
(see <code>pwrFDR</code> documentation) or when calculating the
sample size, effect size mixing proportion or alpha required for
tp-power.
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>type</code></td>
<td>

<p>A character string specifying, in the groups=2 case, whether the
test is 'paired', 'balanced', or 'unbalanced' and in the case when
groups &gt;=3, whether the test is 'balanced' or 'unbalanced'. The
default in all cases is 'balanced'. Left unspecified in the one
sample (groups=1) case. 
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>grpj.per.grp1</code></td>
<td>

<p>Required when <code>type</code>="unbalanced", specifies the group 0 to
group 1 ratio in the two group case, and in the case of 3 or more
groups, the group j to group 1 ratio, where group 1 is the group
with the largest effect under the alternative hypothesis. 
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>FDP.control.method</code></td>
<td>

<p>A character string specifying how the false discovery proportion (FDP) is to be
controlled. You may specify the whole word or any shortened uniquely
identifying truncation. <br>
"BHFDR": the usual BH-FDR <br>
"BHCLT": use asymptotic approximation to the distribution of the FDP 
to find a smaller FDR which guarantees probability less
than alpha that the FDP exceeds alpha. <br>
"Romano": use Romano's method which guarantees probability less than 
alpha that the FDP exceeds alpha. <br>
"Auto": in 'FixedPoint' mode, the program will use its own 
wisdom to determine which choice above to make. The 
order of conservatism is Romano &gt; BHCLT &gt; BHFDR, but 
BHFDR offers only expected control while the other two 
guarantee bounds on the excedance probabilty. If the 
distribution of the FDP is nearly degenerate, then BHFDR 
is the best option. Otherwise, if it can be reliably used, 
BHCLT would be the best choice. The 'effective' denominator, 
gamma*N.tests, in the CLT determines when the approximation 
is good enough and the asymptotic standard error of the FDP 
determines when the distribution is dispersed enough to matter.
Use "Auto" to run through these checks and determine the best. 
A return argument, 'Auto', displays the choice made. See 
output components and details. <br>
"both": in 'simulation' mode, compute statistics R and T under BHCLT
and Romano (in addition to BHFDR). Corresponding
statistics are denoted R.st, T.st corresponding to BHCLT
control of the FDP, and R.R and T.R corresponding to
Romano control of the FDP. If sim.level is set to 2,
(default) the statistics R.st.ht and T.st.ht, which are
the number rejected and number true positives under BHCLT
where r_0 = 1-r_1, gamma, and alpha.star have been estimated 
from the P-value data and then alpha.star computed from
these.
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>control</code></td>
<td>
<p>Optionally, a list with components with the following  
components: <br>
'tol' is a convergence criterion used in iterative 
methods which is set to 1e-8 by default.
'max.iter' is an iteration limit, set to 20 for the iterated
function limit and 1000 for all others by default.
'distop', specifying the distribution family of the central
and non-centrally located sub-populations. distopt=1
gives normal (2 groups), distop=2 gives t- (2 groups)
and distopt=3 gives F- (2+ groups) <br>
'CS', correlation structure, for use only with 'method="simulation"'  
which will simulate m simulatenous tests with correlations 
'rho' in blocks of size 'n.WC'. Specify as a list
CS = list(rho=0.80,n.WC=50) for example.  <br>
'sim.level' sim level 2 (default) stipulates, when FDP.control.method
is set to "BHCLT", or "both", R.st.ht and T.st.ht are
computed in addition to R.st and T.st (see above). <br>
'low.power.stop' in simulation option, will result in an error message 
if the power computed via FixedPoint method is too low, which 
result in no solution for the BHCLT option. Default setting is TRUE. 
Set to FALSE to over-ride this behavior. <br>
'FDP.meth.thresh' fine-tunes the 'Auto' voodoo (see above). Leave 
this alone. <br>
'verb' vebosity level.<br>
'ast.le.a' leaving this at the default value TRUE forces
'alpha.star', the solution under FDP.method.control="BHCLT",
to be less than the specified 'alpha'.
</p>
</td>
</tr>
</table>
<h3>Details</h3>

<p>Arguments may be specified as vectors of possible values or can be
set to a single constant value.
</p>


<h3>Value</h3>

<p>A list having two components:
</p>
<table>
<tr style="vertical-align: top;">
<td><code>conditions</code></td>
<td>
<p>A data.frame with one column for each argument
listing the distinct settings for all parameters.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>results</code></td>
<td>
<p>A list with components objects of class <code>pwr</code>,
the results of the calls to <code>pwrFDR</code></p>
</td>
</tr>
</table>
<h3>Author(s)</h3>

<p>Grant Izmirlian &lt;izmirlian at nih dot gov&gt;
</p>


<h3>References</h3>

<p>Izmirlian G. (2020) Strong consistency and asymptotic normality for
quantities related to the Benjamini-Hochberg false discovery rate
procedure. Statistics and Probability Letters; 108713,
&lt;doi:10.1016/j.spl.2020.108713&gt;
</p>
<p>Izmirlian G. (2017) Average Power and <code class="reqn">\lambda</code>-power in
Multiple Testing Scenarios when the Benjamini-Hochberg False
Discovery Rate Procedure is Used. &lt;arXiv:1801.03989&gt;
</p>
<p>Jung S-H. (2005) Sample size for FDR-control in microarray data
analysis. Bioinformatics; 21:3097-3104.
</p>
<p>Liu P. and Hwang J-T. G. (2007) Quick calculation for sample size while
controlling false discovery rate with application to microarray
analysis. Bioinformatics; 23:739-746.
</p>
<p>Lehmann E. L., Romano J. P.. Generalizations of the familywise error
rate. Ann. Stat.. 2005;33(3):1138â€“1154.
</p>
<p>Romano Joseph P., Shaikh Azeem M.. Stepup procedures for control of
generalizations of the familywise error rate. Ann. Stat..
2006;34(4):1850-1873. 
</p>


<h3>See Also</h3>

<p><code>pwrFDR.grid</code>
<code>controlFDP</code>
</p>


<h3>Examples</h3>

<pre><code class="language-R">tst &lt;- pwrFDR.grid(effect.size=c(0.6,0.9), n.sample=c(50,60,70), r.1=0.4+0.2*(0:1),
                   alpha=0.05+0.05*(0:3), N.tests=1000, FDP.control.method="Auto")

</code></pre>


</div>