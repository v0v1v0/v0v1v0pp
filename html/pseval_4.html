<div class="container">

<table style="width: 100%;"><tr>
<td>add_integration</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>Integration models</h2>

<h3>Description</h3>

<p>Add integration model to a psdesign object
</p>


<h3>Usage</h3>

<pre><code class="language-R">add_integration(psdesign, integration)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>psdesign</code></td>
<td>
<p>A psdesign object</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>integration</code></td>
<td>
<p>An integration object</p>
</td>
</tr>
</table>
<h3>Details</h3>

<p>This is a list of the available integration models. The fundamental problem in surrogate evaluation is that there are unobserved values of the counterfactual surrogate responses S(1). In the estimated maximum likelihood framework, for subjects missing the S(1) values, we use an auxiliary pre-treatment variable or set of variables W that is observed for every subject to estimate the distribution of S(1) | W. Typically, this W is a BIP. Then for each missing S(1), we integrate likelihood contributions over each non-missing S(1) given their value of W, and average over the contributions.
</p>

<ul>
<li> <p>integrate_parametric This is a parametric integration model that fits a linear model for the mean of S(1) | W and assumes a Gaussian distribution.
</p>
</li>
<li> <p>integrate_bivnorm This is another parametric integration model that assumes that S(1) and W are jointly normally distributed. The user must specify their mean, variances and correlation.
</p>
</li>
<li> <p>integrate_nonparametric This is a non-parametric integration model that is only valid for categorical S(1) and W. It uses the observed proportions to estimate the joint distribution of S(1), W.
</p>
</li>
<li> <p>integrate_semiparametric This is a semi-parametric model that uses the semi-parametric location scale model of Heagerty and Pepe (1999). Models are specified for the location of S(1) | W and the scale of S(1) | W. Then integrations are drawn from the empirical distribution of the residuals from that model, which are then transformed to the appropriate location and scale.
</p>
</li>
</ul>
<h3>Examples</h3>

<pre><code class="language-R">
test &lt;- psdesign(generate_example_data(n = 100), Z = Z, Y = Y.obs, S = S.obs, BIP = BIP)
add_integration(test, integrate_parametric(S.1 ~ BIP))
test + integrate_parametric(S.1 ~ BIP)  # same as above

</code></pre>


</div>