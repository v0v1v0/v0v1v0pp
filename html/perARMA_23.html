<div class="container">

<table style="width: 100%;"><tr>
<td>pgram</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>
Plotting the periodogram of time series
</h2>

<h3>Description</h3>

<p>The periodogram is a classical tool 
based on the sample Fourier transform 
for finding periodic components in a time series. 
The procedure <code>pgram</code> computes and plots an average 
of <code class="reqn">np</code> periodograms where <code>np=floor(length(x)/fftlen)</code> where the 
input parameter <code>fftlen</code> is the length of the FFT; to get just 
1 FFT of length <code>fftlen</code>, use <code>x(1:fftlen)</code> in place of <code>x</code>. To get a 
significance of high periodogram peaks, the procedure tests, 
at each frequency, the value of the averaged periodogram against 
the average of <code>2*halflen</code> neighboring cells (<code>halflen</code> on each side), 
and averaged over the <code class="reqn">np</code> periodograms; the neighboring cell average 
is called the background. Significance of the ratio of center 
frequency average to the background average is computed from the 
F distribution. 
</p>


<h3>Usage</h3>

<pre><code class="language-R">pgram(x, fftlen,...)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>x</code></td>
<td>
<p>input time series, missing values denoted by NaNs will be
replaced in <code>pgram</code> by zeros.
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>fftlen</code></td>
<td>
<p>length of FFT which will be used. In <code>pgram</code> we can specify the desired length of the FFT, then <code>x</code> is divided into pieces of 
this length. FFT is done on each of these pieces and the resulting magnitude squares values are added,
so average of the periodograms for each frequency is obtained. 
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>...</code></td>
<td>
<p>other arguments that are connected with periodogram plot: <code>np1</code>, <code>np2</code>, <code>halflen</code>, <code>alpha</code>, <code>rejalpha</code>, <code>logsw</code>, 
<code>datastr</code>, <code>typeci</code>, <code>typepgram</code>, <code>colci</code>, <code>colpgram</code>, where <br><code>np1</code> and <code>np2</code> are frequency indexes of the first and the last frequency in the periodogram plot; it is required that
<code class="reqn">np1 &gt; halflen</code> and usually <code class="reqn">np2=\left \lfloor length(x)/2 \right \rfloor</code>, because periodogram is symmetric;<br><code>halflen</code> is a value on each side of the center for background estimation, <br><code>alpha</code> is significance level for testing for periodic components, <br><code>rejalpha</code> is significance level for rejecting outliers in the background estimation, <br><code>logsw</code> if is equal to 1 plot of the periodogram is in <code class="reqn">\log</code> scale, else linear, <br><code>datastr</code> string name of data for printing, <br>
Parameters <code>typeci</code> / <code>typepgram</code>, <code>colci</code> / <code>colpgram</code> define the type and colors of confidence intervals / periodogram values on the plot.<br>
By default they are fixed to <code>np1 = 5</code>, <code>np2 = fftlen/2</code>, <code>halflen = 4</code>, <code>alpha = .05</code>, <code>rejalpha = .01</code>, <code>logsw = 1</code>, 
<code>datastr = 'data'</code>, <code>typeci = "b"</code>, <code>typepgram = "b"</code>, <code>colci = "red"</code>, <code>colpgram = "blue"</code>.
</p>
</td>
</tr>
</table>
<h3>Details</h3>

<p>When we assume that period <code>T_t</code> of PC-T structure is unknown, 
function <code>pgram</code> enables us to find
candidate for the period length assuming the period of 
the second order structure is the same as the period of 
the first order structure (IE, in the series itself).
</p>


<h3>Value</h3>

<p>For any FFT index <code class="reqn">j</code> (say where a strong peak occurs)
<code class="reqn">j</code> corresponds to the number of cycles in the FFT window, 
so the period can be easily computed as <code>T_t = fftlen/j</code>.
</p>


<h3>Author(s)</h3>

<p>Harry Hurd 
</p>


<h3>References</h3>

<p>Box, G. E. P., Jenkins, G. M., Reinsel, G. (1994), Time Series Analysis, 3rd Ed., Prentice-Hall,
Englewood Cliffs, NJ.
<br><br>
Hurd, H. L., Miamee, A. G., (2007), Periodically Correlated Random Sequences: 
Spectral Theory and Practice, Wiley InterScience.<br></p>


<h3>See Also</h3>

<p><code>scoh</code>
</p>


<h3>Examples</h3>

<pre><code class="language-R">data(volumes)
dev.set(which=1)
pgram(t(volumes),length(volumes),datastr='volumes')
</code></pre>


</div>