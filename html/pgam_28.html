<div class="container">

<table style="width: 100%;"><tr>
<td>predict.pgam</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>Prediction</h2>

<h3>Description</h3>

<p>Prediction and forecasting of the fitted model.</p>


<h3>Usage</h3>

<pre><code class="language-R">## S3 method for class 'pgam'
predict(object, forecast = FALSE, k = 1, x = NULL, ...)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>object</code></td>
<td>
<p>object of class <code>pgam</code> holding the fitted model</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>forecast</code></td>
<td>
<p>if <code>TRUE</code> the function tries to forecast</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>k</code></td>
<td>
<p>steps for forecasting</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>x</code></td>
<td>
<p>covariate values for forecasting if the model has covariates. Must have the <code class="reqn">k</code> rows and <code class="reqn">p</code> columns</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>...</code></td>
<td>
<p>further arguments passed to method</p>
</td>
</tr>
</table>
<h3>Details</h3>

<p>It estimates predicted values, their variances, deviance components, generalized Pearson statistics components, local level, smoothed prediction and forecast.
</p>
<p>Considering a Poisson process and a gamma priori, the predictive distribution of the model is negative binomial with parameters <code class="reqn">a_{t|t-1}</code> and <code class="reqn">b_{t|t-1}</code>. So, the conditional mean and variance are given by
</p>
<p style="text-align: center;"><code class="reqn">E\left(y_{t}|Y_{t-1}\right)=a_{t|t-1}/b_{t|t-1}</code>
</p>

<p>and
</p>
<p style="text-align: center;"><code class="reqn">Var\left(y_{t}|Y_{t-1}\right)=a_{t|t-1}\left(1+b_{t|t-1}\right)/b_{t|t-1}^{2}</code>
</p>

<p>Deviance components are estimated as follow
</p>
<p style="text-align: center;"><code class="reqn">D\left(y;\hat\mu\right)=2\sum_{t=\tau+1}^{n}{a_{t|t-1}\log \left(\frac{a_{t|t-1}}{y_{t}b_{t|t-1}}\right)-\left(a_{t|t-1}+y_{t}\right)\log \frac{\left(y_{t}+a_{t|t-1}\right)}{\left(1+b_{t|t-1}\right)y_{t}}}</code>
</p>

<p>Generalized Pearson statistics has the form
</p>
<p style="text-align: center;"><code class="reqn">X^{2}=\sum_{t=\tau+1}^{n}\frac{\left(y_{t}b_{t|t-1}-a_{t|t-1}\right)^{2}} {a_{t|t-1}\left(1+b_{t|t-1}\right)}</code>
</p>

<p>Approximate scale parameter is given by the expression
</p>
<p style="text-align: center;"><code class="reqn">\hat\phi=frac{X^{2}}{edf}</code>
</p>

<p>where <code class="reqn">edf</code> is the number o degrees of reedom of the fitted model.
</p>


<h3>Value</h3>

<p>List with those described in <b>Details</b>
</p>


<h3>Author(s)</h3>

<p>Washington Leite Junger <a href="mailto:wjunger@ims.uerj.br">wjunger@ims.uerj.br</a> and Antonio Ponce de Leon <a href="mailto:ponce@ims.uerj.br">ponce@ims.uerj.br</a>
</p>


<h3>References</h3>

<p>Green, P. J., Silverman, B. W. (1994) Nonparametric Regression and Generalized Linear Models: a roughness penalty approach. Chapman and Hall, London
</p>
<p>Harvey, A. C., Fernandes, C. (1989) Time series models for count data or qualitative observations. Journal of Business and Economic Statistics, 7(4):407â€“417
</p>
<p>Junger, W. L. (2004) Semiparametric Poisson-Gamma models: a roughness penalty approach. MSc Dissertation. Rio de Janeiro, PUC-Rio, Department of Electrical Engineering. 
</p>
<p>Harvey, A. C. (1990) Forecasting, structural time series models and the Kalman Filter. Cambridge, New York
</p>
<p>Hastie, T. J., Tibshirani, R. J.(1990) Generalized Additive Models. Chapman and Hall, London
</p>
<p>McCullagh, P., Nelder, J. A. (1989). Generalized Linear Models. Chapman and Hall, 2nd edition, London
</p>


<h3>See Also</h3>

<p><code>pgam</code>, <code>residuals.pgam</code></p>


<h3>Examples</h3>

<pre><code class="language-R">library(pgam)
data(aihrio)
attach(aihrio)
form &lt;- ITRESP5~f(WEEK)+HOLIDAYS+rain+PM+g(tmpmax,7)+g(wet,3)
m &lt;- pgam(form,aihrio,omega=.8,beta=.01,maxit=1e2,eps=1e-4,optim.method="BFGS")

p &lt;- predict(m)$yhat
plot(ITRESP5)
lines(p)

</code></pre>


</div>