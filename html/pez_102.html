<div class="container">

<table style="width: 100%;"><tr>
<td>pez.shape</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>Calculate (phylogenetic) shape: examine assemblage composition</h2>

<h3>Description</h3>

<p>As described in Pearse et al. (2014), a shape metric is one the
examines the phylogenetic structure of species present in each
assemblage, ignoring abundances entirely. For completeness, options
are provided to calculate these metrics using species traits.
</p>


<h3>Usage</h3>

<pre><code class="language-R">pez.shape(
  data,
  sqrt.phy = FALSE,
  traitgram = NULL,
  traitgram.p = 2,
  ext.dist = NULL,
  which.eigen = 1,
  quick = TRUE,
  q = 1e-04
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>data</code></td>
<td>
<p><code>comparative.comm</code> object</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>sqrt.phy</code></td>
<td>
<p>If TRUE (default is FALSE) your phylogenetic
distance matrix will be square-rooted; specifying TRUE will force
the square-root transformation on phylogenetic distance matrices
(in the spirit of Leitten and Cornwell, 2014). See ‘details’ for
details about different metric calculations when a distance matrix
is used.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>traitgram</code></td>
<td>
<p>If not NULL (default), a number to be passed to
<code>funct.phylo.dist</code> (<code>phyloWeight</code>; the ‘a’ parameter),
causing analysis on a distance matrix reflecting both traits and
phylogeny (0 –&gt; only phylogeny, 1 –&gt; only traits; see
<code>funct.phylo.dist</code>). If a vector of numbers is given,
<code>pez.shape</code> iterates across them and returns a
<code>data.frame</code> with coefficients from each iteration. See
‘details’ for details about different metric calculations when a
distance matrix is used.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>traitgram.p</code></td>
<td>
<p>A value for ‘p’ to be used in conjunction with
<code>traitgram</code> when calling <code>funct.phylo.dist</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>ext.dist</code></td>
<td>
<p>Supply an external species-level distance matrix
for use in calculations. See ‘details’ for comments on the use of
distance matrices in different metric calculations.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>which.eigen</code></td>
<td>
<p>The eigen vector to calculate for the PhyloEigen
metric (<code>eigen.sum</code>)</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>quick</code></td>
<td>
<p>Only calculate metrics which are quick to calculate
(default: TRUE); setting to FALSE will also calculate
<code>fd.dist</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>q</code></td>
<td>
<p>value for <em>q</em> in <code>scheiner</code> (default 0.0001)</p>
</td>
</tr>
</table>
<h3>Details</h3>

<p>Most of these metrics do not involve comparison with some kind of
evolutionary-derived expectation for phylogenetic shape. Those that
do, however, such as PSV, make no sense unless applied to a
phylogenetic distance matrix - their null expectation *requires*
it. Using square-rooted distance matrices, or distance matrices
that incorporate trait information, can be an excellent thing to
do, but (for the above reasons), <code>pez</code> won't give you an
answer for metrics for which WDP thinks it makes no
sense. <code>pd</code>, <code>eed</code> &amp; <code>hed</code> can (...up to you whether
you should!...) be used with a square-rooted distance matrix, but
the results *will always be wrong* if you do not have an
ultrametric tree (branch lengths proportional to time) and you will
be warned about this. WDP strongly feels you should only be using
ultrametric phylogenies in any case, but code to fix this bug is
welcome.
</p>


<h3>Value</h3>

<p><code>phy.structure</code> list object of metric values. Use
<code>coefs</code> to extract a summary metric table, or examine each
individual metric (which gives more details for each) by calling
<code>print</code> on the output (i.e., type <code>output</code> in the example
below).
</p>
<p>Some of the metrics in this wrapper are also in
<code>pez.evenness</code>; such metrics can be calculated using
species' abundances (making them <em>evenness</em>) metrics or simply
using presence/absence of species (making them <em>shape</em>
metrics).
</p>


<h3>Note</h3>

<p>As mentioned above, <code>dist.fd</code> is calculated using a
phylogenetic distance matrix if no trait data are available, or if
you specify <code>sqrt.phy</code>. It is not calculated by default
because it generates warning messsages (which WDP is loathe to
suppress) which are related to the general tendency for a low rank
of phylogenetic distance matrices. Much ink has been written about
this, and in part this problem is why the <code>eigen.sum</code> measure
came to be suggested.
</p>
<p>Many of these metrics, (<em>e.g.</em>, <code>eed</code>) will cause
(inconsequential) warnings if given assemblages with only one
species in them, and return NA/NaN values depending on the
metric. I consider these ‘features’, not bugs.
</p>


<h3>Author(s)</h3>

<p>M.R. Helmus, Will Pearse
</p>


<h3>References</h3>

<p>Pearse W.D., Purvis A., Cavender-Bares J. &amp; Helmus
M.R. (2014). Metrics and Models of Community Phylogenetics. In:
Modern Phylogenetic Comparative Methods and Their Application in
Evolutionary Biology. Springer Berlin Heidelberg, pp. 451-464.
</p>
<p><code>PSV,PSR</code> Helmus M.R., Bland T.J., Williams C.K. &amp;
Ives A.R. (2007). Phylogenetic measures of biodiversity. American
Naturalist, 169, E68-E83.
</p>
<p><code>PD</code> Faith D.P. (1992). Conservation evaluation
and phylogenetic diversity. Biological Conservation, 61, 1-10.
</p>
<p><code>gamma</code> Pybus O.G. &amp; Harvey P.H. (2000) Testing
macro-evolutionary models using incomplete molecular
phylogenies. _Proceedings of the Royal Society of London. Series
B. Biological Sciences 267: 2267–2272.
</p>
<p><code>taxon</code> Clarke K.R. &amp; Warwick R.M. (1998). A
taxonomic distinctness index and its statistical
properties. J. Appl. Ecol., 35, 523-531.
</p>
<p><code>eigen.sum</code> Diniz-Filho J.A.F., Cianciaruso M.V.,
Rangel T.F. &amp; Bini L.M. (2011). Eigenvector estimation of
phylogenetic and functional diversity. Functional Ecology, 25,
735-744.
</p>
<p><code>eed,hed</code> (i.e., <em>Eed, Hed</em>) Cadotte M.W.,
Davies T.J., Regetz J., Kembel S.W., Cleland E. &amp; Oakley
T.H. (2010). Phylogenetic diversity metrics for ecological
communities: integrating species richness, abundance and
evolutionary history. Ecology Letters, 13, 96-105.
</p>
<p><code>innd,mipd</code> Ness J.H., Rollinson E.J. &amp; Whitney
K.D. (2011). Phylogenetic distance can predict susceptibility to
attack by natural enemies. Oikos, 120, 1327-1334.
</p>
<p><code>scheiner</code> Scheiner, S.M. (20120). A metric of
biodiversity that integrates abundance, phylogeny, and function.
Oikos, 121, 1191-1202.
</p>


<h3>See Also</h3>

<p><code>pez.evenness</code> <code>pez.dispersion</code>
<code>pez.dissimilarity</code>
</p>


<h3>Examples</h3>

<pre><code class="language-R">data(laja)
data &lt;- comparative.comm(invert.tree, river.sites, invert.traits)
(output&lt;-pez.shape(data))
</code></pre>


</div>