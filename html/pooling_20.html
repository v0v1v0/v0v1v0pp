<div class="container">

<table style="width: 100%;"><tr>
<td>p_dfa_xerrors2</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>Discriminant Function Approach for Estimating Odds Ratio with Gamma Exposure
Measured in Pools and Potentially Subject to Errors</h2>

<h3>Description</h3>

<p>Archived on 7/23/18. Please use <code>p_gdfa</code> instead.
</p>


<h3>Usage</h3>

<pre><code class="language-R">p_dfa_xerrors2(g, y, xtilde, c = NULL, constant_or = TRUE,
  errors = "both", integrate_tol = 1e-08,
  integrate_tol_hessian = integrate_tol, estimate_var = TRUE,
  fix_posdef = FALSE, ...)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>g</code></td>
<td>
<p>Numeric vector with pool sizes, i.e. number of members in each pool.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>y</code></td>
<td>
<p>Numeric vector with poolwise <code>Y</code> values, coded 0 if all members
are controls and 1 if all members are cases.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>xtilde</code></td>
<td>
<p>Numeric vector (or list of numeric vectors, if some pools have
replicates) with <code>Xtilde</code> values.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>c</code></td>
<td>
<p>List where each element is a numeric matrix containing the
<strong><code>C</code></strong> values for members of a particular pool (1 row for each
member).</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>constant_or</code></td>
<td>
<p>Logical value for whether to assume a constant OR for
<code>X</code>, which means that <code>gamma_y = 0</code>. If <code>NULL</code>, model is
fit with and without this assumption, and likelihood ratio test is performed
to test it.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>errors</code></td>
<td>
<p>Character string specifying the errors that <code>X</code> is subject
to. Choices are <code>"neither"</code>, <code>"processing"</code> for processing error
only, <code>"measurement"</code> for measurement error only, and <code>"both"</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>integrate_tol</code></td>
<td>
<p>Numeric value specifying the <code>tol</code> input to
<code>hcubature</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>integrate_tol_hessian</code></td>
<td>
<p>Same as <code>integrate_tol</code>, but for use when
estimating the Hessian matrix only. Sometimes more precise integration
(i.e. smaller tolerance) helps prevent cases where the inverse Hessian is not
positive definite.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>estimate_var</code></td>
<td>
<p>Logical value for whether to return variance-covariance
matrix for parameter estimates.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>fix_posdef</code></td>
<td>
<p>Logical value for whether to repeatedly reduce
<code>integrate_tol_hessian</code> by factor of 5 and re-estimate Hessian to try
to avoid non-positive definite variance-covariance matrix.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>...</code></td>
<td>
<p>Additional arguments to pass to <code>nlminb</code>.</p>
</td>
</tr>
</table>
<h3>Value</h3>

<p>List of point estimates, variance-covariance matrix, objects returned by
<code>nlminb</code>, and AICs, for one or two models depending on
<code>constant_or</code>. If <code>constant_or = NULL</code>, also returns result of a
likelihood ratio test for <code>H0: gamma_y = 0</code>, which is equivalent to
<code>H0: log-OR is constant</code>. If <code>constant_or = NULL</code>, returned objects
with names ending in 1 are for model that does not assume constant log-OR,
and those ending in 2 are for model that assumes constant log-OR.
</p>


<h3>References</h3>

<p>Lyles, R.H., Van Domelen, D.R., Mitchell, E.M. and Schisterman, E.F. (2015)
"A discriminant function approach to adjust for processing and measurement
error When a biomarker is assayed in pooled samples."
<em>Int. J. Environ. Res. Public Health</em> <strong>12</strong>(11): 14723–14740.
</p>
<p>Mitchell, E.M, Lyles, R.H., and Schisterman, E.F. (2015) "Positing, fitting,
and selecting regression models for pooled biomarker data." <em>Stat. Med</em>
<strong>34</strong>(17): 2544–2558.
</p>
<p>Schisterman, E.F., Vexler, A., Mumford, S.L. and Perkins, N.J. (2010) "Hybrid
pooled-unpooled design for cost-efficient measurement of biomarkers."
<em>Stat. Med.</em> <strong>29</strong>(5): 597–613.
</p>
<p>Whitcomb, B.W., Perkins, N.J., Zhang, Z., Ye, A., and Lyles, R. H. (2012)
"Assessment of skewed exposure in case-control studies with pooling."
<em>Stat. Med.</em> <strong>31</strong>: 2461–2472.
</p>


<h3>Examples</h3>

<pre><code class="language-R"># Load dataset with (g, Y, Xtilde, C) values for 248 pools and list of C
# values for members of each pool. Xtilde values are affected by processing
# error.
data(pdat2)
dat &lt;- pdat2$dat
c.list &lt;- pdat2$c.list

# Estimate log-OR for X and Y adjusted for C, ignoring processing error
fit1 &lt;- p_dfa_xerrors2(
  g = dat$g,
  y = dat$y,
  xtilde = dat$xtilde,
  c = c.list,
  errors = "neither"
)
fit1$estimates

# Repeat, but accounting for processing error.
## Not run: 
fit2 &lt;- p_dfa_xerrors2(
  g = dat$g,
  y = dat$y,
  xtilde = dat$xtilde,
  c = c.list,
  errors = "processing",
  control = list(trace = 1)
)
fit2$estimates

## End(Not run)

</code></pre>


</div>