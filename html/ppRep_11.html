<div class="container">

<table style="width: 100%;"><tr>
<td>postPPtheta</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>Marginal posterior distribution of effect size</h2>

<h3>Description</h3>

<p>These functions compute the marginal posterior of the effect
size <code class="reqn">\theta</code>. A power prior for <code class="reqn">\theta</code> is
constructed by updating an initial normal prior <code class="reqn">\theta \sim
    \mathrm{N}(\code{m}, \code{v})</code> with likelihood of the
original data raised to the power of <code class="reqn">\alpha</code>. The power
parameter <code class="reqn">\alpha</code> can either be fixed to some value between 0
and 1 or it can have a beta prior distribution <code class="reqn">\alpha \sim
    \mbox{Beta}(\code{x}, \code{y})</code>.
</p>


<h3>Usage</h3>

<pre><code class="language-R">postPPtheta(
  theta,
  tr,
  sr,
  to,
  so,
  x = 1,
  y = 1,
  alpha = NA,
  m = 0,
  v = Inf,
  hypergeo = FALSE,
  ...
)

postPPthetaHPD(
  level,
  tr,
  sr,
  to,
  so,
  x = 1,
  y = 1,
  alpha = NA,
  m = 0,
  v = Inf,
  thetaRange = tr + c(-1, 1) * stats::qnorm(p = (1 + level)/2) * sr * 3,
  quantileRange = c((1 - level) * 0.2, (1 - level) * 0.8),
  ...
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>theta</code></td>
<td>
<p>Effect size. Can be a vector.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>tr</code></td>
<td>
<p>Effect estimate of the replication study.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>sr</code></td>
<td>
<p>Standard error of the replication effect estimate.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>to</code></td>
<td>
<p>Effect estimate of the original study.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>so</code></td>
<td>
<p>Standard error of the replication effect estimate.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>x</code></td>
<td>
<p>Number of successes parameter for beta prior of power parameter
<code class="reqn">\alpha</code>. Defaults to <code>1</code>. Is only taken into account
when <code>alpha = NA</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>y</code></td>
<td>
<p>Number of failures parameter for beta prior of power parameter
<code class="reqn">\alpha</code>. Defaults to <code>1</code>. Is only taken into account
when <code>alpha = NA</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>alpha</code></td>
<td>
<p>Power parameter. Can be set to a number between 0 and 1.
Defaults to <code>NA</code> (a beta prior on the power parameter).</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>m</code></td>
<td>
<p>Mean parameter of initial normal prior for <code class="reqn">\theta</code>.
Defaults to <code>0</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>v</code></td>
<td>
<p>Variance parameter of initial normal prior for <code class="reqn">\theta</code>.
Defaults to <code>Inf</code> (uniform prior).</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>hypergeo</code></td>
<td>
<p>Logical indicating whether for uniform priors, the marginal
posterior should be computed with the hypergeometric function. Defaults
to <code>FALSE</code> (using numerical integration instead).</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>...</code></td>
<td>
<p>Additional arguments passed to <code>stats::integrate</code> or
<code>hypergeo::genhypergeo</code> (depending on the <code>hypergeo</code> argument).</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>level</code></td>
<td>
<p>Credibility level of the highest posterior density interval.
Defaults to <code>0.95</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>thetaRange</code></td>
<td>
<p>The numerical search range for the effect size. Defaults to
the <code>level*100</code>% confidence inteval range inflated by a factor of
three. We recommend changing this argument only if there are numerical
problems in calculating the HPD interval.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>quantileRange</code></td>
<td>
<p>The numerical search range for the lower posterior
quantile of the HPD interval. Defaults to the range between <code>(1 -
level)*0.2</code> and <code>(1 - level)*0.8</code>. We recommend changing this
argument only if there are numerical problems in calculating the HPD
interval.</p>
</td>
</tr>
</table>
<h3>Value</h3>

<p><code>postPPtheta</code> returns the marginal posterior density of the
effect size.
</p>
<p><code>postPPthetaHPD</code> returns the highest marginal posterior density
interval of the effect size (this may take a while).
</p>


<h3>Author(s)</h3>

<p>Samuel Pawel
</p>


<h3>See Also</h3>

<p><code>postPP</code>, <code>postPPalpha</code>, <code>plotPP</code>
</p>


<h3>Examples</h3>

<pre><code class="language-R">theta &lt;- seq(0, 0.6, 0.001)
margpostdens &lt;- postPPtheta(theta = theta, tr = 0.1, to = 0.2, sr = 0.05, so = 0.05)
plot(theta, margpostdens, type = "l", xlab = bquote("Effect size" ~ theta),
     ylab = "Marginal posterior density", las = 1)
</code></pre>


</div>