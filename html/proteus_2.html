<div class="container">

<table style="width: 100%;"><tr>
<td>proteus</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>proteus</h2>

<h3>Description</h3>

<p>Proteus is a Sequence-to-Sequence Variational Model designed for time-feature analysis, leveraging a wide range of distributions for improved accuracy. Unlike traditional methods that rely solely on the normal distribution, Proteus uses various latent models to better capture and predict complex processes. To achieve this, Proteus employs a neural network architecture that estimates the shape, location, and scale parameters of the chosen distribution. This approach transforms past sequence data into future sequence parameters, improving the model's prediction capabilities. Proteus also assesses the accuracy of its predictions by estimating the error of measurement and calculating the confidence interval. By utilizing a range of distributions and advanced modeling techniques, Proteus provides a more accurate and comprehensive approach to time-feature analysis.
</p>


<h3>Usage</h3>

<pre><code class="language-R">proteus(
  data,
  target,
  future,
  past,
  ci = 0.8,
  smoother = FALSE,
  t_embed = 30,
  activ = "linear",
  nodes = 32,
  distr = "normal",
  optim = "adam",
  loss_metric = "crps",
  epochs = 30,
  lr = 0.01,
  patience = 10,
  latent_sample = 100,
  verbose = TRUE,
  stride = 1,
  dates = NULL,
  rolling_blocks = FALSE,
  n_blocks = 4,
  block_minset = 30,
  error_scale = "naive",
  error_benchmark = "naive",
  batch_size = 30,
  omit = FALSE,
  min_default = 1,
  future_plan = "future::multisession",
  seed = 42
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>data</code></td>
<td>
<p>A data frame with time features on columns and possibly a date column (not mandatory)</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>target</code></td>
<td>
<p>Vector of strings. Names of the time features to be jointly analyzed</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>future</code></td>
<td>
<p>Positive integer. The future dimension with number of time-steps to be predicted</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>past</code></td>
<td>
<p>Positive integer. Length of past sequences</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>ci</code></td>
<td>
<p>Positive numeric. Confidence interval. Default: 0.8</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>smoother</code></td>
<td>
<p>Logical. Perform optimal smoothing using standard loess for each time feature. Default: FALSE</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>t_embed</code></td>
<td>
<p>Positive integer. Number of embedding for the temporal dimension. Minimum value is equal to 2. Default: 30.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>activ</code></td>
<td>
<p>String. Activation function to be used by the forward network. Implemented functions are: "linear", "mish", "swish", "leaky_relu", "celu", "elu", "gelu", "selu", "bent", "softmax", "softmin", "softsign", "softplus", "sigmoid", "tanh". Default: "linear".</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>nodes</code></td>
<td>
<p>Positive integer. Nodes for the forward neural net. Default: 32.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>distr</code></td>
<td>
<p>String. Distribution to be used by variational model. Implemented distributions are: "normal", "genbeta", "gev", "gpd", "genray", "cauchy", "exp", "logis", "chisq", "gumbel", "laplace", "lognorm", "skewed". Default: "normal".</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>optim</code></td>
<td>
<p>String. Optimization method. Implemented methods are: "adadelta", "adagrad", "rmsprop", "rprop", "sgd", "asgd", "adam".</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>loss_metric</code></td>
<td>
<p>String. Loss function for the variational model. Three options: "elbo", "crps", "score". Default: "crps".</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>epochs</code></td>
<td>
<p>Positive integer. Default: 30.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>lr</code></td>
<td>
<p>Positive numeric. Learning rate. Default: 0.01.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>patience</code></td>
<td>
<p>Positive integer. Waiting time (in epochs) before evaluating the overfit performance. Default: epochs.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>latent_sample</code></td>
<td>
<p>Positive integer. Number of samples to draw from the latent variables. Default: 100.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>verbose</code></td>
<td>
<p>Logical. Default: TRUE</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>stride</code></td>
<td>
<p>Positive integer. Number of shifting positions for sequence generation. Default: 1.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>dates</code></td>
<td>
<p>String. Label of feature where dates are located. Default: NULL (progressive numbering).</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>rolling_blocks</code></td>
<td>
<p>Logical. Option for incremental or rolling window. Default: FALSE.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>n_blocks</code></td>
<td>
<p>Positive integer. Number of distinct blocks for back-testing. Default: 4.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>block_minset</code></td>
<td>
<p>Positive integer. Minimum number of sequence to create a block. Default: 3.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>error_scale</code></td>
<td>
<p>String. Scale for the scaled error metrics. Two options: "naive" (average of naive one-step absolute error for the historical series) or "deviation" (standard error of the historical series). Default: "naive".</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>error_benchmark</code></td>
<td>
<p>String. Benchmark for the relative error metrics. Two options: "naive" (sequential extension of last value) or "average" (mean value of true sequence). Default: "naive".</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>batch_size</code></td>
<td>
<p>Positive integer. Default: 30.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>omit</code></td>
<td>
<p>Logical. Flag to TRUE to remove missing values, otherwise all gaps, both in dates and values, will be filled with kalman filter. Default: FALSE.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>min_default</code></td>
<td>
<p>Positive numeric. Minimum differentiation iteration. Default: 1.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>future_plan</code></td>
<td>
<p>how to resolve the future parallelization. Options are: "future::sequential", "future::multisession", "future::multicore". For more information, take a look at future specific documentation. Default: "future::multisession".</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>seed</code></td>
<td>
<p>Random seed. Default: 42.</p>
</td>
</tr>
</table>
<h3>Value</h3>

<p>This function returns a list including:
</p>

<ul>
<li>
<p> model_descr: brief model description (number of tensors and parameters)
</p>
</li>
<li>
<p> prediction: a table with quantile predictions, mean, std, mode, skewness and kurtosis for each time feature (and other metrics, such as iqr_to_range, above_to_below_range, upside_prob, divergence).
</p>
</li>
<li>
<p> pred_sampler: empirical function for sampling each prediction point for each time feature
</p>
</li>
<li>
<p> plot: graph with history and prediction for each time feature
</p>
</li>
<li>
<p> feature_errors: train and test error for each time feature (me, mae, mse, rmsse, mpe, mape, rmae, rrmse, rame, mase, smse, sce)
</p>
</li>
<li>
<p> history: average cross-validation loss across blocks
</p>
</li>
<li>
<p> time_log: computation time.
</p>
</li>
</ul>
<h3>Author(s)</h3>

<p>Giancarlo Vercellino <a href="mailto:giancarlo.vercellino@gmail.com">giancarlo.vercellino@gmail.com</a>
</p>


<h3>References</h3>

<p>https://rpubs.com/giancarlo_vercellino/proteus
</p>


</div>