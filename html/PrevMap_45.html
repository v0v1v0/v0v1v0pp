<div class="container">

<table style="width: 100%;"><tr>
<td>spatial.pred.linear.MLE</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>Spatial predictions for the geostatistical Linear Gaussian model using plug-in of ML estimates</h2>

<h3>Description</h3>

<p>This function performs spatial prediction, fixing the model parameters at the maximum likelihood estimates of a linear geostatistical model.
</p>


<h3>Usage</h3>

<pre><code class="language-R">spatial.pred.linear.MLE(
  object,
  grid.pred,
  predictors = NULL,
  predictors.samples = NULL,
  type = "marginal",
  scale.predictions = c("logit", "prevalence", "odds"),
  quantiles = c(0.025, 0.975),
  n.sim.prev = 0,
  standard.errors = FALSE,
  thresholds = NULL,
  scale.thresholds = NULL,
  messages = TRUE,
  include.nugget = FALSE
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>object</code></td>
<td>
<p>an object of class "PrevMap" obtained as result of a call to <code>linear.model.MLE</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>grid.pred</code></td>
<td>
<p>a matrix of prediction locations.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>predictors</code></td>
<td>
<p>a data frame of the values of the explanatory variables at each of the locations in <code>grid.pred</code>; each column correspond to a variable and each row to a location. <b>Warning:</b> the names of the columns in the data frame must match those in the data used to fit the model. Default is <code>predictors=NULL</code> for models with only an intercept.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>predictors.samples</code></td>
<td>
<p>a list of data frame objects. This argument is used to average over repeated simulations of the predictor variables in order to obtain an "average" map over the distribution of the explanatory variables in the model.
Each component of the list is a simulation. The number of simulations passed through <code>predictors.samples</code> must be the same as <code>n.sim.prev</code>. NOTE: This argument can currently only be used only for a linear regression model that does not use any approximation of the spatial Gaussian process.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>type</code></td>
<td>
<p>a character indicating the type of spatial predictions: <code>type="marginal"</code> for marginal predictions or <code>type="joint"</code> for joint predictions. Default is <code>type="marginal"</code>. In the case of a low-rank approximation only marginal predictions are available.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>scale.predictions</code></td>
<td>
<p>a character vector of maximum length 3, indicating the required scale on which spatial prediction is carried out: "logit", "prevalence" and "odds". Default is <code>scale.predictions=c("logit","prevalence","odds")</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>quantiles</code></td>
<td>
<p>a vector of quantiles used to summarise the spatial predictions.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>n.sim.prev</code></td>
<td>
<p>number of simulation for non-linear predictive targets. Default is <code>n.sim.prev=0</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>standard.errors</code></td>
<td>
<p>logical; if <code>standard.errors=TRUE</code>, then standard errors for each <code>scale.predictions</code> are returned. Default is <code>standard.errors=FALSE</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>thresholds</code></td>
<td>
<p>a vector of exceedance thresholds; default is <code>thresholds=NULL</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>scale.thresholds</code></td>
<td>
<p>a character value indicating the scale on which exceedance thresholds are provided; <code>"logit"</code>, <code>"prevalence"</code> or <code>"odds"</code>. Default is <code>scale.thresholds=NULL</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>messages</code></td>
<td>
<p>logical; if <code>messages=TRUE</code> then status messages are printed on the screen (or output device) while the function is running. Default is <code>messages=TRUE</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>include.nugget</code></td>
<td>
<p>logical; if <code>include.nugget=TRUE</code> then the nugget effect is included in the predictions. This option is available only for fitted linear models with locations having multiple observations. Default is <code>include.nugget=FALSE</code>.</p>
</td>
</tr>
</table>
<h3>Value</h3>

<p>A "pred.PrevMap" object list with the following components: <code>logit</code>; <code>prevalence</code>; <code>odds</code>; <code>exceedance.prob</code>, corresponding to a matrix of the exceedance probabilities where each column corresponds to a specified value in <code>thresholds</code>; <code>grid.pred</code> prediction locations; <code>samples</code>, corresponding to the predictive samples of the linear predictor (only if <code>any(scale.predictions=="prevalence")</code>).
Each of the three components <code>logit</code>, <code>prevalence</code> and  <code>odds</code> is also a list with the following components:
</p>
<p><code>predictions</code>: a vector of the predictive mean for the associated quantity (logit, odds or prevalence).
</p>
<p><code>standard.errors</code>: a vector of prediction standard errors (if <code>standard.errors=TRUE</code>).
</p>
<p><code>quantiles</code>: a matrix of quantiles of the resulting predictions with each column corresponding to a quantile specified through the argument <code>quantiles</code>.
</p>
<p><code>samples</code>: If <code>n.sim.prev &gt; 0</code>, the function returns <code>n.sim.prev</code> samples of the linear predictor at each of the prediction locations.
</p>


<h3>Author(s)</h3>

<p>Emanuele Giorgi <a href="mailto:e.giorgi@lancaster.ac.uk">e.giorgi@lancaster.ac.uk</a>
</p>
<p>Peter J. Diggle <a href="mailto:p.diggle@lancaster.ac.uk">p.diggle@lancaster.ac.uk</a>
</p>


</div>