<div class="container">

<table style="width: 100%;"><tr>
<td>penhdfeppml_cluster</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>Plugin Lasso Estimation</h2>

<h3>Description</h3>

<p>Performs plugin lasso - PPML estimation with HDFE. This is an internal function, called by
<code>mlfitppml</code> and <code>penhdfeppml</code> when users select the <code>method = "plugin"</code>
option, but it's made available as a stand-alone option for advanced users who may prefer to avoid
some overhead imposed by the wrappers.
</p>


<h3>Usage</h3>

<pre><code class="language-R">penhdfeppml_cluster(
  data,
  dep = 1,
  indep = NULL,
  fixed = NULL,
  cluster = NULL,
  selectobs = NULL,
  ...
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>data</code></td>
<td>
<p>A data frame containing all relevant variables.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>dep</code></td>
<td>
<p>A string with the name of the independent variable or a column number.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>indep</code></td>
<td>
<p>A vector with the names or column numbers of the regressors. If left unspecified,
all remaining variables (excluding fixed effects) are included in the regressor matrix.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>fixed</code></td>
<td>
<p>A vector with the names or column numbers of factor variables identifying the fixed effects,
or a list with the desired interactions between variables in <code>data</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>cluster</code></td>
<td>
<p>A string with the name of the clustering variable or a column number.
It's also possible to input a vector with several variables, in which case the interaction of
all of them is taken as the clustering variable. Note that this is NOT OPTIONAL in this case:
our plugin algorithm requires clusters to be specified.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>selectobs</code></td>
<td>
<p>Optional. A vector indicating which observations to use (either a logical vector
or a numeric vector with row numbers, as usual when subsetting in R).</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>...</code></td>
<td>
<p>Further options. For a full list of options, see penhdfeppml_cluster_int.</p>
</td>
</tr>
</table>
<h3>Details</h3>

<p>This function is a thin wrapper around <code>penppml_cluster_int</code>, providing a more convenient interface
for data frames. Whereas the internal function requires some preliminary handling of data sets (<code>y</code>
must be a vector, <code>x</code> must be a matrix and <code>fes</code> must be provided in a list), the wrapper
takes a full data frame in the <code>data</code> argument, and users can simply specify which variables
correspond to y, x and the fixed effects, using either variable names or column numbers.
</p>
<p>The plugin method uses coefficient-specific penalty weights that account for heteroskedasticity. The
penalty parameters are calculated automatically by the function using statistical theory - for a
brief discussion of this, see Breinlich, Corradi, Rocha, Ruta, Santos Silva and Zylkin (2021), and
for a more in-depth analysis, check Belloni, Chernozhukov, Hansen, and Kozbur (2016), which introduced
the specific implementation used in this package. Heuristically, the penalty parameters are set at
a level high enough so that the absolute value of the score for each regressor must be statistically
large relative to its standard error in order for the regressors to be selected.
</p>


<h3>Value</h3>

<p>An object of class <code>elnet</code> with the elements described in glmnet, as
well as the following:
</p>

<ul>
<li> <p><code>mu</code>: a 1 x <code>length(y)</code> matrix with the final values of the conditional mean <code class="reqn">\mu</code>.
</p>
</li>
<li> <p><code>deviance</code>.
</p>
</li>
<li> <p><code>bic</code>: Bayesian Information Criterion.
</p>
</li>
<li> <p><code>phi</code>: coefficient-specific penalty weights.
</p>
</li>
<li> <p><code>x_resid</code>: matrix of demeaned regressors.
</p>
</li>
<li> <p><code>z_resid</code>: vector of demeaned (transformed) dependent variable.
</p>
</li>
</ul>
<h3>References</h3>

<p>Breinlich, H., Corradi, V., Rocha, N., Ruta, M., Santos Silva, J.M.C. and T. Zylkin (2021).
"Machine Learning in International Trade Research: Evaluating the Impact of Trade Agreements",
Policy Research Working Paper; No. 9629. World Bank, Washington, DC.
</p>
<p>Correia, S., P. Guimaraes and T. Zylkin (2020). "Fast Poisson estimation with high dimensional
fixed effects", <em>STATA Journal</em>, 20, 90-115.
</p>
<p>Gaure, S (2013). "OLS with multiple high dimensional category variables",
<em>Computational Statistics &amp; Data Analysis</em>, 66, 8-18.
</p>
<p>Friedman, J., T. Hastie, and R. Tibshirani (2010). "Regularization paths for generalized linear
models via coordinate descent", <em>Journal of Statistical Software</em>, 33, 1-22.
</p>
<p>Belloni, A., V. Chernozhukov, C. Hansen and D. Kozbur (2016). "Inference in high dimensional panel
models with an application to gun control", <em>Journal of Business &amp; Economic Statistics</em>, 34, 590-605.
</p>


<h3>Examples</h3>

<pre><code class="language-R">## Not run: 
# To reduce run time, we keep only countries in the Americas:
americas &lt;- countries$iso[countries$region == "Americas"]
test &lt;- penhdfeppml_cluster(data = trade[, -(5:6)],
                              dep = "export",
                              fixed = list(c("exp", "time"),
                                           c("imp", "time"),
                                           c("exp", "imp")),
                              cluster = c("exp", "imp"),
                              selectobs = (trade$imp %in% americas) &amp; (trade$exp %in% americas),
                              tol = 1e-5, hdfetol = 1e-1)

## End(Not run)

</code></pre>


</div>