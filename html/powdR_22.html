<div class="container">

<table style="width: 100%;"><tr>
<td>fps_lm.powdRlib</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>Full pattern summation using linear regression</h2>

<h3>Description</h3>

<p><code>fps_lm.powdRlib</code> returns a simple fit of a given pattern using linear regression,
where coefficients may be either positive or negative. Does not return quantitative
data. For quantitative results use <code>fps</code> or <code>afps</code>.
</p>


<h3>Usage</h3>

<pre><code class="language-R">## S3 method for class 'powdRlib'
fps_lm(
  lib,
  smpl,
  harmonise,
  refs,
  std,
  tth_align,
  align,
  manual_align,
  tth_fps,
  shift,
  p,
  ...
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>lib</code></td>
<td>
<p>A <code>powdRlib</code> object representing the reference library. Created using the
<code>powdRlib</code> constructor function.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>smpl</code></td>
<td>
<p>A data frame. First column is 2theta, second column is counts</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>harmonise</code></td>
<td>
<p>logical parameter defining whether to harmonise the <code>lib</code> and <code>smpl</code>.
Default = <code>TRUE</code>. When <code>TRUE</code> the function harmonises the <code>lib</code> and <code>smpl</code>
data to the intersecting 2theta range at the coarsest resolution available using natural splines.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>refs</code></td>
<td>
<p>A character string of reference pattern IDs or names from the specified library.
The IDs or names supplied must be present within the <code>lib$phases$phase_id</code> or
<code>lib$phases$phase_name</code> columns. If missing from the function call then all phases in
the reference library will be used.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>std</code></td>
<td>
<p>The phase ID (e.g. "QUA.1") to be used as internal
standard. Must match an ID provided in the <code>refs</code> parameter.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>tth_align</code></td>
<td>
<p>A vector defining the minimum and maximum 2theta values to be used during
alignment (e.g. <code>c(5,65)</code>). If not defined, then the full range is used.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>align</code></td>
<td>
<p>The maximum shift that is allowed during initial 2theta
alignment (degrees). Default = 0.1.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>manual_align</code></td>
<td>
<p>A logical operator denoting whether to optimise the alignment within the
negative/position 2theta range defined in the <code>align</code> argument, or to use the specified
value of the <code>align</code> argument for alignment of the sample to the standards. Default
= <code>FALSE</code>, i.e. alignment is optimised.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>tth_fps</code></td>
<td>
<p>A vector defining the minimum and maximum 2theta values to be used during
full pattern summation (e.g. <code>c(5,65)</code>). If not defined, then the full range is used.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>shift</code></td>
<td>
<p>A single numeric value denoting the maximum (positive or negative) shift,
in degrees 2theta, that is allowed during the shifting of selected phases. Default = 0.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>p</code></td>
<td>
<p>a numeric parameter between 0 and 1 specifying the p-value limit for coefficients.
Any reference patterns with a p-value greater than this value will be omitted from the
linear regression and results recomputed. Must be greater than 0.000001 but no greater than 1.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>...</code></td>
<td>
<p>Other arguments</p>
</td>
</tr>
</table>
<h3>Details</h3>

<p>Requires a <code>powdRlib</code> library of reference patterns. Mineral concentrations
are not quantified and therefore reference intensity ratios are not required.
</p>


<h3>Value</h3>

<p>a powdRlm object with components:
</p>
<table>
<tr style="vertical-align: top;">
<td><code>tth</code></td>
<td>
<p>a vector of the 2theta scale of the fitted data</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>fitted</code></td>
<td>
<p>a vector of the count intensities of the fitted XRPD pattern</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>measured</code></td>
<td>
<p>a vector of the original count intensities of the XRPD measurement (aligned)</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>residuals</code></td>
<td>
<p>a vector of the residuals (fitted vs measured)</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>phases</code></td>
<td>
<p>a dataframe of the phases used to produce the fitted pattern and their concentrations</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>phases_grouped</code></td>
<td>
<p>the phases dataframe grouped by phase_name and concentrations summed</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>weighted_pure_patterns</code></td>
<td>
<p>a dataframe of reference patterns used to produce the fitted pattern.
All patterns have been weighted according to the coefficients used in the fit</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>coefficients</code></td>
<td>
<p>a named vector of coefficients used to produce the fitted pattern</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>inputs</code></td>
<td>
<p>a list of input arguments used in the function call</p>
</td>
</tr>
</table>
<h3>Examples</h3>

<pre><code class="language-R">data(rockjock)
data(rockjock_mixtures)

#Compute the PCA and loadings
x1 &lt;- xrpd_pca(rockjock_mixtures,
               mean_center = TRUE,
               bin_size = 1,
               root_transform = 1)

## Not run: 
fps_lm_out &lt;- fps_lm(rockjock,
                     smpl = data.frame("x" = x1$loadings$tth,
                                       "y" = x1$loadings$Dim.1),
                     refs = rockjock$phases$phase_id,
                     std = "QUARTZ",
                     align = 0.3,
                     p = 0.01)

plot(fps_lm_out,
     wavelength = "Cu",
     interactive = TRUE,
     group = TRUE)


## End(Not run)

</code></pre>


</div>