<div class="container">

<table style="width: 100%;"><tr>
<td>ShrinkageMoments</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>Functions for calculating shrinkage-based comoments of financial time series</h2>

<h3>Description</h3>

<p>calculates covariance, coskewness and cokurtosis matrices using linear shrinkage
between the sample estimator and a structured estimator
</p>


<h3>Usage</h3>

<pre><code class="language-R">M2.shrink(R, targets = 1, f = NULL)

M3.shrink(R, targets = 1, f = NULL, unbiasedMSE = FALSE, as.mat = TRUE)

M4.shrink(R, targets = 1, f = NULL, as.mat = TRUE)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>R</code></td>
<td>
<p>an xts, vector, matrix, data frame, timeSeries or zoo object of
asset returns</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>targets</code></td>
<td>
<p>vector of integers selecting the target matrices to shrink to. The first four
structures are, in order: 'independent marginals', 'independent and identical marginals', 
'observed 1-factor model' and 'constant correlation'. See Details.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>f</code></td>
<td>
<p>vector or matrix with observations of the factor, to be used with target 3. See Details.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>unbiasedMSE</code></td>
<td>
<p>TRUE/FALSE whether to use a correction to have an unbiased
estimator for the marginal skewness values, in case of targets 1 and/or 2, default FALSE</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>as.mat</code></td>
<td>
<p>TRUE/FALSE whether to return the full moment matrix or only
the vector with the unique elements (the latter is advised for speed), default
TRUE</p>
</td>
</tr>
</table>
<h3>Details</h3>

<p>The coskewness and cokurtosis matrices are defined as the matrices of dimension 
p x p^2 and p x p^3 containing the third and fourth order central moments. They
are useful for measuring nonlinear dependence between different assets of the 
portfolio and computing modified VaR and modified ES of a portfolio.
</p>
<p>Shrinkage estimation for the covariance matrix was popularized by Ledoit and 
Wolf (2003, 2004). An extension to coskewness and cokurtosis matrices by
Martellini and Ziemann (2010) uses the 1-factor and constant-correlation structured
comoment matrices as targets. In Boudt, Cornilly and Verdonck (2017) the framework
of single-target shrinkage for the coskewness and cokurtosis matrices is 
extended to a multi-target setting, making it possible to include several target matrices
at once. Also, an option to enhance small sample performance for coskewness estimation
was proposed, resulting in the option 'unbiasedMSE' present in the 'M3.shrink' function.
</p>
<p>The first four target matrices of the 'M2.shrink', 'M3.shrink' and 'M4.shrink' 
correspond to the models 'independent marginals', 'independent and identical marginals', 
'observed 1-factor model' and 'constant correlation'. Coskewness shrinkage includes two
more options, target 5 corresponds to the latent 1-factor model proposed in Simaan (1993)
and target 6 is the coskewness matrix under central-symmetry, a matrix full of zeros.
For more details on the targets, we refer to Boudt, Cornilly and Verdonck (2017) and
the supplementary appendix.
</p>
<p>If f is a matrix containing multiple factors, then the shrinkage estimator will
use each factor in a seperate single-factor model and use multi-target shrinkage
to all targets matrices at once.
</p>


<h3>Author(s)</h3>

<p>Dries Cornilly
</p>


<h3>References</h3>

<p>Boudt, Kris, Brian G. Peterson, and Christophe Croux. 2008.
Estimation and Decomposition of Downside Risk for Portfolios with Non-Normal
Returns. Journal of Risk. Winter.
</p>
<p>Boudt, Kris, Cornilly, Dries and Verdonck, Tim. 2017. A Coskewness Shrinkage 
Approach for Estimating the Skewness of Linear Combinations of Random Variables. 
Submitted. Available at SSRN: https://ssrn.com/abstract=2839781
</p>
<p>Ledoit, Olivier and Wolf, Michael. 2003. Improved estimation of the covariance matrix 
of stock returns with an application to portfolio selection. Journal of empirical 
finance, 10(5), 603-621.
</p>
<p>Ledoit, Olivier and Wolf, Michael. 2004. A well-conditioned estimator for large-dimensional 
covariance matrices. Journal of multivariate analysis, 88(2), 365-411.
</p>
<p>Martellini, Lionel and Ziemann, V\"olker. 2010. Improved estimates of higher-order 
comoments and implications for portfolio selection. Review of Financial 
Studies, 23(4), 1467-1502.
</p>
<p>Simaan, Yusif. 1993. Portfolio selection and asset pricing: three-parameter framework. 
Management Science, 39(5), 68-577.
</p>


<h3>See Also</h3>

<p><code>CoMoments</code> <br><code>StructuredMoments</code> <br><code>EWMAMoments</code> <br><code>MCA</code>
</p>


<h3>Examples</h3>

<pre><code class="language-R">
data(edhec)

# construct an underlying factor (market-factor, observed factor, PCA, ...)
f &lt;- rowSums(edhec)

# multi-target shrinkage with targets 1, 3 and 4
# as.mat = F' would speed up calculations in higher dimensions
targets &lt;- c(1, 3, 4)
sigma &lt;- M2.shrink(edhec, targets, f)$M2sh
m3 &lt;- M3.shrink(edhec, targets, f)$M3sh
m4 &lt;- M4.shrink(edhec, targets, f)$M4sh

# compute equal-weighted portfolio modified ES
mu &lt;- colMeans(edhec)
p &lt;- length(mu)
ES(p = 0.95, portfolio_method = "component", weights = rep(1 / p, p), mu = mu, 
    sigma = sigma, m3 = m3, m4 = m4)

# compare to sample method
sigma &lt;- cov(edhec)
m3 &lt;- M3.MM(edhec)
m4 &lt;- M4.MM(edhec)
ES(p = 0.95, portfolio_method = "component", weights = rep(1 / p, p), mu = mu, 
    sigma = sigma, m3 = m3, m4 = m4)

</code></pre>


</div>