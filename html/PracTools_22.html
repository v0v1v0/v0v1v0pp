<div class="container">

<table style="width: 100%;"><tr>
<td>GeoDistMOS</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>
Split geographic PSUs based on a measure of size threshold
</h2>

<h3>Description</h3>

<p>Split geographic PSUs into new geographically contiguous PSUs based on a maximum measure of size for each PSU
</p>


<h3>Usage</h3>

<pre><code class="language-R">   GeoDistMOS(lat, long, psuID, n, MOS.var, MOS.takeall = 1, Input.ID = NULL)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>lat</code></td>
<td>
<p>latitude variable in an input file. Must be in decimal format.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>long</code></td>
<td>
<p>longitude variable in an input file. Must be in decimal format.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>psuID</code></td>
<td>
<p>PSU Cluster ID from an input file.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>n</code></td>
<td>
<p>Sample size of PSUs; may be a preliminary value used in the computation to identify certainty PSUs</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>MOS.var</code></td>
<td>
<p>Variable used for probability proportional to size sampling</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>MOS.takeall</code></td>
<td>
<p>Threshold relative measure of size value for certainties; must satisfy 0 &lt; <code>MOS.takeall</code> &lt;= 1</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>Input.ID</code></td>
<td>
<p>ID variable from the input file</p>
</td>
</tr>
</table>
<h3>Details</h3>

<p><code>GeoDistMOS</code> splits geographic primary sampling units (PSUs) in the input object based on a variable which is used to create the measure of size for each PSU (<code>MOS.var</code>). The goal is to create PSUs of similarly sized MOS. The input file should have one row for each geographic unit, i.e. secondary sampling unit (SSU), with a PSU ID assigned. The latitude and longitude input vectors define the centroid of each input SSU. The complete linkage method for clustering is used. Accordingly, PSUs are split on a distance metric and not on the MOS threshold value. <code>GeoDistMOS</code> calls the function <code>inclusionprobabilities</code> from the <code>sampling</code> package to calculate the inclusion probability for each SSU within a PSU and <code>distHaversine</code> from the <code>geosphere</code> package to calculate the distances between centroids.
</p>


<h3>Value</h3>

<p>A list with two components:
</p>
<table>
<tr style="vertical-align: top;">
<td><code>PSU.ID.Max.MOS</code></td>
<td>
<p>A data frame containing the SSU ID value in character format (<code>Input.ID</code>), the original PSU ID (<code>psuID.orig</code>), and the new PSU ID after splitting for the maximum measure of size (<code>psuID.new</code>).</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>PSU.Max.MOS.Info</code></td>
<td>
<p>A data frame containing the new PSU ID (<code>psuID.new</code>) after splitting for the maximum Measure of Size, the inclusion probability of the PSU ID given the input sample size n (<code>psuID.prob</code>), the measure of size of the new PSU (<code>MOS</code>), the number of SSUs in the new PSU ID (<code>Number.SSUs</code>), and the means of the SSUs latitudes and longitudes that were combined to form the new PSU (<code>PSU.Mean.Latitude</code> and <code>PSU.Mean.Longitude</code>).</p>
</td>
</tr>
</table>
<h3>Author(s)</h3>

<p>George Zipf, Richard Valliant
</p>


<h3>See Also</h3>

<p><code>GeoDistPSU</code>, <code>GeoMinMOS</code>
</p>


<h3>Examples</h3>

<pre><code class="language-R">data(Test_Data_US)

   # Create PSU ID with GeoDistPSU
g &lt;- GeoDistPSU(Test_Data_US$lat,
                Test_Data_US$long,
                "miles",
                100,
                Input.ID = Test_Data_US$ID)
   # Append PSU ID to input file
library(dplyr)
Test_Data_US &lt;- dplyr::inner_join(Test_Data_US, g$PSU.ID, by=c("ID" = "Input.file.ID"))

   # Split PSUs with MOS above 0.80
m &lt;- GeoDistMOS(lat         = Test_Data_US$lat,
                long        = Test_Data_US$long,
                psuID       = Test_Data_US$psuID,
                n           = 15,
                MOS.var     = Test_Data_US$Amount,
                MOS.takeall = 0.80,
                Input.ID    = Test_Data_US$ID)

   # Create histogram of Measure of Size Values
hist(m$PSU.Max.MOS.Info$psuID.prob,
     breaks = seq(0, 1, 0.1),
     main = "Histogram of PSU Inclusion Probabilities (Certainties = 1)",
     xlab = "Inclusion Probability",
     ylab = "Frequency")
</code></pre>


</div>