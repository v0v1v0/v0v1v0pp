<div class="container">

<table style="width: 100%;"><tr>
<td>rbbinom</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>Sampling of beta-binomial data</h2>

<h3>Description</h3>

<p><code>rbbinom()</code> samples beta-binomial data according to Menssen and Schaarschmidt (2019).
</p>


<h3>Usage</h3>

<pre><code class="language-R">rbbinom(n, size, prob, rho)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>n</code></td>
<td>
<p>defines the number of clusters (<code class="reqn">i</code>)</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>size</code></td>
<td>
<p>integer vector defining the number of trials per cluster (<code class="reqn">n_i</code>)</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>prob</code></td>
<td>
<p>probability of success on each trial (<code class="reqn">\pi</code>)</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>rho</code></td>
<td>
<p>intra class correlation (<code class="reqn">\rho</code>)</p>
</td>
</tr>
</table>
<h3>Details</h3>

<p>For beta binomial data with <code class="reqn">i=1, ... I</code> clusters, the variance is
</p>
<p style="text-align: center;"><code class="reqn">var(y_i)= n_i \pi (1-\pi) [1+ (n_i - 1) \rho]</code>
</p>

<p>with <code class="reqn">\rho</code> as the intra class correlation coefficient
</p>
<p style="text-align: center;"><code class="reqn">\rho = 1 / (1+a+b).</code>
</p>

<p>For the sampling <code class="reqn">(a+b)</code> is defined as
</p>
<p style="text-align: center;"><code class="reqn">(a+b)=(1-\rho)/\rho</code>
</p>

<p>where <code class="reqn">a=\pi (a+b)</code> and <code class="reqn">b=(a+b)-a</code>. Then, the binomial proportions
for each cluster are sampled from the beta distribution
</p>
<p style="text-align: center;"><code class="reqn">\pi_i \sim Beta(a, b)</code>
</p>

<p>and the number of successes for each cluster are sampled to be
</p>
<p style="text-align: center;"><code class="reqn">y_i \sim Bin(n_i, \pi_i).</code>
</p>

<p>In this parametrization <code class="reqn">E(\pi_i)=\pi=a/(a+b)</code> and <code class="reqn">E(y_i)=n_i \pi</code>.
Please note, that <code class="reqn">1+ (n_i-1) \rho</code> is a constant if all cluster sizes are
the same and hence, in this special case, also the quasi-binomial assumption is
fulfilled.
</p>


<h3>Value</h3>

<p>a <code>data.frame</code> with two columns (succ, fail)
</p>


<h3>References</h3>

<p>Menssen M, Schaarschmidt F.: Prediction intervals for overdispersed binomial data
with application to historical controls. Statistics in Medicine. 2019;38:2652-2663.
<a href="https://doi.org/10.1002/sim.8124">doi:10.1002/sim.8124</a>
</p>


<h3>Examples</h3>

<pre><code class="language-R"># Sampling of example data
set.seed(234)
bb_dat1 &lt;- rbbinom(n=10, size=50, prob=0.1, rho=0.06)
bb_dat1


set.seed(234)
bb_dat2 &lt;- rbbinom(n=3, size=c(40, 50, 60), prob=0.1, rho=0.06)
bb_dat2


</code></pre>


</div>