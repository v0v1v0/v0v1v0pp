<div class="container">

<table style="width: 100%;"><tr>
<td>geneticBgEffects</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>Simulate infinitesimal genetic effects (reflecting sample kinship).</h2>

<h3>Description</h3>

<p>geneticBgEffects simulates an infinitesimal genetic effects with a proportion 
of the effect shared across samples and a proportion independent across 
samples; they are based on the kinship estimates of the (simulated) samples.
</p>


<h3>Usage</h3>

<pre><code class="language-R">geneticBgEffects(
  P,
  N,
  kinship,
  phenoID = "Trait_",
  id_samples = colnames(kinship),
  shared = TRUE,
  independent = TRUE,
  id_phenos = NULL
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>P</code></td>
<td>
<p>Number [integer] of phenotypes to simulate .</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>N</code></td>
<td>
<p>Number [integer] of samples to simulate; has to be provided as a 
dimnesionality check for kinship and downstream analyses; nrow(kinship) has 
to be equal to N.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>kinship</code></td>
<td>
<p>[N x N] Matrix of kinship estimates [double].</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>phenoID</code></td>
<td>
<p>Prefix [string] for naming traits.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>id_samples</code></td>
<td>
<p>Vector of [NrSamples] sample IDs [string]; if not provided
colnames(kinship) are used.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>shared</code></td>
<td>
<p>[bool] shared effect simulated if set to TRUE; at least one of 
shared or independent has to be set to TRUE.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>independent</code></td>
<td>
<p>[bool] independent effect simulated if set to TRUE.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>id_phenos</code></td>
<td>
<p>Vector of [NrTraits] phenotype IDs [string]; if not provided
constructed by paste(phenoID, 1:P, sep="").</p>
</td>
</tr>
</table>
<h3>Details</h3>

<p>For the simulation of the infinitesimal genetic effects, three 
matrix components are used: i) the kinship matrix K [N x N] which is treated 
as the sample design matrix, ii) matrix B [N x P] with vec(B) drawn from a 
normal distribution and iii) the trait design matrix A [P x P]. For the
independent effect, A is a diagonal matrix with normally distributed values.  
A for the shared effect is a matrix of rowrank one, with normally distributed 
entries in row 1 and zeros elsewhere. To construct the final effects, the 
three matrices are multiplied as: E = cholesky(K)BA^T.
</p>


<h3>Value</h3>

<p>Named list of shared infinitesimal genetic effects (shared: [N x P] 
matrix) and independent infinitesimal genetic effects (independent: [N x P] 
matrix), the covariance term of the shared effect (cov_shared: [P x P] 
matrix), the covariance term of the independent effect (cov_independent: 
[P x P] matrix), the eigenvectors (eigenvec_kinship: [N x N]) and eigenvalues
(eigenval_kinship: [N]) of the kinship matrix.
</p>


<h3>Examples</h3>

<pre><code class="language-R">genotypes &lt;- simulateGenotypes(N=100, NrSNP=400, verbose=FALSE)
kinship &lt;- getKinship(N=100, X=genotypes$genotypes, standardise=TRUE, 
verbose=FALSE)
geneticBg &lt;- geneticBgEffects(N=100, P=10, kinship=kinship)
</code></pre>


</div>