<div class="container">

<table style="width: 100%;"><tr>
<td>PD_ses</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>Phylogenetic diversity standardized for species richness</h2>

<h3>Description</h3>

<p>This function computes the standard effect size of PD by correcting for
changes in species richness. The novelty of this function is its ability
to utilize sparse community matrix making it possible to
efficiently randomize very large community matrices spanning thousands of
taxa and sites.
</p>


<h3>Usage</h3>

<pre><code class="language-R">PD_ses(
  x,
  phy,
  model = c("tipshuffle", "rowwise", "colwise"),
  reps = 10,
  metric = "pd",
  ...
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>x</code></td>
<td>
<p>a (sparse) community matrix, i.e. an object of class matrix or
Matrix.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>phy</code></td>
<td>
<p>a phylogenetic tree (object of class phylo).</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>model</code></td>
<td>
<p>The null model for separating patterns from processes and
for contrasting against alternative hypotheses. Available null models
include:
</p>

<ul>
<li> <p>“tipshuffle”: shuffles tip labels multiple times.
</p>
</li>
<li> <p>“rowwise”: shuffles sites (i.e., varying richness) and
keeping species occurrence frequency constant.
</p>
</li>
<li> <p>“colwise”: shuffles species occurrence frequency and
keeping site richness constant.</p>
</li>
</ul>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>reps</code></td>
<td>
<p>Number of replications.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>metric</code></td>
<td>
<p>The phylodiversity measure to compute.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>...</code></td>
<td>
<p>Further arguments passed to or from other methods.</p>
</td>
</tr>
</table>
<h3>Value</h3>

<p>A data frame of results for each community or grid cell
</p>

<ul>
<li>
<p> grids: Site identity
</p>
</li>
<li>
<p> richness: Number of taxa in community
</p>
</li>
<li>
<p> pd_obs: Observed PD in community
</p>
</li>
<li>
<p> pd_rand.mean: Mean PD in null communities
</p>
</li>
<li>
<p> pd_rand.sd: Standard deviation of PD in null communities
</p>
</li>
<li>
<p> pd_obs.rank: Rank of observed PD vs. null communities
</p>
</li>
<li>
<p> pd_obs.z: Standardized effect size of PD vs. null communities
<code class="reqn">= (pd_obs - pd_rand.mean) / pd_rand_sd</code>
</p>
</li>
<li>
<p> pvalue: P-value (quantile) of observed PD vs. null communities
<code class="reqn">= mpd_obs_rank / iter + 1</code>
</p>
</li>
<li>
<p> reps: Number of replicates
</p>
</li>
<li>
<p> p_obs_c_lower: Number of times observed value &lt; random value
</p>
</li>
<li>
<p> p_obs_c_upper: Number of times observed value &gt; random value
</p>
</li>
<li>
<p> p_obs_p_lower: Percentage of times observed value &lt; random value
</p>
</li>
<li>
<p> p_obs_p_upper: Percentage of times observed value &gt; random value
</p>
</li>
<li>
<p> p_obs_q: Number of the non-NA random values used for comparison
</p>
</li>
</ul>
<h3>References</h3>

<p>Proches, S., Wilson, J.R.U. &amp; Cowling, R.M. (2006) How much evolutionary
history in a 10 x 10m plot? <em>Proceedings of Royal Society B</em>
<strong>273</strong>: 1143-1148.
</p>


<h3>Examples</h3>

<pre><code class="language-R">library(ape)
library(Matrix)
tree &lt;- read.tree(text ="((t1:1,t2:1)N2:1,(t3:1,t4:1)N3:1)N1;")
com &lt;- sparseMatrix(c(1,3,4,1,4,5,1,2,3,4,5,6,3,4,6),
  c(1,1,1,2,2,2,3,3,3,3,3,3,4,4,4),x=1,
  dimnames = list(paste0("g", 1:6), tree$tip.label))

PD_ses(com, tree, model="rowwise")

</code></pre>


</div>