<div class="container">

<table style="width: 100%;"><tr>
<td>BCPNN</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>Bayesian confidence propagation neural network</h2>

<h3>Description</h3>

<p>Bayesian confidence propagation neural network (Bate et al. 1998, Noren et al. 2006) extended to the multiple comparison framework. 
</p>


<h3>Usage</h3>

<pre><code class="language-R">BCPNN(DATABASE, RR0 = 1, MIN.n11 = 1, DECISION = 1, DECISION.THRES = 0.05, 
RANKSTAT = 1, MC = FALSE, NB.MC = 10000)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>DATABASE</code></td>
<td>
<p>Object returned by the function <code>as.PhViD</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>RR0</code></td>
<td>
<p>Value of the tested risk. By default, <code>RR0=1</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>MIN.n11</code></td>
<td>
<p>Minimum number of notifications for a couple to be potentially considered as a signal. By default, <code>MIN.n11 = 1</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>DECISION</code></td>
<td>
<p>Decision rule for the signal generation based on
</p>
<p>1 = FDR (Default value)
</p>
<p>2 = Number of signals 
</p>
<p>3 = Ranking statistic. See <code>RANKSTAT</code></p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>DECISION.THRES</code></td>
<td>
<p>Threshold for <code>DECISION</code>. Ex 0.05 for FDR (<code>DECISION</code>=1). </p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>RANKSTAT</code></td>
<td>
<p>Statistic used for ranking the couples:
</p>
<p>1 = Posterior probability of the null hypothesis
</p>
<p>2 = 2.5% quantile of the posterior distribution of IC.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>MC</code></td>
<td>
<p>If <code>MC=TRUE</code>, the statistic of interest (see <code>RANKSTAT</code>) is calculated by Monte Carlo simulations which can be very long. If <code>MC=FALSE</code>, IC is approximated by a normal distribution (which can be very crude for small counts).</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>NB.MC</code></td>
<td>
<p>If <code>MC=TRUE</code>, <code>NB.MC</code> indicates the number of Monte Carlo simulations to be done</p>
</td>
</tr>
</table>
<h3>Details</h3>

<p>The BCPNN method is based on the calculation of the Information Component IC. If <code>MC = FALSE</code>, the bayesian model used is the beta-binomial proposed by Bate et al. (1998). The statistic of interest (see <code>RANKSTAT</code>) is calculated by the normal approximation made in Bate et al. (1998) with the use of the exact expectation and variance proposed by Gould (2003). If <code>MC = TRUE</code>, the model is based on the Dirichlet-multinomial model proposed more recently in Noren et al. (2006). In this case, the statistic of interest is calculated by Monte Carlo simulations. 
</p>


<h3>Value</h3>

<table>
<tr style="vertical-align: top;">
<td><code>ALLSIGNALS</code></td>
<td>
<p>Data.frame summarizing the results of all couples with at least <code>MIN.n11</code> notifications ordered by <code>RANKSTAT</code>. It contains notably the labels, the cell counts, the expected counts (<code class="reqn">n1. \times n.1 / N</code>, see <code>as.PhViD</code>), <code>RANKSTAT</code>, the ratios(count/expected count), the marginal counts and the estimations of FDR, FNR, Se et Sp. If <code>RANKSTAT!=1</code>, the last column is the posterior probability of the null hypothesis.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>SIGNALS</code></td>
<td>
<p>Same Data.frame as <code>ALLSIGNALS</code> but restricted to the list of generated signals.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>NB.SIGNALS</code></td>
<td>
<p>Number of generated signals.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>INPUT.PARAM</code></td>
<td>
<p>Parameters entered in the function.</p>
</td>
</tr>
</table>
<h3>Author(s)</h3>

<p>Ismaïl Ahmed &amp; Antoine Poncet</p>


<h3>References</h3>

<p>Ahmed I, Haramburu F, Fourrier-Réglat A, Thiessard F, Kreft-Jais C, Miremont-Salamé G, Bégaud B, Tubert-Bitter P. Bayesian pharmacovigilance signal detection methods revisited in a multiple comparison setting. Stat Med. 2009 Jun 15;28(13):1774-1792. 
</p>
<p>Bate A, Lindquist M, Edwards IR, Olsson S, Orre R, Lansner A, De Freitas RM, A Bayesian Neural Network Method for Adverse Drug Reaction Signal Generation European Journal of Clinical Pharmacology, 1998, 54, 315-321.
</p>
<p>Gould AL, Practical Pharmacovigilance Analysis Strategies Pharmacoepidemiology and Drug Safety, 2003, 12, 559-574
</p>
<p>Noren, GN, Bate A, Orre R, Edwards IR, Extending the methods used to screen the WHO drug safety database towards analysis of complex associations and improved accuracy for rare events Statistics in Medicine, 2006, 25, 3740-3757.
</p>


<h3>Examples</h3>

<pre><code class="language-R">## start
data(PhViDdata.frame)
PhViDdata &lt;- as.PhViD(PhViDdata.frame)
# res &lt;- BCPNN(PhViDdata)
## end
</code></pre>


</div>