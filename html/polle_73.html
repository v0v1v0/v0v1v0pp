<div class="container">

<table style="width: 100%;"><tr>
<td>sim_two_stage</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>Simulate Two-Stage Data</h2>

<h3>Description</h3>

<p>Simulate Two-Stage Data
</p>


<h3>Usage</h3>

<pre><code class="language-R">sim_two_stage(
  n = 10000,
  par = c(gamma = 0.5, beta = 1),
  seed = NULL,
  action_model_1 = function(C_1, beta, ...) stats::rbinom(n = NROW(C_1), size = 1, prob =
    lava::expit(beta * C_1)),
  action_model_2 = function(C_2, beta, ...) stats::rbinom(n = NROW(C_1), size = 1, prob =
    lava::expit(beta * C_2)),
  deterministic_rewards = FALSE
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>n</code></td>
<td>
<p>Number of observations.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>par</code></td>
<td>
<p>Named vector with distributional parameters.
</p>

<ul>
<li> <p><code>gamma</code>: <code class="reqn">\gamma</code>
</p>
</li>
<li> <p><code>beta</code>: <code class="reqn">\beta</code>
</p>
</li>
</ul>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>seed</code></td>
<td>
<p>Integer.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>action_model_1</code></td>
<td>
<p>Function used to specify the action/treatment at stage 1.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>action_model_2</code></td>
<td>
<p>Function used to specify the action/treatment at stage 2.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>deterministic_rewards</code></td>
<td>
<p>Logical. If TRUE, the deterministic reward
contributions are returned as well (columns U_1_A0, U_1_A1, U_2_A0, U_2_A1).</p>
</td>
</tr>
</table>
<h3>Details</h3>

<p><code>sim_two_stage</code> samples <code>n</code> iid observation
<code class="reqn">O</code> with the following distribution:
<code class="reqn">BB</code> is a random categorical variable with levels <code>group1</code>,
<code>group2</code>, and <code>group3</code>. Furthermore,
</p>
<p style="text-align: center;"><code class="reqn">
B \sim \mathcal{N}(0,1)\\
L_{1} \sim \mathcal{N}(0, 1)\\
C_{1} \mid L_{1} \sim \mathcal{N}(L_1, 1)\\
A_1 \mid C_1 \sim Bernoulli(expit(\beta C_1))\\
L_{2} \sim \mathcal{N} (0, 1)\\
C_{2} \mid A_1, L_1 \sim \mathcal{N}(\gamma L_1 + A_1, 1)\\
A_2 \mid C_2 \sim Bernoulli(expit(\beta C_2))\\
L_{3} \sim \mathcal{N} (0, 1)
</code>
</p>

<p>The rewards are calculated as
</p>
<p style="text-align: center;"><code class="reqn">
U_1 = L_1\\
U_2 = A_1\cdot C_1 + L_2 \\
U_3 = A_2\cdot C_2 + L_3.
</code>
</p>



<h3>Value</h3>

<p>data.table::data.table with n rows and columns B, BB, L_1, C_1, A_1, L_2, C_2,
A_2, L_3, U_1, U_2, U_3 (,U_1_A0, U_1_A1, U_2_A0, U_2_A1).
</p>


</div>