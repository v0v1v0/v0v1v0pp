<div class="container">

<table style="width: 100%;"><tr>
<td>plfd</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>PLFD</h2>

<h3>Description</h3>

<script id="MathJax-script" async src="../../mathjaxr/doc/mathjax/es5/tex-chtml-full.js"></script><p>A portmanteau local feature discrimination (PLFD) approach to the classification with
high-dimensional matrix-variate data.
</p>


<h3>Usage</h3>

<pre><code class="language-R">plfd(x, y, r0, c0, blockList, blockMode = NULL, permNum = 100, alpha = 0)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>x</code></td>
<td>
<p>Array of \(r \times c \times n\).</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>y</code></td>
<td>
<p>Vector of length-\(n\) with values 1 or 2.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>r0, c0</code></td>
<td>
<p>Row and column size of blocks. See details.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>blockList</code></td>
<td>
<p>List including the index set of pre-specified blocks. See details.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>blockMode</code></td>
<td>
<p>How the differential structure of \(M_1 - M_2\) are
detected. The default (<code>blockMode=NULL</code>) does NOT detect the structure of feature
blocks. If <code>blockMode="fd"</code>(or <code>"forward"</code>), a forward stepwise procedure is
conducted to detect the nonzero positions of feature blocks, wherein BIC serves
as the stopping rule.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>permNum</code></td>
<td>
<p>Rounds of permutation.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>alpha</code></td>
<td>
<p>The <strong>upper</strong>-\(\alpha\) quantile of the permutation statistic.</p>
</td>
</tr>
</table>
<h3>Details</h3>

<p>There are two ways to specify the blocks under consideration. In the case that
the matrix-variate is partition into non-overlapping blocks that share the common
row size and column size, these sizes can be specified by <code>r0</code> and <code>c0</code>. Otherwise, the
blocks can be flexibly specified by parameter <code>blockList</code>, which should be a list in
which each element includes <code>rIdx</code> and <code>cIdx</code> corresponding to the row and column index
set of a block. See examples.
</p>


<h3>Value</h3>

<p>List.
</p>

<ul>
<li> <p><code>n1</code>, <code>n2</code>, <code>rDim</code>, <code>cDim</code>, <code>blockMode</code>, <code>permNum</code>, <code>alpha</code>;
</p>
</li>
<li> <p><code>blockNumber</code>: the number of identified feature blocks.
</p>
</li>
<li> <p><code>paras</code>: <code>list(list(rIdx, cIdx, B, M), ...)</code>, list of the information of
feature blocks.
</p>
</li>
</ul>
<h3>References</h3>

<p>Xu Z., Luo S. and Chen Z. (2021). A Portmanteau Local Feature Discrimination
Approach to the Classification with High-dimensional Matrix-variate Data. Sankhya A.
<a href="https://doi.org/10.1007/s13171-021-00255-2">doi:10.1007/s13171-021-00255-2</a>
</p>


<h3>Examples</h3>

<pre><code class="language-R">set.seed(2023)
rDim &lt;- 20
cDim &lt;- 20

n &lt;- 100
y &lt;- sample(1:2, n, TRUE, c(0.5, 0.5))
x &lt;- array(rnorm(rDim*cDim*n), dim=c(rDim, cDim, n))
x[, , y==2] &lt;- (x[, , y==2] + 1.0)

ntest &lt;- 200
ytest &lt;- sample(1:2, ntest, TRUE, c(0.5, 0.5))
xtest &lt;- array(rnorm(rDim*cDim*ntest), dim=c(rDim, cDim, ntest))
xtest[, , ytest==2] &lt;- (xtest[, , ytest==2] + 1.0)

## Uniform partition
print( plfd(x, y, r0=5, c0=5) )

## Pre-specify feature blocks
blockList &lt;- list(list(rIdx=1:5, cIdx=1:5), 
                  list(rIdx=6:10, cIdx=1:5), 
                  list(rIdx=3:9, cIdx=2:8))
print( plfd.model &lt;- plfd(x, y, blockList=blockList) )

## Predict
predict(plfd.model, xtest, ytest)

</code></pre>


</div>