<div class="container">

<table style="width: 100%;"><tr>
<td>logitBvs</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>Bayesian variable selection for the binomial logit model</h2>

<h3>Description</h3>

<p>This function performs Bayesian variable selection for binomial logit regression
models via spike and slab priors. A cluster-specific random intercept can be included 
in the model to account for within-cluster dependence with variance selection of 
the random intercept to determine whether there is between-cluster variation 
in the model. For posterior inference, a MCMC sampling algorithm is used which 
is based on data augmentation.
</p>


<h3>Usage</h3>

<pre><code class="language-R">logitBvs(
  y,
  N,
  X,
  model = list(),
  prior = list(),
  mcmc = list(),
  start = NULL,
  BVS = TRUE
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>y</code></td>
<td>
<p>an integer vector of binomial counts</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>N</code></td>
<td>
<p>an integer vector containing the number of trials</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>X</code></td>
<td>
<p>a design matrix (including an intercept term)</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>model</code></td>
<td>
<p>an (optional) list specifying the structure of the model 
(see details)</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>prior</code></td>
<td>
<p>an (optional) list of prior settings and hyper-parameters 
controlling the priors (see details)</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>mcmc</code></td>
<td>
<p>an (optional) list of MCMC sampling options (see details)</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>start</code></td>
<td>
<p>an (optional), numeric vector containing starting values for the 
regression effects (including an intercept term); defaults to <code>NULL</code>
(i.e. a vector of zeros is used).</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>BVS</code></td>
<td>
<p>if <code>TRUE</code> (default), Bayesian variable selection is performed
to identify regressors with a non-zero effect; otherwise, an unrestricted 
model is estimated (without variable selection).</p>
</td>
</tr>
</table>
<h3>Details</h3>

<p>The method provides Bayesian variable selection for binomial logit models 
using mixture priors with a spike and a slab component to identify regressors 
with a non-zero effect. More specifically, a Dirac spike is used, i.e. a 
point mass at zero and (by default), the slab component is specified as a scale 
mixture of normal distributions, resulting in a Student-t distribution with 
2<code>psi.nu</code> degrees of freedom. 
In the more general random intercept model, variance selection of the random
intercept is based on the non-centered parameterization of the model, where
the signed standard deviation <code class="reqn">\theta_\alpha</code> of the random intercept term 
appears as a further regression effect in the model equation. 
For details, see Wagner and Duller (2012). 
</p>
<p>The implementation of Bayesian variable selection further relies on the 
representation of the binomial logit model as a Gaussian regression model 
in auxiliary variables. Data augmentation is based on Fussl et 
al. (2013), who show that the binomial logit model can be represented as a 
linear regression model in the latent variable, which has an interpretation as 
the difference of aggregated utilities. The error distribution in the auxiliary 
model is approximated by a finite scale mixture of normal distributions, where
the mixture parameters are taken from the R package <code>binomlogit</code>. 
See Fussl (2014) for details. 
</p>
<p>For details concerning the sampling algorithm see Dvorzak and Wagner (2016) 
and Wagner and Duller (2012). 
</p>
<p>Details for model specification (see arguments): 
</p>
 
<dl>
<dt>
<code>model</code>:</dt>
<dd>

<dl>
<dt><code>deltafix</code></dt>
<dd>
<p>an indicator vector of length <code>ncol(X)-1</code> 
specifying which regression effects are subject to selection (i.e., 0 =
subject to selection, 1 = fix in the model); defaults to a vector of zeros.</p>
</dd> 
<dt><code>gammafix</code></dt>
<dd>
<p>an indicator for variance selection of the random 
intercept term (i.e., 0 = with variance selection (default), 1 = no
variance selection); only used if a random intercept is includued in the 
model (see <code>ri</code>).</p>
</dd> 
<dt><code>ri</code></dt>
<dd>
<p>logical. If <code>TRUE</code>, a cluster-specific
random intercept is included in the model; defaults to <code>FALSE</code>.</p>
</dd> 
<dt><code>clusterID</code></dt>
<dd>
<p>a numeric vector of length equal to the number
of observations containing the cluster ID c = 1,...,C for each observation 
(required if <code>ri=TRUE</code>).</p>
</dd> 
</dl>
</dd>
<dt>
<code>prior</code>:</dt>
<dd>

<dl>
<dt><code>slab</code></dt>
<dd>
<p>distribution of the slab component, i.e. "<code>Student</code>" 
(default) or "<code>Normal</code>".</p>
</dd>
<dt><code>psi.nu</code></dt>
<dd>
<p>hyper-parameter of the Student-t slab (used for a 
"<code>Student</code>" slab); defaults to 5.</p>
</dd>
<dt><code>m0</code></dt>
<dd>
<p>prior mean for the intercept parameter; defaults to 0.</p>
</dd>
<dt><code>M0</code></dt>
<dd>
<p>prior variance for the intercept parameter; defaults to 100.</p>
</dd>
<dt><code>aj0</code></dt>
<dd>
<p>a vector of prior means for the regression effects (which
is encoded in a normal distribution, see notes); defaults to vector of zeros.</p>
</dd>
<dt><code>V</code></dt>
<dd>
<p>variance of the slab; defaults to 5.</p>
</dd>
<dt><code>w</code></dt>
<dd>
<p>hyper-parameters of the Beta-prior for the mixture weight
<code class="reqn">\omega</code>; defaults to <code>c(wa0=1, wb0=1)</code>, i.e. a uniform
distribution.</p>
</dd>
<dt><code>pi</code></dt>
<dd>
<p>hyper-parameters of the Beta-prior for the mixture weight 
<code class="reqn">\pi</code>; defaults to <code>c(pa0=1, pb0=1)</code>, i.e. a uniform 
distribution.</p>
</dd>
</dl>
</dd>
<dt>
<code>mcmc</code>:</dt>
<dd>

<dl>
<dt><code>M</code></dt>
<dd>
<p>number of MCMC iterations after the burn-in phase; defaults 
to 8000.</p>
</dd> 
<dt><code>burnin</code></dt>
<dd>
<p>number of MCMC iterations discarded as burn-in; 
defaults to 2000.</p>
</dd> 
<dt><code>thin</code></dt>
<dd>
<p>thinning parameter; defaults to 1.</p>
</dd> 
<dt><code>startsel</code></dt>
<dd>
<p>number of MCMC iterations drawn from the unrestricted
model (e.g., <code>burnin/2</code>); defaults to 1000.</p>
</dd> 
<dt><code>verbose</code></dt>
<dd>
<p>MCMC progress report in each <code>verbose</code>-th 
iteration step; defaults to 500. If <code>verbose=0</code>, no output is 
generated.</p>
</dd> 
<dt><code>msave</code></dt>
<dd>
<p>returns additional output with variable 
selection details (i.e. posterior samples for <code class="reqn">\omega</code>, 
<code class="reqn">\delta</code>, <code class="reqn">\pi</code>, <code class="reqn">\gamma</code>); defaults to <code>FALSE</code>.</p>
</dd> 
</dl>
</dd>
</dl>
<h3>Value</h3>

<p>The function returns an object of class "<code>pogit</code>" with methods
<code>print.pogit</code>, <code>summary.pogit</code> and 
<code>plot.pogit</code>. 
</p>
<p>The returned object is a list containing the following elements: 
</p>
<table>
<tr style="vertical-align: top;">
<td><code>samplesL</code></td>
<td>
<p>a named list containing the samples from the posterior
distribution of the parameters in the binomial logit model 
(see also <code>msave</code>): 
</p>

<dl>
<dt><code>alpha, thetaAlpha</code></dt>
<dd>
<p>regression coefficients <code class="reqn">\alpha</code> and
<code class="reqn">\theta_\alpha</code></p>
</dd>
<dt><code>pdeltaAlpha</code></dt>
<dd>
<p>P(<code class="reqn">\delta_\alpha</code>=1)</p>
</dd>
<dt><code>psiAlpha</code></dt>
<dd>
<p>scale parameter <code class="reqn">\psi_\alpha</code> of the slab component</p>
</dd>
<dt><code>pgammaAlpha</code></dt>
<dd>
<p>P(<code class="reqn">\gamma_\alpha</code>=1)</p>
</dd>
<dt><code>ai</code></dt>
<dd>
<p>cluster-specific random intercept</p>
</dd>
</dl>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>data</code></td>
<td>
<p>a list containing the data <code>y</code>, <code>N</code> and <code>X</code></p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>model.logit</code></td>
<td>
<p>a list containing details on the model specification, 
see details for <code>model</code></p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>mcmc</code></td>
<td>
<p>see details for <code>mcmc</code></p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>prior.logit</code></td>
<td>
<p>see details for <code>prior</code></p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>dur</code></td>
<td>
<p>a list containing the total runtime (<code>total</code>) 
and the runtime after burn-in (<code>durM</code>), in seconds</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>BVS</code></td>
<td>
<p>see arguments</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>start</code></td>
<td>
<p>a list containing starting values, see arguments</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>family</code></td>
<td>
<p>"logit"</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>call</code></td>
<td>
<p>function call</p>
</td>
</tr>
</table>
<h3>Note</h3>

<p>If prior information on the regression parameters is available, this
information is encoded in a normal distribution instead of the 
spike and slab prior (<code>BVS</code> is set to <code>FALSE</code>). 
</p>
<p>For binary observations, a vector of ones for the number of trials <code>N</code>
is required.
</p>


<h3>Author(s)</h3>

<p>Michaela Dvorzak &lt;m.dvorzak@gmx.at&gt;, Helga Wagner
</p>


<h3>References</h3>

<p>Dvorzak, M. and Wagner, H. (2016). Sparse Bayesian modelling
of underreported count data. <em>Statistical Modelling</em>, <strong>16</strong>(1),
24 - 46, <a href="https://doi.org/10.1177/1471082x15588398">doi:10.1177/1471082x15588398</a>.
</p>
<p>Fussl, A., Fruehwirth-Schnatter, S. and Fruehwirth, R. (2013). 
Efficient MCMC for Binomial Logit Models. <em>ACM Transactions on 
Modeling and Computer Simulation</em>, 23, <strong>1</strong>, Article 3, 1-21.
</p>
<p>Fussl, A. (2014). <code>binomlogit</code>: Efficient MCMC for Binomial 
Logit Models. R package version 1.2, 
<a href="https://CRAN.R-project.org/package=binomlogit">https://CRAN.R-project.org/package=binomlogit</a>.
</p>
<p>Wagner, H. and Duller, C. (2012). Bayesian model selection for 
logistic regression models with random intercept. <em>Computational 
Statistics and Data Analysis</em>, <strong>56</strong>, 1256-1274.
</p>


<h3>See Also</h3>

<p><code>pogitBvs</code>
</p>


<h3>Examples</h3>

<pre><code class="language-R">## Not run: 
## Examples below should take about 1-2 minutes.

# load simulated data set 'simul_binomial'
data(simul_binomial)
y &lt;- simul_binomial$y
N &lt;- simul_binomial$N
X &lt;- as.matrix(simul_binomial[, -c(1, 2)])

# Bayesian variable selection for simulated data set
m1 &lt;- logitBvs(y = y, N = N, X = X)

# print, summarize and plot results
print(m1)
summary(m1)
plot(m1)

# MCMC sampling without BVS with specific MCMC and prior settings
m2 &lt;- logitBvs(y = y, N = N, X = X, prior = list(slab = "Normal"), 
               mcmc = list(M = 4000, burnin = 1000, thin = 5),
               BVS = FALSE)
print(m2)    
summary(m2)
plot(m2, maxPlots = 4) 

# BVS with specification of regression effects subject to selection
m3 &lt;- logitBvs(y = y, N = N, X = X, mcmc = list(M = 4000, burnin = 1000), 
               model = list(deltafix = c(1, 1, 1, 0, 0, 0, 1, 0, 0)))   
print(m3)   
summary(m3)
plot(m3, burnin = FALSE, maxPlots = 4)
plot(m3, type = "acf", maxPlots = 4)       

## End(Not run)
</code></pre>


</div>