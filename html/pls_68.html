<div class="container">

<table style="width: 100%;"><tr>
<td>selectNcomp</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>Suggestions for the optimal number of components in PCR and PLSR models</h2>

<h3>Description</h3>

<p>Choosing the best number of components in PCR and PLSR models is difficult
and usually done on the basis of visual inspection of the validation plots.
In cases where large numbers of models are built this choice needs to be
automated. This function implements two proposals, one based on
randomization (permutation) testing, and an approach based on the standard
error of the cross-validation residuals.
</p>


<h3>Usage</h3>

<pre><code class="language-R">selectNcomp(
  object,
  method = c("randomization", "onesigma"),
  nperm = 999,
  alpha = 0.01,
  ncomp = object$ncomp,
  plot = FALSE,
  ...
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>object</code></td>
<td>
<p>an <code>mvr</code> object.  The fitted model. It should contain a
<code>validation</code> element.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>method</code></td>
<td>
<p>character string, indicating the heuristic to use.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>nperm</code></td>
<td>
<p>number of permutations in the <code>"randomization"</code> approach -
not used in the <code>"onesigma"</code> approach.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>alpha</code></td>
<td>
<p>cutoff for p values in the <code>"randomization"</code> approach -
not used in the <code>"onesigma"</code> approach.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>ncomp</code></td>
<td>
<p>maximum number of components to consider when determining the
global minimum in the cross-validation curve.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>plot</code></td>
<td>
<p>whether or not to show a cross-validation plot. The plot for the
<code>"randomization"</code> approach shows models that do not differ
significantly from the global RMSEP minimum with open circles; the
<code>"onesigma"</code> approach shows the one-sigma bands around the RMSEP
values. In both cases, the selection is indicated with a blue dashed line.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>...</code></td>
<td>
<p>Further plotting arguments, e.g., to add a title to the plot,
or to limit the plotting range.</p>
</td>
</tr>
</table>
<h3>Details</h3>

<p>In both approaches the results of cross-validation are used, so the model
should have been calculated with some form of cross-validation. First, the
absolute minimum in the CV curve is determined (considering only the first
ncomp components), leading to the reference model. The randomization test
approach (Van der Voet, 1994) checks whether the squared prediction errors
of models with fewer components are significantly larger than in the
reference model. This leads for each model considered to a <code class="reqn">p</code> value;
the smallest model not significantly worse than the reference model is
returned as the selected one.
</p>
<p>The approach <code>"onesigma"</code> simply returns the first model where the
optimal CV is within one standard error of the absolute optimum (Hastie,
Tibshirani and Friedman, 2009). Note that here we simply use the standard
deviation of the cross-validation residuals, in line with the procedure used
to calculate the error measure itself. Some other packages implementing
similar procedures (such as <code>glmnet</code>) calculate an error measure for
each validation segment separately and use the average as the final
estimate. In such cases the standard error across segments is the relevant
measure of spread. For LOO, the two procedures are identical. In other forms
of validation, small differences will occur.
</p>


<h3>Value</h3>

<p>A number indicating the suggested number of components in the model.
</p>


<h3>Author(s)</h3>

<p>Ron Wehrens, Hilko van der Voet and Gerie van der Heijden
</p>


<h3>References</h3>

<p>Van der Voet, H. (1994) Comparing the predictive accuracy of
models using a simple randomization test. Chemom. Intell. Lab. Syst. 25 (2),
313-323
</p>
<p>Hastie, T., Friedman, J. and Tibshirani, R. The Elements of Statistical
Learning: data mining, inference, and prediction, Springer (2013), 10th
printing with corrections, paragraph 7.10.
</p>


<h3>See Also</h3>

<p><code>mvr</code>, <code>summary.mvr</code>
</p>


<h3>Examples</h3>

<pre><code class="language-R">
data(yarn)
yarn.pls &lt;- plsr(density ~ NIR, data = yarn, scale = TRUE,
                 ncomp = 20, validation = "LOO")
selectNcomp(yarn.pls, "onesigma", plot = TRUE, ylim = c(0, 3))
selectNcomp(yarn.pls, "randomization", plot = TRUE)
selectNcomp(yarn.pls, "randomization", plot = TRUE,
            ncomp = 10, ylim = c(0, 3))

</code></pre>


</div>