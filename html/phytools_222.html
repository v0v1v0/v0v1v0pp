<div class="container">

<table style="width: 100%;"><tr>
<td>phylo.to.map</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>Plot tree with tips linked to geographic coordinates</h2>

<h3>Description</h3>

<p>Project a phylogeny on a geographic map.
</p>


<h3>Usage</h3>

<pre><code class="language-R">phylo.to.map(tree, coords, rotate=TRUE, ...)
## S3 method for class 'phylo.to.map'
plot(x, type=c("phylogram","direct"), ...)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>tree</code></td>
<td>
<p>an object of class <code>"phylo"</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>coords</code></td>
<td>
<p>a matrix containing the latitude (in column 1) and the longitude of all tip species in the tree. The row names should be the same as <code>tree$tip.label</code>; however, more than one set of coordinates per species can be supplied by duplicating some row names.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>rotate</code></td>
<td>
<p>a logical value indicating whether or not to rotate nodes of the tree to better match longitudinal positions.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>x</code></td>
<td>
<p>for <code>plot.phylo.to.map</code>, an object of class <code>"phylo.to.map"</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>type</code></td>
<td>
<p>a string indicating whether to map the tips of the tree onto a geographic map from a square phylogram (<code>type="phylogram"</code>) or to project the tree directly onto the map (<code>type="direct"</code>).</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>...</code></td>
<td>
<p>various optional arguments. For the function <code>phylo.to.map</code>, which first creates an object of the special class <code>"phylo.to.map"</code> and then (optionally) plots this object, arguments include: <code>database</code> and <code>regions</code> (see <code>map</code>), as well as any arguments that should be passed to <code>plot.phylo.to.map</code> internally. For <code>phylo.to.map</code>, optional arguments <code>xlim</code> and <code>ylim</code>, which control the plot area for the map; <code>fsize</code> for the font size of plot labels and <code>ftype</code> for the font type (following <code>plotSimmap</code>; <code>split</code> which controls the proportion of vertical (or horizontal) space for the tree (first) and map, in a vector; <code>psize</code> the size of the plotted points on the map - or <code>cex.points</code>, a vector contain the size of the tip points and geographic coordinate points, respectively; <code>from.tip</code> a logical value indicating whether to plot the linking lines from the tips (if <code>TRUE</code>) or from the end of the tip label, the default; <code>colors</code>, a single value or a vector of colors for the points and the linking lines; <code>pch</code> a single value or a vector of point types; <code>lwd</code> and <code>lty</code> for the linking lines; and <code>pts</code> a logical value indicating whether or not to plot points at the tips of the tree. <code>mar</code> and <code>asp</code> are as in <code>par</code>.</p>
</td>
</tr>
</table>
<h3>Details</h3>

<p><code>phylo.to.map</code> creates an object of class <code>"phylo.to.map"</code> and (optionally) plots that object.
</p>
<p><code>plot.phylo.to.map</code> plots an object of class <code>"phylo.to.map"</code> in which the tips of the tree point to coordinates on a geographic map.
</p>


<h3>Value</h3>

<p><code>phylo.to.map</code> creates an object of class <code>"phylo.to.map"</code> and  (if <code>plot=TRUE</code>) plots a phylogeny projected onto a geographic map.
</p>
<p><code>plot.phylo.to.map</code> plots on object of class <code>"phylo.to.map"</code>.
</p>


<h3>Author(s)</h3>

<p>Liam Revell <a href="mailto:liam.revell@umb.edu">liam.revell@umb.edu</a></p>


<h3>References</h3>

<p>Revell, L. J. (2014) Graphical methods for visualizing comparative data on phylogenies. Chapter 4 in <em>Modern phylogenetic comparative methods and their application in evolutionary biology: Concepts and practice</em> (L. Z. Garamszegi ed.), pp. 77-103.
</p>
<p>Revell, L. J. (2024) phytools 2.0: an updated R ecosystem for phylogenetic comparative methods (and other things). <em>PeerJ</em>, <b>12</b>, e16505.
</p>


<h3>Examples</h3>

<pre><code class="language-R">## generally recommend using higher resolution map
## e.g., from mapdata package
data(tortoise.tree)
data(tortoise.geog)
tortoise.phymap&lt;-phylo.to.map(tortoise.tree,
  tortoise.geog,plot=FALSE,direction="rightwards",
  regions="Ecuador")
plot(tortoise.phymap,direction="rightwards",pts=FALSE,
  xlim=c(-92.25,-89.25),ylim=c(-1.8,0.75),ftype="i",
  fsize=0.8,lty="dashed",map.bg="lightgreen",
  colors="slategrey")
## reset margins
par(mar=c(5.1,4.1,4.1,2.1))
</code></pre>


</div>