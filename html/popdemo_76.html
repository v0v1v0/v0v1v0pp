<div class="container">

<table style="width: 100%;"><tr>
<td>stoch</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>Project population dynamics</h2>

<h3>Description</h3>

<p>Analyse long-term dynamics of a stochastic population matrix projection model.
</p>


<h3>Usage</h3>

<pre><code class="language-R">stoch(
  A,
  what = "all",
  Aseq = "unif",
  vector = NULL,
  Astart = NULL,
  iterations = 10000,
  discard = 1000,
  PREcheck = FALSE
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>A</code></td>
<td>
<p>a list of matrices. <code>stoch</code> uses <code>project</code> to 
perform a stochastic' projection where the matrix varies with each timestep. 
The sequence of matrices is determined using <code>Aseq</code>. Matrices must be 
square, non-negative and numeric, and all matrices must have the same dimension.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>what</code></td>
<td>
<p>what should be returned. A character vector with possible entries
"lambda" (to calcualate stochastic growth), "var" (to calculate variance in 
stochastic growth) and/or "all" (to calculate both).</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>Aseq</code></td>
<td>
<p>the sequence of matrices in a stochastic projection. 
<code>Aseq</code> may be either:
</p>

<ul>
<li>
<p> "unif" (default), which results in every matrix in <code>A</code> having an 
equal, random chance of being chosen at each timestep.
</p>
</li>
<li>
<p> a square, nonnegative left-stochastic matrix describing a 
first-order markov chain used to choose the matrices. This should have the 
same dimension as the number of matrices in <code>A</code>. 
</p>
</li>
<li>
<p> a numeric vector giving a specific sequence which corresponds to the
matrices in <code>A</code>.
</p>
</li>
<li>
<p> a character vector giving a specific sequence which corresponds to the
names of the matrices in <code>A</code>.
</p>
</li>
</ul>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>vector</code></td>
<td>
<p>(optional) a numeric vector describing the age/stage 
distribution used to calculate the projection. If <code>vector</code> is not 
specified, a random vector is generated. Long-term stochastic dynamics should 
usually be the same for any vector, although if all the matrices in A are 
reducible (see <code>isIrreducible</code>), that may not be the case.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>Astart</code></td>
<td>
<p>(optional) in a stochastic projection, the matrix with which to
initialise the projection (either numeric, corresponding to the matrices in 
<code>A</code>, or character, corresponding to the names of matrices in <code>A</code>). 
When <code>Astart = NULL</code>, a random initial matrix is chosen.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>iterations</code></td>
<td>
<p>the number of projection intervals. The default is 1e+5.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>discard</code></td>
<td>
<p>the number of initial projection intervals to discard, to 
discount near-term effects arising from the choice of vector. The default is
1e+3</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>PREcheck</code></td>
<td>
<p>many functions in <code>popdemo</code> first check Primitivity, 
Reducibility and/or Ergodicity of matrices, with associated warnings and/or 
errors if a matrix breaks any assumptions. Set <code>PREcheck=FALSE</code> if you
want to bypass these checks.</p>
</td>
</tr>
</table>
<h3>Details</h3>

<p>Calculates stochastic growth and its variance for a given stochastic population 
matrix projection model.
</p>


<h3>Value</h3>

<p>A numeric vector with two possible elements: "lambda" (the stochastic population
growth rate) and "var" (the variance in stochastic population growth rate). Values
returned depend on what's passed to <code>what</code>.
</p>


<h3>Examples</h3>

<pre><code class="language-R">  # load the Polar bear data
  ( data(Pbear) )

  # Find the stochastic growth for a time series with uniform probability of each
  # matrix
  ( lambda_unif &lt;- stoch(Pbear, what = "lambda", Aseq = "unif") )

  # Find the variance in stochastic growth for a time series with uniform 
  # probability of each matrix
  ( var_unif &lt;- stoch(Pbear, what = "var", Aseq = "unif") )
                 
  # Find stochastic growth and its variance for a time series with a sequence of
  # matrices where "bad" years happen with probability q
  q &lt;- 0.5
  prob_seq &lt;- c(rep(1-q,3)/3, rep(q,2)/2)
  Pbear_seq &lt;- matrix(rep(prob_seq,5), 5, 5)
  ( var_unif &lt;- stoch(Pbear, what = "var", Aseq = Pbear_seq) )
  
</code></pre>


</div>