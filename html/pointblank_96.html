<div class="container">

<table style="width: 100%;"><tr>
<td>get_data_extracts</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>Collect data extracts from a validation step</h2>

<h3>Description</h3>

<p>In an agent-based workflow (i.e., initiating with <code>create_agent()</code>), after
interrogation with <code>interrogate()</code>, we can extract the row data that didn't
pass row-based validation steps with the <code>get_data_extracts()</code> function.
There is one discrete extract per row-based validation step and the amount of
data available in a particular extract depends on both the fraction of test
units that didn't pass the validation step and the level of sampling or
explicit collection from that set of units. These extracts can be collected
programmatically through <code>get_data_extracts()</code> but they may also be
downloaded as CSV files from the HTML report generated by the agent's print
method or through the use of <code>get_agent_report()</code>.
</p>
<p>The availability of data extracts for each row-based validation step depends
on whether <code>extract_failed</code> is set to <code>TRUE</code> within the <code>interrogate()</code> call
(it is by default). The amount of <em>fail</em> rows extracted depends on the
collection parameters in <code>interrogate()</code>, and the default behavior is to
collect up to the first 5000 <em>fail</em> rows.
</p>
<p>Row-based validation steps are based on those validation functions of the
form <code style="white-space: pre;">⁠col_vals_*()⁠</code> and also include <code>conjointly()</code> and <code>rows_distinct()</code>.
Only functions from that combined set of validation functions can yield data
extracts.
</p>


<h3>Usage</h3>

<pre><code class="language-R">get_data_extracts(agent, i = NULL)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>agent</code></td>
<td>
<p><em>The pointblank agent object</em>
</p>
<p><code style="white-space: pre;">⁠obj:&lt;ptblank_agent&gt;⁠</code> // <strong>required</strong>
</p>
<p>A <strong>pointblank</strong> <em>agent</em> object that is commonly created through the use of
the <code>create_agent()</code> function. It should have had <code>interrogate()</code> called on
it, such that the validation steps were carried out and any sample rows
from non-passing validations could potentially be available in the object.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>i</code></td>
<td>
<p><em>A validation step number</em>
</p>
<p><code style="white-space: pre;">⁠scalar&lt;integer&gt;⁠</code> // <em>default:</em> <code>NULL</code> (<code>optional</code>)
</p>
<p>The validation step number, which is assigned to each validation step by
<strong>pointblank</strong> in the order of definition. If <code>NULL</code> (the default), all
data extract tables will be provided in a list object.</p>
</td>
</tr>
</table>
<h3>Value</h3>

<p>A list of tables if <code>i</code> is not provided, or, a standalone table if
<code>i</code> is given.
</p>


<h3>Examples</h3>

<p>Create a series of two validation steps focused on testing row values for
part of the <code>small_table</code> object. Use <code>interrogate()</code> right after that.
</p>
<div class="sourceCode r"><pre>agent &lt;-
  create_agent(
    tbl = small_table %&gt;%
      dplyr::select(a:f),
    label = "`get_data_extracts()`"
  ) %&gt;%
  col_vals_gt(d, value = 1000) %&gt;%
  col_vals_between(
    columns = c,
    left = vars(a), right = vars(d),
    na_pass = TRUE
  ) %&gt;%
  interrogate()
</pre></div>
<p>Using <code>get_data_extracts()</code> with its defaults returns of a list of tables,
where each table is named after the validation step that has an extract
available.
</p>
<div class="sourceCode r"><pre>agent %&gt;% get_data_extracts()
</pre></div>
<pre>## $`1`
## # A tibble: 6 × 6
##       a b             c     d e     f    
##   &lt;int&gt; &lt;chr&gt;     &lt;dbl&gt; &lt;dbl&gt; &lt;lgl&gt; &lt;chr&gt;
## 1     8 3-ldm-038     7  284. TRUE  low  
## 2     7 1-knw-093     3  843. TRUE  high 
## 3     3 5-bce-642     9  838. FALSE high 
## 4     3 5-bce-642     9  838. FALSE high 
## 5     4 2-dmx-010     7  834. TRUE  low  
## 6     2 7-dmx-010     8  108. FALSE low  
## 
## $`2`
## # A tibble: 4 × 6
##       a b             c     d e     f    
##   &lt;int&gt; &lt;chr&gt;     &lt;dbl&gt; &lt;dbl&gt; &lt;lgl&gt; &lt;chr&gt;
## 1     6 8-kdg-938     3 2343. TRUE  high 
## 2     8 3-ldm-038     7  284. TRUE  low  
## 3     7 1-knw-093     3  843. TRUE  high 
## 4     4 5-boe-639     2 1036. FALSE low</pre>
<p>We can get an extract for a specific step by specifying it in the <code>i</code>
argument. Let's get the failing rows from the first validation step (the
<code>col_vals_gt()</code> one).
</p>
<div class="sourceCode r"><pre>agent %&gt;% get_data_extracts(i = 1)
</pre></div>
<pre>## # A tibble: 6 × 6
##       a b             c     d e     f    
##   &lt;int&gt; &lt;chr&gt;     &lt;dbl&gt; &lt;dbl&gt; &lt;lgl&gt; &lt;chr&gt;
## 1     8 3-ldm-038     7  284. TRUE  low  
## 2     7 1-knw-093     3  843. TRUE  high 
## 3     3 5-bce-642     9  838. FALSE high 
## 4     3 5-bce-642     9  838. FALSE high 
## 5     4 2-dmx-010     7  834. TRUE  low  
## 6     2 7-dmx-010     8  108. FALSE low</pre>


<h3>Function ID</h3>

<p>8-2
</p>


<h3>See Also</h3>

<p>Other Post-interrogation: 
<code>all_passed()</code>,
<code>get_agent_x_list()</code>,
<code>get_sundered_data()</code>,
<code>write_testthat_file()</code>
</p>


</div>