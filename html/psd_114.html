<div class="container">

<table style="width: 100%;"><tr>
<td>spec_confint</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>Confidence intervals for multitaper power spectral density estimates</h2>

<h3>Description</h3>

<p>Confidence intervals for multitaper power spectral density estimates
</p>


<h3>Usage</h3>

<pre><code class="language-R">spec_confint(x, ...)

## S3 method for class 'spec'
spec_confint(x, ...)

## S3 method for class 'tapers'
spec_confint(x, ...)

## Default S3 method:
spec_confint(x, ...)

.spec_confint(dof, p = 0.95, as.db = FALSE, ...)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>x</code></td>
<td>
<p>object to calculate spectral properties</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>...</code></td>
<td>
<p>additional arguments</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>dof</code></td>
<td>
<p>numeric; the degrees of freedom <code class="reqn">\nu</code></p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>p</code></td>
<td>
<p>numeric; the coverage probability <code class="reqn">p</code>, bound within <code class="reqn">[0,1)</code></p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>as.db</code></td>
<td>
<p>logical; should the values be returned as decibels?</p>
</td>
</tr>
</table>
<h3>Details</h3>

<p>The errors are estimated 
from the number of degrees of freedom <code class="reqn">\nu</code> by evaluating
the <code class="reqn">\chi_{p,\nu}^{2}(\nu,\nu)</code> distribution for an optional 
coverage probability <code class="reqn">p</code> (defaulting to <code class="reqn">p=0.95</code>).  
Additionally, the
<code class="reqn">p=0.5</code> values and an approximation from <code class="reqn">1/\sqrt{\nu - 1}</code>
are returned.
</p>
<p>A more 
sophisticated (and complicated) approach would be to
estimate via jack-knifing (Prieto et al 2007), but this is not yet
made available.
</p>
<p>Additive uncertainties <code class="reqn">\delta S</code> are returned, such that 
the spectrum with confidence interval is <code class="reqn">S \pm \delta S</code>.
</p>


<h3>Value</h3>

<p>A <code>data.frame</code> with the following properties (and names):
</p>

<ul>
<li>
<p><code>lower</code>: Based on upper tail probabilities (<code class="reqn">p</code>)
</p>
</li>
<li>
<p><code>upper</code>: Based on lower tail probabilities (<code class="reqn">1-p</code>)
</p>
</li>
<li>
<p><code>median</code>: Based on lower tail probabilities (<code class="reqn">p=0.5</code>)
</p>
</li>
<li>
<p><code>approx</code>: Approximation based on <code class="reqn">1/\sqrt(\nu - 1)</code>.
</p>
</li>
</ul>
<h3>Author(s)</h3>

<p>A.J. Barbour; some code modified from the <code>spec.ci</code> function inside <code>stats::plot.spec</code>
</p>


<h3>See Also</h3>

<p><code>spectral_properties</code>, <code>psd-package</code>, <code>stats::plot.spec</code>, <code>dB</code>
</p>


<h3>Examples</h3>

<pre><code class="language-R">## Not run: #REX
library(psd)

##
## Confidence intervals from taper numbers
##

sp &lt;- spectral_properties(as.tapers(1:50), p=0.95, db.ci=TRUE)

# standard errors as a function of tapers
par(las=1)
plot(stderr.chi.upper ~ taper, sp, type="s",
       ylim=c(-10,20), yaxs="i", xaxs="i",
       xlab=expression("number of tapers ("* nu/2 *")"), ylab="dB",
       main="Spectral uncertainties")
mtext("(additive factor)", line=.3)
lines(stderr.chi.lower ~ taper, sp, type="s")
lines(stderr.chi.median ~ taper, sp, type="s", lwd=2)
lines(stderr.chi.approx ~ taper, sp, type="s", col="red",lwd=2)
# indicate K needed to reach 3 dB wide confidence interval (p=.95)
abline(v=33, lty=3)
legend("topright",
        c(expression("Based on "* chi^2 *"(p,"*nu*") and (1-p,"*nu*")"),
          expression(""* chi^2 *"(p=0.5,"*nu*")"),
          "approximation"),
       lwd=c(1,3,3),
       col=c("black","black","red"),
       bg="grey98")


## End(Not run)#REX
</code></pre>


</div>