<div class="container">

<table style="width: 100%;"><tr>
<td>calc_t</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>Calculate Canonical Statistic for Potts Model</h2>

<h3>Description</h3>

<p>Calculate the canonical statistic 't' for a realization of a Potts
Model
</p>


<h3>Usage</h3>

<pre><code class="language-R">calc_t_full(x,ncolor)
calc_t_innergrid(x, ncolor, grid, i, j)
calc_t(x, ncolor, grid=NULL, i=NULL, j=NULL)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>x</code></td>
<td>
<p>2 dimensional matrix, elements in 1, ..., <code>ncolor</code>,
representing a Potts model</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>ncolor</code></td>
<td>
<p>numeric. Number of colors in this Potts Model.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>grid</code></td>
<td>
<p>numeric. 2 dimensional matrix, elements in 1, ...,
<code>ncolor</code>.  If non-NULL it is placed into <code>x</code> at the location
<code>x[i,j]</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>i</code></td>
<td>
<p>numeric.  Row to place the grid.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>j</code></td>
<td>
<p>numeric.  Column to place the grid.</p>
</td>
</tr>
</table>
<h3>Details</h3>

<p>For a description of notation and terminology, see
<code>composite.ll</code>.
</p>
<p>Calculates the canonical statistics for a realized Potts Model.
<code>calc_t</code> calls <code>calc_t_full</code> if <code>grid</code> is <code>NULL</code>
and <code>calc_t_innergrid</code> otherwise.
</p>
<p><code>calc_t_full</code> calculates the canonical statistics for the full image.
</p>
<p><code>calc_t_innergrid</code> calculates the canonical statistics for the a
window of the image, but with that window replaced by <code>grid</code>,
with the upper left corner of <code>grid</code> located at <code>x[i,j]</code>.
</p>


<h3>Value</h3>

<p>For a description of notation and terminology, see
<code>composite.ll</code>.
</p>
<p>All functions return a vector of length <code>ncolor+1</code>.  Elements
1,...,<code>ncolor</code> contain the number of pixels of each color.
Element <code>ncolor+1</code> contains the number of matching neighbor pairs
for the image.
</p>
<p><code>calc_t_full</code> returns the values for the whole image.
</p>
<p><code>calc_t_innergrid</code> returns the value for just the selected
window, but this includes the number of matching pairs from the
replaced window to it's neighbors.  E.g. if <code>X</code> is the full
image, and <code class="reqn">A_a</code> is the value of some window in the image
and we want to know the value of <code class="reqn">t(y \cup X \setminus
  A_a)</code> this would be <code>calc_t_full(X,
  ncolor) + calc_t_innergrid(X, ncolor, y, i, j) - calc_t_innergrid(X,
  ncolor, A(a), i, j)</code>
</p>


<h3>See Also</h3>

<p><code>generate_t_cache</code>, <code>composite.ll</code>.
</p>


<h3>Examples</h3>

<pre><code class="language-R">
ncolor &lt;- 4
beta   &lt;- log(1+sqrt(ncolor))
theta  &lt;- c(rep(0,ncolor), beta)

nrow &lt;- 32
ncol &lt;- 32

x &lt;- matrix(sample(ncolor, nrow*ncol, replace=TRUE), nrow=nrow, ncol=ncol)
foo &lt;- packPotts(x, ncolor)
out &lt;- potts(foo, theta, nbatch=10)
x &lt;- unpackPotts(out$final)

t_stat &lt;- calc_t(x, ncolor)
t_stat_inner &lt;- calc_t(x, ncolor, matrix(1, nrow=2, ncol=2), 1, 1)

</code></pre>


</div>