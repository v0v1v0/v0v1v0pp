<div class="container">

<table style="width: 100%;"><tr>
<td>repo</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>Query and manipulate CRAN-like repositories</h2>

<h3>Description</h3>

<p>These functions are currently experimental.
</p>


<h3>Details</h3>



<h4>List packages in a repository</h4>

<p><code>repo$list()</code> lists packages in a repository. It reads the <code>PACKAGES</code>
file containing the repository metadata.
</p>


<h5>Usage</h5>

<div class="sourceCode"><pre>repo_list(..., path = ".")
</pre></div>



<h5>Arguments</h5>


<ul>
<li> <p><code>...</code>: ignored currently.
</p>
</li>
<li> <p><code>path</code>: path to repository. Must contain a <code>PACKAGES</code> file.
</p>
</li>
</ul>
<h5>Value</h5>

<p>Data frame of package data, a data frame with at least the following
columns, possibly more if there are other entries in the metadata:
</p>

<ul>
<li> <p><code>Package</code>
</p>
</li>
<li> <p><code>Version</code>
</p>
</li>
<li> <p><code>Depends</code>
</p>
</li>
<li> <p><code>Imports</code>
</p>
</li>
<li> <p><code>Suggests</code>
</p>
</li>
<li> <p><code>Enhances</code>
</p>
</li>
<li> <p><code>LinkingTo</code>
</p>
</li>
<li> <p><code>License</code>
</p>
</li>
<li> <p><code>File</code>
</p>
</li>
<li> <p><code>DownloadURL</code>
</p>
</li>
<li> <p><code>OS</code>
</p>
</li>
<li> <p><code>Arch</code>
</p>
</li>
<li> <p><code>Built</code>
</p>
</li>
<li> <p><code>Filesize</code>
</p>
</li>
<li> <p><code>SHA256</code>
</p>
</li>
<li> <p><code>RVersion</code>
</p>
</li>
<li> <p><code>Platform</code>
</p>
</li>
<li> <p><code>GraphicsAPIVersion</code>
</p>
</li>
<li> <p><code>InternalsId</code>
</p>
</li>
</ul>
<h4>Delete packages from repository metadata</h4>

<p><code>repo$delete()</code> deletes matching packages from the repository
metadata.
</p>


<h5>Description</h5>

<p>All matching packages will be removed.
It does not delete the files themselves.
</p>



<h5>Usage</h5>

<div class="sourceCode"><pre>repo$delete(package, ..., path = ".")
</pre></div>



<h5>Arguments</h5>


<ul>
<li> <p><code>package</code>: package name.
</p>
</li>
<li> <p><code>...</code>: other fields to match, they must be named. Matching is
case insensitive.
</p>
</li>
<li> <p><code>path</code>: path to repository. Must contain a <code>PACKAGES</code> file.
</p>
</li>
</ul>
<h4>Add a package to a repository</h4>



<h5>Description</h5>

<p>It does not check if any version of the package is already
in the repository. If you want to <em>update</em> a package, use
<code>repo$update()</code>.
</p>



<h5>Usage</h5>

<div class="sourceCode"><pre>repo$add(file, ..., path = ".")
</pre></div>



<h5>Arguments</h5>


<ul>
<li>
<p> 'file Package file.
</p>
</li>
<li>
<p> '... Ignored currently.
</p>
</li>
<li> <p><code style="white-space: pre;">⁠path Path to repository. Must contain a ⁠</code>PACKAGES' file.
</p>
</li>
</ul>
<h4>Update a package in a repository</h4>



<h5>Description</h5>

<p>Previous version of the same package are removed. In particular,
it removes packages with matching:
</p>

<ul>
<li>
<p> package name (<code>Package</code> field),
</p>
</li>
<li>
<p> R version (<code>Rversion</code> field),
</p>
</li>
<li>
<p> same OS (<code>OS</code> field), or no <code>OS</code> field,
</p>
</li>
<li>
<p> same architecture (<code>Arch</code> field), or not <code>Arch</code> field.
</p>
</li>
</ul>
<h5>Usage</h5>

<div class="sourceCode"><pre>repo$update(file, ..., path = ".")
</pre></div>



<h5>Arguments</h5>


<ul>
<li>
<p> 'file Package file.
</p>
</li>
<li>
<p> '... Ignored currently.
</p>
</li>
<li> <p><code style="white-space: pre;">⁠path Path to repository. Must contain a ⁠</code>PACKAGES' file.
</p>
</li>
</ul>
<h4>Update a file in a package metadata, stored on GitHub</h4>



<h5>Description</h5>


<ol>
<li>
<p> Clones the GitHub repository.
</p>
</li>
<li>
<p> Calls <code>repo_update()</code> with <code>file</code>, in the <code>subdir</code> directory.
</p>
</li>
<li>
<p> Adds and commits changes.
</p>
</li>
<li>
<p> Pushes the git repository to GitHub.
If the push fails, then it resets the git repository, pulls it from
GitHub and tries the update process again, until the push succeeds.
</p>
</li>
</ol>
<p>This function needs command line git installed.
</p>
<p>It sets up a <code>cache</code> credential helper, so the <code style="white-space: pre;">⁠git push⁠</code> works
without interaction with the user.
</p>



<h5>Usage</h5>

<div class="sourceCode"><pre>repo$update_gh(repo, subdir, files)
</pre></div>



<h5>Arguments</h5>


<ul>
<li> <p><code>repo</code>: GitHub slug, e.g. <code>r-hub/repos</code>.
</p>
</li>
<li> <p><code>subdir</code>: subdirectory in the GitHub repository, where the R package
metadata should be updated. It must exist in the repository.
If it does not have <code style="white-space: pre;">⁠PACKAGES*⁠</code> files, then they will be created.
</p>
</li>
<li> <p><code>files</code>: package files to add. The files will <em>not</em> be added to the
repository, only to the metadata. They should be in the repository
already.
</p>
</li>
</ul>
</div>