<div class="container">

<table style="width: 100%;"><tr>
<td>PINstimation-package</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>An R package for estimating the probability of informed trading</h2>

<h3>Description</h3>

<p>The package provides utilities for the estimation
of probability of informed trading measures: original PIN (<code>PIN</code>) as
introduced by Easley and Ohara (1992) and
Easley et al. (1996)
, multilayer PIN (<code>MPIN</code>) as introduced by
Ersan (2016), adjusted PIN (<code>AdjPIN</code>) model
as introduced in Duarte and Young (2009), and
volume-synchronized PIN (<code>VPIN</code>) as introduced by
Easley et al. (2011) and
Easley et al. (2012). Estimations of
<code>PIN</code>, <code>MPIN</code>, and <code>adjPIN</code> are subject to floating-point exception
error, and are sensitive to the choice of initial values.
Therefore, researchers developed factorizations of the model likelihood
functions as well as algorithms for determining initial parameter sets for
the maximum likelihood estimation - (MLE henceforth).
<br><br><br> As for the factorizations, the package includes three
different factorizations of the <code>PIN</code> likelihood function :<code>fact_pin_eho()</code>
as in Easley et al. (2010), <code>fact_pin_lk()</code> as in
Lin and Ke (2011), and <code>fact_pin_e()</code> as in
Ersan (2016);
one factorization for <code>MPIN</code> likelihood function: <code>fact_mpin()</code> as in
Ersan (2016); and one factorization for
<code>AdjPIN</code> likelihood function: <code>fact_adjpin()</code> as in
Ersan and Ghachem (2022b).
<br><br> The package implements three algorithms to generate initial
parameter sets for the MLE of the <code>PIN</code> model in: <code>initials_pin_yz()</code>
for the algorithm of Yan and Zhang (2012),
<code>initials_pin_gwj()</code> for the algorithm of
Gan et al. (2015), and <code>initials_pin_ea()</code> for the
algorithm of Ersan and Alici (2016). As for the
initial parameter sets for the MLE of the <code>MPIN</code> model, the function
<code>initials_mpin()</code> implements a multilayer extension of the algorithm of
Ersan and Alici (2016). Finally, three functions
implement three algorithms of initial parameter sets for the MLE of
the <code>AdjPIN</code> model, namely <code>initials_adjpin()</code> for the algorithm in
Ersan and Ghachem (2022b), <code>initials_adjpin_cl()</code>
for the algorithm of Cheng and Lai (2021); and
<code>initials_adjpin_rnd()</code> for randomly generated initial parameter sets.
The choice of the initial parameter sets can be done directly, either using
specific functions implementing MLE for the PIN model, such as, <code>pin_yz()</code>,
<code>pin_gwj()</code>, <code>pin_ea()</code>; or through the argument <code>initialsets</code> in generic
functions implementing MLE for the <code>MPIN</code> and <code>AdjPIN</code> models, namely
<code>mpin_ml()</code>, and <code>adjpin()</code>.
Besides, <code>PIN</code>, <code>MPIN</code> and <code>AdjPIN</code> models can be estimated using custom
initial parameter set(s) provided by the user and fed through
the argument <code>initialsets</code> for the functions <code>pin()</code>, <code>mpin_ml()</code> and
<code>adjpin()</code>. Through the function <code>get_posteriors()</code>, the package also
allows users to assign, for each day in the sample, the posterior
probability that the day is a no-information day, good-information day
and bad-information day.
<br><br> As an alternative to the standard maximum likelihood estimation,
estimation via expectation conditional maximization algorithm (<code>ECM</code>)
is suggested in Ghachem and Ersan (2022a), and is
implemented through the function <code>mpin_ecm()</code> for the <code>MPIN</code> model, and
the function <code>adjpin()</code> for the <code>AdjPIN</code> model.
<br><br> Dataset(s) of daily aggregated numbers of buys and sells with user
determined number of information layers can be simulated with the function
<code>generatedata_mpin()</code> for the <code>MPIN</code> (<code>PIN</code>) model;
and <code>generatedata_adjpin()</code>
for the <code>AdjPIN</code> model. The output of these functions contains the
theoretical parameters used in the data generation, empirical parameters
computed from the generated data, alongside the generated data itself.
Data simulation functions allow for broad customization
to produce data that fit the user's preferences. Therefore, simulated data
series can be utilized in comparative analyses for the applied methods in
different scenarios. Alternatively, the user can use two example datasets
preloaded in the package: <code>dailytrades</code> as a representative of a quarterly
trade data with daily buys and sells; and <code>hfdata</code> as a simulated
high-frequency dataset comprising <code style="white-space: pre;">⁠100 000⁠</code> trades.
<br><br> Finally, the package provides two functions to deal with
high-frequency data.
First, the function <code>vpin()</code> estimates and provides detailed output on the
order flow toxicity metric, volume-synchronized probability of informed
trading, as developed in Easley et al. (2011) and
Easley et al. (2012). Second, the function
<code>aggregate_trades()</code> aggregates the high-frequency trade-data into daily
data using several trade classification algorithms, namely the <code>tick</code>
algorithm, the <code>quote</code> algorithm, <code>LR</code> algorithm
(Lee and Ready 1991) and the <code>EMO</code>
algorithm (Ellis et al. 2000).
<br><br> The package provides fast, compact, and precise utilities to tackle
the sophisticated, error-prone, and time-consuming estimation procedure of
informed trading, and this solely using the raw trade-level data.
Ghachem and Ersan (2022b)
provides comprehensive overview of the package: it first
details the underlying theoretical background, provides a thorough
description of the functions, before using them to tackle relevant
research questions.
</p>


<h3>Functions</h3>


<ul>
<li> <p>adjpin estimates the adjusted probability of informed trading
(<code>AdjPIN</code>) of the model of Duarte and Young (2009).
</p>
</li>
<li> <p>aggregate_trades aggregates the trading data per day using
different trade classification algorithms.
</p>
</li>
<li> <p>detectlayers_e detects the number of information layers present
in the trade-data using the algorithm in
Ersan (2016).
</p>
</li>
<li> <p>detectlayers_eg detects the number of information layers present
in the trade-data using the algorithm in
Ersan and Ghachem (2022a).
</p>
</li>
<li> <p>detectlayers_ecm detects the number of information layers
present in the trade-data using the expectation-conditional maximization
algorithm in Ghachem and Ersan (2022a).
</p>
</li>
<li> <p>fact_adjpin returns the <code>AdjPIN</code> factorization of the likelihood
function by Ersan and Ghachem (2022b) evaluated at the
provided data and parameter sets.
</p>
</li>
<li> <p>fact_pin_e returns the <code>PIN</code> factorization of the likelihood
function by Ersan (2016) evaluated at
the provided data and parameter sets.
</p>
</li>
<li> <p>fact_pin_eho returns the <code>PIN</code> factorization of the likelihood
function by Easley et al. (2010) evaluated at the
provided data and parameter sets.
</p>
</li>
<li> <p>fact_pin_lk returns the <code>PIN</code> factorization of the likelihood
function by Lin and Ke (2011) evaluated
at the provided data and parameter sets.
</p>
</li>
<li> <p>fact_mpin returns the <code>MPIN</code> factorization of the likelihood
function by Ersan (2016) evaluated at the
provided data and parameter sets.
</p>
</li>
<li> <p>generatedata_adjpin generates a dataset object or a list of
dataset objects generated according to the assumptions of the <code>AdjPIN</code> model.
</p>
</li>
<li> <p>generatedata_mpin generates a dataset object or a list of
dataset objects generated according to the assumptions of the <code>MPIN</code> model.
</p>
</li>
<li> <p>get_posteriors computes, for each day in the sample, the
posterior probabilities that it is a no-information day, good-information day
and bad-information day respectively.
</p>
</li>
<li> <p>initials_adjpin generates the initial parameter sets for the
<code>ML</code>/<code>ECM</code> estimation of the adjusted probability of informed trading using
the algorithm of Ersan and Ghachem (2022b).
</p>
</li>
<li> <p>initials_adjpin_cl generates the initial parameter sets for the
<code>ML</code>/<code>ECM</code> estimation of the adjusted probability of informed trading using
an extension of the algorithm of
Cheng and Lai (2021).
</p>
</li>
<li> <p>initials_adjpin_rnd generates random parameter sets for the
estimation of the <code>AdjPIN</code> model.
</p>
</li>
<li> <p>initials_mpin generates initial parameter sets for the maximum
likelihood estimation of the multilayer
probability of informed trading (<code>MPIN</code>) using the
Ersan (2016) generalization of the algorithm
in Ersan and Alici (2016).
</p>
</li>
<li> <p>initials_pin_ea generates the initial parameter sets for the
maximum likelihood estimation of the probability of informed trading (<code>PIN</code>)
using the algorithm of Ersan and Alici (2016).
</p>
</li>
<li> <p>initials_pin_gwj generates the initial parameter set for the
maximum likelihood estimation of the probability of informed trading (<code>PIN</code>)
using the algorithm of Gan et al. (2015).
</p>
</li>
<li> <p>initials_pin_yz generates the initial parameter sets for the
maximum likelihood estimation of the probability of informed trading (<code>PIN</code>)
using the algorithm of Yan and Zhang (2012).
</p>
</li>
<li> <p>mpin_ecm estimates the multilayer probability of informed
trading (<code>MPIN</code>) using the expectation-conditional maximization algorithm
(<code>ECM</code>) as in Ghachem and Ersan (2022a).
</p>
</li>
<li> <p>mpin_ml estimates the multilayer probability of informed trading
(<code>MPIN</code>) using layer detection algorithms in
Ersan (2016), and
Ersan and Ghachem (2022a); and standard maximum
likelihood estimation.
</p>
</li>
<li> <p>pin estimates the probability of informed trading (<code>PIN</code>) using
custom initial parameter set(s) provided by the user.
</p>
</li>
<li> <p>pin_bayes estimates the probability of informed trading (<code>PIN</code>) using
the Bayesian approach in Griffin et al. (2021).
</p>
</li>
<li> <p>pin_ea estimates the probability of informed trading (<code>PIN</code>)
using the initial parameter sets from the algorithm of
Ersan and Alici (2016).
</p>
</li>
<li> <p>pin_gwj estimates the probability of informed trading (<code>PIN</code>)
using the initial parameter set from the algorithm of
Gan et al. (2015).
</p>
</li>
<li> <p>pin_yz estimates the probability of informed trading (<code>PIN</code>)
using the initial parameter sets from the grid-search algorithm of
Yan and Zhang (2012).
</p>
</li>
<li> <p>vpin estimates the volume-synchronized probability of informed
trading (<code>VPIN</code>).
</p>
</li>
</ul>
<h3>Datasets</h3>


<ul>
<li> <p>dailytrades A dataframe representative of quarterly (60
trading days) data of simulated daily buys and sells.
</p>
</li>
<li> <p>hfdata A dataframe containing simulated high-frequency
trade-data on 100 000 timestamps with the variables
<code style="white-space: pre;">⁠{timestamp, price, volume, bid, ask}⁠</code>.
</p>
</li>
</ul>
<h3>Estimation results</h3>


<ul>
<li> <p>estimate.adjpin-class The class <code>estimate.adjpin</code> stores the
estimation results of the function <code>adjpin()</code>.
</p>
</li>
<li> <p>estimate.mpin-class The class <code>estimate.mpin</code> stores the
estimation results of the <code>MPIN</code> model as estimated by the function
<code>mpin_ml()</code>.
</p>
</li>
<li> <p>estimate.mpin.ecm-class The class <code>estimate.mpin.ecm</code> stores
the estimation results of the <code>MPIN</code> model as estimated by the function
<code>mpin_ecm()</code>.
</p>
</li>
<li> <p>estimate.pin-class The class <code>estimate.pin</code> stores the
estimation results of the following <code>PIN</code> functions: <code>pin(), pin_yz(),
  pin_gwj()</code>, and <code>pin_ea()</code>.
</p>
</li>
<li> <p>estimate.vpin-class The class <code>estimate.vpin</code> stores the
estimation results of the <code>VPIN</code> model using the function <code>vpin()</code>.
</p>
</li>
</ul>
<h3>Data simulation</h3>


<ul>
<li> <p>dataset-class The class <code>dataset</code> stores the result of
simulation of the aggregate daily trading data.
</p>
</li>
<li> <p>data.series-class The class <code>data.series</code> stores a list of
<code>dataset</code>.
</p>
</li>
</ul>
<h3>Author(s)</h3>

<p>Montasser Ghachem <a href="mailto:montasser.ghachem@pinstimation.com">montasser.ghachem@pinstimation.com</a> <br>
Department of Economics at Stockholm University, Stockholm, Sweden. <br></p>
<p>Oguz Ersan <a href="mailto:oguz.ersan@pinstimation.com">oguz.ersan@pinstimation.com</a> <br>
Department of International Trade and Finance at Kadir Has University,
Istanbul, Turkey.<br></p>


<h3>References</h3>

<p>Cheng T, Lai H (2021).
“Improvements in estimating the probability of informed trading models.”
<em>Quantitative Finance</em>, <b>21</b>(5), 771-796.<br><br> Duarte J, Young L (2009).
“Why is PIN priced?”
<em>Journal of Financial Economics</em>, <b>91</b>(2), 119–138.
ISSN 0304405X.<br><br> Easley D, De Prado MML, Ohara M (2011).
“The microstructure of the \"flash crash\": flow toxicity, liquidity crashes, and the probability of informed trading.”
<em>The Journal of Portfolio Management</em>, <b>37</b>(2), 118–128.<br><br> Easley D, Hvidkjaer S, Ohara M (2010).
“Factoring information into returns.”
<em>Journal of Financial and Quantitative Analysis</em>, <b>45</b>(2), 293–309.
ISSN 00221090.<br><br> Easley D, Kiefer NM, Ohara M, Paperman JB (1996).
“Liquidity, information, and infrequently traded stocks.”
<em>Journal of Finance</em>, <b>51</b>(4), 1405–1436.
ISSN 00221082.<br><br> Easley D, Lopez De Prado MM, OHara M (2012).
“Flow toxicity and liquidity in a high-frequency world.”
<em>Review of Financial Studies</em>, <b>25</b>(5), 1457–1493.
ISSN 08939454.<br><br> Easley D, Ohara M (1992).
“Time and the Process of Security Price Adjustment.”
<em>The Journal of Finance</em>, <b>47</b>(2), 577–605.
ISSN 15406261.<br><br> Ellis K, Michaely R, Ohara M (2000).
“The Accuracy of Trade Classification Rules: Evidence from Nasdaq.”
<em>The Journal of Financial and Quantitative Analysis</em>, <b>35</b>(4), 529–551.<br><br> Ersan O (2016).
“Multilayer Probability of Informed Trading.”
<em>Available at SSRN 2874420</em>.<br><br> Ersan O, Alici A (2016).
“An unbiased computation methodology for estimating the probability of informed trading (PIN).”
<em>Journal of International Financial Markets, Institutions and Money</em>, <b>43</b>, 74–94.
ISSN 10424431.<br><br> Ersan O, Ghachem M (2022a).
“Identifying information types in probability of informed trading (PIN) models: An improved algorithm.”
<em>Available at SSRN 4117956</em>.<br><br> Ersan O, Ghachem M (2022b).
“A methodological approach to the computational problems in the estimation of adjusted PIN model.”
<em>Available at SSRN 4117954</em>.<br><br> Gan Q, Wei WC, Johnstone D (2015).
“A faster estimation method for the probability of informed trading using hierarchical agglomerative clustering.”
<em>Quantitative Finance</em>, <b>15</b>(11), 1805–1821.<br><br> Ghachem M, Ersan O (2022a).
“Estimation of the probability of informed trading models via an expectation-conditional maximization algorithm.”
<em>Available at SSRN 4117952</em>.<br><br> Ghachem M, Ersan O (2022b).
“PINstimation: An R package for estimating models of probability of informed trading.”
<em>Available at SSRN 4117946</em>.<br><br> Griffin J, Oberoi J, Oduro SD (2021).
“Estimating the probability of informed trading: A Bayesian approach.”
<em>Journal of Banking &amp; Finance</em>, <b>125</b>, 106045.<br><br> Lee CMC, Ready MJ (1991).
“Inferring Trade Direction from Intraday Data.”
<em>The Journal of Finance</em>, <b>46</b>(2), 733–746.
ISSN 00221082, 15406261.<br><br> Lin H, Ke W (2011).
“A computing bias in estimating the probability of informed trading.”
<em>Journal of Financial Markets</em>, <b>14</b>(4), 625-640.
ISSN 1386-4181.<br><br> Yan Y, Zhang S (2012).
“An improved estimation method and empirical properties of the probability of informed trading.”
<em>Journal of Banking and Finance</em>, <b>36</b>(2), 454–467.
ISSN 03784266.
</p>


</div>