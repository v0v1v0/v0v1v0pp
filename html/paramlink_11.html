<div class="container">

<table style="width: 100%;"><tr>
<td>as.matrix.linkdat</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>linkdat to matrix conversion</h2>

<h3>Description</h3>

<p>Converts a <code>linkdat</code> object to a matrix (basically following a
pre-makeped LINKAGE format), with marker annotations and other info attached
as attributes.
</p>


<h3>Usage</h3>

<pre><code class="language-R">## S3 method for class 'linkdat'
as.matrix(x, include.attrs = TRUE, ...)

restore_linkdat(x, attrs = NULL, checkped = TRUE)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>x</code></td>
<td>
<p>a <code>linkdat</code> object. In <code>restore_linkdat</code>: A
numerical matrix in LINKAGE format.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>include.attrs</code></td>
<td>
<p>a logical indicating if marker annotations and other
info should be attached as attributes. See value.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>...</code></td>
<td>
<p>not used.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>attrs</code></td>
<td>
<p>a list containing marker annotations and other <code>linkdat</code>
info compatible with <code>x</code>, in the format produced by <code>as.matrix</code>.
If NULL, the attributes of <code>x</code> itself are used.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>checkped</code></td>
<td>
<p>a logical, forwarded to <code>linkdat</code>. If FALSE, no
checks for pedigree errors are performed.</p>
</td>
</tr>
</table>
<h3>Details</h3>

<p><code>restore_linkdat</code> is the reverse of <code>as.matrix</code>.
</p>
<p>The way <code>linkdat</code> objects are created in paramlink, marker data
are stored as a list of <code>marker</code> objects. Each of these is essentially a
matrix with various attributes like allele frequencies, map info a.s.o.. This
format works well for marker-by-marker operations (e.g. likelihoods and LOD
scores), but makes it somewhat awkward to operate 'horizontally', i.e.
individual-by-individual, for instance if one wants to delete all genotypes
of a certain individual, or rearrange the pedigree in some way.
</p>
<p>It is therefore recommended to convert the <code>linkdat</code> object to a matrix
first, do the necessary manipulations on the matrix, and finally use
<code>restore_linkdat</code>. Attributes are often deleted during matrix
manipulation, so it may be necessary to store them in a variable and feed
them manually to <code>restore_linkdat</code> using the <code>attrs</code> argument.
</p>
<p>With default parameters, <code>restore_linkdat(as.matrix(x))</code> should
reproduce <code>x</code> exactly.
</p>


<h3>Value</h3>

<p>For <code>as.matrix</code>: A matrix with <code>x$nInd</code> rows and <code>6 +
  2*x$nMark</code> columns.  The 6 first columns describe the pedigree in LINKAGE
format, and the remaining columns contain marker alleles, using the
internal (numerical) allele coding and 0 for missing alleles. If
<code>include.attrs = TRUE</code> the matrix has the following attributes:
</p>
 <ul>
<li> <p><code>markerattr</code> (a list of marker annotations) </p>
</li>
<li>
<p><code>available</code> (the availability vector) </p>
</li>
<li> <p><code>model</code> (the disease
model, if present) </p>
</li>
<li> <p><code>plot.labels</code> (plot labels, if present) </p>
</li>
<li>
<p><code>orig.ids</code> (original individual IDs) </p>
</li>
</ul>
<p>For <code>restore_linkdat</code>: A <code>linkdat</code> object.
</p>


<h3>See Also</h3>

<p><code>linkdat</code>, <code>as.data.frame.linkdat</code>
</p>


<h3>Examples</h3>

<pre><code class="language-R">
x = linkdat(toyped, model=1)
y = restore_linkdat(as.matrix(x))
stopifnot(all.equal(x,y))

# If attributes are lost during matrix manipulation: Use the 'attrs' argument.
xmatr = as.matrix(x)
newmatr = xmatr[-4, ] # NB: attributes are lost here
z = restore_linkdat(newmatr, attrs = attributes(xmatr))

# Should be the same as:
z2 = removeIndividuals(x, 4)
stopifnot(all.equal(z, z2))

</code></pre>


</div>