<div class="container">

<table style="width: 100%;"><tr>
<td>estimate_matrix_prods</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>Estimate covariance matrices and mean vectors containing product terms</h2>

<h3>Description</h3>

<p>Estimate covariance matrices and mean vectors containing product terms
</p>


<h3>Usage</h3>

<pre><code class="language-R">estimate_matrix_prods(sigma_mat, mu_vec, prod_list)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>sigma_mat</code></td>
<td>
<p>Covariance parameter matrix.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>mu_vec</code></td>
<td>
<p>Mean parameter matrix.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>prod_list</code></td>
<td>
<p>List of 2-element vectors containing the names of variables in <code>sigma_mat</code>.</p>
</td>
</tr>
</table>
<h3>Value</h3>

<p>Augmented covariance matrix and mean vector containing product terms.
</p>


<h3>Examples</h3>

<pre><code class="language-R">## Establish mean and covariance parameters
mu_vec &lt;- 1:4
sigma_mat &lt;- reshape_vec2mat(c(.1, .2, .3, .4, .5, .6), var_names = LETTERS[1:4])
names(mu_vec) &lt;- colnames(sigma_mat)

## Define a list of variables to be used in estimating products:
prod_list &lt;- list(c("A", "B"),
                  c("A", "C"),
                  c("A", "D"),
                  c("B", "C"),
                  c("B", "D"),
                  c("C", "D"))

## Generate data for the purposes of comparison:
set.seed(1)
dat &lt;- data.frame(MASS::mvrnorm(100000, mu = mu_vec, Sigma = sigma_mat, empirical = TRUE))

## Create product terms in simulated data:
for(i in 1:length(prod_list))
     dat[,paste(prod_list[[i]], collapse = "_x_")] &lt;-
     dat[,prod_list[[i]][1]] * dat[,prod_list[[i]][2]]

## Analytically estimate product variables and compare to simulated data:
estimate_matrix_prods(sigma_mat = sigma_mat, mu_vec = mu_vec, prod_list = prod_list)
round(cov(dat), 2)
round(apply(dat, 2, mean), 2)
</code></pre>


</div>