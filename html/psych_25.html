<div class="container">

<table style="width: 100%;"><tr>
<td>biplot.psych</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>Draw biplots of factor or component scores by factor or component loadings</h2>

<h3>Description</h3>

<p>Extends the biplot function to the output of <code>fa</code>, <code>fa.poly</code>  or <code>principal</code>. Will plot factor scores and factor loadings in the same graph.  If the number of factors &gt; 2, then all pairs of factors are plotted. Factor score histograms are plotted on the diagonal. The input is the resulting object from <code>fa</code>, <code>principal</code>, or <code>fa.poly</code> with the scores=TRUE option. Points may be colored according to other criteria.
</p>


<h3>Usage</h3>

<pre><code class="language-R">## S3 method for class 'psych'
biplot(x, labels=NULL,cex=c(.75,1),main="Biplot from fa",
hist.col="cyan",xlim.s=c(-3,3),ylim.s=c(-3,3),xlim.f=c(-1,1),ylim.f=c(-1,1),
maxpoints=100,adjust=1.2,col,pos, arrow.len = 0.1,pch=16,choose=NULL,
cuts=1,cutl=.0,group=NULL,smoother=FALSE,vars=TRUE,...)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>x</code></td>
<td>
<p>The output from <code>fa</code>, <code>fa.poly</code> or <code>principal</code>  with the scores=TRUE option</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>labels</code></td>
<td>
<p>if NULL, draw the points with the plot character (pch) specified. 
To identify the data points, specify labels= 1:n  where n is the number of 
observations, or labels =rownames(data) where data was the data set analyzed
by the factor analysis.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>cex</code></td>
<td>
<p>A vector of plot sizes of the data labels and of the factor labels</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>main</code></td>
<td>
<p>A main title for a two factor biplot</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>hist.col</code></td>
<td>
<p>If plotting more than two factors, the color of the histogram of the factor scores</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>xlim.s</code></td>
<td>
<p>x limits of the scores. Defaults to plus/minus three sigma</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>ylim.s</code></td>
<td>
<p>y limits of the scores.Defaults to plus/minus three sigma</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>xlim.f</code></td>
<td>
<p>x limits of the factor loadings.Defaults to plus/minus 1.0</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>ylim.f</code></td>
<td>
<p>y limits of the factor loadings.Defaults to plus/minus 1.0</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>maxpoints</code></td>
<td>
<p>When plotting 3 (or more) dimensions, at what size should we switch 
from plotting "o" to plotting "."</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>adjust</code></td>
<td>
<p>an adjustment factor in the histogram</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>col</code></td>
<td>
<p>a vector of colors for the data points and for the factor loading labels</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>pos</code></td>
<td>
<p>If plotting labels, what position should they be in? 1=below, 2=left,
3 top, 4 right.
If missing, then the assumption is that labels should be printed instead of data points.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>arrow.len</code></td>
<td>
<p> the length of the arrow head</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>pch</code></td>
<td>
<p>The plotting character to use.  pch=16 gives reasonable size dots.
pch="." gives tiny points.  If adding colors, use pch between 21 and 25. 
(see examples).</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>choose</code></td>
<td>
<p>Plot just the specified factors</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>cuts</code></td>
<td>
<p>Do not label cases with abs(factor scores) &lt; cuts) (Actually,
the  distance of the x and y scores from 0) </p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>cutl</code></td>
<td>
<p>Do not label variables with communalities in the two space &lt; cutl</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>group</code></td>
<td>
<p>A vector of a grouping variable for the scores.  Show a different color 
and symbol for each group.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>smoother</code></td>
<td>
<p>If TRUE then do a smooth scatter plot (which shows the density rather than the data points). Only useful for large data sets.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>vars</code></td>
<td>
<p>If TRUE, draw arrows for the variables, and plot the scores.  If FALSE, then draw arrows for the scores and plot the variables.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>...</code></td>
<td>
<p>more options for graphics</p>
</td>
</tr>
</table>
<h3>Details</h3>

<p>Uses the generic biplot function to take the output of a factor analysis <code>fa</code>, <code>fa.poly</code> or principal components analysis <code>principal</code> and plot the factor/component scores along with the factor/component loadings.
</p>
<p>This is an extension of the generic biplot function to allow more control over plotting points in a two space and also to plot three or more factors (two at time).  
</p>
<p>This will work for objects produced by <code>fa</code>, <code>fa.poly</code> or <code>principal</code>  if they applied to the original data matrix.  If however, one has a correlation matrix (e.g., based upon the output from <code>tetrachoric</code> or <code>polychoric</code>), and has done either <code>fa</code> or <code>principal</code> on the correlations, then obviously, we can not do a biplot.  
</p>
<p>However, both of those functions produce a weights matrix, which, in combination with the original data can be used to find the scores by using <code>factor.scores</code>.  Since biplot.psych is looking for two elements of the x object: x$loadings and x$scores, you can create the appropriate object to plot, or add it to the factor object See the third and 	fourth examples.
</p>
<p>In order to just plot the loadings, use <code>fa.plot</code>.  Or, if we want to show the loadings as vectors, use pch = "". 
</p>


<h3>Author(s)</h3>

<p>William Revelle</p>


<h3>See Also</h3>

<p><code>fa</code>, <code>fa.poly</code>,  <code>principal</code>, <code>fa.plot</code>, <code>pairs.panels</code>
</p>


<h3>Examples</h3>

<pre><code class="language-R">#the standard example
data(USArrests)
fa2 &lt;- fa(USArrests,2,scores=TRUE)
biplot(fa2,labels=rownames(USArrests))

# plot the 3 factor solution
#data(bfi)
fa3 &lt;- fa(bfi[1:200,1:15],3,scores=TRUE)
biplot(fa3)
#just plot factors 1 and 3 from that solution
biplot(fa3,choose=c(1,3))

#
fa2 &lt;- fa(bfi[16:25],2)  #factor analysis
fa2$scores &lt;- fa2$scores[1:100,]  #just take the first 100
#now plot with different colors and shapes for males and females
biplot(fa2,pch=c(24,21)[bfi[1:100,"gender"]],
group =bfi[1:100,"gender"],
   main="Biplot of Openness and Neuroticism by gender")

## An example from the correlation matrix
r &lt;- cor(bfi[1:200,1:10], use="pairwise") #find the correlations
f2 &lt;- fa(r,2) 
#biplot(f2)  #this throws an error    (not run)

#f2 does not have scores, but we can find them
f2$scores &lt;- factor.scores(bfi[1:200,1:10],f2)

biplot(f2,main="biplot from correlation matrix and factor scores")


#or create a new object with the scores
 #find the correlations for all subjects
r &lt;- cor(bfi[1:10], use="pairwise") 
f2 &lt;- fa(r,2) 
x &lt;- list() 
#find the scores for just the first 200 subjects
x$scores &lt;- factor.scores(bfi[1:200,1:10],f2)
x$loadings &lt;- f2$loadings
class(x) &lt;- c('psych','fa')
biplot(x,main="biplot from correlation matrix combined with factor scores")

</code></pre>


</div>