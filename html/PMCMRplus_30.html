<div class="container">

<table style="width: 100%;"><tr>
<td>chenJanTest</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>Chen and Jan Many-to-One Comparisons Test</h2>

<h3>Description</h3>

<p>Performs Chen and Jan nonparametric test for contrasting increasing
(decreasing) dose levels of a treatment in a randomized block design.
</p>


<h3>Usage</h3>

<pre><code class="language-R">chenJanTest(y, ...)

## Default S3 method:
chenJanTest(
  y,
  groups,
  blocks,
  alternative = c("greater", "less"),
  p.adjust.method = c("single-step", "SD1", p.adjust.methods),
  ...
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>y</code></td>
<td>
<p>a numeric vector of data values, or a list of numeric data
vectors.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>groups</code></td>
<td>
<p>a vector or factor object giving the group for the
corresponding elements of <code>"x"</code>. Ignored with a warning if <code>"x"</code> is a list.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>blocks</code></td>
<td>
<p>a vector or factor object giving the block for the
corresponding elements of <code>"x"</code>.
Ignored with a warning if <code>"x"</code> is a list.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>alternative</code></td>
<td>
<p>the alternative hypothesis. Defaults to <code>greater</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>p.adjust.method</code></td>
<td>
<p>method for adjusting p values
(see <code>p.adjust</code>)</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>...</code></td>
<td>
<p>further arguments to be passed to or from methods.</p>
</td>
</tr>
</table>
<h3>Details</h3>

<p>Chen's test is a non-parametric step-down trend test for
testing several treatment levels with a zero control. Let
there be <code class="reqn">k</code> groups including the control and let
the zero dose level be indicated with <code class="reqn">i = 0</code> and the highest
dose level with <code class="reqn">i = m</code>, then the following <code>m = k - 1</code> hypotheses are tested:
</p>
<p style="text-align: center;"><code class="reqn">
\begin{array}{ll}
\mathrm{H}_{m}: \theta_0 = \theta_1 = \ldots = \theta_m, &amp; \mathrm{A}_{m} = \theta_0 \le \theta_1 \le \ldots \theta_m, \theta_0 &lt; \theta_m \\
\mathrm{H}_{m-1}: \theta_0 = \theta_1 = \ldots = \theta_{m-1}, &amp; \mathrm{A}_{m-1} = \theta_0 \le \theta_1 \le \ldots \theta_{m-1}, \theta_0 &lt; \theta_{m-1} \\
\vdots &amp; \vdots \\
\mathrm{H}_{1}: \theta_0 = \theta_1, &amp; \mathrm{A}_{1} = \theta_0 &lt; \theta_1\\
\end{array}
</code>
</p>

<p>Let <code class="reqn">Y_{ij1}, Y_{ij2}, \ldots, Y_{ijn_{ij}}</code>
<code class="reqn">(i = 1, 2, \dots, b, j = 0, 1, \ldots, k ~ \mathrm{and} ~ n_{ij} \geq 1)</code> be
a i.i.d. random variable of at least ordinal scale. Further,the zero dose
control is indicated with <code class="reqn">j = 0</code>.
</p>
<p>The Mann-Whittney statistic is
</p>
<p style="text-align: center;"><code class="reqn">
T_{ij} = \sum_{u=0}^{j-1} \sum_{s=1}^{n_{ij}}
\sum_{r=1}^{n_{iu}} I(Y_{ijs} - Y_{iur}),
\qquad i = 1, 2, \ldots, b, ~ j = 1, 2, \ldots, k,
</code>
</p>

<p>where where the indicator function returns <code class="reqn">I(a) = 1, ~ \mathrm{if}~ a &gt; 0, 0.5 ~ \mathrm{if} a = 0</code>
otherwise <code class="reqn">0</code>.
</p>
<p>Let
</p>
<p style="text-align: center;"><code class="reqn">
N_{ij} = \sum_{s=0}^j n_{is} \qquad  i = 1, 2, \ldots, b, ~ j = 1, 2, \ldots, k,
</code>
</p>

<p>and
</p>
<p style="text-align: center;"><code class="reqn">
T_j = \sum_{i=1}^b T_{ij} \qquad j = 1, 2, \ldots, k.
</code>
</p>

<p>The mean and variance of <code class="reqn">T_j</code> are
</p>
<p style="text-align: center;"><code class="reqn">
\mu(T_j) = \sum_{i=1}^b n_{ij} ~ N_{ij-1} / 2 \qquad \mathrm{and}
</code>
</p>

<p style="text-align: center;"><code class="reqn">
 \sigma(T_j) = \sum_{i=1}^b n_{ij} ~ N_{ij-1} \left[
 \left(N_{ij} + 1\right) - \sum_{u=1}^{g_i}
 \left(t_u^3 - t_u \right) /
 \left\{N_{ij} \left(N_{ij} - 1\right) \right\} \right]/ 2,
</code>
</p>

<p>with <code class="reqn">g_i</code> the number of ties in the <code class="reqn">i</code>th block and
<code class="reqn">t_u</code> the size of the tied group <code class="reqn">u</code>.
</p>
<p>The test statistic <code class="reqn">T_j^*</code> is asymptotically multivariate normal
distributed.
</p>
<p style="text-align: center;"><code class="reqn">
T_j^* = \frac{T_j - \mu(T_j)}{\sigma(T_j)}
</code>
</p>

<p>If <code>p.adjust.method =  "single-step"</code> than the p-values
are calculated with the probability function of the multivariate
normal distribution with <code class="reqn">\Sigma = I_k</code>. Otherwise
the standard normal distribution is used to calculate
p-values and any method as available
by <code>p.adjust</code> or by the step-down procedure as proposed
by Chen (1999), if <code>p.adjust.method = "SD1"</code> can be used
to account for <code class="reqn">\alpha</code>-error inflation.
</p>


<h3>Value</h3>

<p>A list with class <code>"PMCMR"</code> containing the following components:
</p>

<dl>
<dt>method</dt>
<dd>
<p>a character string indicating what type of test was performed.</p>
</dd>
<dt>data.name</dt>
<dd>
<p>a character string giving the name(s) of the data.</p>
</dd>
<dt>statistic</dt>
<dd>
<p>lower-triangle matrix of the estimated
quantiles of the pairwise test statistics.</p>
</dd>
<dt>p.value</dt>
<dd>
<p>lower-triangle matrix of the p-values for the pairwise tests.</p>
</dd>
<dt>alternative</dt>
<dd>
<p>a character string describing the alternative hypothesis.</p>
</dd>
<dt>p.adjust.method</dt>
<dd>
<p>a character string describing the method for p-value
adjustment.</p>
</dd>
<dt>model</dt>
<dd>
<p>a data frame of the input data.</p>
</dd>
<dt>dist</dt>
<dd>
<p>a string that denotes the test distribution.</p>
</dd>
</dl>
<h3>References</h3>

<p>Chen, Y.I., Jan, S.L., 2002. Nonparametric Identification of
the Minimum Effective Dose for Randomized Block Designs.
<em>Commun Stat-Simul Comput</em> <strong>31</strong>, 301â€“312.
</p>


<h3>See Also</h3>

<p><code>Normal</code> <code>pmvnorm</code>
</p>


<h3>Examples</h3>

<pre><code class="language-R">## Example from Chen and Jan (2002, p. 306)
## MED is at dose level 2 (0.5 ppm SO2)
y &lt;- c(0.2, 6.2, 0.3, 0.3, 4.9, 1.8, 3.9, 2, 0.3, 2.5, 5.4, 2.3, 12.7,
-0.2, 2.1, 6, 1.8, 3.9, 1.1, 3.8, 2.5, 1.3, -0.8, 13.1, 1.1,
12.8, 18.2, 3.4, 13.5, 4.4, 6.1, 2.8, 4, 10.6, 9, 4.2, 6.7, 35,
9, 12.9, 2, 7.1, 1.5, 10.6)
groups &lt;- gl(4,11, labels = c("0", "0.25", "0.5", "1.0"))
blocks &lt;- structure(rep(1:11, 4), class = "factor",
levels = c("1", "2", "3", "4", "5", "6", "7", "8", "9", "10", "11"))

summary(chenJanTest(y, groups, blocks, alternative = "greater"))
summary(chenJanTest(y, groups, blocks, alternative = "greater", p.adjust = "SD1"))

</code></pre>


</div>