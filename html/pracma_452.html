<div class="container">

<table style="width: 100%;"><tr>
<td>whittaker</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>
Whittaker Smoothing
</h2>

<h3>Description</h3>

<p>Smoothing of time series using the Whittaker-Henderson approach.
</p>


<h3>Usage</h3>

<pre><code class="language-R">whittaker(y, lambda = 1600, d = 2)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>y</code></td>
<td>
<p>signal to be smoothed.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>lambda</code></td>
<td>
<p>smoothing parameter (rough 50..1e4 smooth); the default
value of 1600 has been recommended in the literature.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>d</code></td>
<td>
<p>order of differences in penalty (generally 2)</p>
</td>
</tr>
</table>
<h3>Details</h3>

<p>The Whittaker smoother family was first presented by Whittaker in 
1923 for life tables, based on penalized least squares. These ideas 
were revived by Paul Eilers, Leiden University, in 2003. This
approach is also known as Whittaker-Henderson smoothing.
</p>
<p>The smoother attempts to both fit a curve that represents the raw 
data, but is penalized if subsequent points vary too much.
Mathematically it is a large, but sparse optimization problem that 
can be expressed in a few lines of Matlab or R code.
</p>


<h3>Value</h3>

<p>A smoothed time series.
</p>


<h3>Note</h3>

<p>This is a version that avoids package 'SparseM'.
</p>


<h3>Author(s)</h3>

<p>An R version, based on Matlab code by P. Eilers in 2002, has been 
published by Nicholas Lewin-Koh on the R-help mailing list in Feb. 
2004, and in private communication to the author of this package.
</p>


<h3>References</h3>

<p>P. H. C. Eilers (2003). A Perfect Smoother. Analytical Chemistry,
Vol. 75, No. 14, pp. 3631â€“3636.
</p>
<p>Wilson, D. I. (2006). The Black Art of Smoothing. Electrical and 
Automation Technology, June/July issue.
</p>


<h3>See Also</h3>

<p><code>supsmu</code>, <code>savgol</code>, <code>ptw::whit2</code>
</p>


<h3>Examples</h3>

<pre><code class="language-R"># **Sinosoid test function**
ts &lt;- sin(2*pi*(1:1000)/200)
t1 &lt;- ts + rnorm(1000)/10
t3 &lt;- whittaker(t1, lambda = 1600)
## Not run: 
plot(1:1000, t1, col = "grey")
lines(1:1000, ts, col="blue")
lines(1:1000, t3, col="red")
## End(Not run)
</code></pre>


</div>