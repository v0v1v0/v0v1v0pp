<div class="container">

<table style="width: 100%;"><tr>
<td>PERMANOVA</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>
PERMANOVA: MANOVA based on distances
</h2>

<h3>Description</h3>

<p>The correct application of MANOVA needs normal and homocedastic data and the number of variables be much smaller than the number of individuals, but for many applications the conditions do not hold. To extend the application to this data Anderson develops PERMANOVA. This non-parametric test based on distances uses permutation to approximate the sampling distribution of the test statistic.
</p>
<p>Contrasts and Effects can be added to the calculations.
</p>


<h3>Usage</h3>

<pre><code class="language-R">PERMANOVA(Distance, group, C = NULL, Effects = NULL, nperm = 1000, seed = NULL,
CoordPrinc = FALSE, dimens = 2, PCoA = "Standard", ProjectInd = TRUE, tol = 1e-04,
DatosIni = TRUE, PostHoc="bonferroni")
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>Distance</code></td>
<td>

<p>A list of three elements containing the data, the distances between individuals and type of distance used.
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>group</code></td>
<td>

<p>A factor containing the groups to compare.
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>C</code></td>
<td>

<p>Contrast matrix. By default it is null and the identity is used.
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>Effects</code></td>
<td>

<p>A factor with the effects in the rows of C. By default it is null and each row is considered as an effect.
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>nperm</code></td>
<td>

<p>Number of permutations to perform. By default is 1000.
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>seed</code></td>
<td>

<p>Seed to start permutations. By default is null.
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>CoordPrinc</code></td>
<td>

<p>Should the principal coordinates be calculated?. By default is FALSE.
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>dimens</code></td>
<td>

<p>Number of dimensions to choose in the PCoA. By default is 2.
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>PCoA</code></td>
<td>

<p>The type of Principal Coordinates Analysis.
</p>
<p>There are two possibilities:
</p>
<p>* Standard
</p>
<p>* Weighted
</p>
<p>By default is Standard.
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>ProjectInd</code></td>
<td>

<p>Show the row coordinates. By default is TRUE.
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>tol</code></td>
<td>

<p>Tolerance.
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>DatosIni</code></td>
<td>

<p>It contains the initial data. By default is TRUE.
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>PostHoc</code></td>
<td>

<p>Correction method. There are eight possibilities:
</p>
<p>*holm: Holm
</p>
<p>*hochberg: Hochberg 
</p>
<p>*hommel: Hommel
</p>
<p>*bonferroni: Bonferroni. By default is this method.
</p>
<p>*BH:Benjamini &amp; Hochberg 
</p>
<p>*BY: Benjamini &amp; Yekutieli
</p>
<p>*fdr: Benjamini &amp; Hochberg 
</p>
<p>*none
</p>
</td>
</tr>
</table>
<h3>Details</h3>

<p>The function performs a PERMANOVA Analysis.
</p>


<h3>Value</h3>

<p>The PERMANOVA function create a list that return:
</p>
<table>
<tr style="vertical-align: top;">
<td><code>call</code></td>
<td>
<p>Function.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>Title</code></td>
<td>
<p>Permutation based MANOVA.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>Type</code></td>
<td>
<p>PERMANOVA.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>Distances</code></td>
<td>
<p>A matrix containing the distances between individuals.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>C</code></td>
<td>
<p>Contrasts Matrix.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>Initial</code></td>
<td>
<p> Containing two matrices:
</p>
<p>* Global -&gt; Global contrast.
</p>
<p>* Contrastes -&gt;Contrasts for groups.
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>DistMuestral</code></td>
<td>
<p>Sample distribution of F-exp from permutations.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>pvalue</code></td>
<td>
<p>Estimate p-valor for PERMANOVA.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>ExplainedVariance</code></td>
<td>
<p>Explained variance by Principal Coordinates selected.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>Inertias</code></td>
<td>
<p>Eigenvalue, Explained variance, Cumulative explained variance.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>MeanCoordinates</code></td>
<td>
<p>Mean Coordinates by groups for the dimensions obtained in the Principal Coordinates Analysis.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>Qualities</code></td>
<td>
<p>Qualities representation by groups for the dimensions of PCoA.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>CummulativeQualities</code></td>
<td>
<p>Cumulative qualities representation.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>ClusterType</code></td>
<td>
<p>Cluster type selected.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>Clusters</code></td>
<td>
<p>Clusters created.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>ClusterNames</code></td>
<td>
<p>Names of clusters.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>ClusterColors</code></td>
<td>
<p>Colors of clusters, color name and HTML code.</p>
</td>
</tr>
</table>
<h3>Author(s)</h3>

<p>Laura Vicente-Gonzalez, Jose Luis Vicente-Villardon
</p>


<h3>References</h3>

<p>Anderson, M. J. (2008). A new method for non-parametric multivariate analysis of variance. Austral ecology, 26(1):32â€“46.
</p>
<p>Anderson, M. J. (2005). Permanova: a fortran computer program for permutational multivariate analysis of variance. Department of Statistics, University of Auckland, New Zealand, 24.
</p>


<h3>Examples</h3>

<pre><code class="language-R">data(wine)
X = wine[,4:21]
X=IniTransform(X)
D = DistContinuous (X)
perwine=PERMANOVA(D, wine$Group)
perwine


C = matrix(c(1, 1, -1, 1, 1, -1, 1, 1, 1, -1, -1, 1), nrow=3, byrow=TRUE)
rownames(C)=c("C1", "C2", "C3")
colnames(C)=levels(wine$Group)

effects=factor(c(1,2,3))
levels(effects)=c("Origin", "Year", "Interaction")
perwine2=PERMANOVA(D, wine$Group, C=C, Effects=effects, CoordPrinc = TRUE)
summary(perwine2)

</code></pre>


</div>