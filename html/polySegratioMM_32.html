<div class="container">

<table style="width: 100%;"><tr>
<td>setPriors</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>Set prior distributions for parameters of Bayesian mixture model for dosages</h2>

<h3>Description</h3>

<p>May be used to automatically set up vague or strong priors or
explicitly set them for Bayesian finite mixture model specified as an
object of class <code>modelSegratioMM</code> using
<code>setModel</code>
</p>


<h3>Usage</h3>

<pre><code class="language-R">setPriors(model, type.prior = c("strong",
              "vague", "strong.tau","strong.s", "specified"),
mean.vague = 0.1, prec.vague = 0.1, A.vague = 0.1, B.vague = 0.1,
prec.strong=400, n.individuals=200, reffect.A = 44, reffect.B = 0.8,
M.sd = 0.025, STRONG.PREC=c(0.025, 0.975), UPPER = 0.995,  PREC.INT=0.2,
params = NULL, segRatio = NULL)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>model</code></td>
<td>
<p> object of class <code>modelSegratioMM</code> specifying model
parameters, ploidy etc</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>type.prior</code></td>
<td>
<p>The type of prior required being one of
“strong”, “vague”, “strong.tau”
“strong.s” or “specified”. The first
four prior types will automatically set prior distributions whereas
for the last, namely “specified”, the prior distribution
parameters must be set explicitly. Note that strong priors get
progressively stronger from “strong” to “strong.s” </p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>mean.vague</code></td>
<td>
<p>The mean of Normal priors for a “vague” prior</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>prec.vague</code></td>
<td>
<p>The precision of Normal priors for a “vague” prior</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>A.vague</code></td>
<td>
<p>The shape parameter of the Gamma prior for the
precision parameters for a “vague” prior </p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>B.vague</code></td>
<td>
<p> The rate (scale) parameter of the Gamma prior for the
precision parameters for a “vague” prior </p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>prec.strong</code></td>
<td>
<p>Precision for Normal mean parameters when
<code>type.prior</code> is “strong”. Note that on logit scale
default is equivalent to having a 95%CI as +/- 0.1</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>n.individuals</code></td>
<td>
<p>Used for Binomial calculations to set prior
precision parameters when <code>type.prior</code> is “strong”.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>reffect.A</code></td>
<td>
<p> The shape parameter of the Gamma prior for the
precision parameter of the random.effect for a “vague” prior </p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>reffect.B</code></td>
<td>
<p>The rate (scale) parameter of the Gamma prior for the
precision parameter of the random.effect for a “vague” prior</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>M.sd</code></td>
<td>
<p>Approximate standard deviation for the mean segregation
ratios on raw probability scale - this is set to 0.025 which would
give an approximate 95% interval of 0.1 for the segregation ratio</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>UPPER</code></td>
<td>
<p>Cutoff for guessing parameters on logit scale noting that
logit(1) is undefined</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>STRONG.PREC</code></td>
<td>
<p>Interval on raw probabilty scale used to set strong
priors on the the precision distribution parameters of the
segregation ratios by using a 95% interval on the theoretical
distribution and equating this on the logit scale (Default: c(0.025,
0.975))</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>PREC.INT</code></td>
<td>
<p>Multiplier or setting prior for precision on logit
scale corresponding to approx confidence region being precision*(1 -
PREC.INT, 1 + PREC.INT) Default:0.2</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>params</code></td>
<td>
<p>if <code>type.prior</code> is “specified” then a list
of priors parameters must be set containing components M for means,
A and B for gamma prior parameters and if the model contains a
random.effect then reffect.A, and reffect.B for the gamma prior for
the precision of random effect <code>taub</code>. Note that the lengths of
M, prec, A and B should be equal to the number of components</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>segRatio</code></td>
<td>
<p>If specified, this value overides the automatically
generated value which is set as the expected segregation ratio given
the ploidy level</p>
</td>
</tr>
</table>
<h3>Value</h3>

<p>Returns an object of class <code>priorsSegratioMM</code> which is a list
with components
</p>
<table>
<tr style="vertical-align: top;">
<td><code>type</code></td>
<td>
<p>Type of prior: one of “vague”, “strong”
or “specified”</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>bugs.code</code></td>
<td>
<p>Text containing prior statements for <code>BUGS</code> file</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>random.effect</code></td>
<td>
<p>Logical indicating whether model contains random
effect (Default: <code>FALSE</code>)</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>equal.variances</code></td>
<td>
<p>Logical indicating equal or separate variances
for each component</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>params</code></td>
<td>
<p>List containing Normal means on logit scale
<code>logit.means</code>, precision on logit scale <code>logit.prec</code>, and
Gamma parameters <code>A</code> and <code>B</code> and finally <code>reffect.A</code> and
<code>reffect.B</code> if the model contains a random effect</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>call</code></td>
<td>
<p>function call</p>
</td>
</tr>
</table>
<h3>Author(s)</h3>

<p>Peter Baker <a href="mailto:p.baker1@uq.edu.au">p.baker1@uq.edu.au</a></p>


<h3>See Also</h3>

 <p><code>setModel</code> <code>setInits</code>
<code>expected.segRatio</code>
<code>segRatio</code>
<code>setControl</code>
<code>dumpData</code> <code>dumpInits</code> or for an easier way to
run a  segregation ratio mixture model  see
<code>runSegratioMM</code>
</p>


<h3>Examples</h3>

<pre><code class="language-R">## simulate small autooctaploid data set
a1 &lt;- sim.autoMarkers(8,c(0.7,0.2,0.1),n.markers=100,n.individuals=50)

## set up model with 3 components
x &lt;- setModel(3,8)
x2 &lt;- setPriors(x)
print(x2)

x2b &lt;- setPriors(x, "strong")
print(x2b)

</code></pre>


</div>