<div class="container">

<table style="width: 100%;"><tr>
<td>optAdjSet</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>Compute the optimal adjustment set</h2>

<h3>Description</h3>

<p><code>optAdjSet</code> computes the optimal valid adjustment set relative to the variables (<code>X</code>,<code>Y</code>) in the given graph.
</p>


<h3>Usage</h3>

<pre><code class="language-R">optAdjSet(graphEst,x.pos,y.pos)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>graphEst</code></td>
<td>
<p>graphNel object or adjacency matrix of type amat.cpdag.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>x.pos, x</code></td>
<td>
<p>Positions of variables <code>X</code> in the covariance matrix.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>y.pos, y</code></td>
<td>
<p>Positions of variables <code>Y</code> in the covariance matrix.</p>
</td>
</tr>
</table>
<h3>Details</h3>

<p>Suppose we have data from a linear SEM compatible with a known causal graph <code>G</code> and our aim is to estimate the total joint effect of <code>X</code> on <code>Y</code>. Here the total joint effect of <code>X</code> <code class="reqn">= (X_1,X_2)</code> on <code>Y</code> is defined via Pearl's do-calculus as the vector <code class="reqn">(E[Y|do(X_1=x_1+1,X_2=x_2)]-E[Y|do(X_1=x_1,X_2=x_2)], E[Y|do(X_1=x_1,X_2=x_2+1)]-E[Y|do(X_1=x_1,X_2=x_2)])</code>, with a similar definition for more than two variables. These values are equal to the partial derivatives (evaluated at <code class="reqn">x_1,x_2</code>) of <code class="reqn">E[Y|do(X=x_1',X_2=x_2')]</code> with respect to <code class="reqn">x_1</code>' and <code class="reqn">x_2</code>'. Moreover, under the linearity assumption, these partial derivatives do not depend on the values at which they are evaluated.
</p>
<p>It is possible to estimate the total joint effect of <code>X</code> on <code>Y</code> with a simple linear regression of the form <code>lm(Y ~ X + Z)</code>, if and only if the covariate set <code>Z</code> is a valid adjustment set (see Perkovic et al. (2018)). Often, however, there are multiple such valid adjustment sets, providing total effect estimates with varying accuracies. Suppose that there exists a valid adjustment set relative to (<code>X</code>,<code>Y</code>) in causal graph <code>G</code>, and each node in Y is a descendant of X, then there exists a valid adjustment which provides the total effect estimate with the optimal asymptotic variance, which we will refer to as <code>O(X,Y,G)</code> (Henckel et al., 2019). This function returns this optimal valid adjustment set <code>O(X,Y,G)</code>. 
</p>
<p>The restriction that each node in <code>Y</code> be a descendant of the node set <code>X</code> is not notable, as the total effect of the node set <code>X</code> on a non-descendant is always 0. If provided with a node set <code>Y</code> that does not fulfill this condition this function computes a pruned node set <code>Y2</code> by removing all nodes from <code>Y</code> that are not descendants of <code>X</code> and returns <code>O(X,Y2,G)</code> instead. The user will be alerted to this and given the pruned set <code>Y2</code>.
</p>


<h3>Value</h3>

<p>A vector with the positions of the nodes of the optimal set O(<code>X</code>,<code>Y</code>,<code>G</code>).
</p>


<h3>Author(s)</h3>

<p>Leonard Henckel
</p>


<h3>References</h3>

<p>E. Perković, J. Textor, M. Kalisch and M.H. Maathuis (2018). Complete graphical characterization and construction of adjustment   sets in Markov equivalence classes of ancestral graphs. <em>Journal of Machine Learning Research.</em> <b>18</b>(220) 1–62,
</p>
<p>L. Henckel, E. Perkovic and M.H. Maathuis (2019). Graphical criteria for efficient total 
effect estimation via adjustment in causal linear models.
<em>Working Paper.</em>
</p>


<h3>Examples</h3>

<pre><code class="language-R">## Simulate a true DAG, its CPDAG and an intermediate max. PDAG
suppressWarnings(RNGversion("3.5.0"))
set.seed(123)
p &lt;- 10
## true DAG
myDAG &lt;- randomDAG(p, prob = 0.3) 
## true CPDAG
myCPDAG &lt;- dag2cpdag(myDAG) 
## true PDAG with added background knowledge 5 -&gt; 6
myPDAG &lt;- addBgKnowledge(myCPDAG,5,6) 
if (require(Rgraphviz)) {
par(mfrow = c(1,3))
plot(myDAG)
plot(myPDAG)
plot(myCPDAG) ## plot of the graphs
}

## if the CPDAG C is amenable relative to (X,Y),
## the optimal set will be the same for all DAGs 
## and any max. PDAGs obtained by adding background knowledge to C 
(optAdjSet(myDAG,3,10))
(optAdjSet(myPDAG,3,10))
(optAdjSet(myCPDAG,3,10))


## the optimal adjustment set can also be compute for sets X and Y
(optAdjSet(myDAG,c(3,4),c(9,10)))
(optAdjSet(myPDAG,c(3,4),c(9,10)))
(optAdjSet(myCPDAG,c(3,4),c(9,10)))

## The only restriction is that it requires all nodes in Y to be
## descendants of X.
## However, if a node in Y is non-descendant of X the lowest variance
## partial total effect estimate is simply 0.
## Hence, we can proceed with a pruned Y. This function does this automatically!
optAdjSet(myDAG,1,c(3,9))

## Note that for sets X there may be no valid adjustment set even
## if the PDAG is is amenable relative to (X,Y).
## Not run: optAdjSet(myPDAG,c(4,9),7)

</code></pre>


</div>