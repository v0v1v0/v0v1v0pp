<div class="container">

<table style="width: 100%;"><tr>
<td>extract_nonvscan_counts</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>extract_nonvscan_counts</h2>

<h3>Description</h3>

<p>Extract counts from vcf produced by other caller than VarScan (e.g., bcftools, FreeBayes, GATK)
</p>


<h3>Usage</h3>

<pre><code class="language-R">.extract_nonvscan_counts(vcf_data, nb_all, ad_idx, min_rc)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>vcf_data</code></td>
<td>
<p>a matrix of String containing count information</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>nb_all</code></td>
<td>
<p>a vector containing the number of alleles for the different markers</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>ad_idx</code></td>
<td>
<p>the index of the FORMAT AD field</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>min_rc</code></td>
<td>
<p>Minimal allowed read count per base (same as min.rc option in <code>vcf2pooldata</code>)</p>
</td>
</tr>
</table>
<h3>Details</h3>

<p>Extract VarScan counts and return read counts for the reference and alternate allele
</p>


<h3>Value</h3>

<p>A numeric matrix of read count with nsnp rows and 2*npools+6 columns.
The first npools columns consist of read count for the reference allele,
columns npools+1 to 2*npools consist of read coverage. The last 6 columns correspond to 
the index of the two most frequent alleles (idx_all1 and idx_all2) and their count (cnt_all1 and cnt_all2);
the min_rc filtering criterion and count of variant (cnt_bases) other than two first most frequent. The min_rc crit is
set to -1 for polymorphisms with more than 2 alleles and with the third most frequent alleles having 
more than min_rc count
</p>


<h3>Examples</h3>

<pre><code class="language-R">.extract_nonvscan_counts(rbind(c("0/0:20,0","1/1:1,18"),c("0/2:12,1,15","1/1:27,1,0")),c(2,3),2,0)
.extract_nonvscan_counts(rbind(c("0/0:20,0","1/1:1,18"),c("0/2:12,1,15","1/1:27,1,0")),c(2,3),2,2)
</code></pre>


</div>