<div class="container">

<table style="width: 100%;"><tr>
<td>powerInteract2by2</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>
Power Calculation for Interaction Effect in 2x2 Two-Way ANOVA Given Effect Sizes
</h2>

<h3>Description</h3>

<p>Power calculation for interaction effect in 2x2 two-way ANOVA given effect sizes.
</p>


<h3>Usage</h3>

<pre><code class="language-R">powerInteract2by2(n, tauBetaSigma, alpha = 0.05, nTests = 1, verbose = FALSE)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>n</code></td>
<td>

<p>integer. Number of subjects per group.
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>tauBetaSigma</code></td>
<td>

<p>Effect sizes <code class="reqn">\left(\tau\beta\right)_{ij}/\sigma, i=1, \ldots, a, j=1,\ldots, b</code>, where <code class="reqn">a=b=2</code> and <code class="reqn">\sigma</code> is
the standard deviation of random error. Rows are for factor 1 and columns are for factor 2.  Note that <code class="reqn">\sum_{i=1}^a \left(\tau\beta\right)_{ij} = \sum_{j=1}^b \left(\tau\beta\right)_{ij}=0</code>. We can get
<code class="reqn">\left(\tau\beta\right)_{11}=\theta</code>,
<code class="reqn">\left(\tau\beta\right)_{12}=-\theta</code>,
<code class="reqn">\left(\tau\beta\right)_{21}=-\theta</code>,
<code class="reqn">\left(\tau\beta\right)_{22}=\theta</code>. So
<code>tauBetaSigma=</code><code class="reqn">\theta/\sigma</code>
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>alpha</code></td>
<td>

<p>family-wise type I error rate.
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>nTests</code></td>
<td>

<p>integer. For high-throughput omics study, 
we perform two-way ANOVA for each of 'nTests' probes.
We use Bonferroni correction to control for family-wise type I error rate.
That is, for each probe, type I error rate would be <code>alpha/nTests</code>.
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>verbose</code></td>
<td>

<p>logical. Indicating if intermediate results should be printed out.
</p>
</td>
</tr>
</table>
<h3>Details</h3>

<p>We assume the following model:
</p>
<p style="text-align: center;"><code class="reqn">y_{ijk}=\mu+\tau_i + \beta_j + \left(\tau\beta\right)_{ij} + \epsilon_{ijk},</code>
</p>

<p>where <code class="reqn">i=1,\ldots, a, j=1,\ldots, b, k=1, \ldots, n</code>, <code class="reqn">\sum_{i=1}^{a}\tau_i = 0</code>, 
<code class="reqn">\sum_{j=1}^{b}\beta_j = 0</code>, <code class="reqn">\sum_{i=1}^{a} \left(\tau\beta\right)_{ij} = 0</code>,
<code class="reqn">\sum_{j=1}^{b} \left(\tau\beta\right)_{ij} = 0</code>,
and <code class="reqn">\epsilon_{ijk}\stackrel{i.i.d}{\sim} N\left(0, \sigma^2\right)</code>. 
</p>
<p>The group means are
</p>
<p style="text-align: center;"><code class="reqn">\mu_{ij} = \mu+\tau_i + \beta_j + \left(\tau\beta\right)_{ij}, i=1 \ldots, a,
j=1,\ldots, b.</code>
</p>

<p>Note that <code class="reqn">\mu = \sum_{i=1}^{a}\sum_{j=1}^b \mu_{ij} / (ab)</code>,
<code class="reqn">\tau_i = \sum_{j=1}^b \mu_{ij}/b - \mu</code>, and 
<code class="reqn">\beta_j = \sum_{i=1}^a \mu_{ij}/a - \mu</code>.
</p>
<p>The null hypothesis <code class="reqn">H_0</code>: all <code class="reqn">\left(\tau\beta\right)_{ij}, i=1, \ldots, a, j=1,\ldots, b</code> are equal to zero.
The alternative hypothesis <code class="reqn">H_a</code>: at least one <code class="reqn">\left(\tau\beta\right)_{ij}</code> is different from zero.
</p>
<p>The F test statistic is </p>
<p style="text-align: center;"><code class="reqn">F=MS_{AB}/MS_{E}\stackrel{H_a}{\sim} F_{(a-1)(b-1), ab(n - 1), ncp},</code>
</p>

<p>where <code>ncp</code> is the 
non-centrality parameter of the F test statistic:
</p>
<p style="text-align: center;"><code class="reqn">ncp=n\sum_{i=1}^{a}\sum_{j=1}^{b}\left[\frac{\left(\tau\beta\right)_{ij}}{\sigma}\right]^2.</code>
</p>

<p>For the scenario <code class="reqn">a=b=2</code>, we have 
<code class="reqn">\left(\tau\beta\right)_{11}=\theta</code>,
<code class="reqn">\left(\tau\beta\right)_{12}=-\theta</code>,
<code class="reqn">\left(\tau\beta\right)_{21}=-\theta</code>,
<code class="reqn">\left(\tau\beta\right)_{22}=\theta</code>. 
Hence,
the non-centrality parameter can be simplified to
</p>
<p style="text-align: center;"><code class="reqn">ncp=4n\left(\frac{\theta}{\sigma}\right)^2.</code>
</p>

<p>The power for testing the null hypothesis <code class="reqn">H_0</code> versus
the alternative hypothesis <code class="reqn">H_a</code> is
</p>
<p style="text-align: center;"><code class="reqn">power=Pr\left(F &gt; F_0 | H_a\right),</code>
</p>
 
<p>where the rejection region boundary <code class="reqn">F_0</code> satisfies:
</p>
<p style="text-align: center;"><code class="reqn">Pr\left(F &gt; F_0 | H_0\right) = \alpha/nTests.</code>
</p>



<h3>Value</h3>

<p>A list with 5 elements:
</p>
<table>
<tr style="vertical-align: top;">
<td><code>power </code></td>
<td>
<p>the power of the two-way ANOVA test</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>df1 </code></td>
<td>
<p>the first degree of freedom of the F test statistic (<code>df1=(a-1)(b-1)</code>)</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>df2 </code></td>
<td>
<p>the second degree of freedom of the F test statistic (<code>df1=a*b(n-1)</code>)</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>F0 </code></td>
<td>
<p>the rejection region boundary</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>ncp </code></td>
<td>
<p>the non-centrality parameter</p>
</td>
</tr>
</table>
<h3>Author(s)</h3>

<p>Weiliang Qiu <a href="mailto:weiliang.qiu@gmail.com">weiliang.qiu@gmail.com</a>
</p>


<h3>References</h3>

<p>Chow SC, Shao J, and Wang H. 
Sample size calculations in clinical research. 2nd edition.
Chapman &amp; Hall/CRC. 2008
</p>
<p>Montgomery DC.
Design and Analysis of Experiments. 8th edition.
John Wiley &amp; Sons. Inc.
</p>


<h3>Examples</h3>

<pre><code class="language-R">n = 25
tauBetaSigma = 0.3

# power = 0.8437275
res2 = powerInteract2by2(n = n, tauBetaSigma = tauBetaSigma, 
    alpha = 0.05, nTests = 1, verbose = TRUE)

</code></pre>


</div>