<div class="container">

<table style="width: 100%;"><tr>
<td>predict_probe_func</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>Obtaining predictions, confidence intervals and prediction intervals from probe</h2>

<h3>Description</h3>

<p>A function providing predictions, along with <code class="reqn">(1-\alpha)*100\%</code> credible, and prediction intervals for new observations.
</p>


<h3>Usage</h3>

<pre><code class="language-R">predict_probe_func(res, X, Z = NULL, alpha = 0.05, X_2 = NULL)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>res</code></td>
<td>
<p>The results from the probe function.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>X</code></td>
<td>
<p>A matrix containing the predictors on which to apply the probe algorithm</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>Z</code></td>
<td>
<p>(optional) A matrix or dataframe of predictors not subjected to the sparsity assumption to account for.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>alpha</code></td>
<td>
<p>significance level for (<code class="reqn">100(1-\alpha)\%</code>) credible and prediction intervals.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>X_2</code></td>
<td>
<p>(optional) Square of X matrix.</p>
</td>
</tr>
</table>
<h3>Value</h3>

<p>A dataframe with predictions, credible intervals, and prediction intervals for each new observation.
</p>


<h3>References</h3>

<p>McLain, A. C., Zgodic, A., &amp; Bondell, H. (2022). Sparse high-dimensional linear regression with a partitioned empirical Bayes ECM algorithm. arXiv preprint arXiv:2209.08139.
Zgodic, A., Bai, R., Zhang, J., Wang, Y., Rorden, C., &amp; McLain, A. (2023). Heteroscedastic sparse high-dimensional linear regression with a partitioned empirical Bayes ECM algorithm. arXiv preprint arXiv:2309.08783.
</p>


<h3>Examples</h3>

<pre><code class="language-R">### Example
data(Sim_data)
data(Sim_data_test)
attach(Sim_data)
attach(Sim_data_test)
alpha &lt;- 0.05
plot_ind &lt;- TRUE
adj &lt;- 10

# Run the analysis. Y_test and X_test are included for plotting purposes only
full_res &lt;- probe( Y = Y, X = X, Y_test = Y_test, 
X_test = X_test, alpha = alpha, plot_ind = plot_ind, adj = adj)

# Predicting for test data
pred_res &lt;- predict_probe_func(full_res, X = X_test, alpha = alpha)
sqrt(mean((Y_test - pred_res$Pred)^2))
head(pred_res)

</code></pre>


</div>