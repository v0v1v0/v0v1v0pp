<div class="container">

<table style="width: 100%;"><tr>
<td>pgraph</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>Calculate the Conditional Dependency Graph</h2>

<h3>Description</h3>

<p><code>pgraph</code> calculate the conditional dependency graph (with/without external factors) via projection using lasso or sparse additive model.
</p>


<h3>Usage</h3>

<pre><code class="language-R">pgraph(
  z,
  f = NULL,
  method = c("lasso", "sam", "ols"),
  cond = TRUE,
  R = 199,
  randSeed = 0,
  trace = FALSE
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>z</code></td>
<td>
<p>n * p dimensional matrix</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>f</code></td>
<td>
<p>n * q factor matrix. Default = 'NULL'.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>method</code></td>
<td>
<p>projection method. Default = 'lasso'.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>cond</code></td>
<td>
<p>whether to create a conditional graph or unconditional graph.
Default = TRUE. If cond = FALSE, f must be provided.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>R</code></td>
<td>
<p>number of random permutations for the test.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>randSeed</code></td>
<td>
<p>the random seed for the program. Default = 0.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>trace</code></td>
<td>
<p>whether to trace to estimation process.</p>
</td>
</tr>
</table>
<h3>Value</h3>

<p>a list to be used to calculate the ROC curve.
</p>
<table>
<tr style="vertical-align: top;">
<td><code>statmat.pearson</code></td>
<td>
<p>matrix with pearson correlation test</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>statmat.dcov</code></td>
<td>
<p>matrix with distance covariance test</p>
</td>
</tr>
</table>
<h3>See Also</h3>

<p><code>greg</code>, <code>roc</code>, <code>projcov</code>
</p>


<h3>Examples</h3>

<pre><code class="language-R">library(splines)
set.seed(0)
p = 5;
n = 100;
tmp=runif(p-1,1,3)
s=c(0,cumsum(tmp));
s1=matrix(s,p,p)
cov.mat.true=exp(-abs(s1-t(s1)))
prec.mat.true=solve(cov.mat.true);
a=matrix(rnorm(p*n),n,p)
data.sa=a%*%chol(cov.mat.true);
true.graph = outer(1:p,1:p,f&lt;-function(x,y){(abs(x-y)==1)})
methodlist = c('lasso','sam')
fit = vector(mode='list', length=2)
info = vector(mode='list', length=2)
auc = NULL
for(i in 1:2){
method = methodlist[i]
fit[[i]] = pgraph(data.sa, method = method)
info[[i]] = roc(fit[[i]]$statmat.pearson, true.graph)
auc[i] = sum(-diff(info[[i]][,1])*info[[i]][-1,2])
  cat(method, ': auc=', auc[i],'\n')
}
</code></pre>


</div>