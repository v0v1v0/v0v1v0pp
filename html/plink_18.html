<div class="container">

<table style="width: 100%;"><tr>
<td>drm-methods</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>Dichotomous Response Model Probabilities</h2>

<h3>Description</h3>

<p>This function computes the probability of correct responses (and optionally, incorrect 
responses) for one or more items for a given set of theta values using the 1PL, 2PL, 3PL,
M1PL, M2PL or M3PL model, depending on the included item parameters and the specified
number of dimensions.
</p>


<h3>Usage</h3>

<pre><code class="language-R">drm(x, theta, dimensions = 1, D = 1, incorrect = FALSE, 
  print.mod = FALSE, items, information = FALSE, angle, ...)

## S4 method for signature 'numeric'
drm(x, theta, dimensions, D, incorrect, print.mod, items, information, angle, ...)

## S4 method for signature 'matrix'
drm(x, theta, dimensions, D, incorrect, print.mod, items, information, angle, ...)

## S4 method for signature 'data.frame'
drm(x, theta, dimensions, D, incorrect, print.mod, items, information, angle, ...)

## S4 method for signature 'list'
drm(x, theta, dimensions, D, incorrect, print.mod, items, information, angle, ...)

## S4 method for signature 'irt.pars'
drm(x, theta, dimensions, D, incorrect, print.mod, items, information, angle, ...)

## S4 method for signature 'sep.pars'
drm(x, theta, dimensions, D, incorrect, print.mod, items, information, angle, ...)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>x</code></td>
<td>
<p>an <code>R</code> object containing item parameters</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>theta</code></td>
<td>
<p>vector, matrix, or list of theta values for which probabilities will be computed. 
If <code>theta</code> is not specified, an equal interval range of values from -4 to 4 is used 
with an increment of 0.5. See details below for more information. </p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>dimensions</code></td>
<td>
<p>number of modeled dimensions </p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>D</code></td>
<td>
<p>scaling constant. The default value assumes that the parameters are already in the 
desired metric. If the parameters are in the logistic metric, they can be transformed to a 
normal metric by setting D = 1.7</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>incorrect</code></td>
<td>
<p>if <code>TRUE</code>, compute probabilities for the incorrect response category) </p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>print.mod</code></td>
<td>
<p>if <code>TRUE</code>, print the model that was used (i.e., 1PL, 2PL, 3PL, M1PL, M2PL, or M3PL) </p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>items</code></td>
<td>
<p>numeric vector identifying the items for which probabilities should be computed</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>information</code></td>
<td>
<p>logical value. If <code>TRUE</code> compute item information. In the multidimensional
case, information will be computed in the directions specified by <code>angle</code> or default angles
of 0 - 90 in increments of 10 degrees.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>angle</code></td>
<td>
<p>vector or matrix of angles between the dimension 1 axis and the corresponding axes for each 
of the other dimensions for which information will be computed. When there are more than two dimensions 
and <code>angle</code> is a vector, the same set of angles will be used relative to each of the corresponding axes.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>...</code></td>
<td>
<p>further arguments passed to or from other methods </p>
</td>
</tr>
</table>
<h3>Details</h3>

<p><code>theta</code> can be specified as a vector, matrix, or list.  For the unidimensional case, <code>theta</code>
should be a vector. If a matrix or list of values is supplied, they will be converted to a single vector
of theta values.  For the multidimensional case, if a vector of values is supplied it will be assumed
that this same set of values should be used for each dimension.  Probabilities will be computed for each
combination of theta values.  Similarly, if a list is supplied, probabilities will be computed for each
combination of theta values.  In instances where probabilities are desired for specific combinations of 
theta values, a j x m matrix should be specified for j ability points and m dimensions where the columns 
are ordered from dimension 1 to m.
</p>


<h3>Value</h3>

<p>Returns an object of class <code>irt.prob</code>
</p>


<h3>Methods</h3>


<dl>
<dt>x = "numeric"</dt>
<dd>
<p>This method should only be used for the Rasch model where <code>x</code> is a vector of 
difficulty parameters (or parameters related to item difficulty in the multidimensional case).  Under 
this method the slopes and lower asymptote values for all items will default to one and zero respectively.  
This is true for both the unidimensional and multidimensional case.</p>
</dd>
<dt>x = "matrix"</dt>
<dd>
<p>This method allows one to specify an n x k matrix for n items, for m
dimensions, and k equal to m, m+1, or m+2.  The first m columns generally correspond to the 
discrimination/slope parameters, and the last two columns correspond to the difficulty, and
lower asymptote parameters, although this may not be the case depending on the supplied
parameters.
</p>

<dl>
<dt>1PL/M1PL:</dt>
<dd>
<p>For the 1PL and M1PL model with discriminations equal to 1 (Rasch Model), 
an n x 1 matrix of item difficulties can be supplied.  An n x (m+1) matrix can also be used with
all the values in the first m columns equal to 1 and difficulty parameters in the last
column.  For discrimination values other than 1, <code>x</code> should include at least m+1
columns where the first m columns contain the item discriminations (identical for all items) 
and the last column is for the item difficulties.  The lower asymptote defaults to zero for 
all items; however, m+2 columns can be specified where the values in the last column all 
equal zero.</p>
</dd>
<dt>2PL/M2PL:</dt>
<dd>
<p><code>x</code> should include at least m+1 columns where the first m columns contain 
the item discriminations and the last column is for the item difficulties.  The lower asymptote 
defaults to zero for all items; however, m+2 columns can be specified where the values in the 
last column all equal zero.</p>
</dd>
<dt>3PL/M3PL:</dt>
<dd>
<p><code>x</code> should include m+2 columns where the first m columns contain the item 
discriminations, the m+1 column is for item difficulties, and the last column is for lower 
asymptote values.</p>
</dd>
</dl>
</dd>
<dt>x = "data.frame"</dt>
<dd>
<p>See the method for x = "matrix" </p>
</dd>
<dt>x = "list"</dt>
<dd>
<p>This method can include a list with 1, 2, or 3 elements.  In general, these 
elements correspond to discrimination, difficulty, and lower asymptote parameters, although 
this may not be the case depending on the supplied parameters.  For the unidimensional case,
each list element can be a vector of length n or an n x 1 matrix for n items.  For the 
multidimensional case, the list element for the discrimination parameters should be an n x m
matrix for m dimensions.  The other list elements can be vectors of length n or an n x 1 matrix 
for n items.
</p>

<dl>
<dt>1PL/M1PL:</dt>
<dd>
<p>For the 1PL and M1PL model with discriminations equal to 1 (Rasch Model), 
one element with item difficulties can be supplied.  Alternatively, two elements can be used 
with the first list element containing a matrix/vector of ones and difficulty parameters in 
the second list element.  For discrimination values other than 1, <code>x</code> should contain 
at  least two list elements where the first contains the item discriminations (identical 
for all items) and the second is for item difficulties.  The lower asymptote defaults to 
zero for all items; however, a third element with a vector/matrix of zeros can be included.</p>
</dd>
<dt>2PL/M2PL:</dt>
<dd>
<p><code>x</code> should contain at least two list elements where the first element 
contains the item discriminations and the second element includes the item difficulties.  
The lower asymptote defaults to zero for all items; however, a third element with a 
vector/matrix of zeros can be included.</p>
</dd>
<dt>3PL/M3PL:</dt>
<dd>
<p><code>x</code> should include three list elements where the first element contains the 
item discriminations, the second element includes the item difficulties, and the third element
contains the lower asymptote values.</p>
</dd>
</dl>
</dd>
<dt>x = "irt.pars"</dt>
<dd>
<p>This method can be used to compute probabilities for the dichotomous
items in an object of class <code>"irt.pars"</code>.  If <code>x</code> contains polytomous items, a
warning will be displayed stating that probabilities will be computed for the 
dichotomous items only.  If <code>x</code> contains parameters for multiple groups, a list of 
<code>"irt.prob"</code> objects will be returned.  The argument <code>dimensions</code> does not need
to be included for this method.</p>
</dd>
<dt>x = "sep.pars"</dt>
<dd>
<p>This method can be used to compute probabilities for the dichotomous
items in an object of class <code>sep.pars</code>.  If <code>x</code> contains polytomous items, a
warning will be displayed stating that probabilities will be computed for the 
dichotomous items only.  The argument <code>dimensions</code> does not need to be included for 
this method.</p>
</dd>
</dl>
<h3>Note</h3>

 
<p>The indices 0 and 1 are used in the column labels for incorrect and correct responses 
respectively (e.g. the label d1.0 indicates the incorrect response column for item 1, d1.1 
indicates the correct response column for the same item).  If <code>incorrect</code> = <code>FALSE</code>, 
all column labels will end with .1
</p>


<h3>Author(s)</h3>

<p> Jonathan P. Weeks <a href="mailto:weeksjp@gmail.com">weeksjp@gmail.com</a> </p>


<h3>References</h3>

 
<p>Adams, R. J., Wilson, M., &amp; Wang, W. (1997).
The multidimensional random coefficients multinomial logit model.
<em>Applied Psychological Measurement</em>, <em>21</em>(1), 1-23.
</p>
<p>Birnbaum, A. (1968).
Some latent trait models and their use in inferring an examinee's ability
In F. M. Lord &amp; M. R. Novick (Eds.)
<em>Statistical Theories of Mental Test Scores.</em>
Reading, MA: Addison-Wesley.
</p>
<p>Rasch, G. (1960).
<em>Probabilistic Models for Some Intelligence and Attainment Tests</em>
Copenhagen, Denmark: Danish Institute for Educational Research.
</p>
<p>Reckase, M. D. (1985). 
The difficulty of items that measure more than one ability.
<em>Applied Psychological Measurement</em>, <em>9</em>(4), 401-412. 
</p>
<p>Reckase, M. D. (1997). 
A linear logistic multidimensional model for dichotomous item response data. 
In W. J. van der Linden &amp; R. K. Hambleton (Eds.)
<em>Handbook of Modern Item Response Theory</em> (pp. 271-286). 
New York: Springer-Verlag.
</p>
<p>Weeks, J. P. (2010) 
<b>plink</b>: An R package for linking mixed-format tests using IRT-based methods. 
<em>Journal of Statistical Software</em>, <b>35(12)</b>, 1â€“33. 
URL <a href="http://www.jstatsoft.org/v35/i12/">http://www.jstatsoft.org/v35/i12/</a>
</p>


<h3>See Also</h3>

 
<p><code>mixed:</code> compute probabilities for mixed-format items<br><code>plot:</code> plot item characteristic/category curves<br><code>irt.prob</code>, <code>irt.pars</code>, <code>sep.pars:</code> classes
</p>


<h3>Examples</h3>

<pre><code class="language-R">###### Unidimensional Examples ######
## 1PL
# A single item with a difficulty at 1 logit
x &lt;- drm(1) 
plot(x)

# Three items with a difficulties at -2.2, -1.7, and 0.54 logits 
# respectively. Assume a constant discrimination of 1 for each item
b &lt;- c(-2.2,-.7,1.54)
x &lt;- drm(b) 
# Plot the expected probabilites
plot(x)

# Five items with a constant discrimination equal to 1.2
# Use the scaling constant for the normal metric
a &lt;- rep(1.2,5)
b &lt;- c(-2,-1,0,1,2)
pars &lt;- list(a,b)
x &lt;- drm(pars,D=1.7)
# Extract the expected probabilities
get.prob(x)
# Plot the expected probabilities
plot(x,combine=5,item.names="Items 1-5")


## 2PL
# Compute probabilities for five items at a theta value of 1.5 logits
# Print the model
a &lt;- c(1,.8,.6,1.2,.9)
b &lt;- c(-1.7,2.2,.4,-1,-.4)
pars &lt;- cbind(a,b)
drm(pars,theta=1.5,print.mod=TRUE)


# Include a vector of zeros for the lower asymptote
# Compute probabilities for incorrect responses
a &lt;- c(.63,1.14,.89,1.01,1.51,.58)
b &lt;- c(-1.9,.08,1.6,-1.4,.5,-2.3)
c &lt;- rep(0,6)
pars &lt;- cbind(a,b,c)
x &lt;- drm(pars,incorrect=TRUE)
plot(x)


## 3PL
a &lt;- c(1,.8,.4,1.5,.9)
b &lt;- c(-2,-1,0,1,2)
c &lt;- c(.2,.25,.18,.2,.22)
pars &lt;- list(a,b,c)
x &lt;- drm(pars)
plot(x)

# Use theta values from -3 to 3 with an increment of 0.2
a &lt;- c(.71,.96,.36,1.05,1.76,.64)
b &lt;- c(-.16,1.18,2.03,1.09,.82,-1.56)
c &lt;- c(.22,.17,.24,.08,.20,.13)
theta &lt;- seq(-3,3,.2)
pars &lt;- cbind(a,b,c)
x &lt;- drm(pars,theta)
plot(x,combine=6,item.names="Items 1-6",auto.key=list(space="right"))

###### Multidimensional Examples ######
## M1PL
# A single item with a parameter related to item difficulty at 1 logit
x &lt;- drm(1, dimensions=2) 
plot(x)

# Three items with a difficulties at -2.2, -1.7, and 0.54 logits 
# respectively. Assume a constant discrimination of 1 for each item
d &lt;- c(-2.2,-.7,1.54)
x &lt;- drm(d, dimensions=2) 
plot(x, drape=TRUE)


## M2PL
# Items 27-30 from Reckase (1985)
a &lt;- matrix(c(1.66,1.72,.69,.19,.88,1.12,.68,1.21),4,2,byrow=TRUE)
d &lt;- c(-.38,-.68,-.91,-1.08)
pars &lt;- list(a,d)
x &lt;- drm(pars,dimensions=2)
plot(x, drape=TRUE, item.names=paste("Item",27:30))

# Create contourplots for these items
plot(x,type="contourplot",cuts=10)


## M3PL
# Single item from Reckase (1997, p. 274)
pars &lt;- t(c(.8,1.4,-2,.2))
x &lt;- drm(pars, dimensions=2)
plot(x, default.scales=list(arrows=FALSE),drape=TRUE)

# Compute the probabilities of an incorrect response
# for the Reckase (1997) item
x &lt;- drm(pars, dimensions=2, incorrect=TRUE)
plot(x, screen=list(z=-40,x=-60), auto.key=list(space="right"))

# Four items from the included example for BMIRT (Yao, 2003)
# modeled using four dimensions
pars &lt;- matrix(c(0.5038,2.1910,1.1317,0.2493,0.5240,0.1763, 
0.2252,1.1999,0.5997,0.2087, 2.1730,0.4576,
0.2167,0.2487,1.4009,0.3865,-1.5270,0.3507, 
2.3428,1.1530,0.3577,0.4240,-1.4971,0.3641),4,6,byrow=TRUE)
colnames(pars) &lt;- c("a1","a2","a3","a4","d","c")
x &lt;- drm(pars, dimensions=4, print.mod=TRUE)


## Not run: 
# Plot the item response surfaces for item 4
plot(x,items=4,item.names="Item 4",drape=TRUE)

## End(Not run)
</code></pre>


</div>