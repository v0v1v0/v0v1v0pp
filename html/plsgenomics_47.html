<div class="container">

<table style="width: 100%;"><tr>
<td>sample.bin</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>Generates covariate matrix X with correlated block of covariates and 
a binary random reponse depening on X through a logistic model</h2>

<h3>Description</h3>

<p>The function <code>sample.bin</code> generates a random sample of n observations, 
composed of p predictors, collected in the n x p matrix X, and a binary 
response, in a vector Y of length n, thanks to a logistic model, where the 
response Y is generated as a Bernoulli random variable of parameter 
logit^{-1}(XB), the coefficients B are sparse. In addition, the covariate 
matrix X is composed of correlated blocks of predictors.
</p>


<h3>Usage</h3>

<pre><code class="language-R">sample.bin(
  n,
  p,
  kstar,
  lstar,
  beta.min,
  beta.max,
  mean.H = 0,
  sigma.H = 1,
  sigma.F = 1,
  seed = NULL
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>n</code></td>
<td>
<p>the number of observations in the sample.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>p</code></td>
<td>
<p>the number of covariates in the sample.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>kstar</code></td>
<td>
<p>the number of underlying latent variables used to generates 
the covariate matrix <code>X</code>, <code>kstar &lt;= p</code>. <code>kstar</code> is also the 
number of blocks in the covariate matrix (see details).</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>lstar</code></td>
<td>
<p>the number of blocks in the covariate matrix <code>X</code> that are 
used to generates the response <code>Y</code>, i.e. with non null coefficients 
in vector <code>B</code>, <code>lstar &lt;= kstar</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>beta.min</code></td>
<td>
<p>the inf bound for non null coefficients (see details).</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>beta.max</code></td>
<td>
<p>the sup bound for non null coefficients (see details).</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>mean.H</code></td>
<td>
<p>the mean of latent variables used to generates <code>X</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>sigma.H</code></td>
<td>
<p>the standard deviation of latent variables used to 
generates <code>X</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>sigma.F</code></td>
<td>
<p>the standard deviation of the noise added to latent 
variables used to generates <code>X</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>seed</code></td>
<td>
<p>an positive integer, if non NULL it fix the seed (with the 
command <code>set.seed</code>) used for random number generation.</p>
</td>
</tr>
</table>
<h3>Details</h3>

<p>The set (1:p) of predictors is partitioned into kstar block. 
Each block k (k=1,...,kstar) depends on a latent variable H.k which are 
independent and identically distributed following a Gaussian distribution 
N(mean.H, sigma.H^2). Each columns X.j of the matrix X is generated 
as H.k + F.j for j in the block k, where F.j is independent and identically 
distributed gaussian noise N(0,sigma.F^2).
</p>
<p>The coefficients B are generated as random between beta.min and beta.max 
on lstar blocks, randomly chosen, and null otherwise. The variables with 
non null coefficients are then relevant to explain the response, whereas 
the ones with null coefficients are not.
</p>
<p>The response is generated as by drawing one observation of n different 
Bernoulli random variables of parameters logit^{-1}(XB).
</p>
<p>The details of the procedure are developped by Durif et al. (2018).
</p>


<h3>Value</h3>

<p>An object with the following attributes:
</p>
<table>
<tr style="vertical-align: top;">
<td><code>X</code></td>
<td>
<p>the (n x p) covariate matrix, containing the <code>n</code> observations 
for each of the <code>p</code> predictors.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>Y</code></td>
<td>
<p>the (n) vector of Y observations.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>proba</code></td>
<td>
<p>the n vector of Bernoulli parameters used to generate the 
response, in particular <code>logit^{-1}(X %*% B)</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>sel</code></td>
<td>
<p>the index in (1:p) of covariates with non null coefficients 
in <code>B</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>nosel</code></td>
<td>
<p>the index in (1:p) of covariates with null coefficients 
in <code>B</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>B</code></td>
<td>
<p>the (n) vector of coefficients.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>block.partition</code></td>
<td>
<p>a (p) vector indicating the block of each predictors 
in (1:kstar).</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>p</code></td>
<td>
<p>the number of covariates in the sample.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>kstar</code></td>
<td>
<p>the number of underlying latent variables used to generates 
the covariate matrix <code>X</code>, <code>kstar &lt;= p</code>. <code>kstar</code> is also 
the number of blocks in the covariate matrix (see details).</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>lstar</code></td>
<td>
<p>the number of blocks in the covariate matrix <code>X</code> that 
are used to generates the response <code>Y</code>, i.e. with non null 
coefficients in vector <code>B</code>, <code>lstar &lt;= kstar</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>p0</code></td>
<td>
<p>the number of predictors with non null coefficients in <code>B</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>block.sel</code></td>
<td>
<p>a (lstar) vector indicating the index in (1:kstar) of 
blocks with predictors having non null coefficient in <code>B</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>beta.min</code></td>
<td>
<p>the inf bound for non null coefficients (see details).</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>beta.max</code></td>
<td>
<p>the sup bound for non null coefficients (see details).</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>mean.H</code></td>
<td>
<p>the mean of latent variables used to generates <code>X</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>sigma.H</code></td>
<td>
<p>the standard deviation of latent variables used to 
generates <code>X</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>sigma.F</code></td>
<td>
<p>the standard deviation of the noise added to latent 
variables used to generates <code>X</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>seed</code></td>
<td>
<p>an positive integer, if non NULL it fix the seed 
(with the command <code>set.seed</code>) used for random number generation.</p>
</td>
</tr>
</table>
<h3>Author(s)</h3>

<p>Ghislain Durif (<a href="https://gdurif.perso.math.cnrs.fr/">https://gdurif.perso.math.cnrs.fr/</a>).
</p>


<h3>References</h3>

<p>Durif, G., Modolo, L., Michaelsson, J., Mold, J.E., Lambert-Lacroix, S., 
Picard, F., 2018. High dimensional classification with combined 
adaptive sparse PLS and logistic regression. Bioinformatics 34, 
485â€“493. <a href="https://doi.org/10.1093/bioinformatics/btx571">doi:10.1093/bioinformatics/btx571</a>.
Available at <a href="http://arxiv.org/abs/1502.05933">http://arxiv.org/abs/1502.05933</a>.
</p>


<h3>See Also</h3>

<p><code>sample.cont</code>
</p>


<h3>Examples</h3>

<pre><code class="language-R">### load plsgenomics library
library(plsgenomics)

### generating data
n &lt;- 100
p &lt;- 1000
sample1 &lt;- sample.bin(n=n, p=p, kstar=20, lstar=2, beta.min=0.25, 
                      beta.max=0.75, mean.H=0.2, 
                      sigma.H=10, sigma.F=5)

str(sample1)

</code></pre>


</div>