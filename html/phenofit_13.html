<div class="container">

<table style="width: 100%;"><tr>
<td>D</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>D</h2>

<h3>Description</h3>

<p>Get derivative of <code>phenofit</code> object.
<code>D1</code> first order derivative, <code>D2</code> second order derivative, n
<code>curvature</code> curvature.
</p>


<h3>Usage</h3>

<pre><code class="language-R">D1(fit, t = NULL, analytical = FALSE, smoothed.spline = FALSE, ...)

D2(fit, t = NULL, analytical = FALSE, smoothed.spline = FALSE, ...)

## S3 method for class 'fFIT'
D1(fit, t = NULL, analytical = FALSE, smoothed.spline = FALSE, ...)

## S3 method for class 'fFIT'
D2(fit, t = NULL, analytical = FALSE, smoothed.spline = FALSE, ...)

curvature(fit, t = NULL, analytical = FALSE, smoothed.spline = FALSE, ...)

## S3 method for class 'fFIT'
curvature(fit, t = NULL, analytical = FALSE, smoothed.spline = FALSE, ...)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>fit</code></td>
<td>
<p>A curve fitting object returned by <code>curvefit</code>, with the object of:
</p>

<ul>
<li> <p><code>par</code>: parameters of curve fitting function
</p>
</li>
<li> <p><code>fun</code>: curve fitting function name, e.g., "doubleLog_AG"
</p>
</li>
<li> <p><code>zs</code>: predicted values, vector or data.frame
</p>
</li>
</ul>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>analytical</code></td>
<td>
<p>If true, <code>numDeriv</code> package <code>grad</code> and <code>hess</code>
will be used; if false, <code>D1</code> and <code>D2</code> will be used.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>smoothed.spline</code></td>
<td>
<p>Whether apply <code>smooth.spline</code> first?</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>...</code></td>
<td>
<p>Other parameters will be ignored.</p>
</td>
</tr>
</table>
<h3>Details</h3>

<p>If <code>fit$fun</code> has no gradient function or <code>smoothed.spline = TRUE</code>,
time-series smoothed by spline first, and get derivatives at last.
If <code>fit$fun</code> exists and <code>analytical = TRUE</code>, <code>smoothed.spline</code>
will be ignored.
</p>


<h3>Value</h3>


<ul>
<li>
<p> der1 First order derivative
</p>
</li>
<li>
<p> der2 Second order derivative
</p>
</li>
<li>
<p> k    Curvature
</p>
</li>
</ul>
<h3>Examples</h3>

<pre><code class="language-R"># doubleLog.Beck
t    &lt;- seq(1, 365, 8)
tout &lt;- seq(1, 365, 1)
par  = c(mn  = 0.1, mx  = 0.7, sos = 50, rsp = 0.1, eos = 250, rau = 0.1)
y &lt;- doubleLog.Beck(par, t)

methods &lt;- c("AG", "Beck", "Elmore", "Gu", "Zhang") # "Klos" too slow
fit &lt;- curvefit(y, t, tout, methods)
x  &lt;- fit$model$AG
d1 &lt;- D1(x)
d2 &lt;- D2(x)
d_k &lt;- curvature(x)
</code></pre>


</div>