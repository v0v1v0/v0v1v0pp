<div class="container">

<table style="width: 100%;"><tr>
<td>Tagloss_fit</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>fit a model of tag loss using a CMR database.</h2>

<h3>Description</h3>

<p>This function fits a model of tag loss using a CMR database.<br>
The names of parameters can be:<br>
Model Pfaller et al. (2019):<br></p>

<dl>
<dt>Left tag lost when 2 are present</dt>
<dd>
<p><code>D1_L2</code>, <code>D2D1_L2</code>, <code>D3D2_L2</code>, <code>A_L2</code>, <code>B_L2</code>, <code>C_L2</code>, <code>delta_L2</code></p>
</dd>
<dt>Right tag lost when 2 are present</dt>
<dd>
<p><code>D1_R2</code>, <code>D2D1_R2</code>, <code>D3D2_R2</code>, <code>A_R2</code>, <code>B_R2</code>, <code>C_R2</code>, <code>delta_R2</code></p>
</dd>
<dt>Left tag lost when 1 is present</dt>
<dd>
<p><code>D1_L1</code>, <code>D2D1_L1</code>, <code>D3D2_L1</code>, <code>A_L1</code>, <code>B_L1</code>, <code>C_L1</code>, <code>delta_L1</code></p>
</dd>
<dt>Right tag lost when 1 is present</dt>
<dd>
<p><code>D1_R1</code>, <code>D2D1_R1</code>, <code>D3D2_R1</code>, <code>A_R1</code>, <code>B_R1</code>, <code>C_R1</code>, <code>delta_R1</code></p>
</dd>
<dt>One tag lost when 2 are present</dt>
<dd>
<p><code>D1_2</code>, <code>D2D1_2</code>, <code>D3D2_2</code>, <code>A_2</code>, <code>B_2</code>, <code>C_2</code>, <code>delta_2</code></p>
</dd>
<dt>One tag lost when 1 is present</dt>
<dd>
<p><code>D1_1</code>, <code>D2D1_1</code>, <code>D3D2_1</code>, <code>A_1</code>, <code>B_1</code>, <code>C_1</code>, <code>delta_1</code></p>
</dd>
</dl>
<p><code>pA</code>, <code>pB</code> and <code>pC</code> are the daily probabilities of tag loss with
<code>pA=-logit(A)</code>, <code>pB=-logit(B)</code> and <code>pC=-logit(C)</code> .<br><code>delta</code> is used as: <code>p = p + delta</code>. Nothe that <code>delta</code> can be negative<br>
Tag loss rate is <code>pA</code> at day 1<br>
Tag loss rate changes gradually from <code>pA</code> to <code>pB</code> that is reached at day <code>D1</code><br>
Tag loss rate is <code>pB</code> from day <code>D1</code> to day <code>D2=D1+D2D1</code><br>
Tag loss rate changes gradually from <code>pB</code> to <code>pC</code> that is reached at day <code>D3=D2+D3D2</code><br></p>
<p>When parameters from Rivalan et al. (2005) are used:<br></p>

<dl>
<dt>One tag lost when 2 are present</dt>
<dd>
<p><code>a0_2</code>, <code>a1_2</code>, <code>a2_2</code>, <code>a3_2</code>, <code>a4_2</code>, <code>delta_2</code></p>
</dd>
<dt>One tag lost when 1 is present</dt>
<dd>
<p><code>a0_1</code>, <code>a1_1</code>, <code>a2_1</code>, <code>a3_1</code>, <code>a4_1</code>, <code>delta_1</code></p>
</dd>
</dl>
<p>When parameters from Casale et al. (2017) are used:<br>
Model I<br></p>

<dl>
<dt>One tag lost when 2 are present</dt>
<dd>
<p><code>CasaleModelIc_2</code></p>
</dd>
<dt>One tag lost when 1 is present</dt>
<dd>
<p><code>CasaleModelIc_1</code></p>
</dd>
</dl>
<p>Model II<br></p>

<dl>
<dt>One tag lost when 2 are present</dt>
<dd>
<p><code>CasaleModelIIa0_2</code>, <code>CasaleModelIIa1_2</code>, <code>CasaleModelIIa4_2</code></p>
</dd>
<dt>One tag lost when 1 is present</dt>
<dd>
<p><code>CasaleModelIIa0_1</code>, <code>CasaleModelIIa1_1</code>, <code>CasaleModelIIa4_1</code></p>
</dd>
</dl>
<p>Model III<br></p>

<dl>
<dt>One tag lost when 2 are present</dt>
<dd>
<p><code>CasaleModelIIIa0_2</code>, <code>CasaleModelIIIa1_2</code>, <code>CasaleModelIIIa4_2</code></p>
</dd>
<dt>One tag lost when 1 is present</dt>
<dd>
<p><code>CasaleModelIIIa0_1</code>, <code>CasaleModelIIIa1_1</code>, <code>CasaleModelIIIa4_1</code></p>
</dd>
</dl>
<p>Model IV<br></p>

<dl>
<dt>One tag lost when 2 are present</dt>
<dd>
<p><code>CasaleModelIVa0_2</code>, <code>CasaleModelIVa1_2</code>, <code>CasaleModelIVa2_2</code>, <code>CasaleModelIVa3_2</code>, <code>CasaleModelIVa4_2</code></p>
</dd>
<dt>One tag lost when 1 is present</dt>
<dd>
<p><code>CasaleModelIVa0_1</code>, <code>CasaleModelIVa1_1</code>, <code>CasaleModelIVa2_1</code>, <code>CasaleModelIVa3_1</code>, <code>CasaleModelIVa4_1</code></p>
</dd>
</dl>
<p>Model V<br></p>

<dl>
<dt>One tag lost when 2 are present</dt>
<dd>
<p><code>CasaleModelVa0_2</code>, <code>CasaleModelVa1_2</code>, <code>CasaleModelVa2_2</code>, <code>CasaleModelVa3_2</code>, <code>CasaleModelVa4_2</code></p>
</dd>
<dt>One tag lost when 1 is present</dt>
<dd>
<p><code>CasaleModelVa0_1</code>, <code>CasaleModelVa1_1</code>, <code>CasaleModelVa2_1</code>, <code>CasaleModelVa3_1</code>, <code>CasaleModelVa4_1</code></p>
</dd>
</dl>
<p>If only one parameter is fitted, method must be "Brent" and <code>upper</code> and <code>lower</code>
parameters must be set up with finite values.
</p>
<p>model_before can be ""par['a0_1']=par['a0_2'];par['a1_1']=par['a1_2']".
model_after can be "p1=p2"
</p>


<h3>Usage</h3>

<pre><code class="language-R">Tagloss_fit(
  data = stop("A database formated using Tagloss_format() must be used"),
  fitted.parameters = NULL,
  fixed.parameters = NULL,
  model_before = NULL,
  model_after = NULL,
  control = list(trace = 1, maxit = 10000),
  method = "Nelder-Mead",
  lower = -Inf,
  upper = Inf,
  hessian = FALSE,
  mc.cores = detectCores(all.tests = FALSE, logical = TRUE),
  groups = NULL
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>data</code></td>
<td>
<p>An object formated using Tagloss_format</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>fitted.parameters</code></td>
<td>
<p>Set of parameters to be fitted</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>fixed.parameters</code></td>
<td>
<p>Set of fixed parameters</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>model_before</code></td>
<td>
<p>Transformation of parameters before to use Tagloss_model()</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>model_after</code></td>
<td>
<p>Transformation of parameters after to use Tagloss_model()</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>control</code></td>
<td>
<p>Control parameters to be send to optim()</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>method</code></td>
<td>
<p>optim() method</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>lower</code></td>
<td>
<p>Lower value for parameter when Brent method is used</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>upper</code></td>
<td>
<p>Upper value for parameter when Brent method is used</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>hessian</code></td>
<td>
<p>Does the hessian matrix should be estimated</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>mc.cores</code></td>
<td>
<p>Number of cores to use for parallel computing</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>groups</code></td>
<td>
<p>Number of groups for parallel computing</p>
</td>
</tr>
</table>
<h3>Details</h3>

<p>Tagloss_fit fits a model of tag loss using a CMR database.
</p>


<h3>Value</h3>

<p>Return a list object with the model describing tag loss.
</p>


<h3>Author(s)</h3>

<p>Marc Girondot <a href="mailto:marc.girondot@gmail.com">marc.girondot@gmail.com</a>
</p>


<h3>References</h3>

<p>Rivalan, P., Godfrey, M.H., Prévot-Julliard, A.-C., Girondot, M., 2005. Maximum likelihood estimates of tag loss in leatherback sea turtles. Journal of Wildlife Management 69, 540-548.
</p>
<p>Casale, P., Freggi, D., Salvemini, P., 2017. Tag loss is a minor limiting factor in sea turtle tagging programs relying on distant tag returns: the case of Mediterranean loggerhead sea turtles. European Journal of Wildlife Research 63.
</p>
<p>Pfaller JB, Williams KL, Frick MG, Shamblin BM, Nairn CJ, Girondot M (2019) Genetic determination of tag loss dynamics in nesting loggerhead turtles: A new chapter in “the tag loss problem”. Marine Biology 166: 97 doi 10.1007/s00227-019-3545-x
</p>


<h3>See Also</h3>

<p>Other Model of Tag-loss: 
<code>Tagloss_L()</code>,
<code>Tagloss_LengthObs()</code>,
<code>Tagloss_cumul()</code>,
<code>Tagloss_daymax()</code>,
<code>Tagloss_format()</code>,
<code>Tagloss_mcmc()</code>,
<code>Tagloss_mcmc_p()</code>,
<code>Tagloss_model()</code>,
<code>Tagloss_simulate()</code>,
<code>logLik.Tagloss()</code>,
<code>o_4p_p1p2</code>,
<code>plot.Tagloss()</code>,
<code>plot.TaglossData()</code>
</p>


<h3>Examples</h3>

<pre><code class="language-R">## Not run: 
library(phenology)
# Example
data_f_21 &lt;- Tagloss_format(outLR, model="21")

# model fitted by Rivalan et al. 2005
par &lt;- c(a0_2=-5.43E-2, a1_2=-103.52, a4_2=5.62E-4, 
         delta_1=3.2E-4)
pfixed &lt;- c(a2_2=0, a3_2=0, a2_1=0, a3_1=0)
model_before &lt;- "par['a0_1']=par['a0_2'];par['a1_1']=par['a1_2'];par['a4_1']=par['a4_2']"
o &lt;- Tagloss_fit(data=data_f_21, fitted.parameters=par, fixed.parameters=pfixed, 
                 model_before=model_before)
plot(o, t=1:1000, model="cumul")
plot(o, t=1:1000, model="1")
plot(o, t=1:1000, model="2", add=TRUE, col="red")

# Same data fitted with new model
par &lt;- c(D1_1 = 100.15324837975547, A_1 = 5.9576927964120188, 
         B_1 = 8.769924225871069, B_2 = 8.2353860179664125)
pfixed &lt;- c(D2D1_1 = 2568, D3D2_1 = 2568, D2D1_2 = 2568, D3D2_2 = 2568)
o_4p_p1p2 &lt;- Tagloss_fit(data=data_f_21, fitted.parameters = par, 
                         fixed.parameters = pfixed, 
                         model_before = "par['C_1']=par['B_1'];
                         par['A_2']=par['A_1'];
                         par['C_2']=par['B_2'];
                         par['D1_2']=par['D1_1']", hessian=TRUE)
                         
# Without the N20 the computing is much faster
data_f_21_fast &lt;- subset(data_f_21, subset=(is.na(data_f_21$N20)))
par &lt;- c('D1_2' = 49.78891736351531, 
         'D2D1_2' = 1059.3635769732305, 
         'D3D2_2' = 12.434313273804602, 
         'A_2' = 5.2238379144659683, 
         'B_2' = 8.0050044071275543, 
         'C_2' = 8.4317863609499675, 
         'D1_1' = 701.80273287212935, 
         'D2D1_1' = 0.010951749100596819, 
         'D3D2_1' = 3773.6290607434876, 
         'A_1' = 205.42435592344776, 
         'B_1' = 9.9598342503239863, 
         'C_1' = 6.7234868237164722)
o &lt;- Tagloss_fit(data=data_f_21_fast, fitted.parameters=par, hessian = TRUE)
plot(o, model="1", col="red")
plot(o, model="2", col="blue", add=TRUE)
legend("topright", legend=c("2-&gt;1", "1-&gt;0"), lty=1, col=c("blue", "red"))

## End(Not run)
</code></pre>


</div>