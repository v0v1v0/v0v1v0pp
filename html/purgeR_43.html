<div class="container">

<table style="width: 100%;"><tr>
<td>ip_Fij</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>Partial inbreeding coefficient</h2>

<h3>Description</h3>

<p>Computes partial inbreeding coefficients, <em>Fi(j)</em>.
A coefficient <em>Fi(j)</em> can be read as the probability of individual <em>i</em> being
homozygous for alleles derived from ancestor <em>j</em>.
It is calculated following the tabular method described by Gulisija &amp; Crow (2007).
Optionally, it can be estimated via genedrop simulation.
</p>


<h3>Usage</h3>

<pre><code class="language-R">ip_Fij(
  ped,
  mode = "founders",
  ancestors = NULL,
  Fcol = NULL,
  genedrop = 0,
  seed = NULL,
  ncores = 1L
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>ped</code></td>
<td>
<p>A dataframe containing the pedigree. Individual (id), maternal (dam), and paternal (sire) identities are mandatory columns.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>mode</code></td>
<td>
<p>Defines the set of ancestors considered when computing partial inbreeding. It can be set as:
"founder" for inbreeding conditional to founders only (default),
"all" for all individuals in the pedigree (it may take long to compute in large pedigrees),
and "custom" for individuals identities given in a integer vector (see 'ancestors' argument).</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>ancestors</code></td>
<td>
<p>Under the "custom" run mode, it defines a vector of ancestors that will be considered
when computing partial inbreeding values.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>Fcol</code></td>
<td>
<p>Name of column with inbreeding coefficient values. If none is used, inbreeding will be computed.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>genedrop</code></td>
<td>
<p>Number of genedrop iterations to run. If set to zero (as default), exact coefficients are computed.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>seed</code></td>
<td>
<p>Sets a seed for the random number generator (only if genedrop is enabled).</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>ncores</code></td>
<td>
<p>Number of cores to use for parallel computing (default = 1)</p>
</td>
</tr>
</table>
<h3>Value</h3>

<p>A matrix of partial inbreeding coefficients. <em>Fi(j)</em> values can thus be read from row i and column j.
In the resultant matrix, there are as many rows as individuals in the pedigree, and as many columns as ancestors used.
Columns will be named and sorted by ancestor identity.
</p>


<h3>References</h3>


<ul><li>
<p>Gulisija D, Crow JF. 2007. Inferring purging from pedigree data. Evolution 61(5): 1043-1051.
</p>
</li></ul>
<h3>See Also</h3>

<p><code>ip_F</code>
</p>


<h3>Examples</h3>

<pre><code class="language-R"># Original pedigree file in Gulisija &amp; Crow (2007)
pedigree &lt;- tibble::tibble(
  id = c("M", "K", "J", "a", "c", "b", "e", "d", "I"),
  dam = c("0", "0", "0", "K", "M", "a", "c", "c", "e"),
  sire = c("0", "0", "0", "J", "a", "J", "b", "b", "d")
)
pedigree &lt;- purgeR::ped_rename(pedigree, keep_names = TRUE)

# Partial inbreeding relative to founder ancestors
m &lt;- ip_Fij(pedigree)
# Note that in the example above, the sum of the values in
# rows will equal the vector of inbreeding coefficients
# i.e. base::rowSums(m) equals purgeR::ip_F(pedigree)$Fi

# Compute partial inbreeding relative to an arbitrary ancestor
# with id = 3 (i.e. individual named "J")
anc &lt;- as.integer(c(3))
m &lt;- ip_Fij(pedigree, mode = "custom", ancestors = anc)
</code></pre>


</div>