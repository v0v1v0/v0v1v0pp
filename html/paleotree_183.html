<div class="container">

<table style="width: 100%;"><tr>
<td>twoWayEcologyCluster</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>R-Mode vs Q-Mode Two-Way Cluster Analyses and Abundance Plot for Community Ecology Data</h2>

<h3>Description</h3>

<p>This mode plots both R-mode (across sites) and Q-mode (across taxa) dendrograms
for a community ecology data set, with branches aligned with a grid of dots
representing the relative abundance of taxa at each site in the dataset.
</p>


<h3>Usage</h3>

<pre><code class="language-R">twoWayEcologyCluster(
  xDist,
  yDist,
  propAbund,
  clustMethod = "average",
  marginBetween = 0.1,
  extraMarginForLabels = 0,
  abundExpansion = 3,
  cex.axisLabels = 1,
  trimChar = 5,
  xAxisLabel = "Across Sites",
  yAxisLabel = "Across Taxa"
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>xDist</code></td>
<td>
<p>The pair-wise distance matrix for the cluster diagram drawn along the
horizontal axis of the graphic. Should be a distance matrix, or a matrix that can
be coerced to a distance matrix, for the same number of units as rows in <code>propAbund</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>yDist</code></td>
<td>
<p>The pair-wise distance matrix for the cluster diagram drawn along the
vertical axis of the graphic. Should be a distance matrix, or a matrix that can
be coerced to a distance matrix, for the same number of units as columns in <code>propAbund</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>propAbund</code></td>
<td>
<p>A matrix of abundance data, preferably relative
abundance scaled as proportions of the total number of individuals
at each site. This data determines the size scale of the taxon/site dots.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>clustMethod</code></td>
<td>
<p>The agglomerative clustering method used, as with
argument <code>method</code> with function <code>hclust</code>. 
<code>clustMethod</code> must be one of <code>"average"</code> 
(the default method for this function, 
also known as average-linkage or as UPGMA), 
<code>"ward.D"</code>, <code>"ward.D2"</code>, <code>"single"</code>, <code>"complete"</code>,
<code>"mcquitty"</code> (also known as WPGMA), <code>"median"</code>
(also known as WPGMC) or <code>"centroid"</code> (also known as UPGMC).</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>marginBetween</code></td>
<td>
<p>Argument controlling space placed between
the cluster diagrams and the abundance plot. Default is 0.1.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>extraMarginForLabels</code></td>
<td>
<p>Argument for extending the space for 
plotting taxon and site labels. This parameter is currently being
tested and may not behave well, especially for plots that
aren't being made with very large dimensions.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>abundExpansion</code></td>
<td>
<p>An argument that is a multiplier controlling the size
of dots plotted for reflecting relative abundance.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>cex.axisLabels</code></td>
<td>
<p>Character expansion parameter for controlling the plotting
of axis labels on the abundance dot-grid only.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>trimChar</code></td>
<td>
<p>How many characters should the axis labels be trimmed to?
Default is 5, which means only the first five letters of each taxon/site
label will be shown on the dot-abundance plot.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>xAxisLabel</code></td>
<td>
<p>The label placed on the horizontal axis of the plot.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>yAxisLabel</code></td>
<td>
<p>The label placed on the vertical axis of the plot.</p>
</td>
</tr>
</table>
<h3>Details</h3>

<p>You might be able to apply this to datasets that aren't community ecology datasets
of proportional abundance, but I can't guarantee or even predict what will happen.
</p>


<h3>Value</h3>

<p>This function creates a plot, and returns nothing, not even invisible output.
</p>


<h3>Author(s)</h3>

<p>David W. Bapst
</p>


<h3>References</h3>

<p>The function here was designed to emulate previous published 'two-way'
cluster diagrams, particularly the one in Miller, 1988:
</p>
<p>Miller, A. I. 1988. Spatial Resolution in Subfossil Molluscan
Remains: Implications for Paleobiological Analyses. <em>Paleobiology</em> 14(1):91-103.
</p>


<h3>See Also</h3>

<p>Several other functions for community ecology data in paleotree are described
at the <code>communityEcology</code> help file. 
Also see the example dataset, <code>kanto</code>.
</p>


<h3>Examples</h3>

<pre><code class="language-R">set.seed(1)

# generate random community ecology data
    # using a Poisson distribution
data&lt;-matrix(rpois(5*7,1),5,7)

# get relative abundance, distance matrices
propAbundMat&lt;-t(apply(data,1,function(x) x/sum(x)))
rownames(propAbundMat)&lt;-paste0("site ", 1:nrow(propAbundMat))
colnames(propAbundMat)&lt;-paste0("taxon ", 1:ncol(propAbundMat))

# for simplicity, let's calculate
    # the pairwise square chord distance
    # between sites and taxa

squareChordDist&lt;-function(mat){
    res&lt;-apply(mat,1,function(x)
        apply(mat,1,function(y)
            sum((sqrt(x)-sqrt(y))^2)
            )
        )
    #
    res&lt;-as.dist(res)
    return(res)
    }

# its not a very popular distance metric
    # but it will do
    # quite popular in palynology

siteDist&lt;-squareChordDist(propAbundMat)
taxaDist&lt;-squareChordDist(t(propAbundMat))

dev.new(width=10)    

twoWayEcologyCluster(
    xDist = siteDist, 
    yDist = taxaDist,
    propAbund = propAbundMat
    )

## Not run: 

# now let's try an example with the example kanto dataset
# and use bray-curtis distance from vegan

library(vegan)

data(kanto)

# get distance matrices for sites and taxa
    # based on bray-curtis dist
    # standardized to total abundance

# standardize site matrix to relative abundance
siteStandKanto &lt;- decostand(kanto, method = "total")

# calculate site distance matrix (Bray-Curtis)
siteDistKanto &lt;- vegdist(siteStandKanto, "bray")

# calculate taxa distance matrix (Bray-Curtis)
    # from transposed standardized site matrix 
taxaDistKanto &lt;- vegdist(t(siteStandKanto), "bray")

dev.new(width=10)    

twoWayEcologyCluster(
    xDist = siteDistKanto,
    yDist = taxaDistKanto,
    propAbund = siteStandKanto,
    cex.axisLabels = 0.8
    )


## End(Not run)
</code></pre>


</div>