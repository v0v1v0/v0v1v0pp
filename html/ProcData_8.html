<div class="container">

<table style="width: 100%;"><tr>
<td>chooseK_seq2seq</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>Choose the number of autoencoder features</h2>

<h3>Description</h3>

<p><code>chooseK_seq2seq</code> chooses the number of features to be extracted
by cross-validation.
</p>


<h3>Usage</h3>

<pre><code class="language-R">chooseK_seq2seq(seqs, ae_type, K_cand, rnn_type = "lstm", n_epoch = 50,
  method = "last", step_size = 1e-04, optimizer_name = "adam",
  n_fold = 5, cumulative = FALSE, log = TRUE, weights = c(1, 0.5),
  valid_prop = 0.1, verbose = TRUE)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>seqs</code></td>
<td>
<p>an object of class <code>"proc"</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>ae_type</code></td>
<td>
<p>a string specifies the type of autoencoder. The autoencoder can be an
action sequence autoencoder ("action"), a time sequence autoencoder ("time"), or an 
action-time sequence autoencoder ("both").</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>K_cand</code></td>
<td>
<p>the candidates of the number of features.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>rnn_type</code></td>
<td>
<p>the type of recurrent unit to be used for modeling
response processes. <code>"lstm"</code> for the long-short term memory unit. 
<code>"gru"</code> for the gated recurrent unit.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>n_epoch</code></td>
<td>
<p>the number of training epochs for the autoencoder.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>method</code></td>
<td>
<p>the method for computing features from the output of an
recurrent neural network in the encoder. Available options are 
<code>"last"</code> and <code>"avg"</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>step_size</code></td>
<td>
<p>the learning rate of optimizer.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>optimizer_name</code></td>
<td>
<p>a character string specifying the optimizer to be used
for training. Availabel options are <code>"sgd"</code>, <code>"rmsprop"</code>, 
<code>"adadelta"</code>, and <code>"adam"</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>n_fold</code></td>
<td>
<p>the number of folds for cross-validation.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>cumulative</code></td>
<td>
<p>logical. If TRUE, the sequence of cumulative time up to each event is
used as input to the neural network. If FALSE, the sequence of inter-arrival time (gap 
time between an event and the previous event) will be used as input to the neural network.
Default is FALSE.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>log</code></td>
<td>
<p>logical. If TRUE, for the timestamp sequences, input of the neural net is
the base-10 log of the original sequence of times plus 1 (i.e., log10(t+1)). If FALSE,
the original sequence of times is used.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>weights</code></td>
<td>
<p>a vector of 2 elements for the weight of the loss of action sequences
(categorical_crossentropy) and time sequences (mean squared error), respectively. 
The total loss is calculated as the weighted sum of the two losses.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>valid_prop</code></td>
<td>
<p>the proportion of validation samples in each fold.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>verbose</code></td>
<td>
<p>logical. If TRUE, training progress is printed.</p>
</td>
</tr>
</table>
<h3>Value</h3>

<p><code>chooseK_seq2seq</code> returns a list containing
</p>
<table>
<tr style="vertical-align: top;">
<td><code>K</code></td>
<td>
<p>the candidate in <code>K_cand</code> producing the smallest cross-validation loss.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>K_cand</code></td>
<td>
<p>the candidates of number of features.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>cv_loss</code></td>
<td>
<p>the cross-validation loss for each candidate in <code>K_cand</code>.</p>
</td>
</tr>
</table>
<h3>See Also</h3>

<p><code>seq2feature_seq2seq</code> for feature extraction given the number of features.
</p>


</div>