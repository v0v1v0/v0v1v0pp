<div class="container">

<table style="width: 100%;"><tr>
<td>set_options</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>set and get phenofit option</h2>

<h3>Description</h3>

<p>set and get phenofit option
</p>


<h3>Usage</h3>

<pre><code class="language-R">set_options(..., options = NULL)

get_options(names = NULL)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>...</code></td>
<td>
<p>list of phenofit options FUN_season: character, <code>season_mov</code> or
<code>season</code> rFUN: character, rough fitting function. <code>smooth_wWHIT</code>,
<code>smooth_wSG</code> or <code>smooth_wHANTs</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>options</code></td>
<td>
<p>If not NULL, <code>options</code> will overwrite the default parameters
(<code>get_options()</code>).
</p>

<ul>
<li> <p><code>qcFUN</code>      : function to process qc flag, see <code>qcFUN()</code> for details.
</p>
</li>
<li> <p><code>nptperyear</code> : Integer, number of images per year.
</p>
</li>
<li> <p><code>wFUN</code>       : character (default <code>wTSM</code>), the name of weights updating
functions, can be one of c("wTSM", "wChen", "wBisquare", "wSELF"). See
<code>wTSM()</code>, <code>wChen()</code>, <code>wBisquare()</code> and <code>wSELF()</code> for details.
</p>

<ul><li>
<p> If <code>options$season$wFUN</code> or <code>options$season$wFUN</code> is <code>NULL</code>, the
<code>options$wFUN</code> will overwrite it.
</p>
</li></ul>
</li>
<li> <p><code>wmin</code>       : double, the minimum weigth of bads points (i.e. snow, ice
and cloud).
</p>

<ul><li>
<p> If <code>options$season$wmin</code> or <code>options$season$wmin</code> is <code>NULL</code>, the
<code>options$wmin</code> will overwrite it.
</p>
</li></ul>
</li>
<li> <p><code>season</code>     : See the following part: options for season for details.
</p>
</li>
<li> <p><code>fitting</code>    : See the following part: options for fitting for details.
</p>
</li>
</ul>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>names</code></td>
<td>
<p>vector of character, names of options</p>
</td>
</tr>
</table>
<h3>options for season</h3>



<h4>(a) Parameters for rough fitting</h4>


<ul>
<li> <p><code>rFUN</code>              : character (default <code>smooth_wWHIT</code>), the name of rough
curve fitting function, can be one of <code>c("smooth_wSG", "smooth_wWHIT", "smooth_wHANTS")</code>, which are corresponding to <code>smooth_wSG()</code>,
<code>smooth_wWHIT()</code> and <code>smooth_wHANTS()</code>.
</p>
</li>
<li> <p><code>wFUN</code>              : character (default <code>wTSM</code>), the name of weights
updating functions, can be one of c("wTSM", "wChen", "wBisquare",
"wSELF"). See <code>wTSM()</code>, <code>wChen()</code>, <code>wBisquare()</code> and <code>wSELF()</code> for
details.
</p>
</li>
<li> <p><code>iters</code>             : integer (default 2), the number of rough fitting
iterations.
</p>
</li>
<li> <p><code>wmin</code>              : double, the minimum weight of bad points (i.e. snow,
ice and cloud).
</p>
</li>
<li> <p><code>verbose</code>           : logical (default <code>FALSE</code>). If <code>TRUE</code>,
<code>options$season</code> will be printed on the console.
</p>
</li>
<li> <p><code>lambda</code>            : double (default NULL), the smoothing parameter of
<code>smooth_wWHIT()</code>.
</p>

<ul><li>
<p> If <code>lambda = NULL</code>, V-curve theory will be employed to find the
optimal <code>lambda</code>. See <code>lambda_vcurve()</code> for details.
</p>
</li></ul>
</li>
<li> <p><code>frame</code>             : integer (default NULL), the parameter of
<code>smooth_wSG()</code>, moving window size.
</p>

<ul><li>
<p> If <code>frame = NULL</code>, <code>frame</code> will be reset as <code>floor(nptperyear/5)*2 +    1</code> (refered by TIMESAT).
</p>
</li></ul>
</li>
<li> <p><code>nf</code>                : integer (default 4), the number of frequencies in
<code>smooth_wHANTS()</code>.
</p>
</li>
<li> <p><code>maxExtendMonth</code>: integer (default 12), previous and subsequent
<code>maxExtendMonth</code> (in month) data were added to the current year for rough
fitting.
</p>
</li>
<li> <p><code>nextend</code>           : integer (default NULL), same as <code>maxExtendMonth</code>, but
in points.
</p>

<ul>
<li>
<p> If <code>nextend</code> provided, <code>maxExtendMonth</code> will be ignored.
</p>
</li>
<li>
<p> If <code>nextend = NULL</code>, <code>nextend</code> will be reset as
<code>ceiling(maxExtendMonth/12*nptperyear)</code>
</p>
</li>
</ul>
</li>
</ul>
<h4>(b) Parameters for growing season division</h4>


<ul>
<li> <p><code>minpeakdistance</code>   : double (default NULL), the minimum distance of two
peaks (in points). If the distance of two maximum extreme value less than
<code>minpeakdistance</code>, only the maximum one will be kept.
</p>

<ul><li>
<p> If <code>minpeakdistance = NULL</code>, it will be reset as <code>nptperyear/6</code>.
</p>
</li></ul>
</li>
<li> <p><code>r_max</code>             : double (default 0.2; in (0, 1)). <code>r_max</code> and <code>r_min</code>
are used to eliminate fake peaks and troughs.
</p>

<ul>
<li>
<p> The real peaks should satisfy:
</p>

<ol>
<li> <p><code class="reqn">max(h_{peak, L}, h_{peak, R}) &gt; r_{max} A</code>
</p>
</li>
<li> <p><code class="reqn">min(h_{peak, L}, h_{peak, R}) &gt; r_{min} A,</code> where <code class="reqn">h_{peak,
     L}, h_{peak, R}</code> are height difference from the peak to the left- and
right-hand troughs.
</p>
</li>
</ol>
</li>
<li>
<p> The troughs should satisfy:
</p>

<ol><li> <p><code class="reqn">max(h_{trough, L}, h_{trough, R}) &gt; r_{max} A,</code> where
<code class="reqn">h_{trough, L}, h_{trough, R}</code> are height difference from the trough
to the left- and right-hand peaks.
</p>
</li></ol>
</li>
</ul>
</li>
<li> <p><code>r_min</code>             : double (default 0.05; in (0, 1)), see above <code>r_max</code>
for details. <code>r_min</code> &lt; <code>r_max</code>.
</p>
</li>
<li> <p><code>rtrough_max</code>       : double (default 0.6, in (0, 1)), <code class="reqn">y_{peak} &lt;=
  rtrough_max * A + ylu[1]</code>.
</p>
</li>
<li> <p><code>ypeak_min</code>         : double 0.1 (in VI unit), <code class="reqn">y_{peak} &gt;= ypeak_min</code>.
</p>
</li>
<li> <p><code>.check_season</code>     : logical (default <code>TRUE</code>). check the growing season
length according to <code>len_min</code> and <code>len_max</code>. If <code>FALSE</code>, <code>len_min</code> and
<code>len_max</code> will lose their effect.
</p>
</li>
<li> <p><code>len_min</code>           : integer (default 45), the minimum length (in days) of
growing season
</p>
</li>
<li> <p><code>len_max</code>           : integer (default 650), the minimum length (in days)
of growing season
</p>
</li>
<li> <p><code>adj.param</code>         : logical. If <code>TRUE</code> (default), if there are too many
or too less peaks and troughs, <code>phenofit</code> will automatically adjust rough
curve fitting function parameters. See <code>MaxPeaksPerYear</code> and
<code>MaxTroughsPerYear</code> for details.
</p>
</li>
<li> <p><code>MaxPeaksPerYear</code> (optional)   : integer (default 2), the max number of
peaks per year. If <code>PeaksPerYear</code> &gt; <code>MaxPeaksPerYear</code>, then <code>lambda = lambda*2</code>.
</p>
</li>
<li> <p><code>MaxTroughsPerYear</code> (optional) : integer (default 3), the max number of
troughs per year. If <code>TroughsPerYear</code> &gt; <code>MaxTroughsPerYear</code>, then <code>lambda = lambda*2</code>.
</p>
</li>
<li> <p><code>calendarYear</code>      : logical (default <code>FALSE</code>). If <code>TRUE</code>, the start and
end of a calendar year will be regarded as growing season division (North
Hemisphere is from 01 Jan to 31 Dec; South Hemisphere is from 01 Jul to 30
Jun).
</p>
</li>
<li> <p><code>rm.closed</code>         : logical (default <code>TRUE</code>). If <code>TRUE</code>, closed peaks (or troughs)
will be further tidied. Only the maximum
</p>
</li>
<li> <p><code>is.continuous</code> (not used): logical (default <code>TRUE</code>). This parameter is for
<code>fluxnet2015</code> fluxsite data, where the input might be not continuous.
</p>
</li>
</ul>
<h3>options for fitting</h3>


<ul>
<li> <p><code>methods</code> (default <code style="white-space: pre;">⁠c('AG', 'Beck', 'Elmore', 'Zhang')``): Fine curve fitting methods, can be one or more of ⁠</code>c('AG', 'Beck', 'Elmore', 'Zhang',
'Gu', 'Klos')‘. Note that ’Gu' and 'Klos' are very slow.
</p>
</li>
<li> <p><code>iters</code> (default 2): max iterations of fine fitting.
</p>
</li>
<li> <p><code>wFUN</code> (default <code>wTSM</code>): Character or function, weights updating function
of fine fitting function.
</p>
</li>
<li> <p><code>wmin</code> (default 0.1): min weights in the weights updating procedure.
</p>
</li>
<li> <p><code>use.rough</code> (default FALSE): Whether to use rough fitting smoothed
time-series as input? If <code>false</code>, smoothed VI by rough fitting will be used
for Phenological metrics extraction; If <code>true</code>, original input <code>y</code> will be
used (rough fitting is used to divide growing seasons and update weights.
</p>
</li>
<li> <p><code>use.y0</code> (default TRUE): boolean. whether to use original <code>y0</code> as the input
of <code>plot_input</code>, note that not for curve fitting. <code>y0</code> is the original
value before the process of <code>check_input</code>.
</p>
</li>
<li> <p><code>nextend</code> (default 2): Extend curve fitting window, until <code>nextend</code> good or
marginal points are found in the previous and subsequent growing season.
</p>
</li>
<li> <p><code>maxExtendMonth</code> (default 1): Search good or marginal good values in
previous and subsequent <code>maxExtendMonth</code> period.
</p>
</li>
<li> <p><code>minExtendMonth</code> (default 0.5): Extend period defined by <code>nextend</code> and
<code>maxExtendMonth</code>, should be no shorter than <code>minExtendMonth</code>. When all
points of the input time-series are good value, then the extending period
will be too short. In that situation, we can't make sure the connection
between different growing seasons is smoothing.
</p>
</li>
<li> <p><code>minPercValid</code>: (default 0, not use). If the percentage of good- and
marginal- quality points is less than <code>minPercValid</code>, curve fiting result is
set to <code>NA</code>.
</p>
</li>
<li> <p><code>minT</code>: (not use). If <code>Tn</code> not provided in <code>INPUT</code>, <code>minT</code> will
not be used. <code>minT</code> use night temperature Tn to define backgroud value
(days with <code>Tn &lt; minT</code> treated as ungrowing season).
</p>
</li>
</ul>
<h3>Examples</h3>

<pre><code class="language-R">set_options(verbose = FALSE) 
get_options("season") %&gt;% str()
</code></pre>


</div>