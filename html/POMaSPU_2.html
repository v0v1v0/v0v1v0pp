<div class="container">

<table style="width: 100%;"><tr>
<td>POMaSPU</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>
An adaptive sum of powered score (SPU) test for single SNP and mutiple phenotypes
</h2>

<h3>Description</h3>

<p>POM-aSPU test evaluates an associations between an ordinal response (e.g. SNP) 
and multiple phenotypes;
provides a series of p-values of POM-SPU(pow) and POM-aSPU tests.
</p>


<h3>Usage</h3>

<pre><code class="language-R">POMaSPU(Y, Y.level, pheno, Z = NULL, pow = c(1:8, Inf), n.perm)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>Y</code></td>
<td>
<p>a vector of categorical indicators</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>Y.level</code></td>
<td>
<p>a vector indicating an order of categories either numeric or character e.g. Y.level = c(0, 1, 2) or 
Y.level = c("Well", "Mild", "Impaired").</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>pheno</code></td>
<td>
<p>a numeric phenotype matrix with each row as a different individual and each column as a separate phenotype.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>Z</code></td>
<td>
<p>a numeric covariate matrix with each row as a different individual and each column as a covariate to be adjusted.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>pow</code></td>
<td>
<p>a vector of the power weight to be used at a trait level (default = c(1:8, Inf)).</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>n.perm</code></td>
<td>
<p>a numeric value of number of null statistics (default = 1000).</p>
</td>
</tr>
</table>
<h3>Details</h3>

<p>Adaptive association tests for an ordinal variable (e.g. SNP) and multiple phenotypes using POM.
</p>


<h3>Value</h3>

<p>a vector of p-values from POM-SPU(pow) tests and POM-aSPU test.
</p>


<h3>Note</h3>

<p>We provide a permutation based POM-aSPU test where null statistics are generated from permutations.
</p>


<h3>Author(s)</h3>

<p>Junghi Kim and Wei Pan
</p>


<h3>References</h3>

<p>Kim J, and Pan W (2017). "Adaptive testing for multiple traits in a proportional odds model with applications to detect SNP-brain network associations." <em>Genetic Epidemiology</em>, 41(3), 259â€“277.
</p>


<h3>Examples</h3>

<pre><code class="language-R"># Example 1) 
# -- simulating phenotypes
# -- n.subjects: number of subjects
# -- n.traits: number of phenotypes

set.seed(136)
n.subjects &lt;- 100
n.traits &lt;- 10
pheno &lt;- matrix(rnorm(n.subjects*n.traits), n.subjects, n.traits)


# -- simulating genotype (Y) and covariates (Z)
Y &lt;- sample(c(0,1,2), n.subjects, replace = TRUE)
Z &lt;- matrix(rnorm(n.subjects*2, 2, 1), n.subjects, 2)

# -- Computing the p-value of POMaSPU test with the permutation based method
Pvl &lt;- POMaSPU(Y = Y, Y.level = c(0,1,2), pheno = pheno, Z = Z,  pow = c(1,2,4,Inf), n.perm = 1000)


# -- Each element of Pvl is a p value of POM-SPU(pow) in order
# -- The last element of Pvl is a p value of POM-aSPU test
Pvl
Pvl[length(Pvl)]


# &gt; Pvl
#     SPU.1     SPU.2     SPU.4   SPU.Inf      aSPU 
# 0.1800000 0.5010000 0.3220000 0.1720000 0.3506494 


# &gt; Pvl[length(Pvl)]
#      aSPU
# 0.3506494



# Example 2) 
# n.subjects &lt;- 100
# n.traits &lt;- 10
# Y &lt;- sample(c("Well", "Mild", "Sick"), n.subjects, replace = TRUE)
# pheno &lt;- matrix(rnorm(n.subjects*n.traits), n.subjects, n.traits)
# Z &lt;- matrix(rnorm(n.subjects*2, 2, 1), n.subjects, 2)
# Pvl &lt;- POMaSPU(Y = Y, Y.level = c("Sick", "Mild",  "Well"), pheno = pheno, Z = Z,  
# 		 pow = c(1,2,4,Inf), n.perm = 1000)
</code></pre>


</div>