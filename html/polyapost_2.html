<div class="container">

<table style="width: 100%;"><tr>
<td>constrppprob</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>Dependent Sampling from the Uniform Distribution on a Polytope.</h2>

<h3>Description</h3>

<p>Let <code class="reqn">p=(p_1,\ldots,p_n)</code>
be a probability distribution
which belongs to a lower dimensional polytope of the <code class="reqn">n</code>-dimensional
simplex.  The polytope is defined by a collection of linear
equality and inequality constraints.  A dependent sequence of the 
<code class="reqn">p</code>'s are generated by a Markov chain using the Metropolis-Hastings
algorithm whose stationary distribution is the uniform distribution
over the polytope.  This is done by generating <code class="reqn">k</code> blocks
of size <code>step</code>
where the last member of each is returned.</p>


<h3>Usage</h3>

<pre><code class="language-R">constrppprob(A1,A2,A3,b1,b2,b3,initsol,step,k)</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>A1</code></td>
<td>
<p>The matrix for the equality constraints.This must always
contain the constraint <code>sum(p) == 1</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>A2</code></td>
<td>
<p>The matrix for the <code>&lt;=</code> inequality constraints.  This must always
contain the constraints <code>-p &lt;= 0</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>A3</code></td>
<td>
<p>The matrix for the <code>&gt;=</code> inequality constraints.  If there are no
such constraints <code>A3</code> must be set equal to <code>NULL</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>b1</code></td>
<td>
<p>The rhs vector for <code>A1</code>, each component must be nonnegative.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>b2</code></td>
<td>
<p>The rhs vector for <code>A2</code>, each component must be nonnegative.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>b3</code></td>
<td>
<p>The rhs vector for <code>A3</code>, each component must be nonnegative.
If <code>A3</code> is <code>NULL</code> then <code>b3</code> must be NULL.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>initsol</code></td>
<td>
<p>A vector which lies in the interior of the polytope.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>step</code></td>
<td>
<p>The number of <code>p</code>'s generated in a block before the
last member of a block is returned.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>k</code></td>
<td>
<p>The total number of blocks generated and hence the number
of <code>p</code>'s returned.</p>
</td>
</tr>
</table>
<h3>Value</h3>

<p>The returned value is a <code class="reqn">k</code> by <code class="reqn">n</code> matrix of probability vectors.
</p>


<h3>Examples</h3>

<pre><code class="language-R">A1&lt;-rbind(rep(1,6),1:6)
A2&lt;-rbind(c(2,5,7,1,10,8),diag(-1,6))
A3&lt;-matrix(c(1,1,1,0,0,0),1,6)
b1&lt;-c(1,3.5)
b2&lt;-c(6,rep(0,6))
b3&lt;-0.45
initsol&lt;-rep(1/6,6)
constrppprob(A1,A2,A3,b1,b2,b3,initsol,2000,5)
</code></pre>


</div>