<div class="container">

<table style="width: 100%;"><tr>
<td>pwefvplus</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>A utility functon</h2>

<h3>Description</h3>

<p>This will calculate the more complex integration accounting for crossover</p>


<h3>Usage</h3>

<pre><code class="language-R">pwefvplus(t=seq(0,5,by=0.5),rate1=c(0,5,0.8),rate2=rate1,
                   rate3=c(0.1,0.2),rate4=rate2,rate5=rate2,
                   rate6=c(0.5,0.3),tchange=c(0,3),type=1,
                   rp2=0.5,eps=1.0e-2)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>t</code></td>
<td>
<p>A vector of time points</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>rate1</code></td>
<td>
<p>piecewise constant event rate</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>rate2</code></td>
<td>
<p>piecewise constant event rate</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>rate3</code></td>
<td>
<p>piecewise constant event rate</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>rate4</code></td>
<td>
<p>additional piecewise constant</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>rate5</code></td>
<td>
<p>additional piecewise constant</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>rate6</code></td>
<td>
<p>piecewise constant event rate for censoring</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>tchange</code></td>
<td>
<p>a strictly increasing sequence of time points starting from zero at which event rate changes. The first element of tchange must be zero. The above rates and tchange must have the same length.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>type</code></td>
<td>
<p>type of the crossover, markov, semi-markov and hybrid</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>rp2</code></td>
<td>
<p>re-randomization prob</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>eps</code></td>
<td>
<p>tolerance</p>
</td>
</tr>
</table>
<h3>Details</h3>

<p>Let <code class="reqn">h_1,\ldots,h_6</code> correspond to <code>rate1</code>,...,<code>rate6</code>, and <code class="reqn">H_1,\ldots,H_6</code> be the corresponding survival functions. Also let <code class="reqn">\pi_2=\code{rp2}</code>.
when <code>type</code>=1, we calculate
</p>
<p style="text-align: center;"><code class="reqn">\int_0^t s^k h_2(s)H_2(s)H_6(s)\int_0^s h_3(u)H_1(u)H_3(u)/H_2(u)duds;</code>
</p>

<p>when <code>type</code>=2, we calculate
</p>
<p style="text-align: center;"><code class="reqn">\int_0^t s^kH_6(s)\int_0^s h_3(u)H_1(u)H_3(u)h_2(s-u)H_2(s-u)duds;</code>
</p>

<p>when <code>type</code>=3, we calculate the sum of 
</p>
<p style="text-align: center;"><code class="reqn">\pi_2\int_0^t s^kH_4^{1-\pi_2}(s)H_6(s)\int_0^s h_3(u)H_1(u)H_3(u)h_2(s-u)H_2^{\pi_2}(s-u)/H_4^{1-\pi_2}(u)duds</code>
</p>

<p>and 
</p>
<p style="text-align: center;"><code class="reqn">(1-\pi_2)\int_0^t s^kh_4(s)H_4^{1-\pi_2}(s)H_6(s)\int_0^s h_3(u)H_1(u)H_3(u)H_2^{\pi_2}(s-u)/H_4^{1-\pi_2}(u)duds;</code>
</p>

<p>when <code>type</code>=4, we calculate the sum of 
</p>
<p style="text-align: center;"><code class="reqn">\pi_2\int_0^t s^kH_6(s)\int_0^s h_3(u)H_1(u)H_3(u)h_2(s-u)H_2(s-u)duds</code>
</p>

<p>and
</p>
<p style="text-align: center;"><code class="reqn">(1-\pi_2)\int_0^t s^kh_4(s)H_4(s)H_6(s)\int_0^s h_3(u)H_1(u)H_3(u)/H_4(u)duds;</code>
</p>

<p>when <code>type</code>=5, we calculate the sum of
</p>
<p style="text-align: center;"><code class="reqn">\pi_2\int_0^t s^kH_6(s)\int_0^s h_3(u)H_1(u)H_3(u)h_2(s-u)H_2(s-u)duds</code>
</p>

<p>and
</p>
<p style="text-align: center;"><code class="reqn">(1-\pi_2)\int_0^t s^kH_6(s)\int_0^s h_3(u)H_1(u)H_3(u)h_4(s-u)H_4(s-u)duds.</code>
</p>



<h3>Value</h3>

<table>
<tr style="vertical-align: top;">
<td><code>f0</code></td>
<td>
<p>values when <code class="reqn">k=0</code></p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>f1</code></td>
<td>
<p>values when <code class="reqn">k=1</code></p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>f2</code></td>
<td>
<p>values when <code class="reqn">k=2</code></p>
</td>
</tr>
</table>
<h3>Note</h3>

<p>This provides the result of the complex integration</p>


<h3>Author(s)</h3>

<p>Xiaodong Luo</p>


<h3>References</h3>

<p>Luo et al. (2018) Design and monitoring of survival trials in complex scenarios, Statistics in Medicine &lt;doi: https://doi.org/10.1002/sim.7975&gt;.
</p>


<h3>See Also</h3>

<p><code>rpwe</code></p>


<h3>Examples</h3>

<pre><code class="language-R">r1&lt;-c(0.6,0.3)
r2&lt;-c(0.6,0.6)
r3&lt;-c(0.1,0.2)
r4&lt;-c(0.5,0.4)
r5&lt;-c(0.4,0.5)
r6&lt;-c(0.4,0.5)
tchange&lt;-c(0,1.75)
pwefun&lt;-pwefvplus(t=seq(0,5,by=0.5),rate1=r1,rate2=r2,rate3=r3,
                 rate4=r4,rate5=r5,rate6=r6,
                 tchange=c(0,3),type=1,eps=1.0e-2)
pwefun
</code></pre>


</div>