<div class="container">

<table style="width: 100%;"><tr>
<td>pRF</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>
pRF 
</h2>

<h3>Description</h3>

<p>The workhorse function - estimates statistical significance of feature importance by
permuting the response variable
</p>


<h3>Usage</h3>

<pre><code class="language-R">pRF(response, predictors, n.perms, alpha = 0.05, 
mtry = NULL, type = c("classification", "regression"),
ntree = 500,seed=12345, ...)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>response</code></td>
<td>
<p>a character vector or a factor for classification containing the group memberships for classification, a numeric vector for regression
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>predictors</code></td>
<td>

<p>A matrix consisting of features (measurements) corresponding to samples. The orientation per se does not matter - the function orients them correctly for 
Random Forest learning. 
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>n.perms</code></td>
<td>

<p>Number of permutations to estimate significance. If the number of all possible
permutations is less than this the latter will be used for estimation. 
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>alpha</code></td>
<td>

<p>The significance level threshold of p.values for estimating false discovery rate
using the two-step BH method for correlated test statistics, as implemented in the
multtest package's mt.rawp2adjp function.
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>mtry</code></td>
<td>

<p>see ?randomForest for details - defines how many features are randomly sampled for building trees
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>type</code></td>
<td>

<p>string, set to "classification" or "regression"
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>ntree</code></td>
<td>

<p>number of trees in the random forest, see documentation from the randomForest package for details. 
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>seed</code></td>
<td>

<p>set seed to ensure reproducibility from run to run and to standardise runs on actual and permuted data
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>...</code></td>
<td>

<p>Arguments to pass on to the randomForest function
</p>
</td>
</tr>
</table>
<h3>Value</h3>

<p>A standardised list containing
</p>
<table>
<tr style="vertical-align: top;">
<td><code>Res.table</code></td>
<td>
<p>A data.frame containing significance, FDR, and the feature name. b= number of permutations yielding a higher importance than observed + 1, m= number of permutations + 1</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>obs</code></td>
<td>
<p>named numeric vector, contains observed importances</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>perms</code></td>
<td>
<p>data.frame, contains importance values from permutations</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>Model</code></td>
<td>
<p>the randomForest model that was fit to the original data</p>
</td>
</tr>
</table>
<h3>Author(s)</h3>

<p>Ankur Chakravarthy
</p>


<h3>References</h3>

<p>The main function is based on the idea presented in
</p>
<p>Altmann A, Tolosi L, Sander O, Lengauer T. Permutation importance: a corrected
feature importance measure. Bioinformatics. 2010 May 15;26(10):1340-7. doi:
10.1093/bioinformatics/btq134. Epub 2010 Apr 12. PubMed PMID: 20385727.
</p>
<p>The permutation p.values in the package are exact, calculated according to
</p>
<p>Phipson B, Smyth GK. Permutation P-values should never be zero: calculating
exact P-values when permutations are randomly drawn. Stat Appl Genet Mol Biol.
2010;9:Article39. doi: 10.2202/1544-6115.1585. Epub 2010 Oct 31. PubMed PMID:
21044043.
</p>
<p>False discovery rates account for correlations using the Two-Step BH procedure,
initially reported in 
</p>
<p>Yoav Benjamini, Abba M. Krieger, and Daniel Yekutieli, 'Adaptive Linear Step-up Procedures That Control the False Discovery Rate', Biometrika, 93 (2006), 491-507.
</p>


<h3>Examples</h3>

<pre><code class="language-R">
#Load the iris dataset
data(iris)

#Set up the predictors object

predictors=iris[,c(1:4)]
colnames(predictors)&lt;-colnames(iris[1:4])

#Execute the main pRF function
p.test&lt;-pRF(response=factor(iris$Species),
predictors=iris[,c(1:4)],n.perms=20,mtry=3,
type="classification",alpha=0.05)

#Put together a dataframe that consists of the 
#significance stats and observed importance metrics

df&lt;-cbind(p.test$Res.table,p.test$obs)

</code></pre>


</div>