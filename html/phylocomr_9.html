<div class="container">

<table style="width: 100%;"><tr>
<td>ph_bladj</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>bladj</h2>

<h3>Description</h3>

<p>Bladj take a phylogeny and fixes the root node at a specified age,
and fixes other nodes you might have age estimates for. It then sets all
other branch lengths by placing the nodes evenly between dated nodes,
and between dated nodes and terminals (beginning with the longest
'chains').
</p>


<h3>Usage</h3>

<pre><code class="language-R">ph_bladj(ages, phylo)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>ages</code></td>
<td>
<p>(data.frame/character) ages data.frame, or path to an ages
file. required. column names do not matter, and are discarded anyway.
the first column must be the node names, and the second column the node
ages. See Details.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>phylo</code></td>
<td>
<p>(character/phylo) One of: phylogeny as a newick string (will be
written to a temp file) - OR path to file with a newick
string - OR a an <span class="pkg">ape</span> <code>phylo</code> object. required.</p>
</td>
</tr>
</table>
<h3>Details</h3>

<p>See phylocomr-inputs for expected input formats
</p>


<h3>Value</h3>

<p>newick string with attributes for where ages and phylo files
used are stored
</p>


<h3>Common Errors</h3>

<p>A few issues to be aware of:
</p>

<ul>
<li>
<p> the ages table must have a row for the root node with an age estimate.
bladj will not work without that. We attempt to check this but can only
check it if you pass in a phylo object; there's no easy way to parse a
newick string without requiring ape
</p>
</li>
<li>
<p> bladj is case sensitive. internally we lowercase all tip and node labels
and taxon names in your ages file to avoid any case sensitivity problems
</p>
</li>
</ul>
<h3>Examples</h3>

<pre><code class="language-R">## Not run: 
ages_file &lt;- system.file("examples/ages", package = "phylocomr")
phylo_file &lt;- system.file("examples/phylo_bladj", package = "phylocomr")

# from data.frame
ages_df &lt;- data.frame(
  a = c('malpighiales','eudicots','ericales_to_asterales','plantaginaceae',
        'malvids', 'poales'),
  b = c(81, 20, 56, 76, 47, 71)
)
phylo_str &lt;- readLines(phylo_file)
(res &lt;- ph_bladj(ages = ages_df, phylo = phylo_str))
if (requireNamespace("ape")) {
  library(ape)
  plot(read.tree(text = res))
}

# from files
ages_file2 &lt;- file.path(tempdir(), "ages")
write.table(ages_df, file = ages_file2, row.names = FALSE,
  col.names = FALSE, quote = FALSE)
phylo_file2 &lt;- tempfile()
cat(phylo_str, file = phylo_file2, sep = '\n')
(res &lt;- ph_bladj(ages_file2, phylo_file2))
if (requireNamespace("ape")) {
  library(ape)
  plot(read.tree(text = res))
}

# using a ape phylo phylogeny object
x &lt;- read.tree(text = phylo_str)
if (requireNamespace("ape")) {
  library(ape)
  plot(x)
}

(res &lt;- ph_bladj(ages_file2, x))
if (requireNamespace("ape")) {
  library(ape)
  tree &lt;- read.tree(text = res)
  plot(tree)
}

## End(Not run)
</code></pre>


</div>