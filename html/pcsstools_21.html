<div class="container">

<table style="width: 100%;"><tr>
<td>model_product</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>Approximate a linear model for a product using PCSS</h2>

<h3>Description</h3>

<p><code>model_product</code> approximates the linear model for the product
of m phenotypes as a function of a set of predictors.
</p>


<h3>Usage</h3>

<pre><code class="language-R">model_product(
  formula,
  n,
  means,
  covs,
  predictors,
  responses = NULL,
  response = "continuous",
  ...
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>formula</code></td>
<td>
<p>an object of class <code>formula</code> whose dependent variable is
a combination of variables and  <code>*</code> operators. All model terms
must be accounted for in <code>means</code> and <code>covs</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>n</code></td>
<td>
<p>sample size.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>means</code></td>
<td>
<p>named vector of predictor and response means.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>covs</code></td>
<td>
<p>named matrix of the covariance of all model predictors and the
responses.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>predictors</code></td>
<td>
<p>named list of objects of class <code>predictor</code></p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>responses</code></td>
<td>
<p>named list of objects of class <code>predictor</code>
corresponding to all terms being multiplied in the response. Can be
left <code>NULL</code> if only multiplying two terms</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>response</code></td>
<td>
<p>character. Describe distribution of all product terms.
Either <code>"continuous"</code> or <code>"binary"</code>. If <code>"binary"</code>
different approximations of product means and variances are used.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>...</code></td>
<td>
<p>additional arguments</p>
</td>
</tr>
</table>
<h3>Value</h3>

<p>an object of class <code>"pcsslm"</code>.
</p>
<p>An object of class <code>"pcsslm"</code> is a list containing at least the 
following components:
</p>
<table>
<tr style="vertical-align: top;">
<td><code>call</code></td>
<td>
<p>the matched call</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>terms</code></td>
<td>
<p>the <code>terms</code> object used</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>coefficients</code></td>
<td>
<p>a <code class="reqn">p x 4</code> matrix with columns for the 
estimated coefficient, its standard error, t-statistic and
corresponding (two-sided) p-value.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>sigma</code></td>
<td>
<p>the square root of the estimated variance of the random
error.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>df</code></td>
<td>
<p>degrees of freedom, a 3-vector <code class="reqn">p, n-p, p*</code>, the
first being the number of non-aliased coefficients, the last being
the total number of coefficients.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>fstatistic</code></td>
<td>
<p>a 3-vector with the value of the F-statistic with its
numerator and denominator degrees of freedom.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>r.squared</code></td>
<td>
<p><code class="reqn">R^2</code>, the 'fraction of variance explained by the 
model'.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>adj.r.squared</code></td>
<td>
<p>the above <code class="reqn">R^2</code> statistic <em>'adjusted'</em>,
penalizing for higher <code class="reqn">p</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>cov.unscaled</code></td>
<td>
<p>a <code class="reqn">p x p</code> matrix of (unscaled) covariances of the
<code class="reqn">coef[j], j=1,...p</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>Sum Sq</code></td>
<td>
<p>a 3-vector with the model's Sum of Squares Regression 
(SSR), Sum of Squares Error (SSE), and Sum of Squares Total (SST).</p>
</td>
</tr>
</table>
<h3>References</h3>


<p>Wolf JM, Westra J, Tintle N (2021).
“Using Summary Statistics to Model Multiplicative Combinations of Initially Analyzed Phenotypes With a Flexible Choice of Covariates.”
<em>Frontiers in Genetics</em>, <b>12</b>, 1962.
ISSN 1664-8021, <a href="https://doi.org/10.3389/fgene.2021.745901">doi:10.3389/fgene.2021.745901</a>, <a href="https://www.frontiersin.org/articles/10.3389/fgene.2021.745901/full">https://www.frontiersin.org/articles/10.3389/fgene.2021.745901/full</a>.
</p>



<h3>Examples</h3>

<pre><code class="language-R">ex_data &lt;- pcsstools_example[c("g1", "g2", "g3", "x1", "y4", "y5", "y6")]
head(ex_data)
means &lt;- colMeans(ex_data)
covs &lt;- cov(ex_data)
n &lt;- nrow(ex_data)
predictors &lt;- list(
  g1 = new_predictor_snp(maf = mean(ex_data$g1) / 2),
  g2 = new_predictor_snp(maf = mean(ex_data$g2) / 2),
  g3 = new_predictor_snp(maf = mean(ex_data$g3) / 2),
  x1 = new_predictor_normal(mean = mean(ex_data$x1), sd = sd(ex_data$x1))
)
responses &lt;- lapply(means[c("y4", "y5", "y6")], new_predictor_binary)

model_product(
  y4 * y5 * y6 ~ g1 + g2 + g3 + x1,
  means = means, covs = covs, n = n,
  predictors = predictors, responses = responses, response = "binary"
)

summary(lm(y4 * y5 * y6 ~ g1 + g2 + g3 + x1, data = ex_data))
</code></pre>


</div>