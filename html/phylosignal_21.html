<div class="container">

<table style="width: 100%;"><tr>
<td>lipaMoran</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>Local Indicator of Phylogenetic Association</h2>

<h3>Description</h3>

<p>This function computes Local Indicator of Phylogenetic Association (local Moran's I)
for each tip of a tree.
Tests are based on permutations.
</p>


<h3>Usage</h3>

<pre><code class="language-R">lipaMoran(
  p4d,
  trait = names(tdata(p4d)),
  reps = 999,
  alternative = "greater",
  prox.phylo = "patristic",
  as.p4d = FALSE
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>p4d</code></td>
<td>
<p>a <code>phylo4d</code> object.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>trait</code></td>
<td>
<p>the traits in the <code>phylo4d</code> object for which to compute LIPA.
Can be a character vector giving the name of the traits
or numbers giving the column in the table of the data slot of the <code>phylo4d</code> object.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>reps</code></td>
<td>
<p>a numeric value. Number of repetitions for the estimation of p.values with randomization.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>alternative</code></td>
<td>
<p>a character string specifying the alternative hypothesis for the tests.
Must be one of <code>greater</code> (default), <code>two-sided</code> or <code>less</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>prox.phylo</code></td>
<td>
<p>a matrix of phylogenetic proximities or
a character string specifying a method to compute it.
See Details.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>as.p4d</code></td>
<td>
<p>logical. Should the results returned as a <code>phylo4d</code> object?</p>
</td>
</tr>
</table>
<h3>Details</h3>

<p>If "<code>prox.phylo</code>" is a character string,
the phylogenetic proximity matrix is computed internally
using the function <code>proxTips</code> from the package <span class="pkg">adephylo</span>.
Different methods are available:
"<code>patristic</code>","<code>nNodes</code>","<code>Abouheif</code>" and "<code>sumDD</code>".
See <code>proxTips</code> for details about the methods.
</p>


<h3>Value</h3>

<p>If <code>as.p4d</code> is <code>FALSE</code> (default), the function returns a list:
</p>

<dl>
<dt>lipa</dt>
<dd>
<p>A matrix of LIPA indices computed for each tip of the tree and each trait.</p>
</dd>
<dt>p.value</dt>
<dd>
<p>A matrix of p-values (tests of LIPA indices)</p>
</dd>
<dt>reps</dt>
<dd>
<p>Number of permutations for the tests</p>
</dd>
<dt>alternative</dt>
<dd>
<p>Alternative hypothesis for the tests</p>
</dd>
</dl>
<p>If <code>as.p4d</code> is <code>TRUE</code>, the function returns a <code>phylo4d</code> object
with LIPA values as tips associated data.
</p>


<h3>References</h3>

<p>Anselin L. (1995) Local Indicators of Spatial Association-LISA. Geographical Analysis 27, 93-115.
</p>


</div>