<div class="container">

<table style="width: 100%;"><tr>
<td>dsepAMTest</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>Test for d-separation in a MAG</h2>

<h3>Description</h3>

<p>This function tests for d-separation (also known as m-separation) of node <code>x</code> and node <code>y</code> given nodes <code>S</code> in a MAG.
<code>dsepAMTest()</code> is written to be easily used in <code>skeleton</code>, <code>fci</code>,
<code>fciPlus</code>.
</p>


<h3>Usage</h3>

<pre><code class="language-R">dsepAMTest(x, y, S = NULL, suffStat)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>x</code></td>
<td>
<p>Column number of node <code>x</code> in the adjacency matrix</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>y</code></td>
<td>
<p>Column number of node <code>y</code> in the adjacency matrix</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>S</code></td>
<td>
<p>Vector of column numbers of nodes <code>S</code> in the adjacency
matrix, may be empty</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>suffStat</code></td>
<td>
<p>a <code>list</code> with two elements,
</p>

<dl>
<dt>amat</dt>
<dd>
<p>The Maximal Ancestral Graph encoded as adjacency matrix 
of type amatType</p>
</dd>
<dt>verbose</dt>
<dd>
<p>If true, more detailed output is provided.</p>
</dd>
</dl>
</td>
</tr>
</table>
<h3>Details</h3>

<p>The function is a wrapper for <code>dsepAM</code>, which checks
separation in the moralized graph as explained in Richardson and Spirtes (2002).
</p>


<h3>Value</h3>

<p>Returns 1 if <code>x</code> and <code>y</code> are d-separated by <code>S</code> in the 
MAG encoded by <code>amat</code>, otherwise 0.
</p>
<p>This is analogous to the p-value of an ideal
(without sampling error) conditional independence test on any
distribution that is faithful to the MAG.
</p>


<h3>Author(s)</h3>

<p>Markus Kalisch (<a href="mailto:kalisch@stat.math.ethz.ch">kalisch@stat.math.ethz.ch</a>), Joris Mooij
</p>


<h3>References</h3>

<p>T.S. Richardson and P. Spirtes (2002). Ancestral graph Markov models.
<em>Annals of Statistics</em> <b>30</b> 962-1030.
</p>


<h3>See Also</h3>

<p><code>dsepTest</code> for a similar function for DAGs.
<code>gaussCItest</code>, <code>disCItest</code> and
<code>binCItest</code> for similar functions for a conditional
independence test for gaussian, discrete and
binary variables, respectively.
</p>


<h3>Examples</h3>

<pre><code class="language-R"># Y-structure MAG
# Encode as adjacency matrix
p &lt;- 4 # total number of variables
V &lt;- c("X1","X2","X3","X4") # variable labels
# amat[i,j] = 0 iff no edge btw i,j
# amat[i,j] = 1 iff i *-o j
# amat[i,j] = 2 iff i *-&gt; j
# amat[i,j] = 3 iff i *-- j
amat &lt;- rbind(c(0,0,2,0),
              c(0,0,2,0),
              c(3,3,0,2),
              c(0,0,3,0))
rownames(amat)&lt;-V
colnames(amat)&lt;-V

suffStat&lt;-list(g=amat,verbose=FALSE)
## d-separated
cat('X1 d-separated from X2? ', dsepAMTest(1,2,S=NULL,suffStat),'\n')
## not d-separated given node 3
cat('X1 d-separated from X2 given X4? ',
dsepAMTest(1,2,S=4,suffStat),'\n')
## not d-separated by node 3 and 4
cat('X1 d-separated from X2 given X3 and X4? ', dsepAMTest(1,2,S=c(3,4),
suffStat),'\n')

# Derive PAG that represents the Markov equivalence class of the MAG with the FCI algorithm
# Make use of d-separation oracle as "independence test"
indepTest &lt;- dsepAMTest
fci.pag &lt;- fci(suffStat,indepTest,alpha = 0.5,labels = V,verbose=FALSE)
cat('True MAG:\n')
print(amat)
cat('PAG output by FCI:\n')
print(fci.pag@amat)
</code></pre>


</div>