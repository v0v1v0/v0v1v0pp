<div class="container">

<table style="width: 100%;"><tr>
<td>FCAk</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>Generalisation of Correspondence Analysis for k-way tables</h2>

<h3>Description</h3>

<p>Performs a particular <code>PTAk</code>  data as a ratio Observed/Expected
under complete independence with metrics as margins of the multiple
contingency table (in frequencies).
</p>


<h3>Usage</h3>

<pre><code class="language-R"> FCAk(X,nbPT=3,nbPT2=1,minpct=0.01,
               smoothing=FALSE,smoo=rep(list(
                       function(u)ksmooth(1:length(u),u,kernel="normal",
                       bandwidth=3,x.points=(1:length(u)))$y),length(dim(X))),
                     verbose=getOption("verbose"),file=NULL,
                       modesnam=NULL,addedcomment="",chi2=TRUE,E=NULL, ...)</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>X</code></td>
<td>
<p>a multiple contingency table (array) of order <em>k</em></p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>nbPT</code></td>
<td>
<p>a number or a vector of dimension <em>(k-2)</em></p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>nbPT2</code></td>
<td>
<p>if 0 no 2-modes solutions will be computed, 1 =all, &gt;1
otherwise</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>minpct</code></td>
<td>
<p>numerical 0-100 to control of computation of future solutions at this level and below</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>smoothing</code></td>
<td>
<p>see <code>SVDgen</code></p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>smoo</code></td>
<td>
<p>see <code>SVDgen</code></p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>verbose</code></td>
<td>
<p>control printing</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>file</code></td>
<td>
<p>output printed at the prompt if <code>NULL</code>, or printed in the given  ‘<span class="file">file</span>’</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>modesnam</code></td>
<td>
<p>character vector of the names of the modes, if <code>NULL</code> "<code>mo 1</code>"
..."<code>mo k</code>"</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>addedcomment</code></td>
<td>
<p>character string printed if <code>printt</code> after the title of the analysis</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>chi2</code></td>
<td>
<p>print the chi2 information when computing margins in <code>FCAmet</code></p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>E</code></td>
<td>
<p> if not <code>NULL</code> is an array with the same dimensions as X</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>...</code></td>
<td>
<p>any other arguments passed to SVDGen or other functions</p>
</td>
</tr>
</table>
<h3>Details</h3>

<p>Gives the SVD-<em>k</em>modes decomposition of the <code class="reqn">1+\chi^2/N</code> of
the multiple contingency table of full count <code class="reqn">N=\sum X_{ijk...}</code>,
i.e. complete independence + lack of independence (including marginal
independences) as shown for example in Lancaster(1951)(see reference
in Leibovici(2000)). Noting <code class="reqn">P=X/N</code>,  a <code>PTAk</code> of the
<code class="reqn">(k+1)</code>-uple is done, e.g. for a three way contingency table
<code class="reqn">k=3</code> the <em>4</em>-uple data and metrics is:
</p>
<p style="text-align: center;"><code class="reqn"> ((D_I^{-1} \otimes D_J^{-1} \otimes D_K^{-1})P, \quad D_I, \quad D_J, \quad D_K)</code>
</p>

<p>where the metrics are diagonals of the corresponding margins. For
full description of arguments see <code>PTAk</code>. If <code>E</code>
is not <code>NULL</code> an FCAk-modes relatively to a model is
done (see Escoufier(1985) and therin reference
Escofier(1984) for a 2-way derivation), e.g. for a three way contingency table
<code class="reqn">k=3</code> the <em>4</em>-tuple data and metrics is:
</p>
<p style="text-align: center;"><code class="reqn"> ((D_I^{-1} \otimes D_J^{-1} \otimes D_K^{-1})(P-E), \quad D_I, \quad D_J, \quad D_K)</code>
</p>

<p>If <code>E</code> was the complete independence (product of the margins)
then this would give an <code>AFCk</code> but without looking at the
marginal  dependencies (i.e. for a three way table no two-ways lack of
independence are looked for).
</p>


<h3>Value</h3>

<p>a <code>FCAk</code> (inherits <code>PTAk</code>) object </p>


<h3>Author(s)</h3>

<p>Didier G. Leibovici</p>


<h3>References</h3>

<p>Escoufier Y (1985) <em>L'Analyse des correspondances : ses
propri&lt;e9&gt;t&lt;e9&gt;s et ses extensions</em>. ISI 45th session Amsterdam.
</p>
<p>Leibovici D(1993) <em>Facteurs &lt;e0&gt; Mesures R&lt;e9&gt;p&lt;e9&gt;t&lt;e9&gt;es et Analyses Factorielles :
applications &lt;e0&gt; un suivi &lt;e9&gt;pid&lt;e9&gt;miologique</em>. Universit&lt;e9&gt; de Montpellier
II. PhD Thesis in Math&lt;e9&gt;matiques et Applications (Biostatistiques).
</p>
<p>Leibovici D (2000) <em>Multiway Multidimensional Analysis for
Pharmaco-EEG Studies</em>.<a href="http://www.fmrib.ox.ac.uk/analysis/techrep/tr00dl2/tr00dl2.pdf">http://www.fmrib.ox.ac.uk/analysis/techrep/tr00dl2/tr00dl2.pdf</a>
</p>
<p>Leibovici DG (2010) <em>Spatio-temporal Multiway Decomposition using Principal Tensor Analysis on k-modes:the R package <span class="pkg">PTAk</span></em>. Journal of Statistical Software, 34(10), 1-34. <a href="https://doi.org/10.18637/jss.v034.i10">doi:10.18637/jss.v034.i10</a>
</p>
<p>Leibovici DG and Birkin MH (2013) Simple, multiple and multiway correspondence analysis applied to spatial census-based population microsimulation studies using R. NCRM Working Paper. NCRM-n^o 07/13, Id-3178 <a href="https://eprints.ncrm.ac.uk/id/eprint/3178">https://eprints.ncrm.ac.uk/id/eprint/3178</a>
</p>


<h3>See Also</h3>

<p><code>PTAk</code>, <code>FCAmet</code>, <code>summary.FCAk</code>  </p>


<h3>Examples</h3>

<pre><code class="language-R">   # try the demo
   # demo.FCAk()
</code></pre>


</div>