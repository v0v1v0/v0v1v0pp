<div class="container">

<table style="width: 100%;"><tr>
<td>numericalSolution</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>Numerical solution and plotting</h2>

<h3>Description</h3>

<p>Numerically solves a two-dimensional autonomous ODE system for a given
initial condition, using <code>ode</code> from the package
<code>deSolve</code>. It then plots the dependent variables against
the independent variable.
</p>


<h3>Usage</h3>

<pre><code class="language-R">numericalSolution(
  deriv,
  y0 = NULL,
  tlim,
  tstep = 0.01,
  parameters = NULL,
  type = "one",
  col = c("red", "blue"),
  add.grid = TRUE,
  add.legend = TRUE,
  state.names = c("x", "y"),
  xlab = "t",
  ylab = state.names,
  method = "ode45",
  ...
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>deriv</code></td>
<td>
<p>A function computing the derivative at a point for the ODE
system to be analysed. Discussion of the required structure of these
functions can be found in the package vignette, or in the help file for the
function <code>ode</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>y0</code></td>
<td>
<p>The initial condition. Should be a <code>numeric</code>
<code>vector</code> of <code>length</code> two reflecting
the location of the two dependent variables initially.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>tlim</code></td>
<td>
<p>Sets the limits of the independent variable for which the
solution should be plotted. Should be a <code>numeric</code>
<code>vector</code> of <code>length</code> two. If
<code>tlim[2] &gt; tlim[1]</code>, then <code>tstep</code> should be negative to indicate a
backwards trajectory.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>tstep</code></td>
<td>
<p>The step length of the independent variable, used in numerical
integration. Decreasing the absolute magnitude of <code>tstep</code> theoretically
makes the numerical integration more accurate, but increases computation
time. Defaults to <code>0.01</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>parameters</code></td>
<td>
<p>Parameters of the ODE system, to be passed to <code>deriv</code>.
Supplied as a <code>numeric</code> <code>vector</code>; the
order of the parameters can be found from the <code>deriv</code> file. Defaults to
<code>NULL</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>type</code></td>
<td>
<p>If set to <code>"one"</code> the trajectories are plotted on the same
graph. If set to <code>"two"</code> they are plotted on separate graphs. Defaults
to <code>"one"</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>col</code></td>
<td>
<p>Sets the colours of the trajectories of the two dependent
variables. Should be a <code>character</code>
<code>vector</code> of <code>length</code> two. Will be reset
accordingly if it is of the wrong <code>length</code>. Defaults to
<code>c("red", "blue")</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>add.grid</code></td>
<td>
<p>Logical. If <code>TRUE</code>, grids are added to the plots.
Defaults to <code>TRUE</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>add.legend</code></td>
<td>
<p>Logical. If <code>TRUE</code>, a <code>legend</code>
is added to the plots. Defaults to <code>TRUE</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>state.names</code></td>
<td>
<p>The state names for <code>ode</code> functions
that do not use positional states.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>xlab</code></td>
<td>
<p>Label for the x-axis of the resulting plot.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>ylab</code></td>
<td>
<p>Label for the y-axis of the resulting plot.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>method</code></td>
<td>
<p>Passed to <code>ode</code>. See there for further
details. Defaults to <code>"ode45"</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>...</code></td>
<td>
<p>Additional arguments to be passed to
<code>plot</code>.</p>
</td>
</tr>
</table>
<h3>Value</h3>

<p>Returns a <code>list</code> with the following components:
</p>
<table>
<tr style="vertical-align: top;">
<td><code>add.grid</code></td>
<td>
<p>As per input.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>add.legend</code></td>
<td>
<p>As per input.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>col</code></td>
<td>
<p>As per input, but with possible editing if a
<code>character</code> <code>vector</code> of the wrong
<code>length</code> was supplied.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>deriv</code></td>
<td>
<p>As per input.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>method</code></td>
<td>
<p>As per input.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>parameters</code></td>
<td>
<p>As per input.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>t</code></td>
<td>
<p>A <code>numeric</code> <code>vector</code> containing
the values of the independent variable at each integration step.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>tlim</code></td>
<td>
<p>As per input.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>tstep</code></td>
<td>
<p>As per input.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>x</code></td>
<td>
<p>A <code>numeric</code> <code>vector</code> containing
the numerically computed values of the first dependent variable at each
integration step.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>y</code></td>
<td>
<p>A <code>numeric</code> <code>vector</code> containing
the numerically computed values of the second dependent variable at each
integration step.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>y0</code></td>
<td>
<p>As per input.</p>
</td>
</tr>
</table>
<h3>Author(s)</h3>

<p>Michael J Grayling
</p>


<h3>See Also</h3>

<p><code>ode</code>, <code>plot</code>
</p>


<h3>Examples</h3>

<pre><code class="language-R"># A two-dimensional autonomous ODE system, vanDerPol.
vanDerPol_numericalSolution &lt;- numericalSolution(vanDerPol,
                                                 y0         = c(4, 2),
                                                 tlim       = c(0, 100),
                                                 parameters = 3)

</code></pre>


</div>