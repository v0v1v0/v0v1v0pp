<div class="container">

<table style="width: 100%;"><tr>
<td>expandTaxonTree</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>Extrapolating Lower-Level Taxon Phylogenies from Higher-Level Taxon Trees</h2>

<h3>Description</h3>

<p>This function takes a tree composed of higher-level taxa and a vector of
lower-level taxa belonging to the set of higher-level taxa included in the
input tree and produces a tree composed of the lower-level taxa, by treating
the higher-level taxa as unresolved monophyletic polytomies. A user can also
mark higher taxa as paraphyletic such that these are secondarily collapsed
and do not form monophyletic clades in the output tree.
</p>


<h3>Usage</h3>

<pre><code class="language-R">expandTaxonTree(
  taxonTree,
  taxaData,
  collapse = NULL,
  keepBrLen = FALSE,
  plot = FALSE
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>taxonTree</code></td>
<td>
<p>A phylogeny as an object of class <code>phylo</code>, where tips represent 
some 'higher taxa' that is to be expanded at a lower taxonomic level.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>taxaData</code></td>
<td>
<p>Character vector of higher taxa, with elements names equal
to the lower taxa. See below.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>collapse</code></td>
<td>
<p>Character vector containing names of non-monophyletic higher taxa to be
collapsed.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>keepBrLen</code></td>
<td>
<p>Logical, decides if branch lengths should be kept or
discarded. <code>FALSE</code> by default. See details below.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>plot</code></td>
<td>
<p>If <code>TRUE</code>, plots a comparison between input and output trees</p>
</td>
</tr>
</table>
<h3>Details</h3>

<p>The output tree will probably be a rough unresolved view of the
relationships among the taxa, due to the treatment of higher-level taxa as
polytomies. This is similar to the methods used in Webb and Donoghue (2005)
and Friedman (2009). Any analyses should be done by resolving this tree with
<code>multi2di</code> in the <code>ape</code> package or via the various time-scaling
functions found in this package (paleotree).
</p>
<p>The <code>taxaData</code> vector should have one element per lower-level taxon that is to
be added to the tree. The name of each element in the vector should be the
names of the lower-level taxa, which will be used as new tip labels of the
output lower-taxon tree. There should be no empty elements! 
Otherwise, <code>expandTaxonTree</code> won't know what to do with taxa that aren't being expanded.
</p>
<p>By default, all higher-level taxa are treated as monophyletic clades if not
otherwise specified. The collapse vector can (and probably should) be used
if there is doubt about the monophyly of any higher-level taxa included in
the input taxon-tree, so that such a group would be treated as a paraphyletic
group in the output tree.
</p>
<p>Also by default, the output tree will lack branch lengths and thus will not be
dated, even if the input phylogeny is dated. 
If <code>keepBrLen = TRUE</code>, then the tree's edge lengths are kept and
new taxa are added as zero length branches attaching to a node that
represents the previous higher-taxon. This tree is probably not useful for
most applications, and may even strongly bias some analyses. <em>USE WITH
CAUTION!</em> The <code>collapse</code> argument, given as a vector, 
will cause such edges to be replaced by
zero-length branches rather than fully collapsing them, which could have odd
effects. If <code>collapse</code> is not <code>NULL</code> and <code>keepBrLen = TRUE</code>, 
a warning is issued that the output probably won't make much sense at all.
</p>


<h3>Value</h3>

<p>Outputs the modified tree as an object of class <code>phylo</code>, with the
higher-level taxa expanded into polytomies and the lower-level taxa as the
tip labels.
</p>


<h3>Author(s)</h3>

<p>David W. Bapst
</p>


<h3>References</h3>

<p>Friedman, M. 2009 Ecomorphological selectivity among marine
teleost fishes during the end-Cretaceous extinction. <em>Proceedings of
the National Academy of Sciences</em> <b>106</b>(13):5218–5223.
</p>
<p>Webb, C. O., and M. J. Donoghue. 2005 Phylomatic: tree assembly for applied
phylogenetics. <em>Molecular Ecology Notes</em> <b>5</b>(1):181–183.
</p>


<h3>See Also</h3>

<p><code>multi2di</code>, <code>bind.tree</code>
</p>


<h3>Examples</h3>

<pre><code class="language-R">
set.seed(444)
# lets make our hypothetical simulated tree of higher taxa
taxtr &lt;- rtree(10)
# taxa to place within higher taxa
taxd &lt;- sample(taxtr$tip.label, 30, replace = TRUE)	
names(taxd) &lt;- paste(taxd,"_x", 1:30, sep = "")
coll &lt;- sample(taxtr$tip.label,3)		#what to collapse?
expandTaxonTree(taxonTree = taxtr, taxaData = taxd, 
                collapse = coll, plot = TRUE)

</code></pre>


</div>