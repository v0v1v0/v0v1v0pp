<div class="container">

<table style="width: 100%;"><tr>
<td>factorizations</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>Factorizations of the different PIN likelihood functions</h2>

<h3>Description</h3>

<p>The <code>PIN</code> likelihood function is derived from the original <code>PIN</code> model as
developed by Easley and Ohara (1992) and
Easley et al. (1996). The maximization of the
likelihood function as is leads to computational problems, in particular,
to floating point errors. To remedy to this issue, several
log-transformations or factorizations of the different <code>PIN</code> likelihood
functions have been suggested.
The main factorizations in the literature are:
</p>

<ul>
<li> <p><code>fact_pin_eho()</code>: factorization of
Easley et al. (2010)
</p>
</li>
<li> <p><code>fact_pin_lk()</code>: factorization of
Lin and Ke (2011)
</p>
</li>
<li> <p><code>fact_pin_e()</code>: factorization of
Ersan (2016)
</p>
</li>
</ul>
<p>The factorization of the likelihood function of the multilayer <code>PIN</code> model,
as developed in Ersan (2016).
</p>

<ul><li> <p><code>fact_mpin()</code>: factorization of
Ersan (2016)
</p>
</li></ul>
<p>The factorization of the likelihood function of the adjusted <code>PIN</code> model
(Duarte and Young 2009), is derived, and presented in
Ersan and Ghachem (2022b).
</p>

<ul><li> <p><code>fact_adjpin()</code>: factorization in
Ersan and Ghachem (2022b)
</p>
</li></ul>
<h3>Usage</h3>

<pre><code class="language-R">fact_pin_eho(data, parameters = NULL)

fact_pin_lk(data, parameters = NULL)

fact_pin_e(data, parameters = NULL)

fact_mpin(data, parameters = NULL)

fact_adjpin(data, parameters = NULL)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>data</code></td>
<td>
<p>A dataframe with 2 variables: the first
corresponds to buyer-initiated trades (buys), and the second corresponds
to seller-initiated trades (sells).</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>parameters</code></td>
<td>
<p>In the case of the <code>PIN</code> likelihood
factorization, it is an ordered numeric vector (<code class="reqn">\alpha</code>, <code class="reqn">\delta</code>,
<code class="reqn">\mu</code>, <code class="reqn">\epsilon</code><sub>b</sub>, <code class="reqn">\epsilon</code><sub>s</sub>). In the case of the <code>MPIN</code> likelihood factorization,
it is an ordered numeric vector (<strong><code class="reqn">\alpha</code></strong>, <strong><code class="reqn">\delta</code></strong>,
<strong><code class="reqn">\mu</code></strong>, <code class="reqn">\epsilon</code><sub>b</sub>, <code class="reqn">\epsilon</code><sub>s</sub>), where <strong><code class="reqn">\alpha</code></strong>, <strong><code class="reqn">\delta</code></strong>,
and <strong><code class="reqn">\mu</code></strong> are numeric vectors of size <code>J</code>, where <code>J</code> is the
number of information layers in the data.
In the case of the <code>AdjPIN</code> likelihood factorization, it is an ordered
numeric vector (<code class="reqn">\alpha</code>, <code class="reqn">\delta</code>, <code class="reqn">\theta</code>, <code class="reqn">\theta'</code>,
<code class="reqn">\epsilon</code><sub>b</sub>, <code class="reqn">\epsilon</code><sub>s</sub>, <code class="reqn">\mu</code><sub>b</sub>, <code class="reqn">\mu</code><sub>s</sub>, <code class="reqn">\Delta</code><sub>b</sub>, <code class="reqn">\Delta</code><sub>s</sub>). The default value is <code>NULL</code>.</p>
</td>
</tr>
</table>
<h3>Details</h3>

<p>The argument 'data' should be a numeric dataframe, and contain
at least two variables. Only the first two variables will be considered:
The first variable is assumed to correspond to the total number of
buyer-initiated trades, while the second variable is assumed to
correspond to the total number of seller-initiated trades. Each row or
observation correspond to a trading day. <code>NA</code> values will be ignored.
</p>
<p>Our tests, in line with Lin and Ke (2011),
and Ersan and Alici (2016), demonstrate very
similar results for <code>fact_pin_lk()</code>, and <code>fact_pin_e()</code>, both
having substantially better estimates than <code>fact_pin_eho()</code>.
</p>


<h3>Value</h3>

<p>If the argument <code>parameters</code> is omitted, returns a function
object that can be used with the optimization functions <code>optim()</code>,
and <code>neldermead()</code>.
</p>
<p>If the argument <code>parameters</code> is provided, returns a numeric value of the
log-likelihood function evaluated at the dataset <code>data</code> and the
parameters <code>parameters</code>, where <code>parameters</code> is a numeric vector
following this order (<code class="reqn">\alpha</code>, <code class="reqn">\delta</code>, <code class="reqn">\mu</code>, <code class="reqn">\epsilon</code><sub>b</sub>, <code class="reqn">\epsilon</code><sub>s</sub>)
for the factorizations of the <code>PIN</code> likelihood function, (<strong><code class="reqn">\alpha</code></strong>,
<strong><code class="reqn">\delta</code></strong>, <strong><code class="reqn">\mu</code></strong>, <code class="reqn">\epsilon</code><sub>b</sub>, <code class="reqn">\epsilon</code><sub>s</sub>) for the factorization of the
<code>MPIN</code> likelihood function, and (<code class="reqn">\alpha</code>, <code class="reqn">\delta</code>, <code class="reqn">\theta</code>,
<code class="reqn">\theta'</code>, <code class="reqn">\epsilon</code><sub>b</sub>, <code class="reqn">\epsilon</code><sub>s</sub> ,<code class="reqn">\mu</code><sub>b</sub>, <code class="reqn">\mu</code><sub>s</sub>, <code class="reqn">\Delta</code><sub>b</sub>, <code class="reqn">\Delta</code><sub>s</sub>) for the factorization of
the <code>AdjPIN</code> likelihood function.
</p>


<h3>References</h3>

<p>Duarte J, Young L (2009).
“Why is PIN priced?”
<em>Journal of Financial Economics</em>, <b>91</b>(2), 119–138.
ISSN 0304405X.<br><br> Easley D, Hvidkjaer S, Ohara M (2010).
“Factoring information into returns.”
<em>Journal of Financial and Quantitative Analysis</em>, <b>45</b>(2), 293–309.
ISSN 00221090.<br><br> Easley D, Kiefer NM, Ohara M, Paperman JB (1996).
“Liquidity, information, and infrequently traded stocks.”
<em>Journal of Finance</em>, <b>51</b>(4), 1405–1436.
ISSN 00221082.<br><br> Easley D, Ohara M (1992).
“Time and the Process of Security Price Adjustment.”
<em>The Journal of Finance</em>, <b>47</b>(2), 577–605.
ISSN 15406261.<br><br> Ersan O (2016).
“Multilayer Probability of Informed Trading.”
<em>Available at SSRN 2874420</em>.<br><br> Ersan O, Alici A (2016).
“An unbiased computation methodology for estimating the probability of informed trading (PIN).”
<em>Journal of International Financial Markets, Institutions and Money</em>, <b>43</b>, 74–94.
ISSN 10424431.<br><br> Ersan O, Ghachem M (2022b).
“A methodological approach to the computational problems in the estimation of adjusted PIN model.”
<em>Available at SSRN 4117954</em>.<br><br> Lin H, Ke W (2011).
“A computing bias in estimating the probability of informed trading.”
<em>Journal of Financial Markets</em>, <b>14</b>(4), 625-640.
ISSN 1386-4181.
</p>


<h3>Examples</h3>

<pre><code class="language-R"># There is a preloaded quarterly dataset called 'dailytrades' with 60
# observations. Each observation corresponds to a day and contains the
# total number of buyer-initiated trades ('B') and seller-initiated
# trades ('S') on that day. To know more, type ?dailytrades

xdata &lt;- dailytrades

# ------------------------------------------------------------------------ #
# Using fact_pin_eho(), fact_pin_lk(), fact_pin_e() to find the likelihood #
# value as factorized by Easley(2010), Lin &amp; Ke (2011), and Ersan(2016).   #
# ------------------------------------------------------------------------ #

# Choose a given parameter set to evaluate the likelihood function at a
# givenpoint  = (alpha, delta, mu, eps.b, eps.s)

givenpoint &lt;- c(0.4, 0.1, 800, 300, 200)

# Use the ouput of fact_pin_e() with the optimization function optim() to
# find optimal estimates of the PIN model.

model &lt;- suppressWarnings(optim(givenpoint, fact_pin_e(xdata)))

# Collect the model estimates from the variable model and display them.

varnames &lt;- c("alpha", "delta", "mu", "eps.b", "eps.s")
estimates &lt;- setNames(model$par, varnames)
show(estimates)

# Find the value of the log-likelihood function at givenpoint

lklValue &lt;- fact_pin_lk(xdata, givenpoint)

show(lklValue)

# ------------------------------------------------------------------------ #
# Using fact_mpin() to find the value of the MPIN likelihood function as   #
# factorized by Ersan (2016).                                              #
# ------------------------------------------------------------------------ #

# Choose a given parameter set to evaluate the likelihood function at a
# givenpoint  = (alpha(), delta(), mu(), eps.b, eps.s) where alpha(), delta()
# and mu() are vectors of size 2.

givenpoint &lt;- c(0.4, 0.5, 0.1, 0.6, 600, 1000, 300, 200)

# Use the output of fact_mpin() with the optimization function optim() to
# find optimal estimates of the PIN model.

model &lt;- suppressWarnings(optim(givenpoint, fact_mpin(xdata)))

# Collect the model estimates from the variable model and display them.

varnames &lt;- c(paste("alpha", 1:2, sep = ""), paste("delta", 1:2, sep = ""),
              paste("mu", 1:2, sep = ""), "eb", "es")
estimates &lt;- setNames(model$par, varnames)
show(estimates)

# Find the value of the MPIN likelihood function at givenpoint

lklValue &lt;- fact_mpin(xdata, givenpoint)

show(lklValue)

# ------------------------------------------------------------------------ #
# Using fact_adjpin() to find the value of the DY likelihood function as   #
# factorized by Ersan and Ghachem (2022b).                                 #
# ------------------------------------------------------------------------ #

# Choose a given parameter set to evaluate the likelihood function
# at a the initial parameter set givenpoint = (alpha, delta,
# theta, theta',eps.b, eps.s, muB, muS, db, ds)

givenpoint &lt;- c(0.4, 0.1, 0.3, 0.7, 500, 600, 800, 1000, 300, 200)

# Use the output of fact_adjpin() with the optimization function
# neldermead() to find optimal estimates of the AdjPIN model.

low &lt;- c(0, 0, 0, 0, 0, 0, 0, 0, 0, 0)
up &lt;- c(1, 1, 1, 1, Inf, Inf, Inf, Inf, Inf, Inf)
model &lt;- nloptr::neldermead(
givenpoint, fact_adjpin(xdata), lower = low, upper = up)

# Collect the model estimates from the variable model and display them.

varnames &lt;- c("alpha", "delta", "theta", "thetap", "eps.b", "eps.s",
              "muB", "muS", "db", "ds")
estimates &lt;- setNames(model$par, varnames)
show(estimates)

# Find the value of the log-likelihood function at givenpoint

adjlklValue &lt;- fact_adjpin(xdata, givenpoint)
show(adjlklValue)
</code></pre>


</div>