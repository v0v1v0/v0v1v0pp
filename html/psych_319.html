<div class="container">

<table style="width: 100%;"><tr>
<td>outlier</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>Find and graph Mahalanobis squared distances to detect outliers</h2>

<h3>Description</h3>

<p>The Mahalanobis distance is <code class="reqn">D^2 = (x-\mu)' \Sigma^-1 (x-\mu)</code> where <code class="reqn">\Sigma</code> is the covariance of the x matrix.  D2 may be used as a way of detecting outliers in distribution.  Large D2 values, compared to the expected Chi Square values indicate an unusual response pattern.  The mahalanobis function in stats does not handle missing data.
</p>


<h3>Usage</h3>

<pre><code class="language-R">outlier(x, plot = TRUE, bad = 5,na.rm = TRUE, xlab, ylab, ...)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>x</code></td>
<td>
<p>A data matrix or data.frame</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>plot</code></td>
<td>
<p>Plot the resulting QQ graph</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>bad</code></td>
<td>
<p>Label the bad worst values</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>na.rm</code></td>
<td>
<p>Should missing data be deleted</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>xlab</code></td>
<td>
<p>Label for x axis</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>ylab</code></td>
<td>
<p>Label for y axis</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>...</code></td>
<td>
<p>More graphic parameters, e.g., cex=.8</p>
</td>
</tr>
</table>
<h3>Details</h3>

<p>Adapted from the mahalanobis function and help page from stats.
</p>


<h3>Value</h3>

<p>The D2 values for each case</p>


<h3>Author(s)</h3>

<p>William Revelle</p>


<h3>References</h3>

<p>Yuan, Ke-Hai and Zhong, Xiaoling, (2008) Outliers, Leverage Observations, and Influential Cases in Factor Analysis: Using Robust Procedures to Minimize Their Effect, Sociological Methodology, 38, 329-368.
</p>


<h3>See Also</h3>

<p><code>mahalanobis</code> 
</p>


<h3>Examples</h3>

<pre><code class="language-R">#first, just find and graph the outliers
d2 &lt;- outlier(sat.act)
#combine with the data frame and plot it with the outliers highlighted in blue
sat.d2 &lt;- data.frame(sat.act,d2)
pairs.panels(sat.d2,bg=c("yellow","blue")[(d2 &gt; 25)+1],pch=21)
</code></pre>


</div>