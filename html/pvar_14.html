<div class="container">

<table style="width: 100%;"><tr>
<td>PvarBreakTest</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>Structural break test</h2>

<h3>Description</h3>

<p>This function performs structural break test that is based on p-variation.
</p>


<h3>Usage</h3>

<pre><code class="language-R">PvarBreakTest(x, TimeLabel = as.vector(time(x)), alpha = 0.05,
  FullInfo = TRUE)

## S3 method for class 'PvarBreakTest'
plot(x, main1 = "Data",
  main2 = "Bridge transformation", ylab1 = x$dname,
  ylab2 = "BridgeT(" %.% x$dname %.% ")", sub2 = NULL,
  col.PP = 3, cex.PP = 0.5, col.BP = 2, cex.BP = 1, cex.DP = 0.5,
  ...)

## S3 method for class 'PvarBreakTest'
summary(object, ...)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>x</code></td>
<td>
<p>a numeric vector of data values or an object of class <code>pvar</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>TimeLabel</code></td>
<td>
<p>numeric, a time index of <code>x</code>. Used only for plotting.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>alpha</code></td>
<td>
<p>a small number greater then 0. It indicates the significant level of the test.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>FullInfo</code></td>
<td>
<p><code>logical</code>. If <code>TRUE</code> (the default) the function will return an object of the class <code>PvarBreakTest</code> 
that saves all useful information. Otherwise only the statistics will by returned.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>main1</code></td>
<td>
<p>the <code>main</code> parameter of the data graph.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>main2</code></td>
<td>
<p>the <code>main</code> parameter of the Bridge transformation graph.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>ylab1</code></td>
<td>
<p>the <code>ylab</code> parameter of the data graph.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>ylab2</code></td>
<td>
<p>the <code>ylab</code> parameter of the Bridge transformation graph.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>sub2</code></td>
<td>
<p>the <code>sub</code> parameter of the Bridge transformation graph. By default it reports the number of break points.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>col.PP</code></td>
<td>
<p>the color of partition points.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>cex.PP</code></td>
<td>
<p>the cex of partition points.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>col.BP</code></td>
<td>
<p>the color of break points.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>cex.BP</code></td>
<td>
<p>the cex of break points.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>cex.DP</code></td>
<td>
<p>the cex of data points.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>...</code></td>
<td>
<p>further arguments, passed to <code>print</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>object</code></td>
<td>
<p>the object of the class <code>PvarBreakTest</code>.</p>
</td>
</tr>
</table>
<h3>Details</h3>

<p>Lets <code>x</code> be a data that should be tested of structural breaks. 
Then the p-variation of the <code>BridgeT(x)</code> with <code>p=4</code> is the test's statistics.
</p>
<p>The quantiles of H0 distribution is based on Monte-Carlo simulation of 140 millions iterations. 
The test is reliable then <code>length(x)</code> is between 100 and 10000.
The test might work with other lengths too, but it is not tested well.
The test will not compute then <code>length(x)&lt;20</code>.
</p>


<h3>Value</h3>

<p>If <code>FullInfo=TRUE</code> then function returns an object of the class <code>PvarBreakTest</code>. 
It is the <code>list</code> that contains:
</p>
<table>
<tr style="vertical-align: top;">
<td><code>Stat</code></td>
<td>
<p>a value of statistics (p-variation of transformed data).</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>CriticalValue</code></td>
<td>
<p>the critical value of the test according to significant level.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>alpha</code></td>
<td>
<p>the significant level.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>p.value</code></td>
<td>
<p>approximate p-value.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>reject</code></td>
<td>
<p><code>logical</code>. If <code>TRUE</code>, the H0 was rejected.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>dname</code></td>
<td>
<p>the name of data vector.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>p</code></td>
<td>
<p>the power in p-variation calculus. The test performs only with the <code>p=4</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>x</code></td>
<td>
<p>a vector of original data.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>y</code></td>
<td>
<p>a vector of transformed data (<code>y=BridgeT(x)</code>).</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>Timelabel</code></td>
<td>
<p>time label of <code>x</code>. Used only for ploting.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>BreakPoints</code></td>
<td>
<p>the indexes of break points suggestion.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>Partition</code></td>
<td>
<p>a vector of indexes that indicates the partition of <code>y</code> that achieves the p-variation maximum.</p>
</td>
</tr>
</table>
<h3>Author(s)</h3>

<p>Vygantas Butkus &lt;Vygantas.Butkus@gmail.com&gt;
</p>


<h3>References</h3>

<p>The test was proposed by A. Rackaskas. The test is based on the results given in the flowing article
</p>
<p>[1] R. Norvaisa, A. Rackauskas. Convergence in law of partial sum processes in p-variation norm. 
Lth. Math. J., 2008., Vol. 48, No. 2, 212-227.
</p>


<h3>See Also</h3>

<p>Tests statistics is  <code>pvar</code> of the data <code>BridgeT(x)</code>(see  <code>BridgeT</code>) with (p=4).
The critical value and the approximate  p-value of the test might by found by functions
<code>PvarQuantile</code> and  <code>PvarPvalue</code>.
</p>


<h3>Examples</h3>

<pre><code class="language-R">set.seed(1)
MiuDiff &lt;- 0.3
x &lt;- rnorm(250*4, rep(c(0, MiuDiff, 0, MiuDiff), each=250))

plot(x, pch=19, cex=0.5, main='original data, with several shifts of mean')
k &lt;- 50
moveAvg &lt;- filter(x, rep(1/k, k))
lines(time(x), moveAvg, lwd=2, col=2)
legend('topleft', c('sample', 'moving average (k='%.%k%.%')'),
       lty=c(NA,1), lwd=c(NA, 2), col=1:2, pch=c(19,NA), pt.cex=c(0.7,1)
       ,inset = .03, bg='antiquewhite1')

xtest &lt;- PvarBreakTest(x)
plot(xtest)
</code></pre>


</div>