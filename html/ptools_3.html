<div class="container">

<table style="width: 100%;"><tr>
<td>check_pois</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>Checks the fit of a Poisson Distribution</h2>

<h3>Description</h3>

<p>Provides a frequency table to check the fit of a Poisson distribution to empirical data.
</p>


<h3>Usage</h3>

<pre><code class="language-R">check_pois(counts, min_val, max_val, pred, silent = FALSE)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>counts</code></td>
<td>
<p>vector of counts, e.g. c(0,5,1,3,4,6)</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>min_val</code></td>
<td>
<p>scaler minimum value to generate the grid of results, e.g. <code>0</code></p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>max_val</code></td>
<td>
<p>scaler maximum value to generate the grid of results, e.g. <code>max(counts)</code></p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>pred</code></td>
<td>
<p>can either be a scaler, e.g. <code>mean(counts)</code>, or a vector (e.g. predicted values from a Poisson regression)</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>silent</code></td>
<td>
<p>boolean, do not print mean/var stat messages, only applies when passing scaler for pred (default <code>FALSE</code>)</p>
</td>
</tr>
</table>
<h3>Details</h3>

<p>Given either a scaler mean to test the fit, or a set of predictions (e.g. varying means predicted from a model), checks whether the data fits a given Poisson distribution over a specified set of integers. That is it builds a table of integer counts, and calculates the observed vs the expected distribution according to Poisson. Useful for checking any obvious deviations.
</p>


<h3>Value</h3>

<p>A dataframe with columns
</p>

<ul>
<li> <p><code>Int</code>, the integer value
</p>
</li>
<li> <p><code>Freq</code>, the total observed counts within that Integer value
</p>
</li>
<li> <p><code>PoisF</code>, the expected counts according to a Poisson distribution with mean/pred specified
</p>
</li>
<li> <p><code>ResidF</code>, the residual from <code>Freq - PoisF</code>
</p>
</li>
<li> <p><code>Prop</code>, the observed proportion of that integer (0-100 scale)
</p>
</li>
<li> <p><code>PoisD</code>, the expected proportion of that integer (0-100 scale)
</p>
</li>
<li> <p><code>ResidD</code>, the residual from <code>Prop - PoisD</code>
</p>
</li>
</ul>
<h3>Examples</h3>

<pre><code class="language-R"># Example use for constant over the whole sample
set.seed(10)
lambda &lt;- 0.2
x &lt;- rpois(10000,lambda)
pfit &lt;- check_pois(x,0,max(x),mean(x))
print(pfit)
# 82% zeroes is not zero inflated -- expected according to Poisson!

# Example use if you have varying predictions, eg after Poisson regression
n &lt;- 10000
ru &lt;- runif(n,0,10)
x &lt;- rpois(n,lambda=ru)
check_pois(x, 0, 23, ru)

# If you really want to do a statistical test of fit
chi_stat &lt;- sum((pfit$Freq - pfit$PoisF)^2/pfit$PoisF)
df &lt;- length(pfit$Freq) - 2
stats::dchisq(chi_stat, df) #p-value
# I prefer evaluating specific integers though (e.g. zero-inflated, longer-tails, etc.)

</code></pre>


</div>