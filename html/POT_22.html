<div class="container">

<table style="width: 100%;"><tr>
<td>fitmcgpd</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>Fitting Markov Chain Models to Peaks Over a Threshold</h2>

<h3>Description</h3>

<p>Fitting a Markov chain to cluster exceedances using a bivariate
extreme value distribution and a censored maximum likelihood
procedure.
</p>


<h3>Usage</h3>

<pre><code class="language-R">fitmcgpd(data, threshold, model = "log", start, ..., std.err.type =
"observed", corr = FALSE, warn.inf = TRUE, method = "BFGS")
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>data</code></td>
<td>
<p>A vector of observations.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>threshold</code></td>
<td>
<p>The threshold value.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>model</code></td>
<td>
<p>A character string which specifies the model used. Must
be one of <code>log</code> (the default), <code>alog</code>, <code>nlog</code>,
<code>anlog</code>, <code>mix</code> and <code>amix</code> for the logistic, asymmetric
logistic, negative logistic, asymmetric negative logistic, mixed and
asymmetric mixed models.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>start</code></td>
<td>
<p>Optional. A list for starting values in the fitting
procedure.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>...</code></td>
<td>
<p>Additional parameters to be passed to the
<code>optim</code> function or to the bivariate model. In
particular, parameter of the model can be hand fixed.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>std.err.type</code></td>
<td>
<p>The type of the standard error. Currently, one
must specify <code>``observed''</code> for observed Fisher information
matrix or <code>``none''</code> for no computations of the standard
errors.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>corr</code></td>
<td>
<p>Logical. Should the correlation matrix be computed?</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>warn.inf</code></td>
<td>
<p>Logical. Should users be warned if likelihood is not
finite at starting values?</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>method</code></td>
<td>
<p>The optimization method, see <code>optim</code>.</p>
</td>
</tr>
</table>
<h3>Details</h3>

<p>The Markov Chain model is defined as follows:
</p>
<p style="text-align: center;"><code class="reqn">L\left(y;\theta_1,\theta_2\right) = f\left(x_1; \theta_1\right)
    \prod_{i=2}^n f\left(y_i |
    y_{i-1};\theta_1,\theta_2\right)</code>
</p>

<p>As exceedances above a (high enough) threshold are of interest, it is
assumed that the marginal are GPD distributed, while the joint
distribution is represented by a bivariate extreme value
distribution. Smith et al. (1997) present theoretical results about
this Markov Chain model.
</p>
<p>The bivariate exceedances are fitted using censored likelihood
procedure. This methodology is fully described in Ledford (1996).
</p>
<p>Most of models are described in Kluppelberg (2006).
</p>


<h3>Value</h3>

<p>The function returns an object of class <code>c("mcpot", "uvpot",
    "pot")</code>.  As usual, one can extract several features using
<code>fitted</code> (or <code>fitted.values</code>),
<code>deviance</code>, <code>logLik</code> and <code>AIC</code>
functions.
</p>
<table>
<tr style="vertical-align: top;">
<td><code>fitted.values</code></td>
<td>
<p>The maximum likelihood estimates of the Markov
chain including estimated parameters of the bivariate extreme value
distribution.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>std.err</code></td>
<td>
<p>A vector containing the standard errors - only present
when the observed information matrix is not singular.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>var.cov</code></td>
<td>
<p>The asymptotic variance covariance matrix - only
presents when the observed information matrix is not singular.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>deviance</code></td>
<td>
<p>The deviance.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>corr</code></td>
<td>
<p>The correlation matrix.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>convergence, counts, message</code></td>
<td>
<p>Informations taken from the
<code>optim</code> function.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>threshold</code></td>
<td>
<p>The threshold.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>pat</code></td>
<td>
<p>The proportion above the threshold.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>nat</code></td>
<td>
<p>The number above the threshold.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>data</code></td>
<td>
<p>The observations.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>exceed</code></td>
<td>
<p>The exceedances.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>call</code></td>
<td>
<p>The call of the current function.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>model</code></td>
<td>
<p>The model for the bivariate extreme value distribution.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>chi</code></td>
<td>
<p>The chi statistic of Coles (1999). A value near 1 (resp. 0)
indicates perfect dependence (resp. independence).</p>
</td>
</tr>
</table>
<h3>Warnings</h3>

<p>Because of numerical problems, there exists artificial numerical
constraints imposed on each model. These are:
</p>

<ul>
<li>
<p> For the logistic and asymmetric logistic models: <code class="reqn">\alpha</code>
must lie in [0.05, 1] instead of [0,1];
</p>
</li>
<li>
<p> For the negative logistic model: <code class="reqn">\alpha</code> must lie in
[0.01, 15] instead of <code class="reqn">[0,\infty[</code>;
</p>
</li>
<li>
<p> For the asymmetric negative logistic model: <code class="reqn">\alpha</code> must
lie in [0.2, 15] instead of <code class="reqn">[0,\infty[</code>;
</p>
</li>
<li>
<p> For the mixed and asymmetric mixed models: None artificial numerical
constraints are imposed.
</p>
</li>
</ul>
<p>For this purpose, users must check if estimates are near these
artificial numerical constraints. Such cases may lead to substantial
biases on the GP parameter estimates. One way to detect quickly if
estimates are near the border constraints is to look at the standard
errors for the dependence parameters. Small values (i.e. &lt; 1e-5) often
indicates that numerical constraints have been reached.
</p>
<p>In addition, users must be aware that the mixed and asymmetric mixed
models can not deal with perfect dependence.
</p>
<p>Thus, user may want to plot the Pickands' dependence function to see
if variable are near independence or dependence cases using the
<code>pickdep</code> function.
</p>
<p>In addition, we recommend to fix the marginal parameters. Indeed, even
this is a two steps optimization procedure, this avoid numerical
troubles - the likelihood function for the Markov chain model seems to
be problematic. Thus, estimates are often better using the two stages
approach.
</p>


<h3>Author(s)</h3>

<p>Mathieu Ribatet</p>


<h3>References</h3>

<p>Kl\"uppelberg, C., and May A. (2006) Bivariate extreme value
distributions based on polynomial dependence functions. Mathematical
Methods in the Applied Sciences, <b>29</b> 1467–1480.
</p>
<p>Ledford A., and Tawn, J. (1996) Statistics for near Independence in
Multivariate Extreme Values. Biometrika, <b>83</b> 169–187.
</p>
<p>Smith, R., and Tawn, J., and Coles, S. (1997) Markov chain models for
threshold exceedances. Biometrika, <b>84</b> 249–268
</p>


<h3>See Also</h3>

<p>The following usual generic functions are available 
<code>print</code>, 
<code>plot</code>
as well as new generic functions 
<code>retlev</code> and
<code>convassess</code>.
</p>
<p>See also <code>pickdep</code>.
</p>
<p>For optimization in R, see <code>optim</code>.
</p>


<h3>Examples</h3>

<pre><code class="language-R">mc &lt;- simmc(1000, alpha = 0.25)
mc &lt;- qgpd(mc, 0, 1, 0.25)
##A first application when marginal parameter are estimated
fitmcgpd(mc, 0)

##Another one where marginal parameters are fixed
fmle &lt;- fitgpd(mc, 0)
fitmcgpd(mc, 0, scale = fmle$param["scale"], shape = fmle$param["shape"])
</code></pre>


</div>