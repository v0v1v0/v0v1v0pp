<div class="container">

<table style="width: 100%;"><tr>
<td>prune</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>Remove tree nodes by regular expression pattern matching.</h2>

<h3>Description</h3>

<p><code>"prune"</code> takes an object of class <code>"dendrogram"</code> and
removes all branches whose branch labels match a given regular
expression.
</p>


<h3>Usage</h3>

<pre><code class="language-R">prune(tree, pattern, keep = FALSE, ...)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>tree</code></td>
<td>
<p>an object of class <code>"dendrogram"</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>pattern</code></td>
<td>
<p>a regular expression.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>keep</code></td>
<td>
<p>logical indicating whether the nodes whose labels match
the regular expression provided in "pattern" should be
kept and the remainder discarded. Defaults to FALSE.
Note that nodes without "label" attributes are ignored.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>...</code></td>
<td>
<p>further arguments to be passed to <code>grepl</code> and <code>gsub</code>.</p>
</td>
</tr>
</table>
<h3>Details</h3>

<p>This function recursively tests the "label" attribute of each
dendrogram node (including non-leaf inner nodes if applicable) for
the specified pattern, removing those that register a positive hit.
Note that positive matching inner nodes are removed along with all of
their sub-nodes, regardless of whether the "label" attributes of the
sub-nodes match the pattern.
</p>


<h3>Value</h3>

<p>Returns an object of class <code>"dendrogram"</code>.
</p>


<h3>Author(s)</h3>

<p>Shaun Wilkinson
</p>


<h3>See Also</h3>

<p>The <code>drop.tip</code> function in the
<code>ape</code> package performs a similar operation for objects
of class <code>"phylo"</code>. See <code>regex</code> for help with
compiling regular expressions.
</p>


<h3>Examples</h3>

<pre><code class="language-R">  x &lt;- read.dendrogram(text = "(A:0.1,B:0.2,(C:0.3,D:0.4):0.5);")
  plot(x, horiz = TRUE)
  x &lt;- prune(x, pattern = "^A$")
  plot(x, horiz = TRUE)
</code></pre>


</div>