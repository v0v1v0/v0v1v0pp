<div class="container">

<table style="width: 100%;"><tr>
<td>graph_perm_test</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>Performs graph-based permutation tests</h2>

<h3>Description</h3>

<p>Performs graph-based tests for one-way designs.
</p>


<h3>Usage</h3>

<pre><code class="language-R">graph_perm_test(
  physeq,
  sampletype,
  grouping = 1:nsamples(physeq),
  distance = "jaccard",
  type = c("mst", "knn", "threshold.value", "threshold.nedges"),
  max.dist = 0.4,
  knn = 1,
  nedges = nsamples(physeq),
  keep.isolates = TRUE,
  nperm = 499
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>physeq</code></td>
<td>
<p>A phyloseq object.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>sampletype</code></td>
<td>
<p>A string giving the column name of the sample to
be tested. This should be a factor with two or more levels.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>grouping</code></td>
<td>
<p>Either a string with the name of a sample data
column or a factor of length equal to the number of samples in
physeq. These are the groups of samples whose labels should be
permuted and are used for repeated measures designs. Default is no
grouping (each group is of size 1).</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>distance</code></td>
<td>
<p>A distance, see <code>distance</code> for a
list of the possible methods.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>type</code></td>
<td>
<p>One of "mst", "knn", "threshold". If "mst", forms the
minimum spanning tree of the sample points. If "knn", forms a
directed graph with links from each node to its k nearest
neighbors. If "threshold", forms a graph with edges between every
pair of samples within a certain distance.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>max.dist</code></td>
<td>
<p>For type "threshold", the maximum distance between
two samples such that we put an edge between them.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>knn</code></td>
<td>
<p>For type "knn", the number of nearest neighbors.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>nedges</code></td>
<td>
<p>If using "threshold.nedges", the number of edges to use.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>keep.isolates</code></td>
<td>
<p>In the returned network, keep the unconnected
points?</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>nperm</code></td>
<td>
<p>The number of permutations to perform.</p>
</td>
</tr>
</table>
<h3>Value</h3>

<p>A list with the observed number of pure edges, the vector
containing the number of pure edges in each permutation, the
permutation p-value, the graph used for testing, and a vector with
the sample types used for the test.
</p>


<h3>Examples</h3>

<pre><code class="language-R">library(phyloseq)
data(enterotype)
gt = graph_perm_test(enterotype, sampletype = "SeqTech", type = "mst")
gt
</code></pre>


</div>