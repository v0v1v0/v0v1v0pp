<div class="container">

<table style="width: 100%;"><tr>
<td>fastBM</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>(Reasonably) fast quantitative trait simulation on phylogenies</h2>

<h3>Description</h3>

<p>Simulates one or multiple continuous traits on the tree under various evolutionary models.
</p>


<h3>Usage</h3>

<pre><code class="language-R">fastBM(tree, a=0, mu=0, sig2=1, bounds=c(-Inf,Inf), internal=FALSE, nsim=1, 
   ...)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>tree</code></td>
<td>
<p>is a phylogenetic tree in <code>"phylo"</code> format.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>a</code></td>
<td>
<p>a value for ancestral state at the root node.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>mu</code></td>
<td>
<p>an optional value for the mean of random normal changes along branches of the tree - can be used to simulate a trend if <code>mu!=0</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>sig2</code></td>
<td>
<p>instantaneous variance of the BM process, <code class="reqn">\sigma^2</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>bounds</code></td>
<td>
<p>a vector with the lower and upper bounds (respectively) for bounded Brownian simulation - by default simulation is unbounded.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>internal</code></td>
<td>
<p>logical value indicating whether or not to return states for internal nodes.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>nsim</code></td>
<td>
<p>number of simulations.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>...</code></td>
<td>
<p>optional arguments <code>alpha</code> and <code>theta</code> used for OU simulation. If <code>alpha</code> is set then <code>mu</code> and <code>bounds</code> are ignored with a warning.</p>
</td>
</tr>
</table>
<h3>Details</h3>

<p>This function conducts (reasonably) fast quantitative trait simulation on a phylogeny under several different models: Brownian motion (default), BM with a trend (for <code>mu!=0</code>), bounds (for <code>bounds!=c(-Inf,</code> <code>Inf)</code>), and OU. 
</p>


<h3>Value</h3>

<p>A vector (for <code>nsim=1</code>) or matrix containing the tip states for the <code>n</code> species in the tree, and (optionally) the ancestral states for internal nodes.
</p>


<h3>Author(s)</h3>

<p>Liam Revell <a href="mailto:liam.revell@umb.edu">liam.revell@umb.edu</a></p>


<h3>References</h3>

<p>Revell, L. J. (2024) phytools 2.0: an updated R ecosystem for phylogenetic comparative methods (and other things). <em>PeerJ</em>, <b>12</b>, e16505.
</p>


<h3>See Also</h3>

<p><code>sim.corrs</code>
</p>


<h3>Examples</h3>

<pre><code class="language-R">## simulate 10 characters on the Anolis tree 
## under Brownian motion
data(anoletree)
X&lt;-fastBM(anoletree,nsim=10)
head(X)
</code></pre>


</div>