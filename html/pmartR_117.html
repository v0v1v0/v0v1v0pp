<div class="container">

<table style="width: 100%;"><tr>
<td>plot.statRes</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>Plot statRes Object</h2>

<h3>Description</h3>

<p>Produces plots that summarize the results contained in a 'statRes' object.
</p>


<h3>Usage</h3>

<pre><code class="language-R">## S3 method for class 'statRes'
plot(
  x,
  plot_type = "bar",
  fc_threshold = NULL,
  fc_colors = c("red", "black", "green"),
  stacked = TRUE,
  show_sig = TRUE,
  color_low = NULL,
  color_high = NULL,
  plotly_layout = NULL,
  interactive = FALSE,
  x_lab = NULL,
  x_lab_size = 11,
  x_lab_angle = NULL,
  y_lab = NULL,
  y_lab_size = 11,
  title_lab = NULL,
  title_lab_size = 14,
  legend_lab = NULL,
  legend_position = "right",
  text_size = 3,
  bw_theme = TRUE,
  display_count = TRUE,
  custom_theme = NULL,
  cluster = FALSE,
  free_y_axis = FALSE,
  ...
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>x</code></td>
<td>
<p>'statRes' object to be plotted, usually the result of 'imd_anova'</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>plot_type</code></td>
<td>
<p>defines which plots to be produced, options are "bar",
"volcano", "gheatmap", "fcheatmap"; defaults to "bar".  See details for
plot descriptions.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>fc_threshold</code></td>
<td>
<p>optional threshold value for fold change estimates.
Modifies the volcano plot as follows:  Vertical lines are added at
(+/-)<code>fc_threshold</code> and all observations that have absolute fold
change less than <code>abs(fc_threshold)</code> are colored as 'non-significant'
(as specified by <code>fc_colors</code>).</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>fc_colors</code></td>
<td>
<p>vector of length three with character color values
interpretable by ggplot. i.e. c("orange", "black", "blue") with the values
being used to color negative, non-significant, and positive fold changes
respectively</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>stacked</code></td>
<td>
<p>TRUE/FALSE for whether to stack positive and negative fold
change sections in the barplot, defaults to TRUE</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>show_sig</code></td>
<td>
<p>This input is used when <code>plot_type = "gheatmap"</code>. A
logical value. If TRUE a visual indicator that a certain bin combination is
significant by the g-test is shown.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>color_low</code></td>
<td>
<p>This input is used when <code>plot_type = "gheatmap"</code>. A
character string specifying the color of the gradient for low count values.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>color_high</code></td>
<td>
<p>This input is used when <code>plot_type = "gheatmap"</code>. A
character string specifying the color of the gradient for high count
values.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>plotly_layout</code></td>
<td>
<p>This input is used when <code>plot_type = "gheatmap"</code>. A
list of arguments, not including the plot, to be passed to
<code>plotly::layout</code> if <code>interactive = TRUE</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>interactive</code></td>
<td>
<p>TRUE/FALSE for whether to create an interactive plot using
plotly. Not valid for all plots.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>x_lab</code></td>
<td>
<p>character string specifying the x-axis label.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>x_lab_size</code></td>
<td>
<p>integer value indicating the font size for the x-axis. The
default is 11.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>x_lab_angle</code></td>
<td>
<p>integer value indicating the angle of x-axis labels.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>y_lab</code></td>
<td>
<p>character string specifying the y-axis label.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>y_lab_size</code></td>
<td>
<p>integer value indicating the font size for the y-axis. The
default is 11.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>title_lab</code></td>
<td>
<p>character string specifying the plot title.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>title_lab_size</code></td>
<td>
<p>integer value indicating the font size of the plot
title. The default is 14.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>legend_lab</code></td>
<td>
<p>character string specifying the legend title.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>legend_position</code></td>
<td>
<p>character string specifying the position of the
legend. Can be one of "right", "left", "top", "bottom", or "none". The
default is "none".</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>text_size</code></td>
<td>
<p>integer specifying the size of the text (number of
non-missing values) within the plot. The default is 3.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>bw_theme</code></td>
<td>
<p>logical value. If TRUE uses the ggplot2 black and white
theme.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>display_count</code></td>
<td>
<p>logical value. Indicates whether the non-missing counts
will be displayed on the bar plot. The default is TRUE.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>custom_theme</code></td>
<td>
<p>a ggplot 'theme' object to be applied to non-interactive
plots, or those converted by plotly::ggplotly().</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>cluster</code></td>
<td>
<p>logical for heatmaps; TRUE will cluster biomolecules on X
axis. defaults to TRUE for seqData statistics and FALSE for all others.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>free_y_axis</code></td>
<td>
<p>Logical. If TRUE the y axis for each bar plot can have its
own range. The default is FALSE.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>...</code></td>
<td>
<p>further arguments passed to or from other methods.</p>
</td>
</tr>
</table>
<h3>Details</h3>

<p>Plot types:
</p>

<ul>
<li>
<p>"bar" <code>?pmartR::statres_barplot</code> Bar-chart with bar heights
indicating the number of significant biomolecules, grouped by test type and
fold change direction.
</p>
</li>
<li>
<p>"volcano" <code>?pmartR::statres_volcano_plot</code> Scatter plot showing
negative-log-pvalues against fold change. Colored by statistical
significance and fold change.
</p>
</li>
<li>
<p>"gheatmap" <code>?pmartR::gtest_heatmap</code> Heatmap with x and y axes
indicating the number of nonmissing values for two groups. Colored by
number of biomolecules that fall into that combination of nonmissing values.
</p>
</li>
<li>
<p>"fcheatmap" Heatmap showing all biomolecules across comparisons,
colored by fold change.
</p>
</li>
</ul>
<h3>Value</h3>

<p>ggplot2 plot object if interactive is FALSE, or plotly plot object if
interactive is TRUE
</p>


<h3>Examples</h3>

<pre><code class="language-R">
library(pmartRdata)
# Group the data by condition
mypro &lt;- group_designation(
  omicsData = pro_object,
  main_effects = c("Phenotype")
)

# Apply the IMD ANOVA filter
imdanova_Filt &lt;- imdanova_filter(omicsData = mypro)
mypro &lt;- applyFilt(
  filter_object = imdanova_Filt,
  omicsData = mypro,
  min_nonmiss_anova = 2
)

# Implement the IMD ANOVA method and compuate all pairwise comparisons
# (i.e. leave the `comparisons` argument NULL)
anova_res &lt;- imd_anova(omicsData = mypro, test_method = 'anova')
plot(anova_res)
plot(anova_res, plot_type = "volcano")

imd_res &lt;- imd_anova(omicsData = mypro, test_method = 'gtest')
plot(imd_res)

imd_anova_res &lt;- imd_anova(
  omicsData = mypro,
  test_method = 'comb',
  pval_adjust_a_multcomp = 'bon',
  pval_adjust_g_multcomp = 'bon'
)
plot(imd_anova_res, bw_theme = TRUE)
plot(imd_anova_res, plot_type = "volcano", bw_theme = TRUE)

</code></pre>


</div>