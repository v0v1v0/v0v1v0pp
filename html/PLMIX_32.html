<div class="container">

<table style="width: 100%;"><tr>
<td>ppcheckPLMIX</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>Posterior predictive check for Bayesian mixtures of Plackett-Luce models</h2>

<h3>Description</h3>

<p>Perform posterior predictive check to assess the goodness-of-fit of Bayesian mixtures of Plackett-Luce models with a different number of components.
</p>


<h3>Usage</h3>

<pre><code class="language-R">ppcheckPLMIX(pi_inv, seq_G, MCMCsampleP, MCMCsampleW, top1 = TRUE,
  paired = TRUE, parallel = FALSE)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>pi_inv</code></td>
<td>
<p>An object of class <code>top_ordering</code>, collecting the numeric <code class="reqn">N</code><code class="reqn">\times</code><code class="reqn">K</code> data matrix of partial orderings, or an object that can be coerced with <code>as.top_ordering</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>seq_G</code></td>
<td>
<p>Numeric vector with the number of components of the Plackett-Luce mixtures to be assessed.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>MCMCsampleP</code></td>
<td>
<p>List of size <code>length(seq_G)</code>, whose generic element is a numeric <code class="reqn">L</code><code class="reqn">\times</code><code class="reqn">(G*K)</code> matrix with the MCMC samples of the component-specific support parameters.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>MCMCsampleW</code></td>
<td>
<p>List of size <code>length(seq_G)</code>, whose generic element is a numeric <code class="reqn">L</code><code class="reqn">\times</code><code class="reqn">G</code> matrix with the MCMC samples of the mixture weights.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>top1</code></td>
<td>
<p>Logical: whether the posterior predictive <code class="reqn">p</code>-value based on the top item frequencies has to be computed. Default is <code>TRUE</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>paired</code></td>
<td>
<p>Logical: whether the posterior predictive <code class="reqn">p</code>-value based on the paired comparison frequencies has to be computed. Default is <code>TRUE</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>parallel</code></td>
<td>
<p>Logical: whether parallelization should be used. Default is <code>FALSE</code>.</p>
</td>
</tr>
</table>
<h3>Details</h3>

<p>The <code>ppcheckPLMIX</code> function returns two posterior predictive <code class="reqn">p</code>-values based on two chi squared discrepancy variables involving: (i) the top item frequencies and (ii) the paired comparison frequencies. In the presence of partial sequences in the <code>pi_inv</code> matrix, the same missingness patterns observed in the dataset (i.e., the number of items ranked by each sample unit) are reproduced on the replicated datasets from the posterior predictive distribution.
</p>


<h3>Value</h3>

<p>A list with a named element:
</p>
<table><tr style="vertical-align: top;">
<td><code>post_pred_pvalue</code></td>
<td>
<p> Numeric <code>length(seq_G)</code><code class="reqn">\times</code><code class="reqn">2</code> matrix of posterior predictive <code class="reqn">p</code>-values based on the top item and paired comparison frequencies. If either <code>top1</code> or <code>paired</code> argument is <code>FALSE</code>, the corresponding matrix entries are <code>NA</code>.</p>
</td>
</tr></table>
<h3>Author(s)</h3>

<p>Cristina Mollica and Luca Tardella
</p>


<h3>References</h3>

<p>Mollica, C. and Tardella, L. (2017). Bayesian Plackett-Luce mixture models for partially ranked data. <em>Psychometrika</em>, <b>82</b>(2), pages 442â€“458, ISSN: 0033-3123, DOI: 10.1007/s11336-016-9530-0.
</p>


<h3>See Also</h3>

<p><code>ppcheckPLMIX_cond</code>
</p>


<h3>Examples</h3>

<pre><code class="language-R">
data(d_carconf)
K &lt;- ncol(d_carconf)

## Fit 1- and 2-component PL mixtures via MAP estimation
MAP_1 &lt;- mapPLMIX_multistart(pi_inv=d_carconf, K=K, G=1, 
                             n_start=2, n_iter=400*1)

MAP_2 &lt;- mapPLMIX_multistart(pi_inv=d_carconf, K=K, G=2, 
                             n_start=2, n_iter=400*2)
                                   
MAP_3 &lt;- mapPLMIX_multistart(pi_inv=d_carconf, K=K, G=3, 
                             n_start=2, n_iter=400*3)
                                   
mcmc_iter &lt;- 30
burnin &lt;- 10

## Fit 1- and 2-component PL mixtures via Gibbs sampling procedure
GIBBS_1 &lt;- gibbsPLMIX(pi_inv=d_carconf, K=K, G=1, n_iter=mcmc_iter, 
                      n_burn=burnin, init=list(p=MAP_1$mod$P_map,
                      z=binary_group_ind(MAP_1$mod$class_map,G=1)))
GIBBS_2 &lt;- gibbsPLMIX(pi_inv=d_carconf, K=K, G=2, n_iter=mcmc_iter, 
                      n_burn=burnin, init=list(p=MAP_2$mod$P_map,
                      z=binary_group_ind(MAP_2$mod$class_map,G=2)))
GIBBS_3 &lt;- gibbsPLMIX(pi_inv=d_carconf, K=K, G=3, n_iter=mcmc_iter, 
                      n_burn=burnin, init=list(p=MAP_3$mod$P_map,
                      z=binary_group_ind(MAP_3$mod$class_map,G=3)))
                            
## Checking goodness-of-fit of the estimated mixtures
CHECK &lt;- ppcheckPLMIX(pi_inv=d_carconf, seq_G=1:3, 
                      MCMCsampleP=list(GIBBS_1$P, GIBBS_2$P, GIBBS_3$P), 
                      MCMCsampleW=list(GIBBS_1$W, GIBBS_2$W, GIBBS_3$W))
CHECK$post_pred_pvalue

</code></pre>


</div>