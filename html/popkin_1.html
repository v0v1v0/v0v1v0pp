<div class="container">

<table style="width: 100%;"><tr>
<td>popkin-package</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>A package for estimating kinship and FST under arbitrary population structure</h2>

<h3>Description</h3>

<p>The heart of this package is the <code>popkin()</code> function, which estimates the kinship matrix of all individual pairs from their genotype matrix.
Inbreeding coefficients, the generalized <code>FST</code>, and the individual-level pairwise <code>FST</code> matrix are extracted from the kinship matrix using <code>inbr()</code>, <code>fst()</code>, and <code>pwfst()</code>, respectively.
<code>fst()</code> accepts weights for individuals to balance subpopulations obtained with <code>weights_subpops()</code>.
Kinship matrices can be renormalized (to change the most recent common ancestor population or MRCA) using <code>rescale_popkin()</code>.
Coancestry matrices can be estimated from allele frequency matrices using <code>popkin_af()</code>.
Lastly, kinship, coancestry, and pairwise FST matrices can be visualized using <code>plot_popkin()</code> (with the help of <code>inbr_diag()</code> for kinship matrices only).
</p>


<h3>Author(s)</h3>

<p><strong>Maintainer</strong>: Alejandro Ochoa <a href="mailto:alejandro.ochoa@duke.edu">alejandro.ochoa@duke.edu</a> (<a href="https://orcid.org/0000-0003-4928-3403">ORCID</a>)
</p>
<p>Authors:
</p>

<ul><li>
<p> John D. Storey <a href="mailto:jstorey@princeton.edu">jstorey@princeton.edu</a> (<a href="https://orcid.org/0000-0001-5992-402X">ORCID</a>)
</p>
</li></ul>
<h3>See Also</h3>

<p>Useful links:
</p>

<ul>
<li> <p><a href="https://github.com/StoreyLab/popkin/">https://github.com/StoreyLab/popkin/</a>
</p>
</li>
<li>
<p> Report bugs at <a href="https://github.com/StoreyLab/popkin/issues">https://github.com/StoreyLab/popkin/issues</a>
</p>
</li>
</ul>
<h3>Examples</h3>

<pre><code class="language-R"># estimate and visualize kinship and FST from a genotype matrix

# Construct toy data
X &lt;- matrix(c(0,1,2,1,0,1,1,0,2), nrow = 3, byrow = TRUE) # genotype matrix
subpops &lt;- c(1,1,2) # subpopulation assignments for individuals
subpops2 &lt;- 1:3 # alternate labels treat every individual as a different subpop

# NOTE: for BED-formatted input, use BEDMatrix!
# "file" is path to BED file (excluding .bed extension)
## library(BEDMatrix)
## X &lt;- BEDMatrix(file) # load genotype matrix object

# estimate the kinship matrix from the genotypes "X"!
# all downstream analysis require "kinship", none use "X" after this
kinship &lt;- popkin(X, subpops) # calculate kinship from X and optional subpop labels

# plot the kinship matrix, marking the subpopulations
# note inbr_diag replaces the diagonal of kinship with inbreeding coefficients
plot_popkin( inbr_diag(kinship), labs = subpops )

# extract inbreeding coefficients from kinship
inbreeding &lt;- inbr(kinship)

# estimate FST
weights &lt;- weights_subpops(subpops) # weigh individuals so subpopulations are balanced
Fst &lt;- fst(kinship, weights) # use kinship matrix and weights to calculate fst
Fst &lt;- fst(inbreeding, weights) # estimate more directly from inbreeding vector (same result)

# estimate and visualize the pairwise FST matrix
pairwise_fst &lt;- pwfst(kinship) # estimated matrix
leg_title &lt;- expression(paste('Pairwise ', F[ST])) # fancy legend label
# NOTE no need for inbr_diag() here!
plot_popkin(pairwise_fst, labs = subpops, leg_title = leg_title)

# rescale the kinship matrix using different subpopulations (implicitly changes the MRCA)
kinship2 &lt;- rescale_popkin(kinship, subpops2)

# toy allele frequency data
P &lt;- matrix( runif( 9 ), nrow = 3 )

# estimate coancestry from allele frequency matrix
# (useful from P matrices from admixture models)
coancestry &lt;- popkin_af( P )

</code></pre>


</div>