<div class="container">

<table style="width: 100%;"><tr>
<td>power.tsd.p</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>
Power calculation of adaptive 2-stage BE studies in 2-group parallel designs
</h2>

<h3>Description</h3>

<p>This functions calculate the ‘empirical’ power of 2-stage BE studies
with 2 parallel groups according to Fuglsang 2014 via simulations. The Potvin decision
schemes are modified to include a futility criterion Nmax, a minimum number of
subjects to be included in stage 2 and to allow the sample size estimation
step to be done with point estimate and variabilities from
stage 1 (fully adaptive).<br><br>
Function <code style="white-space: pre;">⁠power.tsd.pAF()⁠</code> performes exactly as described in
Fuglsang’s paper, namely the power monitoring steps and the sample
size estimation are based always on the pooled <em>t</em>-test.<br><br>
Function <code>power.tsd.p()</code> with argument <code style="white-space: pre;">⁠test="welch"⁠</code> on the
other hand uses the genuine power of Welch’s test. Moreover it
accepts unequal treatment groups in stage 1.
</p>


<h3>Usage</h3>

<pre><code class="language-R">power.tsd.p(method = c("B", "C"), alpha0 = 0.05, alpha = c(0.0294, 0.0294),
            n1, GMR, CV, targetpower = 0.8, pmethod = c("nct", "exact", "shifted"),
            usePE = FALSE, Nmax = Inf, min.n2=0, test = c("welch", "t-test", "anova"),
            theta0, theta1, theta2, npct = c(0.05, 0.5, 0.95), nsims,
            setseed = TRUE, details = FALSE)

power.tsd.pAF(method = c("B", "C"), alpha0 = 0.05, alpha = c(0.0294, 0.0294),
              n1, GMR, CV, targetpower = 0.8, pmethod = c("shifted", "nct", "exact"),
              usePE = FALSE, Nmax = Inf, test = c("welch", "t-test", "anova"),
              theta0, theta1, theta2, npct = c(0.05, 0.5, 0.95), nsims,
              setseed = TRUE, details = FALSE)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>method</code></td>
<td>

<p>Decision schemes according to Potvin <em>et.al.</em> (defaults to <code style="white-space: pre;">⁠"B"⁠</code>).<br>
Potvin’s ‘method D’ can be obtained by choosing <code style="white-space: pre;">⁠"C"⁠</code> but
setting <code style="white-space: pre;">⁠alpha=c(0.028, 0.028)⁠</code>.
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>alpha0</code></td>
<td>

<p>Alpha value for the first step(s) in Potvin <code style="white-space: pre;">⁠"C"⁠</code>, the power inspection
and BE decision if power &gt; targetpower.<br>
Defaults to 0.05.
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>alpha</code></td>
<td>

<p>Vector (two elements) of the nominal alphas for the two stages.<br>
Defaults to Pocock’s alpha setting <code style="white-space: pre;">⁠alpha=c(0.0294, 0.0294)⁠</code>.
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>n1</code></td>
<td>

<p>Sample size of stage 1.<br>
Function <code style="white-space: pre;">⁠power.tsd.p()⁠</code> accepts also a vector of
stage 1 sample sizes with two elements,
where the number of subjects in the in treatment group <em>T</em> should be
given in the first element and the number of subjects in the treatment
group <em>R</em> in the second.<br>
If given with one element, the total <code style="white-space: pre;">⁠n1⁠</code> should be even.
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>GMR</code></td>
<td>

<p>Ratio T/R to be used in decision scheme (power calculations in
stage 1 and sample size estimation for
stage 2).
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>CV</code></td>
<td>

<p>Coefficient of variation of the total variability
(use <em>e.g.</em>, 0.3 for 30%)<br>
Can be a vector with two elements. In that case <code style="white-space: pre;">⁠CV[1]⁠</code> is for the group
under the Test treatment and <code style="white-space: pre;">⁠CV[2]⁠</code> for the group under the Reference.
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>targetpower</code></td>
<td>

<p>Power threshold in the power monitoring steps and power to achieve
in the sample size estimation step.
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>pmethod</code></td>
<td>

<p>Power calculation method, also to be used in the sample size estimation for
stage 2.<br>
Implemented are <code style="white-space: pre;">⁠"nct"⁠</code> (approximate calculations via non-central
<em>t</em>-distribution, <code style="white-space: pre;">⁠"exact"⁠</code> (exact calculations via Owen’s Q),
and <code style="white-space: pre;">⁠"shifted"⁠</code> (approximate calculation via shifted central
<em>t</em>-distribution<br>
Defaults to <code style="white-space: pre;">⁠"nct"⁠</code> for speed reasons in function <code style="white-space: pre;">⁠power.tsd.p()⁠</code>
as a reasonable compromise between speed and accuracy in the sample size
estimation step.<br>
Defaults to <code style="white-space: pre;">⁠"shifted"⁠</code> in function <code style="white-space: pre;">⁠power.tsd.pAF()⁠</code> for
consistancy with Fuglsang.<br></p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>usePE</code></td>
<td>

<p>If <code style="white-space: pre;">⁠TRUE⁠</code> the sample size estimation step is done with <abbr><span class="acronym">MSE</span></abbr>
<b>and</b> <abbr><span class="acronym">PE</span></abbr> of stage 1.<br>
Defaults to <code>FALSE</code> <em>i.e.</em>, the sample size is estimated with
<code style="white-space: pre;">⁠GMR⁠</code> and <abbr><span class="acronym">MSE</span></abbr> (calculated from <code style="white-space: pre;">⁠CV⁠</code>) of
stage 1 analogous to Potvin <em>et. al</em>.<br>
NB: The power inspection steps in the Potvin methods are always done with the
<code style="white-space: pre;">⁠GMR⁠</code> argument and <abbr><span class="acronym">MSE</span></abbr> (<code style="white-space: pre;">⁠CV⁠</code>) of
stage 1.
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>Nmax</code></td>
<td>

<p>Futility criterion. If set to a finite value, all studies simulated in which a
sample size <code style="white-space: pre;">⁠&gt;Nmax⁠</code> is obtained will be regarded as BE=FAIL.<br>
Set this argument to <code style="white-space: pre;">⁠Inf⁠</code>, the default, to work without that futility
criterion.
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>min.n2</code></td>
<td>

<p>Minimum sample size of stage 2.<br>
If the sample size estimation step gives <code style="white-space: pre;">⁠N &lt; n1+min.n2⁠</code> the sample size for
stage 2 will be forced to <code style="white-space: pre;">⁠min.n2⁠</code>,
<em>i.e.</em> the total sample size to <code>n1+min.n2</code>.<br>
Defaults to zero, <em>i.e.</em>, no minimum sample size for
stage 2 is applied.<br></p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>test</code></td>
<td>

<p>Test on which the CI calculations are based on.<br>
Defaults to <code style="white-space: pre;">⁠"welch"⁠</code> = Welch’s <em>t</em>-test accounting for
heteroscedasticity in the variabilities of Test and Reference, but neglecting
stage effects.<br><code style="white-space: pre;">⁠"anova"⁠</code> calculates the
100(1–2α)
confidence interval based on an <abbr><span class="acronym">ANOVA</span></abbr> with treatment and stage
in the model.<br><code style="white-space: pre;">⁠"t-test"⁠</code> calculates the
100(1–2α)
confidence interval based on the <em>t</em>-test assuming equal
variabilities of Test and Reference and neglecting stage effects.
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>theta0</code></td>
<td>

<p>Assumed ratio of geometric means (T/R) for simulations. If missing,
defaults to <code style="white-space: pre;">⁠GMR⁠</code>.
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>theta1</code></td>
<td>

<p>Lower bioequivalence limit. Defaults to 0.8.
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>theta2</code></td>
<td>

<p>Upper bioequivalence limit. Defaults to 1.25.
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>npct</code></td>
<td>

<p>Percentiles to be used for the presentation of the distribution of
<code style="white-space: pre;">⁠n(total)=n1+n2⁠</code>.<br>
Defaults to <code style="white-space: pre;">⁠c(0.05, 0.5, 0.95)⁠</code> to obtain the 5% and 95% percentiles
and the median.
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>nsims</code></td>
<td>

<p>Number of studies to simulate.<br>
If missing, <code style="white-space: pre;">⁠nsims⁠</code> is set to 1E+05 = 100,000 or to 1E+06 = 1 Mio if
estimating the empiric Type I Error (<code style="white-space: pre;">⁠'alpha'⁠</code>), <em>i.e.</em>, with <code style="white-space: pre;">⁠theta0⁠</code> at
the border or outside the acceptance range <code style="white-space: pre;">⁠theta1⁠</code> ... <code style="white-space: pre;">⁠theta2⁠</code>.
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>setseed</code></td>
<td>

<p>Simulations are dependent on the starting point of the (pseudo) random number
generator. To avoid differences in power for different runs a
<code>set.seed(1234567)</code> is issued if <code style="white-space: pre;">⁠setseed=TRUE⁠</code>, the default.<br>
Set this argument to <code style="white-space: pre;">⁠FALSE⁠</code> to view the variation in power between
different runs.
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>details</code></td>
<td>

<p>If set to <code style="white-space: pre;">⁠TRUE⁠</code> the function prints the results of time measurements
of the simulation steps. Defaults to <code style="white-space: pre;">⁠FALSE⁠</code>.
</p>
</td>
</tr>
</table>
<h3>Details</h3>

<p>The calculations follow in principle the simulations as described by Fuglsang.<br>
The underlying subject data are assumed to be evaluated after log-transformation.
But instead of simulating subject data the statistics (mean and variance of Test
and Reference of stage 1 and
stage 2) are simulated via their associated
distributions (normal and χ<sup>2</sup>).
</p>


<h3>Value</h3>

<p>Returns an object of class <code style="white-space: pre;">⁠"pwrtsd"⁠</code> with all the input arguments and results
as components.<br>
The class <code style="white-space: pre;">⁠"pwrtsd"⁠</code> has an S3 print method.<br>
The results are in the components:
</p>
<table>
<tr style="vertical-align: top;">
<td><code>pBE</code></td>
<td>
<p>Fraction of studies found BE.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>pBE_s1</code></td>
<td>
<p>Fraction of studies found BE in stage 1.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>pct_s2</code></td>
<td>
<p>Percentage of studies continuing to stage 2.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>nmean</code></td>
<td>
<p>Mean of n(total).</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>nrange</code></td>
<td>
<p>Range (min, max) of n(total).</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>nperc</code></td>
<td>
<p>Percentiles of the distribution of n(total).</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>ntable</code></td>
<td>
<p>Object of class <code style="white-space: pre;">⁠"table"⁠</code> summarizing the discrete distribution of
n(total) via its distinct values and counts of occurences of these values.
This component is only given back if <code style="white-space: pre;">⁠usePE==FALSE⁠</code> or otherwise if
<code style="white-space: pre;">⁠is.finite(Nmax)⁠</code>, <em>i.e.</em>, a futility criterion is used.</p>
</td>
</tr>
</table>
<h3>Author(s)</h3>

<p>D. Labes
</p>


<h3>References</h3>

<p>Fuglsang A. <em>Sequential Bioequivalence Approaches for Parallel Design.</em><br>
AAPS J. 2014; 16(3):373–8. doi: <a href="https://doi.org/10.1208/s12248-014-9571-1">10.1208/s12248-014-9571-1</a>
</p>
<p>Potvin D, DiLiberti CE, Hauck WW, Parr AF, Schuirmann DJ, Smith RA. <em>Sequential design approaches for bioequivalence studies with crossover designs.</em><br>
Pharm Stat. 2008; 7(4):245–62. doi: <a href="https://doi.org/10.1002/pst.294">10.1002/pst.294</a>
</p>


<h3>See Also</h3>

<p><code>power.2stage</code> for analogous calculations for the 2×2 crossover.
</p>


<h3>Examples</h3>

<pre><code class="language-R"># using all the defaults
power.tsd.p(n1=48, CV=0.25)
</code></pre>


</div>