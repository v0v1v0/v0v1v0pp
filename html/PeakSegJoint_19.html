<div class="container">

<table style="width: 100%;"><tr>
<td>PeakSegJointFaster</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>PeakSegJointFaster</h2>

<h3>Description</h3>

<p>Run the PeakSegJointFaster heuristic optimization algorithm, for
several bin.factor parameter values, keeping only the most likely
model found. This gives an approximate solution to a multi-sample
Poisson maximum likelihood segmentation problem. Given S samples,
this function computes a sequence of S+1 PeakSegJoint models, with
0, ..., S samples with an overlapping peak (maximum of one peak
per sample). It also computes for G groups, the seq of G+1
models, with 0, ..., G groups with an overlapping peak.</p>


<h3>Usage</h3>

<pre><code class="language-R">PeakSegJointFaster(profiles, 
    bin.factor.vec = 2:7)</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>profiles</code></td>
<td>
<p>data.frame with columns sample.id, sample.group, chromStart,
chromEnd, count.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>bin.factor.vec</code></td>
<td>
<p>Size of bin pyramid. Bigger values result in slower computation.</p>
</td>
</tr>
</table>
<h3>Value</h3>

<p>List of model fit results.</p>


<h3>Author(s)</h3>

<p>Toby Dylan Hocking &lt;toby.hocking@r-project.org&gt; [aut, cre]</p>


<h3>Examples</h3>

<pre><code class="language-R">
library(PeakSegJoint)
data(H3K36me3.TDH.other.chunk1, envir=environment())
some.counts &lt;- subset(
  H3K36me3.TDH.other.chunk1$counts,
  43000000 &lt; chromEnd &amp;
  chromStart &lt; 43200000)
some.counts$sample.group &lt;- some.counts$cell.type

fit &lt;- PeakSegJointFaster(some.counts, 2:7)

if(interactive() &amp;&amp; require(ggplot2)){

  both &lt;- with(fit, rbind(
    data.frame(model="sample", sample.modelSelection),
  data.frame(model="group", group.modelSelection)))
  ggplot()+
    ggtitle("model selection functions")+
    scale_size_manual(values=c(sample=2, group=1))+
    geom_segment(aes(min.log.lambda, complexity,
                     color=model, size=model,
                     xend=max.log.lambda, yend=complexity),
                 data=both)+
    xlab("log(penalty)")+
    ylab("model complexity (samples or groups with a common peak)")

}

</code></pre>


</div>