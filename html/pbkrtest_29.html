<div class="container">

<table style="width: 100%;"><tr>
<td>kr_modcomp</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>F-test and degrees of freedom based on Kenward-Roger approximation</h2>

<h3>Description</h3>

<p>An approximate F-test based on the Kenward-Roger approach.
</p>


<h3>Usage</h3>

<pre><code class="language-R">KRmodcomp(largeModel, smallModel, betaH = 0, details = 0)

## S3 method for class 'lmerMod'
KRmodcomp(largeModel, smallModel, betaH = 0, details = 0)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>largeModel</code></td>
<td>
<p>An <code>lmer</code> model</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>smallModel</code></td>
<td>
<p>An <code>lmer</code> model or a restriction matrix</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>betaH</code></td>
<td>
<p>A number or a vector of the beta of the hypothesis,
e.g. L beta=L betaH. If <code>smallModel</code> is a model object then betaH=0.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>details</code></td>
<td>
<p>If larger than 0 some timing details are printed.</p>
</td>
</tr>
</table>
<h3>Details</h3>

<p>An F test is calculated according to the approach of Kenward and
Roger (1997).  The function works for linear mixed models fitted
with the lmer() function of the <code>lme4</code> package. Only models where
the covariance structure is a linear combination (a weighted sum)
of known matrices can be compared.
</p>
<p>The <code>smallModel</code> is the model to be tested against the <code>largeModel</code>.
</p>
<p>The <code>largeModel</code> is a model fitted with <code>lmer()</code>. A technical
detail: The model must be fitted with <code>REML=TRUE</code>. If the model is
fitted with <code>REML=FALSE</code> then the model is refitted with
<code>REML=TRUE</code> before the p-values are calculated. Put differently,
the user needs not worry about this issue.
</p>
<p>The <code>smallModel</code> can be one of several things:
</p>

<ol>
<li>
<p> a model fitted with <code>lmer()</code>. It must have the same covariance
structure as <code>largeModel</code>. Furthermore, its linear space of
expectation must be a subspace of the space for <code>largeModel</code>.
</p>
</li>
<li>
<p> a restriction matrix <code>L</code> specifying the hypothesis
</p>
<p style="text-align: center;"><code class="reqn">L \beta = L \beta_H</code>
</p>

<p>where <code>L</code> is a <code style="white-space: pre;">⁠k x p⁠</code> matrix (there are k restrictions and p is
the number of fixed effect parameters (the length of
<code>fixef(largeModel)</code>) and <code>beta_H</code> is a p column vector.
</p>
</li>
<li>
<p> A formula or a text string specifying what is to be removed from the
larger model to form the smaller model.
</p>
</li>
</ol>
<p>Notice: if you want to test a hypothesis
</p>
<p style="text-align: center;"><code class="reqn">L \beta = c</code>
</p>

<p>with a <code class="reqn">k</code> vector <code class="reqn">c</code>, a suitable <code class="reqn">\beta_H</code> is obtained
via <code class="reqn">\beta_H=L c</code> where <code class="reqn">L_n</code> is a g-inverse of <code class="reqn">L</code>.
</p>
<p>Notice: It cannot be guaranteed that the results agree with other
implementations of the Kenward-Roger approach!
</p>


<h3>Author(s)</h3>

<p>Ulrich Halekoh <a href="mailto:uhalekoh@health.sdu.dk">uhalekoh@health.sdu.dk</a>, Søren Højsgaard
<a href="mailto:sorenh@math.aau.dk">sorenh@math.aau.dk</a>
</p>


<h3>References</h3>

<p>Ulrich Halekoh, Søren Højsgaard (2014)., A
Kenward-Roger Approximation and Parametric Bootstrap Methods
for Tests in Linear Mixed Models - The R Package pbkrtest.,
Journal of Statistical Software, 58(10), 1-30.,
<a href="https://www.jstatsoft.org/v59/i09/">https://www.jstatsoft.org/v59/i09/</a>
</p>
<p>Kenward, M. G. and Roger, J. H. (1997), <em>Small Sample Inference for
Fixed Effects from Restricted Maximum Likelihood</em>, Biometrics 53: 983-997.
</p>


<h3>See Also</h3>

<p><code>getKR</code>, <code>lmer</code>,
<code>vcovAdj</code>, <code>PBmodcomp</code>,
<code>SATmodcomp</code>
</p>


<h3>Examples</h3>

<pre><code class="language-R">
(fm0 &lt;- lmer(Reaction ~ (Days|Subject), sleepstudy))
(fm1 &lt;- lmer(Reaction ~ Days + (Days|Subject), sleepstudy))
(fm2 &lt;- lmer(Reaction ~ Days + I(Days^2) + (Days|Subject), sleepstudy))

## Test for no effect of Days in fm1, i.e. test fm0 under fm1
KRmodcomp(fm1, "Days")
KRmodcomp(fm1, ~.-Days)
L1 &lt;- cbind(0, 1) 
KRmodcomp(fm1, L1)
KRmodcomp(fm1, fm0)
anova(fm1, fm0)

## Test for no effect of Days and Days-squared in fm2, i.e. test fm0 under fm2
KRmodcomp(fm2, "(Days+I(Days^2))")
KRmodcomp(fm2, ~. - Days - I(Days^2))
L2 &lt;- rbind(c(0, 1, 0), c(0, 0, 1))
KRmodcomp(fm2, L2)
KRmodcomp(fm2, fm0)
anova(fm2, fm0)

## Test for no effect of Days-squared in fm2, i.e. test fm1 under fm2
KRmodcomp(fm2, "I(Days^2)")
KRmodcomp(fm2, ~. - I(Days^2))
L3 &lt;- rbind(c(0, 0, 1))
KRmodcomp(fm2, L3)
KRmodcomp(fm2, fm1)
anova(fm2, fm1)
</code></pre>


</div>