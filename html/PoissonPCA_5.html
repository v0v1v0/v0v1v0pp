<div class="container">

<table style="width: 100%;"><tr>
<td>makelogtransformation</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>constructs a log transformation for use with functions
from the PoissoncorrectedPCA package.

</h2>

<h3>Description</h3>

<p>When we are dealing with a transformation of the latent
Poisson mean Lambda, we need various useful functions. This function
computes the necessary functions for the log transformation, and returns a list of the required functions.

</p>


<h3>Usage</h3>

<pre><code class="language-R">makelogtransformation(a,N,uselog=6,unbiassed=TRUE)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>a</code></td>
<td>
<p>The point about which to expand the Taylor series (see details)</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>N</code></td>
<td>
<p>The number of terms in the Taylor series to expand (see
details)</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>uselog</code></td>
<td>
<p>Value above which we use the logarithm to approximate
g(x). Typically should not be larger than 2a.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>unbiassed</code></td>
<td>
<p>Indicates that the recommended unbiassed method
should be used.</p>
</td>
</tr>
</table>
<h3>Details</h3>

<p>The logarithmic transformation is fundamentally unestimable. There is
no estimator which is an unbiassed estimator for log(Lambda). This is
because the logarithm function has a singularity at zero, so has no
globally convergent Taylor series expansion. Instead, we aim to use an
approximately unbiassed estimator. For large enough X, g(X)=log(X) is
a reasonable estimator. For smaller X, we need to compute a Taylor
series for exp(-Lambda)log(Lambda). We do this from the equation
log(x)=log(a)+log(x/a) and the Taylor expansion
log(1+y)=y-y^2/2+y^3/3-... where y=x/a-1. This has radius of
convergence 1, so will converge provided 0&lt;x&lt;2a. However, if we try to
convert it to a polynomial in x, the coefficients will
diverge. Instead, we truncate this Taylor series in y at a chosen
number N terms. If the x is close to a, this truncated Taylor series
should give an approximately unbiassed estimator for log(Lambda).
Choice of N can have some effect. Larger values of N reduce the bias
of g(X) but increase the variance. Experimentally, a=3 and N=6 seem to
produce reasonable results, with g(X)=log(X) for X&gt;6.
</p>


<h3>Value</h3>

<table>
<tr style="vertical-align: top;">
<td><code>type</code></td>
<td>
<p>="log"</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>f</code></td>
<td>
<p>function which evaluates the transformation</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>g</code></td>
<td>
<p>an estimator for the transformation of a latent Poisson mean</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>solve</code></td>
<td>
<p>function which computes the inverse transformation (often used for simulations)</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>ECVar</code></td>
<td>
<p>an estimator for the average conditional variance of g(X)</p>
</td>
</tr>
</table>
<h3>Author(s)</h3>

<p>Toby Kenney <a href="mailto:tkenney@mathstat.dal.ca">tkenney@mathstat.dal.ca</a> and Tianshu Huang</p>


<h3>Examples</h3>

<pre><code class="language-R">
logtrans&lt;-makelogtransformation(5,6)
X&lt;-rpois(100,exp(1.4))
gX&lt;-X
for(i in 1:100){
gX[i]&lt;-logtrans$g(X[i])
}
mean(gX)
var(gX)
logtrans$ECVar(X)

</code></pre>


</div>