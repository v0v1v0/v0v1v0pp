<div class="container">

<table style="width: 100%;"><tr>
<td>getResiduals</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>Residuals from the GBLUP</h2>

<h3>Description</h3>

<p>Residuals from the best linear unbiased predictor of the genetic effects (GBLUP), which is computed given REML-estimates of the variance components.
</p>


<h3>Usage</h3>

<pre><code class="language-R"> getResiduals(suffStat, covariates = NULL, cov.method = "uni", K = NULL) </code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>suffStat</code></td>
<td>
<p>A data.frame, of which the first column is the factor G (genotype),  and subsequent columns contain the traits. The name of the first column should be G. </p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>covariates</code></td>
<td>
<p>A data.frame containing covariates, that should always be used in each conditional independence test. Should be either <code>NULL</code> (default) or a data.frame with the same number of rows as suffStat. An intercept is already included for each trait in suffStat; covariates should not contain a column of ones.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>cov.method</code></td>
<td>
<p>(A string, specifying which method should be used to compute the GBLUP. Options are <code>"us"</code> (unstructured multi-trait model fitted using sommer) and <code>"uni"</code> (based on univariate GBLUPs). Default is <code>"uni"</code>). </p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>K</code></td>
<td>
<p>A genetic relatedness matrix. If <code>NULL</code> (default), independent genetic effects are assumed.</p>
</td>
</tr>
</table>
<h3>Details</h3>

<p>If <code>cov.method = "uni"</code>, the GBLUP and the residuals are computed separately for each trait in suffStat. The covariance of each trait is then assumed to be </p>
<p style="text-align: center;"><code class="reqn">\sigma_G^2 Z K Z^t + \sigma_E^2 I_n</code>
</p>
<p> where <code class="reqn">Z</code> is a binary incidence matrix, assigning plants or plots to genotypes. <code class="reqn">Z</code> is based on the first column in <code>suffStat</code>. If there is a single observation per genotype (typically a genotypic mean), <code class="reqn">Z</code> is the identity matrix, and the relatedness matrix <code class="reqn">K</code> should be specified. If there are replicates for at least some of the genotypes, and no <code class="reqn">K</code> is provided, independent genetic effects are assumed (<code class="reqn">K</code> will be the identity matrix). It is also possible to have replicates and specify a non-diagonal <code class="reqn">K</code>.
Whenever <code class="reqn">K</code> is specified, sommer (mmer2) will be used; otherwise lmer (lme4). The mmer2 is also used when <code>cov.method = "us"</code>, in which case the multivariate GBLUP is computed, for all traits in <code>suffStat</code> simultaneously. This is only possible for a limited number of traits.
</p>


<h3>Value</h3>

<p> A data-frame with the residuals.</p>


<h3>Author(s)</h3>

<p>Willem Kruijer and Pariya Behrouzi.
Maintainers: Willem Kruijer <a href="mailto:willem.kruijer@wur.nl">willem.kruijer@wur.nl</a> and
Pariya Behrouzi <a href="mailto:pariya.behrouzi@gmail.com">pariya.behrouzi@gmail.com</a>
</p>


<h3>References</h3>

<p>Covarrubias-Pazaran, G., 2016. Genome-assisted prediction of quantitative traits using the R package sommer. PloS one, 11(6), p.e0156744. <br></p>


<h3>Examples</h3>

<pre><code class="language-R">
data(simdata)
rs &lt;- getResiduals(suffStat= simdata)

</code></pre>


</div>