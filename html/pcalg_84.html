<div class="container">

<table style="width: 100%;"><tr>
<td>pag2anc</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>Reads off identifiable ancestors and non-ancestors from a directed PAG</h2>

<h3>Description</h3>

<p>Constructs a matrix which contains identifiable ancestral and
non-ancestral relations in the Markov equivalence class represented
by a directed partial ancestral graph.
</p>


<h3>Usage</h3>

<pre><code class="language-R">pag2anc(P,verbose=FALSE)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>P</code></td>
<td>
<p>Adjacency matrix of type amat.pag, which should encode
a directed PAG (i.e., it should not contain any undirected edges of the
form <code>x --- y</code> or any circle-tail edges of the form <code>x o-- y</code>).</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>verbose</code></td>
<td>
<p>If true, more detailed output is provided.</p>
</td>
</tr>
</table>
<h3>Details</h3>

<p>We say that node <code>i</code> is ancestor of node <code>j</code> in a directed mixed graph (DMG) iff there
exists a directed path from <code>i</code> to <code>j</code> in that graph. If the directed mixed graph
has a causal interpretation (for example, if it is the graph of a simple SCM) then ancestral
relations coincide (generically) with causal relations.
</p>
<p>This function implements the sufficient conditions (Propositions 4 and 5) in Mooij and Claassen (2020) 
for concluding whether an ancestral relation between two nodes must be present or absent
in all directed mixed graphs in the Markov equivalence class represented by the directed PAG <code>P</code>.
It applies to both the
acyclic case as well as the cyclic (simple SCM) case, assuming the d-separation resp. <code class="reqn">\sigma</code>-separation
Markov property.
</p>
<p>The output is a matrix containing for each ordered pair of nodes whether
the presence of an ancestral relation was identified, or the absence, or neither.
</p>
<p>It is not known whether these sufficient conditions for identifiability are complete. 
Hence, zero entries in the result indicate that the sufficient condition gives no 
conclusion, rather than that the Markov equivalence class represented by the directed PAG 
necessarily contains DMGs where an ancestral relation is present as well as DMGs where it is absent.
</p>
<p><code>P</code> should be an adjacency matrix of type amat.pag that contains no undirected
and circle-tail edges.
</p>


<h3>Value</h3>

<p>Matrix <code>A</code>, where entry <code>A[i,j]</code> equals </p>

<dl>
<dt>1</dt>
<dd>
<p>if node <code>i</code> is an identifiable ancestor of node <code>j</code>,</p>
</dd>
<dt>-1</dt>
<dd>
<p>if node <code>i</code> is an identifiable non-ancestor of node <code>j</code>,</p>
</dd>
<dt>0</dt>
<dd>
<p>in case the ancestral relationship between nodes <code>i</code> and <code>j</code> is unknown.</p>
</dd>
</dl>
<h3>Author(s)</h3>

<p>Joris Mooij.
</p>


<h3>References</h3>

<p>J. M. Mooij and T. Claassen (2020).
Constraint-Based Causal Discovery using Partial Ancestral Graphs in the presence of Cycles.
<em>In Proc. of the 36th Conference on Uncertainty in Artificial Intelligence (UAI-20)</em>, 1159-1168.
</p>


<h3>Examples</h3>

<pre><code class="language-R">##################################################
## Mooij et al. (2020), Fig. 43(a), p. 97
##################################################

# Encode ADMG as adjacency matrix
p &lt;- 8 # total number of variables
V &lt;- c("Ca","Cb","Cc","X0","X1","X2","X3","X4") # 3 context variables, 5 system variables
# amat[i,j] = 0 iff no edge btw i,j
# amat[i,j] = 1 iff i *-o j
# amat[i,j] = 2 iff i *-&gt; j
# amat[i,j] = 3 iff i *-- j
amat &lt;- rbind(c(0,2,2,2,0,0,0,0),
              c(2,0,2,0,2,0,0,0),
              c(2,2,0,0,2,2,0,0),
              c(3,0,0,0,0,0,2,0),
              c(0,3,3,0,0,3,0,2),
              c(0,0,3,0,2,0,0,0),
              c(0,0,0,3,0,0,0,2),
              c(0,0,0,0,2,0,3,0))
rownames(amat)&lt;-V
colnames(amat)&lt;-V

# Make use of d-separation oracle as "independence test"
indepTest &lt;- dsepAMTest
suffStat&lt;-list(g=amat,verbose=FALSE)

# Derive PAG that represents the Markov equivalence class of the ADMG with the FCI algorithm
# (assuming no selection bias)
fci.pag &lt;- fci(suffStat,indepTest,alpha = 0.5,labels = V,verbose=TRUE,selectionBias=FALSE)

# Read off causal features from the FCI PAG
cat('Identified absence (-1) and presence (+1) of ancestral causal relations from FCI PAG:\n')
print(pag2anc(fci.pag@amat))

</code></pre>


</div>