<div class="container">

<table style="width: 100%;"><tr>
<td>extract_probs</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>Extract edge selection frequency in bootstrap subsamples</h2>

<h3>Description</h3>

<p>Extracts edge selection frequency in networks reconstructed from bootstrap subsamples
during the stars stability selection procedure, as either a matrix or a named vector. In the latter
case, edge names follow igraph naming convention.
</p>


<h3>Usage</h3>

<pre><code class="language-R">extract_probs(
  Robject,
  penalty = NULL,
  index = NULL,
  crit = c("StARS", "BIC", "EBIC"),
  format = c("matrix", "vector"),
  tol = 1e-05
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>Robject</code></td>
<td>
<p>an object with class <code>PLNnetworkfamily</code>, i.e. an output from <code>PLNnetwork()</code></p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>penalty</code></td>
<td>
<p>penalty used for the bootstrap subsamples</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>index</code></td>
<td>
<p>Integer index of the model to be returned. Only the first value is taken into account.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>crit</code></td>
<td>
<p>a character for the criterion used to performed the selection. Either
"BIC", "ICL", "EBIC", "StARS", "R_squared". Default is <code>ICL</code> for <code>PLNPCA</code>, and <code>BIC</code> for <code>PLNnetwork</code>.
If StARS (Stability Approach to Regularization Selection) is chosen and stability selection
was not yet performed, the function will call the method <code>stability_selection()</code> with default argument.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>format</code></td>
<td>
<p>output format. Either a matrix (default) or a named vector.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>tol</code></td>
<td>
<p>tolerance for rounding error when comparing penalties.</p>
</td>
</tr>
</table>
<h3>Value</h3>

<p>Either a matrix or named vector of edge-wise probabilities. In the latter case, edge names follow igraph convention.
</p>


<h3>Examples</h3>

<pre><code class="language-R">data(trichoptera)
trichoptera &lt;- prepare_data(trichoptera$Abundance, trichoptera$Covariate)
nets &lt;- PLNnetwork(Abundance ~ 1 + offset(log(Offset)), data = trichoptera)
## Not run: 
stability_selection(nets)
probs &lt;- extract_probs(nets, crit = "StARS", format = "vector")
probs

## End(Not run)

## Not run: 
## Add edge attributes to graph using igraph
net_stars &lt;- getBestModel(nets, "StARS")
g &lt;- plot(net_stars, type = "partial_cor", plot=F)
library(igraph)
E(g)$prob &lt;- probs[as_ids(E(g))]
g

## End(Not run)

</code></pre>


</div>