<div class="container">

<table style="width: 100%;"><tr>
<td>pheno.ddm</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>Dense design matrix for phenological data</h2>

<h3>Description</h3>

<p>Creation of dense two-way classification design matrix.
The sum of the second factor is constrained to be zero. No general mean.
</p>


<h3>Usage</h3>

<pre><code class="language-R">pheno.ddm(D,na.omit=TRUE)</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>D</code></td>
<td>
<p>Data frame with three columns: (observations, factor 1, factor 2).</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>na.omit</code></td>
<td>
<p>Determined whether missing values should be omitted or not. Default is TRUE.</p>
</td>
</tr>
</table>
<h3>Details</h3>

<p>In phenological applications observations should be the julian day
of observation of a certain phase, factor 1 should be the observation year
and factor 2 should be a station-id.
Usually this is much easier created by:
<code>y &lt;- factor(f1),
	s &lt;- factor(f2),
	ddm &lt;- as.matrix.csr(model.matrix(~ y + s -1, contrasts=list(s=("contr.sum"))))</code>.
However, this procedure can be quite memory demanding and might exceed storage
capacity for large problems. 
This procedure here is much less memory comsuming.
Moreover, in order to get direct estimates for all coefficients, 
an additional row is appended to the matrix, where the columns for the second factor are set to 1.
Therefore, dimensions of <code>ddm</code> are (nlevels(factor1)+1)x(nlevels(factor2)).
</p>


<h3>Value</h3>

<table>
<tr style="vertical-align: top;">
<td><code>ddm</code></td>
<td>
<p>Dense roworder matrix, matrix.csr format (see matrix.csr in package SparseM)</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>D</code></td>
<td>
<p>Data frame D sorted first by f2 then by f1 and with rows containing NA's removed.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>na.rows</code></td>
<td>
<p>Rows in D that were omitted due to missing values.</p>
</td>
</tr>
</table>
<h3>Author(s)</h3>

<p>Joerg Schaber
</p>


<h3>See Also</h3>

<p><code>model.matrix</code>
<code>matrix.csr</code>
</p>


<h3>Examples</h3>

<pre><code class="language-R">	data(DWD)
	ddm1 &lt;- pheno.ddm(DWD)
	attach(DWD)
	y &lt;- factor(DWD[[2]])
	s &lt;- factor(DWD[[3]])
	ddm2 &lt;- as.matrix.csr(model.matrix(~ y + s -1, contrasts=list(s=("contr.sum"))))
	identical(ddm1$ddm,ddm2)
</code></pre>


</div>