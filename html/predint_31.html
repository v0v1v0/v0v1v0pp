<div class="container">

<table style="width: 100%;"><tr>
<td>quasi_bin_pi</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>Prediction intervals for quasi-binomial data</h2>

<h3>Description</h3>

<p><code>quasi_bin_pi()</code> calculates bootstrap calibrated prediction intervals for binomial
data with constant overdispersion (quasi-binomial assumption).
</p>


<h3>Usage</h3>

<pre><code class="language-R">quasi_bin_pi(
  histdat,
  newdat = NULL,
  newsize = NULL,
  alternative = "both",
  alpha = 0.05,
  nboot = 10000,
  delta_min = 0.01,
  delta_max = 10,
  tolerance = 0.001,
  traceplot = TRUE,
  n_bisec = 30,
  algorithm = "MS22mod"
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>histdat</code></td>
<td>
<p>a <code>data.frame</code> with two columns (success and failures) containing the historical data</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>newdat</code></td>
<td>
<p>a <code>data.frame</code> with two columns (success and failures) containing the future data</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>newsize</code></td>
<td>
<p>a vector containing the future cluster sizes</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>alternative</code></td>
<td>
<p>either "both", "upper" or "lower". <code>alternative</code>
specifies if a prediction interval or an upper or a lower prediction limit
should be computed</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>alpha</code></td>
<td>
<p>defines the level of confidence (1-alpha)</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>nboot</code></td>
<td>
<p>number of bootstraps</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>delta_min</code></td>
<td>
<p>lower start value for bisection</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>delta_max</code></td>
<td>
<p>upper start value for bisection</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>tolerance</code></td>
<td>
<p>tolerance for the coverage probability in the bisection</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>traceplot</code></td>
<td>
<p>if <code>TRUE</code>: Plot for visualization of the bisection process</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>n_bisec</code></td>
<td>
<p>maximal number of bisection steps</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>algorithm</code></td>
<td>
<p>either "MS22" or "MS22mod" (see details)</p>
</td>
</tr>
</table>
<h3>Details</h3>

<p>This function returns bootstrap-calibrated prediction intervals as well as
lower or upper prediction limits.
</p>
<p>If <code>algorithm</code> is set to "MS22", both limits of the prediction interval
are calibrated simultaneously using the algorithm described in Menssen and
Schaarschmidt (2022), section 3.2.4. The calibrated prediction interval is given
as
</p>
<p style="text-align: center;"><code class="reqn">[l,u]_m = n^*_m \hat{\pi} \pm q^{calib} \hat{se}(Y_m - y^*_m)</code>
</p>

<p>where
</p>
<p style="text-align: center;"><code class="reqn">\hat{se}(Y_m - y^*_m) = \sqrt{\hat{\phi} n^*_m \hat{\pi} (1- \hat{\pi}) +
\frac{\hat{\phi} n^{*2}_m \hat{\pi} (1- \hat{\pi})}{\sum_h n_h}}</code>
</p>

<p>with <code class="reqn">n^*_m</code> as the number of experimental units in the future clusters,
<code class="reqn">\hat{\pi}</code> as the estimate for the binomial proportion obtained from the
historical data, <code class="reqn">q^{calib}</code> as the bootstrap-calibrated coefficient,
<code class="reqn">\hat{\phi}</code> as the estimate for the dispersion parameter
and <code class="reqn">n_h</code> as the number of experimental units per historical cluster. <br></p>
<p>If <code>algorithm</code> is set to "MS22mod", both limits of the prediction interval
are calibrated independently from each other. The resulting prediction interval
is given by
</p>
<p style="text-align: center;"><code class="reqn">[l,u] = \Big[n^*_m \hat{\pi} - q^{calib}_l \hat{se}(Y_m - y^*_m), \quad
n^*_m \hat{\pi} + q^{calib}_u \hat{se}(Y_m - y^*_m) \Big]</code>
</p>

<p>Please note, that this modification does not affect the calibration procedure, if only
prediction limits are of interest.
</p>


<h3>Value</h3>

<p><code>quasi_bin_pi</code> returns an object of class <code>c("predint", "quasiBinomialPI")</code>
with prediction intervals or limits in the first entry (<code>$prediction</code>).
</p>


<h3>References</h3>

<p>Menssen and Schaarschmidt (2019): Prediction intervals for overdispersed binomial
data with application to historical controls. Statistics in Medicine.
<a href="https://doi.org/10.1002/sim.8124">doi:10.1002/sim.8124</a> <br>
Menssen and Schaarschmidt (2022): Prediction intervals for all of M future
observations based on linear random effects models. Statistica Neerlandica,
<a href="https://doi.org/10.1111/stan.12260">doi:10.1111/stan.12260</a>
</p>


<h3>Examples</h3>

<pre><code class="language-R"># Pointwise prediction interval
pred_int &lt;- quasi_bin_pi(histdat=mortality_HCD, newsize=40, nboot=100)
summary(pred_int)

# Pointwise upper prediction limit
pred_u &lt;- quasi_bin_pi(histdat=mortality_HCD, newsize=40, alternative="upper", nboot=100)
summary(pred_u)

# Please note that nboot was set to 100 in order to decrease computing time
# of the example. For a valid analysis set nboot=10000.

</code></pre>


</div>