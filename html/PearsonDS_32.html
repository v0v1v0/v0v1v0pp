<div class="container">

<table style="width: 100%;"><tr>
<td>PearsonIV</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>
The Pearson Type IV Distribution
</h2>

<h3>Description</h3>

<p>Density, distribution function, quantile function and random generation for 
the Pearson type IV distribution.
</p>


<h3>Usage</h3>

<pre><code class="language-R">
dpearsonIV(x, m, nu, location, scale, params, log = FALSE)

ppearsonIV(q, m, nu, location, scale, params, lower.tail = TRUE, 
           log.p = FALSE, tol = 1e-08, ...)

qpearsonIV(p, m, nu, location, scale, params, lower.tail = TRUE, 
           log.p = FALSE, tol = 1e-08, ...)

rpearsonIV(n, m, nu, location, scale, params)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>x, q</code></td>
<td>

<p>vector of quantiles.
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>p</code></td>
<td>

<p>vector of probabilities.
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>n</code></td>
<td>

<p>number of observations.
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>m</code></td>
<td>

<p>first shape parameter of Pearson type IV distribution.
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>nu</code></td>
<td>

<p>second shape parameter (skewness) of Pearson type IV distribution.
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>location</code></td>
<td>

<p>location parameter of Pearson type IV distribution.
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>scale</code></td>
<td>

<p>scale parameter of Pearson type IV distribution.
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>params</code></td>
<td>

<p>vector/list of length 4 containing parameters <code>m</code>, <code>nu</code>, 
<code>location</code>, <code>scale</code> for Pearson type IV distribution 
(in this order!). 
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>log, log.p</code></td>
<td>

<p>logical; if <code>TRUE</code>, probabilities <code>p</code> are given as <code>log(p)</code>.
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>lower.tail</code></td>
<td>

<p>logical; if <code>TRUE</code>, probabilities are <code class="reqn">P[X\le x]</code>, 
otherwise, <code class="reqn">P[X&gt;x]</code>.
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>tol</code></td>
<td>

<p>relative tolerance for evaluation of hypergeometric function 2F1 
(<code>ppearsonIV</code>) or absolute target <code>q</code>-error for Newton method 
(<code>qpearsonIV</code>).
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>...</code></td>
<td>

<p>further parameters for underlying hypergeometric function.
</p>
</td>
</tr>
</table>
<h3>Details</h3>

<p>The Pearson type IV distribution with location parameter 
<code>location</code><code class="reqn">=\lambda</code>,
scale parameter <code>scale</code><code class="reqn">=a</code>, and shape parameters 
<code class="reqn">m</code> and <code class="reqn">\nu</code> can
be obtained by its probability density function
</p>
<p style="text-align: center;"><code class="reqn">f(x) = \frac{\left|\frac{\Gamma(m+\frac{\nu}{2}i)}{\Gamma(m)}\right|^2}
        {a B(m-\frac{1}{2},\frac{1}{2})}
        \left[1+\left(\frac{x-\lambda}{a}\right)^2\right]^{-m} 
        e^{-\nu \mathrm{arctan}\left(\frac{x-\lambda}{a} \right)}</code>
</p>

<p>for <code class="reqn">a&gt;0</code>, <code class="reqn">m&gt;\frac{1}{2}</code>, <code class="reqn">\nu\ne 0</code> 
(<code class="reqn">\nu=0</code> corresponds to the Pearson type VII distribution family).
</p>
<p>The normalizing constant, which involves the complex Gamma function, is
calculated with <code>lngamma_complex</code> (see <code>Gamma</code>) of
package <code>gsl</code>, if package <code>gsl</code> is installed.  
Section 5.1 of [2] contains an algorithm (C code) for the calculation of the
normalizing constant, which is used otherwise, but this will be very slow for 
large absolute values of <code class="reqn">\nu</code>.
</p>
<p>The generation of random numbers (<code>rpearsonIV</code>) uses the C code from 
section 7 of [2]. It is (thus) restricted to distributions with <code class="reqn">m&gt;1</code>.
</p>
<p>For the cumulative distribution function (<code>ppearsonIV</code>), numerical 
integration of the density function is used, if package <code>gsl</code> is not
available. 
If package <code>gsl</code> is installed, three different
methods are used, depending on the parameter constellation (the corresponding 
parameter regions were obtained by comprehensive benchmarks):
</p>

<ul>
<li>
<p> numerical integration of the density function
</p>
</li>
<li>
<p> cdf representation of Heinrich [2]
</p>
</li>
<li>
<p> cdf representation of Willink [4]
</p>
</li>
</ul>
<p>The hypergeometric functions involved in the latter two representations are 
approximated 
via partial sums of the corresponding series (see [1], 15.1.1, p. 556). 
Depending on the parameter constellation, transformation 15.3.5 of [1] 
(p. 559) is applied for Heinrich's method.
The evaluation of the partial sums is first carried out in (ordinary) 
double arithmetic. If cancellation reduces accuracy beyond <code>tol</code>, the
evaluation is redone in double-double arithmetics. If cancellation still
reduces accuracy beyond <code>tol</code>, the evaluation is again redone in 
quad-double arithmetic. Code for double-double and quad-double arithmetics 
is based on [3].
For Willink's representation, the hypergeometric function in the denominator 
of <code class="reqn">R</code> in equation (10) is evaluated via complex gamma 
functions (see [1], 15.1.20, p. 556), which is fast and much more stable. 
A warning is issued if the approximation of the hypergeometric function 
seems to fail (which should not 
happen, since numerical integration should be carried out for critical
parameter constellations).
</p>
<p>The quantile function (<code>qpearsonIV</code>) is obtained via Newton's method.
The Newton iteration begins in the (single) mode of the distribution, 
which is easily calculated (see [2], section 3). Since the mode of the 
distribution is the only inflection point of the cumulative distribution
function, convergence is guaranteed.
The Newton iteration stops when the target <code>q</code>-error is reached 
(or after a maximum of 30 iterations).
</p>


<h3>Value</h3>

<p><code>dpearsonIV</code> gives the density, <code>ppearsonIV</code> gives the distribution 
function, <code>qpearsonIV</code> gives the quantile function, and <code>rpearsonIV</code> 
generates random deviates.
</p>


<h3>Warning</h3>

  
<p>If at all possible, package <code>gsl</code> should be installed. 
Otherwise, calculations for distributions with (more or less) extreme 
parameters may slow down by factors of more than 1000 and/or may become
unstable.
</p>


<h3>Note</h3>

<p>Many calculations are done in logarithms to avoid IEEE 754 underflow/overflow
issues.
</p>
<p>The description of quad-double arithmetics in [3] contains minor errors:
in algorithm 9 (p. 6), lines 9 and 10 should be interchanged; 
in algorithm 14 (p. 10), <code class="reqn">k&lt;2</code> should be replaced with <code class="reqn">k&lt;3</code> (line 10)
and <code class="reqn">k&lt;3</code> should be replaced with <code class="reqn">k&lt;4</code> (line 11).
</p>


<h3>Author(s)</h3>

<p>Martin Becker <a href="mailto:martin.becker@mx.uni-saarland.de">martin.becker@mx.uni-saarland.de</a>,
Stefan Klößner <a href="mailto:S.Kloessner@mx.uni-saarland.de">S.Kloessner@mx.uni-saarland.de</a> and
Joel Heinrich
</p>


<h3>References</h3>

<p>[1] Abramowitz, M. and I. A. Stegun (1972) 
<em>Handbook of mathematical functions</em>, 
National Bureau of Standards, Applied Mathematics Series - 55, Tenth Printing,
Washington D.C.
</p>
<p>[2] Heinrich, J. (2004) <em>A Guide to the Pearson Type IV Distribution</em>, 
Univ. Pennsylvania, Philadelphia, Tech. Rep. CDF/Memo/Statistics/Public/6820
<a href="http://www-cdf.fnal.gov/physics/statistics/notes/cdf6820_pearson4.pdf">http://www-cdf.fnal.gov/physics/statistics/notes/cdf6820_pearson4.pdf</a>
</p>
<p>[3] Hida, Y., X. S. Li and D. H. Bailey (2000) 
<em>Algorithms for quad-double precision floating point arithmetic</em>, 
Lawrence Berkeley National Laboratory. Paper LBNL-48597.
</p>
<p>[4] Willink, R. (2008) <em>A Closed-form Expression for the Pearson Type IV 
Distribution Function</em>, Aust. N. Z. J. Stat. 50 (2), pp. 199-205
</p>


<h3>See Also</h3>

<p><code>PearsonDS-package</code>,
<code>Pearson</code>
</p>


<h3>Examples</h3>

<pre><code class="language-R">## define Pearson type IV parameter set with m=5.1, nu=3, location=0.5, scale=2
pIVpars &lt;- list(m=5.1, nu=3, location=0.5, scale=2)
## calculate probability density function
dpearsonIV(-2:2,params=pIVpars)
## calculate cumulative distribution function
ppearsonIV(-2:2,params=pIVpars)
## calculate quantile function
qpearsonIV(seq(0.1,0.9,by=0.2),params=pIVpars)
## generate random numbers
rpearsonIV(5,params=pIVpars)
</code></pre>


</div>