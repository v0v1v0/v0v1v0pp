<div class="container">

<table style="width: 100%;"><tr>
<td>brownieREML</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>REML version of brownie.lite</h2>

<h3>Description</h3>

<p>Fits a multi-rate Brownian motion evolution model using REML. (See <code>brownie.lite</code> for more details.)
</p>


<h3>Usage</h3>

<pre><code class="language-R">brownieREML(tree, x, maxit=2000, ...)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>tree</code></td>
<td>
<p>an object of class <code>"phylo"</code> or <code>"simmap"</code>. (See <code>read.simmap</code> and <code>make.simmap</code> for more information about the latter object class.)</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>x</code></td>
<td>
<p>a vector of tip values for species. <code>names(x)</code> should be the species names.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>maxit</code></td>
<td>
<p>an optional integer value indicating the maximum number of iterations for optimization - may need to be increased for large trees.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>...</code></td>
<td>
<p>optional arguments.</p>
</td>
</tr>
</table>
<h3>Details</h3>

<p>This function takes an object of class <code>"phylo"</code> or an object of class <code>"simmap"</code> with a mapped binary or multi-state trait (see <code>read.simmap</code>) and data for a single continuously valued character.  It then uses restricted maximum likelihood (REML) to fit the Brownian rate variation ("noncensored") model of O'Meara et al. (2006; <em>Evolution</em>).  This function is similar to <code>brownie.lite</code> but uses REML (which is faster and unbiased) instead of ML.  REML optimization takes advantage of Felsenstein's (1985) contrasts algorithm.
</p>


<h3>Value</h3>

<p>An object of class <code>"brownieREML"</code> containing the following components:
</p>
<table>
<tr style="vertical-align: top;">
<td><code>sig2.single</code></td>
<td>
<p>is the rate, <code class="reqn">\sigma^2</code>, for a single rate model - this is usually the "null" model.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>logL1</code></td>
<td>
<p>log-likelihood of the single-rate model.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>sig2.multiple</code></td>
<td>
<p>is a length <em>p</em> (for <em>p</em> rates) vector of BM rates (<code class="reqn">\sigma_1^2</code>, <code class="reqn">\sigma_2^2</code>, and so on) from the multi-rate model.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>logL2</code></td>
<td>
<p>log-likelihood of the multi-rate model.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>convergence</code></td>
<td>
<p>numerical value from <code>optim</code>.</p>
</td>
</tr>
</table>
<h3>Author(s)</h3>

<p>Liam Revell <a href="mailto:liam.revell@umb.edu">liam.revell@umb.edu</a></p>


<h3>References</h3>

<p>Felsenstein, J. (1985) Phylogenies and the comparative method. <em>American Naturalist</em>, <b>125</b>, 1-15. 
</p>
<p>O'Meara, B. C., C. Ane, M. J. Sanderson, and P. C. Wainwright (2006) Testing for different rates of continuous trait evolution using likelihood. <em>Evolution</em>, <b>60</b>, 922-933.
</p>
<p>Revell, L. J. (2024) phytools 2.0: an updated R ecosystem for phylogenetic comparative methods (and other things). <em>PeerJ</em>, <b>12</b>, e16505.
</p>


<h3>See Also</h3>

<p><code>brownie.lite</code>, <code>evol.vcv</code>, <code>evol.rate.mcmc</code>, <code>ratebytree</code>
</p>


<h3>Examples</h3>

<pre><code class="language-R">## load data from Revell &amp; Collar (2009)
data(sunfish.tree)
data(sunfish.data)
## extract character of interest
gape.width&lt;-setNames(sunfish.data$gape.width,
    rownames(sunfish.data))
## fit model
multiBM.reml&lt;-brownieREML(sunfish.tree,
	gape.width)
print(multiBM.reml)
</code></pre>


</div>