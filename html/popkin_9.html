<div class="container">

<table style="width: 100%;"><tr>
<td>mean_kinship</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>Calculate the weighted mean kinship</h2>

<h3>Description</h3>

<p>This function computes a particular weighted mean kinship that arises in the context of kinship and FST estimators and in the definition of the effective sample size.
This function allows for weights to be zero or even negative, but they are internally normalized to sum to one.
</p>


<h3>Usage</h3>

<pre><code class="language-R">mean_kinship(kinship, weights = NULL)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>kinship</code></td>
<td>
<p>The kinship matrix</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>weights</code></td>
<td>
<p>Weights for individuals (optional).
If <code>NULL</code> (default), uniform weights are used.</p>
</td>
</tr>
</table>
<h3>Value</h3>

<p>The weighted mean kinship matrix, equivalent to <code>drop( weights %*% kinship %*% weights )</code> after normalizing weights to sum to one.
</p>


<h3>Examples</h3>

<pre><code class="language-R"># construct a dummy kinship matrix
kinship &lt;- matrix(c(0.5, 0, 0, 0.6), nrow=2)

# this is the ordinary mean
mean_kinship(kinship)

# weighted mean with twice as much weight on the second individual
# (weights are internally normalized to sum to one)
weights &lt;- c(1, 2)
mean_kinship(kinship, weights)

</code></pre>


</div>