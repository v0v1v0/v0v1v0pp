<div class="container">

<table style="width: 100%;"><tr>
<td>patterns</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>Stopping pattern for a given run</h2>

<h3>Description</h3>

<p>A pattern consists of all departures, stops, routes, runs, directions and
disruptions associated with a particular run ID. This is returned as a list
of tibbles, with output corresponding to their respective API calls.
</p>


<h3>Usage</h3>

<pre><code class="language-R">patterns(
  run_ref,
  route_type,
  stop_id = NULL,
  departs = Sys.time(),
  user_id = determine_user_id(),
  api_key = determine_api_key()
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>run_ref</code></td>
<td>
<p>A character run reference. This supersedes the integer
<code>run_id</code>. For backwards compatibility and since most run references are
integers, this function will attempt to convert an the argument to a
character. Run references may be retrieved from the
<code>departures</code> or <code>runs_on_route</code> functions.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>route_type</code></td>
<td>
<p>Optionally filter results by a route type. A route type can
be provided either as a non-negative integer code, or as a character:
"Tram", "Train", "Bus", "Vline" or "Night Bus". Character inputs are not
case-sensitive. Use the <code>route_types</code> function to extract a
vector of all route types.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>stop_id</code></td>
<td>
<p>Integer. Optionally filter results to a specific stop ID.
These can be searched for with the <code>stops_on_route</code> and <code>stops_nearby</code>
functions.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>departs</code></td>
<td>
<p>POSIXct or character. Optionally filter by date. See Details.
Characters are automatically converted to departs, and are assumed to be
given as Melbourne time. The behaviour of the API is unpredictable when
using this argument — see details. Defaults to the current system time.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>user_id</code></td>
<td>
<p>Integer or character. A user ID or devid provided by Public
Transport Victoria. Refer to <code>?ptvapi</code> for more details.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>api_key</code></td>
<td>
<p>Character. An API key, with dashes, provided by Public
Transport Victoria. Refer to <code>?ptvapi</code> for more details.</p>
</td>
</tr>
</table>
<h3>Details</h3>

<p>The <code>stops</code> tibble has an output similar to that returned by
<code>stops_on_route</code>. The <code>routes</code> tibble does not contain service
status information.
</p>
<p>Departures: The API seems to return the earliest 7 departures. While
the PTV Timetable API supports filtering patterns by datetimes, the
behaviour of this argument is not reliable — it appears to filter by day
only, returning the earliest 7 departures of a different day. It is
recommended that departures are retrieved via the <code>departures</code>
function.
</p>


<h3>Value</h3>

<p>An object of class "ptvapi", which is effectively a list with the
following names: </p>
 <ul>
<li> <p><code>departures</code> </p>
</li>
<li> <p><code>stops</code> </p>
</li>
<li> <p><code>routes</code>
</p>
</li>
<li> <p><code>runs</code> </p>
</li>
<li> <p><code>directions</code> </p>
</li>
<li> <p><code>disruptions</code> </p>
</li>
</ul>
<h3>Examples</h3>

<pre><code class="language-R">## Not run: 
patterns(run_ref = "1", route_type = 0)
patterns(run_ref = "1", route_type = "Train")

## End(Not run)

</code></pre>


</div>