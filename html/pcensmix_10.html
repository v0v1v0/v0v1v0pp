<div class="container">

<table style="width: 100%;"><tr>
<td>pcensmixSim</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>Fitting a Normal Mixture Model to a Simulated Progressive Type-II Censored
Data Using EM Algorithm</h2>

<h3>Description</h3>


<p>This function fits a normal mixture model
to progressive Type-II censored mixture data by dealing with the two aspects of
missing data, latent mixture components and the censored data, using a maximum
likelihood estimation through a constrained two-layer EM algorithm.
</p>


<h3>Usage</h3>

<pre><code class="language-R">pcensmixSim(Pdat, ...)

## S3 method for class 'pcgen'
pcensmixSim(Pdat, r, p, param, iteration = 1e+05,
  INERiter = 20, ...)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>Pdat</code></td>
<td>
<p>an object of class <code>"pcgen"</code> created by function
<code>pcgen</code> or a two-column matrix (or data.frame)
with first column
giving a vector of censored version of a two-component mixed normal data,
and the other one indicating the censoring status associated with them (1
if not censored, otherwise zero).</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>...</code></td>
<td>
<p>additinal arguments to pass by.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>r</code></td>
<td>
<p>desired number of failures to observe.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>p</code></td>
<td>
<p>a parameter controlling the amount of censoring. The action of
censoring individuals after each failure occurs with probabilty <code>p</code>
from binomial distribution at each stage. If <code>p = 0</code>, there will be no
censoring.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>param</code></td>
<td>
<p>a numeric vector; used as starting values for the EM and
simulating a new data to replace in case of happening singularity in the
likelihood.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>iteration</code></td>
<td>
<p>the maximum number of required iteration for the EM
algorithm until convergence– default value is 1e+05.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>INERiter</code></td>
<td>
<p>the maximum number of required iteration for the second EM
algorithm– default is 20.</p>
</td>
</tr>
</table>
<h3>Details</h3>

<p>This function fits a two-component normal mixture model to simulated
progressive Type-II censored data with density function </p>
<p style="text-align: center;"><code class="reqn">\pi
  (\frac{1}{\sigma_1})\,  \phi\!\! \left[\frac{(z - \mu_1)}{\sigma_1}\right]
  + (1 - \pi) (\frac{1}{\sigma_2})\,  \phi\!\! \left[\frac{(z -
  \mu_2)}{\sigma_2}\right]</code>
</p>
<p> where <code class="reqn">\phi</code>
is the standard normal density.
</p>
<p>It uses a constrained two-layer EM algorithm to deal with the two forms of
missing data: the censored survival times and the mixture component labels.
Given the EM algorithm is at a particular iteration: (i) first, in the
E-step it obtains the mixture component indicator estimates given the
current parameter estimates and the observed data. (ii) Next, for
re-estimation of the unknown parameters, a new EM algorithm is nested in
the M-step of the initial EM algorithm to deal with the estimation of the
missing censored survival times and consequently building the maximum
likelihood equations. These steps are repeated until the model converges.
</p>


<h3>Value</h3>

<p><code>pcensmixSim</code> gives an object of class <code>data.frame</code>
containing the following components: </p>
<table>
<tr style="vertical-align: top;">
<td><code>muhat1,sigmahat1</code></td>
<td>
<p>component one
parameter estimates (<code class="reqn">\hat\mu_1</code>,
<code class="reqn">\hat\sigma_1</code> )</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>muhat2,sigmahat2</code></td>
<td>
<p>component two
parameter estimates (<code class="reqn">\hat\mu_2</code>,
<code class="reqn">\hat{\sigma_2}</code></p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>pihat</code></td>
<td>
<p>estimation of mixture
proportion <code class="reqn">\hat\pi</code></p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>se.muhat1,se.sigmahat1</code></td>
<td>
<p>standard
errors of <code class="reqn">\hat\mu_1</code> and <code class="reqn">\hat{\sigma_1}</code></p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>se.muhat2,se.sigmahat2</code></td>
<td>
<p>standard errors of
<code class="reqn">\hat\mu_2</code> and <code class="reqn">\hat\sigma_2</code></p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>se.pihat</code></td>
<td>
<p>standard error of <code class="reqn">\hat\pi</code></p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>no.fails.comp1,no.fails.comp2</code></td>
<td>
<p>number of failures from each mixture
component</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>no.cens.comp1,no.cens.comp2</code></td>
<td>
<p>number of censored
observations from each mixture component</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>ll</code></td>
<td>
<p>log-likelihood value</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>datachange_flag</code></td>
<td>
<p><code>TRUE</code> if data has been replaced by a newly
generated one</p>
</td>
</tr>
</table>
<h3>Note</h3>

 <ul>
<li>
<p> In fitting the model, to overcome the problem of
singularity and model non-identifiability that might happen in some cases
depending on the true means and standard deviations of the components, we
use the constraint proposed by Hathaway (1985). Based on this, the
ratios of the standard deviations are considered to be greater than a
pre-fixed constant. We consider the constraints <code class="reqn">\sigma_1/\sigma_2&gt;0.1</code>
and <code class="reqn">\sigma_2/\sigma_1&gt;0.1</code> which lead to obtain a parameter space with
no singularities. In case this conditions doesn't hold, the data will be
replaced by a new simulated one and <code>datachange_flag</code> will appear as
<code>TRUE</code> in the output. </p>
</li>
<li>
<p> See <code>pcgen</code> for the
definition of censored version of data.</p>
</li>
</ul>
<h3>Author(s)</h3>

<p>Lida Fallah, John Hinde
</p>
<p>Maintainer: Lida Fallah &lt;l.fallah22@gmail.com&gt;
</p>


<h3>See Also</h3>

<p><code>pcgen</code>, <code>run_pcensmix</code>
</p>


<h3>Examples</h3>

<pre><code class="language-R">## Not run: 
set.seed(100)

Pdat&lt;- pcgen(r = 60, p = 0.3, data = mixgen(N = 100, dist1 = 'norm',
                 dist2 = 'norm', control = list(12, 2, 14, 5, 0.35)))
pcensmixSim(Pdat, r = 60, p = 0.3, param=c(12, 2, 14, 5, 0.35))
## End(Not run)

</code></pre>


</div>