<div class="container">

<table style="width: 100%;"><tr>
<td>psw.spec.test</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>Propensity score model specification test</h2>

<h3>Description</h3>

<p><code>psw.spec.test</code> is used to test the sufficiency of propensity score model in balancing covariates between groups.
</p>


<h3>Usage</h3>

<pre><code class="language-R">psw.spec.test(data, form.ps, weight, V.name, trans.type, K = 4)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>data</code></td>
<td>
<p>data frame to be used.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>form.ps</code></td>
<td>
<p>propensity score model.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>weight</code></td>
<td>
<p>weighting method to be used. Available methods are <code>"ATE"</code>,  <code>"ATT"</code>, <code>"ATC"</code>, <code>"MW"</code>, and <code>"TRAPEZOIDAL"</code>.
Note that specification test is not available for <code>weight = "OVERLAP"</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>V.name</code></td>
<td>
<p>a vector of covariates on which the specification test is performed.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>trans.type</code></td>
<td>
<p>a vector of the same length as <code>V.name</code> that specifies the transformation type for each element in <code>V.name</code>.
Available transformations are <code>"identity"</code>, <code>"log"</code>, <code>"logit"</code>, <code>"sqrt"</code>, and <code>"Fisher"</code>.
No transformation is perfomred with <code>"identity"</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>K</code></td>
<td>
<p>value of <code class="reqn">K</code> in <code class="reqn">\omega(e_i) = min(1, K min(e_i, 1-e_i)) </code> for <code>"TRAPEZOIDAL"</code> weight. <code>K=4</code> by default.</p>
</td>
</tr>
</table>
<h3>Details</h3>

<p>In the data set, treatment indicator should be numerically specified such that a value of <code>1</code> indicates the treated
and a value of <code>0</code> indicates the control. The null hypothesis is that the propensity score model is correctly specified; the
alternative is that the propensity score model is misspecified. Therefore, this test is a goodness-of-fit test of propensity score model,
with the test statistic being a metric of covariate balance.
#'
Rejection of the specification test implies current propensity score model is inadquate
for balancing covariates between groups.
</p>


<h3>Value</h3>

<p>A list of model specification test results.
</p>
<table>
<tr style="vertical-align: top;">
<td><code>weight</code></td>
<td>
<p>weighting method.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>ps.model</code></td>
<td>
<p>object returned by fitting the propensity score model using <code>glm</code> with <code>"binomial"</code> family.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>ps.hat</code></td>
<td>
<p>estimated propensity score.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>W</code></td>
<td>
<p>estimated propensity score weight.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>V.name</code></td>
<td>
<p>covariates in the specification test.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>g.B1.hat</code></td>
<td>
<p>a vector of transformed weighted average for covariates in the treated group when <code>spec.test=T</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>g.B0.hat</code></td>
<td>
<p>a vector of transformed weighted average for covariates in the control group when <code>spec.test=T</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>B.hat</code></td>
<td>
<p>difference between <code>eta.B1.hat</code> and <code>eta.B0.hat</code> when <code>spec.test=T</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>var.B.hat</code></td>
<td>
<p>covariance matrix for <code>B.hat</code> when <code>spec.test=T</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>test.stat</code></td>
<td>
<p>test statistic for the specification test, which follows the <code class="reqn">\chi^2_{df}</code> distribution under the null, available when <code>spec.test=T</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>df</code></td>
<td>
<p>degree of freedom for the specification test, <code>df=rank(var.B.hat)</code>, available when <code>spec.test=T</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>pvalue</code></td>
<td>
<p>pvalue of the specification test when <code>spec.test=T</code>.</p>
</td>
</tr>
</table>
<h3>See Also</h3>

<p>psw, psw.balance
</p>


<h3>Examples</h3>

<pre><code class="language-R"># Load the test data set
data(test_data);
# Propensity score model
form.ps &lt;- "Z ~ X1 + X2 + X3 + X4";
# A vector of covariates
V.name &lt;- c( "X1", "X2", "X3", "X4" );
# A vector of transformation types for covariates in V.name.
trans.type &lt;- c( "identity", "identity", "logit", "logit" );
tmp &lt;- psw.spec.test( data = test_data, form.ps = form.ps,
weight = "MW", V.name = V.name, trans.type = trans.type );

</code></pre>


</div>