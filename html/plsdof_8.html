<div class="container">

<table style="width: 100%;"><tr>
<td>dvvtz</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>First derivative of the projection operator</h2>

<h3>Description</h3>

<p>This function computes the first derivative of the projection operator
</p>
<p style="text-align: center;"><code class="reqn">P_V z= V V^\top z</code>
</p>



<h3>Usage</h3>

<pre><code class="language-R">dvvtz(v, z, dv, dz)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>v</code></td>
<td>
<p>orthonormal basis of the space on which <code>z</code> is projected.
<code>v</code> is either a matrix or a vector.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>z</code></td>
<td>
<p>vector that is projected onto the columns of <code>v</code></p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>dv</code></td>
<td>
<p>first derivative of the the columns of <code>v</code> with respect to a
vector y. If <code>v</code> is a matrix, <code>dv</code> is an array of dimension
<code>ncol(v)</code>x<code>nrow(v)</code>x<code>length(y)</code>. If <code>v</code> is a vector,
<code>dv</code> is a matrix of dimension <code>nrow(v)</code>x<code>length(y)</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>dz</code></td>
<td>
<p>first derivative of <code>z</code> with respect to a vector y. This is a
matrix of dimension <code>nrow(v)</code>x<code>length(y)</code>.</p>
</td>
</tr>
</table>
<h3>Details</h3>

<p>For the computation of the first derivative, we assume that the columns of
<code>v</code> are normalized and mutually orthogonal. (Note that the function
will not return an error message if these assumptionsa are not fulfilled. If
we denote the columns of <code>v</code> by <code class="reqn">v_1,\ldots,v_l</code>, the first
derivative of the projection operator is </p>
<p style="text-align: center;"><code class="reqn"> \frac{\partial P}{\partial
y}=\sum_{j=1} ^ l \left[ \left(v_j z^ \top + v_j^ \top z I_n
\right)\frac{\partial v_j}{\partial y} + v_j v_j ^ \top \frac{\partial
z}{\partial y}\right] </code>
</p>
<p> Here, n denotes the length of the vectors <code class="reqn">v_j</code>.
</p>


<h3>Value</h3>

<p>The first derivative of the projection operator with respect to y.
This is a matrix of dimension <code>nrow(v)</code>x<code>length(y)</code>.
</p>


<h3>Note</h3>

<p>This is an internal function.
</p>


<h3>Author(s)</h3>

<p>Nicole Kraemer, Mikio L. Braun
</p>


<h3>References</h3>

<p>Kraemer, N., Sugiyama M. (2011). "The Degrees of Freedom of
Partial Least Squares Regression". Journal of the American Statistical
Association. 106 (494)
<a href="https://www.tandfonline.com/doi/abs/10.1198/jasa.2011.tm10107">https://www.tandfonline.com/doi/abs/10.1198/jasa.2011.tm10107</a>
</p>
<p>Kraemer, N., Braun, M.L. (2007) "Kernelizing PLS, Degrees of Freedom, and
Efficient Model Selection", Proceedings of the 24th International Conference
on Machine Learning, Omni Press, 441 - 448
</p>


<h3>See Also</h3>

<p><code>vvtz</code>
</p>


</div>