<div class="container">

<table style="width: 100%;"><tr>
<td>look_up</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>Look up geological intervals and assign geological stages</h2>

<h3>Description</h3>

<p>A function that uses interval names to assign either
<a href="https://stratigraphy.org/ICSchart/ChronostratChart2022-02.pdf">international geological stages</a>
and numeric ages from the International Commission on Stratigraphy (ICS), or
user-defined intervals, to fossil occurrences.
</p>


<h3>Usage</h3>

<pre><code class="language-R">look_up(
  occdf,
  early_interval = "early_interval",
  late_interval = "late_interval",
  int_key = FALSE,
  assign_with_GTS = "GTS2020",
  return_unassigned = FALSE
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>occdf</code></td>
<td>
<p><code>data.frame</code>. A dataframe of fossil occurrences or other
geological data, with columns of class <code>character</code> specifying the
earliest and the latest possible interval associated with each occurrence.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>early_interval</code></td>
<td>
<p><code>character</code>. Name of the column in <code>occdf</code> that
contains the earliest interval from which the occurrences are from. Defaults
to "early_interval".</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>late_interval</code></td>
<td>
<p><code>character</code>. Name of the column in <code>occdf</code> that
contains the latest interval from which the occurrences are from. Defaults
to "late_interval".</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>int_key</code></td>
<td>
<p><code>data.frame</code>. A dataframe linking interval names to
international geological stage names from the ICS, or other, user-defined
intervals.
This dataframe should contain the following named columns containing
<code>character</code> values: <br></p>

<ul>
<li> <p><code>interval_name</code> contains the names to be matched from <code>occdf</code> <br></p>
</li>
<li> <p><code>early_stage</code> contains the names of the earliest stages
corresponding to the intervals <br></p>
</li>
<li> <p><code>late_stage</code> contains the latest stage corresponding to the
intervals <br></p>
</li>
</ul>
<p>Optionally, named <code>numeric</code> columns provide maximum and minimum ages
for the intervals: <br></p>

<ul>
<li> <p><code>max_ma</code>
</p>
</li>
<li> <p><code>min_ma</code>
</p>
</li>
</ul>
<p>If set to <code>FALSE</code> (default), stages and numerical ages can be assigned
based on one of the GTS tables (see below).</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>assign_with_GTS</code></td>
<td>
<p><code>character</code> or <code>FALSE</code>. Allows intervals to
be searched in the <code>GTS2020</code> (default) or the <code>GTS2012</code> table. Set to
<code>FALSE</code> to disable.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>return_unassigned</code></td>
<td>
<p><code>logical</code>. Return interval names which could
not be assigned, instead of the dataframe with assignments.
Defaults to <code>FALSE</code>.</p>
</td>
</tr>
</table>
<h3>Details</h3>

<p>If <code>int_key</code> is set to <code>FALSE</code> (default), this function can be used to
assign numerical ages solely based on stages from a GTS table, and to assign
stages based on GTS interval names.
</p>
<p>Instead of  geological stages, the user can supply any names in the
<code>early_stage</code> and <code>late_stage</code> column of <code>int_key</code>.
<code>assign_with_GTS</code> should then be set to <code>FALSE</code>.
</p>
<p>An exemplary <code>int_key</code> has been included within this package
(<code>interval_key</code>). This key works well for assigning
geological stages to many of the intervals from the
<a href="https://paleobiodb.org">Paleobiology Database</a>
and the <a href="https://www.paleo-reefs.pal.uni-erlangen.de/">PaleoReefs Database</a>.
<code>palaeoverse</code> cannot guarantee that all of
the stage assignments with the exemplary key are accurate.
The table corresponding to this key can be loaded with
<code>palaeoverse::interval_key</code>.
</p>


<h3>Value</h3>

<p>A <code>dataframe</code> of the original input <code>data</code> with the following
appended columns is returned: <code>early_stage</code> and <code>late_stage</code>, corresponding
to the earliest and latest international geological stage which
could be assigned to the occurrences based on the given interval names.
<code>interval_max_ma</code> and <code>interval_min_ma</code> return maximum and minimum interval
ages if provided in the interval key, or if they can be fetched from GTS2012
or GTS2020. A column <code>interval_mid_ma</code> is appended to provide the midpoint
ages of the intervals.
</p>


<h3>Developer(s)</h3>

<p>Kilian Eichenseer &amp; William Gearty
</p>


<h3>Reviewer(s)</h3>

<p>Lewis A. Jones &amp; Christopher D. Dean
</p>


<h3>Examples</h3>

<pre><code class="language-R">## Just use GTS2020 (default):
# create exemplary dataframe
taxdf &lt;- data.frame(name = c("A", "B", "C"),
early_interval = c("Maastrichtian", "Campanian", "Sinemurian"),
late_interval = c("Maastrichtian", "Campanian", "Bartonian"))
# assign stages and numerical ages
taxdf &lt;- look_up(taxdf)

## Use exemplary int_key
# Get internal reef data
occdf &lt;- reefs
 # assign stages and numerical ages
occdf &lt;- look_up(occdf,
                early_interval = "interval",
                late_interval = "interval",
                int_key = interval_key)

## Use exemplary int_key and return unassigned
# Get internal tetrapod data
occdf &lt;- tetrapods
# assign stages and numerical ages
occdf &lt;- look_up(occdf, int_key = palaeoverse::interval_key)
# return unassigned intervals
unassigned &lt;- look_up(occdf, int_key = palaeoverse::interval_key,
                      return_unassigned = TRUE)

## Use own key and GTS2012:
# create example data
occdf &lt;- data.frame(
  stage = c("any Permian", "first Permian stage",
            "any Permian", "Roadian"))
# create example key
interval_key &lt;- data.frame(
  interval_name = c("any Permian", "first Permian stage"),
  early_stage = c("Asselian", "Asselian"),
  late_stage = c("Changhsingian", "Asselian"))
# assign stages and numerical ages:
occdf &lt;- look_up(occdf,
                 early_interval = "stage", late_interval = "stage",
                 int_key = interval_key, assign_with_GTS = "GTS2012")

</code></pre>


</div>