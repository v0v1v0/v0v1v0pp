<div class="container">

<table style="width: 100%;"><tr>
<td>np.est</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>Nonparametric estimate of the regression function</h2>

<h3>Description</h3>

<p>This routine computes estimates for <code class="reqn">m(newt_j)</code> (<code class="reqn">j=1,...,J</code>) from a sample <code class="reqn">{(Y_i, t_i): i=1,...,n}</code>, where:
</p>
<p style="text-align: center;"><code class="reqn">Y_i= m(t_i) + \epsilon_i.</code>
</p>

<p>The regression function, <code class="reqn">m</code>, is a smooth but unknown function, and the random errors, <code class="reqn">{\epsilon_i}</code>, are allowed to be time series. Kernel smoothing is used.
</p>


<h3>Usage</h3>

<pre><code class="language-R">np.est(data = data, h.seq = NULL, newt = NULL,
estimator = "NW", kernel = "quadratic")
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>data</code></td>
<td>

<p><code>data[, 1]</code> contains the values of the response variable, <code class="reqn">Y</code>;
</p>
<p><code>data[, 2]</code> contains the values of the explanatory variable, <code class="reqn">t</code>.
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>h.seq</code></td>
<td>
<p>the considered bandwidths. If <code>NULL</code> (the default), only one bandwidth, selected by means of the cross-validation procedure, is used.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>newt</code></td>
<td>
<p>values of the explanatory variable where the estimates are obtained. If NULL (the default), the considered values will be the values of <code>data[,2]</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>estimator</code></td>
<td>
<p>allows us the choice between “NW” (Nadaraya-Watson) or “LLP” (Local Linear Polynomial). The default is “NW”.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>kernel</code></td>
<td>
<p>allows us the choice between “gaussian”, “quadratic” (Epanechnikov kernel), “triweight” or “uniform” kernel. The default is “quadratic”.</p>
</td>
</tr>
</table>
<h3>Details</h3>

<p>See Fan and Gijbels (1996) and Francisco-Fernandez and Vilar-Fernandez (2001).
</p>


<h3>Value</h3>

<p>YHAT: a length(<code>newt</code>) x length(<code>h.seq</code>) matrix containing the estimates for <code class="reqn">m(newt_j)</code> 
</p>
<p>(<code class="reqn">j=1,...,</code>length(<code>newt</code>)) using the different bandwidths in <code>h.seq</code>.
</p>


<h3>Author(s)</h3>

<p>German Aneiros Perez <a href="mailto:ganeiros@udc.es">ganeiros@udc.es</a> 
</p>
<p>Ana Lopez Cheda <a href="mailto:ana.lopez.cheda@udc.es">ana.lopez.cheda@udc.es</a></p>


<h3>References</h3>

<p>Fan, J.  and Gijbels, I. (1996) <em>Local Polynomial Modelling and its Applications</em>. Chapman and Hall, London.
</p>
<p>Francisco-Fernandez, M. and Vilar-Fernandez, J. M. (2001) Local polynomial regression estimation with correlated errors. <em>Comm. Statist. Theory Methods</em> <b>30</b>, 1271-1293.
</p>


<h3>See Also</h3>

<p>Other related functions are: <code>np.gcv</code>, <code>np.cv</code>, <code>plrm.est</code>, <code>plrm.gcv</code> and <code>plrm.cv</code>.
</p>


<h3>Examples</h3>

<pre><code class="language-R"># EXAMPLE 1: REAL DATA
data &lt;- matrix(10,120,2)
data(barnacles1)
barnacles1 &lt;- as.matrix(barnacles1)
data[,1] &lt;- barnacles1[,1]
data &lt;- diff(data, 12)
data[,2] &lt;- 1:nrow(data)

aux &lt;- np.gcv(data)
h &lt;- aux$h.opt
ajuste &lt;- np.est(data=data, h=h)
plot(data[,2], ajuste, type="l", xlab="t", ylab="m(t)")
plot(data[,1], ajuste, xlab="y", ylab="y.hat", main="y.hat vs y")
abline(0,1)
residuos &lt;- data[,1] - ajuste
mean(residuos^2)/var(data[,1])



# EXAMPLE 2: SIMULATED DATA
## Example 2a: independent data

set.seed(1234)
# We generate the data
n &lt;- 100
t &lt;- ((1:n)-0.5)/n
m &lt;- function(t) {0.25*t*(1-t)}
f &lt;- m(t)

epsilon &lt;- rnorm(n, 0, 0.01)
y &lt;-  f + epsilon
data_ind &lt;- matrix(c(y,t),nrow=100)

# We estimate the nonparametric component of the PLR model
# (CV bandwidth)
est &lt;- np.est(data_ind)
plot(t, est, type="l", lty=2, ylab="")
points(t, 0.25*t*(1-t), type="l")
legend(x="topleft", legend = c("m", "m hat"), col=c("black", "black"), lty=c(1,2))

</code></pre>


</div>