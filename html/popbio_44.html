<div class="container">

<table style="width: 100%;"><tr>
<td>resample</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>Resample a projection matrix</h2>

<h3>Description</h3>

<p>Resample a projection matrix using  a multinomial distribution for
transitions and a log normal distribution for fertilities
</p>


<h3>Usage</h3>

<pre><code class="language-R">resample(A, n, fvar = 1.5, ...)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>A</code></td>
<td>
<p>a projection matrix</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>n</code></td>
<td>
<p>either a stage vector with the number of transitions to sample
in each column or a single value  that is applied to all columns</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>fvar</code></td>
<td>
<p>either a vector of different fertility variances or a single
variance of fertility (default 1.5) that is applied to all rates</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>...</code></td>
<td>
<p>additional items are passed to <code>splitA</code>
and are used to split A into T and F matrices</p>
</td>
</tr>
</table>
<h3>Details</h3>

<p>The projection matrix A is first split into separate transition and fertility
matrices.  Dead fates are added to the transtion matrix and the columns are
then sampled from a <code>Multinomial</code> distribution based on the size
in each corresponding stage class in <code>n</code>. The fertility rates are
sampled from a Log Normal distribution using the <code>lnorms</code>
function. The variance can be a single value which is applied to all rates,
or vector of different values to apply to each rate.  In this case, the
values are recycled to match the number of non-zero fertilities.
</p>


<h3>Value</h3>

<p>A resampled projection matrix
</p>


<h3>Note</h3>

<p>see section 12.1.5.2 on parametric bootsrap in Caswell (2001)
</p>


<h3>Author(s)</h3>

<p>Chris Stubben
</p>


<h3>See Also</h3>

<p><code>boot.transitions</code>
</p>


<h3>Examples</h3>

<pre><code class="language-R">A &lt;- hudsonia[[1]]
lambda(A)
## NOTE fertilities are in first two rows, so use r=1:2 for splitting this matrix
## resample transitions 100 times each
resample(A, 100, r=1:2)
## set higher fvar in stage 4 and 6
## because there are two fertilities per stage (8 total), need to repeat values
resample(A,1000, fvar=c(1.5, 1.5, 3, 3), r=1:2)
## OR resample based on number of plants surveyed
# data from table 6.4 and  box 7.3)
n &lt;- c(4264,3, 30, 16, 24,5)
## create a list with 1000 resampled matrices
x &lt;- lapply(1:1000, function(x) resample(A,n, r=1:2))
mean(x)
## use var2 to check variances, especially if  using differnt fvar values
var2(x)
## growth rates
y &lt;- sapply(x, lambda)
quantile( y, c(0.025, .975) )
hist(y, br=30, col="palegreen", xlab="Lambda", main="1985 Hudsonia growth rates")
abline(v=quantile(y, c(0.025, .975)), lty=3)
## double the sample size (and quadruple seedlings) and you may be able to detect a decline
n &lt;- n * 2
n[2] &lt;- n[2] * 2
x &lt;- lapply(1:1000, function(x) resample(A, n * 2, r=1:2))
quantile( sapply(x, lambda), c(0.025, .975) )

</code></pre>


</div>