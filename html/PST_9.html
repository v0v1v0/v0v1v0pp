<div class="container">

<table style="width: 100%;"><tr>
<td>impute</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>
Impute missing values using a probabilistic suffix tree
</h2>

<h3>Description</h3>

<p>Missing states in a set of sequences are imputed by using the probability distributions stored in a probabilistic suffix tree.
</p>


<h3>Usage</h3>

<pre><code class="language-R">## S4 method for signature 'PSTf,stslist'
impute(object, data, method="pmax")
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>object</code></td>
<td>

<p>a probabilistic suffix tree, i.e., an object of class <code>"PSTf"</code> as returned by the <code>pstree</code>, <code>prune</code> or <code>tune</code> function.
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>data</code></td>
<td>

<p>a sequence object, i.e., an object of class <code>'stslist'</code> as created by TraMineR <code>seqdef</code> function, containing the sequences to impute. See details.
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>method</code></td>
<td>

<p>character. If <code>method='pmax'</code> the state having the highest probability according to the probability distribution associated with the context preceding the missing status is imputed. If <code>method='prob'</code> the imputation is done randomly by using this probability distribution.
</p>
</td>
</tr>
</table>
<h3>Details</h3>

<p>A probabilistic suffix tree (PST) can be used to impute missing states in sequences built on the same alphabet. When a missing state occurs in a sequence the procedure searches in the PST for the context preceding the missing state and impute the state according to the conditional distribution associated with the context. The imputation can be done either randomly (method="prob") or with the state having the highest probability. However, more sophisticated modelling taking account of the non response mechanism could be required for imputing missing states. For more details, see <cite>Gabadinho 2016</cite>.
</p>


<h3>Value</h3>

<p>A sequence object (of class <code>stslist</code>) containing original sequences in <code>data</code> with missing states imputed.  
</p>


<h3>Author(s)</h3>

<p>Alexis Gabadinho
</p>


<h3>References</h3>

<p>Gabadinho, A. &amp; Ritschard, G. Analyzing State Sequences with Probabilistic Suffix Trees: The PST R Package. <em>Journal of Statistical Software</em>, 2016, <b>72</b>(3), 1-39.
</p>


<h3>Examples</h3>

<pre><code class="language-R">## Loading the SRH.seq sequence object
data(SRH)

## working with a sub-sample of 500 sequences
## to reduce computing time
subs &lt;- sample(nrow(SRH.seq), size=500)
SRH.sub.seq &lt;- SRH.seq[subs,]

## Learning the model (missing state is not included)
SRH.pst.L10 &lt;- pstree(SRH.sub.seq, nmin=2, ymin=0.001)

## Pruning
C99 &lt;- qchisq(0.99,5-1)/2
SRH.pst.L10.C99 &lt;- prune(SRH.pst.L10, gain="G2", C=C99)

## Imputing missing values in the SRH sequences
SRH.sub.iseq &lt;- impute(SRH.pst.L10, SRH.sub.seq, method="prob")

## locating sequences having missing values
## in sequence object missing states are identified by '*'
have.miss &lt;- which(rowSums(SRH.sub.seq=='*')&gt;0)

## plotting non imputed vs imputed sequence
## (first 10 sequences in the set) 
par(mfrow=c(1,2))
seqiplot(SRH.sub.seq[have.miss,], withlegend=FALSE)
seqiplot(SRH.sub.iseq[have.miss,], withlegend=FALSE)
</code></pre>


</div>