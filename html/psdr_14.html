<div class="container">

<table style="width: 100%;"><tr>
<td>PSDIdentifyDominantFrequency</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>Given a time series vector, create a PSD and find the dominant frequency</h2>

<h3>Description</h3>

<p>The range to look for a dominant frequency (frequency corresponding to max
PSD value) should be specified for this function. This function uses the
MakePowerSpectralDensity() function and the IdentifyMaxOnXY() function
together. If multiple equal maxima are found, then IdentifyMaxOnXY()
will display a message.
</p>


<h3>Usage</h3>

<pre><code class="language-R">PSDIdentifyDominantFrequency(
  sampling_frequency,
  data_vector,
  x_start = 0,
  x_end,
  x_increment
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>sampling_frequency</code></td>
<td>
<p>Numeric value specifying sampling frequency in hertz. If data is sampled once every second, then sampling frequency is 1 Hz. If data is sampled once every 2 seconds, then sampling frequency is 0.5 Hz.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>data_vector</code></td>
<td>
<p>Vector of numeric values. Timeseries vector of data.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>x_start</code></td>
<td>
<p>Numeric value specifying start of x value to look at.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>x_end</code></td>
<td>
<p>Numeric value specifying end of x value to look at.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>x_increment</code></td>
<td>
<p>Numeric value specifying the increment of the x-values to use.</p>
</td>
</tr>
</table>
<h3>Value</h3>

<p>A vector with two elements, The first element is the x value (frequency)
where the max y value (PSD value) is found. The second element is the max y value.
</p>


<h3>Examples</h3>

<pre><code class="language-R">
#Create a vector of time that represent times where data are sampled.
Fs = 100; #sampling frequency in Hz
T = 1/Fs; #sampling period
L = 1000; #length of time vector
t = (0:(L-1))*T; #time vector

#First signal
#1. 1 Hz with amplitude of 2
S1 &lt;- 2*sin(2*pi*1*t)
level1.vals &lt;- rep("a", length(S1))
level2.vals &lt;- rep("1", length(S1))
S1.data.frame &lt;- as.data.frame(cbind(t, S1, level1.vals, level2.vals))
colnames(S1.data.frame) &lt;- c("Time", "Signal", "level1.ID", "level2.ID")
S1.data.frame[,"Signal"] &lt;- as.numeric(S1.data.frame[,"Signal"])


results &lt;- PSDIdentifyDominantFrequency(Fs, S1.data.frame[,"Signal"], 0, 10, 0.01)

</code></pre>


</div>