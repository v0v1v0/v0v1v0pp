<div class="container">

<table style="width: 100%;"><tr>
<td>clusterPeaks</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>clusterPeaks</h2>

<h3>Description</h3>

<p>Cluster <code>peaks</code> into overlapping groups.</p>


<h3>Usage</h3>

<pre><code class="language-R">clusterPeaks(peaks)</code></pre>


<h3>Arguments</h3>

<table><tr style="vertical-align: top;">
<td><code>peaks</code></td>
<td>
<p>data.frame with columns chromStart, chromEnd.</p>
</td>
</tr></table>
<h3>Value</h3>

<p><code>peaks</code> data.frame, sorted by chromStart, with an additional column
cluster.</p>


<h3>Author(s)</h3>

<p>Toby Dylan Hocking &lt;toby.hocking@r-project.org&gt; [aut, cre]</p>


<h3>Examples</h3>

<pre><code class="language-R">unordered &lt;-
  data.frame(chromStart=c(11, 12, 1, 2, 3, 6, 7),
             chromEnd=c(13, 14, 5, 8, 4, 9, 10),
             sample.id=factor(paste0("sample.", c(1, 2, 1, 2, 3, 4, 5))))
clustered &lt;- clusterPeaks(unordered)
library(ggplot2)
bases &lt;- geom_text(aes(position, "base", label=base),
                   data=data.frame(position=1:20, base="N"))
gg &lt;- ggplot()+bases+ylab("")+
  scale_x_continuous(breaks=1:20)

gg+
  geom_segment(aes(chromStart+1/2, sample.id,
                   xend=chromEnd+1/2, yend=sample.id),
                   data=clustered)+
  theme_bw()+
  theme(panel.margin=grid::unit(0, "cm"))+
  facet_grid(.~cluster, labeller=label_both, scales="free", space="free")

gg+
  geom_segment(aes(chromStart+1/2, sample.id,
                   xend=chromEnd+1/2, yend=sample.id, color=factor(cluster)),
                   data=clustered)
</code></pre>


</div>