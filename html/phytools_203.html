<div class="container">

<table style="width: 100%;"><tr>
<td>optim.phylo.ls</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>Phylogeny inference using the least squares method</h2>

<h3>Description</h3>

<p>Phylogenetic inference using the method of least-squares (Cavalli-Sforza &amp; Edwards, 1967).
</p>


<h3>Usage</h3>

<pre><code class="language-R">optim.phylo.ls(D, stree=NULL, set.neg.to.zero=TRUE, fixed=FALSE,
   tol=1e-10, collapse=TRUE)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>D</code></td>
<td>
<p>a distance matrix.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>stree</code></td>
<td>
<p>an optional starting tree for the optimization.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>set.neg.to.zero</code></td>
<td>
<p>a logical value indicating whether to set negative branch lengths to zero (default <code>TRUE</code>).</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>fixed</code></td>
<td>
<p>a logical value indicating whether to estimate the topology - if <code>TRUE</code> only the branch lengths will be computed.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>tol</code></td>
<td>
<p>a tolerance value used to assess whether the optimization has converged.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>collapse</code></td>
<td>
<p> a logical indicating whether to collapse branches with zero length.</p>
</td>
</tr>
</table>
<h3>Details</h3>

<p>Function uses <code>nni</code> from the <span class="pkg">phangorn</span> package (Schliep 2011) to conduct NNIs for topology estimation.
</p>
<p>Since topology optimization is performed using NNIs, convergence to the true least-squares topology is not guaranteed. It is consequently probably wise to start with a very good tree - such as a NJ tree.
</p>


<h3>Value</h3>

<p>An object of class <code>"phylo"</code> that (may be) the least-squares tree with branch lengths; also returns the sum of squares in <code>attr(tree,"Q-score")</code>.
</p>


<h3>Author(s)</h3>

<p>Liam Revell <a href="mailto:liam.revell@umb.edu">liam.revell@umb.edu</a></p>


<h3>References</h3>

<p>Cavalli-Sforza, L. L., and A. W. F. Edwards. (1967) Phylogenetic analysis: Models and estimation procedures. <em>American Journal of Human Genetics</em>, <b>19</b>, 233-257.
</p>
<p>Felsenstein, J. (2004) <em>Inferring Phylogenies</em>. Sinauer.
</p>
<p>Paradis, E., J. Claude, and K. Strimmer. (2004) APE: Analyses of phylogenetics and evolution in R language. <em>Bioinformatics</em>, <b>20</b>, 289-290.
</p>
<p>Revell, L. J. (2024) phytools 2.0: an updated R ecosystem for phylogenetic comparative methods (and other things). <em>PeerJ</em>, <b>12</b>, e16505.
</p>
<p>Schliep, K. P. (2011) phangorn: phylogenetic analysis in R. <em>Bioinformatics</em>, <b>27</b>, 592-593.
</p>


<h3>See Also</h3>

<p><code>exhaustiveMP</code>, <code>nni</code>
</p>


</div>