<div class="container">

<table style="width: 100%;"><tr>
<td>cv.pgee</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>Cross validation for Penalized Generalized Estimating Equations</h2>

<h3>Description</h3>

<p>Performs k-fold cross-validation for Penalized Generalized Estimating
Equations (PGEEs) over grid(s) of tuning parameters lambda. Linear and binary
logistic models are supported. In particular, can handle the case of
bivariate correlated mixed outcomes, in which each cluster consists of one
continuous outcome and one binary outcome.
</p>


<h3>Usage</h3>

<pre><code class="language-R">cv.pgee(N, m, X, Z = NULL, y = NULL, yc = NULL, yb = NULL, K = 5,
  grid1, grid2 = NULL, wctype = "Ind", family = "Gaussian", eps = 1e-06,
  maxiter = 1000, tol.coef = 0.001, tol.score = 0.001, init = NULL,
  standardize = TRUE, penalty = "SCAD", warm = TRUE, weights = rep(1,
  N), type_c = "square", type_b = "deviance", marginal = 0, FDR = FALSE,
  fdr.corr = NULL, fdr.type = "all")
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>N</code></td>
<td>
<p>Number of clusters.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>m</code></td>
<td>
<p>Cluster size. Assumed equal across all clusters. Should be set to 2
for family=="Mixed".</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>X</code></td>
<td>
<p>Design matrix. If family=="Mixed", then design matrix for continuous
responses. For family!="Mixed", should have N*m rows. For family=="Mixed",
should have N rows.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>Z</code></td>
<td>
<p>Design matrix for binary responses for family=="Mixed". Should not
be provided for other family types. If not provided for family=="Mixed", is
set equal to X. For family!="Mixed", should have N*m rows. For
family=="Mixed", should have N rows.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>y</code></td>
<td>
<p>Response vector. Don't use this argument for family == "Mixed".
Instead, use arguments yc and yb. Since the cluster size is assumed equal
across clusters, the vector is assumed to have the form c(y_1,
y_2,...,y_N), with y_i = c(y_i1,...,y_im).</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>yc</code></td>
<td>
<p>Continuous response vector. Use only for family=="Mixed".</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>yb</code></td>
<td>
<p>Binary (0/1) response vector. Use only for family=="Mixed".</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>K</code></td>
<td>
<p>Number of folds.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>grid1</code></td>
<td>
<p>For family!="Mixed", the grid of tuning parameters. For
family=="Mixed", the grid of tuning parameters for coefficients
corresponding to the continuous outcomes.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>grid2</code></td>
<td>
<p>For family=="Mixed", the grid of tuning parameters for
coefficients corresponding to the binary outcomes. Not used for
family!="Mixed".</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>wctype</code></td>
<td>
<p>Working correlation type; one of "Ind", "CS", or "AR1". For
family=="Mixed", "CS" and "AR1" are equivalent.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>family</code></td>
<td>
<p>"Gaussian", "Binomial", or "Mixed" (use the last for bivariate
mixed outcomes). Note that for "Binomial", currently only binary outcomes
are supported.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>eps</code></td>
<td>
<p>Disturbance in the Linear Quadratic Approximation algorithm.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>maxiter</code></td>
<td>
<p>The maximum number of iterations the Newton algorithm tries
before declaring failure to converge.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>tol.coef</code></td>
<td>
<p>Converge of the Newton algorithm is declared if two
conditions are met: The L1-norm of the difference of successive iterates
should be less than tol.coef AND the L1-norm of the penalized score should
be less than tol.score.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>tol.score</code></td>
<td>
<p>See <code>tol.coef</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>init</code></td>
<td>
<p>Vector of initial values for regression coefficients. For
family=="Mixed", should be c(init_c, init_b). Defaults to glm values.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>standardize</code></td>
<td>
<p>Standardize the design matrices prior to estimation?</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>penalty</code></td>
<td>
<p>"SCAD", "MCP", or "LASSO".</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>warm</code></td>
<td>
<p>Use warm starts?</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>weights</code></td>
<td>
<p>Vector of cluster weights. All observations in a cluster are
assumed to have the same weight.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>type_c</code></td>
<td>
<p>Loss function for continuous outcomes. "square" (square error
loss, the default) or "absolute" (absolute error loss).</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>type_b</code></td>
<td>
<p>Loss function for binary outcomes. "deviance" (binomial
deviance, the default) or "classification" (prediction error).</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>marginal</code></td>
<td>
<p>For the mixed outcomes case, set to 0 (the default) to
account for both the continuous loss and the binary loss, set to 1 to only
account for the continuous loss, and set to 2 to only account for the
binary loss.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>FDR</code></td>
<td>
<p>Should the false discovery rate be estimated for family=="Mixed"?
Currently, FDR cannot be estimated for other family types.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>fdr.corr</code></td>
<td>
<p>Association parameter to use in FDR estimation. The default
is to use the association parameter estimated from the PGEEs.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>fdr.type</code></td>
<td>
<p>Estimate the FDR for only the coefficients corresponding to
the continuous outcomes ("continuous"), for only the coefficients
corresponding to the binary outcomes ("binary"), or for all coefficients
("all", the default).</p>
</td>
</tr>
</table>
<h3>Details</h3>

<p>The function calls <code>pgee.fit</code> <code>K</code> times, each time leaving out
1/<code>K</code> of the data. The cross-validation error is determined by the
arguments <code>type_c</code> and <code>type_b</code>. For family=="Mixed", the
cross-validation error is (by default) the sum of the continuous error and
the binary error.
</p>


<h3>Value</h3>

<p>A list
</p>
<table>
<tr style="vertical-align: top;">
<td><code>coefficients</code></td>
<td>
<p>Vector of estimated regression
coefficients. For family=="Mixed", this takes the form c(coef_c, coef_b).</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>vcov</code></td>
<td>
<p>Sandwich formula based covariance matrix of estimated
regression coefficients (other than the intercept(s)). The row/column
names correspond to elements of <code>coefficients</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>phi</code></td>
<td>
<p>Estimated dispersion parameter.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>alpha</code></td>
<td>
<p>Estimated association parameter.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>num_iterations</code></td>
<td>
<p>Number of iterations the Newton algorithm ran.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>converge</code></td>
<td>
<p>0=converged, 1=did not converge.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>PenScore</code></td>
<td>
<p>Vector of penalized score functions at the
estimated regression coefficients. If the algorithm converges, then these
should be close to zero.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>FDR</code></td>
<td>
<p>Estimated FDR for family=="Mixed", if requested.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>lambda.loss</code></td>
<td>
<p>Cross validation loss (error) for the
optimal tuning parameter(s) lambda, averaged across folds.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>LossMat</code></td>
<td>
<p>Matrix of cross validation losses. Rows denote tuning
parameter values, columns denote folds.</p>
</td>
</tr>
</table>
<h3>Examples</h3>

<pre><code class="language-R">## Not run: 
# Gaussian
N &lt;- 100
m &lt;- 10
p &lt;- 50
y &lt;- rnorm(N * m)
# If you want standardize = TRUE, you must provide an intercept.
X &lt;- cbind(1, matrix(rnorm(N * m * (p - 1)), N * m, p - 1))
gr1 &lt;- seq(0.001, 0.1, length.out = 100)
fit &lt;- cv.pgee(X = X, y = y, N = N, m = m, grid1 = gr1, wctype = "CS",
            family = "Gaussian")

# Binary
y &lt;- sample(0:1, N*m, replace = TRUE)
fit &lt;- cv.pgee(X = X, y = y, N = N, m = m, grid1 = gr1, wctype = "CS",
            family = "Binomial")

# Bivariate mixed outcomes
# Generate some data
Bc &lt;- c(2.0, 3.0, 1.5, 2.0, rep(0,times=p-4))
Bb &lt;- c(0.7, -0.7, -0.4, rep(0,times=p-3))
dat &lt;- gen_mixed_data(Bc, Bc, N, 0.5)
# We require two grids of tuning parameters
gr2 &lt;- seq(0.0001, 0.01, length.out = 100)
# Estimate regression coefficients and false discovery rate
fit &lt;- cv.pgee(X = dat$X, Z = dat$Z, yc = dat$yc, yb = dat$yb, N = N, m = 2,
               wctype = "CS", family = "Mixed", grid1 = gr1, grid2 = gr2,
               FDR = TRUE)

## End(Not run)
</code></pre>


</div>