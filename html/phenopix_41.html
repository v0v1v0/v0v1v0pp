<div class="container">

<table style="width: 100%;"><tr>
<td>PhenoKl</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>
Extract phenophases from a fitted equation according to Klosterman et al. 2014
</h2>

<h3>Description</h3>

<p>A function for the extraction of phenological thresholds according to Klosterman et al. 2014. 
This is a rather internal function. Use PhenoExtract with method='klosterman' instead. 
</p>


<h3>Usage</h3>

<pre><code class="language-R">PhenoKl(x, uncert = FALSE, fit, breaks, ...)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>x</code></td>
<td>

<p>A named vector with the parameters of the equation used to fit the data. 
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>uncert</code></td>
<td>

<p>Currently unused
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>fit</code></td>
<td>

<p>A list structured as in output from the fitting procedures, such as GuFit, 
KlostermanFit, ElmoreFit, BeckFit.
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>breaks</code></td>
<td>

<p>Currently unused
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>...</code></td>
<td>

<p>Further arguments, currently not used.
</p>
</td>
</tr>
</table>
<h3>Details</h3>

<p>Threshold extraction is performed according to Klosterman et al (2014) with a 
modification derived from Zhang et al (2003). Briefly, the rate of curvature 
(k) as defined in Klosterman et al (2014) is computed and inflection points 
are evaluated on its derivative (derK). The growing season is splitted in 
its increasing and decreasing parts around the maximum. The same happens to 
derK. Greenup date is defined as the day of maximum derK (a local maximum) 
before the first minimum in derK in the increasing part of the curve. 
Maturity is defined as the maximum in derK between the minimum of derK 
and mid season. Senescence is defined as the first local minimum in the 
decreasing part of derK. Dormancy is defined as the last local minimum 
in derK. Phases are named after Zhang et al (2003).     
</p>


<h3>Value</h3>

<p>A named vector of length 4 with the extracted thresholds: Greenup, 
Maturity, Senescence, Dormancy.  
</p>


<h3>Note</h3>

<p>Since this threshold extraction is based on a derivable function, 
it cannot be performed on raw data. 
Uncertainty estimation with this method on a fitted curve from 
SplineFit is currently not implemented. Instead you can use PhenoKl 
in a for loop cycling in  the uncertainty dataframe columns. 

</p>


<h3>Author(s)</h3>

<p>Gianluca Filippa &lt;gian.filippa@gmail.com&gt;
</p>


<h3>References</h3>

<p>Klosterman ST, Hufkens K, Gray JM, Melaas E, Sonnentag O, Lavine I, 
Mitchell L, Norman R, Friedl MA, Richardson A D (2014) Evaluating 
remote sensing of deciduous forest phenology at multiple spatial 
scales using PhenoCam imagery, Biogeosciences, 11, 4305-4320, 
doi:10.5194/bg-11-4305-2014.
</p>
<p>Zhang X, Friedl MA, Schaaf CB, Strahler AH, Hodges JCF, Gao F, Reed BC, 
Huete A (2003) Monitoring vegetation phenology using MODIS, Remote 
Sens. Environ., 84, 471-475.
</p>


<h3>See Also</h3>

<p><code>PhenoExtract</code>

</p>


<h3>Examples</h3>

<pre><code class="language-R">## Not run: 
data(bartlett2009.fitted)
klosterman.phenophases &lt;- PhenoKl(
	x=bartlett2009.fitted$fit$params, 
	fit=bartlett2009.fitted$fit)
plot(bartlett2009.fitted$fit$predicted)
abline(v=klosterman.phenophases[1:4], col=palette())
mtext(names(klosterman.phenophases[1:4]), 
	at=klosterman.phenophases[1:4], line=-2:-5, 
	col=palette()[1:4])

## End(Not run)
</code></pre>


</div>