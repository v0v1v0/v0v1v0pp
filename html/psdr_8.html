<div class="container">

<table style="width: 100%;"><tr>
<td>IdentifyMaxOnXY</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>Given a xy plot. Find the maximum value on the plot</h2>

<h3>Description</h3>

<p>To generate a curve of points, interpolation is used
and the range and increment can be specified. Will output
a message if multiple maxima are detected.
</p>


<h3>Usage</h3>

<pre><code class="language-R">IdentifyMaxOnXY(x_vector, y_vector, x_start = 0, x_end, x_increment)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>x_vector</code></td>
<td>
<p>A numerical vector with x coordinates.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>y_vector</code></td>
<td>
<p>A numerical vector with y coordinates.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>x_start</code></td>
<td>
<p>Numeric value specifying start of x value to look at.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>x_end</code></td>
<td>
<p>Numeric value specifying end of x value to look at.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>x_increment</code></td>
<td>
<p>Numeric value specifying the increment of the x-values to use.</p>
</td>
</tr>
</table>
<h3>Value</h3>

<p>A vector with two elements, The first element is the x value
where the max y value is found. The second element is the max y value.
</p>


<h3>Examples</h3>

<pre><code class="language-R">
#I want to create a plot that shows two curves:
#1. Composite of time series signals 1, 2, and 3.
#2. Composite of time series signals 3 and 4.

#Create a vector of time that represent times where data are sampled.
Fs = 100; #sampling frequency in Hz
T = 1/Fs; #sampling period
L = 1000; #length of time vector
t = (0:(L-1))*T; #time vector

#First signal
#1. 1 Hz with amplitude of 2
S1 &lt;- 2*sin(2*pi*1*t)
level1.vals &lt;- rep("a", length(S1))
level2.vals &lt;- rep("1", length(S1))
S1.data.frame &lt;- as.data.frame(cbind(t, S1, level1.vals, level2.vals))
colnames(S1.data.frame) &lt;- c("Time", "Signal", "level1.ID", "level2.ID")
S1.data.frame[,"Signal"] &lt;- as.numeric(S1.data.frame[,"Signal"])

#Second signal
#1. 1 Hz with amplitude of -4
#2. 2 Hz with amplitude of -2
S2 &lt;- (-4)*sin(2*pi*1*t) - 2*sin(2*pi*2*t);
level1.vals &lt;- rep("a", length(S2))
level2.vals &lt;- rep("2", length(S2))
S2.data.frame &lt;- as.data.frame(cbind(t, S2, level1.vals, level2.vals))
colnames(S2.data.frame) &lt;- c("Time", "Signal", "level1.ID", "level2.ID")
S2.data.frame[,"Signal"] &lt;- as.numeric(S2.data.frame[,"Signal"])

#Third signal
#1. 1 Hz with amplitude of 2
#2. 2 Hz with amplitude of 2
S3 &lt;- 2*sin(2*pi*1*t) + 2*sin(2*pi*2*t);
level1.vals &lt;- rep("a", length(S3))
level2.vals &lt;- rep("3", length(S3))
S3.data.frame &lt;- as.data.frame(cbind(t, S3, level1.vals, level2.vals))
colnames(S3.data.frame) &lt;- c("Time", "Signal", "level1.ID", "level2.ID")
S3.data.frame[,"Signal"] &lt;- as.numeric(S3.data.frame[,"Signal"])

#Fourth signal
#1. 1 Hz with amplitude of -2
S4 &lt;- -2*sin(2*pi*1*t)
level1.vals &lt;- rep("b", length(S4))
level2.vals &lt;- rep("3", length(S4))
S4.data.frame &lt;- as.data.frame(cbind(t, S4, level1.vals, level2.vals))
colnames(S4.data.frame) &lt;- c("Time", "Signal", "level1.ID", "level2.ID")
S4.data.frame[,"Signal"] &lt;- as.numeric(S4.data.frame[,"Signal"])

#Extra representation of S2 dataframe to show an example that has enough samples
#to have significance for Kruskal-Wallis test
windows &lt;- list(S1.data.frame, S2.data.frame, S2.data.frame, S2.data.frame, S2.data.frame,
S2.data.frame, S2.data.frame, S2.data.frame, S2.data.frame, S2.data.frame, S3.data.frame,
S4.data.frame)

#Gets the composite of the first, second, and third signal. Should result in a flat signal.
FirstComboToUse &lt;- list( c("a"), c(1, 2, 3) )

#Gets the composite of the third and fourth signal
SecondComboToUse &lt;- list( c("a", "b"), c(3) )


#PSD-------------------------------------------------------------------------

PSD.results &lt;- AutomatedCompositePlotting(list.of.windows = windows,
                           name.of.col.containing.time.series = "Signal",
                           x_start = 0,
                           x_end = 10,
                           x_increment = 0.01,
                           level1.column.name = "level1.ID",
                           level2.column.name = "level2.ID",
                           level.combinations = list(FirstComboToUse, SecondComboToUse),
                           level.combinations.labels = c("Signal 1 + 2 + 3", "Signal 3 + 4"),
                           plot.title = "Example",
                           plot.xlab = "Hz",
                           plot.ylab = "(Original units)^2/Hz",
                           combination.index.for.envelope = 2,
                           TimeSeries.PSD.LogPSD = "PSD",
                           sampling_frequency = 100)

ggplot.obj.PSD &lt;- PSD.results[[2]]

dataframes.plotted &lt;- PSD.results[[1]]

first.curve &lt;- dataframes.plotted[[1]]

second.curve &lt;- dataframes.plotted[[2]]

first.curve.max &lt;- IdentifyMaxOnXY(first.curve$xvals, first.curve$yvals, 0, 10, 0.01)
first.curve.max.limited &lt;- IdentifyMaxOnXY(first.curve$xvals, first.curve$yvals, 1.25, 2.5, 0.01)

second.curve.max &lt;- IdentifyMaxOnXY(second.curve$xvals, second.curve$yvals, 0, 10, 0.01)


</code></pre>


</div>