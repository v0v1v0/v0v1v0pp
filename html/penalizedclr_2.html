<div class="container">

<table style="width: 100%;"><tr>
<td>default.pf</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>Data adaptive candidate vector of penalty factors for L1 penalty in conditional logistic regression with covariates divided in blocks</h2>

<h3>Description</h3>

<p>Computes a data adaptive vector of penalty factors for  blocks of covariates by fitting
a tentative penalized conditional logistic regression model. The penalty for the <code>i</code>th block is obtained
as the inverse of the arithmetic mean of coefficient estimates for its covariates.
</p>


<h3>Usage</h3>

<pre><code class="language-R">default.pf(
  response,
  stratum,
  penalized,
  unpenalized = NULL,
  alpha = 1,
  p = NULL,
  standardize = TRUE,
  event,
  nfolds = 10,
  type.step1,
  verbose = FALSE
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>response</code></td>
<td>
<p>The response variable, either a 0/1 vector or a factor with two levels.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>stratum</code></td>
<td>
<p>A numeric vector with stratum membership of each observation.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>penalized</code></td>
<td>
<p>A matrix of penalized covariates.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>unpenalized</code></td>
<td>
<p>A matrix of additional unpenalized covariates.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>alpha</code></td>
<td>
<p>The elastic net mixing parameter, a number between 0 and 1.
alpha=0 would give pure ridge; alpha=1 gives lasso. Pure ridge penalty is never obtained in this implementation since alpha must be positive.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>p</code></td>
<td>
<p>The sizes of blocks of covariates,
a numerical vector of the length equal to the number of blocks,
and with the sum equal to the number of penalized covariates.
If missing, all covariates are treated the same and a single penalty is applied.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>standardize</code></td>
<td>
<p>Should the covariates be standardized, a logical value.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>event</code></td>
<td>
<p>If response is a factor, the level that
should be considered a success in the logistic regression.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>nfolds</code></td>
<td>
<p>The number of folds used in cross-validation. Default is 10.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>type.step1</code></td>
<td>
<p>Should the tentative model be fit on all covariates jointly (<code>comb</code>) or to each block separately (<code>sep</code>).</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>verbose</code></td>
<td>
<p>Logical. Should the message about the obtained penalty factors be printed?</p>
</td>
</tr>
</table>
<h3>Details</h3>

<p>Blocks that contain covariates with large estimated coefficients will obtain a smaller penalty.
If all estimated coefficients pertaining to a block are zero, the function returns a message.
A tentative conditional logistic regression model is fit either to each covariates block separately (<code>type.step1 = "sep"</code>) or  jointly to all blocks (<code>type.step1 = "comb"</code>).
Note that <code>unpenalized = NULL</code> is the only implemented option  in this function as of now.
</p>


<h3>Value</h3>

<p>The function returns a list containing the  vector of penalty factors correspondng to different blocks.
</p>


<h3>References</h3>

<p>Schulze G. (2017) Clinical Outcome Prediction based on Multi-Omics Data: Extension of IPF-LASSO. Master Thesis.
</p>


<h3>See Also</h3>

<p>find.default.lambda
</p>


</div>