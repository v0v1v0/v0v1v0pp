<div class="container">

<table style="width: 100%;"><tr>
<td>impute_na</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>Impute missing values</h2>

<h3>Description</h3>

<p>This function imputes missing values using a user-specified
imputation method.
</p>


<h3>Usage</h3>

<pre><code class="language-R">impute_na(
  df,
  method = "minProb",
  tune_sigma = 1,
  q = 0.01,
  maxiter = 10,
  ntree = 20,
  n_pcs = 2,
  seed = NULL
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>df</code></td>
<td>
<p>A <code>raw_df</code> object (output of <code>create_df</code>)
containing missing values or a <code>norm_df</code> object after performing
normalization.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>method</code></td>
<td>
<p>Imputation method to use. Default is <code>"minProb"</code>.
Available methods: <code>"minDet", "RF", "kNN", and "SVD"</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>tune_sigma</code></td>
<td>
<p>A scalar used in the <code>"minProb"</code> method for
controlling the standard deviation of the Gaussian distribution
from which random values are drawn for imputation.<br>
Default is 1.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>q</code></td>
<td>
<p>A scalar used in <code>"minProb"</code> and <code>"minDet"</code> methods
to obtain a low intensity value for imputation. <code>q</code> should be set to a
very low value. Default is 0.01.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>maxiter</code></td>
<td>
<p>Maximum number of iterations to be performed when using the
<code>"RF"</code> method. Default is <code>10</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>ntree</code></td>
<td>
<p>Number of trees to grow in each forest when using the
<code>"RF"</code> method. Default is <code>20</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>n_pcs</code></td>
<td>
<p>Number of principal components to calculate when using the
<code>"SVD"</code> method. Default is 2.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>seed</code></td>
<td>
<p>Numerical. Random number seed. Default is <code>NULL</code></p>
</td>
</tr>
</table>
<h3>Details</h3>

<ul>
<li>
<p> Ideally, you should first remove proteins with
high levels of missing data using the <code>filterbygroup_na</code> function
before running <code>impute_na</code> on the <code>raw_df</code> object or the
<code>norm_df</code> object.
</p>
</li>
<li> <p><code>impute_na</code> function imputes missing values using a
user-specified imputation method from the available options, <code>minProb</code>,
<code>minDet</code>, <code>kNN</code>, <code>RF</code>, and <code>SVD</code>.
</p>
</li>
<li> <p><strong>Note: Some imputation methods may require that the data be normalized
prior to imputation.</strong>
</p>
</li>
<li>
<p> Make sure to fix the random number seed with <code>seed</code> for reproducibility</p>
</li>
</ul>
<p>.
</p>


<h3>Value</h3>

<p>An <code>imp_df</code> object, which is a data frame of protein intensities
with no missing values.
</p>


<h3>Author(s)</h3>

<p>Chathurani Ranathunge
</p>


<h3>References</h3>

<p>Lazar, Cosmin, et al. "Accounting for the multiple natures of
missing values in label-free quantitative proteomics data sets to compare
imputation strategies." Journal of proteome research 15.4 (2016): 1116-1125.
</p>


<h3>See Also</h3>

<p>More information on the available imputation methods can be found
in their respective packages.
</p>
<ul>
<li> <p><code>create_df</code>
</p>
</li>
<li>
<p> For <code>minProb</code> and
<code>minDet</code> methods, see
<code>imputeLCMD</code> package.
</p>
</li>
<li>
<p> For Random Forest (<code>RF</code>) method, see
<code>missForest</code>.
</p>
</li>
<li>
<p> For <code>kNN</code> method, see <code>kNN</code> from the
<code>VIM</code> package.
</p>
</li>
<li>
<p> For <code>SVD</code> method, see <code>pca</code> from the
<code>pcaMethods</code> package.</p>
</li>
</ul>
<h3>Examples</h3>

<pre><code class="language-R">## Generate a raw_df object with default settings. No technical replicates.
raw_df &lt;- create_df(
  prot_groups = "https://raw.githubusercontent.com/caranathunge/promor_example_data/main/pg1.txt",
  exp_design = "https://raw.githubusercontent.com/caranathunge/promor_example_data/main/ed1.txt"
)

## Impute missing values in the data frame using the default minProb
## method.
imp_df1 &lt;- impute_na(raw_df, seed = 3312)


## Impute using the RF method with the number of iterations set at 5
## and number of trees set at 100.
imp_df2 &lt;- impute_na(raw_df,
  method = "RF",
  maxiter = 5, ntree = 100,
  seed = 3312
)


## Using the kNN method.
imp_df3 &lt;- impute_na(raw_df, method = "kNN", seed = 3312)



## Using the SVD method with n_pcs set to 3.
imp_df4 &lt;- impute_na(raw_df, method = "SVD", n_pcs = 3, seed = 3312)

## Using the minDet method with q set at 0.001.
imp_df5 &lt;- impute_na(raw_df, method = "minDet", q = 0.001, seed = 3312)

## Impute a normalized data set using the kNN method
imp_df6 &lt;- impute_na(ecoli_norm_df, method = "kNN")

</code></pre>


</div>