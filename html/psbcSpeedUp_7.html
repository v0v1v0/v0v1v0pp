<div class="container">

<table style="width: 100%;"><tr>
<td>psbcSpeedUp</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>Function to Fit the Bayesian Cox Lasso Model</h2>

<h3>Description</h3>

<p>This a speed-up and extended version of the function <code>psbcGL()</code> in the R package <code>psbcGrouup</code>
</p>


<h3>Usage</h3>

<pre><code class="language-R">psbcSpeedUp(
  survObj = NULL,
  p = 0,
  q = 0,
  hyperpar = list(),
  nIter = 1,
  burnin = 0,
  thin = 1,
  rw = FALSE,
  outFilePath,
  tmpFolder = "tmp/"
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>survObj</code></td>
<td>
<p>a list containing observed data from <code>n</code> subjects;
<code>t</code>, <code>di</code>, <code>x</code>. See details for more information</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>p</code></td>
<td>
<p>number of covariates for variable selection</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>q</code></td>
<td>
<p>number of mandatory covariates</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>hyperpar</code></td>
<td>
<p>a list containing prior parameter values; among
<code>c('groupInd', 'beta.ini', 'eta0', 'kappa0', 'c0', 'r', 'delta',
'lambdaSq', 'sigmaSq', 'tauSq', 's', 'h', 'beta.prop.var',
'beta.clin.var')</code>. See details for more information</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>nIter</code></td>
<td>
<p>the number of iterations of the chain</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>burnin</code></td>
<td>
<p>number of iterations to discard at the start of the chain.
Default is 0</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>thin</code></td>
<td>
<p>thinning MCMC intermediate results to be stored</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>rw</code></td>
<td>
<p>when setting to "TRUE", the conventional random walk Metropolis
Hastings algorithm is used. Otherwise, the mean and the variance of the
proposal density is updated using the jumping rule described in
Lee et al. (2011)</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>outFilePath</code></td>
<td>
<p>path to where the output files are to be written</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>tmpFolder</code></td>
<td>
<p>the path to a temporary folder where intermediate data
files are stored (will be erased at the end of the chain). It is specified
relative to <code>outFilePath</code></p>
</td>
</tr>
</table>
<h3>Details</h3>

<p>psbcSpeedUp
</p>

<table>
<tr>
<td style="text-align: left;">
<code>t</code> </td>
<td style="text-align: left;"> a vector of <code>n</code> times to the event </td>
</tr>
<tr>
<td style="text-align: left;">
<code>di</code> </td>
<td style="text-align: left;"> a vector of <code>n</code> censoring indicators for the event time (1=event occurred, 0=censored) </td>
</tr>
<tr>
<td style="text-align: left;">
<code>x</code> </td>
<td style="text-align: left;"> covariate matrix, <code>n</code> observations by <code>p</code> variables</td>
</tr>
<tr>
<td style="text-align: left;">
<code>groupInd</code> </td>
<td style="text-align: left;"> a vector of <code>p</code> group indicator for each variable</td>
</tr>
<tr>
<td style="text-align: left;">
<code>beta.ini</code> </td>
<td style="text-align: left;"> the starting values for coefficients <code class="reqn">\beta</code>
</td>
</tr>
<tr>
<td style="text-align: left;">
<code>eta0</code> </td>
<td style="text-align: left;"> scale parameter of gamma process prior for the cumulative baseline hazard, <code class="reqn">\eta_0 &gt; 0</code>
</td>
</tr>
<tr>
<td style="text-align: left;">
<code>kappa0</code> </td>
<td style="text-align: left;"> shape parameter of gamma process prior for the cumulative baseline hazard, <code class="reqn">\kappa_0 &gt; 0</code>
</td>
</tr>
<tr>
<td style="text-align: left;">
<code>c0</code> </td>
<td style="text-align: left;"> the confidence parameter of gamma process prior for the cumulative baseline hazard, <code class="reqn">c_0 &gt; 0</code>
</td>
</tr>
<tr>
<td style="text-align: left;">
<code>r</code> </td>
<td style="text-align: left;"> the shape parameter of the gamma prior for <code class="reqn">\lambda^2</code>
</td>
</tr>
<tr>
<td style="text-align: left;">
<code>delta</code> </td>
<td style="text-align: left;"> the rate parameter of the gamma prior for <code class="reqn">\lambda^2</code>
</td>
</tr>
<tr>
<td style="text-align: left;">
<code>lambdaSq</code> </td>
<td style="text-align: left;"> the starting value for <code class="reqn">\lambda^2</code>
</td>
</tr>
<tr>
<td style="text-align: left;">
<code>sigmaSq</code> </td>
<td style="text-align: left;"> the starting value for <code class="reqn">\sigma^2</code>
</td>
</tr>
<tr>
<td style="text-align: left;">
<code>tauSq</code> </td>
<td style="text-align: left;"> the starting values for <code class="reqn">\tau^2</code>
</td>
</tr>
<tr>
<td style="text-align: left;">
<code>s</code> </td>
<td style="text-align: left;"> the set of time partitions for specification of the cumulative baseline hazard function</td>
</tr>
<tr>
<td style="text-align: left;">
<code>h</code> </td>
<td style="text-align: left;"> the starting values for <code class="reqn">h</code>
</td>
</tr>
<tr>
<td style="text-align: left;">
<code>beta.prop.var</code> </td>
<td style="text-align: left;"> the variance of the proposal density for <code class="reqn">\beta</code> in a random walk M-H sampler</td>
</tr>
<tr>
<td style="text-align: left;">
<code>beta.clin.var</code> </td>
<td style="text-align: left;"> the starting value for the variance of <code class="reqn">\beta</code>
</td>
</tr>
<tr>
<td style="text-align: left;">
</td>
</tr>
</table>
<h3>Value</h3>

<p>An object of class <code>psbcSpeedUp</code> is saved as
<code>obj_psbcSpeedUp.rda</code> in the output file, including the following components:
</p>

<ul>
<li>
<p> input - a list of all input parameters by the user
</p>
</li>
<li>
<p> output - a list of the all output estimates:
</p>

<ul>
<li>
<p> "<code>beta.p</code>" - a matrix with MCMC intermediate estimates of the regression coefficients.
</p>
</li>
<li>
<p> "<code>h.p</code>" - a matrix with MCMC intermediate estimates of the increments in the cumulative baseline hazard in each interval.
</p>
</li>
<li>
<p> "<code>tauSq.p</code>" - a vector MCMC intermediate estimates of the hyperparameter "tauSq".
</p>
</li>
<li>
<p> "<code>sigmaSq.p</code>" - a vector MCMC intermediate estimates of the hyperparameter "sigmaSq".
</p>
</li>
<li>
<p> "<code>lambdaSq.p</code>" - a vector MCMC intermediate estimates of the hyperparameter "lambdaSq".
</p>
</li>
<li>
<p> "<code>accept.rate</code>" - a vector acceptance rates of individual regression coefficients.
</p>
</li>
</ul>
</li>
<li>
<p> call - the matched call.
</p>
</li>
</ul>
<h3>References</h3>

<p>Lee KH, Chakraborty S, and Sun J (2011). Bayesian Variable
Selection in Semiparametric Proportional Hazards Model for High Dimensional
Survival Data. <em>The International Journal of Biostatistics</em>, 7(1):1-32.
</p>
<p>Zucknick M, Saadati M, and Benner A (2015). Nonidentical twins:
Comparison of frequentist and Bayesian lasso for Cox models.
<em>Biometrical Journal</em>, 57(6):959â€“81.
</p>


<h3>Examples</h3>

<pre><code class="language-R">
# Load the example dataset
data("exampleData", package = "psbcSpeedUp")
p &lt;- exampleData$p
q &lt;- exampleData$q
survObj &lt;- exampleData[1:3]

# Set hyperparameters
mypriorPara &lt;- list(
  "groupInd" = 1:p, "eta0" = 0.02, "kappa0" = 1, "c0" = 2, "r" = 10 / 9,
  "delta" = 1e-05, "lambdaSq" = 1, "sigmaSq" = runif(1, 0.1, 10),
  "beta.prop.var" = 1, "beta.clin.var" = 1
)


# run Bayesian Lasso Cox
library("psbcSpeedUp")
set.seed(123)
fitBayesCox &lt;- psbcSpeedUp(survObj,
  p = p, q = q, hyperpar = mypriorPara,
  nIter = 10, burnin = 0, outFilePath = tempdir()
)
plot(fitBayesCox, color = "blue")


</code></pre>


</div>