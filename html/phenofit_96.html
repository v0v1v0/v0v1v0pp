<div class="container">

<table style="width: 100%;"><tr>
<td>optim_pheno</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>optim_pheno</h2>

<h3>Description</h3>

<p>Interface of optimization functions for double logistics and other parametric
curve fitting functions.
</p>


<h3>Usage</h3>

<pre><code class="language-R">optim_pheno(
  prior,
  sFUN,
  y,
  t,
  tout,
  method,
  w,
  nptperyear,
  ylu,
  iters = 2,
  wFUN = wTSM,
  lower = -Inf,
  upper = Inf,
  constrain = TRUE,
  verbose = FALSE,
  ...,
  use.cpp = FALSE
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>prior</code></td>
<td>
<p>A vector of initial values for the parameters for which optimal
values are to be found. <code>prior</code> is suggested giving a column name.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>sFUN</code></td>
<td>
<p>The name of fine curve fitting functions, can be one of <code style="white-space: pre;">⁠ 'FitAG', 'FitDL.Beck', 'FitDL.Elmore', 'FitDL.Gu' and 'FitDL.Klos', 'FitDL.Zhang'⁠</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>y</code></td>
<td>
<p>Numeric vector, vegetation index time-series</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>t</code></td>
<td>
<p>Numeric vector, <code>Date</code> variable</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>tout</code></td>
<td>
<p>Corresponding doy of prediction.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>method</code></td>
<td>
<p>The name of optimization method to solve fine fitting, one of
<code style="white-space: pre;">⁠'BFGS','CG','Nelder-Mead', 'L-BFGS-B', 'nlm', 'nlminb', 'ucminf'⁠</code> and
<code style="white-space: pre;">⁠'spg','Rcgmin','Rvmmin', 'newuoa','bobyqa','nmkb','hjkb'⁠</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>w</code></td>
<td>
<p>(optional) Numeric vector, weights of <code>y</code>. If not specified,
weights of all <code>NA</code> values will be <code>wmin</code>, the others will be 1.0.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>nptperyear</code></td>
<td>
<p>Integer, number of images per year, passed to <code>wFUN</code>.
Only <code>wTSM()</code> needs <code>nptperyear</code>. If not specified,
<code>nptperyear</code> will be calculated based on <code>t</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>ylu</code></td>
<td>
<p><code style="white-space: pre;">⁠[ymin, ymax]⁠</code>, which is used to force <code>ypred</code> in the range of <code>ylu</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>iters</code></td>
<td>
<p>How many times curve fitting is implemented.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>wFUN</code></td>
<td>
<p>weights updating function, can be one of 'wTSM', 'wChen' and
'wBisquare'.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>lower, upper</code></td>
<td>

<p>vectors of lower and upper bounds, replicated to be as long as
<code>start</code>.  If unspecified, all parameters are assumed to be
unconstrained.
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>constrain</code></td>
<td>
<p>boolean, whether to use parameter constrain</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>verbose</code></td>
<td>
<p>Whether to display intermediate variables?</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>...</code></td>
<td>
<p>other parameters passed to <code>I_optim()</code> or <code>I_optimx()</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>use.cpp</code></td>
<td>
<p>(unstable, not used) boolean, whether to use c++ defined fine
fitting function? If <code>FALSE</code>, R version will be used.</p>
</td>
</tr>
</table>
<h3>Value</h3>

<p>A <code>fFIT()</code> object, with the element of:
</p>

<ul>
<li> <p><code>tout</code>: The time of output curve fitting time-series.
</p>
</li>
<li> <p><code>zs</code>  : Smoothed vegetation time-series of every iteration.
</p>
</li>
<li> <p><code>ws</code>  : Weights of every iteration.
</p>
</li>
<li> <p><code>par</code> : Final optimized parameter of fine fitting.
</p>
</li>
<li> <p><code>fun</code> : The name of fine fitting.
</p>
</li>
</ul>
<h3>See Also</h3>

<p><code>fFIT()</code>, <code>stats::nlminb()</code>
</p>


<h3>Examples</h3>

<pre><code class="language-R"># library(magrittr)
# library(purrr)

# simulate vegetation time-series
t    &lt;- seq(1, 365, 8)
tout &lt;- seq(1, 365, 1)

FUN = doubleLog_Beck
par  = c( mn  = 0.1 , mx  = 0.7 , sos = 50 , rsp = 0.1 , eos = 250, rau = 0.1)
par0 = c( mn  = 0.15, mx  = 0.65, sos = 100, rsp = 0.12, eos = 200, rau = 0.12)

y &lt;- FUN(par, t)

methods = c("BFGS", "ucminf", "nlm", "nlminb")
opt1 &lt;- I_optim(par0, doubleLog_Beck, y, t, methods) # "BFGS", "ucminf", "nlm",
# opt2 &lt;- I_optimx(prior, fFUN, y, t, tout, )

sFUN   = "doubleLog.Beck" # doubleLog.Beck
r &lt;- optim_pheno(par0, sFUN, y, t, tout, method = methods[4],
                 nptperyear = 46, iters = 2, wFUN = wTSM, verbose = FALSE, use.julia = FALSE)
</code></pre>


</div>