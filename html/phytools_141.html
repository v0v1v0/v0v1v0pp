<div class="container">

<table style="width: 100%;"><tr>
<td>ltt</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>Creates lineage-through-time plot (including extinct lineages)</h2>

<h3>Description</h3>

<p>Computes and visualizes a lineage through time (LTT) plot, and related measures.
</p>


<h3>Usage</h3>

<pre><code class="language-R">ltt(tree, ...)
## S3 method for class 'phylo'
ltt(tree, plot=TRUE, drop.extinct=FALSE, log.lineages=TRUE, gamma=TRUE, ...)
## S3 method for class 'multiPhylo'
ltt(tree, drop.extinct=FALSE, gamma=TRUE, ...)
## S3 method for class 'simmap'
ltt(tree, plot=TRUE, log.lineages=FALSE, gamma=TRUE, ...)
## S3 method for class 'multiSimmap'
ltt(tree, gamma=TRUE, ...)
gtt(tree, n=100, ...)
mccr(obj, rho=1, nsim=100, ...)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>tree</code></td>
<td>
<p>an object of class <code>"phylo"</code>, <code>"multiPhylo"</code>, <code>"simmap"</code>, or <code>"multiSimmap"</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>plot</code></td>
<td>
<p>a logical value indicating whether or not to create LTT plot.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>drop.extinct</code></td>
<td>
<p>logical value indicating whether or not to drop extinct tips from the tree.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>log.lineages</code></td>
<td>
<p>logical value indicating whether LTT plot should be on log-linear (default for <code>"phylo"</code> and <code>"multiPhylo"</code> objects) or linear-linear scale.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>gamma</code></td>
<td>
<p>logical value indicating whether or not to compute <code class="reqn">\gamma</code> from Pybus &amp; Harvey (2000; <em>Proc. Roy. Soc. B</em>).</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>n</code></td>
<td>
<p>for <code>gtt</code> the number of time intervals to use to track <code class="reqn">\gamma</code> through time.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>obj</code></td>
<td>
<p>for <code>mccr</code> an object of class <code>"ltt"</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>rho</code></td>
<td>
<p>for <code>mccr</code> sampling fraction.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>nsim</code></td>
<td>
<p>for <code>mccr</code> number of simulations to use for the MCCR test.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>...</code></td>
<td>
<p>other arguments to be passed to plotting methods. See <code>plot.default</code>.</p>
</td>
</tr>
</table>
<h3>Details</h3>

<p>The function <code>ltt</code> computes LTT plot with extant and extinct lineages, and optionally conducts <code class="reqn">\gamma</code>-test of Pybus &amp; Harvey (2000). The object returned by <code>ltt</code> can be plotted or re-plotted using <code>plot</code>.
</p>
<p>For the case in which <code>tree</code> is an object of class <code>"simmap"</code> or <code>"multiSimmap"</code> then the object will contain the number of lineages through time (for each tree, in the case of <code>"multiSimmap"</code> objects) separated by mapped regimes.
</p>
<p>The function <code>gtt</code> computes the value of Pybus &amp; Harvey's <code class="reqn">\gamma</code> statistic through time by slicing the tree at various points - by default in even intervals from the time above the root at which <em>N</em> = 3 to the present day.
</p>
<p>The function <code>mccr</code> performs the MCCR test of Pybus &amp; Harvey (2000) which takes into account incomplete taxon sampling in computing a P-value of the <code class="reqn">\gamma</code> statistic.
</p>
<p>Although it is calculated here, it's unclear how to interpret the <code class="reqn">\gamma</code>-statistic if not all the tips in the tree are contemporaneous.
</p>


<h3>Value</h3>

<p><code>ltt</code> returns an object of class <code>"ltt"</code> which normally includes the following elements:
</p>
<table>
<tr style="vertical-align: top;">
<td><code>times</code></td>
<td>
<p>a vector of branching times.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>ltt</code></td>
<td>
<p>a vector of lineages, or a matrix of lineages in each state over time for objects of class <code>"simmap"</code> and <code>"multiSimmap"</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>gamma</code></td>
<td>
<p>optionally, a value for the <code class="reqn">\gamma</code>-statistic.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>p</code></td>
<td>
<p>two-tailed P-value for the <code class="reqn">\gamma</code>-test.</p>
</td>
</tr>
</table>
<p>If <code>tree</code> is an object of class <code>"multiPhylo"</code>, then an object of class <code>"multiLtt"</code> is returned consisting of a list of object of class <code>"ltt"</code>.
</p>
<p><code>gtt</code> returns an object of class <code>"gtt"</code>.
</p>
<p><code>mccr</code> returns of object of class <code>"mccr"</code>.
</p>


<h3>Author(s)</h3>

<p>Liam Revell <a href="mailto:liam.revell@umb.edu">liam.revell@umb.edu</a></p>


<h3>References</h3>

<p>Pybus, O. G., and P. H. Harvey (2000) Testing macro-evolutionary models using incomplete molecular phylogenies. <em>Proc. R. Soc. Lond. B</em>, <b>267</b>, 2267-2272.
</p>
<p>Revell, L. J. (2024) phytools 2.0: an updated R ecosystem for phylogenetic comparative methods (and other things). <em>PeerJ</em>, <b>12</b>, e16505.
</p>


<h3>See Also</h3>

<p><code>gammatest</code>, <code>ltt95</code>
</p>


<h3>Examples</h3>

<pre><code class="language-R">## LTT plots
set.seed(99)
trees&lt;-pbtree(n=100,scale=100,nsim=10)
obj&lt;-ltt(trees,plot=FALSE)
plot(obj,log="y",log.lineages=FALSE,
    bty="l")
title(main="LTT plots for 10 pure-birth trees",
    font.main=3)
tree&lt;-pbtree(b=1,d=0.25,t=4)
obj&lt;-ltt(tree,gamma=FALSE,show.tree=TRUE,
    bty="l")
title(main="LTT plot with superimposed tree",
    font.main=3)
obj
## GTT plot
data(anoletree)
anole.gtt&lt;-gtt(anoletree,n=40)
plot(anole.gtt)
</code></pre>


</div>