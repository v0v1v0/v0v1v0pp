<div class="container">

<table style="width: 100%;"><tr>
<td>conditional piecewise exponential</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>The Conditional Piecewise Exponential Distribution</h2>

<h3>Description</h3>

<p>Distribution function, quantile function and random generation for the piecewise exponential distribution <code class="reqn">t</code> with piecewise rate <code>rate</code> given <code class="reqn">t&gt;qT</code>.
</p>


<h3>Usage</h3>

<pre><code class="language-R">ppwexp_conditional(q, qT, rate=1, breakpoint=NULL, lower.tail=TRUE,
                   log.p=FALSE, one_piece, safety_check=TRUE)
qpwexp_conditional(p, qT, rate=1, breakpoint=NULL, lower.tail=TRUE,
                   log.p=FALSE, one_piece, safety_check=TRUE)
rpwexp_conditional(n, qT, rate, breakpoint=NULL)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>q</code></td>
<td>
<p>vector of quantiles.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>p</code></td>
<td>
<p>vector of probabilities.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>qT</code></td>
<td>
<p>the distribution is conditional on <code class="reqn">t&gt;</code><code>qT</code>. <code>qT</code> can be a scalar or a vector with the same length of <code>q</code> or <code>p</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>n</code></td>
<td>
<p>number of observations. Must be a positive integer with length 1. </p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>rate</code></td>
<td>
<p>a vector of rates in each piece.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>breakpoint</code></td>
<td>
<p>a vector of breakpoints. The length is <code>length(rate)-1</code>. Can be NULL if rate is a single value.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>log, log.p</code></td>
<td>
<p>logical; if TRUE, probabilities p are given as log(p).</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>lower.tail</code></td>
<td>
<p>logical; if TRUE (default), probabilities are <code class="reqn">P[X \le x]</code>, otherwise, <code class="reqn">P[X &gt; x]</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>one_piece</code></td>
<td>
<p>(only required when <code>safety_check=FALSE</code>) whether the distribution only has one piece (i.e.,
rate is a single value and breakpoint=NULL).</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>safety_check</code></td>
<td>
<p>logical; whether check the input arguments; if FALSE, function has better computing performance by skipping all safety checks.</p>
</td>
</tr>
</table>
<h3>Details</h3>

<p>See webpage <a href="https://zjph602xtc.github.io/PWEXP/">https://zjph602xtc.github.io/PWEXP/</a> for more details for its survival function, cumulative density function, quantile function.
</p>


<h3>Value</h3>

<p><code>ppwexp_conditional</code> gives the conditional distribution function, <code>qpwexp_conditional</code> gives the conditional quantile function, and <code>rpwexp_conditional</code> generates conditional random variables.
</p>
<p>The length of the result is determined by <code>q</code>, <code>p</code> or <code>n</code> for <code>ppwexp_conditional</code>, <code>qpwexp_conditional</code> or <code>rpwexp_conditional</code>. You can only specify a single piecewise exponential distribution every time you call these functions. This is different from the exponential distribution functions in package <span class="pkg">stats</span>.
</p>
<p>When the length of <code>qT</code> is 1, then all results are conditional on the same <code class="reqn">t&gt;</code><code>qT</code>.
In <code>rpwexp_conditional</code>, <code>qT</code> must be a scalar. When the length of <code>qT</code> equals to the length of <code>q</code> or <code>p</code>, then each value in the result is conditional on <code class="reqn">t&gt;</code><code>qT</code> for each value in <code>qT</code>.
</p>
<p>Arguments <code>rate</code> and <code>breakpoint</code> must match. The length of rate is the length of breakpoint + 1.
</p>


<h3>Author(s)</h3>

<p>Tianchen Xu <a href="mailto:zjph602xutianchen@gmail.com">zjph602xutianchen@gmail.com</a>
</p>


<h3>See Also</h3>

<p><code>dpwexp</code>,
<code>ppwexp</code>,
<code>qpwexp</code>,
<code>rpwexp</code>
</p>


<h3>Examples</h3>

<pre><code class="language-R"># CDF and qunatile function of conditional piecewise exp with rate 2, 1, 3 given t &gt; 0.1
t &lt;- seq(0.1, 1.2, 0.01)
F2_con &lt;- ppwexp_conditional(t, qT=0.1, rate=c(2, 1, 3), breakpoint=c(0.3, 0.8))
plot(t, F2_con, type='l', col='red', lwd=2, main="CDF and Quantile Function of
    Conditional \nPiecewsie Exp Dist", xlim=c(0, 1.2), ylim=c(0, 1.2))
lines(F2_con, qpwexp_conditional(F2_con, qT=0.1, rate=c(2, 1, 3),
    breakpoint=c(0.3,0.8)), lty=2, lwd=2, col='red')

# compare with CDF and quantile function of unconditional piecewise exp with rate 2, 1, 3
t &lt;- seq(0, 1.2, 0.01)
F2 &lt;- ppwexp(t, rate=c(2, 1, 3), breakpoint=c(0.3,0.8))
lines(t, F2, lwd=2)
lines(F2, qpwexp(F2, rate=c(2, 1, 3), breakpoint=c(0.3,0.8)), lty=2, lwd=2)
abline(v=0.1, col='grey')
abline(h=0.1, col='grey')
legend('topleft', c('CDF of piecewise exp dist given t &gt; 0.1', 'quantile
    function of piecewise exp dist given t &gt; 0.1', 'CDF of piecewise exp dist',
  'quantile function of piecewise exp dist'), col=c('red', 'red', 'black', 'black'),
  lty=c(1, 2, 1, 2), lwd=2)

# use rpwexp_conditional function to generate piecewise exp samples with rate 2, 1, 3 given t &gt; 0.1
r_sample_con &lt;- rpwexp_conditional(3000, qT=0.1, rate=c(2, 1, 3), breakpoint=c(0.3,0.8))
plot(ecdf(r_sample_con), col='red', lwd=2,  main="Empirical CDF of Conditional
    Piecewsie Exp Dist", xlim=c(0, 1.2), ylim=c(0, 1))

# compare with its CDF
lines(seq(0.1, 1.2, 0.01), F2_con, lwd=2)
legend('topleft', c('empirial CDF of piecewise exp dist given t &gt; 0.1',
    'true CDF of piecewise exp dist given t &gt; 0.1'), col=c('red', 'black'), lty=c(1,2), lwd=2)
</code></pre>


</div>