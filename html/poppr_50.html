<div class="container">

<table style="width: 100%;"><tr>
<td>diversity_boot</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>Perform a bootstrap analysis on diversity statistics</h2>

<h3>Description</h3>

<p>This function is intended to perform bootstrap statistics on a matrix of
multilocus genotype counts in different populations. Results from this
function should be interpreted carefully as the default statistics are known
to have a downward bias. See the details for more information.
</p>


<h3>Usage</h3>

<pre><code class="language-R">diversity_boot(
  tab,
  n,
  n.boot = 1L,
  n.rare = NULL,
  H = TRUE,
  G = TRUE,
  lambda = TRUE,
  E5 = TRUE,
  ...
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>tab</code></td>
<td>
<p>a table produced from the <span class="pkg">poppr</span> function
<code>mlg.table()</code>. MLGs in columns and populations in rows</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>n</code></td>
<td>
<p>an integer &gt; 0 specifying the number of bootstrap replicates to
perform (corresponds to <code>R</code> in the function <code>boot::boot()</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>n.boot</code></td>
<td>
<p>an integer specifying the number of samples to be drawn in each
bootstrap replicate. If <code>n.boot</code> &lt; 2 (default), the number of samples
drawn for each bootstrap replicate will be equal to the number of samples in
the data set.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>n.rare</code></td>
<td>
<p>a sample size at which all resamplings should be performed.
This should be no larger than the smallest sample size. Defaults to
<code>NULL</code>, indicating that each population will be sampled at its own
size.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>H</code></td>
<td>
<p>logical whether or not to calculate Shannon's index</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>G</code></td>
<td>
<p>logical whether or not to calculate Stoddart and Taylor's index (aka
inverse Simpson's index).</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>lambda</code></td>
<td>
<p>logical whether or not to calculate Simpson's index</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>E5</code></td>
<td>
<p>logical whether or not to calculate Evenness</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>...</code></td>
<td>
<p>other parameters passed on to <code>boot::boot()</code> and
<code>diversity_stats()</code>.</p>
</td>
</tr>
</table>
<h3>Details</h3>

<p>Bootstrapping is performed in three ways:
</p>

<ul><li>
<p> if <code>n.rare</code> is a number greater than zero, then bootstrapping
is performed by randomly sampling without replacement <em>n.rare</em>
samples from the data.
</p>
<div class="sourceCode"><pre>\item if `n.boot` is greater than 1, bootstrapping is performed by
sampling n.boot samples from a multinomial distribution weighted by the
proportion of each MLG in the data.

\item if `n.boot` is less than 2, bootstrapping is performed by 
sampling N samples from a multinomial distribution weighted by the
proportion of each MLG in the data.
</pre></div>
</li></ul>
<h4>Downward Bias</h4>

<p>When sampling with replacement, the diversity statistics here present a
downward bias partially due to the small number of samples in the data.
The result is that the mean of the bootstrapped samples will often be
much lower than the observed value. Alternatively, you can increase the
sample size of the bootstrap by increasing the size of <code>n.boot</code>. Both
of these methods should be taken with caution in interpretation. There
are several R packages freely available that will calculate and perform
bootstrap estimates of Shannon and Simpson diversity metrics (eg.
<span class="pkg">entropart</span>, <span class="pkg">entropy</span>, <span class="pkg">simboot</span>, and
<span class="pkg">EntropyEstimation</span>. These packages also offer unbiased estimators of
Shannon and Simpson diversity. Please take care when attempting to
interpret the results of this function.
</p>



<h3>Value</h3>

<p>a list of objects of class "boot".
</p>


<h3>Author(s)</h3>

<p>Zhian N. Kamvar
</p>


<h3>See Also</h3>

<p><code>diversity_stats()</code> for basic statistic calculation,
<code>diversity_ci()</code> for confidence intervals and plotting, and
<code>poppr()</code>. For bootstrap sampling:
<code>stats::rmultinom()</code> <code>boot::boot()</code>
</p>


<h3>Examples</h3>

<pre><code class="language-R">library(poppr)
data(Pinf)
tab &lt;- mlg.table(Pinf, plot = FALSE)
diversity_boot(tab, 10L)
## Not run: 
# This can be done in a parallel fashion (OSX uses "multicore", Windows uses "snow")
system.time(diversity_boot(tab, 10000L, parallel = "multicore", ncpus = 4L))
system.time(diversity_boot(tab, 10000L))

## End(Not run)
</code></pre>


</div>