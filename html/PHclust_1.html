<div class="container">

<table style="width: 100%;"><tr>
<td>Hybrid</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>Calculate optimal number of clusters.</h2>

<h3>Description</h3>

<p>This function estimates the optimal number of clusters for a given dataset.
</p>


<h3>Usage</h3>

<pre><code class="language-R">Hybrid(data, absolute = FALSE, Kstart = NULL, Treatment)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>data</code></td>
<td>
<p>Data matrix with dimension N*P indicating N features and P samples.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>absolute</code></td>
<td>
<p>Logical. Whether we should use absolute (TRUE) or relative (FALSE) abundance of features to determine clusters.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>Kstart</code></td>
<td>
<p>Positive integer. The number of clusters for starting the hybrid merging algorithm. Should be relatively large to ensure that Kstart &gt; optimal number of clusters. Uses <em>max(50, sqrt(N))</em> by default.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>Treatment</code></td>
<td>
<p>Vector of length p, indicating replicates of different treatment groups. For example, <em>Treatment</em> = c(1,1,2,2,3,3) indicates 3 treatment groups, each with 2 replicates.</p>
</td>
</tr>
</table>
<h3>Value</h3>

<p>A positive integer indicating the optimal number of clusters
</p>


<h3>Examples</h3>

<pre><code class="language-R">######## Run the following codes in order:
##
## This is a sample data set which has 100 features, and 4 treatment groups with 4 replicates each.
data('sample_data')
head(sample_data)
set.seed(1)
##
## Finding the optimal number of clusters
K &lt;- Hybrid(sample_data, Kstart = 4, Treatment = rep(c(1,2,3,4), each = 4))
##
## Clustering result from EM algorithm
result &lt;- PHcluster(sample_data, rep(c(1,2,3,4), each = 4), K, method = 'EM', nstart = 1)
print(result$cluster)
##
## Plot the feature abundance level for each cluster
plot_abundance(result, sample_data, Treatment = rep(c(1,2,3,4), each = 4))
</code></pre>


</div>