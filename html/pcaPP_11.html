<div class="container">

<table style="width: 100%;"><tr>
<td>l1median_NLM</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2> Multivariate L1 Median </h2>

<h3>Description</h3>

<p>Computes the multivariate L1 median (also called spatial median) of a data matrix <code>X</code>.  
</p>


<h3>Usage</h3>

<pre><code class="language-R">l1median_NM (X, maxit = 200, tol = 10^-8, trace = 0,
             m.init = .colMedians (X), ...)
l1median_CG (X, maxit = 200, tol = 10^-8, trace = 0,
             m.init = .colMedians (X), ...)
l1median_BFGS (X, maxit = 200, tol = 10^-8, trace = 0,
               m.init = .colMedians (X), REPORT = 10, ...)
l1median_NLM (X, maxit = 200, tol = 10^-8, trace = 0,
              m.init = .colMedians (X), ...)
l1median_HoCr (X, maxit = 200, tol = 10^-8, zero.tol = 1e-15, trace = 0,
               m.init = .colMedians (X), ...)
l1median_VaZh (X, maxit = 200, tol = 10^-8, zero.tol = 1e-15, trace = 0,
	       m.init = .colMedians (X), ...)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>X</code></td>
<td>
<p> a matrix of dimension <code>n</code> x <code>p</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>maxit</code></td>
<td>
<p> The maximum number of iterations to be performed. </p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>tol</code></td>
<td>
<p> The convergence tolerance. </p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>trace</code></td>
<td>
<p> The tracing level. Set <code>trace &gt; 0</code> to retrieve additional information on the single iterations. </p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>m.init</code></td>
<td>
<p> A vector of length <code>p</code> containing the initial value of the L1-median. </p>
</td>
</tr>
</table>
<table>
<tr style="vertical-align: top;">
<td><code>REPORT</code></td>
<td>
<p> A parameter internally passed to <code>optim</code>. </p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>zero.tol</code></td>
<td>
<p> The zero-tolerance level used in <code>l1median_VaZh</code> and <code>l1median_HoCr</code> for determining the equality of two observations (i.e. an observation and a current center estimate). </p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>...</code></td>
<td>
<p> Further parameters passed from other functions. </p>
</td>
</tr>
</table>
<h3>Details</h3>

<p>The L1-median is computed using the built-in functions 
<code>optim</code> and <code>nlm</code>. 
These functions are a transcript of the <code>L1median</code> 
method of package <code>robustX</code>, porting as much code as possible into C++.</p>


<h3>Value</h3>



<table>
<tr style="vertical-align: top;">
<td><code>par</code></td>
<td>
<p> A vector of length <code>p</code> containing the L1-median. </p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>value</code></td>
<td>
<p> The value of the objective function <code>||X - l1median||</code> which is minimized for finding the L1-median. </p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>code</code></td>
<td>
<p> The return code of the optimization algorithm. See <code>optim</code> and <code>nlm</code> for further information. </p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>iterations</code></td>
<td>
<p> The number of iterations performed. </p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>iterations_gr</code></td>
<td>
<p> When using a gradient function this value holds the number of times the gradient had to be computed. </p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>time</code></td>
<td>
<p>The algorithms runtime in milliseconds.</p>
</td>
</tr>
</table>
<h3>Note</h3>

<p>See the vignette "Compiling pcaPP for Matlab" which comes with this package to compile and use some of these functions in Matlab.</p>


<h3>Author(s)</h3>

<p>Heinrich Fritz, Peter Filzmoser &lt;<a href="mailto:P.Filzmoser@tuwien.ac.at">P.Filzmoser@tuwien.ac.at</a>&gt;</p>


<h3>See Also</h3>

 <p><code>median</code></p>


<h3>Examples</h3>

<pre><code class="language-R">
  # multivariate data with outliers
  library(mvtnorm)
  x &lt;- rbind(rmvnorm(200, rep(0, 4), diag(c(1, 1, 2, 2))), 
             rmvnorm( 50, rep(3, 4), diag(rep(2, 4))))

  l1median_NM (x)$par
  l1median_CG (x)$par
  l1median_BFGS (x)$par
  l1median_NLM (x)$par
  l1median_HoCr (x)$par
  l1median_VaZh (x)$par

  # compare with coordinate-wise median:
  apply(x,2,median)
</code></pre>


</div>