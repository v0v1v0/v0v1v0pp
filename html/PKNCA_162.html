<div class="container">

<table style="width: 100%;"><tr>
<td>pk.calc.half.life</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>Compute the half-life and associated parameters</h2>

<h3>Description</h3>

<p>The terminal elimination half-life is estimated from the final points in the
concentration-time curve using semi-log regression (<code>log(conc)~time</code>)
with automated selection of the points for calculation (unless
<code>manually.selected.points</code> is <code>TRUE</code>).
</p>


<h3>Usage</h3>

<pre><code class="language-R">pk.calc.half.life(
  conc,
  time,
  tmax,
  tlast,
  manually.selected.points = FALSE,
  options = list(),
  min.hl.points = NULL,
  adj.r.squared.factor = NULL,
  conc.blq = NULL,
  conc.na = NULL,
  first.tmax = NULL,
  allow.tmax.in.half.life = NULL,
  check = TRUE
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>conc</code></td>
<td>
<p>Measured concentrations</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>time</code></td>
<td>
<p>Time of the measurement of the concentrations</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>tmax</code></td>
<td>
<p>Time of maximum concentration (will be calculated and
included in the return data frame if not given)</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>tlast</code></td>
<td>
<p>Time of last concentration above the limit of
quantification (will be calculated and included in the return data
frame if not given)</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>manually.selected.points</code></td>
<td>
<p>Have the input points (<code>conc</code> and
<code>time</code>) been manually selected?  The impact of setting this to
<code>TRUE</code> is that no selection for the best points will be done.  When
<code>TRUE</code>, this option causes the options of <code>adj.r.squared.factor</code>,
<code>min.hl.points</code>, and <code>allow.tmax.in.half.life</code> to be ignored.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>options</code></td>
<td>
<p>List of changes to the default PKNCA options (see
<code>PKNCA.options()</code>)</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>min.hl.points</code></td>
<td>
<p>The minimum number of points that must be
included to calculate the half-life</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>adj.r.squared.factor</code></td>
<td>
<p>The allowance in adjusted r-squared for
adding another point.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>conc.blq</code></td>
<td>
<p>See <code>clean.conc.blq()</code></p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>conc.na</code></td>
<td>
<p>See <code>clean.conc.na()</code></p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>first.tmax</code></td>
<td>
<p>See <code>pk.calc.tmax()</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>allow.tmax.in.half.life</code></td>
<td>
<p>Allow the concentration point for tmax
to be included in the half-life slope calculation.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>check</code></td>
<td>
<p>Run <code>assert_conc_time()</code>,
<code>clean.conc.blq()</code>, and <code>clean.conc.na()</code>?</p>
</td>
</tr>
</table>
<h3>Details</h3>

<p>See the "Half-Life Calculation" vignette for more details on the calculation
methods used.
</p>
<p>If <code>manually.selected.points</code> is <code>FALSE</code> (default), the
half-life is calculated by computing the best fit line for all points at or
after tmax (based on the value of <code>allow.tmax.in.half.life</code>).  The best
half-life is chosen by the following rules in order:
</p>

<ul>
<li>
<p>At least <code>min.hl.points</code> points included
</p>
</li>
<li>
<p>A <code>lambda.z</code> &gt; 0 and at the same time the best adjusted r-squared
(within <code>adj.r.squared.factor</code>)
</p>
</li>
<li>
<p>The one with the most points included
</p>
</li>
</ul>
<p>If <code>manually.selected.points</code> is <code>TRUE</code>, the <code>conc</code>
and <code>time</code> data are used as-is without any form of selection for
the best-fit half-life.
</p>


<h3>Value</h3>

<p>A data frame with one row and columns for
</p>

<dl>
<dt>tmax</dt>
<dd>
<p>Time of maximum observed concentration (only included
if not given as an input)</p>
</dd>
<dt>tlast</dt>
<dd>
<p>Time of last observed concentration above the LOQ (only
included if not given as an input)</p>
</dd>
<dt>r.squared</dt>
<dd>
<p>coefficient of determination</p>
</dd>
<dt>adj.r.squared</dt>
<dd>
<p>adjusted coefficient of determination</p>
</dd>
<dt>lambda.z</dt>
<dd>
<p>elimination rate</p>
</dd>
<dt>lambda.z.time.first</dt>
<dd>
<p>first time for half-life calculation</p>
</dd>
<dt>lambda.z.n.points</dt>
<dd>
<p>number of points in half-life calculation</p>
</dd>
<dt>clast.pred</dt>
<dd>
<p>Concentration at tlast as predicted by the half-life
line</p>
</dd>
<dt>half.life</dt>
<dd>
<p>half-life</p>
</dd>
<dt>span.ratio</dt>
<dd>
<p>span ratio [ratio of half-life to time used for
half-life calculation</p>
</dd>
</dl>
<h3>References</h3>

<p>Gabrielsson J, Weiner D.  "Section 2.8.4 Strategies for estimation of
lambda-z."  Pharmacokinetic &amp; Pharmacodynamic Data Analysis: Concepts
and Applications, 4th Edition.  Stockholm, Sweden: Swedish
Pharmaceutical Press, 2000.  167-9.
</p>


</div>