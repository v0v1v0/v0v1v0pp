<div class="container">

<table style="width: 100%;"><tr>
<td>cv.coxlasso</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>Cross-validation for coxlasso</h2>

<h3>Description</h3>

<p>performs k-fold cross-validation for <code>coxlasso</code>, produces a plot, and returns a value for the LASSO tuning parameter <code class="reqn">\xi</code>.  
</p>


<h3>Usage</h3>

<pre><code class="language-R">cv.coxlasso(fix, rnd = NULL, vary.coef = NULL, n.folds = 10, xi = NULL,
            data, adaptive.weights = NULL, print.fold = TRUE, print.xi = FALSE,
            len.xi = 100, lgrid = TRUE, ran.seed = 1909, xi.factor = 1.01, min.fold = 4,
            pass.on.start = TRUE, control = list(print.iter = FALSE))
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>fix</code></td>
<td>
<p>a two-sided linear formula object describing the fixed (time-constant) effects part of the model, with the response on the left of a
<code>~</code> operator and the terms, separated by <code>+</code> operators, on
the right. The response must be a survival object as returned by the <code>Surv</code> function.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>rnd</code></td>
<td>
<p>a two-sided linear formula object describing the
random-effects part of the model, with the grouping factor on the left of a
<code>~</code> operator and the random terms, separated by <code>+</code> operators, on
the right. Default is NULL, so no random effects are present.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>vary.coef</code></td>
<td>
<p>a one-sided linear formula object describing the
time-varying effects part of the model, with the time-varying terms, separated by <code>+</code> operators,
on the right side of a <code>~</code> operator. Default is NULL, so no time-varying effects are incorporated.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>n.folds</code></td>
<td>
<p>number of folds. Default is 10.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>xi</code></td>
<td>
<p>Optional user-supplied xi sequence; default is NULL, and cv.coxlasso chooses its own sequence</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>data</code></td>
<td>
<p>the data frame containing the variables named in the three preceding
<code>formula</code> arguments.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>adaptive.weights</code></td>
<td>
<p>for the LASSO-penalized fixed effects a vector of adaptive weights can be passed to the procedure. If no adaptive weights are specified, an unpenalized model (i.e. <code class="reqn">\xi=0</code>) is fitted by the <code>coxFL</code> function and the obtained estimates are used as adaptive weights (see value section).</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>print.fold</code></td>
<td>
<p>Should folds of CV be printed? Default is yes.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>print.xi</code></td>
<td>
<p>Should current <code class="reqn">\xi</code> value be printed? Default is no.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>len.xi</code></td>
<td>
<p>Length of <code class="reqn">\xi</code> grid. Default is 100.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>lgrid</code></td>
<td>
<p>Logical; shall a logarithmized grid version for the penalty parameter be used? Default is TRUE.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>ran.seed</code></td>
<td>
<p>Random seed number to be set. Default is 1909, the year of birth of Borussia Dortmund football club.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>xi.factor</code></td>
<td>
<p>A factor which increases xi.max once again to be sure that xi is large enough on all sets. Default is 1.01</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>min.fold</code></td>
<td>
<p>Only those xi values are taken into account where at least min.fold folds are not NA. Default is 4.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>pass.on.start</code></td>
<td>
<p>Shall starting values be passed onthroughout estimation? Default is TRUE</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>control</code></td>
<td>
<p>a list of control values for the estimation algorithm to replace the default values returned by the function <code>coxlassoControl</code>. Default is <code>print.iter = FALSE</code>.</p>
</td>
</tr>
</table>
<h3>Details</h3>

<p>The function runs <code>coxlasso</code> over a grid of values <code class="reqn">\xi</code> for each training data set with one fold omitted. 
</p>
<p>For each run, the value for the full likelihood is calculated and the average for each <code class="reqn">\xi</code> on the grid is computed over the folds. The function choses the <code class="reqn">\xi</code> that maximizes this likelihood value as the optimal tuning parameter value.  
</p>


<h3>Value</h3>

<p>The function returns a list <code>"cv.coxlasso"</code> which includes:    
</p>
<table>
<tr style="vertical-align: top;">
<td><code>cv.error</code></td>
<td>
<p>a vector of mean CV error (i.e., negative likelihood) values for each <code class="reqn">\xi</code> on the grid averaged over the folds.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>xi.opt</code></td>
<td>
<p>a scalar value of <code class="reqn">\xi</code> associated with the smallest CV error.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>xi.1se</code></td>
<td>
<p>largest value of <code class="reqn">\xi</code> such that error is within 1 standard error of the minimum.</p>
</td>
</tr>
</table>
<p>The <code>plot</code> function plots the values of <code class="reqn">\xi</code> against the corresponding CV error (i.e., negative likelihood) values.   
</p>


<h3>Author(s)</h3>

<p>Andreas Groll  <a href="mailto:groll@statistik.tu-dortmund.de">groll@statistik.tu-dortmund.de</a> <br>
Maike Hohberg <a href="mailto:mhohber@uni-goettingen.de">mhohber@uni-goettingen.de</a>
</p>


<h3>References</h3>

<p>To appear soon.
</p>


<h3>See Also</h3>

<p><code>coxlasso, coxlassoControl, coxFL, Surv, pbc</code>
</p>


<h3>Examples</h3>

<pre><code class="language-R">## Not run: 
data(lung)

# remove NAs
lung &lt;- lung[!is.na(lung$inst),]

# transform inst into factor variable
lung$inst &lt;- as.factor(lung$inst)

# just for illustration, create factor with only three ph.ecog classes
lung$ph.ecog[is.na(lung$ph.ecog)] &lt;- 2
lung$ph.ecog[lung$ph.ecog==3] &lt;- 2
lung$ph.ecog &lt;- as.factor(lung$ph.ecog)

fix.form &lt;- as.formula("Surv(time, status) ~ 1 + age + ph.ecog + sex")

# find optimal tuning paramater
cv.coxlasso.obj &lt;- cv.coxlasso(fix = fix.form, data = lung, n.folds = 5)

# estimate coxlasso model with optimal xi
lasso.obj &lt;- coxlasso(fix=fix.form, data=lung, xi=cv.coxlasso.obj$xi.opt,
                control=list(print.iter=TRUE))

coef(lasso.obj)             
                

# see also demo("coxlasso-lung")

## End(Not run)</code></pre>


</div>