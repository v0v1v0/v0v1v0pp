<div class="container">

<table style="width: 100%;"><tr>
<td>power.TOST.sim</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>
Power of the TOST procedure obtained via simulations
</h2>

<h3>Description</h3>

<p>Power is calculated by simulations of studies (PE via its normal distribution, 
MSE via its associated <em>χ</em><sup>2</sup> distribution) and application of the two one-sided <em>t</em>-tests. Power is obtained via ratio of studies found BE to 
the number of simulated studies. 
</p>


<h3>Usage</h3>

<pre><code class="language-R">power.TOST.sim(alpha = 0.05, logscale = TRUE, theta1, theta2, theta0, CV, n, 
               design = "2x2", robust = FALSE, setseed = TRUE, nsims = 1e+05)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>alpha</code></td>
<td>

<p>Significance level (one-sided). Commonly set to 0.05.
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>logscale</code></td>
<td>

<p>Should the data used on log-transformed or on original scale? <code>TRUE</code> (default) or <code>FALSE</code>.
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>theta0</code></td>
<td>

<p>‘True’ or assumed T/R ratio or difference.<br>
In case of <code>logscale=TRUE</code> it must be given as ratio T/R.<br>
If <code>logscale=FALSE</code>, the difference in means. In this case, the difference may be expressed in two ways: relative to the same (underlying) reference mean, i.e. as (T-R)/R = T/R - 1; or as difference in means T-R. Note that in the former case the units of <code>CV</code>, <code>theta1</code> and <code>theta2</code> need also be given relative to the reference mean (specified as ratio).<br>
Defaults to 0.95 if <code>logscale=TRUE</code> or to 0.05 if <code>logscale=FALSE</code>
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>theta1</code></td>
<td>

<p>Lower (bio-)equivalence limit.<br>
In case of <code>logscale=TRUE</code> it is given as ratio.<br>
If <code>logscale=FALSE</code>, the limit may be expressed in two ways:
difference of means relative to the same (underlying) reference mean or in units of the difference of means.
Note that in the former case the units of <code>CV</code>, <code>theta0</code> and <code>theta2</code> need also be given relative to the reference mean (specified as ratio).<br>
Defaults to 0.8 if <code>logscale=TRUE</code> or to -0.2 if <code>logscale=FALSE</code>.
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>theta2</code></td>
<td>

<p>Upper (bio-)equivalence limit.<br>
In case of <code>logscale=TRUE</code> it is given as ratio.
If <code>logscale=FALSE</code>, the limit may be expressed in two ways:
difference of means relative to the same (underlying) reference mean or in units of the difference of means.
Note that in the former case the units of <code>CV</code>, <code>theta0</code> and <code>theta1</code> need also be given relative to the reference mean (specified as ratio).<br>
If not given, <code>theta2</code> will be calculated as <code>1/theta1</code> if <code>logscale=TRUE</code> or as <code>-theta1</code> if <code>logscale=FALSE</code>.
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>CV</code></td>
<td>

<p>In case of <code>logscale=TRUE</code> the (geometric) coefficient of variation given as ratio.<br>
If <code>logscale=FALSE</code> the argument refers to (residual) standard deviation of the response. In this case, standard deviation may be expressed two ways: relative to a reference mean (specified as ratio sigma/muR), i.e. again as a coefficient of variation; or untransformed, i.e. as standard deviation of the response. Note that in the former case the units of <code>theta0</code>, <code>theta1</code> and <code>theta2</code> need also be given relative to the reference mean (specified as ratio).<br></p>
<p>In case of cross-over studies this is the within-subject CV, in case of a parallel-group design the CV of the total variability.
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>n</code></td>
<td>

<p>Number of subjects under study.<br>
Is total number if given as scalar, else number of subjects in the (sequence) 
groups. In the latter case the length of <code>n</code> vector has to be equal to the 
number of (sequence) groups.
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>design</code></td>
<td>

<p>Character string describing the study design.<br>
See <code>known.designs()</code> for designs covered in this package.
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>robust</code></td>
<td>

<p>Defaults to <code>FALSE</code>. With that value the usual degrees of freedom will be used.<br>
Set to <code>TRUE</code> will use the degrees of freedom according to the ‘robust’ evaluation
(aka Senn’s basic estimator). These degrees of freedom are calculated as <code>n-seq</code>.
See <code>known.designs()$df2</code> for designs covered in this package.<br>
Has only effect for higher-order crossover designs.
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>setseed</code></td>
<td>

<p>Simulations are dependent on the starting point of the (pseudo) random number 
generator. To avoid differences in power for different runs a <code>set.seed(1234567)</code> 
is issued if <code>setseed=TRUE</code>, the default.<br>
Set this argument to <code>FALSE</code> to view the variation in power between 
different runs.
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>nsims</code></td>
<td>

<p>Number of studies to simulate. Defaults to 100,000 = 1E5.
</p>
</td>
</tr>
</table>
<h3>Value</h3>

<p>Value of power according to the input arguments.
</p>


<h3>Note</h3>

<p>This function was intended for internal check of the analytical power
calculation methods. Use of the analytical power calculation methods 
(<code>power.TOST()</code>) for real problems is recommended.<br>
For sufficient precision nsims &gt; 1E5 (default) may be necessary. 
Be patient if using nsims=1E6. May take some seconds.
</p>


<h3>Author(s)</h3>

<p>D. Labes
</p>


<h3>See Also</h3>

<p><code>power.TOST</code>, 
</p>


<h3>Examples</h3>

<pre><code class="language-R"># using the default design 2x2, BE range 0.8 ... 1.25, logscale, theta0=0.95
power.TOST.sim(alpha = 0.05, CV = 0.3, n = 12)
# should give 0.15054, with nsims=1E6 it will be 0.148533
# exact analytical is
power.TOST(alpha = 0.05, CV = 0.3, n = 12)
# should give 0.1484695

# very unusual alpha setting
power.TOST.sim(alpha = 0.9, CV = 0.3, n = 12)
# should give the same (within certain precision) as
power.TOST(alpha = 0.95, CV = 0.3, n = 12)
# or also within certain precision equal to  
power.TOST(alpha = 0.95, CV = 0.3, n = 12, method = "mvt")
# SAS Proc Power gives here the incorrect value 0.60525
</code></pre>


</div>