<div class="container">

<table style="width: 100%;"><tr>
<td>VDJ_db_annotate</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>Wrapper function of VDJ_antigen_integrate function</h2>

<h3>Description</h3>

<p>Wraps the VDJ_antigen_integrate function and uses it to annotate a VDJ dataframe with antigen information. Needs to VDJ_db_load to be executed first, with preprocess=T and vgm.names=T to obtain the same column names as in the VDJ (to allow for sequence matching).
</p>


<h3>Usage</h3>

<pre><code class="language-R">VDJ_db_annotate(VDJ, db.list, database.features, match, homology, lv.distance)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>VDJ</code></td>
<td>
<p>VDJ or VDJ.GEX.matrix[[1]] object, as obtained from the VDJ_GEX_matrix function in Platypus.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>db.list</code></td>
<td>
<p>list of database dataframes or csv file paths, obtained from VDJ_db_load with .</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>database.features</code></td>
<td>
<p>list of features/column names to be integrated from the databases.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>match</code></td>
<td>
<p>string - sequences by which to match and integrate the antigen information. Currently, only 'cdr3.aa' and 'cdrh3.aa' are supported, as all databases have these two sequence types ('VJ_cdr3s_aa','VDJ_cdr3s_aa').</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>homology</code></td>
<td>
<p>string - 'exact' for exact sequence matchings, 'homology' for homology matching.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>lv.distance</code></td>
<td>
<p>integer - maximum Levehnstein distance threshold for the homology matchings.</p>
</td>
</tr>
</table>
<h3>Value</h3>

<p>VDJ with new columns - antigen information integrated from the antigen databases.
</p>


<h3>Examples</h3>

<pre><code class="language-R">
try({
VDJ_db_annotate(VDJ=VDJ,db.list=db.list,database.features='Epitope',match='cdr3.aa',homology=FALSE)
})

</code></pre>


</div>