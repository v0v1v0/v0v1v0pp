<div class="container">

<table style="width: 100%;"><tr>
<td>GEX_GSEA</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>GEX Gene Set Enrichment Analysis and plotting</h2>

<h3>Description</h3>

<p>Conducts a Gene Set Enrichment Analysis (GSEA) on a set of genes submitted in a data frame with a metric each.
Works with the output of GEX_genes_cluster or a custom data frame containing the gene symbols either in a column "symbols" or as rownames and a metric for each gene.
The name of the column containing the metric has to be declared via the input metric.colname.
</p>


<h3>Usage</h3>

<pre><code class="language-R">GEX_GSEA(
  GEX.cluster.genes.output,
  MT.Rb.filter,
  filter,
  path.to.pathways,
  metric.colname,
  pval.adj.cutoff,
  Enrichment.Plots,
  my.own.geneset,
  eps,
  platypus.version
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>GEX.cluster.genes.output</code></td>
<td>
<p>Data frame containing the list of gene symbols and a metric. Function works directly with GEX_cluster_genes output.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>MT.Rb.filter</code></td>
<td>
<p>Logical, should Mitotic and Ribosomal genes be filtered out of the geneset. True by default.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>filter</code></td>
<td>
<p>Character vector containing the identifying symbol sequence for the genes which should be filtered out, if MT.Rb.filter == TRUE. By default set to c("MT-", "RPL", "RPS").</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>path.to.pathways</code></td>
<td>
<p>Either a path to gmt file containing the gene sets (can be downloaded from MSigDB) or vector where first element specifies species and second element specifies the MSigDB collection abbreviation. E.g.: c("Homo sapiens", "H"). Mouse C7 (immunologic signature) gene set will be used by default.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>metric.colname</code></td>
<td>
<p>Name of column which contains the metric used for the ranking of the submitted genelist. "avg_logFC" is used by default.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>pval.adj.cutoff</code></td>
<td>
<p>Only genes with a more significant adjusted pvalue are considered. Default: 0.001</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>Enrichment.Plots</code></td>
<td>
<p>List of Gene-set names which should be plotted as Enrichment plots in addition to the top 10 Up and Downregulated Genesets.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>my.own.geneset</code></td>
<td>
<p>A list, where each element contains a gene list and is named with the corresponding pathway name. Default is set to FALSE, so that gene sets from MSigDB are used. Should not contain ".gmt" in name.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>eps</code></td>
<td>
<p>Numeric, specifying boundary for calculating the p value in the GSEA.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>platypus.version</code></td>
<td>
<p>Function works with V2 and V3, no need to set this parameter.</p>
</td>
</tr>
</table>
<h3>Value</h3>

<p>Returns a list containing a tibble with the gene sets and their enrichment scores and Enrichment plots. List element [[1]]: Dataframe with Genesets and statistics. [[2]]: Enrichment plots of top10 Up regulated genesets. [[3]]: Enrichment plots of top10 Down regulated genesets. [[4]]: Enrichment plots of submited gene-sets in parameter Enrichment.Plot.
</p>


<h3>Examples</h3>

<pre><code class="language-R">
try({
df &lt;- GEX_cluster_genes(Platypus::small_vgm[[2]])

output &lt;- GEX_GSEA(GEX.cluster.genes.output =  df[[1]], MT.Rb.filter = TRUE
, path.to.pathways = "./c5.go.bp.v7.2.symbols.gmt")
cowplot::plot_grid(plotlist=output[[2]], ncol=2)

output &lt;- GEX_GSEA(GEX.cluster.genes.output =  df[[1]], MT.Rb.filter = TRUE
, path.to.pathways = c("Mus musculus", "C7"))

output &lt;- GEX_GSEA(GEX.cluster.genes.output =  df[[1]], MT.Rb.filter = TRUE
, my.own.geneset = my_geneset)
})

</code></pre>


</div>