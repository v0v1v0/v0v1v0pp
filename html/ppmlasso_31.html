<div class="container">

<table style="width: 100%;"><tr>
<td>pointInteractions</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>Calculate point interactions for area-interaction models</h2>

<h3>Description</h3>

<p>This function calculates point interactions at presence locations and
quadrature points required for fitting a regularisation path of area-interaction
models.</p>


<h3>Usage</h3>

<pre><code class="language-R">pointInteractions(dat.ppm, r, availability = NA)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>dat.ppm</code></td>
<td>
<p>A design matrix generated using the <code>ppmdat</code> function.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>r</code></td>
<td>
<p>The radius of point interactions.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>availability</code></td>
<td>
<p>An optional binary matrix used in calculating point interactions indicating
whether locations are available (<code>availability = 1</code>) or not (<code>availability = 0</code>). 
If no such matrix is provided, <code>availability</code> is automatically generated with all
values set to <code>1</code> at a special resolution of half of <code>r</code>.</p>
</td>
</tr>
</table>
<h3>Details</h3>

<p>Theoretically, the point interaction <code class="reqn">t(y)</code> at a point <code class="reqn">y</code> is calculated
as the proportion of available area in a circular region <code class="reqn">Y</code> or radius <code class="reqn">r</code> centred
at <code class="reqn">y</code> that overlaps with circles of radius <code class="reqn">r</code> centred at other presence locations
(Baddeley &amp; Turner, 2005).
</p>
<p>This function discretises the study region at the same spatial resolution
as <code>availability</code> by defining the matrix <code>occupied</code>, a fine grid of locations
spanning the study region initialised to zero. The values of <code>occupied</code> within a 
distance of <code>r</code> of each presence location are then augmented by <code>1</code>, such that
<code>occupied</code> then contains the total number of presence locations with which each
grid location interacts. To prevent unavailable areas from being included in the
calculation of point interactions, the values of <code>occupied</code> at grid locations for which
<code>availability = 0</code> are set to zero.
</p>
<p><code class="reqn">t(y)</code> is then estimated as the proportion of available grid locations within <code class="reqn">Y</code>
that overlap circular regions around other presence locations.
</p>
<p>The availability matrix is particularly useful for regions that have inaccessible areas
(<strong>e.g.</strong> due to the presence of ocean or urban areas).
</p>
<p>Finer resolutions of the <code>availability</code> matrix will yield more precise estimates but
at a cost of greater computation time.</p>


<h3>Value</h3>

<p>A vector of point interactions corresponding to the locations contained in the
<code>dat.ppm</code> argument.</p>


<h3>Author(s)</h3>

<p>Ian W. Renner</p>


<h3>References</h3>

<p>Baddeley, A.J. &amp; Turner, R. (2005). Spatstat: an <code>R</code> package for analyzing spatial
point patterns. <em>Journal of Statistical Software</em> <b>12</b>, 1-42.
</p>


<h3>See Also</h3>

<p><code>ppmlasso</code> for fitting a regularisation path of area-interaction models
</p>


<h3>Examples</h3>

<pre><code class="language-R">data(BlueMountains)
species.ppm = ppmdat(sp.xy = BlueMountains$eucalypt, back.xy = BlueMountains$env, 
sp.scale = 1, datfilename = NA, writefile = FALSE) # generate design matrix
species.int = pointInteractions(species.ppm, 2, BlueMountains$availability)
</code></pre>


</div>