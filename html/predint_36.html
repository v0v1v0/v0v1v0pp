<div class="container">

<table style="width: 100%;"><tr>
<td>rqpois</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>Sampling of overdispersed Poisson data with constant overdispersion</h2>

<h3>Description</h3>

<p><code>rqpois()</code> samples overdispersed Poisson data with constant overdispersion from
the negative-binomial distribution such that the quasi-Poisson assumption is fulfilled.
The following description of the sampling process is based on the parametrization
used by Gsteiger et al. 2013.
</p>


<h3>Usage</h3>

<pre><code class="language-R">rqpois(n, lambda, phi, offset = NULL)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>n</code></td>
<td>
<p>defines the number of clusters (<code class="reqn">I</code>)</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>lambda</code></td>
<td>
<p>defines the overall Poisson mean (<code class="reqn">\lambda</code>)</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>phi</code></td>
<td>
<p>dispersion parameter (<code class="reqn">\Phi</code>)</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>offset</code></td>
<td>
<p>defines the number of experimental units per cluster (<code class="reqn">n_i</code>)</p>
</td>
</tr>
</table>
<h3>Details</h3>

<p>It is assumed that the dispersion parameter (<code class="reqn">\Phi</code>)
is constant for all <code class="reqn">i=1, ... I</code> clusters, such that the variance becomes
</p>
<p style="text-align: center;"><code class="reqn">var(y_i) = \Phi n_i \lambda</code>
</p>

<p>For the sampling <code class="reqn">\kappa_i</code> is defined as
</p>
<p style="text-align: center;"><code class="reqn">\kappa_i=(\Phi-1)/(n_i \lambda)</code>
</p>

<p>where <code class="reqn">a_i=1/\kappa_i</code> and <code class="reqn">b_i=1/(\kappa_i n_i \lambda)</code>. Then, the Poisson means
for each cluster are sampled from the gamma distribution
</p>
<p style="text-align: center;"><code class="reqn">\lambda_i \sim Gamma(a_i, b_i)</code>
</p>

<p>and the observations per cluster are sampled to be
</p>
<p style="text-align: center;"><code class="reqn">y_i \sim Pois(\lambda_i).</code>
</p>

<p>Please note, that the quasi-Poisson assumption is not in contradiction with the
negative-binomial distribution, if the data structure is defined by the number
of clusters only (which is the case here) and the offsets are all the same
<code class="reqn">n_h = n_{hÂ´} = n</code>.
</p>


<h3>Value</h3>

<p>a data.frame containing the sampled observations and the offsets
</p>


<h3>References</h3>

<p>Gsteiger, S., Neuenschwander, B., Mercier, F. and Schmidli, H. (2013):
Using historical control information for the design and analysis of clinical
trials with overdispersed count data. Statistics in  Medicine, 32: 3609-3622.
<a href="https://doi.org/10.1002/sim.5851">doi:10.1002/sim.5851</a>
</p>


<h3>Examples</h3>

<pre><code class="language-R"># set.seed(123)
qp_dat1 &lt;- rqpois(n=10, lambda=50, phi=3)
qp_dat1

# set.seed(123)
qp_dat2 &lt;- rqpois(n=3, lambda=50, phi=3)
qp_dat2


</code></pre>


</div>