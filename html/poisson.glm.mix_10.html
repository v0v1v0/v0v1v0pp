<div class="container">

<table style="width: 100%;"><tr>
<td>mylogLikePoisMix</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>Function to compute the loglikelihood of the mixture.
</h2>

<h3>Description</h3>

<p>This function computes the observed loglikelihood given the means and the mixing proportions of each component. Instead of computing <code class="reqn">L_{i}=\log\sum_{k=1}^{K}g_{ik}</code>, <code class="reqn">i=1,\ldots,n</code>, where <code class="reqn">g_{ik}:=\pi_{k}\prod_{j=1}^{J}\prod_{\ell=1}^{L_j}f(y_{ij\ell}|\mu_{ijlk;m})</code>, <code class="reqn">h_{ik}:=\log g_{ik}</code> are computed for all <code class="reqn"> i </code>. Let <code class="reqn">h_{i}^{*}=\max\{h_{ik},k=1,\ldots,K\}</code>, then  <code class="reqn">L_{i}=h_{i}^{*}+\log\sum_{k=1}^{K}\exp(h_{ik}-h^{*}_{i})</code>.
</p>


<h3>Usage</h3>

<pre><code class="language-R">mylogLikePoisMix(y, mean, pi)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>y</code></td>
<td>
<p>a numeric array of count data with dimension <code class="reqn">n\times d</code>.
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>mean</code></td>
<td>
<p>a list of length K (the number of mixture components) of positive data. Each list element is a matrix with dimension <code class="reqn">n\times d</code> containing <code class="reqn">d</code> Poisson means for each of the <code class="reqn">n</code> observations.
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>pi</code></td>
<td>
<p>a numeric vector of length K (the number of mixture components) containing the mixture weights.
</p>
</td>
</tr>
</table>
<h3>Value</h3>

<table><tr style="vertical-align: top;">
<td><code>ll </code></td>
<td>
<p>the value of the loglikelihood.</p>
</td>
</tr></table>
<h3>Author(s)</h3>

<p>Panagiotis Papastamoulis
</p>


<h3>Examples</h3>

<pre><code class="language-R">## This example computes the loglikelihood of a K = 10 component 
##      Poisson GLM mixture. The number of response variables is
##      d = 6, while the sample size equals to n = 5000. They are
##      stored in the array sim.data[,-1]. The number of covariates
##      equals 1 (corresponding to sim.data[,1]). We will use a 
##      random generation of the regression coefficients alpha and 
##      beta, in order to show that the loglikelihood can be computed 
##      without computational errors even in cases where the parameters
##      are quite ''bad'' for the data.   

data("simulated_data_15_components_bjk_full")
K &lt;- 10
d &lt;- 6
n &lt;- dim(sim.data)[1]
condmean=vector("list",length=K)
weights&lt;-rep(1,K)/K
ar&lt;-array(data=NA,dim=c(n,d))
for (k in 1:K){
for (i in 1:d){
ar[,i]&lt;-runif(n)+(1+0.1*(runif(n)-1))*sim.data[,1]}
condmean[[k]]&lt;-ar}
mylogLikePoisMix(sim.data[,-1],condmean,weights)

</code></pre>


</div>