<div class="container">

<table style="width: 100%;"><tr>
<td>getPhecodeOccurrences</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>Map ICD code occurrences to phecode occurrences</h2>

<h3>Description</h3>

<p>This is typically the first step of an analysis using phenotype risk scores,
the next is <code>getWeights()</code>.
</p>


<h3>Usage</h3>

<pre><code class="language-R">getPhecodeOccurrences(
  icdOccurrences,
  icdPhecodeMap = phers::icdPhecodeMap,
  dxIcd = phers::diseaseDxIcdMap
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>icdOccurrences</code></td>
<td>
<p>A data.table of occurrences of ICD codes for each
person in the cohort. Must have columns <code>person_id</code>, <code>icd</code>, and <code>flag</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>icdPhecodeMap</code></td>
<td>
<p>A data.table of the mapping between ICD codes and
phecodes. Must have columns <code>icd</code>, <code>phecode</code>, and <code>flag</code>. Default is the
map included in this package.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>dxIcd</code></td>
<td>
<p>A data.table of ICD codes to exclude from mapping to phecodes.
Must have columns <code>icd</code> and <code>flag</code>. Default is the table of Mendelian
diseases and the corresponding ICD codes that indicate a genetic diagnosis.
If <code>NULL</code>, no ICD codes will be excluded.</p>
</td>
</tr>
</table>
<h3>Value</h3>

<p>A data.table of phecode occurrences for each person.
</p>


<h3>See Also</h3>

<p><code>getWeights()</code>, <code>getScores()</code>
</p>


<h3>Examples</h3>

<pre><code class="language-R">library('data.table')

# map ICD codes to phecodes
phecodeOccurrences = getPhecodeOccurrences(icdSample)

# calculate weights (using the prevalence method)
weights = getWeights(demoSample, phecodeOccurrences)

# OMIM disease IDs for which to calculate phenotype risk scores
diseaseId = 154700

# map diseases to phecodes
diseasePhecodeMap = mapDiseaseToPhecode()

# calculate scores
scores = getScores(weights, diseasePhecodeMap[disease_id == diseaseId])

# calculate residual scores
rscores = getResidualScores(demoSample, scores, lmFormula = ~ sex)
</code></pre>


</div>