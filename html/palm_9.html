<div class="container">

<table style="width: 100%;"><tr>
<td>fit.ns</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>Fitting a Neyman-Scott point process model</h2>

<h3>Description</h3>

<p>Estimates parameters for a Neyman-Scott point process by maximising
the Palm likelihood. This approach was first proposed by Tanaka et
al. (2008) for two-dimensional Thomas processes. Further
generalisations were made by Stevenson, Borchers, and Fewster
(2019) and Jones-Todd et al. (2019).
</p>


<h3>Usage</h3>

<pre><code class="language-R">fit.ns(
  points,
  lims,
  R,
  disp = "gaussian",
  child.dist = "pois",
  child.info = NULL,
  sibling.list = NULL,
  edge.correction = "pbc",
  start = NULL,
  bounds = NULL,
  use.bobyqa = FALSE,
  trace = FALSE
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>points</code></td>
<td>
<p>A matrix or list of matrices containing locations of
observed points, where each row corresponds to a point and each
column corresponds to a dimension. If a list, then the patterns
are assumed to be independent and a single process is fitted to
all.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>lims</code></td>
<td>
<p>A matrix or list of matrices with two columns,
corresponding to the upper and lower limits of each dimension,
respectively. If a list, then each matrix provides the limits
for the corresponding pattern in <code>points</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>R</code></td>
<td>
<p>Truncation distance for the difference process.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>disp</code></td>
<td>
<p>A character string indicating the distribution of
children around their parents. Use <code>"gaussian"</code> for
multivariate normal dispersion with standard deviation
<code>sigma</code>, or <code>"uniform"</code> for uniform dispersion within
distance <code>tau</code> of the parent.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>child.dist</code></td>
<td>
<p>The distribution of the number of children
generated by a randomly selected parent. For a Poisson
distribution, use <code>"pois"</code>; for a binomial distribution,
use <code>"binomx"</code>, where <code>"x"</code> is replaced by the fixed
value of the number of independent trials (e.g.,
<code>"binom5"</code> for a Binomial(5, p) distribution, and
<code>"binom50"</code> for a Binomial(50, p) distribution); and
<code>"twocamera"</code> for a child distribution appropriate for a
two-camera aerial survey.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>child.info</code></td>
<td>
<p>A list of further information that is required
about the distribution for the number of children generated by
parents. See ‘Details’.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>sibling.list</code></td>
<td>
<p>An optional list that comprises (i) a component
named <code>sibling.mat</code>, containing a matrix such that the jth
entry in the ith row is <code>TRUE</code> if the ith and jth points
are known siblings, <code>FALSE</code> if they are known nonsiblings,
and <code>NA</code> if their sibling status is not known; (ii) alpha,
providing the probability that a sibling is successfully
identified as a sibling; and (iii) beta, providing the
probability that a nonsibling is successfully identified as a
nonsibling. For multi-pattern fitting, this object must be a
list of such lists, one for each pattern.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>edge.correction</code></td>
<td>
<p>The method used for the correction of edge
effects. Either <code>"pbc"</code> for periodic boundary conditions,
or <code>"buffer"</code> for a buffer-zone correction.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>start</code></td>
<td>
<p>A named vector of starting values for the model
parameters.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>bounds</code></td>
<td>
<p>A list with named components. Each component should
be a vector of length two, giving the upper and lower bounds
for the named parameter.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>use.bobyqa</code></td>
<td>
<p>Logical; if <code>TRUE</code> the bobyqa function
is used for optimisation. Otherwise the nlminb function
is used. Note that bobyqa seems to be less stable than
nlminb, but does not require calculation of the Palm
likelihood's partial derivatives.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>trace</code></td>
<td>
<p>Logical; if <code>TRUE</code>, parameter values are printed
to the screen for each iteration of the optimisation procedure.</p>
</td>
</tr>
</table>
<h3>Details</h3>

<p>The parameter <code>D</code> is the density of parent points, which is
always estimated. Possible additional parameters are
</p>

<ul>
<li> <p><code>lambda</code>, the expected number of children generated per
parent (when <code>child.dist = "pois"</code>).
</p>
</li>
<li> <p><code>p</code>, the proportion of the <code>x</code> possible children
that are generated (when <code>child.dist = "binomx"</code>).
</p>
</li>
<li> <p><code>kappa</code>, the average length of the surface phase of a
diving cetacean (when <code>child.dist = "twocamera"</code>; see
Stevenson, Borchers, and Fewster, 2019).
</p>
</li>
<li> <p><code>sigma</code>, the standard deviation of dispersion along
each dimension (when <code>disp</code> = "gaussian").
</p>
</li>
<li> <p><code>tau</code>, the maximum distance a child can be from its
parent (when <code>disp</code> = "uniform").
</p>
</li>
</ul>
<p>The <code>"child.info"</code> argument is required when <code>child.dist</code>
is set to <code>"twocamera"</code>. It must be a list that comprises (i) a
component named <code>w</code>, providing the halfwidth of the detection
zone; (ii) a component named <code>b</code>, providing the halfwidth of
the survey area; (iii) a component named <code>l</code>, providing the
time lag between cameras (in seconds); and (iv) a component named
<code>tau</code>, providing the mean dive-cycle duration. See Stevenson,
Borchers, and Fewster (2019) for details.
</p>


<h3>Value</h3>

<p>An R6 reference class object.
</p>


<h3>References</h3>

<p>Jones-Todd, C. M., Caie, P., Illian, J. B., Stevenson,
B. C., Savage, A., Harrison, D. J., and Bown, J. L. (in
press). Identifying prognostic structural features in tissue
sections of colon cancer patients using point pattern
analysis. <em>Statistics in Medicine</em>, <strong>38</strong>:
1421–1441.
</p>
<p>Stevenson, B. C., Borchers, D. L., and Fewster,
R. M. (2019) Cluster capture-recapture to account for
identification uncertainty on aerial surveys of animal
populations. <em>Biometrics</em>, <strong>75</strong>: 326–336.
</p>
<p>Tanaka, U., Ogata, Y., and Stoyan, D. (2008) Parameter
estimation and model selection for Neyman-Scott point
processes. <em>Biometrical Journal</em>, <strong>50</strong>: 43–57.
</p>


<h3>See Also</h3>

<p>Use coef.palm to extract estimated parameters, and
plot.palm to plot the estimated Palm intensity
function. Use boot.palm to run a parametric bootstrap,
allowing calculation of standard errors and confidence
intervals.
</p>
<p>See sim.ns to simulate from a Neyman-Scott point
process.
</p>


<h3>Examples</h3>

<pre><code class="language-R">## Fitting model to example data.
fit &lt;- fit.ns(example.2D, lims = rbind(c(0, 1), c(0, 1)), R = 0.5)
## Printing estimates.
coef(fit)
## Plotting the estimated Palm intensity.
plot(fit)
## Not run: 
## Simulating data and fitting additional models.
set.seed(1234)
## One-dimensional Thomas process.
data.thomas &lt;- sim.ns(c(D = 10, lambda = 5, sigma = 0.025), lims = rbind(c(0, 1)))
## Fitting a model to these data.
fit.thomas &lt;- fit.ns(data.thomas$points, lims = rbind(c(0, 1)), R = 0.5)
## Three-dimensional Matern process.
data.matern &lt;- sim.ns(c(D = 10, lambda = 10, tau = 0.1), disp = "uniform",
                      lims = rbind(c(0, 1), c(0, 2), c(0, 3)))
## Fitting a model to these data.
fit.matern &lt;- fit.ns(data.matern$points, lims = rbind(c(0, 1), c(0, 2), c(0, 3)),
                     R = 0.5, disp = "uniform")

## End(Not run)

</code></pre>


</div>