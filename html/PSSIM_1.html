<div class="container">

<table style="width: 100%;"><tr>
<td>makepseudo</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>Nearest neighbor augmentatation based on ranks</h2>

<h3>Description</h3>

<p>The function makepseudo performs the nearest neighbor augmentation
based on the rank of covariate values according to the scheme discribed
on page 410-411 of Wang, Tolos and Wang (2010)
</p>


<h3>Usage</h3>

<pre><code class="language-R">makepseudo(N, n, k, a, alltrt)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>N</code></td>
<td>
<p>total number of covariate values.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>n</code></td>
<td>
<p>vector of sample sizes from all treatments</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>k</code></td>
<td>
<p>number of nearest neighbors</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>a</code></td>
<td>
<p>number of treatment levels in the data</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>alltrt</code></td>
<td>
<p>a matrix of dimension 3x<code>N</code>, whose first two rows are
Y and X, and the third row gives the rank of X values within the
same treatment level.</p>
</td>
</tr>
</table>
<h3>Value</h3>

<p>A list containing the following:
psudo: a 3-d array of the dimension (k, a, N) that stores the
augmented observations based on k-nearest neighbor rule
in Wang, Tolos and Wang (2010).
index: a 3-d array of the dimension (k, a, N) that stores the
index of which observation was used for augmentation.
</p>


<h3>References</h3>

<p>Haiyan Wang, Siti Tolos, and Suojin Wang (2010). A Distribution Free
Nonparametric Test to Detect Dependence Between a Response Variable and
Covariate in Presence of Heteroscedastic Treatment Effects.
The Canadian Journal of Statistics. 38(3), 408433. Doi:10.1002/cjs.10068
</p>


<h3>Examples</h3>

<pre><code class="language-R"> a=2; n=c(7,9); N=sum(n);  X=runif(N);
 trt=c(rep(1,n[1]), rep(2, n[2])); e=rnorm(N, 0, 0.1)
 Y=ifelse(trt==1, 4*(X-0.5)^2+e, 2*X+e)
 ranksuse=unlist(tapply(X, trt, rank) )
 alltrt=rbind(Y, X, ranksuse )
 aug=makepseudo(N,n, k=3, a, alltrt)

</code></pre>


</div>