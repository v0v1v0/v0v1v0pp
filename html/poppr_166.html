<div class="container">

<table style="width: 100%;"><tr>
<td>rare_allele_correction</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>Correcting rare allele frequencies</h2>

<h3>Description</h3>

<p>The following is a set of arguments for use in <code>rraf</code>, 
<code>pgen</code>, and <code>psex</code> to correct rare allele frequencies
that were lost in estimating round-robin allele frequencies.
</p>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>e</code></td>
<td>
<p>a numeric epsilon value to use for all missing allele frequencies.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>d</code></td>
<td>
<p>the unit by which to take the reciprocal. <code>div = "sample"</code> will
be 1/(n samples), <code>d = "mlg"</code> will be 1/(n mlg), and <code>d = 
"rrmlg"</code> will be 1/(n mlg at that locus). This is overridden by <code>e</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>mul</code></td>
<td>
<p>a multiplier for div. Default is <code>mul = 1</code>. This parameter 
is overridden by <code>e</code></p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>sum_to_one</code></td>
<td>
<p>when <code>TRUE</code>, the original frequencies will be reduced 
so that all allele frequencies will sum to one. <strong>Default: 
<code>FALSE</code></strong></p>
</td>
</tr>
</table>
<h3>Details</h3>

<p>By default (<code>d = "sample", e = NULL, sum_to_one = FALSE, mul =
1</code>), this will add 1/(n samples) to all zero-value alleles. The basic formula
is <strong>1/(d * m)</strong> unless <strong>e</strong> is specified. If <code>sum_to_one = 
TRUE</code>, then the frequencies will be scaled as x/sum(x) AFTER correction, 
indicating that the allele frequencies will be reduced. See the examples for 
details. The general pattern of correction is that the value of the MAF will 
be <em>rrmlg &gt; mlg &gt; sample</em>
</p>


<h3>Motivation</h3>

<p>When calculating allele frequencies from a round-robin
approach, rare alleles are often lost resulting in zero-valued allele
frequencies (Arnaud-Haond et al. 2007, Parks and Werth 1993). This can be
problematic when calculating values for <code>pgen</code> and
<code>psex</code> because frequencies of zero will result in undefined
values for samples that contain those rare alleles. The solution to this
problem is to give an estimate for the frequency of those rare alleles, but
the question of HOW to do that arises. These arguments provide a way to
define how rare alleles are to be estimated/corrected.
</p>


<h3>Using these arguments</h3>

<p>These arguments are for use in the functions <code>rraf</code>, 
<code>pgen</code>, and <code>psex</code>. They will replace the dots (...) 
that appear at the end of the function call. For example, if you want to set 
the minor allele frequencies to a specific value (let's say 0.001),
regardless of locus, you can insert <code>e = 0.001</code> along with any other 
arguments (note, position is not specific): </p>
<pre>
pgen(my_data, e = 0.001, log = FALSE) 
psex(my_data, method = "multiple", e = 0.001)</pre>


<h3>Author(s)</h3>

<p>Zhian N. Kamvar
</p>


<h3>References</h3>

<p>Arnaud-Haond, S., Duarte, C. M., Alberto, F., &amp; Serr√£o, E. A. 2007.
Standardizing methods to address clonality in population studies.
<em>Molecular Ecology</em>, 16(24), 5115-5139.
</p>
<p>Parks, J. C., &amp; Werth, C. R. 1993. A study of spatial features of clones in a
population of bracken fern, <em>Pteridium aquilinum</em> (Dennstaedtiaceae).
<em>American Journal of Botany</em>, 537-544.
</p>


<h3>See Also</h3>

<p><code>rraf</code>, 
<code>pgen</code>, 
<code>psex</code>, 
<code>rrmlg</code>
</p>


<h3>Examples</h3>

<pre><code class="language-R">## Not run: 

data(Pram)
#-------------------------------------

# If you set correction = FALSE, you'll notice the zero-valued alleles

rraf(Pram, correction = FALSE)

# By default, however, the data will be corrected by 1/n

rraf(Pram)

# Of course, this is a diploid organism, we might want to set 1/2n

rraf(Pram, mul = 1/2)

# To set MAF = 1/2mlg

rraf(Pram, d = "mlg", mul = 1/2)

# Another way to think about this is, since these allele frequencies were
# derived at each locus with different sample sizes, it's only appropriate to
# correct based on those sample sizes.

rraf(Pram, d = "rrmlg", mul = 1/2)

# If we were going to use these frequencies for simulations, we might want to
# ensure that they all sum to one. 

rraf(Pram, d = "mlg", mul = 1/2, sum_to_one = TRUE) 

#-------------------------------------
# When we calculate these frequencies based on population, they are heavily
# influenced by the number of observed mlgs. 

rraf(Pram, by_pop = TRUE, d = "rrmlg", mul = 1/2)

# This can be fixed by specifying a specific value

rraf(Pram, by_pop = TRUE, e = 0.01)


## End(Not run)
</code></pre>


</div>