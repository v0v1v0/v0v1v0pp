<div class="container">

<table style="width: 100%;"><tr>
<td>phylosig</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>Compute phylogenetic signal with two methods</h2>

<h3>Description</h3>

<p>Calculate phylogenetic signal using two different methods (Pagel, 1999; Blomberg et al., 2003).
</p>


<h3>Usage</h3>

<pre><code class="language-R">phylosig(tree, x, method="K", test=FALSE, nsim=1000, se=NULL, start=NULL,
   control=list(), niter=10)
## S3 method for class 'phylosig'
plot(x, ...)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>tree</code></td>
<td>
<p>a phylogenetic tree in <code>"phylo"</code> format.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>x</code></td>
<td>
<p>vector containing values for a single continuously distributed trait. In the case of the <code>plot</code> method, <code>x</code> is an object of class <code>"phylosig"</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>method</code></td>
<td>
<p>method to compute signal: can be <code>"K"</code> or <code>"lambda"</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>test</code></td>
<td>
<p>logical indicating whether or not to conduct a hypothesis test of <code>"K"</code> or <code>"lambda"</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>nsim</code></td>
<td>
<p>for <code>method="K"</code>, number of simulations in randomization test.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>se</code></td>
<td>
<p>named vector containing the standard errors for each species.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>start</code></td>
<td>
<p>vector of starting values for optimization of (respectively) <code class="reqn">\sigma^2</code> and <code class="reqn">\lambda</code>. Only used in <code>method="lambda"</code> and <code>se!=NULL</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>control</code></td>
<td>
<p>list of control parameters for multidimensional optimization, implemented in <code>optim</code>. Only used in <code>method="lambda"</code> and <code>se!=NULL</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>niter</code></td>
<td>
<p>number of iterations for likelihood optimization of <code class="reqn">\lambda</code> (if <code>se!=NULL</code>), or the number of <em>intervals</em> between 0 and the maximum possible value of <code class="reqn">\lambda</code> for univariate optimization of <code class="reqn">\lambda</code> (if <code>se==NULL</code>).</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>...</code></td>
<td>
<p>optional arguments for <code>plot</code> method.</p>
</td>
</tr>
</table>
<h3>Details</h3>

<p>This function computes phylogenetic signal using two different methods. It can also conduct the hypothesis tests for significant phylogenetic signal, and estimate phylogenetic signal incorporating sampling error following Ives et al. (2007).
</p>
<p><code class="reqn">\lambda</code> optimization is performed using <code>optimize</code> with the range of <code class="reqn">\lambda</code> set between 0 and the theoretical upper limit of <code class="reqn">\lambda</code> (determined by the relative height of the most recent internal node on the tree).
</p>
<p><code>plot.phylosig</code> creates either a plot of the null distribution of <em>K</em> or a likelihood surface, depending on the value of <code>method</code>.
</p>


<h3>Value</h3>

<p>The function returns an object of class <code>"phylosig"</code>. With default arguments (<code>method="K"</code>, <code>test=FALSE</code>, and <code>se=NULL</code>), this will be a single numeric value. Otherwise, if <code>(method="K")</code>, it will consist of a list with up to the following elements:
</p>
<table>
<tr style="vertical-align: top;">
<td><code>K</code></td>
<td>
<p>value of the K-statistic.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>sig2</code></td>
<td>
<p>rate of evolution, <code class="reqn">\sigma^2</code>, for estimation with sampling error.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>logL</code></td>
<td>
<p>log-likelihood, for estimation with sampling error.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>P</code></td>
<td>
<p>optionally, the P-value from the randomization test.</p>
</td>
</tr>
</table>
<p>If <code>(method="lambda")</code>, it will be a list with up to the following elements:
</p>
<table>
<tr style="vertical-align: top;">
<td><code>lambda</code></td>
<td>
<p>fitted value of <code class="reqn">\lambda</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>sig2</code></td>
<td>
<p>rate of evolution, <code class="reqn">\sigma^2</code>, for estimation with sampling error.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>logL</code></td>
<td>
<p>log-likelihood.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>logL0</code></td>
<td>
<p>log-likelihood for <code class="reqn">\lambda=0</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>P</code></td>
<td>
<p>P-value of the likelihood ratio test.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>convergence</code></td>
<td>
<p>value for convergence, for estimation with sampling error only. (See <code>optim</code>).</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>message</code></td>
<td>
<p>message from <code>optim</code>, for estimation with sampling error only.</p>
</td>
</tr>
</table>
<h3>Author(s)</h3>

<p>Liam Revell <a href="mailto:liam.revell@umb.edu">liam.revell@umb.edu</a></p>


<h3>References</h3>

<p>Blomberg, S. P., T. Garland Jr., and A. R. Ives (2003) Testing for phylogenetic signal in comparative data: Behavioral traits are more labile. <em>Evolution</em>, <b>57</b>, 717-745.
</p>
<p>Ives, A. R., P. E. Midford, and T. Garland Jr. (2007) Within-species variation and measurement error in phylogenetic comparative biology. <em>Systematic Biology</em>, <b>56</b>, 252-270.
</p>
<p>Pagel, M. (1999) Inferring the historical patterns of biological evolution. <em>Nature</em>, <b>401</b>, 877-884.
</p>
<p>Revell, L. J. (2024) phytools 2.0: an updated R ecosystem for phylogenetic comparative methods (and other things). <em>PeerJ</em>, <b>12</b>, e16505.
</p>


<h3>Examples</h3>

<pre><code class="language-R">## load data from Garland et al. (1992)
data(mammal.tree)
data(mammal.data)
## extract characters of interest
ln.bodyMass&lt;-log(setNames(mammal.data$bodyMass,
    rownames(mammal.data)))
ln.homeRange&lt;-log(setNames(mammal.data$homeRange,
    rownames(mammal.data)))
## compute phylogenetic signal K
K.bodyMass&lt;-phylosig(mammal.tree,ln.bodyMass,
    test=TRUE)
print(K.bodyMass)
plot(K.bodyMass)
K.homeRange&lt;-phylosig(mammal.tree,ln.homeRange,
    test=TRUE)
print(K.homeRange)
plot(K.homeRange)
## compute phylogenetic signal lambda
lambda.bodyMass&lt;-phylosig(mammal.tree,ln.bodyMass,
    method="lambda",test=TRUE)
print(lambda.bodyMass)
plot(lambda.bodyMass)
lambda.homeRange&lt;-phylosig(mammal.tree,ln.homeRange,
    method="lambda",test=TRUE)
print(lambda.homeRange)
plot(lambda.homeRange)
</code></pre>


</div>