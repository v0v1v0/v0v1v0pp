<div class="container">

<table style="width: 100%;"><tr>
<td>ptsr.fit</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>Title Function to fit a PTSR model</h2>

<h3>Description</h3>

<p>Title Function to fit a PTSR model
</p>


<h3>Usage</h3>

<pre><code class="language-R">ptsr.fit(start, yt, xreg = NULL, xregar = TRUE, fit.alpha = TRUE,
  p = 0, q = 0, arlag = NULL, malag = NULL, ddist = d.gamma,
  link1 = "log", link2 = "identity", g1 = NULL, g1.inv = NULL,
  g2 = NULL, method = "L-BFGS-B", ...)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>start</code></td>
<td>
<p>a vector with the starting values for the non-fixed coefficients
of the model.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>yt</code></td>
<td>
<p>the time series</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>xreg</code></td>
<td>
<p>optionally, a vector or matrix of external regressors. Default is <code>NULL</code></p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>xregar</code></td>
<td>
<p>logical, if <code>FALSE</code>, the regressors are not included in the
AR component of the model. Default is <code>TRUE</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>fit.alpha</code></td>
<td>
<p>logical, if FALSE, alpha is set to zero. Default is <code>TRUE</code></p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>p</code></td>
<td>
<p>order of the AR polinomial</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>q</code></td>
<td>
<p>order of the MA polinomial</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>arlag</code></td>
<td>
<p>the lags to be included in the AR polinomial. Default is <code>NULL</code>, meaning that all lags will be included.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>malag</code></td>
<td>
<p>the lags to be included in the MA polinomial. Default is <code>NULL</code>, meaning that all lags will be included.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>ddist</code></td>
<td>
<p>function, the density function to be used</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>link1</code></td>
<td>
<p>character indicating which link must be used for <code class="reqn">\mu_t</code>.  See <code>ptsr.link</code> for available links. Default is ‘log’.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>link2</code></td>
<td>
<p>character indicating which link must be used for <code class="reqn">y_t</code> in the AR recursion.  See <code>ptsr.link</code> for available links. Default is ‘identity’.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>g1</code></td>
<td>
<p>optionally, a link function to be used  for <code class="reqn">\mu_t</code>. Default is <code>NULL</code>, so that it is calculated internally, using <code>link1</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>g1.inv</code></td>
<td>
<p>optionally, a the inverse link function to be used  for <code class="reqn">\eta_t</code>. It must the the ivnerse of <code>g1</code>. Default is <code>NULL</code>, so that it is calculated internally, using <code>link1</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>g2</code></td>
<td>
<p>optionally, a link function to be used  for <code class="reqn">y_t</code>. Default is <code>NULL</code>, so that it is calculated internally, using <code>link2</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>method</code></td>
<td>
<p>The method to be used. See [optim][stats::optim] for details.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>...</code></td>
<td>
<p>Further arguments to be passed to <code>optim</code>.</p>
</td>
</tr>
</table>
<h3>Value</h3>

<p>The same arguments return by <code>optim</code> plus a the  following arguments
</p>

<ul>
<li> <p><code>coefficients</code>: a vector with the estimated coefficients;
</p>
</li>
<li> <p><code>sll</code>: the sum of the log-likelihood for the fitted model;
</p>
</li>
<li> <p><code>series</code>: the original time series;
</p>
</li>
<li> <p><code>xreg</code>: the regressors (if any);
</p>
</li>
<li> <p><code>fitted.values</code>:  the conditional mean, which corresponds to
the in-sample forecast, also denoted fitted values;
</p>
</li>
<li> <p><code>residuals</code>: the observed minus the fitted values;
</p>
</li>
<li> <p><code>model</code>: a list with the configurations used to fit the model.
</p>
</li>
</ul>
<h3>Examples</h3>

<pre><code class="language-R">
#-------------------------------------------------------------------
# Gamma-ARMA(1,1) model with no regressors
#-------------------------------------------------------------------

simu = ptsr.sim(n = 3000, burn = 50,
                varphi = 20, alpha = 0,
                phi = 0.35, theta = 0.2,
                seed = 1234, rdist = r.gamma,
                link1 = "log", link2 = "log")

fit1 = ptsr.fit(start =  c(0,0,0,10), yt = simu$yt,
               fit.alpha = TRUE, p = 1, q = 1,
               ddist = d.gamma, link1 = "log",
               link2 = "log", method = "L-BFGS-B")
summary(fit1)

# removing alpha from the model
fit2 = ptsr.fit(start =  c(0,0,10), yt = simu$yt,
               fit.alpha = FALSE, p = 1, q = 1,
               ddist = d.gamma, link1 = "log",
               link2 = "log", method = "L-BFGS-B")
summary(fit2)

</code></pre>


</div>