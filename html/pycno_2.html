<div class="container">

<table style="width: 100%;"><tr>
<td>Estimation of Population from Pycnophylatic Interpolation</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>
Estimate populations for a set of zones based on pycnophylactic interpolation
</h2>

<h3>Description</h3>

<p>Given a <code>SpatialGridDataFrame</code> of population estimates and a set of polygons,
compute a population  estimate based on Tobler's pycnophylactic interpolation
algorithm for each zone. The result is a vector.
</p>


<h3>Usage</h3>

<pre><code class="language-R">estimate.pycno(sgdf, spdf)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>sgdf</code></td>
<td>

<p>A <code>SpatialGridDataFrame</code> containing the ouput of a pycnophylatic interpolation,
such as those produced by <code>pycno</code>.
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>spdf</code></td>
<td>

<p>A <code>SpatialPolygonsDataFrame</code>, giving the polygons for which estimates are wanted.
</p>
</td>
</tr>
</table>
<h3>Details</h3>

<p>Takes the estimate of population density for each pixel,  checks which polygon each pixel is in, 
and aggregates them. Accuracy depends on the scale of pixels in the initial interpolation.
</p>


<h3>Value</h3>

<p>A vector in which each each pixel set at the estimated population aggregation to each zone in <code>spdf</code>.
</p>


<h3>Note</h3>

<p>Pycnophylatic interpolation has the property that the sum of the estimated values associated with all of the pixels in any polygon equals the supplied population for that polygon.  A further property is that all pixel values are greater than or equal to zero.  The method is generally used to obtain pixel-based population estimates when total populations for a set of irregular polygons (eg. counties) are known.
</p>


<h3>Author(s)</h3>

<p>Chris Brunsdon
</p>


<h3>References</h3>

<p>Tobler, W.R. (1979) <em>Smooth Pycnophylactic Interpolation for Geographical Regions</em>. Journal of the American Statistical Association, v74(367) pp. 519-530.
</p>


<h3>See Also</h3>

<p><code>pycno</code>
</p>


<h3>Examples</h3>

<pre><code class="language-R">library(sp)
# Read in data for North Carolina as a SpatialPolygonsDataFrame
#nc.sids &lt;- readShapeSpatial(system.file("shapes/sids.shp", package="maptools")[1], 
#  IDvar="FIPSNO", proj4string=CRS("+proj=longlat +ellps=clrk66"))

nc.sids &lt;- as(sf::st_read(system.file("shape/nc.shp", package="sf")), "Spatial")
row.names(nc.sids) &lt;- as.character(nc.sids$FIPSNO)

# Compute the pycnophylactic surface for 1974 births as a SpatialGridDataFrame
# Note probably shouldn't really base grid cells on Lat/Long coordinates
# This example just serves to illustrate the use of the functions
births74 &lt;- pycno(nc.sids,nc.sids$BIR74,0.05,converge=1)

# Create a new 'blocky' set of zones
#blocks &lt;- gUnionCascaded(nc.sids,1*(coordinates(nc.sids)[,2] &gt; 36) + 
#  2*(coordinates(nc.sids)[,1] &gt; -80))

crds &lt;- sf::st_coordinates(sf::st_centroid(sf::st_geometry(sf::st_as_sf(nc.sids)),
 of_largest_polygon = TRUE))
block_ID &lt;- 1*(crds[,2] &gt; 36) + 2*(crds[,1] &gt; -80)
temp &lt;- sf::st_as_sf(nc.sids)
temp$block_ID &lt;- block_ID
blocks &lt;- as(aggregate(temp, by=list(temp$block_ID), head, n=1), "Spatial")

# Plot the blocky zones
plot(blocks)
# Aggregate data to them
estimates &lt;- estimate.pycno(births74,blocks)
# Write the estimates on to the map
text(coordinates(blocks),as.character(estimates))
</code></pre>


</div>