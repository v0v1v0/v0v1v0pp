<div class="container">

<table style="width: 100%;"><tr>
<td>pml_bb</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>Likelihood of a tree.</h2>

<h3>Description</h3>

<p><code>pml_bb</code> for pml black box infers a phylogenetic tree infers a tree
using maximum likelihood (ML).
</p>


<h3>Usage</h3>

<pre><code class="language-R">pml_bb(x, model = NULL, rearrangement = "stochastic",
  method = "unrooted", start = NULL, tip.dates = NULL, ...)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>x</code></td>
<td>
<p>An alignment of class (either class <code>phyDat</code>, <code>DNAbin</code> or
<code>AAbin</code>) or an object of class <code>modelTest</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>model</code></td>
<td>
<p>A string providing model (e.g. "GTR+G(4)+I"). Not necessary if
a modelTest object is supplied.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>rearrangement</code></td>
<td>
<p>Type of tree tree rearrangements to perform, one of
"none", "NNI", "stochastic" or "ratchet"</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>method</code></td>
<td>
<p>One of "unrooted", "ultrametric" or "tiplabeled".</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>start</code></td>
<td>
<p>A starting tree can be supplied.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>tip.dates</code></td>
<td>
<p>A named vector of sampling times associated to the tips /
sequences.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>...</code></td>
<td>
<p>Further arguments passed to or from other methods.</p>
</td>
</tr>
</table>
<h3>Details</h3>

<p><code>pml_bb</code> is a convenience function combining <code>pml</code> and
<code>optim.pml</code>. If no tree is supplied, the function will generate a
starting tree. If a modelTest object is supplied the model will be chosen
according to BIC.
</p>
<p><code>tip.dates</code> should be a named vector of sampling times, in any time
unit, with time increasing toward the present. For example, this may be in
units of “days since study start” or “years since 10,000 BCE”, but not
“millions of years ago”.
</p>
<p><code>model</code> takes a string and tries to extract the model. When an
<code>modelTest</code> object the best BIC model is chosen by default.
The string should contain a substitution model (e.g. JC, GTR, WAG) and can
additional have  a term "+I" for invariant sites, "+G(4)" for a discrete
gamma model, "+R(4)" for a free rate model. In case of amino acid models
a term "+F" for estimating the amino acid frequencies. Whether nucleotide
frequencies are estimated is defined by <code>pml.control</code>.
</p>
<p>Currently very experimental and likely to change.
</p>


<h3>Value</h3>

<p><code>pml_bb</code> returns an object of class pml.
</p>


<h3>Author(s)</h3>

<p>Klaus Schliep <a href="mailto:klaus.schliep@gmail.com">klaus.schliep@gmail.com</a>
</p>


<h3>See Also</h3>

<p><code>optim.pml</code>, <code>modelTest</code>,
<code>rtt</code>, <code>pml.control</code>
</p>


<h3>Examples</h3>

<pre><code class="language-R">
data(woodmouse)
tmp &lt;- pml_bb(woodmouse, model="HKY+I", rearrangement="NNI")

## Not run: 
data(Laurasiatherian)
mt &lt;- modelTest(Laurasiatherian)
fit &lt;- pml_bb(mt)

# estimate free rate model with 2 rate categories
fit_HKY_R2 &lt;- pml_bb(woodmouse, model="HKY+R(2)")

## End(Not run)
</code></pre>


</div>