<div class="container">

<table style="width: 100%;"><tr>
<td>pima</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>Calculating Prediction Intervals</h2>

<h3>Description</h3>

<p>This function can estimate prediction intervals (PIs) as follows: 
A parametric bootstrap PI based on confidence distribution
(Nagashima et al., 2018). A parametric bootstrap confidence
interval is also calculated based on the same sampling method
for bootstrap PI.
The Higgins–Thompson–Spiegelhalter (2009) prediction interval.
The Partlett–Riley (2017) prediction intervals.
</p>


<h3>Usage</h3>

<pre><code class="language-R">pima(y, se, v = NULL, alpha = 0.05, method = c("boot", "HTS", "HK",
  "SJ", "KR", "CL", "APX"), B = 25000, parallel = FALSE, seed = NULL,
  maxit1 = 1e+05, eps = 10^(-10), lower = 0, upper = 1000,
  maxit2 = 1000, tol = .Machine$double.eps^0.25, rnd = NULL,
  maxiter = 100)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>y</code></td>
<td>
<p>the effect size estimates vector</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>se</code></td>
<td>
<p>the within studies standard error estimates vector</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>v</code></td>
<td>
<p>the within studies variance estimates vector</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>alpha</code></td>
<td>
<p>the alpha level of the prediction interval</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>method</code></td>
<td>
<p>the calculation method for the pretiction interval (default = "boot").
</p>

<ul>
<li> <p><code>boot</code>: A parametric bootstrap prediction interval
(Nagashima et al., 2018).
</p>
</li>
<li> <p><code>HTS</code>: the Higgins–Thompson–Spiegelhalter (2009) prediction interval / 
(the DerSimonian &amp; Laird estimator for <code class="reqn">\tau^2</code> with
an approximate variance estimator for the average effect,
<code class="reqn">(1/\sum{\hat{w}_i})^{-1}</code>, <code class="reqn">df=K-2</code>).
</p>
</li>
<li> <p><code>HK</code>: Partlett–Riley (2017) prediction interval
(the REML estimator for <code class="reqn">\tau^2</code> with
the Hartung (1999)'s variance estimator [the Hartung and
Knapp (2001)'s estimator] for the average effect,
<code class="reqn">df=K-2</code>).
</p>
</li>
<li> <p><code>SJ</code>: Partlett–Riley (2017) prediction interval /
(the REML estimator for <code class="reqn">\tau^2</code> with
the Sidik and Jonkman (2006)'s bias coreccted variance
estimator for the average effect, <code class="reqn">df=K-2</code>).
</p>
</li>
<li> <p><code>KR</code>: Partlett–Riley (2017) prediction interval /
(the REML estimator for <code class="reqn">\tau^2</code> with
the Kenward and Roger (1997)'s approach
for the average effect, <code class="reqn">df=\nu-1</code>).
</p>
</li>
<li> <p><code>APX</code>: Partlett–Riley (2017) prediction interval /
(the REML estimator for <code class="reqn">\tau^2</code> with
an approximate variance estimator for the average
effect, <code class="reqn">df=K-2</code>).
</p>
</li>
</ul>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>B</code></td>
<td>
<p>the number of bootstrap samples</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>parallel</code></td>
<td>
<p>the number of threads used in parallel computing, or FALSE that means single threading</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>seed</code></td>
<td>
<p>set the value of random seed</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>maxit1</code></td>
<td>
<p>the maximum number of iteration for the exact distribution function of <code class="reqn">Q</code></p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>eps</code></td>
<td>
<p>the desired level of accuracy for the exact distribution function of <code class="reqn">Q</code></p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>lower</code></td>
<td>
<p>the lower limit of random numbers of <code class="reqn">\tau^2</code></p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>upper</code></td>
<td>
<p>the upper limit of random numbers of <code class="reqn">\tau^2</code></p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>maxit2</code></td>
<td>
<p>the maximum number of iteration for numerical inversions</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>tol</code></td>
<td>
<p>the desired level of accuracy for numerical inversions</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>rnd</code></td>
<td>
<p>a vector of random numbers from the exact distribution of <code class="reqn">\tau^2</code></p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>maxiter</code></td>
<td>
<p>the maximum number of iteration for REML estimation</p>
</td>
</tr>
</table>
<h3>Details</h3>

<p>The functions <code>bootPI</code>, <code>pima_boot</code>,
<code>pima_hts</code>, <code>htsdl</code>, <code>pima_htsreml</code>, <code>htsreml</code>
are deprecated, and integrated to the <code>pima</code> function.
</p>


<h3>Value</h3>


<ul>
<li> <p><code>K</code>: the number of studies.
</p>
</li>
<li> <p><code>muhat</code>: the average treatment effect estimate <code class="reqn">\hat{\mu}</code>.
</p>
</li>
<li> <p><code>lci</code>, <code>uci</code>: the lower and upper confidence limits <code class="reqn">\hat{\mu}_l</code> and <code class="reqn">\hat{\mu}_u</code>.
</p>
</li>
<li> <p><code>lpi</code>, <code>upi</code>: the lower and upper prediction limits <code class="reqn">\hat{c}_l</code> and <code class="reqn">\hat{c}_u</code>.
</p>
</li>
<li> <p><code>tau2h</code>: the estimate for <code class="reqn">\tau^2</code>.
</p>
</li>
<li> <p><code>i2h</code>: the estimate for <code class="reqn">I^2</code>.
</p>
</li>
<li> <p><code>nup</code>: degrees of freedom for the prediction interval.
</p>
</li>
<li> <p><code>nuc</code>: degrees of freedom for the confidence interval.
</p>
</li>
<li> <p><code>vmuhat</code>: the variance estimate for <code class="reqn">\hat{\mu}</code>.
</p>
</li>
</ul>
<h3>References</h3>

<p>Higgins, J. P. T, Thompson, S. G., Spiegelhalter, D. J. (2009).
A re-evaluation of random-effects meta-analysis.
<em>J R Stat Soc Ser A Stat Soc.</em>
<strong>172</strong>(1): 137-159.
<a href="https://doi.org/10.1111/j.1467-985X.2008.00552.x">https://doi.org/10.1111/j.1467-985X.2008.00552.x</a>
</p>
<p>Partlett, C, and Riley, R. D. (2017).
Random effects meta-analysis: Coverage performance of 95
confidence and prediction intervals following REML estimation.
<em>Stat Med.</em>
<strong>36</strong>(2): 301-317.
<a href="https://doi.org/10.1002/sim.7140">https://doi.org/10.1002/sim.7140</a>
</p>
<p>Nagashima, K., Noma, H., and Furukawa, T. A. (2018).
Prediction intervals for random-effects meta-analysis:
a confidence distribution approach.
<em>Stat Methods Med Res</em>.
<em>In press</em>.
<a href="https://doi.org/10.1177/0962280218773520">https://doi.org/10.1177/0962280218773520</a>.
</p>
<p>Hartung, J. (1999).
An alternative method for meta-analysis.
<em>Biom J.</em>
<strong>41</strong>(8): 901-916.
<a href="https://doi.org/10.1002/(SICI)1521-4036(199912)41:8%3C901::AID-BIMJ901%3E3.0.CO;2-W">https://doi.org/10.1002/(SICI)1521-4036(199912)41:8&lt;901::AID-BIMJ901&gt;3.0.CO;2-W</a>.
</p>
<p>Hartung, J., and Knapp, G. (2001).
On tests of the overall treatment effect in meta-analysis with
normally distributed responses.
<em>Stat Med.</em>
<strong>20</strong>(12): 1771-1782.
<a href="https://doi.org/10.1002/sim.791">https://doi.org/10.1002/sim.791</a>.
</p>
<p>Sidik, K., and Jonkman, J. N. (2006).
Robust variance estimation for random effects meta-analysis.
<em>Comput Stat Data Anal.</em>
<strong>50</strong>(12): 3681-3701.
<a href="https://doi.org/10.1016/j.csda.2005.07.019">https://doi.org/10.1016/j.csda.2005.07.019</a>.
</p>
<p>Kenward, M. G., and Roger, J. H. (1997).
Small sample inference for fixed effects from restricted
maximum likelihood.
<em>Biometrics.</em>
<strong>53</strong>(3): 983-997.
<a href="https://www.ncbi.nlm.nih.gov/pubmed/9333350">https://www.ncbi.nlm.nih.gov/pubmed/9333350</a>.
</p>
<p>DerSimonian, R., and Laird, N. (1986).
Meta-analysis in clinical trials.
<em>Control Clin Trials.</em>
<strong>7</strong>(3): 177-188.
</p>


<h3>See Also</h3>

<p><code>print.pima</code>,
<code>plot.pima</code>,
<code>cima</code>.
</p>


<h3>Examples</h3>

<pre><code class="language-R">data(sbp, package = "pimeta")

# Nagashima-Noma-Furukawa prediction interval
# is sufficiently accurate when I^2 &gt;= 10% and K &gt;= 3
pimeta::pima(sbp$y, sbp$sigmak, seed = 3141592, parallel = 4)

# Higgins-Thompson-Spiegelhalter prediction interval and
# Partlett-Riley prediction intervals
# are accurate when I^2 &gt; 30% and K &gt; 25
pimeta::pima(sbp$y, sbp$sigmak, method = "HTS")
pimeta::pima(sbp$y, sbp$sigmak, method = "HK")
pimeta::pima(sbp$y, sbp$sigmak, method = "SJ")
pimeta::pima(sbp$y, sbp$sigmak, method = "KR")
pimeta::pima(sbp$y, sbp$sigmak, method = "APX")
</code></pre>


</div>