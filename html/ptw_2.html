<div class="container">

<table style="width: 100%;"><tr>
<td>asysm</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>Trend estimation with asymmetric least squares</h2>

<h3>Description</h3>

<p>Estimates a trend based on asymmetric least squares. In
this case used to estimate the baseline of a given spectrum.</p>


<h3>Usage</h3>

<pre><code class="language-R">  asysm(y, lambda = 1e+07, p = 0.001, eps = 1e-8, maxit = 25)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>y</code></td>
<td>
<p>data: either a vector or a data matrix containing spectra as rows</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>lambda</code></td>
<td>
<p>smoothing parameter (generally 1e5 - 1e8)</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>p</code></td>
<td>
<p>asymmetry parameter</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>eps</code></td>
<td>
<p>numerical precision for convergence</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>maxit</code></td>
<td>
<p>max number of iterations. If no convergence is reached, a
warning is issued.</p>
</td>
</tr>
</table>
<h3>Details</h3>

<p>Asymmetric least squares (not to be confused with alternating
least squares) assigns different weights to the data points that are
above and below an iteratively estimated trendline, respectively. In
this case, the asymmetry parameter p (0 &lt;= p &lt;= 1) is the weight for
points above the trendline, whereas 1-p is the weight for points below
it. Naturally, p should be small for estimating baselines. The
parameter lambda controls the amount of smoothing: the larger it is,
the smoother the trendline will be.
</p>


<h3>Value</h3>

<p>An estimated baseline</p>


<h3>Author(s)</h3>

<p>Paul Eilers, Jan Gerretzen</p>


<h3>References</h3>

<p>Eilers, P.H.C.
Eilers, P.H.C. (2004) "Parametric Time Warping", Analytical Chemistry, <b>76</b> (2), 404 – 411.
</p>
<p>Boelens, H.F.M., Eilers, P.H.C., Hankemeier, T. (2005) "Sign constraints improve the detection of differences between complex spectral data sets: LC-IR as an example", Analytical Chemistry, <b>77</b>, 7998 – 8007.
</p>


<h3>Examples</h3>

<pre><code class="language-R">data(gaschrom)
plot(gaschrom[1,], type = "l", ylim = c(0, 100))
lines(asysm(gaschrom[1,]), col = 2)
</code></pre>


</div>