<div class="container">

<table style="width: 100%;"><tr>
<td>interp.extrap.conc</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>Interpolate concentrations between measurements or extrapolate concentrations
after the last measurement.</h2>

<h3>Description</h3>

<p><code>interpolate.conc()</code> and <code>extrapolate.conc()</code> returns an interpolated (or
extrapolated) concentration. <code>interp.extrap.conc()</code> will choose whether
interpolation or extrapolation is required and will also operate on many
concentrations.  These will typically be used to estimate the concentration
between two measured concentrations or after the last measured concentration.
Of note, these functions will not extrapolate prior to the first point.
</p>


<h3>Usage</h3>

<pre><code class="language-R">interp.extrap.conc(
  conc,
  time,
  time.out,
  lambda.z = NA,
  clast = pk.calc.clast.obs(conc, time),
  options = list(),
  method = NULL,
  auc.type = "AUCinf",
  interp.method,
  extrap.method,
  ...,
  conc.blq = NULL,
  conc.na = NULL,
  check = TRUE
)

interpolate.conc(
  conc,
  time,
  time.out,
  options = list(),
  method = NULL,
  interp.method,
  conc.blq = NULL,
  conc.na = NULL,
  conc.origin = 0,
  ...,
  check = TRUE
)

extrapolate.conc(
  conc,
  time,
  time.out,
  lambda.z = NA,
  clast = pk.calc.clast.obs(conc, time),
  auc.type = "AUCinf",
  extrap.method,
  options = list(),
  conc.na = NULL,
  conc.blq = NULL,
  ...,
  check = TRUE
)

interp.extrap.conc.dose(
  conc,
  time,
  time.dose,
  route.dose = "extravascular",
  duration.dose = NA,
  time.out,
  out.after = FALSE,
  options = list(),
  conc.blq = NULL,
  conc.na = NULL,
  ...,
  check = TRUE
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>conc</code></td>
<td>
<p>Measured concentrations</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>time</code></td>
<td>
<p>Time of the measurement of the concentrations</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>time.out</code></td>
<td>
<p>Time when interpolation is requested (vector for
<code>interp.extrap.conc()</code>, scalar otherwise)</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>lambda.z</code></td>
<td>
<p>The elimination rate (in units of inverse time) for
extrapolation</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>clast</code></td>
<td>
<p>The last observed concentration above the limit of
quantification.  If not given, <code>clast</code> is calculated from
<code>pk.calc.clast.obs()</code></p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>options</code></td>
<td>
<p>List of changes to the default PKNCA options (see
<code>PKNCA.options()</code>)</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>method</code></td>
<td>
<p>The method for integration (one of 'lin up/log down',
'lin-log', or 'linear')</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>auc.type</code></td>
<td>
<p>The type of AUC to compute.  Choices are 'AUCinf', 'AUClast',
and 'AUCall'.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>interp.method, extrap.method</code></td>
<td>
<p>deprecated in favor of method and auc.type</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>...</code></td>
<td>
<p>Additional arguments passed to <code>interpolate.conc()</code> or
<code>extrapolate.conc()</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>conc.blq</code></td>
<td>
<p>How to handle BLQ values. (See <code>clean.conc.blq()</code> for usage
instructions.)</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>conc.na</code></td>
<td>
<p>How to handle NA concentrations.  (See <code>clean.conc.na()</code>)</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>check</code></td>
<td>
<p>Run <code>assert_conc_time()</code>, <code>clean.conc.blq()</code>, and
<code>clean.conc.na()</code>?</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>conc.origin</code></td>
<td>
<p>The concentration before the first measurement.
<code>conc.origin</code> is typically used to set predose values to zero (default),
set a predose concentration for endogenous compounds, or set predose
concentrations to <code>NA</code> if otherwise unknown.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>time.dose</code></td>
<td>
<p>Time of the dose</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>route.dose</code></td>
<td>
<p>What is the route of administration ("intravascular" or
"extravascular").  See the details for how this parameter is used.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>duration.dose</code></td>
<td>
<p>What is the duration of administration? See the details
for how this parameter is used.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>out.after</code></td>
<td>
<p>Should interpolation occur from the data before (<code>FALSE</code>) or
after (<code>TRUE</code>) the interpolated point?  See the details for how this
parameter is used.  It only has a meaningful effect at the instant of an IV
bolus dose.</p>
</td>
</tr>
</table>
<h3>Details</h3>

<p>An <code>NA</code> value for the <code>lambda.z</code> parameter will prevent extrapolation.
</p>

<dl>
<dt>extrap.method</dt>
<dd>

<dl>
<dt>'AUCinf'</dt>
<dd>
<p>Use lambda.z to extrapolate beyond the last point with the half-life.</p>
</dd>
<dt>'AUCall'</dt>
<dd>
<p>If the last point is above the limit of quantification or missing, this is identical to 'AUCinf'. If the last point is below the limit of quantification, then linear interpolation between the Clast and the next BLQ is used for that  interval and all additional points are extrapolated as 0.</p>
</dd>
<dt>'AUClast'</dt>
<dd>
<p>Extrapolates all points after the last above the  limit of quantification as 0.</p>
</dd>
</dl>
</dd>
</dl>
<p><code>duration.dose</code> and <code>direction.out</code> are ignored if <code>route.dose == "extravascular"</code>.  <code>direction.out</code> is ignored if <code>duration.dose &gt; 0</code>.
</p>
<p><code>route.dose</code> and <code>duration.dose</code> affect how interpolation/extrapolation of
the concentration occurs at the time of dosing.  If <code>route.dose == "intravascular"</code> and <code>duration.dose == 0</code> then extrapolation occurs for an IV
bolus using <code>pk.calc.c0()</code> with the data after dosing.  Otherwise (either
<code>route.dose == "extravascular"</code> or <code>duration.dose &gt; 0</code>), extrapolation occurs
using the concentrations before dosing and estimating the half-life (or more
precisely, estimating <code>lambda.z</code>).  Finally, <code>direction.out</code> can change the
direction of interpolation in cases with <code>route.dose == "intravascular"</code> and
<code>duration.dose == 0</code>.  When <code>direction.out == "before"</code> interpolation occurs
only with data before the dose (as is the case for <code>route.dose == "extravascular"</code>), but if <code>direction.out == "after"</code> interpolation occurs
from the data after dosing.
</p>


<h3>Value</h3>

<p>The interpolated or extrapolated concentration value as a scalar
double (or vector for <code>interp.extrap.conc()</code>).
</p>


<h3>Functions</h3>


<ul>
<li> <p><code>interpolate.conc()</code>: Interpolate concentrations through Tlast (inclusive)
</p>
</li>
<li> <p><code>extrapolate.conc()</code>: Extrapolate concentrations after Tlast
</p>
</li>
<li> <p><code>interp.extrap.conc.dose()</code>: Interpolate and extrapolate concentrations
without interpolating or extrapolating beyond doses.
</p>
</li>
</ul>
<h3>See Also</h3>

<p><code>pk.calc.clast.obs()</code>, <code>pk.calc.half.life()</code>, <code>pk.calc.c0()</code>
</p>


</div>