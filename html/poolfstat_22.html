<div class="container">

<table style="width: 100%;"><tr>
<td>add.leaf</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>Test all possible connection of a leaf to a graph with non-admixed and or admixed edges</h2>

<h3>Description</h3>

<p>Test all possible connection of a leaf to a graph with non-admixed and or admixed edges
</p>


<h3>Usage</h3>

<pre><code class="language-R">add.leaf(
  x,
  leaf.to.add,
  fstats,
  only.test.non.admixed.edges = FALSE,
  only.test.admixed.edges = FALSE,
  verbose = TRUE,
  ...
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>x</code></td>
<td>
<p>An object of class graph.params or fitted.graph (see details)</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>leaf.to.add</code></td>
<td>
<p>Name of the leaf to add</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>fstats</code></td>
<td>
<p>Object of class fstats that contains estimates of the fstats (see compute.fstats)</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>only.test.non.admixed.edges</code></td>
<td>
<p>If TRUE the function only test non.admixed edges (may be far faster)</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>only.test.admixed.edges</code></td>
<td>
<p>If TRUE the function only test admixed edges</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>verbose</code></td>
<td>
<p>If TRUE extra information is printed on the terminal</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>...</code></td>
<td>
<p>Some parameters to be passed the function fit.graph called internally</p>
</td>
</tr>
</table>
<h3>Details</h3>

<p>The input object x needs to be of class graph.params (as generated by the function generate.graph.params) or fitted.graph (as generated by the function fit.graph or by the function add.leaf itself in the graphs.fit.res elements of the output list). This is to ensure that the matrix describing the structure of the graph (graph slot of these objects) is valid (note that it can be plotted for checks). Hence graph.params objects may have been generated without fstats information (that should be supplied independently to the add.leaf function to obtain information on the fstats involving the candidate leaf defined with the leaf.to.add argument).
By default the function tests all the possible positions of a newly added edge connecting the candidate leaf to the graph with both non-admixed (including a new rooting with the candidate leaf as an outgroup) and admixed edges. If n_e is the the number of non-admixed edges of the original graph, the number of tested graphs for non-admixed edges equals n_e+1. The newly added node is named "N-"name of the leaf to add (or with more N if the name already exists). For admixed edges, the number of tested graphs equals n_e*(n_e-1)/2 and for a given tested graph, three nodes named "S-"name of the leaf to add, "S1-"name of the leaf to add and "S2-"name of the leaf to add (or with more S if the name already exists) are added and the admixture proportions are named with a letter (A to Z depending on the number of admixed nodes already present in the graph).
</p>


<h3>Value</h3>

<p>A list with the following elements:
</p>

<ol>
<li>
<p> "n.graphs": The number of tested graphs
</p>
</li>
<li>
<p> "fitted.graphs.list": a list of fitted.graph objects (indexed from 1 to n.graphs and in the same order as the list "graphs") containing the results of fitting of each graph. 
</p>
</li>
<li>
<p> "best.fitted.graph": The graph (object of class fitted.graph) with the minimal BIC (see function fit.graph) among all the graphs within fitted.graphs.list 
</p>
</li>
<li>
<p> "bic": a vector of the n.graphs BIC (indexed from 1 to n.graphs and in the same order as the "fitted.graphs.list" list) (see fit.graph details for the computation of the scores). 
</p>
</li>
</ol>
<h3>See Also</h3>

<p>see <code>fit.graph</code> and <code>generate.graph.params</code>.
</p>


</div>