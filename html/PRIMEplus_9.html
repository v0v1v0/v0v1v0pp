<div class="container">

<table style="width: 100%;"><tr>
<td>PRIMEplus.SampleSize</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>Sample Size</h2>

<h3>Description</h3>

<p>Compute the sample size for a given power                   
</p>


<h3>Usage</h3>

<pre><code class="language-R"> 
PRIMEplus.SampleSize(power=0.8, rand_ratio=0.5, effect_p=0.6, enroll_rate=380*0.25/6, 
              lambda1=0.117, HR=0.5, tau=12*5, t1=1, maxiter=100000, stopTol=1e-4,
              alpha=0.05, num_rand=1000, nsim=10000, min.N=100, max.N=700,
              tol.power=0.01, tol.N=1, print=1,
              min.sample.size=50, min.n.event=5, min.per.trt=0.25)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>power</code></td>
<td>
<p>The desired power. The default is 0.8.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>rand_ratio</code></td>
<td>
<p>Allocation ratio</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>effect_p</code></td>
<td>
<p>Vector for proportion of responders in the treatment arm at baseline (see details)</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>enroll_rate</code></td>
<td>
<p>Enrollment rate in subjects per month</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>lambda1</code></td>
<td>
<p>Baseline hazard in terms of months</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>HR</code></td>
<td>
<p>Vector of hazard ratios for responders against controls (see details)</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>tau</code></td>
<td>
<p>Total study duration</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>t1</code></td>
<td>
<p>Delayed duration</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>maxiter</code></td>
<td>
<p>Maximum number of iterations in the EM algorithm. The default is 100000.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>stopTol</code></td>
<td>
<p>Stopping tolerance in the EM algorithm. The default is 1e-4.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>alpha</code></td>
<td>
<p>Significance level. The default is 0.05.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>num_rand</code></td>
<td>
<p>Number of replications in the re-randomization test. The default is 1000.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>nsim</code></td>
<td>
<p>Number of simulations in computing power (<b>see Details</b>). 
The default is 10000.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>min.N</code></td>
<td>
<p>Lower bound for the sample size. The default is 100.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>max.N</code></td>
<td>
<p>Upper bound for the sample size. The default is 700.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>tol.power</code></td>
<td>
<p>Stopping tolerance for the power. The default is 0.01.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>tol.N</code></td>
<td>
<p>Stopping tolerance for the sample size. The default is 1.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>print</code></td>
<td>
<p>0 or 1 to print information. The default is 1.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>min.sample.size</code></td>
<td>
<p>Minimum sample size. The default is 50.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>min.n.event</code></td>
<td>
<p>Minimum number of events. The default is 5.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>min.per.trt</code></td>
<td>
<p>Minimum proportion of controls and treated subjects. The default is 0.25.</p>
</td>
</tr>
</table>
<h3>Details</h3>

<p>The length and order of <code>effect_p</code> must be the same as <code>HR</code>. Both of these vectors
should contain information only for the groups of responders. For example, if there are
full responders and partial responders, then <code>effect_p</code> and <code>HR</code> would be vectors 
of length two.
</p>
<p>This uses a bisection method to estimate the sample size. At each iteration,
the estimated power <code>power_est</code> is computed using <code>PRIMEplus.Power</code> 
for a given sample size holding all other parameters fixed.
The algorithm terminates when <code>abs(power - power_est) &lt;= tol.power</code> or
when the length of the estimated interval containing the sample size is
less than or equal to <code>tol.N</code>.
</p>
<p><b>NOTE:</b> <br><b>It is important to note that the power for a given sample size is estimated by 
running a simulation. Thus, by setting a different seed, a different result may 
be returned. Therefore, to ensure a more precise estimated sample size, set the
option <code>nsim</code> to a large value and/or run this function several times by
setting different seeds and examine the distribution of returned sample sizes.</b>
</p>


<h3>Value</h3>

<p> A list containing the sample size and power.
</p>


<h3>Author(s)</h3>

<p>Zhenzhen Xu &lt;Zhenzhen.Xu@fda.hhs.gov&gt;, Yongsoek Park &lt;yongpark@pitt.edu&gt; and Bin Zhu &lt;bin.zhu@nih.gov&gt;
</p>


<h3>See Also</h3>

 <p><code>PRIMEplus.Power</code> </p>


</div>