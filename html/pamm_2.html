<div class="container">

<table style="width: 100%;"><tr>
<td>EAMM</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>Simulation function for exploratory power analysis for random effects</h2>

<h3>Description</h3>

<p>Given a specific sample size, fixed number of group and replicates per group, the function simulate different variance-covariance structure and assess p-values and power of random intercept and random slope
</p>


<h3>Usage</h3>

<pre><code class="language-R">EAMM(
  numsim,
  group,
  repl,
  fixed = c(0, 1, 0),
  VI = seq(0.05, 0.95, 0.05),
  VS = seq(0.05, 0.5, 0.05),
  CoIS = 0,
  relIS = "cor",
  n.X = NA,
  autocorr.X = 0,
  X.dist = "gaussian",
  intercept = 0,
  heteroscedasticity = c("null"),
  mer.sim = TRUE,
  mer.model = NULL
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>numsim</code></td>
<td>
<p>number of simulation for each step</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>group</code></td>
<td>
<p>number of group</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>repl</code></td>
<td>
<p>number of replicates per group</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>fixed</code></td>
<td>
<p>vector of lenght 3 with mean, variance and estimate of
fixed effect to simulate. Default: <code>c(0, 1, 0)</code></p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>VI</code></td>
<td>
<p>variance component of intercept. Could be specified as a
vector. Default: <code>seq(0.05, 0.95, 0.05)</code></p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>VS</code></td>
<td>
<p>Variance component of the slope or IxE. Could be specified as a vector.
Default: <code>seq(0.05, 0.5, 0.05)</code></p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>CoIS</code></td>
<td>
<p>value of correlation or covariance between random intercept
and random slope. Default: 0</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>relIS</code></td>
<td>
<p>"cor" or "cov" set the type of relation give in CoIS. By
default the relation is set to correlation</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>n.X</code></td>
<td>
<p>number of different values to simulate for the fixed effect (covariate).
If <code>NA</code>, all values of X are independent between groups. If the value specified
is equivalent to the number of replicates per group, <code>repl</code>, then all groups
are observed for the same values of the covariate.  Default: <code>NA</code></p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>autocorr.X</code></td>
<td>
<p>correlation between two successive covariate value for a group. Default: <code>0</code></p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>X.dist</code></td>
<td>
<p>specify the distribution of the fixed effect. Only "gaussian" (normal distribution) and
"unif" (uniform distribution) are accepted actually. Default: <code>"gaussian"</code></p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>intercept</code></td>
<td>
<p>a numeric value giving the expected intercept value.
Default: 0</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>heteroscedasticity</code></td>
<td>
<p>a vector specifying heterogeneity in residual
variance across X.  If <code>c("null")</code> residual variance is homogeneous
across X. If <code>c("power",t1,t2)</code> models heterogeneity with a constant
plus power variance function.
Letting <code class="reqn">v</code> denote the variance covariate and <code class="reqn">\sigma^2(v)</code>
denote the variance function evaluated at <code class="reqn">v</code>, the constant plus power
variance function is defined as <code class="reqn">\sigma^2(v) = (\theta_1 + |v|^{\theta_2})^2</code>,
where <code class="reqn">\theta_1,\theta_2</code> are the variance function coefficients.
If <code>c("exp",t)</code>,models heterogeneity with an
exponential variance function. Letting <code class="reqn">v</code> denote the variance covariate and <code class="reqn">\sigma^2(v)</code>
denote the variance function evaluated at <code class="reqn">v</code>, the exponential
variance function is defined as <code class="reqn">\sigma^2(v) = e^{2 * \theta * v}</code>, where <code class="reqn">\theta</code> is the variance
function coefficient. Default:"Null"</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>mer.sim</code></td>
<td>
<p>Use the simluate.merMod function to simulate the data. Potentially faster for large dataset but more restricted in terms of options</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>mer.model</code></td>
<td>
<p>Simulate the data based on a existing data and model structure from a lmer object. Should be specified as a list of 3 components: a mer object fitted via lmer, an environmental covariate for which to test the random slope, a random effect (e.g. <code>list(fm1,"Days","Subject"</code>)</p>
</td>
</tr>
</table>
<h3>Details</h3>

<p>P-values for random effects are estimated using a log-likelihood ratio
test between two models with and without the effect. Power represent
the percentage of simulations providing a significant p-value for a
given random structure.
Residual variance, e, is calculted as 1-VI.
</p>


<h3>Value</h3>

<p>data frame reporting estimated P-values and power with CI for random
intercept and random slope
</p>


<h3>See Also</h3>

<p>[PAMM()], [SSF()] for other simulations
[plot.EAMM()] for plotting output
</p>


<h3>Examples</h3>

<pre><code class="language-R">## Not run: 
ours &lt;- EAMM(
  numsim = 10, group = 10, repl = 4, fixed = c(0, 1, 1),
  VI = seq(0.1, 0.3, 0.05), VS = seq(0.05, 0.2, 0.05)
)
plot(ours, "both")

(fm1 &lt;- lmer(Reaction ~ Days + (Days | Subject), sleepstudy))
ours2 &lt;- EAMM(
  numsim = 10,
  mer.model = list(model = fm1, env = "Days", random = "Subject"),
  VI = seq(0.3, 0.5, 0.1), VS = seq(0.05, 0.2, 0.05)
)
plot(ours2, "both")

## End(Not run)

</code></pre>


</div>