<div class="container">

<table style="width: 100%;"><tr>
<td>MAF_from_BAM</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>function MAF_from_BAM</h2>

<h3>Description</h3>

<p>Read BAM files  and create MAF file. BAMfiles are stored in a sub-folder '/rBAM'.
MAF files are intermediate files stored in a sub-folder '/BER'.
MAF files contain the raw counts of A,T,C,G, insertion, deletion, insertion&gt;2bp, deletion &gt;2bp for strand plus and stand minus.
Note : we strongly recommand to externally recalibrate BAM files using tools like GATK.
</p>


<h3>Usage</h3>

<pre><code class="language-R">MAF_from_BAM(
  study.dir = "Plasma/",
  input.filenames = NULL,
  bai.ext = ".bai",
  pos_ranges.file = NULL,
  force = FALSE,
  output.dir = study.dir,
  n.trim = 8
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>study.dir, </code></td>
<td>
<p>char, name of the folder containing the rBAM directory  (default 'Plasma/'). The typical folder hierarchy will consist of 'Plasma/rBAM'</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>input.filenames, </code></td>
<td>
<p>a vector of char (default NULL), the names of the BAM files to process. If NULL all BAM files in the rBAM folder will be processed</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>bai.ext, </code></td>
<td>
<p>char, filename extension of the bai files (default '.bai')</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>pos_ranges.file, </code></td>
<td>
<p>char, name of the Rdata file containing the three variables <code>pos_ind</code>, <code>pos_snp</code> and <code>pos_ranges</code> as build by the function <code>PrepareLibrary</code>. Default NULL, use the position_ranges.rda provided, used for our analysis.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>force, </code></td>
<td>
<p>boolean, (default FALSE) if TRUE force all computations to all files including already processed ones</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>output.dir, </code></td>
<td>
<p>char, name of the folder to save results  (default <code>study.dir</code>)</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>n.trim, </code></td>
<td>
<p>integer, number of base positions trimmed at the ends of each amplicon (default 8)</p>
</td>
</tr>
</table>
<h3>Value</h3>

<p>the path/names of the MAF files
</p>


<h3>Author(s)</h3>

<p>N. Pécuchet, P. Laurent-Puig, O. Nordgård and Y. Rozenholc
</p>


<h3>References</h3>

<p><em>Analysis of base-position error rate of next-generation sequencing to detect tumor mutations in circulating DNA</em> N. Pécuchet, Y. Rozenholc, E. Zonta, D. Pietraz, A. Didelot, P. Combe, L. Gibault, J-B. Bachet, V. Taly, E. Fabre, H. Blons, P. Laurent-Puig in <em>Clinical Chemistry</em>
</p>
<p><em>Novel hybridization- and tag-based error-corrected method for sensitive ctDNA mutation detection using ion semiconductor sequencing</em> Kjersti Tjensvoll, Morten Lapin, Bjørnar Gilje, Herish Garresori, Satu Oltedal, Rakel Brendsdal Forthun, Anders Molven, Yves Rozenholc and Oddmund Nordgård  in <em>Scientific Reports</em>
</p>


<h3>Examples</h3>

<pre><code class="language-R">  ## Not run: 
     ctrl.dir = system.file("extdata", "4test_only/ctrl/",
       package = "PlasmaMutationDetector2")
     if (substr(ctrl.dir,nchar(ctrl.dir),nchar(ctrl.dir))!='/')
       ctrl.dir = paste0(ctrl.dir,'/') # TO RUN UNDER WINDOWS
     MAF_from_BAM(ctrl.dir,force=TRUE,output.dir=paste0(tempdir(),'/'))
   
## End(Not run)

</code></pre>


</div>