<div class="container">

<table style="width: 100%;"><tr>
<td>make_newdata</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>Construct a data frame suitable for prediction</h2>

<h3>Description</h3>

<p>This functions provides a flexible interface to create a data set that
can be plugged in as <code>newdata</code> argument to a suitable  <code>predict</code>
function (or similar).
The function is particularly useful in combination with one of the
<code>add_*</code> functions, e.g., <code>add_term</code>,
<code>add_hazard</code>, etc.
</p>


<h3>Usage</h3>

<pre><code class="language-R">make_newdata(x, ...)

## Default S3 method:
make_newdata(x, ...)

## S3 method for class 'ped'
make_newdata(x, ...)

## S3 method for class 'fped'
make_newdata(x, ...)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>x</code></td>
<td>
<p>A data frame (or object that inherits from <code>data.frame</code>).</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>...</code></td>
<td>
<p>Covariate specifications (expressions) that will be evaluated
by looking for variables in <code>x</code>. Must be of the form <code>z = f(z)</code>
where <code>z</code> is a variable in the data set and <code>f</code> a known
function that can be usefully applied to <code>z</code>. Note that this is also
necessary for single value specifications (e.g. <code>age = c(50)</code>).
For data in PED (piece-wise exponential data) format, one can also specify
the time argument, but see "Details" an "Examples" below.</p>
</td>
</tr>
</table>
<h3>Details</h3>

<p>Depending on the type of variables in <code>x</code>, mean or modus values
will be used for variables not specified in ellipsis
(see also <code>sample_info</code>). If <code>x</code> is an object
that inherits from class <code>ped</code>, useful data set completion will be
attempted depending on variables specified in ellipsis. This is especially
useful, when creating a data set with different time points, e.g. to
calculate survival probabilities over time (<code>add_surv_prob</code>)
or to calculate a time-varying covariate effects (<code>add_term</code>).
To do so, the time variable has to be specified in <code>...</code>, e.g.,
<code>tend = seq_range(tend, 20)</code>. The problem with this specification is that
not all values produced by <code>seq_range(tend, 20)</code> will be actual values
of <code>tend</code> used at the stage of estimation (and in general, it will
often be tedious to specify exact <code>tend</code> values). <code>make_newdata</code>
therefore finds the correct interval and sets <code>tend</code> to the respective
interval endpoint. For example, if the intervals of the PED object are
<code class="reqn">(0,1], (1,2]</code> then <code>tend = 1.5</code> will be set to <code>2</code> and the
remaining time-varying information (e.g. offset) completed accordingly.
See examples below.
</p>


<h3>Examples</h3>

<pre><code class="language-R"># General functionality
tumor %&gt;% make_newdata()
tumor %&gt;% make_newdata(age=c(50))
tumor %&gt;% make_newdata(days=seq_range(days, 3), age=c(50, 55))
tumor %&gt;% make_newdata(days=seq_range(days, 3), status=unique(status), age=c(50, 55))
# mean/modus values of unspecified variables are calculated over whole data
tumor %&gt;% make_newdata(sex=unique(sex))
tumor %&gt;% group_by(sex) %&gt;% make_newdata()

# Examples for PED data
ped &lt;- tumor %&gt;% slice(1:3) %&gt;% as_ped(Surv(days, status)~., cut = c(0, 500, 1000))
ped %&gt;% make_newdata(age=c(50, 55))

# if time information is specified, other time variables will be specified
# accordingly and offset calculated correctly
ped %&gt;% make_newdata(tend = c(1000), age = c(50, 55))
ped %&gt;% make_newdata(tend = unique(tend))
ped %&gt;% group_by(sex) %&gt;% make_newdata(tend = unique(tend))

# tend is set to the end point of respective interval:
ped &lt;- tumor %&gt;% as_ped(Surv(days, status)~.)
seq_range(ped$tend, 3)
make_newdata(ped, tend = seq_range(tend, 3))
</code></pre>


</div>