<div class="container">

<table style="width: 100%;"><tr>
<td>haversine</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>
Haversine Formula
</h2>

<h3>Description</h3>

<p>Haversine formula to calculate the arc distance between two points
on earth (i.e., along a great circle).
</p>


<h3>Usage</h3>

<pre><code class="language-R">haversine(loc1, loc2, R = 6371.0)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>loc1, loc2</code></td>
<td>
<p>Locations on earth; for format see Details.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>R</code></td>
<td>
<p>Average earth radius R = 6371 km, can be changed on input.</p>
</td>
</tr>
</table>
<h3>Details</h3>

<p>The Haversine formula is more robust for the calculating the distance 
as with the spherical cosine formula. The user may want to assume a 
slightly different earth radius, so this can be provided as input.
</p>
<p>The location can be input in two different formats, as latitude and
longitude in a character string, e.g. for Frankfurt airport as
'50 02 00N, 08 34 14E', or as a numerical two-vector in degrees
(not radians).
</p>
<p>Here for latitude 'N' and 'S' stand for North and South, and for
longitude 'E' or 'W' stand for East and West. For the degrees format,
South and West must be negative.
</p>
<p>These two formats can be mixed.
</p>


<h3>Value</h3>

<p>Returns the distance in km.
</p>


<h3>Author(s)</h3>

<p>Hans W. Borchers
</p>


<h3>References</h3>

<p>Entry 'Great_circle_distance' in Wikipedia.
</p>


<h3>See Also</h3>

<p>Implementations of the Haversine formula can also be found in other
R packages, e.g. 'geoPlot' or 'geosphere'.
</p>


<h3>Examples</h3>

<pre><code class="language-R">FRA = '50 02 00N, 08 34 14E'  # Frankfurt Airport
ORD = '41 58 43N, 87 54 17W'  # Chicago O'Hare Interntl. Airport
fra &lt;- c(50+2/60, 8+34/60+14/3600)
ord &lt;- c(41+58/60+43/3600, -(87+54/60+17/3600))

dis &lt;- haversine(FRA, ORD)    # 6971.059 km
fprintf('Flight distance Frankfurt-Chicago is %8.3f km.\n', dis)

dis &lt;- haversine(fra, ord)
fprintf('Flight distance Frankfurt-Chicago is %8.3f km.\n', dis)
</code></pre>


</div>