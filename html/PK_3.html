<div class="container">

<table style="width: 100%;"><tr>
<td>auc.complete</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>Confidence intervals for the area under the concentration versus time curve in complete data designs</h2>

<h3>Description</h3>

<p>Examples to find confidence intervals for the area under the concentration versus time curve (AUC) in complete data designs.</p>


<h3>Usage</h3>

<pre><code class="language-R">auc.complete(conc, time, group=NULL, method=c("t", "z", "boott"), 
        alternative=c("two.sided", "less", "greater"), 
        conf.level=0.95, nsample=1000, data) </code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>conc</code></td>
<td>
<p> Levels of concentrations as a vector. </p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>time</code></td>
<td>
<p> Time points of concentration assessment as a vector. One time point for each concentration measured needs to be specified.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>group</code></td>
<td>
<p> A grouping variable as a vector (default=<code>NULL</code>). If specified, a confidence interval for the difference of independent AUCs will be calculated. </p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>method</code></td>
<td>
<p> A character string specifying the method for calculation of confidence intervals (default=<code>c("t", "z", "boott")</code>). </p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>alternative</code></td>
<td>
<p> A character string specifying the alternative hypothesis. Possible values are <code>"less"</code>, <code>"greater"</code> and <code>"two.sided"</code> (the default). </p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>conf.level</code></td>
<td>
<p> Confidence level (default=<code>0.95</code>). </p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>nsample</code></td>
<td>
<p> Number of bootstrap iterations for method <code>boott</code> (default=<code>1000</code>). </p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>data</code></td>
<td>
<p>Optional data frame containing variables named as <code>conc</code>, <code>time</code> and <code>group</code>.</p>
</td>
</tr>
</table>
<h3>Details</h3>

<p>This function computes confidence intervals for an AUC (from 0 to the last time point) or for the difference between two AUCs in complete data designs. <br><br></p>
<p>To compute confidence intervals in complete data designs the design is treated as a batch design with a single batch. More information can therefore be found under <code>auc</code>. A corresponding reminder message is produced if confidence intervals can be computed, ie when at least 2 measurements at each time point are available.<br><br></p>
<p>The above approach, though correct, is often inefficient and so we will illustrate alternative methods in this help file. A general implementation is not provided as the most efficient analysis strongly depends on the context. The interested reader is refered to chapter 8 of Cawello (2003).<br><br></p>
<p>If <code>data</code> is specified the variable names <code>conc</code>, <code>time</code> and <code>group</code> are required and represent the corresponding variables. 
</p>


<h3>Value</h3>

<p>An object of the class PK  containing the following components: <br></p>
<table>
<tr style="vertical-align: top;">
<td><code>est</code></td>
<td>
<p>Point estimates.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>CIs</code></td>
<td>
<p>Point estimates, standard errors and confidence intervals. </p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>conc</code></td>
<td>
<p>Levels of concentrations. </p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>conf.level</code></td>
<td>
<p>Confidence level.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>design</code></td>
<td>
<p>Sampling design used.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>group</code></td>
<td>
<p>Grouping variable.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>time</code></td>
<td>
<p>Time points measured.</p>
</td>
</tr>
</table>
<h3>Author(s)</h3>

<p>Thomas Jaki and Martin Wolfsegger</p>


<h3>References</h3>

<p>Cawello W. (2003). <em>Parameters for Compartment-free Pharmacokinetics. Standardisation of Study Design, Data Analysis and Reporting</em>. Shaker Verlag, Aachen. <br><br></p>
<p>Gibaldi M. and Perrier D. (1982). <em>Pharmacokinetics</em>. Marcel Dekker, New York and Basel.<br></p>


<h3>See Also</h3>

<p><code>auc</code>, <code>estimator</code>, <code>ci</code> and <code>test</code></p>


<h3>Examples</h3>

<pre><code class="language-R">## example from Gibaldi and Perrier (1982, page 436) for an individual AUC
time &lt;- c(0, 0.165, 0.5, 1, 1.5, 3, 5, 7.5, 10)
conc &lt;- c(0, 65.03, 28.69, 10.04, 4.93, 2.29, 1.36, 0.71, 0.38)
auc.complete(conc=conc, time=time)

## dataset Indometh of package datasets
## calculate individual AUCs
require(datasets)
row &lt;- 1
res &lt;- data.frame(matrix(nrow=length(unique(Indometh$Subject)), ncol=2))
colnames(res) &lt;- c('id', 'auc')
for(i in unique(Indometh$Subject)){
   temp &lt;- subset(Indometh, i==Subject)
   res[row, 1] &lt;- i
   res[row, 2] &lt;- auc.complete(data=temp[,c("conc","time")])$est[1,1]
   row &lt;- row + 1
}
print(res)

# function to get geometric mean and corresponding CI
gm.ci &lt;- function(x, conf.level=0.95){
   res &lt;- t.test(x=log(x), conf.level=conf.level)
   out &lt;- data.frame(gm=as.double(exp(res$estimate)), lower=exp(res$conf.int[1]), 
                      upper=exp(res$conf.int[2]))
   return(out)
}    

# geometric mean and corresponding CI: assuming log-normal distributed AUCs
gm.ci(res[,2], conf.level=0.95)

# arithmetic mean and corresponding CI: assuming normal distributed AUCs 
# or at least asymptotic normal distributed arithmetic mean 
t.test(x=res[,2], conf.level=0.95)
     
# alternatively: function auc.complete
set.seed(300874)
Indometh$id &lt;- as.character(Indometh$Subject)
Indometh &lt;- Indometh[order(Indometh$id, Indometh$time),]
Indometh &lt;- Indometh[order(Indometh$time),]
auc.complete(conc=Indometh$conc, time=Indometh$time, method=c("t"))


## example for comparing AUCs assessed in a repeated complete data design
## (dataset: Glucose)
## calculate individual AUCs
data(Glucose)
res &lt;- data.frame(matrix(nrow=length(unique(Glucose$id))*2, ncol=3))
colnames(res) &lt;- c('id', 'date', 'auc')
row &lt;- 1
for(i in unique(Glucose$id)){
  for(j in unique(Glucose$date)){
     temp &lt;- subset(Glucose, id==i &amp; date==j)
     res[row, c(1,2)] &lt;- c(i,j)
     res[row, 3] &lt;- auc.complete(data=temp[,c("conc","time")])$est[1,1]
     row &lt;- row + 1
  }
}
res &lt;- res[order(res$id, res$date),]
print(res)

# assuming log-normally distributed AUCs
# geometric means and corresponding two-sided CIs per date           
tapply(res$auc, res$date, gm.ci)

# comparison of AUCs using ratio of geometric means and corresponding two-sided CI 
# repeated experiment
res1&lt;-reshape(res, idvar = "id", timevar = "date", direction = "wide")
model &lt;- t.test(Pair(log(auc.1),log(auc.2))~1,data=res1)
exp(as.double(model$estimate))
exp(model$conf.int)
</code></pre>


</div>