<div class="container">

<table style="width: 100%;"><tr>
<td>print.phyDat</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>Generic functions for class phyDat</h2>

<h3>Description</h3>

<p>These functions help to manipulate alignments of class phyDat.
</p>


<h3>Usage</h3>

<pre><code class="language-R">## S3 method for class 'phyDat'
print(x, ...)

## S3 method for class 'phyDat'
subset(x, subset, select, site.pattern = TRUE, ...)

## S3 method for class 'phyDat'
x[i, j, ..., drop = FALSE]

## S3 method for class 'phyDat'
unique(x, incomparables = FALSE, identical = TRUE, ...)

removeUndeterminedSites(x, ...)

removeAmbiguousSites(x)

allSitePattern(n, levels = NULL, names = NULL, type = "DNA", code = 1)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>x</code></td>
<td>
<p>An object containing sequences.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>...</code></td>
<td>
<p>further arguments passed to or from other methods.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>subset</code></td>
<td>
<p>a subset of taxa.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>select</code></td>
<td>
<p>a subset of characters.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>site.pattern</code></td>
<td>
<p>select site pattern or sites (see details).</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>i, j</code></td>
<td>
<p>indices of the rows and/or columns to select or to drop. They
may be numeric, logical, or character (in the same way than for standard R
objects).</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>drop</code></td>
<td>
<p>for compatibility with the generic (unused).</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>incomparables</code></td>
<td>
<p>for compatibility with unique.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>identical</code></td>
<td>
<p>if TRUE (default) sequences have to be identical, if FALSE
sequences are considered duplicates if distance between sequences is zero
(happens frequently with ambiguous sites).</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>n</code></td>
<td>
<p>Number of sequences.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>levels</code></td>
<td>
<p>Level attributes.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>names</code></td>
<td>
<p>Names of sequences.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>type</code></td>
<td>
<p>Type of sequences ("DNA", "AA" or "USER").</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>code</code></td>
<td>
<p>The ncbi genetic code number for translation.
By default the standard genetic code is used.</p>
</td>
</tr>
</table>
<h3>Details</h3>

<p><code>allSitePattern</code> generates all possible site patterns and can be useful
in simulation studies. For further details see the vignette
AdvancedFeatures.
</p>
<p>The generic function <code>c</code> can be used to to combine sequences and
<code>unique</code> to get all unique sequences or unique haplotypes.
</p>
<p><code>phyDat</code> stores identical columns of an alignment only once and keeps an
index of the original positions. This saves memory and especially
computations as these are usually need to be done only once for each site
pattern.
In the example below the matrix x in the example has 8 columns, but column 1
and 2 and also 3 and 5 are identical. The <code>phyDat</code> object y has only 6
site pattern. If argument <code>site.pattern=FALSE</code> the indexing behaves like
on the original matrix x. <code>site.pattern=TRUE</code> can be useful inside
functions.
</p>


<h3>Value</h3>

<p>The functions return an object of class <code>phyDat</code>.
</p>


<h3>Author(s)</h3>

<p>Klaus Schliep <a href="mailto:klaus.schliep@gmail.com">klaus.schliep@gmail.com</a>
</p>


<h3>See Also</h3>

<p><code>DNAbin</code>, <code>as.DNAbin</code>,
<code>baseFreq</code>, <code>glance.phyDat</code>, <code>dna2codon</code>,
<code>read.dna</code>, <code>read.nexus.data</code>
and the chapter 1 in the <code>vignette("AdvancedFeatures",
package="phangorn")</code> and the example of <code>pmlMix</code> for the use of
<code>allSitePattern</code>.
</p>


<h3>Examples</h3>

<pre><code class="language-R">
data(Laurasiatherian)
class(Laurasiatherian)
Laurasiatherian
# base frequencies
baseFreq(Laurasiatherian)
# subsetting phyDat objects
# the first 5 sequences
subset(Laurasiatherian, subset=1:5)
# the first 5 characters
subset(Laurasiatherian, select=1:5, site.pattern = FALSE)
# subsetting with []
Laurasiatherian[1:5, 1:20]
# short for
subset(Laurasiatherian, subset=1:5, select=1:20, site.pattern = FALSE)
# the first 5 site patterns (often more than 5 characters)
subset(Laurasiatherian, select=1:5, site.pattern = TRUE)

x &lt;- matrix(c("a", "a", "c", "g", "c", "t", "a", "g",
              "a", "a", "c", "g", "c", "t", "a", "g",
              "a", "a", "c", "c", "c", "t", "t", "g"), nrow=3, byrow = TRUE,
            dimnames = list(c("t1", "t2", "t3"), 1:8))
(y &lt;- phyDat(x))

subset(y, 1:2)
subset(y, 1:2, compress=TRUE)

subset(y, select=1:3, site.pattern = FALSE) |&gt; as.character()
subset(y, select=1:3, site.pattern = TRUE) |&gt; as.character()
y[,1:3] # same as subset(y, select=1:3, site.pattern = FALSE)

# Compute all possible site patterns
# for nucleotides there $4 ^ (number of tips)$ patterns
allSitePattern(5)

</code></pre>


</div>