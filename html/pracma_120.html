<div class="container">

<table style="width: 100%;"><tr>
<td>fderiv</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>
Numerical Differentiation
</h2>

<h3>Description</h3>

<p>Numerical function differentiation for orders <code>n=1..4</code> using
finite difference approximations.
</p>


<h3>Usage</h3>

<pre><code class="language-R">fderiv(f, x, n = 1, h = 0,
        method = c("central", "forward", "backward"), ...)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>f</code></td>
<td>
<p>function to be differentiated.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>x</code></td>
<td>
<p>point(s) where differentiation will take place.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>n</code></td>
<td>
<p>order of derivative, should only be between 1 and 8;
for <code>n=0</code> function values will be returned.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>h</code></td>
<td>
<p>step size: if <code>h=0</code> step size will be set automatically.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>method</code></td>
<td>
<p>one of “central”, “forward”, or “backward”.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>...</code></td>
<td>
<p>more variables to be passed to function <code>f</code>.</p>
</td>
</tr>
</table>
<h3>Details</h3>

<p>Derivatives are computed applying central difference formulas that stem
from the Taylor series approximation. These formulas have a convergence
rate of <code class="reqn">O(h^2)</code>.
</p>
<p>Use the ‘forward’ (right side) or ‘backward’ (left side) method if the
function can only be computed or is only defined on one side. Otherwise,
always use the central difference formulas.
</p>
<p>Optimal step sizes depend on the accuracy the function can be computed with.
Assuming internal functions with an accuracy 2.2e-16, appropriate step
sizes might be <code>5e-6, 1e-4, 5e-4, 2.5e-3</code> for <code>n=1,...,4</code> and
precisions of about <code>10^-10, 10^-8, 5*10^-7, 5*10^-6</code> (at best).
</p>
<p>For <code>n&gt;4</code> a recursion (or finite difference) formula will be applied,
cd. the Wikipedia article on “finite difference”.
</p>


<h3>Value</h3>

<p>Vector of the same length as <code>x</code>.
</p>


<h3>Note</h3>

<p>Numerical differentiation suffers from the conflict between round-off
and truncation errors. 
</p>


<h3>References</h3>

<p>Kiusalaas, J. (2005). Numerical Methods in Engineering with Matlab.
Cambridge University Press.
</p>


<h3>See Also</h3>

<p><code>numderiv</code>, <code>taylor</code>
</p>


<h3>Examples</h3>

<pre><code class="language-R">## Not run: 
f &lt;- sin
xs &lt;- seq(-pi, pi, length.out = 100)
ys &lt;- f(xs)
y1 &lt;- fderiv(f, xs, n = 1, method = "backward")
y2 &lt;- fderiv(f, xs, n = 2, method = "backward")
y3 &lt;- fderiv(f, xs, n = 3, method = "backward")
y4 &lt;- fderiv(f, xs, n = 4, method = "backward")
plot(xs, ys, type = "l", col = "gray", lwd = 2,
     xlab = "", ylab = "", main = "Sinus and its Derivatives")
lines(xs, y1, col=1, lty=2)
lines(xs, y2, col=2, lty=3)
lines(xs, y3, col=3, lty=4)
lines(xs, y4, col=4, lty=5)
grid()
## End(Not run)
</code></pre>


</div>