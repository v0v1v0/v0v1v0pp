<div class="container">

<table style="width: 100%;"><tr>
<td>power.RSABE2L.sdsims</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>
(Empirical) Power of BE Decision via Reference Scaled ABE
</h2>

<h3>Description</h3>

<p>These function performs the power calculation of the BE decision via 
the reference scaled ABE based on <b>subject data</b> simulations.
Implemented are the methods ABEL, Hyslop and ‘exact’ as described in the 
references.<br>
The estimation method of the key statistics needed to perform the <abbr><span class="acronym">RSABE</span></abbr> decision 
is the usual <abbr><span class="acronym">ANOVA</span></abbr>.
</p>


<h3>Usage</h3>

<pre><code class="language-R">power.RSABE2L.sdsims(alpha = 0.05, theta1, theta2, theta0, CV, n, 
                     design = c("2x3x3", "2x2x4", "2x2x3"), design_dta = NULL,
                     SABE_test = "exact", regulator, nsims = 1e+05, 
                     details = FALSE, setseed = TRUE, progress)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>alpha</code></td>
<td>

<p>Type I error probability, significance level. Conventionally mostly set to 0.05.
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>theta1</code></td>
<td>

<p>Conventional lower <abbr><span class="acronym">ABE</span></abbr> (Average Bioequivalence) limit to be applied
in the mixed procedure if <code>CVsWR &lt;= CVswitch</code>. Also lower limit for the point
estimate constraint.<br>
Defaults to 0.8 if not given explicitly.
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>theta2</code></td>
<td>

<p>Conventional upper <abbr><span class="acronym">ABE</span></abbr> limit to be applied in the mixed procedure if 
<code>CVsWR &lt;= CVswitch</code>. Also upper limit for the point estimate constraint.<br>
Defaults to 1.25 if not given explicitly.
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>theta0</code></td>
<td>

<p>‘True’ or assumed T/R ratio.<br>
Defaults to 0.90 according to the two Lászlós if not given explicitly.
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>CV</code></td>
<td>

<p>Intra-subject coefficient(s) of variation as ratio (not percent).
</p>

<ul>
<li>
<p> If given as a scalar (<code>length(CV)==1</code>) the <em>same</em> CV of Test
and Reference is assumed (homoscedasticity, <code>CVwT==CVwR</code>).
</p>
</li>
<li>
<p> If given as a vector (<code>length(CV)==2</code>), <em>i.e.</em>, assuming
heteroscedasticity, the CV of the Test <strong>must</strong> be given in <code>CV[1]</code> and the one of the Reference in the <code>CV[2]</code>.
</p>
</li>
</ul>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>n</code></td>
<td>

<p>Number of subjects under study.<br>
May be given as vector. In that case it is assumed that <code>n</code> contains the number
of subjects in the sequence groups.<br>
If <code style="white-space: pre;">⁠n⁠</code> is given as single number (total sample size) and this number is not 
divisible by the number of sequences of the design an unbalanced design is 
assumed. A corresponding message is thrown (showing the numbers of subjects 
in sequence groups).<br>
Attention! In case of the <code>"2x2x3"</code> (TRT|RTR) design the order of sample sizes
per sequence is important if given as vector. <code>n[1]</code> is for sequence group
'TRT' and <code>n[2]</code> is for sequence group 'RTR'. 
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>design</code></td>
<td>

<p>Design of the study.<br><code>"2x3x3"</code> is the partial replicate design.<br><code>"2x2x4"</code> is a full replicate design with 2 sequences and 4 periods.<br><code>"2x2x3"</code> is a full replicate design with 2 sequences and 3 periods.<br>
Defaults to <code>design="2x3x3"</code>. Details are given the section about Designs.
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>design_dta</code></td>
<td>

<p>Alternatively to using the arguments <code>design</code> and <code>n</code> the design may 
be defined via a data.frame with columns <code>subject, sequence, period</code> and
<code style="white-space: pre;">⁠tmt⁠</code>. This feature is experimental in the sense that the data.frame is
not checked for complying with the assumed structure.<br>
If you use the argument <code>design_dta</code> you don’t need to specify the arguments
<code>design</code> and <code>n</code>.<br>
The default <code>design_dta=NULL</code> means that <code style="white-space: pre;">⁠design⁠</code> and <code style="white-space: pre;">⁠n⁠</code> are used
for the internal construction of the design data.frame.
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>SABE_test</code></td>
<td>

<p>This argument specifies the test method to be used for the reference scaled
<abbr><span class="acronym">ABE</span></abbr> decision.<br>
Default is the <code>"exact"</code> ‘ncTOST’ method of the two Laszlós. Other choices are <code>"ABEL"</code>, <code>"hyslop"</code> and <code>"fda"</code>. See Details.
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>regulator</code></td>
<td>

<p>Regulatory settings for the widening of the BE acceptance limits.<br>
May be given as character <code>"EMA"</code> or as an object of
class 'regSet' (see <code>reg_const</code>).<br>
Defaults to <code>regulator="EMA"</code> if missing.<br>
This argument may be given also in lower case if given as character.<br><br>
If given as object of class 'regSet' the component <code>est_method</code> can not be <code>"ISC"</code>. 
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>nsims</code></td>
<td>

<p>Number of simulations to be performed to obtain the empirical power.
Defaults to 100,000 = 1e+05.<br>
If simulations are aimed for empirical alpha <code>nsims=1e+06</code> is recommended.
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>details</code></td>
<td>

<p>If set to <code style="white-space: pre;">⁠TRUE⁠</code> the computational time is shown as well as the components
for the BE decision.<br><code style="white-space: pre;">⁠p(BE-RSABE)⁠</code> is the probability of a positive outcome of the <abbr><span class="acronym">SABE</span></abbr> test.<br><code style="white-space: pre;">⁠p(BE-PE)⁠</code> is the probability that the point estimate is within
<code style="white-space: pre;">⁠theta1⁠</code> ... <code style="white-space: pre;">⁠theta2⁠</code>.<br><code style="white-space: pre;">⁠p(BE-ABE)⁠</code> is the simulated probability for the conventional <abbr><span class="acronym">ABE</span></abbr> test.
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>setseed</code></td>
<td>

<p>Simulations are dependent on the starting point of the (pseudo) random number 
generator. To avoid differences in power for different runs a <code>set.seed()</code> 
is issued if <code>setseed=TRUE</code>, the default. 
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>progress</code></td>
<td>

<p>Should a progressbar be shown? Defaults to <code>TRUE</code> if missing and <code>nsims &gt;5e5</code>.
</p>
</td>
</tr>
</table>
<h3>Details</h3>

<p>The methods rely on the analysis of log-transformed data, <em>i.e.</em>, assumes a 
log-normal distribution on the original scale.<br><br>
The data.frame with columns <code>subject, sequence, period</code> and <code>tmt</code> 
necessary for evalution of simulated subject data is constructed internally from 
the arguments <code>design</code> and <code>n</code> or may be given user defined via the argument 
<code>design_dta</code>. The last option is usefull if missing data have to be considered
or if designs have to be evaluated which are not in the list of argument 
<code>design</code>.<br><br>
The estimation method for obtaining the statistics necessary to perform the
reference scaled ABE decision is the usual <abbr><span class="acronym">ANOVA</span></abbr> with effects treatment, period,
sequence and subject within sequence for the evaluation of all data and period,
sequence and subject within sequence for the evaluation of the Reference formulation
data only.<br><br>
The SABE tests implemented are:<br></p>

<table>
<tr>
<td style="text-align: left;">
  <code>"exact"</code> </td>
<td style="text-align: left;"> ‘exact’ based method of the two Laszlós (see references, 
  called there ‘ncTOST’)</td>
</tr>
<tr>
<td style="text-align: left;">
  <code>"ABEL"</code> </td>
<td style="text-align: left;"> Average bioequivalence with expanding limits</td>
</tr>
<tr>
<td style="text-align: left;">
  <code>"hyslop"</code> </td>
<td style="text-align: left;"> BE decision via the linearized RSABE criterion and its 
  upper 95% CI</td>
</tr>
<tr>
<td style="text-align: left;">
  <code>"fda"</code> </td>
<td style="text-align: left;"> Hyslop with an additional bias correction term as implemented 
  in the <abbr><span class="acronym">SAS</span></abbr> code of the</td>
</tr>
<tr>
<td style="text-align: left;">
  </td>
<td style="text-align: left;"> <abbr><span class="acronym">FDA</span></abbr>’s Guidance on Progesterone.
</td>
</tr>
</table>
<h3>Value</h3>

<p>Returns the value of the (empirical) power if argument <code>details=FALSE</code>.<br><br>
Returns a named vector if argument <code>details=TRUE</code>.<br><code style="white-space: pre;">⁠p(BE)⁠</code> is the power, <code style="white-space: pre;">⁠p(BE-RSABE)⁠</code> is the power of using the reference
scaled <abbr><span class="acronym">ABE</span></abbr> alone, and <code style="white-space: pre;">⁠p(BE-pe)⁠</code> is the power of the criterion
‘point estimate within acceptance range’ alone. <code style="white-space: pre;">⁠p(BE-ABE)⁠</code> is the power of
the conventional <abbr><span class="acronym">ABE</span></abbr> test given for comparative purposes.
</p>


<h3>Designs</h3>

<p>Although some designs are more ‘popular’ than others, power calculations are valid for <em>all</em> of the following designs:
</p>

<table>
<tr>
<td style="text-align: left;">
    <code>"2x2x4"</code> </td>
<td style="text-align: left;"> TRTR | RTRT</td>
</tr>
<tr>
<td style="text-align: left;">
    </td>
<td style="text-align: left;"> TRRT | RTTR</td>
</tr>
<tr>
<td style="text-align: left;">
    </td>
<td style="text-align: left;"> TTRR | RRTT</td>
</tr>
<tr>
<td style="text-align: left;">
    <code>"2x2x3"</code> </td>
<td style="text-align: left;"> TRT | RTR</td>
</tr>
<tr>
<td style="text-align: left;">
    </td>
<td style="text-align: left;"> TRR | RTT</td>
</tr>
<tr>
<td style="text-align: left;">
    <code>"2x3x3"</code> </td>
<td style="text-align: left;"> TRR | RTR | RRT
  </td>
</tr>
</table>
<h3>Note</h3>

<p>The function is relatively slow. The run-time for 1 Mio. simulations 
is between ~ 1 up to 6 minutes for n=12 or n=120 and 1 Mio. sim’s
(see the call under examples) on a machine with an Intel core i7 processor.<br>
Thus be patient and go for a cup of coffee if you use this function with higher 
sample sizes and aim for estimating the type 1 error!
</p>


<h3>Author(s)</h3>

<p>D. Labes
</p>


<h3>References</h3>

<p>Food and Drug Administration, Office of Generic Drugs (OGD). <em>Draft Guidance on Progesterone.</em> Recommended Apr 2010. Revised Feb 2011. <a href="https://www.accessdata.fda.gov/drugsatfda_docs/psg/Progesterone_caps_19781_RC02-11.pdf">download</a>
</p>
<p>Tóthfalusi L, Endrényi L. <em>An Exact Procedure for the Evaluation of Reference-Scaled Average Bioequivalence.</em> AAPS J. 2016;18(2):476–89. <a href="https://doi.org/10.1208/s12248-016-9873-6">doi:10.1208/s12248-016-9873-6</a>.
</p>
<p>Tóthfalusi L, Endrényi L. <em>Algorithms for evaluating reference scaled average bioequivalence: power, bias, and consumer risk.</em> Stat Med. 2017;36(27):4378–4390. <a href="https://doi.org/10.1002/sim.7440">doi:10.1002/sim.7440</a>
</p>


<h3>See Also</h3>

<p><code>power.RSABE, reg_const</code>
</p>


<h3>Examples</h3>

<pre><code class="language-R"># Not run due to timing policy of CRAN

# pure EMA settings without mixed procedure, cap on widening and PE constraint
# as in the reference from 2017
reg           &lt;- reg_const("EMA")
reg$CVswitch  &lt;- 0
reg$CVcap     &lt;- Inf
reg$pe_constr &lt;- FALSE
reg$name      &lt;- "EMA pure"
power.RSABE2L.sds(CV = 0.4, n = 12, theta0 = exp(0.05),
                  design = "2x2x4", regulator = reg, nsims = 50000)
# should give:
# [1] 0.46504 (compared to 47.1% in the 2017 reference)
</code></pre>


</div>