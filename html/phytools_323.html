<div class="container">

<table style="width: 100%;"><tr>
<td>sim.history</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>Simulate character history or a discrete character at the tips of the tree under some model</h2>

<h3>Description</h3>

<p>Simulates discrete character evolution on a phylogenetic tree.
</p>


<h3>Usage</h3>

<pre><code class="language-R">sim.history(tree, Q, anc=NULL, nsim=1, 
    direction=c("column_to_row","row_to_column"), ...)
sim.Mk(tree, Q, anc=NULL, nsim=1, ...)
sim.multiMk(tree, Q, anc=NULL, nsim=1, ...)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>tree</code></td>
<td>
<p>a phylogenetic tree as an object of class <code>"phylo"</code>. For the case of <code>sim.multiMk</code> <code>tree</code> should be an object of class <code>"simmap"</code> in which the regimes for simulation have been mapped onto the tree.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>Q</code></td>
<td>
<p>a matrix containing the instantaneous transition rates between states. Note that for <code>sim.history</code> <em>by default</em> (i.e., when <code>direction="column_to_row"</code>, see below) normally this is the <em>transpose</em> of the matrix produced by <code>fitDiscrete</code> in the <span class="pkg">geiger</span> package or <code>make.simmap</code> in <span class="pkg">phytools</span>; that is to say the transition rate from <code>i -&gt; j</code> should be given by <code>Q[j,i]</code>. However, if your matrix is properly conformed (i.e., rows <em>or</em> columns sum to 0), then <code>sim.history</code> will attempt to transpose your matrix correctly &amp; will return an informative message (if <code>message=TRUE</code>, see below). For <code>sim.Mk</code> and <code>sim.multiMk</code> this matrix has the same conformation as in <code>fitContinuous</code> and <code>make.simmap</code>. For <code>sim.multiMk</code> <code>Q</code> should be a list of transition matrices with names that correspond to the states mapped onto the tree.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>anc</code></td>
<td>
<p>an optional value for the state at the root node; if <code>NULL</code>, a random state will be assigned. <code>anc</code> can be a vector of states, in which one of the states will be chosen randomly for each simulation. For <code>sim.history</code> <code>anc</code> can be a vector of probabilities with names, in which case a state will be chosen in proportion to the given probabilities.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>nsim</code></td>
<td>
<p>number of simulations.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>direction</code></td>
<td>
<p>row/column direction of the input transition matrix, <code>Q</code>. <code>"column_to_row"</code> indicates that the transition rate from <code>i -&gt; j</code> should be given by <code>Q[j,i]</code>, while <code>"row_to_column"</code> indicates the converse.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>...</code></td>
<td>
<p>other optional arguments. Currently only <code>internal</code>, a logical value indicating whether or not to return internal node states (defaults to <code>internal=FALSE</code>; and <code>message</code>, a logical indicating whether or not to turn on informational messages (defaults to <code>message=TRUE</code>).</p>
</td>
</tr>
</table>
<h3>Details</h3>

<p>The function <code>sim.history</code> simulates a stochastic character history for a discretely valued character trait on the tree. The resultant tree is stored as a modified <code>"phylo"</code> object in stochastic character map (e.g., <code>make.simmap</code>) format.
</p>
<p>The function <code>sim.Mk</code> simulates the states for a discrete character at the tips of the tree only.
</p>
<p>Finally, the function <code>sim.multiMk</code> is the same as <code>sim.Mk</code> except that it permits the user to simulate under different values of <code>Q</code> in different parts of the tree.
</p>


<h3>Value</h3>

<p><code>sim.history</code> returns an object of class <code>"simmap"</code> (a tree with a mapped discrete character) or <code>"multiSimmap"</code> for <code>nsim</code> greater than one.
</p>
<p><code>sim.Mk</code> and <code>sim.multiMk</code> return a factor with the states of our discrete character at the tips of the tree only.
</p>


<h3>Author(s)</h3>

<p>Liam Revell <a href="mailto:liam.revell@umb.edu">liam.revell@umb.edu</a></p>


<h3>References</h3>

<p>Revell, L. J. (2024) phytools 2.0: an updated R ecosystem for phylogenetic comparative methods (and other things). <em>PeerJ</em>, <b>12</b>, e16505.
</p>


<h3>See Also</h3>

<p><code>fitMk</code>, <code>fitmultiMk</code>, <code>make.simmap</code>, <code>read.simmap</code>, <code>plotSimmap</code>, <code>sim.rates</code>
</p>


</div>