<div class="container">

<table style="width: 100%;"><tr>
<td>pcalg1</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>
Periodic Levinson-Durbin algorithm
</h2>

<h3>Description</h3>

<p>Calculate partial periodic autocorrelations, forward and backward
prediction coefficients and error variances using the periodic
Levinson-Durbin algorithm.
</p>


<h3>Usage</h3>

<pre><code class="language-R">alg1(r, p)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>r</code></td>
<td>
<p>periodic autocovariances, a matrix, see ‘Details’.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>p</code></td>
<td>
<p>autoregressive orders, numeric vector.</p>
</td>
</tr>
</table>
<h3>Details</h3>

<p><code>alg1(r,p)</code> calculates the partial periodic correlations from
autocovariances <code>r</code> and autoregression orders <code>p</code>. The
matrix <code>r</code> has the same format as that of the <code>r</code> slot of
<code>pcAcvf</code> objects.  The periodicity, <code>d</code>, is set equal to
the number of rows in <code>r</code>. If the length of <code>p</code> is not
equal to the periodicity, all autoregressive orders are set to the
first element of <code>p</code>. This last feature is really meant to be
used only with a scalar <code>p</code>.
</p>
<p>The convention for the signs of the coefficients is the one from
Boshnakov(1996) and is consistent with other <span style="font-family: Courier New, Courier; color: #666666;"><b>R</b></span> time series
functions.
</p>
<p><code>pmax</code> below stands for the maximal element of <code>p</code>,
i.e. the maximal AR order.
</p>
<p>As in the non-periodic case, the periodic Levinson-Durbin algorithm
fits recursively models of order 0, 1, ..., <code>pmax</code>. Namely,  at
step <code>i</code> the AR orders for all seasons are set to
<code>i</code>. This is done in a way that correctly handles the case when
not all elements of <code>p</code> are equal, see the references.
</p>
<p>The essential quantities calculated by the periodic Levinson-Durbin
algorithm are returned as matrices, whose <code class="reqn">i</code>th rows
contain values for season <code class="reqn">i</code>. The complete details depend on
the quantities, as described below.
</p>
<p>The partial autocorrelations, the forward innovation variances and
the backward innovation variances are returned as matrices with
<code>d</code> rows and <code>1+pmax</code> columns, whose j-th columns contain
the quantities for order j-1 (partial autocorrelations, forward
innovation variances and backward innovation variances, respectively).
Note that the lag-0 partial autocorrelations are the autocovariances
for lag 0, see the references for details.
</p>
<p>The forward autoregression parameters are returned as a list whose
<code class="reqn">j</code>th element is a matrix containing the coefficients for
order <code class="reqn">j</code>. Similarly for the backward autoregression parameters.
</p>
<p>One often is interested in the model of order <code>p</code> only. Its
coefficients are given by <code>af[[pmax]]</code>, while the innovation
variances are in the last column of <code>fv</code>.
</p>


<h3>Value</h3>

<p>A list with the following elements.
</p>
<table>
<tr style="vertical-align: top;">
<td><code>orders </code></td>
<td>
<p>autoregression orders</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code> be </code></td>
<td>
<p>partial autocorrelations, a matrix with d rows</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code> fv </code></td>
<td>
<p>forward innovation variances, a matrix with d rows</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code> bv </code></td>
<td>
<p>backward innovation variances, a matrix with d rows</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code> af </code></td>
<td>
<p>forward  autoregression parameters, a list with one
element for the parameters for each order. </p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code> ab </code></td>
<td>
<p>backward autoregression parameters, a list with one
element for the parameters for each order.</p>
</td>
</tr>
</table>
<h3>Note</h3>

<p>The autoregression orders of the output are not necessarilly the same
as those specified in the call. There may be no PAR model with the
requested orders, see the references.
</p>


<h3>Author(s)</h3>

<p>Georgi N. Boshnakov</p>


<h3>References</h3>

<p>Boshnakov GN (1996).
“Recursive computation of the parameters of periodic autoregressive moving-average processes.”
<em>J. Time Ser. Anal.</em>, <b>17</b>(4), 333–349.
ISSN 0143-9782, <a href="https://doi.org/10.1111/j.1467-9892.1996.tb00281.x">doi:10.1111/j.1467-9892.1996.tb00281.x</a>.
</p>
<p>Lambert-Lacroix S (2000).
“On periodic autoregressive process estimation .”
<em> IEEE Transactions on Signal Processing</em>, <b>48</b>( 6 ), 1800-1803.
</p>
<p>Lambert-Lacroix S (2005).
“ Extension of autocovariance coefficients sequence for periodically correlated processes.”
<em>Journal of Time Series Analysis</em>, <b>26</b>(3), 423-435.
</p>


<h3>See Also</h3>

 <p><code>pdSafeParOrder</code> </p>


<h3>Examples</h3>

<pre><code class="language-R">r1 &lt;- rbind(c(1,0.81,0.729),c(1,0.90,0.900))
alg1(r1,2)

## pc2 &lt;- pcAcvf(init=r1)
## pc2a &lt;- pcAcvf(init=r1,seasonnames=c("am","pm"), periodunit="day")

# example of Lambert-Lacroix
data(ex1f)
pc3 &lt;- slMatrix(period=2,maxlag=5,f=ex1f,type="tt")
res0p2 &lt;- alg1(pc3[],c(0,2))
res1p2 &lt;- alg1(pc3[],c(1,2))
res3p3 &lt;- alg1(pc3[],c(3,3))

paramsys1 &lt;- pcarma_param_system(pc3, NULL, NULL, 2, 0, 2)
t1 &lt;- solve(paramsys1$A,paramsys1$b)

# this is from tests.r but I have lost t1
# set it to pc3 below
# note: t1 is not the t1 computed above and in other examples!

t1 &lt;- pc3
t1
t1[]
alg1(t1[],c(1,1))
alg1(t1[],c(1,0))
alg1(t1[],c(0,1))
alg1(t1[],c(5,5))
alg1(t1[],c(2,2))
alg1(t1[],c(2,3))
alg1(t1[],c(3,3))
alg1(t1[],c(4,4))
alg1(t1[],c(5,5))
</code></pre>


</div>