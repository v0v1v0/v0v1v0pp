<div class="container">

<table style="width: 100%;"><tr>
<td>PTAk</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>Principal Tensor Analysis on k modes</h2>

<h3>Description</h3>

<p>Performs a truncated SVD-<em>k</em>modes analysis with or without
specific metrics, penalised or not. </p>


<h3>Usage</h3>

<pre><code class="language-R"> PTAk(X,nbPT=2,nbPT2=1,minpct=0.1,
                smoothing=FALSE,
                   smoo=list(NA),
                    verbose=getOption("verbose"),file=NULL,
                     modesnam=NULL,addedcomment="", ...)</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>X</code></td>
<td>

<p>a tensor (as an array) of order <em>k</em>, if non-identity metrics are
used <code>X</code> is a list with <code>data</code>  as the array and
<code>met</code> a list of metrics</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>nbPT</code></td>
<td>

<p>integer vector of length <em>(k-2)</em>  specifying the  maximum number
of Principal Tensors requested for the <em>(3,...,k-1, k)</em> modes
levels (see details), if it is not a vector every levels would have
the same given nbPT value </p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>nbPT2</code></td>
<td>
<p>if 0 no 2-modes solutions
will be computed, 1 =all, &gt;1 otherwise</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>minpct</code></td>
<td>

<p>numerical 0-100 to control of computation of future solutions at this
level and below</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>smoothing</code></td>
<td>
<p>see <code>PTA3</code>, <code>SVDgen</code></p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>smoo</code></td>
<td>
<p>see <code>PTA3</code></p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>verbose</code></td>
<td>
<p>control printing</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>file</code></td>
<td>
<p>output printed at the prompt if <code>NULL</code>, or printed in the given  ‘<span class="file">file</span>’</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>modesnam</code></td>
<td>
<p>character vector of the names of the modes, if <code>NULL</code> <code>mo 1</code> ...<code>mo k</code></p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>addedcomment</code></td>
<td>
<p>character string printed if <code>printt</code> after the title of the analysis</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>...</code></td>
<td>
<p>any other arguments passed to other functions</p>
</td>
</tr>
</table>
<h3>Details</h3>

<p>According to the decomposition described in Leibovici(1993) and
Leibovici and Sabatier(1998) the function gives a generalisation of
the SVD (2 modes) to <em>k</em> modes. The algorithm is recursive,
calling <code>APSOLUk</code> which calls <code>PTAk</code> for <em>(k-1)</em>.
<code>nbPT</code>, <code>nbPT2</code> and <code>minpct</code> control the number of
Principal Tensors desired. For example <code>nbPT=c(2,4,3)</code> means a
tensor of order <em>5</em> is analysed, the maximum number of 5-modes
PT is set to <em>3</em>, for <em>each of them</em> one sets a maximum of
<em>4</em> associated <em>4-modes</em> (for each of the five components),
for <em>each of these later</em> a maximum of <em>2</em> associated
<em>3-modes</em> PT is asked (for each of the four components). Then
<code>nbPT2</code> complete for <em>2-modes</em> associated or not. Overall
<code>minpct</code> controls to carry on the algorithm at any level and
lower, <em>i.e.</em> stops if <code class="reqn">100(vs^2/ssx)&lt;minpct</code> (where
<code class="reqn">vs</code> is the singular value, and <em>ssx</em> is the total sum of
squares of the tensor <code class="reqn">X</code> or the "metric transformed" <code class="reqn">X</code>).
Putting a <code class="reqn">0</code> at a given level in <code>nbPT</code> obviously
automatically puts <code class="reqn">0</code>  in <code>nbPT</code> at lower levels. Putting
high values in <code>nbPT</code> allows control only on <code>minpct</code>
helping to reach the full decomposition. All these controls allow to
truncate the full decomposition in a level-controlled fashion. Notice
the full decomposition always contains any possible choice of
truncation, <em>i.e.</em> the solutions are not dependant on the
truncation scheme (Generalised Eckart-Young Theorem).
<br>
Recent work from Tamara G Kolda showed on an example that <em>orthogonal rank</em>
decompositions are not necesseraly nested. This makes PTA-<em>k</em>modes a model with
nested decompositions not giving the exact <em>orthogonal rank</em>.
So PTA-<em>k</em>modes will look for best approximation according to orthogonal tensors in a nested approximmation process.</p>


<h3>Value</h3>

<p>a <code>PTAk</code> object which consist of a list of lists. Each mode has a list in which is listed:
</p>
<table>
<tr style="vertical-align: top;">
<td><code>$v</code></td>
<td>
<p>matrix of components for the given mode</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>$iter</code></td>
<td>
<p>vector of iterations numbers where maximum was reach</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>$test</code></td>
<td>
<p>vector of test values at maximum</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>$modesnam</code></td>
<td>
<p>name of the mode</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>$v</code></td>
<td>
<p>matrix of components for the given mode</p>
</td>
</tr>
</table>
<p>The last mode list has also some additional information on the analysis done:
</p>
<table>
<tr style="vertical-align: top;">
<td><code>$d</code></td>
<td>
<p>vector of singular values</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>$pct</code></td>
<td>
<p>percentage of sum of squares for each quared singular value</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>$ssX</code></td>
<td>
<p>vector of local sum of squares <em>i.e.</em> of the current tensor with the rescursive algorithm</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>$vsnam</code></td>
<td>
<p>vector of names given to the singular value according to a recursive data dependent scheme</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>$datanam</code></td>
<td>
<p>data reference</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>$method</code></td>
<td>
<p>call applied: could be PTAk or CANDPARA or PCAn or even SVDgen, with parameters choices</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>$addedcomment</code></td>
<td>
<p> the addedcomment (repeated) given in the call</p>
</td>
</tr>
</table>
<p>You will notice that methods other than PTAk may not have all list elements but the essential ones such as: $v, $d, $ssX, and may also have additional ones like $coremat for PCAn (the core array).
</p>


<h3>Note</h3>

<p>The use of metrics (diagonal or not) allows flexibility of analysis like in <em>2</em> modes
<em>e.g.</em> correspondence analysis, discriminant analysis, robust analysis.  Smoothing option
extending the analysis towards functional data analysis is theoretically
valid for Principal Tensors  belonging to a tensor product of separable
Hilbert spaces (<em>e.g.</em> Sobolev spaces) see Leibovici and El Maach (1997).</p>


<h3>Author(s)</h3>

<p>Didier G. Leibovici</p>


<h3>References</h3>

<p>Leibovici D(1993) <em>Facteurs &lt;e0&gt; Mesures R&lt;e9&gt;p&lt;e9&gt;t&lt;e9&gt;es et Analyses Factorielles :
applications &lt;e0&gt; un suivi &lt;e9&gt;pid&lt;e9&gt;miologique</em>. Universit&lt;e9&gt; de Montpellier
II. PhD Thesis in Math&lt;e9&gt;matiques et Applications (Biostatistiques).
</p>
<p>Leibovici D and El Maache H (1997) <em>Une d&lt;e9&gt;composition en Valeurs Singuli&lt;e8&gt;res d'un &lt;e9&gt;l&lt;e9&gt;ment
d'un produit Tensoriel de k espaces de Hilbert S&lt;e9&gt;parables</em>. Compte Rendus de l'Acad&lt;e9&gt;mie des
Sciences tome 325, s&lt;e9&gt;rie I, Statistiques (Statistics) &amp; Probabilit&lt;e9&gt;s (Probability Theory):
779-782.
</p>
<p>Leibovici D and Sabatier R (1998) <em>A Singular Value Decomposition of a k-ways array for a
Principal Component Analysis of multi-way data, the PTA-k</em>. Linear Algebra and its Applications,
269:307-329.
Kolda T.G (2003)<em> A Counterexample to the Possibility of an Extension of the Eckart-Young Low-Rank Approximation Theorem for the Orthogonal Rank Tensor Decomposition</em>. SIAM J. Matrix Analysis, 24(2):763-767, Jan. 2003.
</p>
<p>Leibovici  D (2008) <em>A Simple Penalised algorithm for SVD and Multiway
functional  methods</em>. (to be submitted in the futur)
</p>
<p>Leibovici DG (2010) <em>Spatio-temporal Multiway Decomposition using Principal Tensor Analysis on k-modes:the R package <span class="pkg">PTAk</span></em>. Journal of Statistical Software, 34(10), 1-34. <a href="https://doi.org/10.18637/jss.v034.i10">doi:10.18637/jss.v034.i10</a>
</p>


<h3>See Also</h3>

<p><code>REBUILD</code>, <code>FCAk</code>, <code>PTA3</code> <code>summary.PTAk</code>
</p>


<h3>Examples</h3>

<pre><code class="language-R">
  # don &lt;- array((1:3)%x%rnorm(6*4)%x%(1:10),c(10,4,6,3))

don &lt;- array(1:360,c(5,4,6,3))
 don &lt;- don + rnorm(360,1,2)

 dimnames(don) &lt;- list(paste("s",1:5,sep=""),paste("T",1:4,sep=""),
          paste("t",1:6,sep=""),c("young","normal","old"))
   # hypothetic data on learning curve at different age and period of year

 ones &lt;-list(list(v=rep(1,5)),list(v=rep(1,4)),list(v=rep(1,6)),list(v=rep(1,3)))

 don &lt;- PROJOT(don,ones)
 don.sol &lt;- PTAk(don,nbPT=1,nbPT2=2,minpct=0.01,
               verbose=TRUE,
                modesnam=c("Subjects","Trimester","Time","Age"),
                 addedcomment="centered on each mode")

don.sol[[1]] # mode Subjects results and components
don.sol[[2]] # mode Trimester results and components
don.sol[[3]] # mode Time results and components
don.sol[[4]] # mode Age results and  components with additional information on the call

 summary(don.sol,testvar=2)
  plot(don.sol,mod=c(1,2,3,4),nb1=1,nb2=NULL,
     xlab="Subjects/Trimester/Time/Age",main="Best rank-one approx" )
  plot(don.sol,mod=c(1,2,3,4),nb1=4,nb2=NULL,
      xlab="Subjects/Trimester/Time/Age",main="Associated to Subject vs1111")

#  demo function
 # demo.PTAk()

  </code></pre>


</div>