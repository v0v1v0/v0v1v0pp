<div class="container">

<table style="width: 100%;"><tr>
<td>theta.tree</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>
Population Parameter THETA Using Genealogy
</h2>

<h3>Description</h3>

<p>These functions estimate the population parameter <code class="reqn">\Theta</code>
from a genealogy (coded a as phylogenetic tree) under the coalescent.
</p>


<h3>Usage</h3>

<pre><code class="language-R">theta.tree(phy, theta, fixed = FALSE, analytical = TRUE, log = TRUE)
theta.tree.hetero(phy, theta, fixed = FALSE, log = TRUE)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>phy</code></td>
<td>
<p>an object of class <code>"phylo"</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>theta</code></td>
<td>
<p>a numeric vector.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>fixed</code></td>
<td>
<p>a logical specifying whether to estimate <code>theta</code>
(the default), or to return the likelihoods for all values in
<code>theta</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>analytical</code></td>
<td>
<p>a logical specifying whether to use analytical
formulae to estimate <code>theta</code> and its standard-error. If
<code>FALSE</code>, a numerical optimisation of the likelihood is
performed (this option is ignored if <code>fixed = TRUE</code>)</p>
</td>
</tr>
</table>
<p>.
</p>
<table><tr style="vertical-align: top;">
<td><code>log</code></td>
<td>
<p>a logical specifying whether to return the likelihoods on a
log scale (the default); ignored if <code>fixed = FALSE</code>.</p>
</td>
</tr></table>
<h3>Details</h3>

<p>With <code>theta.tree</code>, the tree <code>phy</code> is considered as a
genealogy with contemporaneous samples, and therefore should be
ultrametric. With <code>theta.tree.hetero</code>, the samples may be
heterochronous so <code>phy</code> can be non-ultrametric. If <code>phy</code> is
ultrametric, both functions return the same results.
</p>
<p>By default, <code class="reqn">\theta</code> is estimated by maximum likelihood and
the value given in <code>theta</code> is used as starting value for the
minimisation function (if several values are given as a vector the
first one is used). If <code>fixed = TRUE</code>, then the [log-]likelihood
values are returned corresponding to each value in <code>theta</code>.
</p>
<p>The present implementation does a numerical optimisation of the
log-likelihood function (with <code>nlminb</code>) with the
first partial derivative as gradient. It is possible to solve the
latter and have a direct analytical MLE of <code class="reqn">\theta</code> (and
its standard-error), but this does not seem to be faster.
</p>


<h3>Value</h3>

<p>If <code>fixed = FALSE</code>, a list with two elements:
</p>
<table>
<tr style="vertical-align: top;">
<td><code>theta</code></td>
<td>
<p>the maximum likelihood estimate of <code class="reqn">\Theta</code>;</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>logLik</code></td>
<td>
<p>the log-likelihood at its maximum.</p>
</td>
</tr>
</table>
<p>If <code>fixed = TRUE</code>, a numeric vector with the [log-]likelihood
values.
</p>


<h3>Author(s)</h3>

<p>Emmanuel Paradis</p>


<h3>References</h3>

<p>Kingman, J. F. C. (1982) The coalescent. <em>Stochastic Processes
and their Applications</em>, <b>13</b>, 235–248.
</p>
<p>Kingman, J. F. C. (1982) On the genealogy of large
populations. <em>Journal of Applied Probability</em>, <b>19A</b>,
27–43.
</p>
<p>Wakeley, J. (2009) <em>Coalescent Theory: An Introduction.</em>
Greenwood Village, CO: Roberts and Company Publishers.
</p>


<h3>See Also</h3>

<p><code>theta.h</code>, <code>theta.s</code>, <code>theta.k</code>
</p>


<h3>Examples</h3>

<pre><code class="language-R">tr &lt;- rcoal(50)
(o &lt;- theta.tree(tr))
theta.tree(tr, 10, analytical = FALSE) # uses nlminb()
## profile log-likelihood:
THETA &lt;- seq(0.5, 2, 0.01)
logLikelihood &lt;- theta.tree(tr, THETA, fixed = TRUE)
plot(THETA, logLikelihood, type = "l")
xx &lt;- seq(o$theta - 1.96 * o$se, o$theta + 1.96 * o$se, 0.01)
yy &lt;- theta.tree(tr, xx, fixed = TRUE)
polygon(c(xx, rev(xx)), c(yy, rep(0, length(xx))),
        border = NA, col = "lightblue")
segments(o$theta, 0, o$theta, o$logLik, col = "blue")
abline(v = 1, lty = 3)
legend("topright", legend = expression("log-likelihood",
       "True " * theta, hat(theta) * " (MLE)", "95%\ conf. interv."),
       lty = c(1, 3, 1, 1), lwd = c(1, 1, 1, 15),
       col = c("black", "black", "blue", "lightblue"))
</code></pre>


</div>