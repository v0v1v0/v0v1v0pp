<div class="container">

<table style="width: 100%;"><tr>
<td>AutoD2</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2> AutoD2, CrossD2 or CenterD2 analysis of a multiple time-series </h2>

<h3>Description</h3>

<p>Compute and plot multiple autocorrelation using Mahalanobis generalized distance D2. AutoD2 uses the same multiple time-series. CrossD2 compares two sets of multiple time-series having same size (same number of descriptors). CenterD2 compares subsamples issued from a single multivariate time-series, aiming to detect discontinuities.
</p>


<h3>Usage</h3>

<pre><code class="language-R">AutoD2(series, lags=c(1, nrow(series)/3), step=1, plotit=TRUE,
        add=FALSE, ...)
CrossD2(series, series2, lags=c(1, nrow(series)/3), step=1,
        plotit=TRUE, add=FALSE, ...)
CenterD2(series, window=nrow(series)/5, plotit=TRUE, add=FALSE,
        type="l", level=0.05, lhorz=TRUE, lcol=2, llty=2, ...)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>series</code></td>
<td>
<p> regularized multiple time-series </p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>series2</code></td>
<td>
<p> a second set of regularized multiple time-series </p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>lags</code></td>
<td>
<p> minimal and maximal lag to use. By default, 1 and a third of the number of observations in the series respectively </p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>step</code></td>
<td>
<p> step between successive lags. By default, 1 </p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>window</code></td>
<td>
<p> the window to use for CenterD2. By default, a fifth of the total number of observations in the series </p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>plotit</code></td>
<td>
<p> if <code>TRUE</code> then also plot the graph </p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>add</code></td>
<td>
<p> if <code>TRUE</code> then the graph is added to the current figure </p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>type</code></td>
<td>
<p> The type of line to draw in the CenterD2 graph. By default, a line without points </p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>level</code></td>
<td>
<p> The significance level to consider in the CenterD2 analysis. By default 5% </p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>lhorz</code></td>
<td>
<p> Do we have to plot also the horizontal line representing the significance level on the graph? </p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>lcol</code></td>
<td>
<p> The color of the significance level line. By default, color 2 is used </p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>llty</code></td>
<td>
<p> The style for the significance level line. By default: <code>llty=2</code>, a dashed line is drawn</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>...</code></td>
<td>
<p> additional graph parameters </p>
</td>
</tr>
</table>
<h3>Value</h3>

<p>An object of class 'D2' which contains:
</p>
<table>
<tr style="vertical-align: top;">
<td><code>lag </code></td>
<td>
<p>The vector of lags</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>D2 </code></td>
<td>
<p>The D2 value for this lag</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>call </code></td>
<td>
<p>The command invoked when this function was called</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>data </code></td>
<td>
<p>The series used</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>type </code></td>
<td>
<p>The type of 'D2' analysis: 'AutoD2', 'CrossD2' or 'CenterD2'</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>window </code></td>
<td>
<p>The size of the window used in the CenterD2 analysis</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>level </code></td>
<td>
<p>The significance level for CenterD2</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>chisq </code></td>
<td>
<p>The chi-square value corresponding to the significance level in the CenterD2 analysis</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>units.text </code></td>
<td>
<p>Time units of the series, nicely formatted for graphs</p>
</td>
</tr>
</table>
<h3>WARNING </h3>

<p>If data are too heterogeneous, results could be biased (a singularity matrix appears in the calculations).</p>


<h3>Author(s)</h3>

<p> Frédéric Ibanez (<a href="mailto:ibanez@obs-vlfr.fr">ibanez@obs-vlfr.fr</a>), Philippe Grosjean (<a href="mailto:phgrosjean@sciviews.org">phgrosjean@sciviews.org</a>) </p>


<h3>References</h3>

<p>Cooley, W.W. &amp; P.R. Lohnes, 1962. <em>Multivariate procedures for the behavioural sciences.</em> Whiley &amp; sons.
</p>
<p>Dagnélie, P., 1975. <em>Analyse statistique à plusieurs variables.</em> Presses Agronomiques de Gembloux.
</p>
<p>Ibanez, F., 1975. <em>Contribution à l'analyse mathématique des évènements en écologie planctonique: optimisations méthodologiques; étude expérimentale en continu à petite échelle du plancton côtier.</em> Thèse d'état, Paris VI.
</p>
<p>Ibanez, F., 1976. <em>Contribution à l'analyse mathématique des évènements en écologie planctonique. Optimisations méthodologiques.</em> Bull. Inst. Océanogr. Monaco, 72:1-96.
</p>
<p>Ibanez, F., 1981. <em>Immediate detection of heterogeneities in continuous multivariate oceanographic recordings. Application to time series analysis of changes in the bay of Villefranche sur mer.</em> Limnol. Oceanogr., 26:336-349.
</p>
<p>Ibanez, F., 1991. <em>Treatment of the data deriving from the COST 647 project on coastal benthic ecology: The within-site analysis.</em> In: B. Keegan (ed), <em>Space and time series data analysis in coastal benthic ecology</em>, p 5-43.
</p>


<h3>See Also</h3>

 <p><code>acf</code> </p>


<h3>Examples</h3>

<pre><code class="language-R">data(marphy)
marphy.ts &lt;- as.ts(as.matrix(marphy[, 1:3]))
AutoD2(marphy.ts)
marphy.ts2 &lt;- as.ts(as.matrix(marphy[, c(1, 4, 3)]))
CrossD2(marphy.ts, marphy.ts2)
# This is not identical to:
CrossD2(marphy.ts2, marphy.ts)
marphy.d2 &lt;- CenterD2(marphy.ts, window=16)
lines(c(17, 17), c(-1, 15), col=4, lty=2)
lines(c(25, 25), c(-1, 15), col=4, lty=2)
lines(c(30, 30), c(-1, 15), col=4, lty=2)
lines(c(41, 41), c(-1, 15), col=4, lty=2)
lines(c(46, 46), c(-1, 15), col=4, lty=2)
text(c(8.5, 21, 27.5, 35, 43.5, 57), 11, labels=c("Peripheral Zone", "D1",
        "C", "Front", "D2", "Central Zone")) # Labels
time(marphy.ts)[marphy.d2$D2 &gt; marphy.d2$chisq]
</code></pre>


</div>