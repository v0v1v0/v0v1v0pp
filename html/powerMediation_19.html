<div class="container">

<table style="width: 100%;"><tr>
<td>powerPoisson</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>
Power calculation for simple Poisson regression
</h2>

<h3>Description</h3>

<p>Power calculation for simple Poisson regression.
Assume the predictor is normally distributed.
</p>


<h3>Usage</h3>

<pre><code class="language-R">powerPoisson(
    beta0, 
    beta1, 
    mu.x1, 
    sigma2.x1, 
    mu.T = 1, 
    phi = 1, 
    alpha = 0.05, 
    N = 50)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>beta0</code></td>
<td>

<p>intercept
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>beta1</code></td>
<td>

<p>slope
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>mu.x1</code></td>
<td>

<p>mean of the predictor
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>sigma2.x1</code></td>
<td>

<p>variance of the predictor
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>mu.T</code></td>
<td>

<p>mean exposure time
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>phi</code></td>
<td>

<p>a measure of over-dispersion
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>alpha</code></td>
<td>

<p>type I error rate
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>N</code></td>
<td>

<p>toal sample size
</p>
</td>
</tr>
</table>
<h3>Details</h3>

<p>The simple Poisson regression has the following form:
</p>
<p style="text-align: center;"><code class="reqn">
Pr(Y_i = y_i | \mu_i, t_i) = \exp(-\mu_i t_i) (\mu_i t_i)^{y_i}/ (y_i!)
</code>
</p>

<p>where
</p>
<p style="text-align: center;"><code class="reqn"> 
\mu_i=\exp(\beta_0+\beta_1 x_{1i})
</code>
</p>

<p>We are interested in testing the null hypothesis <code class="reqn">\beta_1=0</code>
versus the alternative hypothesis <code class="reqn">\beta_1 = \theta_1</code>.
Assume <code class="reqn">x_{1}</code>  is normally distributed with mean
<code class="reqn">\mu_{x_1}</code> and variance <code class="reqn">\sigma^2_{x_1}</code>.
The sample size calculation formula derived by Signorini (1991) is
</p>
<p style="text-align: center;"><code class="reqn">
N=\phi\frac{\left[z_{1-\alpha/2}\sqrt{V\left(b_1 | \beta_1=0\right)}
+z_{power}\sqrt{V\left(b_1 | \beta_1=\theta_1\right)}\right]^2}
{\mu_T \exp(\beta_0) \theta_1^2}
</code>
</p>

<p>where <code class="reqn">\phi</code> is the over-dispersion parameter 
(<code class="reqn">=var(y_i)/mean(y_i)</code>), 
<code class="reqn">\alpha</code> is the type I error rate, 
<code class="reqn">b_1</code> is the estimate of the slope <code class="reqn">\beta_1</code>,
<code class="reqn">\beta_0</code> is the intercept,
<code class="reqn">\mu_T</code> is the mean exposure time, 
<code class="reqn">z_{a}</code> is the <code class="reqn">100*a</code>-th lower percentile of 
the standard normal distribution, and 
<code class="reqn">V\left(b_1|\beta_1=\theta\right)</code>
is the variance of the estimate <code class="reqn">b_1</code> given the true slope
<code class="reqn">\beta_1=\theta</code>. 
</p>
<p>The variances are
</p>
<p style="text-align: center;"><code class="reqn">
V\left(b_1 | \beta_1 = 0\right)=\frac{1}{\sigma^2_{x_1}}
</code>
</p>

<p>and
</p>
<p style="text-align: center;"><code class="reqn">
V\left(b_1 | \beta_1 = \theta_1\right)=\frac{1}{\sigma^2_{x_1}}
\exp\left[-\left(\theta_1 \mu_{x_1} + \theta_1^2\sigma^2_{x_1}/2\right)\right]
</code>
</p>



<h3>Value</h3>

<p>power
</p>


<h3>Note</h3>

<p>The test is a two-sided test. For one-sided tests, please double the 
significance level. For example, you can set <code>alpha=0.10</code>
to obtain one-sided test at 5% significance level.
</p>


<h3>Author(s)</h3>

<p>Weiliang Qiu &lt;stwxq@channing.harvard.edu&gt;
</p>


<h3>References</h3>

<p>Signorini D.F. (1991). 
Sample size for Poisson regression. 
Biometrika. Vol.78. no.2, pp. 446-50
</p>


<h3>See Also</h3>

<p>See Also as <code>sizePoisson</code>
</p>


<h3>Examples</h3>

<pre><code class="language-R"># power = 0.8090542
print(powerPoisson(
    beta0 = 0.1, 
    beta1 = 0.5, 
    mu.x1 = 0, 
    sigma2.x1 = 1, 
    mu.T = 1, 
    phi = 1, 
    alpha = 0.05, 
    N = 28))


</code></pre>


</div>