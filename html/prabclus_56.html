<div class="container">

<table style="width: 100%;"><tr>
<td>regeqdist</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>Testing equality of two distance-regressions</h2>

<h3>Description</h3>

<p>Jackknife-based test for equality of two regressions between
distance matrices.
</p>


<h3>Usage</h3>

<pre><code class="language-R">regeqdist(dmx,dmy,grouping,groups=levels(as.factor(grouping))[1:2])

## S3 method for class 'regeqdist'
print(x,...)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>dmx</code></td>
<td>
<p>dissimilarity matrix or object of class
<code>dist</code>. Explanatory dissimilarities (often these will be proper
distances, but more general dissimilarities that do not
necessarily fulfill the triangle inequality can be used, same for
<code>dmy</code>).</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>dmy</code></td>
<td>
<p>dissimilarity matrix or object of class
<code>dist</code>. Response dissimilarities.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>grouping</code></td>
<td>
<p>something that can be coerced into a factor,
defining the grouping of
objects represented by the dissimilarities <code>dmx</code> and <code>dmy</code>
(i.e., if <code>grouping</code> has length n, <code>dmx</code> and <code>dmy</code>
must be dissimilarities between <code>n</code> objects).</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>groups</code></td>
<td>
<p>Vector of two, indicating the two groups defining the
regressions to be compared in the test. These can be
factor levels, integer numbers, or strings, depending on the entries
of <code>grouping</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>x</code></td>
<td>
<p>object of class <code>"regeqdist"</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>...</code></td>
<td>
<p>optional arguments for print method.</p>
</td>
</tr>
</table>
<h3>Details</h3>

<p>The null hypothesis that the regressions within the two groups are
equal is tested using jackknife pseudovalues independently in both
groups allowing for potentially different variances of the
pseudovalues, and aggregating as in Welch's t-test. Tests are run
separately for intercept and slope and aggregated by Bonferroni's
rule.
</p>
<p>The test cannot be run and many components will be <code>NA</code> in case that
within-group regressions or jackknifed within-group regressions are
ill-conditioned.
</p>
<p>This was implemented having in mind an application in which the
explanatory distances represent geographical distances, the response
distances are genetic distances, and groups represent species or
species-candidates. In this application, for testing whether the
regression patterns are compatble with the two groups behaving like a
single species, one would first use <code>regeqdist</code> to test whether a
joint regression for the within-group distances of both groups makes
sense. If this is not rejected, <code>regdistbetween</code> is run to see
whether the between-group distances are compatible with the
within-group distances. On the other hand, if a joint regression on
within-group distances is rejected, <code>regdistbetweenone</code> can be
used to test whether the between-group distances are at least
compatible with the within-group distances of one of the groups, which
can still be the case within a single species, see Hausdorf and Hennig (2019).
</p>


<h3>Value</h3>

<p>list of class <code>"regeqdist"</code> with components
</p>
<table>
<tr style="vertical-align: top;">
<td><code>pval</code></td>
<td>
<p>p-values for intercept and slope.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>coeffdiff</code></td>
<td>
<p>vector of differences between groups (first minus
second) for intercept and slope.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>condition</code></td>
<td>
<p>condition numbers of regressions, see <code>kappa</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>lmfit</code></td>
<td>
<p>list. Output objects of <code>lm</code> within the two groups.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>jr</code></td>
<td>
<p>list of two lists of two; output object of
<code>jackknife</code> within the two groups for intercept and
slope.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>xcenter</code></td>
<td>
<p>mean of <code>dmx</code> within the two groups used for centering.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>tstat</code></td>
<td>
<p>t-statistic.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>tdf</code></td>
<td>
<p>vector of degrees of freedom of t-statistic according to
Welch-Sattertwaithe approximation for intercept and slope.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>jackest</code></td>
<td>
<p>jackknife-estimator of difference between regressions; 
vector with intercept and slope difference.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>jackse</code></td>
<td>
<p>vector with jackknife-standard errors for
<code>jackest</code>, intercept and slope.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>jackpseudo</code></td>
<td>
<p>list of two lists of vectors; jacknife pseudovalues
within both groups for intercept and slope estimators.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>groups</code></td>
<td>
<p>see above.</p>
</td>
</tr>
</table>
<h3>Author(s)</h3>

<p>Christian Hennig
<a href="mailto:christian.hennig@unibo.it">christian.hennig@unibo.it</a>
<a href="https://www.unibo.it/sitoweb/christian.hennig/en">https://www.unibo.it/sitoweb/christian.hennig/en</a></p>


<h3>References</h3>

<p>Hausdorf, B. and Hennig, C. (2019) Species delimitation and
geography. Submitted.
</p>


<h3>See Also</h3>

<p><code>regdistbetween</code>, <code>regdistbetweenone</code>
</p>


<h3>Examples</h3>

<pre><code class="language-R">  options(digits=4)
  data(veronica)
  ver.geo &lt;- coord2dist(coordmatrix=veronica.coord[173:207,],file.format="decimal2")
  vei &lt;- prabinit(prabmatrix=veronica[173:207,],distance="jaccard")
  loggeo &lt;- log(ver.geo+quantile(as.vector(as.dist(ver.geo)),0.25))

  species &lt;-c(rep(1,13),rep(2,22))
  rtest &lt;- regeqdist(dmx=loggeo,dmy=vei$distmat,grouping=species,groups=c(1,2))
  print(rtest)
</code></pre>


</div>