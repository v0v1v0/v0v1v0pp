<div class="container">

<table style="width: 100%;"><tr>
<td>setparts</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>Set partitions</h2>

<h3>Description</h3>

<script id="MathJax-script" async src="../../mathjaxr/doc/mathjax/es5/tex-chtml-full.js"></script><p>Enumeration of set partitions
</p>


<h3>Usage</h3>

<pre><code class="language-R">setparts(x)
listParts(x,do.set=FALSE)
vec_to_set(vec)
vec_to_eq(vec)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>x</code></td>
<td>
<p>If a vector of length 1, the size of the set to be
partitioned.  If a vector of length greater than 1, return all
equivalence relations with equivalence classes with sizes of the
elements of <code>x</code>.  If a matrix, return all equivalence classes
with sizes of the columns of <code>x</code></p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>do.set</code></td>
<td>
<p>Boolean, with <code>TRUE</code> meaning to return  the set
partitions in terms of sets (as per <span class="pkg">sets</span> package) and default
<code>FALSE</code> meaning to present the result in terms of equivalence
classes</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>vec</code></td>
<td>
<p>An integer vector representing a set partition</p>
</td>
</tr>
</table>
<h3>Details</h3>

<p>A <dfn>partition</dfn> of a set
\(S=\left\lbrace 1,\ldots,n\right\rbrace\) is a family of
sets \(T_1,\ldots,T_k\) satisfying
</p>

<ul>
<li> <p>\(i\neq j\longrightarrow T_i\cap
      T_j=\emptyset\)
</p>
</li>
<li> <p>\(\cup_{i=1}^kT_k=S\)
</p>
</li>
<li> <p>\(T_i\neq\emptyset\) for \(i=1,\ldots,
      k\) 
</p>
</li>
</ul>
<p>The induced <dfn>equivalence relation</dfn> has \(i\sim j\) if and
only if <i>i</i> and <i>j</i> belong to the same partition.  Equivalence
classes of \(S=\left\lbrace 1,\ldots,n\right\rbrace\)
may be listed using <code>listParts()</code>.  Thus
</p>
<p>There are exactly fifteen ways to partition a set of four
elements:
</p>

<table>
<tr>
<td style="text-align: left;">
    <i>(1234)</i>
</td>
</tr>
<tr>
<td style="text-align: left;">
    <i>(123)(4), (124)(3), (134)(2), (234)(1)</i>
</td>
</tr>
<tr>
<td style="text-align: left;">
    <i>(12)(34), (13)(24), (14)(23)</i>
</td>
</tr>
<tr>
<td style="text-align: left;">
    <i>(12)(3)(4), (13)(2)(4), (23)(1)(4), (24)(1)(3),
      (34)(1)(2)</i>
</td>
</tr>
<tr>
<td style="text-align: left;">
    <i>(1)(2)(3)(4)</i>
  </td>
</tr>
</table>
<p>Note that <i>(12)(3)(4)</i> is the same partition as, for example,
<i>(3)(4)(21)</i> as the equivalence relation is the same.
</p>
<p>Consider partitions of a set <i>S</i> of five elements (named
<i>1,2,3,4,5</i>) with sizes 2,2,1.  These may be enumerated as
follows:
</p>
<pre>
&gt; u &lt;- c(2,2,1)
&gt; setparts(u)
                                  
[1,] 1 1 1 1 1 1 1 1 1 1 1 1 3 3 3
[2,] 2 2 3 1 1 1 2 2 3 2 2 3 1 1 1
[3,] 3 2 2 3 2 2 1 1 1 3 2 2 2 1 2
[4,] 2 3 2 2 3 2 3 2 2 1 1 1 2 2 1
[5,] 1 1 1 2 2 3 2 3 2 2 3 2 1 2 2

</pre>
<p>See how each column has two 1s, two 2s and one 3.  This is because the
first and second classes have size two, and the third has size one.
</p>
<p>The first partition, <code>x=c(1,2,3,2,1)</code>, is read “class 1
contains elements 1 and 5 (because the first and fifth element of
<code>x</code> is 1); class 2 contains elements 2 and 4 (because the second
and fourth element of <code>x</code> is 2); and class 3 contains element 3
(because the third element of <code>x</code> is 3)”.  Formally, class
<code>i</code> has elements <code>which(x==u[i])</code>.
</p>
<p>You can change the print method by setting, eg,
<code>option(separator="")</code>.
</p>
<p>Functions <code>vec_to_set()</code> and <code>vec_to_eq()</code> are low-level
helper functions.  These take an integer vector, typically a column of a
matrix produced by <code>setparts()</code> and return their set
representation.
</p>


<h3>Value</h3>

<p>Returns a matrix each of whose columns show a set partition; an object
of class <code>"partition"</code>.  Type <code>?print.partition</code> to see how
to change the options for printing.
</p>


<h3>Note</h3>

<p>The <span class="pkg">clue</span> package  by Kurt Hornik contains functionality for
partitions (specifically <code>cl_meet()</code> and <code>cl_join()</code>) which
might be useful.  Option <code>do.set</code> invokes functionality from the
<span class="pkg">sets</span> package by Meyer et al.
</p>
<p>Note carefully that <code>setparts(c(2,1,1))</code> does <em>not</em>
enumerate the ways of placing four numbered balls in three boxes of
capacities 2,1,1.  This is because there are two boxes of capacity 1,
and swapping the balls between these boxes gives the same set
partition (because sets are unordered).  To do this, use
<code>multinomial(c(a=2,b=1,c=1))</code>.  See the <code>setparts</code> vignette
for more details.
</p>


<h3>Author(s)</h3>

<p>Luke G. West (<code>C++</code>) and Robin K. S. Hankin (<span style="font-family: Courier New, Courier; color: #666666;"><b>R</b></span>);
<code>listParts()</code> provided by Diana Tichy
</p>


<h3>References</h3>


<ul>
<li>
<p> R. K. S. Hankin 2006.  <em>Additive integer partitions in
<span style="font-family: Courier New, Courier; color: #666666;"><b>R</b></span></em>.  Journal of Statistical Software, Code Snippets 16(1)
</p>
</li>
<li>
<p> R. K. S. Hankin 2007.  “Set partitions in
<span style="font-family: Courier New, Courier; color: #666666;"><b>R</b></span>”. <em>Journal of Statistical Software</em>, Volume
23, code snippet 2
</p>
</li>
<li>
<p>  Kurt Hornik (2017).  <em>clue: Cluster ensembles</em>.  R
package version 0.3-53. <a href="https://CRAN.R-project.org/package=clue">https://CRAN.R-project.org/package=clue</a>
</p>
</li>
<li>
<p>  Kurt Hornik (2005).  <em>A CLUE for Cluster Ensembles</em>.
Journal of Statistical Software 14/12.
<a href="https://doi.org/10.18637/jss.v014.i12">doi:10.18637/jss.v014.i12</a>
</p>
</li>
</ul>
<h3>See Also</h3>

<p><code>parts</code>, <code>print.partition</code></p>


<h3>Examples</h3>

<pre><code class="language-R">setparts(4)                # all partitions of a set of 4 elements

setparts(c(3,3,2))         # all partitions of a set of 8 elements
                           # into sets of sizes 3,3,2.


listParts(c(2,2,1))        # all 15 ways of defining subsets of
                           # {1,2,3,4,5} with sizes 2,2,1

jj &lt;- restrictedparts(5,3)
setparts(jj)               # partitions of a set of 5 elements into
                           # at most 3 sets

listParts(jj)              # The induced equivalence classes




jj &lt;- restrictedparts(6,3,TRUE)
setparts(jj)               # partitions of a set of 6 elements into
ncol(setparts(jj))         # _exactly_ 3 sets; cf StirlingS2[6,3]==90


setparts(conjugate(jj))    # partitions of a set of 5 elements into
                           # sets not exceeding 3 elements


setparts(diffparts(5))     # partitions of a set of 5 elements into
                           # sets of different sizes


</code></pre>


</div>