<div class="container">

<table style="width: 100%;"><tr>
<td>pgls.Ives</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>Phylogenetic regression with intraspecific sampling error</h2>

<h3>Description</h3>

<p>Phylogenetic regression with within-species sampling error following Ives et al. (2007).
</p>


<h3>Usage</h3>

<pre><code class="language-R">pgls.Ives(tree, X, y, Vx=NULL, Vy=NULL, Cxy=NULL, lower=c(1e-8,1e-8),
    fixed.b1=NULL)
pgls.SEy(model, data, corClass=corBrownian, tree,
    se=NULL, method=c("REML","ML"), interval=c(0,1000), ...)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>tree</code></td>
<td>
<p>a phylogeny as an object of class <code>"phylo"</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>X</code></td>
<td>
<p>a named vector containing a <em>single</em> independent variable (multiple independent variables to be added in future). <code>X</code> can contain the species means, or a single long vector containing the sample of values for each species. In the latter case the <code>names(X)</code> will be repeating - all samples from the same species should have the same name.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>y</code></td>
<td>
<p>vector the dependent variable. Can be species means or individual values, as for <code>X</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>Vx</code></td>
<td>
<p>sampling variances for <code>X</code>. If <code>NULL</code>, then the within-species variance is computed from the data assuming that individual samples, not species means, have been provided in <code>X</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>Vy</code></td>
<td>
<p>sampling variances for <code>y</code>. If <code>NULL</code>, then the within-species variance is computed from the data assuming that individual samples, not species means, have been provided in <code>y</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>Cxy</code></td>
<td>
<p>sampling covariances between <code>X</code> and <code>y</code>. This will also be computed from the data if <code>Cxy==NULL</code>. Note than in this case - but not for the calculation of <code>Vx</code> and <code>Vy</code>, the same number of observations and the same ordering must be provided for <code>X</code> and <code>y</code>. If this is not the case, then it is assumed that different individuals have been sampled for <code>X</code> and <code>y</code> and thus <code>Cxy</code> is assumed to be zero for all species.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>lower</code></td>
<td>
<p>vector specifying the lower bounds for estimation for <code class="reqn">\sigma_x^2</code> and <code class="reqn">\sigma_y^2</code>, respectively. (Must be &gt; 0.)</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>fixed.b1</code></td>
<td>
<p>fixed regression slope, <code class="reqn">\beta</code>. Usually set to zero for null hypothesis testing.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>model</code></td>
<td>
<p>model to fit. (For <code>pgls.SEy</code>.)</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>data</code></td>
<td>
<p>data frame. (For <code>pgls.SEy</code>.)</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>corClass</code></td>
<td>
<p>correlation structure. (For <code>pgls.SEy</code>.)</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>se</code></td>
<td>
<p>vector of standard errors in <em>y</em>. (For <code>pgls.SEy</code>.)</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>method</code></td>
<td>
<p>optimization method. (For <code>pgls.SEy</code>.)</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>interval</code></td>
<td>
<p>interval over which to perform optimization. (For <code>pgls.SEy</code>.)</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>...</code></td>
<td>
<p>optional arguments. (For <code>pgls.SEy</code>.)</p>
</td>
</tr>
</table>
<h3>Details</h3>

<p><code>pgls.Ives</code> fits the phylogenetic regression model with within-species sampling error following Ives et al. (2007).
</p>
<p><code>pgls.SEy</code> fits a simpler model in which only sampling error in <code>y</code> is taken into account. This function uses <code>gls</code> from the <span class="pkg">nlme</span> package internally for optimization and returns an object of class <code>"gls"</code> that is compatible with all methods for that object class.
</p>
<p>In the case of <code>pgls.Ives</code>, only the bivariate regression model is implemented. Note that some problems have been reported with the optimization algorithm for this model, which is simple and thus may fail to find the ML solution.
</p>
<p>In the case of <code>pgls.SEy</code> the user can (theoretically) specify any class of linear model permitted by <code>gls</code>.
</p>


<h3>Value</h3>

<p>In the case of <code>pgls.Ives</code>, an object of class <code>"pgls.Ives"</code> with the following elements:
</p>
<table>
<tr style="vertical-align: top;">
<td><code>beta</code></td>
<td>
<p>a vector or matrix of regression coefficients.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>sig2x</code></td>
<td>
<p>fitted BM rate for <code>X</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>sig2y</code></td>
<td>
<p>fitted BM rate for <code>y</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>a</code></td>
<td>
<p>fitted ancestral states for <code>X</code> and <code>y</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>logL</code></td>
<td>
<p>log-likelihood.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>convergence</code></td>
<td>
<p>a value for convergence. <code>convergence=0</code> is good; see <code>optim</code> for more details.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>message</code></td>
<td>
<p>a message for convergence.</p>
</td>
</tr>
</table>
<p>In the case of <code>pgls.SEy</code>, an object of class <code>"gls"</code>.
</p>


<h3>Author(s)</h3>

<p>Liam Revell <a href="mailto:liam.revell@umb.edu">liam.revell@umb.edu</a></p>


<h3>References</h3>

<p>Ives, A. R., P. E. Midford, and T. Garland Jr. (2007) Within-species measurement error in phylogenetic comparative methods. <em>Systematic Biology</em>, <b>56</b>, 252-270.
</p>
<p>Revell, L. J. (2024) phytools 2.0: an updated R ecosystem for phylogenetic comparative methods (and other things). <em>PeerJ</em>, <b>12</b>, e16505.
</p>


<h3>See Also</h3>

<p><code>brownie.lite</code>, <code>phylosig</code>, <code>phyl.resid</code>
</p>


</div>