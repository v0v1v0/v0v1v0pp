<div class="container">

<table style="width: 100%;"><tr>
<td>numderiv</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>
Richardson's Numerical Derivative
</h2>

<h3>Description</h3>

<p>Richardson's method applied to the computation of the numerical derivative.
</p>


<h3>Usage</h3>

<pre><code class="language-R">numderiv(f, x0, maxiter = 16, h = 1/2, ..., tol = .Machine$double.eps)

numdiff(f, x, maxiter = 16, h = 1/2, ..., tol = .Machine$double.eps)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>f</code></td>
<td>
<p>function to be differentiated.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>x0, x</code></td>
<td>
<p>point(s) at which the derivative is to be computed.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>maxiter</code></td>
<td>
<p>maximum number of iterations.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>h</code></td>
<td>
<p>starting step size, should be the default <code>h=0.5</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>tol</code></td>
<td>
<p>relative tolerance.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>...</code></td>
<td>
<p>variables to be passed to function <code>f</code>.</p>
</td>
</tr>
</table>
<h3>Details</h3>

<p><code>numderiv</code> returns the derivative of <code>f</code> at <code>x0</code>, where
<code>x0</code> must be a single scalar in the domain of the function.
</p>
<p><code>numdiff</code> is a vectorized form of <code>numderiv</code> such that the
derivatives will be returned at all points of the vector <code>x</code>.
</p>


<h3>Value</h3>

<p>Numeric scalar or vector of approximated derivatives.
</p>


<h3>Note</h3>

<p>See <code>grad</code> in the ‘numDeriv’ package for another implementation of
Richardson's method in the context of numerical differentiation.
</p>


<h3>References</h3>

<p>Mathews, J. H., and K. D. Fink (1999). Numerical Methods Using Matlab.
Third Edition, Prentice Hall.
</p>


<h3>See Also</h3>

<p><code>fderiv</code>, <code>complexstep</code>
</p>


<h3>Examples</h3>

<pre><code class="language-R"># Differentiate an anti-derivative function
f &lt;- function(x) sin(x)*sqrt(1+sin(x))
F &lt;- function(x)
        integrate(f, 0, x, rel.tol = 1e-12)$value
x0 &lt;- 1
dF0 &lt;- numderiv(F, x0, tol = 6.5e-15)   #=&gt; 1.141882942715462
f(x0)                                   #   1.141882942715464 true value
# fderiv(F, x0)                         #   1.141882942704476
# numDeriv::grad(F, x0)                 #   1.141882942705797

# Compare over a whole period
x &lt;- seq(0, 2*pi, length.out = 11)
max(abs(numdiff(sin, x) - cos(x)))          #=&gt; 3.44e-15
# max(abs(numDeriv::grad(sin, x) - cos(x))) #   7.70e-12

# Example from complex step
f &lt;- function(x) exp(x) / sqrt(sin(x)^3 + cos(x)^3)
x0 &lt;- 1.5
numderiv(f, x0)                          #   4.05342789389876, error 0.5e-12
                                         #   4.053427893898621... true value
</code></pre>


</div>