<div class="container">

<table style="width: 100%;"><tr>
<td>PAsso</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>Partial association analysis between ordinal responses after adjusting for a set of covariates</h2>

<h3>Description</h3>

<p>This function is mainly designed for conducting the partial association analysis.
It provides two ways of using:
</p>
<p>1. A user-friendly way: only need "responses", "adjustments", and
"data". All the rest of the argument will be setted as default (see Arguments for details of
default).
</p>
<p>2. An advanced way: user can input a list of fitted models by "fitted.models", then the
"responses" and "adjustments" are not necessary. Supported class of cumulative link models in
<code>clm</code>, <code>glm</code>, <code>lrm</code>,
<code>orm</code>, <code>polr</code>, <code>vglm</code>, .
</p>
<p>It generates an object that has partial association matrix, marginal association,
and some attributes: "arguments" saves c(association, method, resids.type). "responses"
contains the names of response variables. The attribute "adjustments" contains the names
of covariates. The "summary" function of "PAsso" class of object provides marginal association '
matrix for comparison purpose.
</p>


<h3>Usage</h3>

<pre><code class="language-R">PAsso(
  responses,
  adjustments,
  data,
  uni.model = c("probit", "logit", "acat"),
  models = NULL,
  method = c("kendall", "pearson", "wolfsigma"),
  resids.type = c("surrogate", "sign", "general", "deviance"),
  jitter = c("latent", "uniform"),
  jitter.uniform.scale = c("probability", "response"),
  fitted.models = NULL,
  n_draws = 20,
  association = "partial",
  ...
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>responses</code></td>
<td>
<p>A string vector that specifies response variables. It requires to be equal
or greater than two variables in the data frame.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>adjustments</code></td>
<td>
<p>A string vector specifies covariates/confounders that need to
be adjusted.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>data</code></td>
<td>
<p>A data.frame including responses and adjustments.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>uni.model</code></td>
<td>
<p>A character string specifying the universal model setting for all
responses. Default <code>"logit"</code> refers to cumulative logit model. <code>"probit"</code>
refers to cumulative probit model. <code>"acat"</code> fits an adjacent categories regression model.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>models</code></td>
<td>
<p>A string vector contains default link functions of fitting models with
respect to each response variable. If <code>"models"</code> is missing or has any one of the model
unspecified, <code>"uni.model"</code> is used to specify same models for all responses automatically.
But, this argument has higher priority than the <code>"uni.model"</code> as long as the length of
<code>"models"</code> equals to the number of <code>"responses"</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>method</code></td>
<td>
<p>A string argument to specify correlation coefficient method.
Three choices <code>c("kendall", "pearson", "wolfsigma")</code>. The default is
<code>"kendall"</code></p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>resids.type</code></td>
<td>
<p>A character string specifying which type of residuals to generate
Current options are <code>"latent"</code> and <code>"uniform"</code>. Default is <code>"latent"</code>.
</p>

<dl>
<dt><code>surrogate</code></dt>
<dd>
<p>surrogate residuals (Liu and Zhang, 2017);</p>
</dd>
<dt><code>sign</code></dt>
<dd>
<p>sign-based residuals (Li and Shepherd, 2010, 2012);</p>
</dd>
<dt><code>general</code></dt>
<dd>
<p>generalized residuals (Franses and Paap, 2001);</p>
</dd>
<dt><code>deviance</code></dt>
<dd>
<p>deviance residuals (-2*loglik).</p>
</dd>
</dl>
<p>Although <code>"sign"</code>, <code>"general"</code>, and <code>"deviance"</code> are provided in
this package, these residuals are problematic for partial association analysis
between ordinal response (more discussions see Liu, Dungang, Li, Shaobo, Yu, Yan,
and Moustaki, Irini.(2020))</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>jitter</code></td>
<td>
<p>A character string specifying how to generate surrogate residuals.
Current options are <code>"latent"</code> and <code>"uniform"</code>. Default is <code>"latent"</code>.
</p>

<dl>
<dt><code>latent</code></dt>
<dd>
<p>surrogate residuals.</p>
</dd>
<dt><code>uniform</code></dt>
<dd>
<p>sign-based residuals.</p>
</dd>
</dl>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>jitter.uniform.scale</code></td>
<td>
<p>A character string specifying the scale on which to perform
the jittering whenever <code>jitter = "uniform"</code>. More details: <code>PAsso::residuals</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>fitted.models</code></td>
<td>
<p>A list contains all the models (S3 objects) you want to
assess for the partial association between ordinal responses after adjusting
for a set of covariates covariates. All of these models should be applied to the
same dataset, having same covariates, same sample size etc. The models in this
list can be an object of class <code>clm</code>,
<code>glm</code>, <code>lrm</code>, <code>orm</code>,
<code>polr</code>, <code>vglm</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>n_draws</code></td>
<td>
<p>A number to specify draws of surrogate residuls
such that the partial correlation coefficients are calculated repeatedly. The final
correlation coefficients are the average of all partial correlation coefficients.
It is the <code>"nsim"</code> argument in <code>"residuals()"</code> function.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>association</code></td>
<td>
<p>An default argument to specify the partial association. Leave this
further development of package such that other association analyses can be embedded.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>...</code></td>
<td>
<p>Additional optional arguments.</p>
</td>
</tr>
</table>
<h3>Value</h3>

<p>An object of class <code>"PAsso"</code> is a list containing at least the following
components. It contains the partial correlation matrix and multiple repeats if
<code>n_draws</code> &gt; 1. This object has "arguments"
attribute saved as c(association, method, resids.type), "responses" attribute, and
"adjustments" attribute.
The list contains:
</p>

<dl>
<dt><code>corr</code></dt>
<dd>
<p>The estimated correlation matrix(average of <code>rep_MatCorr</code>)
of partial association after adjusting confounders;</p>
</dd>
<dt><code>rep_corr</code></dt>
<dd>
<p>The replications of estimated correlation matrix;</p>
</dd>
<dt><code>rep_SRs</code></dt>
<dd>
<p>The replications of surrogate residuals if partial association is applied;</p>
</dd>
<dt><code>fitted.models</code></dt>
<dd>
<p>The list stores all fitted.models;</p>
</dd>
<dt><code>data</code></dt>
<dd>
<p>The data.frame of original dataset;</p>
</dd>
<dt><code>mods_n</code></dt>
<dd>
<p>The sample size of each fitted model;</p>
</dd>
<dt><code>cor_func</code></dt>
<dd>
<p>The correlation function after assign different method;</p>
</dd>
<dt><code>Marg_corr</code></dt>
<dd>
<p>The marginal association matrix.</p>
</dd>
</dl>
<h3>References</h3>

<p>Liu, D., Li, S., Yu, Y., &amp; Moustaki, I. (2020). Assessing partial association between
ordinal variables: quantification, visualization, and hypothesis testing. <em>Journal
of the American Statistical Association</em>, 1-14. doi: <a href="https://doi.org/10.1080/01621459.2020.1796394">10.1080/01621459.2020.1796394</a>
</p>
<p>Liu, D., &amp; Zhang, H. (2018). Residuals and diagnostics for ordinal regression models:
A surrogate approach. <em>Journal of the American Statistical Association</em>, 113(522), 845-854.
doi: <a href="https://doi.org/10.1080/01621459.2017.1292915">10.1080/01621459.2017.1292915</a>
</p>
<p>Li, C., &amp; Shepherd, B. E. (2010). Test of association between two ordinal variables
while adjusting for covariates. <em>Journal of the American Statistical Association</em>,
105(490), 612-620. doi: <a href="https://doi.org/10.1198/jasa.2010.tm09386">10.1198/jasa.2010.tm09386</a>
</p>
<p>Li, C., &amp; Shepherd, B. E. (2012). A new residual for ordinal outcomes. <em>Biometrika</em>,
99(2), 473-480. doi: <a href="https://doi.org/10.1093/biomet/asr073">10.1093/biomet/asr073</a>
</p>
<p>Franses, P. H., &amp; Paap, R. (2001). <em>Quantitative models in marketing research</em>.
Cambridge University Press. doi: <a href="https://doi.org/10.1017/CBO9780511753794">10.1017/CBO9780511753794</a>
</p>


<h3>Examples</h3>

<pre><code class="language-R">
###########################################################
# User-friendly way of using
###########################################################
library(MASS)

# Import ANES2016 data in "PAsso"
data(ANES2016)

# User-friendly way of using: Parial association analysis
PAsso_1 &lt;- PAsso(responses = c("PreVote.num", "PID"),
                adjustments = c("income.num", "age", "edu.year"),
                data = ANES2016,
                method = c("kendall"))

print(PAsso_1, digits = 4)
summary(PAsso_1, digits = 4)

###########################################################
# Advanced way of using
###########################################################

fit.vote&lt;- glm(PreVote.num ~ income.num+ age + edu.year, data = ANES2016,
               family = binomial(link = "probit"))
fit.PID&lt;- polr(as.factor(PID) ~ income.num+age+edu.year, data = ANES2016,
               method="probit", Hess = TRUE)

PAsso_adv1 &lt;- PAsso(fitted.models=list(fit.vote, fit.PID),
                    method = c("kendall"),
                    resids.type = "surrogate")

print(PAsso_adv1, digits = 4)
summary(PAsso_adv1, digits = 4)

</code></pre>


</div>