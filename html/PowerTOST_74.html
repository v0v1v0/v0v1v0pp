<div class="container">

<table style="width: 100%;"><tr>
<td>sampleN.scABEL</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>
Sample size estimation for BE decision via scaled (expanded) BE acceptance limits
</h2>

<h3>Description</h3>

<p>This function performs the sample size estimation via power calculations of the
BE decision via scaled (expanded) BE acceptance limits, based on simulations.
</p>


<h3>Usage</h3>

<pre><code class="language-R">sampleN.scABEL(alpha = 0.05, targetpower = 0.8, theta0, theta1, theta2,
               CV, design = c("2x3x3", "2x2x4", "2x2x3"), regulator,
               nsims = 1e+05, nstart, imax = 100, print = TRUE,
               details = TRUE, setseed = TRUE)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>alpha</code></td>
<td>

<p>Type I error probability. Per convention mostly set to 0.05.
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>targetpower</code></td>
<td>

<p>Power to achieve at least. Must be &gt;0 and &lt;1.<br>
Typical values are 0.8 or 0.9.
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>theta0</code></td>
<td>

<p>‘True’ or assumed T/R ratio. <br>
Defaults to 0.90 according to the two Lászlós if not given explicitly.
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>theta1</code></td>
<td>

<p>Conventional lower ABE limit to be applied in the mixed procedure if
<code>CVsWR &lt;= CVswitch</code>.<br>
Also Lower limit for the point estimate constraint.<br>
Defaults to 0.8 if not given explicitly.
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>theta2</code></td>
<td>

<p>Conventional upper ABE limit to be applied in the mixed procedure if
<code>CVsWR &lt;= CVswitch</code>. Also upper limit for the point estimate constraint.<br>
Defaults to 1.25 if not given explicitly.
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>CV</code></td>
<td>

<p>Intra-subject coefficient(s) of variation as ratio (not percent).
</p>

<ul>
<li>
<p> If given as a scalar (<code>length(CV) == 1</code>) the <em>same</em> CV of Test and Reference is assumed (homoscedasticity, <em>CV</em><sub>wT</sub> = <em>CV</em><sub>wR</sub>).
</p>
</li>
<li>
<p> If given as a vector (<code>length(CV) == 2</code>), <em>i.e.</em>, assuming heteroscedasticity, the <em>CV</em> of the Test <strong>must</strong> be given in
<code>CV[1]</code> and the one of the Reference in the <code>CV[2]</code>.
</p>
</li>
</ul>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>design</code></td>
<td>

<p>Design of the study to be planned.<br><code>"2x3x3"</code> is the partial replicate design.<br><code>"2x2x4"</code> is a full replicate design with 2 sequences and 4 periods.<br><code>"2x2x3"</code> is a full replicate design with 2 sequences and 3 periods.<br>
Defaults to <code>design="2x3x3"</code>. Details are given the section about Designs.
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>regulator</code></td>
<td>

<p>Regulatory settings for the widening of the BE acceptance limits.<br>
May be given as character from the choices <code>"EMA"</code>, <code>"HC"</code>, <code>"GCC"</code>,
<code>"FDA"</code> or as an object of class 'regSet' (see <code>reg_const</code>).<br>
Defaults to <code>regulator="EMA"</code> if missing.<br>
This argument may be given also in lower case if given as character.<br><br></p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>nsims</code></td>
<td>

<p>Number of simulations to be performed to obtain the (empirical) power.
The default value 100,000 = 1e+5 is usually sufficient. Consider to rise
this value if <code>theta0</code> &lt;=0.85 or &gt;=1.20. But see the warning section.
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>nstart</code></td>
<td>

<p>Set this to a start for the sample size search if a previous run failed.<br>
After reworking the start n in version 1.1-05 rarely needed.
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>imax</code></td>
<td>

<p>Maximum number of steps in sample size search. Defaults to 100.
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>print</code></td>
<td>

<p>If <code style="white-space: pre;">⁠TRUE⁠</code> (default) the function prints its results.
If <code style="white-space: pre;">⁠FALSE⁠</code> only the result data.frame will be returned.
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>details</code></td>
<td>

<p>If set to <code>TRUE</code> (default), the steps during sample size search are shown.
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>setseed</code></td>
<td>

<p>Simulations are dependent on the starting point of the (pseudo) random number
generator. To avoid differences in power for different runs a <code>set.seed(123456)</code>
is issued if <code>setseed = TRUE</code>, the default.
</p>
</td>
</tr>
</table>
<h3>Details</h3>

<p>The simulations are done via the distributional properties of the statistical
quantities necessary for deciding BE based on ABEL (‘Average Bioequivalence with Expanded Limits’). For more details see a description in the <code>/doc</code> sub-directory of the package.<br><br>
Function <code>sampleN.scABEL()</code> is based on power calculations via simulations
using the distributional characteristics of the ‘key’ statistics obtained from
the EMA recommended evaluation via ANOVA if <code>regulator="EMA"</code> or if the
regulator component <code>est_method</code> is set to <code>"ANOVA"</code> if regulator is an object
of class 'regSet'.<br>
Otherwise, the simulations are based on the distributional characteristis of the
‘key’ statistics obtained from evaluation via intra-subject contrasts (ISC),
as recommended by the FDA.<br><br>
The estimated sample size gives always the <em>total</em> number of subjects
(not subject/sequence – like in some other software packages).<br><br>
Function <code>sampleN.scABEL2()</code> is solely based on power calculations via
simulation using the distributional characteristics of the ‘key’ statistics
obtained from evaluation via intra-subject contrasts (ISC). This function is deprecated.
</p>


<h3>Value</h3>

<p>Returns a data.frame with the input settings and sample size results.<br>
The <code>Sample size</code> column contains the total sample size.<br>
The <code>nlast</code> column contains the last <code>n</code> value. May be useful for restarting.
</p>


<h3>Designs</h3>

<p>Although some designs are more ‘popular’ than others, sample size estimations are valid for <em>all</em> of the following designs:
</p>

<table>
<tr>
<td style="text-align: left;">
    <code>"2x2x4"</code> </td>
<td style="text-align: left;"> TRTR | RTRT</td>
</tr>
<tr>
<td style="text-align: left;">
    </td>
<td style="text-align: left;"> TRRT | RTTR</td>
</tr>
<tr>
<td style="text-align: left;">
    </td>
<td style="text-align: left;"> TTRR | RRTT</td>
</tr>
<tr>
<td style="text-align: left;">
    <code>"2x2x3"</code> </td>
<td style="text-align: left;"> TRT | RTR</td>
</tr>
<tr>
<td style="text-align: left;">
    </td>
<td style="text-align: left;"> TRR | RTT</td>
</tr>
<tr>
<td style="text-align: left;">
    <code>"2x3x3"</code> </td>
<td style="text-align: left;"> TRR | RTR | RRT
  </td>
</tr>
</table>
<h3>Warning </h3>

<p>The sample size estimation for extreme <code>theta0</code> (&lt;0.83 or &gt;1.21) may be very
time consuming and will eventually also fail since the start values chosen are
not really reasonable in that ranges. This is especially true in the range around
CV = 0.3 and regulatory constant according to FDA.<br>
If you really need sample sizes in that range be prepared to restart the sample
size estimation via the argument <code>nstart</code>.<br>
Since the dependence of power from n is very flat in the mentioned region you may
also consider to adapt the number of simulations not to get caught in the simulation
error trap.<br><br>
If results of <code>power.scABEL</code> are expected to be inaccurate (partial
replicate design with unbalanced sequences and/or heteroscedasticity in the case of <em>CV</em><sub>wT</sub> &gt; <em>CV</em><sub>wR</sub>, subject data via <code>sampleN.scABEL.sdsims</code> should be simulated instead. Very time consuming (easily 100times slower)! Subject data simulations are only supported for <code>regulator="EMA"</code> and <code>regulator="GCC"</code>.
</p>


<h3>Note</h3>

<p>We are doing the sample size estimation only for balanced designs since the
break down of the total subject number in case of unbalanced sequence groups
is not unique. Moreover the formulas used are only for balanced designs.<br><br>
In case of <code>regulator="FDA"</code> the sample size is only approximate since
the BE decision method is not exactly what is expected by the FDA. But the two Lászlós state that the scABEL method should be ‘operationally’ equivalent to the
FDA method. Thus the sample size should be comparable.<br>
Consider in case of <code>regulator="FDA"</code> to use the function
<code>sampleN.RSABE()</code> instead.<br><br>
In case of <code>regulator="HC"</code> the underlying power is only approximative
since the Health Canada recommends evaluation by a mixed model approach.
But this could only implemented via subject data simulations which are very
time consuming.<br><br>
The minimum sample size is 6, even if the power is higher than the intended
targetpower.
</p>


<h3>Author(s)</h3>

<p>D. Labes
</p>


<h3>References</h3>

<p>Tóthfalusi L, Endrényi L. <em>Sample Sizes for Designing Bioequivalence Studies for Highly Variable Drugs.</em> J Pharm Pharmaceut Sci. 2011;15(1):73–84.
<a href="http://ejournals.library.ualberta.ca/index.php/JPPS/article/download/11612/9489">open access</a>
</p>


<h3>See Also</h3>

<p><code>power.scABEL</code>, <code>sampleN.scABEL.sdsims</code>, <code>sampleN.RSABE</code>,
<code>reg_const</code>
</p>


<h3>Examples</h3>

<pre><code class="language-R"># using all the defaults:
# partial replicate design, targetpower=80%,
# true assumed ratio = 0.90, 1E+5 simulated studies
# ABE limits, PE constraint 0.8 - 1.25
# EMA regulatory settings
sampleN.scABEL(CV = 0.3)
# should result in a sample size n=54, power=0.8159

# Now with former (inofficial) ANVISA settings, CVswitch=40%
# (since 2016 ANVISA uses the same settings as EMA)
reg      &lt;- reg_const("USER", r_const = 0.76, CVswitch = 0.4, CVcap = 0.5)
reg$name &lt;- "Old ANVISA"
sampleN.scABEL(CV = 0.3, regulator = reg)
# should result in a sample size n=60, power=0.8101

# For the full replicate design, target power = 90%
# true assumed ratio = 0.9, FDA regulatory settings
# sims based on evalaution via ISC
sampleN.scABEL(CV = 0.4, targetpower = 0.9, design = "2x2x4",
               regulator = "FDA")
# should result in a sample size n=32, power=0.9125

# Fixed wider limits (0.7500 - 1.3333) for the GCC
sampleN.scABEL(CV = 0.4, targetpower = 0.9, design = "2x2x4",
               regulator = "GCC")
# should result in a sample size n=40, power=0.9039
</code></pre>


</div>