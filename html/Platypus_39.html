<div class="container">

<table style="width: 100%;"><tr>
<td>VDJ_extract_germline_consensus_ref</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>Making the trimmed reference and concatenating fr1-fr4</h2>

<h3>Description</h3>

<p>Function that takes the VDJ and the fr1-fr4 sequence per antibody
Based on the ref argument, if TRUE it also returns the returns in the VDJ/VJ_ref.nt/aa the trimmed reference based
on the alignement with the consensus.
</p>


<h3>Usage</h3>

<pre><code class="language-R">VDJ_extract_germline_consensus_ref(
  VDJ,
  n_clones = NA,
  samples = NA,
  ref = TRUE,
  path_toData = "../Data/"
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>VDJ</code></td>
<td>
<p>VDJ or vgm[[1]] object, as obtained from the VDJ_GEX_matrix function in Platypus.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>n_clones</code></td>
<td>
<p>integer, denoting the top n clones to get the reference. If NA it is performed in all clones</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>samples</code></td>
<td>
<p>list of sample names, with the same order as they were accessed to make the VGM</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>ref</code></td>
<td>
<p>bool, denoting whether or not we trim the reference of the antibodies.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>path_toData</code></td>
<td>
<p>str, denoting the folder containing the VDJ folder with VDJ information per sample</p>
</td>
</tr>
</table>
<h3>Value</h3>

<p>$vdj: VDJ containing the VDJ/VJ_ref.nt/aa columns if ref = TRUE and the full_VDJ, full_VJ columns with the fr1-fr4. $clones: clone_ids for which a reference was made.
</p>


<h3>Examples</h3>

<pre><code class="language-R">
try({
samples = c('LCMV', 'TNFR')
vgm = read("VGM.RData")
n_clones = 20
result = VDJ_extract_germline_consensus_ref(vgm$VDJ, n_clones,
samples, ref = TRUE,
path_toData="../Data/")
VDJ = result[1]$vdj
clone_counts = result[2]$clones
})


</code></pre>


</div>