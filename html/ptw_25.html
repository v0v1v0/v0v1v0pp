<div class="container">

<table style="width: 100%;"><tr>
<td>select.traces</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>
Select traces from a data set according to several criteria
</h2>

<h3>Description</h3>

<p>For alignment purposes, it may be useful to select traces which show
clear features, and to throw away traces that contain mainly
noise. This function implements three ways to achieve this: CODA, a
criterion similar to varimax, and a criterion based on the highest
intensity.
</p>


<h3>Usage</h3>

<pre><code class="language-R">select.traces(X, criterion = c("coda", "var", "int"),
              window = 5, smoothing = c("median", "mean"))
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>X</code></td>
<td>
<p>a data matrix or an array. The first dimension signifies the
traces from which a selection is to be made. If X is a matrix, the
first usually corresponds to samples and the second dimension
is the spectral dimension. If X is an array, the data are
assumed to come from a hyphenated experiment, with the first
dimension the chromatographic dimension, the second the spectral
dimension and the third dimension corresponding to samples</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>criterion</code></td>
<td>
<p>either Windig's CODA algorithm, a criterion
calculating the variances of the length-scaled spectra, or a
criterion giving the height of the highest peak</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>window, smoothing</code></td>
<td>
<p>arguments to the coda function.</p>
</td>
</tr>
</table>
<h3>Details</h3>

<p>The CODA criterion in essence selects traces with no baseline
and no spikes, but still containing significant intensities. The
variance criterion aims at something similar: it calculates the
variance (or standard deviation) of every trace after length scaling -
traces with a high value show few highly structured features, whereas
traces with a low value show noise or a significant baseline. The
intensity criterion simply returns the intensity of the highest
peak. The latter two criteria are simpler than CODA but implicitly
assume that the traces have been preprocessed (i.c., spikes have been
removed).
</p>


<h3>Value</h3>

<p>The function returns a list with components
</p>
<table>
<tr style="vertical-align: top;">
<td><code>crit.val</code></td>
<td>
<p>a vector containing the values of the criterion for
all traces. If X is an array, the function is recursively applied
to all samples (elements of the third dimension) - the results are
multiplied to obtain one criterion value per trace</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>trace.nrs</code></td>
<td>
<p>the order of the traces (from large to small)</p>
</td>
</tr>
</table>
<h3>Author(s)</h3>

<p>Ron Wehrens</p>


<h3>See Also</h3>

<p><code>coda</code></p>


<h3>Examples</h3>

<pre><code class="language-R">data(lcms)
ntrace &lt;- dim(lcms)[1]
lcms.selection &lt;- select.traces(lcms[,,1:2], criterion = "var")
good &lt;- lcms.selection$trace.nrs[1]
bad &lt;- lcms.selection$trace.nrs[ntrace]

par(mfrow = c(1,2))
matplot(lcms[good,,1:2], type = 'l', lty = 1)
matplot(lcms[bad,,1:2], type = 'l', lty = 1)
</code></pre>


</div>