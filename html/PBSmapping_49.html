<div class="container">

<table style="width: 100%;"><tr>
<td>addBubbles</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>
Add Bubbles to Maps
</h2>

<h3>Description</h3>

<p>Add bubbles proportional to some <code>EventData</code>'s <code>Z</code> column
(e.g., catch or effort) to an existing plot, where each unique
<code>EID</code> describes a bubble.
</p>


<h3>Usage</h3>

<pre><code class="language-R">addBubbles(events, type=c("perceptual","surface","volume"),
   z.max=NULL, min.size=0, max.size=0.8, symbol.zero="+",
   symbol.fg=rgb(0,0,0,0.60), symbol.bg=rgb(0,0,0,0.30),
   legend.pos="bottomleft", legend.breaks=NULL,
   show.actual=FALSE, legend.type=c("nested","horiz","vert"),
   legend.title="Abundance", legend.cex=.8, neg.col="RYB", ...)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>events</code></td>
<td>
<p>EventData to use (<em>required</em>).</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>type</code></td>
<td>
<p><code>character</code> – scaling option for bubbles where <code>"perceptual"</code>
emphasizes large z-values, <code>"volume"</code> emphasizes small z-values,
and <code>"surface"</code> lies in between.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>z.max</code></td>
<td>
<p><code>numeric</code> – maximum value for z (default = <code>max(events$Z)</code>);
determines the largest bubble; keeps the same legend for different maps.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>min.size</code></td>
<td>
<p><code>numeric</code> – minimum size (inches) for a bubble representing
<code>min(events$Z)</code>.  The legend may not actually include a bubble of
this size because the calculated legend.breaks does not include the <code>min(events$Z)</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>max.size</code></td>
<td>
<p><code>numeric</code> – maximum size (inches) for a bubble representing
<code>z.max</code>.  A legend bubble may exceed this size when
<code>show.actual</code> is <code>FALSE</code> (on account of using <code>pretty(...)</code>).</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>symbol.zero</code></td>
<td>
<p><code>character</code> – symbol to represent z-values equal to 0.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>symbol.fg</code></td>
<td>
<p><code>character</code> – bubble outline (border) colour.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>symbol.bg</code></td>
<td>
<p><code>character</code> – bubble interior (fill) colour.  If a vector, the
first element represents <code>min(legend.breaks)</code> and the last
element represents <code>max(legend.breaks)</code>; colours are interpolated
for values of <code>events$Z</code> between those boundaries.  For values
outside of those boundaries, interiors remain unfilled.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>legend.pos</code></td>
<td>
<p><code>character|numeric</code> – position for the legend.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>legend.breaks</code></td>
<td>
<p><code>numeric</code> – break values for categorizing the z-values.
The automatic method should work if zeroes are present;
otherwise, you can specify your own break values for the legend.
If a single number, specifies the number of breaks; if a vector,
specifies the breaks.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>show.actual</code></td>
<td>
<p><code>logical</code> – if <code>FALSE</code>, legend values are
obtained using <code>pretty(...)</code>, and consequently, the largest
bubble may be larger than <code>z.max</code>; if <code>TRUE</code>, the largest
bubble in the legend will correspond to <code>z.max</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>legend.type</code></td>
<td>
<p><code>character</code> – display format for legend.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>legend.title</code></td>
<td>
<p><code>character</code> – title for legend.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>legend.cex</code></td>
<td>
<p><code>numeric</code> – size of legend text.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>neg.col</code></td>
<td>
<p><code>character</code> – bubble colour for any potential negative values.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>...</code></td>
<td>
<p><code>dots</code> – additional arguments for <code>points</code> function that plots zero-value symbols.</p>
</td>
</tr>
</table>
<h3>Details</h3>

<p>Modified from (and for the legend, strongly inspired by) Tanimura
et al. (2006) by Denis Chabot to work with <span class="pkg">PBSmapping</span>.
</p>
<p>Furthermore, Chabot's modifications make it possible to draw
several maps with bubbles that all have the same scale
(instead of each bubble plot having a scale that depends on
the maximum z-value for that plot).
This is done by making <code>z.max</code> equal to the largest z-value
from all maps that will be plotted.
</p>
<p>The user can also add a legend in one of four corners
(see <code>legend</code>) or at a specific <code>c(X,Y)</code> position.
If <code>legend.pos</code> is <code>NULL</code>, no legend is drawn.
</p>


<h3>Author(s)</h3>

<p><a href="mailto:denis.chabot@dfo-mpo.gc.ca">Denis Chabot</a>, Research Scientist<br>
Maurice-Lamontagne Institute, Fisheries &amp; Oceans Canada (DFO), Mont-Joli QC<br></p>
<p>Maintainer: <a href="mailto:rowan.haigh@dfo-mpo.gc.ca">Rowan Haigh</a>, Program Head – Offshore Rockfish<br>
Pacific Biological Station (PBS), Fisheries &amp; Oceans Canada (DFO), Nanaimo BC<br><em>locus opus</em>: Offsite, Vancouver BC<br>
Last modified <code>Rd: 2024-09-25</code>
</p>


<h3>References</h3>

<p>Tanimura, S., Kuroiwa, C., and Mizota, T. (2006)
Proportional symbol mapping in R.
<em>Journal of Statistical Software</em> <b>15</b>(5).
</p>


<h3>See Also</h3>

<p>In package <span class="pkg">PBSmapping</span>:<br><code>addPolys</code>,
<code>EventData</code>,
<code>RGB2RYB</code>,
<code>surveyData</code>
</p>


<h3>Examples</h3>

<pre><code class="language-R">local(envir=.PBSmapEnv,expr={
  oldpar = par(no.readonly=TRUE)
  #--- common code for both examples below
  data(nepacLL,surveyData,envir=.PBSmapEnv)
  surveyData$Z &lt;- surveyData$catch

  #--- plot a version that only varies the size
  plotMap(nepacLL, xlim=c(-131.8,-127.2), ylim=c(50.5,52.7),
    col="gainsboro",plt=c(.08,.99,.08,.99), cex.axis=1.2, cex.lab=1.5)
  addBubbles(surveyData, symbol.bg=rgb(.9,.5,0,.6),
    legend.type="nested", symbol.zero="+", col="grey")

  #--- plot a version that uses different symbol colours
  plotMap(nepacLL, xlim=c(-131.8,-127.2), ylim=c(50.5,52.7),
  col="gainsboro",plt=c(.08,.99,.08,.99), cex.axis=1.2, cex.lab=1.5)
  subset &lt;- surveyData[surveyData$Z &lt;= 1000, ]
  addBubbles(subset, symbol.bg=c("red", "yellow", "green"),
    legend.type="horiz", legend.breaks=pretty(range(subset$Z), n=11),
    symbol.zero=FALSE, col="grey", min.size=0.1, max.size=0.4)
  par(oldpar)
})
</code></pre>


</div>