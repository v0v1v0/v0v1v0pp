<div class="container">

<table style="width: 100%;"><tr>
<td>fit.bd</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>Fits birth-death (speciation/extinction) model to reconstructed phylogeny</h2>

<h3>Description</h3>

<p>Fits a birth-death (<code>fit.bd</code>) or pure-birth (<code>fit.yule</code>) model to a reconstructed phylogenetic tree with branch lengths.
</p>


<h3>Usage</h3>

<pre><code class="language-R">fit.bd(tree, b=NULL, d=NULL, rho=1, ...)
fit.yule(tree, b=NULL, d=NULL, rho=1, ...)
lik.bd(theta, t, rho=1, N=NULL)
## S3 method for class 'fit.bd'
print(x, ...)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>tree</code></td>
<td>
<p>object of class <code>"phylo"</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>b</code></td>
<td>
<p>birth (speciation) rate. Presently doesn't do anything as the rate cannot be fixed.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>d</code></td>
<td>
<p>death (extinction) rate. Presently doesn't do anything as the rate cannot be fixed.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>rho</code></td>
<td>
<p>sampling fraction.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>theta</code></td>
<td>
<p>vector of <code>b</code> and <code>d</code> for likelihood function.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>t</code></td>
<td>
<p>branching times for calculation of the likelihood.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>N</code></td>
<td>
<p>number of tips in the tree.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>x</code></td>
<td>
<p>object of class <code>"fit.bd"</code> for <code>print</code> method.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>...</code></td>
<td>
<p>optional arguments.</p>
</td>
</tr>
</table>
<h3>Details</h3>

<p>The function <code>fit.bd</code> fits a birth-death model to a phylogenetic tree with edge lengths and a (potentially) incomplete sampling fraction.
</p>
<p>The function <code>fit.yule</code> fits a pure-birth model with a (potentially) incomplete sampling fraction.
</p>
<p>The function <code>lik.bd</code> computes the likelihood of a set of birth &amp; death rates given the set of branching times computed for a tree and a sampling fraction.
</p>


<h3>Value</h3>

<p><code>fit.bd</code> returns an object of class <code>"fit.bd"</code> which can be printed. This object is a list containing the fitted model parameters, likelihood, optimization conditions, a summary of the optimization, and a likelihood function.
</p>
<p><code>fit.yule</code> returns an object of class <code>"fit.yule"</code>. This object is a list containing the fitted model parameter, likelihood, optimization conditions, a summary of the optimization, and a likelihood function.
</p>


<h3>Author(s)</h3>

<p>Liam Revell <a href="mailto:liam.revell@umb.edu">liam.revell@umb.edu</a></p>


<h3>References</h3>

<p>Nee, S., May, R. M. and Harvey, P. H. (1994) The reconstructed evolutionary process. <em>Philosophical Transactions of the Royal Society of London B</em>, <b>344</b>, 305-311.
</p>
<p>Revell, L. J. (2024) phytools 2.0: an updated R ecosystem for phylogenetic comparative methods (and other things). <em>PeerJ</em>, <b>12</b>, e16505.
</p>
<p>Stadler, T. (2012) How can we improve the accuracy of macroevolutionary rate estimates? <em>Systematic Biology</em>, <b>62</b>, 321-329.
</p>


<h3>See Also</h3>

<p><code>birthdeath</code>
</p>


<h3>Examples</h3>

<pre><code class="language-R">data(salamanders)
## compute sampling fraction based on 55 species of Plethodon
sampling.f&lt;-Ntip(salamanders)/55
## fit birth-death model
bd.fit&lt;-fit.bd(salamanders,rho=sampling.f)
print(bd.fit)
## fit Yule model
yule.fit&lt;-fit.yule(salamanders,rho=sampling.f)
print(yule.fit)
## compare b-d and yule models
anova(yule.fit,bd.fit)
## create a likelihood surface for b-d model
ngrid&lt;-100
b&lt;-seq(0.01,0.06,length.out=ngrid)
d&lt;-seq(0.005,0.03,length.out=ngrid)
logL&lt;-sapply(d,function(d,b) sapply(b,function(b,d) 
    bd.fit$lik(c(b,d)),d=d),b=b)
contour(x=b,y=d,logL,nlevels=100,
    xlab=expression(lambda),
    ylab=expression(mu),bty="l")
title(main="Likelihood surface for plethodontid diversification",
    font.main=3)
points(bd.fit$b,bd.fit$d,cex=1.5,pch=4,
    col="blue",lwd=2)
legend("bottomright","ML solution",pch=4,col="blue",
    bg="white",pt.cex=1.5,pt.lwd=2)
</code></pre>


</div>