<div class="container">

<table style="width: 100%;"><tr>
<td>map_phenology</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>Generate a likelihood map varying Phi and Delta.</h2>

<h3>Description</h3>

<p>This function generates a map of likelihood varying Phi and Delta.<br>
Parameters are the same than for the fit_phenology() function except for trace that is disabled.<br>
If Alpha, Beta or Tau are not indicated, Alpha and Tau are set to 0 and 1 and Beta is fitted.<br>
Only one set of Alpha, Beta, Tau, Phi and Delta are used for all timeseries present in data.<br>
Note that it is possible to fit or fixed Alpha[n], Beta[n], Tau[n], Phi[n] and Delta[n] with [n]=1 or 2
and then it is possible to use this function to establish the likelihood map for a
second or third sinusoids added to the global pattern.<br>
If Delta is not specified, it is estimated from Phi and the same precision as Phi is used.
</p>


<h3>Usage</h3>

<pre><code class="language-R">map_phenology(
  data = NULL,
  fitted.parameters = NULL,
  fixed.parameters = NA,
  Phi = seq(from = 0.2, to = 20, length.out = 100),
  Delta = NULL,
  progressbar = any(installed.packages()[, "Package"] == "pbapply"),
  cofactors = NULL,
  add.cofactors = NULL,
  zero = 1e-09
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>data</code></td>
<td>
<p>dataset generated with add_format</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>fitted.parameters</code></td>
<td>
<p>Set of parameters to be fitted</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>fixed.parameters</code></td>
<td>
<p>Set of fixed parameters</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>Phi</code></td>
<td>
<p>Phi values to be analyzed</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>Delta</code></td>
<td>
<p>Delta value to be analyzed</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>progressbar</code></td>
<td>
<p>If FALSE, do not show the progress bar</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>cofactors</code></td>
<td>
<p>data.frame with a column Date and a column for each cofactor</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>add.cofactors</code></td>
<td>
<p>Names of the column of parameter cofactors to use as a cofactor</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>zero</code></td>
<td>
<p>If the theoretical nest number is under this value, this value wll be used</p>
</td>
</tr>
</table>
<h3>Details</h3>

<p>map_phenology generates a likelihood map.
</p>


<h3>Value</h3>

<p>Display a likelihood map
</p>


<h3>Author(s)</h3>

<p>Marc Girondot <a href="mailto:marc.girondot@gmail.com">marc.girondot@gmail.com</a>
</p>


<h3>See Also</h3>

<p>Other Phenology model: 
<code>AutoFitPhenology()</code>,
<code>BE_to_LBLE()</code>,
<code>Gratiot</code>,
<code>LBLE_to_BE()</code>,
<code>LBLE_to_L()</code>,
<code>L_to_LBLE()</code>,
<code>MarineTurtles_2002</code>,
<code>MinBMinE_to_Min()</code>,
<code>adapt_parameters()</code>,
<code>add_SE()</code>,
<code>add_phenology()</code>,
<code>extract_result()</code>,
<code>fit_phenology()</code>,
<code>likelihood_phenology()</code>,
<code>logLik.phenology()</code>,
<code>map_Gratiot</code>,
<code>par_init()</code>,
<code>phenology()</code>,
<code>phenology2fitRMU()</code>,
<code>phenology_MHmcmc()</code>,
<code>phenology_MHmcmc_p()</code>,
<code>plot.phenology()</code>,
<code>plot.phenologymap()</code>,
<code>plot_delta()</code>,
<code>plot_phi()</code>,
<code>print.phenology()</code>,
<code>print.phenologymap()</code>,
<code>print.phenologyout()</code>,
<code>remove_site()</code>,
<code>result_Gratiot</code>,
<code>result_Gratiot1</code>,
<code>result_Gratiot2</code>,
<code>result_Gratiot_Flat</code>,
<code>result_Gratiot_mcmc</code>,
<code>summary.phenology()</code>,
<code>summary.phenologymap()</code>,
<code>summary.phenologyout()</code>
</p>


<h3>Examples</h3>

<pre><code class="language-R">library("phenology")
# Read a file with data
data(Gratiot)
# Generate a formatted list nammed data_Gratiot 
data_Gratiot &lt;- add_phenology(Gratiot, name = "Complete", 
		reference = as.Date("2001-01-01"), format = "%d/%m/%Y")
# Generate initial points for the optimisation
parg &lt;- par_init(data_Gratiot, fixed.parameters = NULL)
# Run the optimisation
## Not run: 
result_Gratiot &lt;- fit_phenology(data = data_Gratiot, 
		fitted.parameters = parg, fixed.parameters = NULL)

## End(Not run)
data(result_Gratiot)
# Extract the fitted parameters
parg1 &lt;- extract_result(result_Gratiot)
# Add constant Alpha and Tau values 
# [day d amplitude=(Alpha+Nd*Beta)^Tau with Nd being the number of counts for day d]
pfixed &lt;- c(parg1, Alpha=0, Tau=1)
pfixed &lt;- pfixed[-which(names(pfixed)=="Theta")]
# The only fitted parameter will be Beta
parg2 &lt;- c(Beta=0.5, parg1["Theta"])
# Generate a likelihood map 
# [default Phi=seq(from=0.1, to=20, length.out=100) but it is very long]
# Take care, it takes 20 hours ! The data map_Gratiot has the result
## Not run: 
library(phenology)
map_Gratiot &lt;- map_phenology(data = data_Gratiot, 
                             Phi = seq(from=0.1, to=30, length.out=100), 
		                          fitted.parameters = parg2, 
		                          fixed.parameters = pfixed)

## End(Not run)
data(map_Gratiot)
# Plot the map
plot(map_Gratiot, col = heat.colors(128))
# Plot the min(-Ln L) for Phi varying at any delta value
plot_phi(map = map_Gratiot)
# Plot the min(-Ln L) for Delta varying with Phi equal to the value for maximum likelihood
plot_delta(map = map_Gratiot)
# Plot the min(-Ln L) for Delta varying with Phi the nearest to 15
plot_delta(map = map_Gratiot, Phi = 15)
</code></pre>


</div>