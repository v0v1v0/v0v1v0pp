<div class="container">

<table style="width: 100%;"><tr>
<td>plotBranchbyTrait</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>Plot branch colors by a quantitative trait or value</h2>

<h3>Description</h3>

<p>Function plots a tree with branches colored by the value for a quantitative trait or probability, by various methods.
</p>


<h3>Usage</h3>

<pre><code class="language-R">plotBranchbyTrait(tree, x, mode=c("edges","tips","nodes"), palette="rainbow", 
   legend=TRUE, xlims=NULL, ...)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>tree</code></td>
<td>
<p>an object of class <code>"phylo"</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>x</code></td>
<td>
<p>either a vector of states for the edges, tips, or nodes of the tree (for <code>mode="edges"</code>, <code>"tips"</code>, and <code>"nodes"</code>, respectively).</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>mode</code></td>
<td>
<p>string indicating plotting mode. <code>mode="edges"</code>, the default, requires that the mapping state of each edge in the tree should be provided. <code>mode="tips"</code> takes the tip values and estimates the state at each internal node. The mapped character value along each branch is the average of the nodes subtending that branch. <code>mode="nodes"</code> similar to <code>"tips"</code>, except that the node values are provided instead of estimated.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>palette</code></td>
<td>
<p>color palette to translate character values to color. Options are presently <code>"rainbow"</code> (the default), <code>"heat.colors"</code>, and <code>"gray"</code>. <code>palette</code> can also be a function produced by <code>colorRampPalette</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>legend</code></td>
<td>
<p>can be a logical value (<code>TRUE</code> or <code>FALSE</code>) or a numeric value greater than 0. In the latter case the numeric value gives the length of the plotted legend, which also acts as a scale bar for the branch lengths of the tree.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>xlims</code></td>
<td>
<p>range for the translation map between trait values and the color map. Should be inclusive of all the values in <code>x</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>...</code></td>
<td>
<p>other optional arguments to be passed to <code>plot.phylo</code> - pretty much all arguments are available. In addition, there <code>plotBranchbyTrait</code> has the following additional optional arguments: <code>tol</code> a small tolerance value to be added to the range of <code>x</code>; <code>prompt</code> for <code>legend=TRUE</code>, a logical value indicating whether to prompt for the position of the legend (or not) - the default is to put the legend in the lower left hand size of the plot; <code>title</code> for <code>legend=TRUE</code>, the title of the legend; and <code>digits</code> for <code>legend=TRUE</code>, the number of digits in the quantitative scale of the legend. Finally, <code>cex</code> can be supplied as either a single numeric value, or as a vector of two different values. If the latter is true than the second element of <code>cex</code> will be passed internally to the function <code>add.color.bar</code>.</p>
</td>
</tr>
</table>
<h3>Details</h3>

<p>Unlike most other tree plotting functions in <span class="pkg">phytools</span>, this function calls <code>plot.phylo</code> (not <code>plotSimmap</code>) internally.
</p>
<p>Note that if <code>prompt=TRUE</code>, the function will prompt for the position of the legend.
</p>


<h3>Value</h3>

<p>Plots a phylogeny.
</p>


<h3>Author(s)</h3>

<p>Liam Revell <a href="mailto:liam.revell@umb.edu">liam.revell@umb.edu</a></p>


<h3>References</h3>

<p>Revell, L. J. (2024) phytools 2.0: an updated R ecosystem for phylogenetic comparative methods (and other things). <em>PeerJ</em>, <b>12</b>, e16505.
</p>


</div>