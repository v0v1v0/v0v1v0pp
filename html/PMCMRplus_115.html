<div class="container">

<table style="width: 100%;"><tr>
<td>kruskalTest</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>Kruskal-Wallis Rank Sum Test</h2>

<h3>Description</h3>

<p>Performs a Kruskal-Wallis rank sum test.
</p>


<h3>Usage</h3>

<pre><code class="language-R">kruskalTest(x, ...)

## Default S3 method:
kruskalTest(x, g, dist = c("Chisquare", "KruskalWallis", "FDist"), ...)

## S3 method for class 'formula'
kruskalTest(
  formula,
  data,
  subset,
  na.action,
  dist = c("Chisquare", "KruskalWallis", "FDist"),
  ...
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>x</code></td>
<td>
<p>a numeric vector of data values, or a list of numeric data
vectors.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>...</code></td>
<td>
<p>further arguments to be passed to or from methods.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>g</code></td>
<td>
<p>a vector or factor object giving the group for the
corresponding elements of <code>"x"</code>.
Ignored with a warning if <code>"x"</code> is a list.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>dist</code></td>
<td>
<p>the test distribution. Defaults's to <code>"Chisquare"</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>formula</code></td>
<td>
<p>a formula of the form <code>response ~ group</code> where
<code>response</code> gives the data values and <code>group</code> a vector or
factor of the corresponding groups.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>data</code></td>
<td>
<p>an optional matrix or data frame (or similar: see
<code>model.frame</code>) containing the variables in the
formula <code>formula</code>.  By default the variables are taken from
<code>environment(formula)</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>subset</code></td>
<td>
<p>an optional vector specifying a
subset of observations to be used.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>na.action</code></td>
<td>
<p>a function which indicates what should happen when
the data contain <code>NA</code>s.  Defaults to <code>getOption("na.action")</code>.</p>
</td>
</tr>
</table>
<h3>Details</h3>

<p>For one-factorial designs with non-normally distributed
residuals the Kruskal-Wallis rank sum test can be performed to test
the H<code class="reqn">_0: F_1(x) = F_2(x) = \ldots = F_k(x)</code> against
the H<code class="reqn">_\mathrm{A}: F_i (x) \ne F_j(x)~ (i \ne j)</code> with at least
one strict inequality.
</p>
<p>Let <code class="reqn">R_{ij}</code> be the joint rank of <code class="reqn">X_{ij}</code>,
with <code class="reqn">R_{(1)(1)} = 1, \ldots, R_{(n)(n)} = N, ~~ N = \sum_{i=1}^k n_i</code>,
The test statistic is calculated as
</p>
<p style="text-align: center;"><code class="reqn">
 H = \sum_{i=1}^k n_i \left(\bar{R}_i - \bar{R}\right) / \sigma_R,
</code>
</p>

<p>with the mean rank of the <code class="reqn">i</code>-th group
</p>
<p style="text-align: center;"><code class="reqn">
\bar{R}_i = \sum_{j = 1}^{n_{i}} R_{ij} / n_i,
</code>
</p>

<p>the expected value
</p>
<p style="text-align: center;"><code class="reqn">
 \bar{R} = \left(N +1\right) / 2
</code>
</p>

<p>and the expected variance as
</p>
<p style="text-align: center;"><code class="reqn">
 \sigma_R^2 = N \left(N + 1\right) / 12.
</code>
</p>

<p>In case of ties the statistic <code class="reqn">H</code> is divided by
<code class="reqn">\left(1 - \sum_{i=1}^r t_i^3 - t_i \right) / \left(N^3 - N\right)</code>
</p>
<p>According to Conover and Imam (1981), the statistic <code class="reqn">H</code> is related
to the <code class="reqn">F</code>-quantile as
</p>
<p style="text-align: center;"><code class="reqn">
 F = \frac{H / \left(k - 1\right)}
     {\left(N - 1 - H\right) / \left(N - k\right)}
</code>
</p>

<p>which is equivalent to a one-way ANOVA F-test using rank transformed data
(see examples).
</p>
<p>The function provides three different <code>dist</code> for <code class="reqn">p</code>-value estimation:
</p>

<dl>
<dt>Chisquare</dt>
<dd>
<p><code class="reqn">p</code>-values are computed from the <code>Chisquare</code>
distribution with <code class="reqn">v = k - 1</code> degree of freedom.</p>
</dd>
<dt>KruskalWallis</dt>
<dd>
<p><code class="reqn">p</code>-values are computed from the
<code>pKruskalWallis</code> of the package <span class="pkg">SuppDists</span>.</p>
</dd>
<dt>FDist</dt>
<dd>
<p><code class="reqn">p</code>-values are computed from the <code>FDist</code> distribution
with <code class="reqn">v_1 = k-1, ~ v_2 = N -k</code> degree of freedom.</p>
</dd>
</dl>
<h3>Value</h3>

<p>A list with class <code>"htest"</code> containing the following components:
</p>

<dl>
<dt>method</dt>
<dd>
<p>a character string indicating what type of test was performed.</p>
</dd>
<dt>data.name</dt>
<dd>
<p>a character string giving the name(s) of the data.</p>
</dd>
<dt>statistic</dt>
<dd>
<p>the estimated quantile of the test statistic.</p>
</dd>
<dt>p.value</dt>
<dd>
<p>the p-value for the test.</p>
</dd>
<dt>parameter</dt>
<dd>
<p>the parameters of the test statistic, if any.</p>
</dd>
<dt>alternative</dt>
<dd>
<p>a character string describing the alternative hypothesis.</p>
</dd>
<dt>estimates</dt>
<dd>
<p>the estimates, if any.</p>
</dd>
<dt>null.value</dt>
<dd>
<p>the estimate under the null hypothesis, if any.</p>
</dd>
</dl>
<h3>References</h3>

<p>Conover, W.J., Iman, R.L. (1981) Rank Transformations as a Bridge
Between Parametric and Nonparametric Statistics.
<em>Am Stat</em> <b>35</b>, 124–129.
</p>
<p>Kruskal, W.H., Wallis, W.A. (1952) Use of Ranks in One-Criterion Variance Analysis.
<em>J Am Stat Assoc</em> <b>47</b>, 583–621.
</p>
<p>Sachs, L. (1997) <em>Angewandte Statistik</em>. Berlin: Springer.
</p>


<h3>See Also</h3>

<p><code>kruskal.test</code>, <code>pKruskalWallis</code>,
<code>Chisquare</code>, <code>FDist</code>
</p>


<h3>Examples</h3>

<pre><code class="language-R">## Hollander &amp; Wolfe (1973), 116.
## Mucociliary efficiency from the rate of removal of dust in normal
## subjects, subjects with obstructive airway disease, and subjects
## with asbestosis.
x &lt;- c(2.9, 3.0, 2.5, 2.6, 3.2) # normal subjects
y &lt;- c(3.8, 2.7, 4.0, 2.4)      # with obstructive airway disease
z &lt;- c(2.8, 3.4, 3.7, 2.2, 2.0) # with asbestosis
g &lt;- factor(x = c(rep(1, length(x)),
                   rep(2, length(y)),
                   rep(3, length(z))),
             labels = c("ns", "oad", "a"))
dat &lt;- data.frame(
   g = g,
   x = c(x, y, z))

## AD-Test
adKSampleTest(x ~ g, data = dat)

## BWS-Test
bwsKSampleTest(x ~ g, data = dat)

## Kruskal-Test
## Using incomplete beta approximation
kruskalTest(x ~ g, dat, dist="KruskalWallis")
## Using chisquare distribution
kruskalTest(x ~ g, dat, dist="Chisquare")

## Not run: 
## Check with kruskal.test from R stats
kruskal.test(x ~ g, dat)

## End(Not run)
## Using Conover's F
kruskalTest(x ~ g, dat, dist="FDist")

## Not run: 
## Check with aov on ranks
anova(aov(rank(x) ~ g, dat))
## Check with oneway.test
oneway.test(rank(x) ~ g, dat, var.equal = TRUE)

## End(Not run)

## Median Test asymptotic
medianTest(x ~ g, dat)

## Median Test with simulated p-values
set.seed(112)
medianTest(x ~ g, dat, simulate.p.value = TRUE)
</code></pre>


</div>