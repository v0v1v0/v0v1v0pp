<div class="container">

<table style="width: 100%;"><tr>
<td>calcOptimalClustering</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>Calculation of the optimal clustering</h2>

<h3>Description</h3>

<p>Calculates the optimal clustering.</p>


<h3>Usage</h3>

<pre><code class="language-R">calcOptimalClustering(disSimObj, maxNClusters=NULL, useLS=F)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>disSimObj</code></td>
<td>
<p>A dissimilarity matrix (in vector format, as the output of the function calcDissimilarityMatrix(), and as described in ?calcDissimilarityMatrix) or a list of dissimilarity matrix, to combine the output of several runs of the MCMC.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>maxNClusters</code></td>
<td>
<p>Set the maximum number of clusters allowed. This is set to the maximum number explored.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>useLS</code></td>
<td>
<p>This is set to FALSE by default. If it is set to TRUE then the least-squares method is used for the calculation of the optimal clustering, as described in Molitor et al (2010). Note that this is set to TRUE by default if disSimObj$onlyLS is set to TRUE.</p>
</td>
</tr>
</table>
<h3>Value</h3>

<p>the output is a list with the following elements. This is an object of type clusObj.
</p>
<table>
<tr style="vertical-align: top;">
<td><code>clusObjRunInfoObj</code></td>
<td>
<p>Details on this run. An object of type runInfoObj.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>clusterSizes</code></td>
<td>
<p>Cluster sizes.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>clusteringPred</code></td>
<td>
<p>The predicted cluster memberships for the predicted scenarios.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>clusObjDisSimMat</code></td>
<td>
<p>Dissimilarity matrix.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>clustering</code></td>
<td>
<p>Cluster memberships.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>nClusters</code></td>
<td>
<p>Optimal number of clusters.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>avgSilhouetteWidth</code></td>
<td>
<p>Average silhouette width when using medoids method for clustering.</p>
</td>
</tr>
</table>
<h3>Authors</h3>

<p>David Hastie, Department of Epidemiology and Biostatistics, Imperial College London, UK
</p>
<p>Silvia Liverani, Department of Epidemiology and Biostatistics, Imperial College London and MRC Biostatistics Unit, Cambridge, UK
</p>
<p>Maintainer: Silvia Liverani &lt;liveranis@gmail.com&gt;
</p>


<h3>References</h3>

<p>Silvia Liverani, David I. Hastie, Lamiae Azizi, Michail Papathomas, Sylvia Richardson (2015). PReMiuM: An R Package for Profile Regression Mixture Models Using Dirichlet Processes. Journal of Statistical Software, 64(7), 1-30. <a href="https://doi.org/10.18637/jss.v064.i07">doi:10.18637/jss.v064.i07</a>.
</p>


<h3>Examples</h3>

<pre><code class="language-R">## Not run: 
generateDataList &lt;- clusSummaryBernoulliDiscrete()
inputs &lt;- generateSampleDataFile(generateDataList)
runInfoObj&lt;-profRegr(yModel=inputs$yModel, xModel=inputs$xModel, 
    nSweeps=10, nBurn=20, data=inputs$inputData, output="output", 
    covNames=inputs$covNames, nClusInit=15)

dissimObj&lt;-calcDissimilarityMatrix(runInfoObj)
clusObj&lt;-calcOptimalClustering(dissimObj)

## End(Not run)
</code></pre>


</div>