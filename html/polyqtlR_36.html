<div class="container">

<table style="width: 100%;"><tr>
<td>singleMarkerRegression</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>Run a single marker regression using marker dosages</h2>

<h3>Description</h3>

<p>Function to run a single marker regression using marker dosages
</p>


<h3>Usage</h3>

<pre><code class="language-R">singleMarkerRegression(
  dosage_matrix,
  Phenotype.df,
  genotype.ID,
  trait.ID,
  maplist = NULL,
  perm_test = FALSE,
  N_perm = 1000,
  alpha = 0.05,
  ncores = 1,
  return_R2 = FALSE,
  log = NULL
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>dosage_matrix</code></td>
<td>
<p>An integer matrix with markers in rows and individuals in columns.
All markers in this matrix will be tested for association with the trait.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>Phenotype.df</code></td>
<td>
<p>A data.frame containing phenotypic values</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>genotype.ID</code></td>
<td>
<p>The colname of <code>Phenotype.df</code> that contains the population identifiers (F1 names) (must be a colname of <code>Phenotype.df</code>)</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>trait.ID</code></td>
<td>
<p>The colname of <code>Phenotype.df</code> that contains the response variable to use in the model (must be a colname of <code>Phenotype.df</code>)</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>maplist</code></td>
<td>
<p>Option to include linkage map in the format returned by <code>MDSMap_from_list</code> from <code>polymapR</code>. If maplist is
not specified (by default <code>NULL</code>) then no ordering of markers from dosage-matrix is performed. Note that all markers in dosage_matrix are tested;
markers with dosages that were not on the maplist will be assigned unordered to linkage group 0 with dummy cM positions 1,2,3 etc.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>perm_test</code></td>
<td>
<p>Logical, by default <code>FALSE</code>. If <code>TRUE</code>, a permutation test will be performed to determine a
genome-wide significance threshold.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>N_perm</code></td>
<td>
<p>Integer. The number of permutations to run if <code>perm_test</code> is <code>TRUE</code>; by default this is 1000.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>alpha</code></td>
<td>
<p>Numeric. The P-value to be used in the selection of a threshold if <code>perm_test</code> is <code>TRUE</code>;
by default 0.05 (i.e. the 0.95 quantile).</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>ncores</code></td>
<td>
<p>Number of cores to use if parallel processing required. Works both for Windows and UNIX (using <code>doParallel</code>).
Use <code>parallel::detectCores()</code> to find out how many cores you have available.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>return_R2</code></td>
<td>
<p>Should the (adjusted) R2 of the model fit also be determined?</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>log</code></td>
<td>
<p>Character string specifying the log filename to which standard output should be written. If <code>NULL</code> log is send to stdout.</p>
</td>
</tr>
</table>
<h3>Value</h3>

<p>A list containing the following components:
</p>

<dl>
<dt>QTL.res</dt>
<dd>
<p> The -log(p) of the model fit per marker are returned as "LOD" scores, although "LOP" would have been a better description.
If requested, R2 values are also returned in column "R2adj"</p>
</dd>
<dt>Perm.res</dt>
<dd>
<p> The results of the permutation test if performed, otherwise <code>NULL</code></p>
</dd>
<dt>Map</dt>
<dd>
<p> The linkage map if provided, otherwise <code>NULL</code></p>
</dd>
<dt>LG_names</dt>
<dd>
<p>Names of the linkage groups, if a map was provided, otherwise <code>NULL</code></p>
</dd>
</dl>
<h3>Examples</h3>

<pre><code class="language-R">data("SNP_dosages.4x","BLUEs.pheno")
Trait_1.smr &lt;- singleMarkerRegression(dosage_matrix = SNP_dosages.4x,
Phenotype.df = BLUEs.pheno,genotype.ID = "Geno",trait.ID = "BLUE")
</code></pre>


</div>