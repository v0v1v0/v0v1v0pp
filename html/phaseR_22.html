<div class="container">

<table style="width: 100%;"><tr>
<td>flowField</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>Flow field</h2>

<h3>Description</h3>

<p>Plots the flow or velocity field for a one- or two-dimensional autonomous ODE
system.
</p>


<h3>Usage</h3>

<pre><code class="language-R">flowField(
  deriv,
  xlim,
  ylim,
  parameters = NULL,
  system = "two.dim",
  points = 21,
  col = "gray",
  arrow.type = "equal",
  arrow.head = 0.05,
  frac = 1,
  add = TRUE,
  state.names = if (system == "two.dim") c("x", "y") else "y",
  xlab = if (system == "two.dim") state.names[1] else "t",
  ylab = if (system == "two.dim") state.names[2] else state.names[1],
  ...
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>deriv</code></td>
<td>
<p>A function computing the derivative at a point for the ODE
system to be analysed. Discussion of the required format of these functions
can be found in the package vignette, or in the help file for the
function <code>ode</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>xlim</code></td>
<td>
<p>In the case of a two-dimensional system, this sets the limits of
the first dependent variable in which gradient reflecting line segments
should be plotted. In the case of a one-dimensional system, this sets the
limits of the independent variable in which these line segments should be
plotted. Should be a <code>numeric</code> <code>vector</code>
of <code>length</code> two.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>ylim</code></td>
<td>
<p>In the case of a two-dimensional system this sets the limits of
the second dependent variable in which gradient reflecting line segments
should be plotted. In the case of a one-dimensional system, this sets the
limits of the dependent variable in which these line segments should be
plotted. Should be a <code>numeric</code> <code>vector</code>
of <code>length</code> two.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>parameters</code></td>
<td>
<p>Parameters of the ODE system, to be passed to <code>deriv</code>.
Supplied as a <code>numeric</code> <code>vector</code>; the
order of the parameters can be found from the <code>deriv</code> file. Defaults to
<code>NULL</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>system</code></td>
<td>
<p>Set to either <code>"one.dim"</code> or <code>"two.dim"</code> to indicate
the type of system being analysed. Defaults to <code>"two.dim"</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>points</code></td>
<td>
<p>Sets the density of the line segments to be plotted;
<code>points</code> segments will be plotted in the x and y directions. Fine tuning
here, by shifting <code>points</code> up and down, allows for the creation of more
aesthetically pleasing plots. Defaults to <code>11</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>col</code></td>
<td>
<p>Sets the colour of the plotted line segments. Should be a
<code>character</code> <code>vector</code> of
<code>length</code> one. Will be reset accordingly if it is of the
wrong <code>length</code>. Defaults to <code>"gray"</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>arrow.type</code></td>
<td>
<p>Sets the type of line segments plotted. If set to
<code>"proportional"</code> the <code>length</code> of the line segments
reflects the magnitude of the derivative. If set to <code>"equal"</code> the line
segments take equal lengths, simply reflecting the gradient of the
derivative(s). Defaults to <code>"equal"</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>arrow.head</code></td>
<td>
<p>Sets the length of the arrow heads. Passed to
<code>arrows</code>. Defaults to <code>0.05</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>frac</code></td>
<td>
<p>Sets the fraction of the theoretical maximum length line
segments can take without overlapping, that they can actually attain. In
practice, <code>frac</code> can be set to greater than 1 without line segments
overlapping. Fine tuning here assists the creation of aesthetically pleasing
plots. Defaults to <code>1</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>add</code></td>
<td>
<p>Logical. If <code>TRUE</code>, the flow field is added to an existing
plot. If <code>FALSE</code>, a new plot is created. Defaults to <code>TRUE</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>state.names</code></td>
<td>
<p>The state names for <code>ode</code> functions
that do not use positional states.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>xlab</code></td>
<td>
<p>Label for the x-axis of the resulting plot.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>ylab</code></td>
<td>
<p>Label for the y-axis of the resulting plot.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>...</code></td>
<td>
<p>Additional arguments to be passed to either
<code>plot</code> or <code>arrows</code>.</p>
</td>
</tr>
</table>
<h3>Value</h3>

<p>Returns a <code>list</code> with the following components (the
exact make up is dependent on the value of <code>system</code>):
</p>
<table>
<tr style="vertical-align: top;">
<td><code>add</code></td>
<td>
<p>As per input.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>arrow.head</code></td>
<td>
<p>As per input.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>arrow.type</code></td>
<td>
<p>As per input.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>col</code></td>
<td>
<p>As per input, but with possible editing if a
<code>character</code> <code>vector</code> of the wrong
<code>length</code> was supplied.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>deriv</code></td>
<td>
<p>As per input.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>dx</code></td>
<td>
<p>A <code>numeric</code> <code>matrix</code>. In the
case of a two-dimensional system, the values of the derivative of the first
dependent derivative at all evaluated points.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>dy</code></td>
<td>
<p>A <code>numeric</code> <code>matrix</code>. In the
case of a two-dimensional system, the values of the derivative of the second
dependent variable at all evaluated points. In the case of a one-dimensional
system, the values of the derivative of the dependent variable at all
evaluated points.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>frac</code></td>
<td>
<p>As per input.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>parameters</code></td>
<td>
<p>As per
input.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>points</code></td>
<td>
<p>As per input.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>system</code></td>
<td>
<p>As per input.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>x</code></td>
<td>
<p>A <code>numeric</code> <code>vector</code>. In the
case of a two-dimensional system, the values of the first dependent variable
at which the derivatives were computed. In the case of a one-dimensional
system, the values of the independent variable at which the derivatives were
computed.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>xlab</code></td>
<td>
<p>As per input.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>xlim</code></td>
<td>
<p>As per input.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>y</code></td>
<td>
<p>A <code>numeric</code> <code>vector</code>. In the
case of a two-dimensional system, the values of the second dependent variable
at which the derivatives were computed. In the case of a one-dimensional
system, the values of the dependent variable at which the derivatives were
computed.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>ylab</code></td>
<td>
<p>As per input.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>ylim</code></td>
<td>
<p>As per input.</p>
</td>
</tr>
</table>
<h3>Author(s)</h3>

<p>Michael J Grayling
</p>


<h3>See Also</h3>

<p><code>arrows</code>, <code>plot</code>
</p>


<h3>Examples</h3>

<pre><code class="language-R"># Plot the flow field, nullclines and several trajectories for the
# one-dimensional autonomous ODE system logistic
logistic_flowField  &lt;- flowField(logistic,
                                 xlim       = c(0, 5),
                                 ylim       = c(-1, 3),
                                 parameters = c(1, 2),
                                 points     = 21,
                                 system     = "one.dim",
                                 add        = FALSE)
logistic_nullclines &lt;- nullclines(logistic,
                                  xlim       = c(0, 5),
                                  ylim       = c(-1, 3),
                                  parameters = c(1, 2),
                                  system     = "one.dim")
logistic_trajectory &lt;- trajectory(logistic,
                                  y0         = c(-0.5, 0.5, 1.5, 2.5),
                                  tlim       = c(0, 5),
                                  parameters = c(1, 2),
                                  system     = "one.dim")

# Plot the velocity field, nullclines and several trajectories for the
# two-dimensional autonomous ODE system simplePendulum
simplePendulum_flowField  &lt;- flowField(simplePendulum,
                                       xlim       = c(-7, 7),
                                       ylim       = c(-7, 7),
                                       parameters = 5,
                                       points     = 19,
                                       add        = FALSE)
y0                        &lt;- matrix(c(0, 1, 0, 4, -6, 1, 5, 0.5, 0, -3),
                                    5, 2, byrow = TRUE)

simplePendulum_nullclines &lt;- nullclines(simplePendulum,
                                        xlim       = c(-7, 7),
                                        ylim       = c(-7, 7),
                                        parameters = 5,
                                        points     = 500)

simplePendulum_trajectory &lt;- trajectory(simplePendulum,
                                        y0         = y0,
                                        tlim       = c(0, 10),
                                        parameters = 5)
</code></pre>


</div>