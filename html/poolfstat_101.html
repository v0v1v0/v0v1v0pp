<div class="container">

<table style="width: 100%;"><tr>
<td>vcf2pooldata</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>Convert a VCF file into a pooldata object.</h2>

<h3>Description</h3>

<p>Convert VCF files into a pooldata object.
</p>


<h3>Usage</h3>

<pre><code class="language-R">vcf2pooldata(
  vcf.file = "",
  poolsizes = NA,
  poolnames = NA,
  min.cov.per.pool = -1,
  min.rc = 1,
  max.cov.per.pool = 1e+06,
  min.maf = -1,
  remove.indels = FALSE,
  min.dist.from.indels = 0,
  nlines.per.readblock = 1e+06,
  verbose = TRUE
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>vcf.file</code></td>
<td>
<p>The name (or a path) of the Popoolation sync file (might be in compressed format)</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>poolsizes</code></td>
<td>
<p>A numeric vector with haploid pool sizes</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>poolnames</code></td>
<td>
<p>A character vector with the names of pool</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>min.cov.per.pool</code></td>
<td>
<p>Minimal allowed read count (per pool). If at least one pool is not covered by at least min.cov.perpool reads, the position is discarded</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>min.rc</code></td>
<td>
<p>Minimal allowed read count per base (options silenced for VarScan vcf). Bases covered by less than min.rc reads are discarded and considered as sequencing error. For instance, if nucleotides A, C, G and T are covered by respectively 100, 15, 0 and 1 over all the pools, setting min.rc to 0 will lead to discard the position (the polymorphism being considered as tri-allelic), while setting min.rc to 1 (or 2, 3..14) will make the position be considered as a SNP with two alleles A and C (the only read for allele T being disregarded). For VarScan vcf, markers with more than one alternative allele are discarded because the VarScan AD field only contains one alternate read count.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>max.cov.per.pool</code></td>
<td>
<p>Maximal allowed read count (per pool). If at least one pool is covered by more than min.cov.perpool reads, the position is discarded</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>min.maf</code></td>
<td>
<p>Minimal allowed Minor Allele Frequency (computed from the ratio overall read counts for the reference allele over the read coverage)</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>remove.indels</code></td>
<td>
<p>Remove indels identified using the number of characters of the alleles in the REF or ALT fields (i.e., if at least one allele is more than 1 character, the position is discarded)</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>min.dist.from.indels</code></td>
<td>
<p>Remove SNPs within min.dist.from.indels from an indel i.e. SNP with position p verifying (indel.pos-min.dist)&lt;=p&lt;=(indel.pos+min.dist+l.indels-1) where l.indel=length of the ref. indel allele. If min.dist.from.indels&gt;0, INDELS are also removed (i.e., remove.indels is set to TRUE).</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>nlines.per.readblock</code></td>
<td>
<p>Number of Lines read simultaneously. Should be adapted to the available RAM.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>verbose</code></td>
<td>
<p>If TRUE extra information is printed on the terminal</p>
</td>
</tr>
</table>
<h3>Details</h3>

<p>Genotype format in the vcf file for each pool is assumed to contain either i) an AD field containing allele counts separated by a comma (as produced by popular software such as GATK or samtools/bcftools) or ii) both a RD (reference allele count) and a AD (alternate allele count) as obtained with the VarScan mpileup2snp program (when run with the –output-vcf option). The underlying format is automatically detected by the function. For VarScan generated vcf, it should be noticed that SNPs with more than one alternate allele are discarded (because only a single count is then reported in the AD fields) making the min.rc unavailable. The VarScan –min-reads2 option might replace to some extent this functionality although SNP where the two major alleles in the Pool-Seq data are different from the reference allele (e.g., expected to be more frequent when using a distantly related reference genome for mapping) will be disregarded.
</p>


<h3>Value</h3>

<p>A pooldata object containing 7 elements:
</p>

<ol>
<li>
<p> "refallele.readcount": a matrix with nsnp rows and npools columns containing read counts for the reference allele (chosen arbitrarily) in each pool
</p>
</li>
<li>
<p> "readcoverage": a matrix with nsnp rows and npools columns containing read coverage in each pool
</p>
</li>
<li>
<p> "snp.info": a matrix with nsnp rows and four columns containing respectively the contig (or chromosome) name (1st column) and position (2nd column) of the SNP; the allele taken as reference in the refallele.readcount matrix (3rd column); and the alternative allele (4th column)
</p>
</li>
<li>
<p> "poolsizes": a vector of length npools containing the haploid pool sizes
</p>
</li>
<li>
<p> "poolnames": a vector of length npools containing the names of the pools
</p>
</li>
<li>
<p> "nsnp": a scalar corresponding to the number of SNPs
</p>
</li>
<li>
<p> "npools": a scalar corresponding to the number of pools
</p>
</li>
</ol>
<h3>Examples</h3>

<pre><code class="language-R"> make.example.files(writing.dir=tempdir())
 pooldata=vcf2pooldata(vcf.file=paste0(tempdir(),"/ex.vcf.gz"),poolsizes=rep(50,15))
</code></pre>


</div>