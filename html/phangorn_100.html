<div class="container">

<table style="width: 100%;"><tr>
<td>getClans</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>Clans, slices and clips</h2>

<h3>Description</h3>

<p>Functions for clanistics to compute clans, slices, clips for unrooted trees
and functions to quantify the fragmentation of trees.
</p>


<h3>Usage</h3>

<pre><code class="language-R">getClans(tree)

getSlices(tree)

getClips(tree, all = TRUE)

getDiversity(tree, x, norm = TRUE, var.names = NULL, labels = "new")

## S3 method for class 'clanistics'
summary(object, ...)

diversity(tree, X)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>tree</code></td>
<td>
<p>An object of class phylo or multiPhylo (getDiversity).</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>all</code></td>
<td>
<p>A logical, return all or just the largest clip.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>x</code></td>
<td>
<p>An object of class phyDat.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>norm</code></td>
<td>
<p>A logical, return Equitability Index (default) or Shannon
Diversity.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>var.names</code></td>
<td>
<p>A vector of variable names.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>labels</code></td>
<td>
<p>see details.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>object</code></td>
<td>
<p>an object for which a summary is desired.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>...</code></td>
<td>
<p>Further arguments passed to or from other methods.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>X</code></td>
<td>
<p>a data.frame</p>
</td>
</tr>
</table>
<h3>Details</h3>

<p>Every split in an unrooted tree defines two complementary clans. Thus for an
unrooted binary tree with <code class="reqn">n</code> leaves there are <code class="reqn">2n - 3</code> edges, and
therefore <code class="reqn">4n - 6</code> clans (including <code class="reqn">n</code> trivial clans containing
only one leave).
</p>
<p>Slices are defined by a pair of splits or tripartitions, which are not
clans. The number of distinguishable slices for a binary tree with <code class="reqn">n</code>
tips is <code class="reqn">2n^2 - 10n + 12</code>.
</p>

<p>cophenetic distance and not by the topology. Namely clips are groups of
leaves for which the maximum pairwise distance is smaller than threshold.

distance within a clip is lower than the distance between any member of the
clip and any other tip.
</p>
<p>A clip is a different type of partition, defining groups of leaves that are
related in terms of evolutionary distances and not only topology.  Namely,
clips are groups of leaves for which all pairwise path-length distances are
smaller than a given threshold value (Lapointe et al. 2010). There exists
different numbers of clips for different thresholds, the largest (and
trivial) one being the whole tree.  There is always a clip containing only
the two leaves with the smallest pairwise distance.
</p>
<p>Clans, slices and clips can be used to characterize how well a vector of
categorial characters (natives/intruders) fit on a tree. We will follow the
definitions of Lapointe et al.(2010).  A complete clan is a clan that
contains all leaves of a given state/color, but can also contain leaves of
another state/color. A clan is homogeneous if it only contains leaves of one
state/color.
</p>
<p><code>getDiversity</code> computes either the <br> Shannon Diversity: <code class="reqn">H =
-\sum_{i=1}^{k}(N_i/N) log(N_i/N), N=\sum_{i=1}^{k} N_i</code> <br> or the <br> Equitability Index: <code class="reqn">E = H /
log(N)</code> <br> where <code class="reqn">N_i</code> are the sizes of the <code class="reqn">k</code> largest homogeneous
clans of intruders.  If the categories of the data can be separated by an
edge of the tree then the E-value will be zero, and maximum equitability
(E=1) is reached if all intruders are in separate clans. getDiversity
computes these Intruder indices for the whole tree, complete clans and
complete slices. Additionally the parsimony scores (p-scores) are reported.
The p-score indicates if the leaves contain only one color (p-score=0), if
the the leaves can be separated by a single split (perfect clan, p-score=1)
or by a pair of splits (perfect slice, p-score=2).
</p>
<p>So far only 2 states are supported (native, intruder), however it is also
possible to recode several states into the native or intruder state using
contrasts, for details see section 2 in vignette("phangorn-specials").
Furthermore unknown character states are coded as ambiguous character, which
can act either as native or intruder minimizing the number of clans or
changes (in parsimony analysis) needed to describe a tree for given data.
</p>
<p>Set attribute labels to "old" for analysis as in Schliep et al. (2010) or to
"new" for names which are more intuitive.
</p>
<p><code>diversity</code> returns a data.frame with the parsimony score for each tree
and each levels of the variables in <code>X</code>. <code>X</code> has to be a
<code>data.frame</code> where each column is a factor and the rownames of <code>X</code>
correspond to the tips of the trees.
</p>



<h3>Value</h3>

<p>getClans, getSlices and getClips return a matrix of partitions, a
matrix of ones and zeros where rows correspond to a clan, slice or clip and
columns to tips. A one indicates that a tip belongs to a certain partition.
<br> getDiversity returns a list with tree object, the first is a data.frame
of the equitability index or Shannon divergence and parsimony scores
(p-score) for all trees and variables. The data.frame has two attributes,
the first is a splits object to identify the taxa of each tree and the
second is a splits object containing all partitions that perfectly fit.
</p>


<h3>Author(s)</h3>

<p>Klaus Schliep <a href="mailto:klaus.schliep@snv.jussieu.fr">klaus.schliep@snv.jussieu.fr</a>
</p>
<p>Francois-Joseph Lapointe <a href="mailto:francois-joseph.lapointe@umontreal.ca">francois-joseph.lapointe@umontreal.ca</a>
</p>


<h3>References</h3>

<p>Lapointe, F.-J., Lopez, P., Boucher, Y., Koenig, J., Bapteste,
E. (2010) Clanistics: a multi-level perspective for harvesting unrooted gene
trees. <em>Trends in Microbiology</em> 18: 341-347
</p>
<p>Wilkinson, M., McInerney, J.O., Hirt, R.P., Foster, P.G., Embley, T.M.
(2007) Of clades and clans: terms for phylogenetic relationships in unrooted
trees. <em>Trends in Ecology and Evolution</em> 22: 114-115
</p>
<p>Schliep, K., Lopez, P., Lapointe F.-J., Bapteste E. (2011) Harvesting
Evolutionary Signals in a Forest of Prokaryotic Gene Trees, <em>Molecular
Biology and Evolution</em> 28(4): 1393-1405
</p>


<h3>See Also</h3>

<p><code>parsimony</code>, Consistency index <code>CI</code>,
Retention index <code>RI</code>, <code>phyDat</code>
</p>


<h3>Examples</h3>

<pre><code class="language-R">
set.seed(111)
tree &lt;- rtree(10)
getClans(tree)
getClips(tree, all=TRUE)
getSlices(tree)

set.seed(123)
trees &lt;- rmtree(10, 20)
X &lt;- matrix(sample(c("red", "blue", "violet"), 100, TRUE, c(.5,.4, .1)),
   ncol=5, dimnames=list(paste('t',1:20, sep=""), paste('Var',1:5, sep="_")))
x &lt;- phyDat(X, type = "USER", levels = c("red", "blue"), ambiguity="violet")
plot(trees[[1]], "u", tip.color = X[trees[[1]]$tip,1])  # intruders are blue

(divTab &lt;- getDiversity(trees, x, var.names=colnames(X)))
summary(divTab)

</code></pre>


</div>