<div class="container">

<table style="width: 100%;"><tr>
<td>pls.regression</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>Multivariate Partial Least Squares Regression</h2>

<h3>Description</h3>

<p>The function <code>pls.regression</code> performs pls multivariate regression (with several response 
variables and several predictor variables) using de Jong's SIMPLS algorithm. This function 
is an adaptation of R. Wehrens' code from the package pls.pcr. 
</p>


<h3>Usage</h3>

<pre><code class="language-R">pls.regression(Xtrain, Ytrain, Xtest=NULL, ncomp=NULL,  unit.weights=TRUE)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>Xtrain</code></td>
<td>
<p>a (ntrain x p) data matrix of predictors. <code>Xtrain</code> may be a matrix or a
data frame. Each row corresponds to an observation and each column to a predictor variable.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>Ytrain</code></td>
<td>
<p>a (ntrain x m) data matrix of responses. <code>Ytrain</code> may be a vector (if m=1), 
a matrix or a data frame. If <code>Ytrain</code> is a matrix or a data frame, each row corresponds 
to an observation and each column to a response variable. If <code>Ytrain</code> is a vector, it 
contains the unique response variable for each observation.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>Xtest</code></td>
<td>
<p>a (ntest x p) matrix containing the predictors for the test data
set. <code>Xtest</code> may also be a
vector of length p (corresponding to only one test observation).</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>ncomp</code></td>
<td>
<p>the number of latent components to be used for regression. If
<code>ncomp</code> is a vector of integers, the regression model is built
successively with each number of components. If <code>ncomp=NULL</code>, the maximal
number of components min(ntrain,p) is chosen.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>unit.weights</code></td>
<td>
<p>if <code>TRUE</code> then the latent components
will be constructed from weight vectors that are standardized to length 1, 
otherwise the weight vectors do not have length 1 but the latent components have
norm 1.</p>
</td>
</tr>
</table>
<h3>Details</h3>

<p>The columns of the data matrices <code>Xtrain</code> and <code>Ytrain</code> must not be centered to have 
mean zero, since centering is performed by the function <code>pls.regression</code> as a preliminary 
step before the SIMPLS algorithm is run. 
</p>
<p>In the original definition of SIMPLS by de Jong (1993), the weight vectors have
length 1. If the weight vectors are standardized to have length 1, 
they satisfy a simple optimality criterion (de Jong, 1993). However, it is
also usual (and computationally efficient) to standardize the latent
components to have length 1. 
</p>
<p>In contrast to the original version found in the package <code>pls.pcr</code>, 
the prediction for the observations from <code>Xtest</code> is performed after
centering the columns of <code>Xtest</code> by substracting the columns means
calculated from <code>Xtrain</code>.
</p>


<h3>Value</h3>

<p>A list with the following components:
</p>
<table>
<tr style="vertical-align: top;">
<td><code>B</code></td>
<td>
<p>the (p x m x length(<code>ncomp</code>)) matrix containing the regression coefficients. Each 
row corresponds to a predictor variable and each column to a response variable. The third
dimension of the matrix <code>B</code> corresponds to the number of PLS components used
to compute the regression coefficients. If <code>ncomp</code> has length 1, <code>B</code>
is just a (p x m) matrix.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>Ypred</code></td>
<td>
<p>the (ntest x m x length(<code>ncomp</code>)) containing the predicted
values of the response variables for the observations from <code>Xtest</code>. The
third dimension of the matrix <code>Ypred</code> corresponds to the number of PLS
components used to compute the regression coefficients. </p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>P</code></td>
<td>
<p>the (p x max(<code>ncomp</code>)) matrix containing the X-loadings.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>Q</code></td>
<td>
<p>the (m x max(<code>ncomp</code>)) matrix containing the Y-loadings.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>T</code></td>
<td>
<p>the (ntrain x max(<code>ncomp</code>)) matrix containing the X-scores (latent components)</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>R</code></td>
<td>
<p>the (p x max(<code>ncomp</code>)) matrix containing the weights used to construct the
latent components.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>meanX</code></td>
<td>
<p>the p-vector containing the means of the columns of <code>Xtrain</code>.</p>
</td>
</tr>
</table>
<h3>Author(s)</h3>

<p>Anne-Laure Boulesteix 
(<a href="https://www.ibe.med.uni-muenchen.de/mitarbeiter/professoren/boulesteix/index.html">https://www.ibe.med.uni-muenchen.de/mitarbeiter/professoren/boulesteix/index.html</a>) 
and 
Korbinian Strimmer (<a href="https://strimmerlab.github.io/korbinian.html">https://strimmerlab.github.io/korbinian.html</a>).
</p>
<p>Adapted in part from 
pls.pcr code by R. Wehrens (in a former version of the 'pls' package
<a href="https://CRAN.R-project.org/package=pls">https://CRAN.R-project.org/package=pls</a>). 
</p>


<h3>References</h3>

<p>S. de Jong (1993). SIMPLS: an alternative approach to partial least squares 
regression, Chemometrics Intell. Lab. Syst. <b>18</b>, 251–263.
</p>
<p>C. J. F. ter Braak and S. de Jong (1993). The objective function of partial
least squares regression, Journal of Chemometrics <b>12</b>, 41–54.
</p>


<h3>See Also</h3>

<p><code>pls.lda</code>, <code>TFA.estimate</code>,
<code>pls.regression.cv</code>.</p>


<h3>Examples</h3>

<pre><code class="language-R"># load plsgenomics library
library(plsgenomics)

# load the Ecoli data
data(Ecoli)

# perform pls regression
# with unit latent components
pls.regression(Xtrain=Ecoli$CONNECdata,Ytrain=Ecoli$GEdata,Xtest=Ecoli$CONNECdata,
			ncomp=1:3,unit.weights=FALSE)

# with unit weight vectors
pls.regression(Xtrain=Ecoli$CONNECdata,Ytrain=Ecoli$GEdata,Xtest=Ecoli$CONNECdata,
			ncomp=1:3,unit.weights=TRUE)


</code></pre>


</div>