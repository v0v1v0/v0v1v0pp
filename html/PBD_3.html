<div class="container">

<table style="width: 100%;"><tr>
<td>pbd_bootstrap</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>Bootstrap analysis under protracted birth-death model of diversification</h2>

<h3>Description</h3>

<p>Likelihood maximization for protracted birth-death model of diversification followed by simulations of the model using the maximum
likelihood parameter estimates to compute an estimate of the error in these estimates and to assess the goodness-of-fit of the model by comparing
maximum likelihoods of the simulated data sets to the maximum likelihood of the real data set.</p>


<h3>Usage</h3>

<pre><code class="language-R">pbd_bootstrap(
   brts,
   initparsopt = c(0.2,0.1,1),
   idparsopt = 1:length(initparsopt),
   idparsfix = NULL,
   parsfix = NULL,
   exteq = (length(initparsopt) &lt; 4),
   parsfunc = c(function(t,pars) {pars[1]},function(t,pars) {pars[2]},
function(t,pars) {pars[3]}, function(t,pars) {pars[4]}),
   missnumspec = 0,
   cond = 1,
   btorph = 0,
   soc = 2,
   plotltt = 1,
   methode = "lsoda",
   n_low = 0,
   n_up = 0,
   tol = c(1E-4, 1E-4, 1E-6),
   maxiter = 1000 * round((1.25)^length(idparsopt)),
   endmc = 100,
   seed = 42
)</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>brts</code></td>
<td>
<p>A set of branching times of a phylogeny, all positive </p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>initparsopt</code></td>
<td>
<p>The initial values of the parameters that must be optimized</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>idparsopt</code></td>
<td>

<p>The ids of the parameters that must be optimized, e.g. 1:4 for all parameters.
The ids are defined as follows: <br>
id == 1 corresponds to b (speciation-initiation rate) <br>
id == 2 corresponds to mu_1 (extinction rate of good species) <br>
id == 3 corresponds to la_1 (speciation-completion rate) <br>
id == 4 corresponds to mu_2 (extinction rate of incipient species) <br></p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>idparsfix</code></td>
<td>

<p>The ids of the parameters that should not be optimized, e.g. c(2,4) if mu_1 and mu_2
should not be optimized, but only b and la_1. In that case idparsopt must be c(1,3).
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>parsfix</code></td>
<td>
<p> The values of the parameters that should not be optimized </p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>exteq</code></td>
<td>
<p>Sets whether incipient species have the same (1) or different (0) extinction rate as good species.
If exteq = 0, then idparsfix and idparsopt should together have all parameters 1:4
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>parsfunc</code></td>
<td>
<p> Specifies functions how the rates depend on time, default functions are constant functions </p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>missnumspec</code></td>
<td>

<p>The number of species that are in the clade but missing in the phylogeny </p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>cond</code></td>
<td>
<p>Conditioning: <br>
cond == 0 : conditioning on stem or crown age <br>
cond == 1 : conditioning on stem or crown age and non-extinction of the phylogeny <br></p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>btorph</code></td>
<td>
<p>Sets whether the likelihood is for the branching times (0) or the phylogeny (1)</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>soc</code></td>
<td>
<p>Sets whether the first element of the branching times is the stem (1) or the crown (2) age</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>plotltt</code></td>
<td>
<p>Sets whether the lineage-through-time plot should be plotted (1) or not (0) </p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>methode</code></td>
<td>
<p>Sets which method should be used in the ode-solver. Default is 'lsoda'.
See package deSolve for details.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>n_low</code></td>
<td>
<p>Sets the lower bound of the number of species on which conditioning should be done when cond = 2. Set this to 0 when conditioning should be done on precisely the number of species (default)</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>n_up</code></td>
<td>
<p>Sets the upper bound of the number of species on which conditioning should be done when cond = 2. Set this to 0 when conditioning should be done on precisely the number of species (default)</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>tol</code></td>
<td>
<p>Sets the tolerances in the optimization. Consists of: <br>
reltolx = relative tolerance of parameter values in optimization <br>
reltolf = relative tolerance of function value in optimization <br>
abstolx = absolute tolerance of parameter values in optimization
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>maxiter</code></td>
<td>
<p>Sets the maximum number of iterations in the optimization</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>endmc</code></td>
<td>
<p>Sets the number of simulations for the bootstrap</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>seed</code></td>
<td>
<p>Sets the seed for the simulations of the bootstrap</p>
</td>
</tr>
</table>
<h3>Value</h3>

<p>A list of three dataframes. The first dataframe contains the maximum likelihood results of the real data set, the second contains the simulated trees, and the third dataframe, with number of rows equal to endmc, contain the maximum likelihood results for the simulated data. The columns of both frames contains the following elements for each simulated data set:
</p>
<table>
<tr style="vertical-align: top;">
<td><code>ntips</code></td>
<td>
<p> gives the number of tips </p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>b</code></td>
<td>
<p> gives the maximum likelihood estimate of b</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>mu_1</code></td>
<td>
<p> gives the maximum likelihood estimate of mu_1</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>la_1</code></td>
<td>
<p> gives the maximum likelihood estimate of la_1</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>mu_2</code></td>
<td>
<p> gives the maximum likelihood estimate of mu_2</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>loglik</code></td>
<td>
<p> gives the maximum loglikelihood</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>df</code></td>
<td>
<p> gives the number of estimated parameters, i.e. degrees of feedom</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>conv</code></td>
<td>
<p> gives a message on convergence of optimization; conv = 0 means convergence</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>exp_durspec</code></td>
<td>
<p> gives the expected duration of speciation</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>median_durspec</code></td>
<td>
<p> gives the median duration of speciation</p>
</td>
</tr>
</table>
<h3>Author(s)</h3>

<p>Rampal S. Etienne
</p>


<h3>See Also</h3>

<p><code>pbd_ML</code>
</p>


</div>