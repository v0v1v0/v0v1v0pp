<div class="container">

<table style="width: 100%;"><tr>
<td>import_IBD</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>Import IBD probabilities as estimated by TetraOrigin or PolyOrigin</h2>

<h3>Description</h3>

<p>Imports the IBD probability output of TetraOrigin (Mathematica software) or PolyOrigin (julia software) into the same
format as natively-estimated IBD probabilities from the polyqtlR package.
</p>


<h3>Usage</h3>

<pre><code class="language-R">import_IBD(
  method,
  folder = NULL,
  filename,
  bivalent_decoding = TRUE,
  error = 0.01,
  log = NULL
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>method</code></td>
<td>
<p>The method used for IBD estimation, either "TO" for TetraOrigin or "PO" for PolyOrigin</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>folder</code></td>
<td>
<p>The path to the folder in which the Tetra/PolyOrigin (ie. TetraOrigin or PolyOrigin) output is contained, 
default is <code>NULL</code> if files are in working directory.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>filename</code></td>
<td>
<p>If method = "TO", the (vector of) character filename stem(s) of the <code>.csv</code> file(s) containing the output of TetraOrigin (stem = without ".csv"). 
Should be in order according to LG/chromosome numbering. If method = "PO", then simply specify the PolyOrigin filename stem here (as the output is not split into separate linkage
groups in PolyOrigin). A PolyOrigin file with name &lt;filename&gt;_polyancestry.csv and its corresponding log file &lt;filename&gt;.log will then be searched for.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>bivalent_decoding</code></td>
<td>
<p>Logical, if method = "TO" you must specify <code>TRUE</code> if only bivalent pairing was allowed in TetraOrigin (in offspring deciding step),
otherwise specify <code>FALSE</code> if multivalent pairing was also allowed. If method = "PO", this will be automatically detected, so no need to specify (will be ignored).</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>error</code></td>
<td>
<p>If method = "TO", the offspring error prior used in the offspring decoding step of TetraOrigin, by default assumed to be 0.01. For method = "PO", this is automatically read in.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>log</code></td>
<td>
<p>Character string specifying the log filename to which standard output should be written. If <code>NULL</code> log is send to stdout.</p>
</td>
</tr>
</table>
<h3>Value</h3>

<p>Returns a list with the following items:
</p>
<table>
<tr style="vertical-align: top;">
<td><code>IBDtype : </code></td>
<td>
<p>Always "genotypeIBD" for the output of TetraOrigin</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>IBDarray : </code></td>
<td>
<p>An array of IBD probabilities. The dimensions of the array are: markers, genotype classes and individuals.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>map : </code></td>
<td>
<p>Integrated linkage map positions of markers used in IBD calculation</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>parental_phase : </code></td>
<td>
<p>The parental marker phasing as used by TetraOrigin, recoded in 1 and 0's</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>marginal.likelihoods : </code></td>
<td>
<p>A list of marginal likelihoods of different valencies, currently <code>NULL</code></p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>valency : </code></td>
<td>
<p>The predicted valency that maximised the marginal likelihood, per offspring. Currently <code>NULL</code></p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>offspring : </code></td>
<td>
<p>Offspring names</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>biv_dec : </code></td>
<td>
<p>Logical, the bivalent_decoding parameter specified.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>gap : </code></td>
<td>
<p>The gap size used in IBD interpolation if performed by <code>spline_IBD</code>. At this stage, <code>NULL</code></p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>genocodes : </code></td>
<td>
<p>Ordered list of genotype codes used to represent different genotype classes.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>pairing : </code></td>
<td>
<p>log likelihoods of each of the different pairing scenarios considered 
(can be used e.g. for post-mapping check of preferential pairing)</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>ploidy : </code></td>
<td>
<p>The ploidy of parent 1, by default assumed to be 4</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>ploidy2 : </code></td>
<td>
<p>The ploidy of parent 2, by default assumed to be 4</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>method : </code></td>
<td>
<p>The method used, either "hmm_TO" (TetraOrigin) or "hmm_PO" (PolyOrigin)</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>error : </code></td>
<td>
<p>The error prior used in the calculation in TetraOrigin, assumed to be 0.01</p>
</td>
</tr>
</table>
<h3>Examples</h3>

<pre><code class="language-R">## Not run: 
## These examples demonstrate the function call for both methods, but won't run without input files
## from either package, hence this call will normally result in an Error:
IBD_TO &lt;- import_IBD(method = "TO", filename = paste0("test_LinkageGroup",1:5,"_Summary"),
bivalent_decoding = FALSE, error = 0.05)
## Equivalent call for PolyOrigin output:
IBD_PO &lt;- import_IBD(method = "PO",filename = "test")

## End(Not run)
</code></pre>


</div>