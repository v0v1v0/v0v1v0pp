<div class="container">

<table style="width: 100%;"><tr>
<td>file_tbl</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>Get a table from a local or remote file</h2>

<h3>Description</h3>

<p>If your target table is in a file, stored either locally or remotely, the
<code>file_tbl()</code> function can make it possible to access it in a single function
call. Compatible file types for this function are: CSV (<code>.csv</code>), TSV
(<code>.tsv</code>), RDA (<code>.rda</code>), and RDS (<code>.rds</code>) files. This function generates an
in-memory <code>tbl_df</code> object, which can be used as a target table for
<code>create_agent()</code> and <code>create_informant()</code>. Another great option is supplying
a table-prep formula involving <code>file_tbl()</code> to <code>tbl_store()</code> so that you have
access to tables based on flat files though single names via a table store.
</p>
<p>In the remote data use case, we can specify a URL starting with <code style="white-space: pre;">⁠http://⁠</code>,
<code style="white-space: pre;">⁠https://⁠</code>, etc., and ending with the file containing the data table. If data
files are available in a GitHub repository then we can use the
<code>from_github()</code> function to specify the name and location of the table data
in a repository.
</p>


<h3>Usage</h3>

<pre><code class="language-R">file_tbl(file, type = NULL, ..., keep = FALSE, verify = TRUE)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>file</code></td>
<td>
<p>The complete file path leading to a compatible data table either
in the user system or at a <code style="white-space: pre;">⁠http://⁠</code>, <code style="white-space: pre;">⁠https://⁠</code>, <code style="white-space: pre;">⁠ftp://⁠</code>, or <code style="white-space: pre;">⁠ftps://⁠</code>
URL. For a file hosted in a GitHub repository, a call to the
<code>from_github()</code> function can be used here.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>type</code></td>
<td>
<p>The file type. This is normally inferred by file extension and is
by default <code>NULL</code> to indicate that the extension will dictate the type of
file reading that is performed internally. However, if there is no
extension (and valid extensions are <code>.csv</code>, <code>.tsv</code>, <code>.rda</code>, and <code>.rds</code>), we
can provide the type as either of <code>csv</code>, <code>tsv</code>, <code>rda</code>, or <code>rds</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>...</code></td>
<td>
<p>Options passed to <strong>readr</strong>'s <code>read_csv()</code> or <code>read_tsv()</code>
function. Both functions have the same arguments and one or the other will
be used internally based on the file extension or an explicit value given
to <code>type</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>keep</code></td>
<td>
<p>In the case of a downloaded file, should it be stored in the
working directory (<code>keep = TRUE</code>) or should it be downloaded to a temporary
directory? By default, this is <code>FALSE</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>verify</code></td>
<td>
<p>If <code>TRUE</code> (the default) then a verification of the data object
having the <code>data.frame</code> class will be carried out.</p>
</td>
</tr>
</table>
<h3>Value</h3>

<p>A <code>tbl_df</code> object.
</p>


<h3>Examples</h3>



<h4>Producing tables from CSV files</h4>

<p>A local CSV file can be obtained as a tbl object by supplying a path to the
file and some CSV reading options (the ones used by <code>readr::read_csv()</code>) to
the <code>file_tbl()</code> function. For this example we could obtain a path to a CSV
file in the <strong>pointblank</strong> package with <code>system.file()</code>.
</p>
<div class="sourceCode r"><pre>csv_path &lt;- 
  system.file(
    "data_files", "small_table.csv",
    package = "pointblank"
  )
</pre></div>
<p>Then use that path in <code>file_tbl()</code> with the option to specify the column
types in that CSV.
</p>
<div class="sourceCode r"><pre>tbl &lt;- 
  file_tbl(
    file = csv_path,
    col_types = "TDdcddlc"
  )

tbl
</pre></div>
<pre>## # A tibble: 13 × 8
##    date_time           date           a b           c      d e     f    
##    &lt;dttm&gt;              &lt;date&gt;     &lt;dbl&gt; &lt;chr&gt;   &lt;dbl&gt;  &lt;dbl&gt; &lt;lgl&gt; &lt;chr&gt;
##  1 2016-01-04 11:00:00 2016-01-04     2 1-bcd-…     3  3423. TRUE  high 
##  2 2016-01-04 00:32:00 2016-01-04     3 5-egh-…     8 10000. TRUE  low  
##  3 2016-01-05 13:32:00 2016-01-05     6 8-kdg-…     3  2343. TRUE  high 
##  4 2016-01-06 17:23:00 2016-01-06     2 5-jdo-…    NA  3892. FALSE mid  
##  5 2016-01-09 12:36:00 2016-01-09     8 3-ldm-…     7   284. TRUE  low  
##  6 2016-01-11 06:15:00 2016-01-11     4 2-dhe-…     4  3291. TRUE  mid  
##  7 2016-01-15 18:46:00 2016-01-15     7 1-knw-…     3   843. TRUE  high 
##  8 2016-01-17 11:27:00 2016-01-17     4 5-boe-…     2  1036. FALSE low  
##  9 2016-01-20 04:30:00 2016-01-20     3 5-bce-…     9   838. FALSE high 
## 10 2016-01-20 04:30:00 2016-01-20     3 5-bce-…     9   838. FALSE high 
## 11 2016-01-26 20:07:00 2016-01-26     4 2-dmx-…     7   834. TRUE  low  
## 12 2016-01-28 02:51:00 2016-01-28     2 7-dmx-…     8   108. FALSE low  
## 13 2016-01-30 11:23:00 2016-01-30     1 3-dka-…    NA  2230. TRUE  high</pre>
<p>Now that we have a 'tbl' object that is a tibble it could be introduced to
<code>create_agent()</code> for validation.
</p>
<div class="sourceCode r"><pre>agent &lt;- create_agent(tbl = tbl)
</pre></div>
<p>A different strategy is to provide the data-reading function call directly to
<code>create_agent()</code>:
</p>
<div class="sourceCode r"><pre>agent &lt;- 
  create_agent(
    tbl = ~ file_tbl(
      file = system.file(
        "data_files", "small_table.csv",
        package = "pointblank"
      ),
      col_types = "TDdcddlc"
    )
  ) %&gt;%
  col_vals_gt(columns = a, value = 0)
</pre></div>
<p>All of the file-reading instructions are encapsulated in the <code>tbl</code> expression
(with the leading <code>~</code>) so the agent will always obtain the most recent
version of the table (and the logic can be translated to YAML, for later
use).
</p>



<h4>Producing tables from files on GitHub</h4>

<p>A CSV can be obtained from a public GitHub repo by using the <code>from_github()</code>
helper function. Let's create an agent a supply a table-prep formula that
gets the same CSV file from the GitHub repository for the pointblank package.
</p>
<div class="sourceCode r"><pre>agent &lt;- 
  create_agent(
    tbl = ~ file_tbl(
      file = from_github(
        file = "inst/data_files/small_table.csv",
        repo = "rstudio/pointblank"
      ),
      col_types = "TDdcddlc"
    ),
    tbl_name = "small_table",
    label = "`file_tbl()` example.",
  ) %&gt;%
  col_vals_gt(columns = a, value = 0) %&gt;%
  interrogate()
</pre></div>
<div class="sourceCode r"><pre>agent
</pre></div>


<img src="https://raw.githubusercontent.com/rstudio/pointblank/main/images/man_file_tbl_1.png" alt="This image was generated from the first code example in the `file_tbl()` help file." style="width:100%;"><p>This interrogated the data that was obtained from the remote source file,
and, there's nothing to clean up (by default, the downloaded file goes into a
system temp directory).
</p>



<h4>File access, table creation, and prep via the table store</h4>

<p>Using table-prep formulas in a centralized table store can make it easier to
work with tables from disparate sources. Here's how to generate a table store
with two named entries for table preparations involving the <code>tbl_store()</code> and
<code>file_tbl()</code> functions.
</p>
<div class="sourceCode r"><pre>store &lt;-
  tbl_store(
    small_table_file ~ file_tbl(
      file = system.file(
        "data_files", "small_table.csv",
        package = "pointblank"
      ),
      col_types = "TDdcddlc"
    ),
    small_high_file ~ {{ small_table_file }} %&gt;%
      dplyr::filter(f == "high")
  )
</pre></div>
<p>Now it's easy to access either of these tables via <code>tbl_get()</code>. We can
reference the table in the store by its name (given to the left of the <code>~</code>).
</p>
<div class="sourceCode r"><pre>tbl_get(tbl = "small_table_file", store = store)
</pre></div>
<pre>## # A tibble: 13 × 8
##    date_time           date           a b           c      d e     f    
##    &lt;dttm&gt;              &lt;date&gt;     &lt;dbl&gt; &lt;chr&gt;   &lt;dbl&gt;  &lt;dbl&gt; &lt;lgl&gt; &lt;chr&gt;
##  1 2016-01-04 11:00:00 2016-01-04     2 1-bcd-…     3  3423. TRUE  high 
##  2 2016-01-04 00:32:00 2016-01-04     3 5-egh-…     8 10000. TRUE  low  
##  3 2016-01-05 13:32:00 2016-01-05     6 8-kdg-…     3  2343. TRUE  high 
##  4 2016-01-06 17:23:00 2016-01-06     2 5-jdo-…    NA  3892. FALSE mid  
##  5 2016-01-09 12:36:00 2016-01-09     8 3-ldm-…     7   284. TRUE  low  
##  6 2016-01-11 06:15:00 2016-01-11     4 2-dhe-…     4  3291. TRUE  mid  
##  7 2016-01-15 18:46:00 2016-01-15     7 1-knw-…     3   843. TRUE  high 
##  8 2016-01-17 11:27:00 2016-01-17     4 5-boe-…     2  1036. FALSE low  
##  9 2016-01-20 04:30:00 2016-01-20     3 5-bce-…     9   838. FALSE high 
## 10 2016-01-20 04:30:00 2016-01-20     3 5-bce-…     9   838. FALSE high 
## 11 2016-01-26 20:07:00 2016-01-26     4 2-dmx-…     7   834. TRUE  low  
## 12 2016-01-28 02:51:00 2016-01-28     2 7-dmx-…     8   108. FALSE low  
## 13 2016-01-30 11:23:00 2016-01-30     1 3-dka-…    NA  2230. TRUE  high</pre>
<p>The second table in the table store is a mutated version of the first. It's
just as easily obtainable via <code>tbl_get()</code>:
</p>
<div class="sourceCode r"><pre>tbl_get(tbl = "small_high_file", store = store)
</pre></div>
<pre>## # A tibble: 6 × 8
##   date_time           date           a b             c     d e     f    
##   &lt;dttm&gt;              &lt;date&gt;     &lt;dbl&gt; &lt;chr&gt;     &lt;dbl&gt; &lt;dbl&gt; &lt;lgl&gt; &lt;chr&gt;
## 1 2016-01-04 11:00:00 2016-01-04     2 1-bcd-345     3 3423. TRUE  high 
## 2 2016-01-05 13:32:00 2016-01-05     6 8-kdg-938     3 2343. TRUE  high 
## 3 2016-01-15 18:46:00 2016-01-15     7 1-knw-093     3  843. TRUE  high 
## 4 2016-01-20 04:30:00 2016-01-20     3 5-bce-642     9  838. FALSE high 
## 5 2016-01-20 04:30:00 2016-01-20     3 5-bce-642     9  838. FALSE high 
## 6 2016-01-30 11:23:00 2016-01-30     1 3-dka-303    NA 2230. TRUE  high</pre>
<p>The table-prep formulas in the <code>store</code> object could also be used in functions
with a <code>tbl</code> argument (like <code>create_agent()</code> and <code>create_informant()</code>). This
is accomplished most easily with the <code>tbl_source()</code> function.
</p>
<div class="sourceCode r"><pre>agent &lt;- 
  create_agent(
    tbl = ~ tbl_source(
      tbl = "small_table_file",
      store = store
    )
  )
</pre></div>
<div class="sourceCode r"><pre>informant &lt;- 
  create_informant(
    tbl = ~ tbl_source(
      tbl = "small_high_file",
      store = store
    )
  )
</pre></div>



<h3>Function ID</h3>

<p>1-7
</p>


<h3>See Also</h3>

<p>Other Planning and Prep: 
<code>action_levels()</code>,
<code>create_agent()</code>,
<code>create_informant()</code>,
<code>db_tbl()</code>,
<code>draft_validation()</code>,
<code>scan_data()</code>,
<code>tbl_get()</code>,
<code>tbl_source()</code>,
<code>tbl_store()</code>,
<code>validate_rmd()</code>
</p>


</div>