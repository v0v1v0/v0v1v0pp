<div class="container">

<table style="width: 100%;"><tr>
<td>create_phased_maplist</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>Create a phased homologue map list using the original dosages</h2>

<h3>Description</h3>

<p><code>create_phased_maplist</code> is a function for creating a phased maplist, using
integrated map positions and original marker dosages.
</p>


<h3>Usage</h3>

<pre><code class="language-R">create_phased_maplist(
  input_type = "discrete",
  maplist,
  dosage_matrix.conv,
  dosage_matrix.orig = NULL,
  probgeno_df,
  chk,
  remove_markers = NULL,
  original_coding = FALSE,
  N_linkages = 2,
  lower_bound = 0.05,
  ploidy,
  ploidy2 = NULL,
  marker_assignment.1,
  marker_assignment.2,
  parent1 = "P1",
  parent2 = "P2",
  marker_conversion_info = NULL,
  log = NULL,
  verbose = TRUE
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>input_type</code></td>
<td>
<p>Can be either one of 'discrete' or 'probabilistic'. For the former (default), at least <code>dosage_matrix.conv</code> must be supplied,
while for the latter <code>chk</code> must be supplied.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>maplist</code></td>
<td>
<p>A list of maps. In the first column marker names and in the second their position.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>dosage_matrix.conv</code></td>
<td>
<p>Matrix of marker dosage scores with markers in rows and individuals in columns. Note that dosages must be
in converted form, i.e. after having run the <code>convert_marker_dosages</code> function. Errors may result otherwise.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>dosage_matrix.orig</code></td>
<td>
<p>Optional, by default <code>NULL</code>.The unconverted dosages (i.e. raw dosage data before using
the <code>convert_marker_dosages</code> function). Required if <code>original_coding</code> is <code>TRUE</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>probgeno_df</code></td>
<td>
<p>Probabilistic genotypes, for description see e.g. <code>gp_overview</code>. Required if probabilistic genotypes are used.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>chk</code></td>
<td>
<p>Output list as returned by function <code>checkF1</code>. Required if probabilistic genotypes are used.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>remove_markers</code></td>
<td>
<p>Optional vector of marker names to remove from the maps. Default is <code>NULL</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>original_coding</code></td>
<td>
<p>Logical. Should the phased map use the original marker coding or not? By default <code>FALSE</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>N_linkages</code></td>
<td>
<p>Number of significant linkages (as defined in <code>homologue_lg_assignment</code>) required for high-confidence linkage group assignment.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>lower_bound</code></td>
<td>
<p>Numeric. Lower bound for the rate at which homologue linkages (fraction of total for that marker) are recognised.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>ploidy</code></td>
<td>
<p>Integer. Ploidy of the organism.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>ploidy2</code></td>
<td>
<p>Optional integer, by default <code>NULL</code>. Ploidy of parent 2, if different from parent 1.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>marker_assignment.1</code></td>
<td>
<p>A marker assignment matrix for parent 1 with markernames as rownames and at least containing the column <code>"Assigned_LG"</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>marker_assignment.2</code></td>
<td>
<p>A marker assignment matrix for parent 2 with markernames as rownames and at least containing the column <code>"Assigned_LG"</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>parent1</code></td>
<td>
<p>character vector with names of the samples of parent 1</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>parent2</code></td>
<td>
<p>character vector with names of the samples of parent 2</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>marker_conversion_info</code></td>
<td>
<p>One of the list elements (named 'marker_conversion_info') generated by the function <code>convert_marker_dosages</code> when the argument <code>marker_conversion_info</code>
was set to <code>TRUE</code> (not the default, so a user will typically have to re-run this step first).
Required if <code>original_coding</code> is <code>TRUE</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>log</code></td>
<td>
<p>Character string specifying the log filename to which standard output should be written. If <code>NULL</code> log is send to stdout.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>verbose</code></td>
<td>
<p>Logical, by default <code>TRUE</code>. Should details of the phasing process be given?</p>
</td>
</tr>
</table>
<h3>Examples</h3>

<pre><code class="language-R">## Not run: 
data("integrated.maplist", "screened_data3", "marker_assignments_P1","marker_assignments_P2")
create_phased_maplist(maplist = integrated.maplist,
                     dosage_matrix.conv = screened_data3,
                     marker_assignment.1=marker_assignments_P1,
                     marker_assignment.2=marker_assignments_P2,
                     ploidy = 4)
## End(Not run)
</code></pre>


</div>