<div class="container">

<table style="width: 100%;"><tr>
<td>plot.RNE</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>Random, neighbour, environment deletion analysis for transfer function
models</h2>

<h3>Description</h3>

<p>Calculates effect of deleting sites from training set at random,
from a geographic neighbourhood, or from an environmental neighbourhood.
A simple graphical technique for gauging the effect of spatial
autocorrelation on the transfer function model.
</p>


<h3>Usage</h3>

<pre><code class="language-R">## S3 method for class 'RNE'
plot(x, which = 1, ylim, ...)

rne(
  y,
  env,
  geodist,
  fun,
  neighbours,
  subsets = c(1, 0.75, 0.5, 0.25, 0.1),
  ...
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>x</code></td>
<td>
<p>RNE object to be plotted</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>which</code></td>
<td>
<p>Which column of the results to plot eg if more than one WAPLS
component is calculated</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>ylim</code></td>
<td>
<p>Y-limits of the plot</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>...</code></td>
<td>
<p>Arguments passed to fun</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>y</code></td>
<td>
<p>Community data, or distance object, or distance matrix</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>env</code></td>
<td>
<p>Environmental variable</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>geodist</code></td>
<td>
<p>Matrix of geographical distances between sites</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>fun</code></td>
<td>
<p>Transfer function</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>neighbours</code></td>
<td>
<p>Neighbourhood radii</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>subsets</code></td>
<td>
<p>Proportion of sites to retain in random deletion</p>
</td>
</tr>
</table>
<h3>Details</h3>

<p>Finds the leave-one-out transfer function performance if sites are
deleted at random, from a
neighbourhood zone, or by deleting environmentally close sites.
</p>
<p>Prior to version 2.1, this function would repeat the random removal 10 times
to reduce variance in results.
This is no longer done as the variance is small for large training sets,
it took a long time, and treats one treatment of the data differently.
</p>


<h3>Value</h3>

<p>Returns an RNE object, list with two components
</p>

<ul>
<li>
<p>random Performance with random deletion.
</p>
</li>
<li>
<p>neighbour Performance with deletion by neighbourhood,
or environment
</p>
</li>
</ul>
<h3>Functions</h3>


<ul><li> <p><code>plot(RNE)</code>: Plot RNE object
</p>
</li></ul>
<h3>Author(s)</h3>

<p>Richard Telford <a href="mailto:Richard.Telford@bio.uib.no">Richard.Telford@bio.uib.no</a>
</p>


<h3>References</h3>

<p>Telford, R. J. and Birks, H. J. B. (2009) Evaluation of transfer
functions in spatially structured environments.
<em>Quaternary Science Reviews</em> <b>28</b>: 1309â€“1316.
<a href="https://doi.org/10.1016/j.quascirev.2008.12.020">doi:10.1016/j.quascirev.2008.12.020</a>
</p>


<h3>Examples</h3>

<pre><code class="language-R">require(rioja)
require(sf)
data(arctic.env)
data(arctic.pollen)

# using just the first 100 sites so that code runs quickly (about 15 seconds for all 828 sites)

# convert environmental data into an sf object
arctic.env &lt;- st_as_sf(
  x = arctic.env,
  coords = c("Longitude", "Latitude"),
  crs = 4326
)

# find great circle distances and remove units
arctic.dist &lt;- st_distance(arctic.env[1:100, ]) |&gt;
  units::set_units("km") |&gt;
  units::set_units(NULL)

# rne
arctic.rne &lt;- rne(
  y = arctic.pollen[1:100, ], env = arctic.env$tjul[1:100],
  geodist = arctic.dist, fun = MAT, neighbours = c(0, 200),
  subsets = c(1, .5), k = 5
)

plot(arctic.rne)
</code></pre>


</div>