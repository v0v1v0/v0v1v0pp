<div class="container">

<table style="width: 100%;"><tr>
<td>pamr.train</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>A function to train a nearest shrunken centroid classifier</h2>

<h3>Description</h3>

<p>A function that computes a nearest shrunken centroid for gene expression
(microarray) data
</p>


<h3>Usage</h3>

<pre><code class="language-R">pamr.train(
  data,
  gene.subset = NULL,
  sample.subset = NULL,
  threshold = NULL,
  n.threshold = 30,
  scale.sd = TRUE,
  threshold.scale = NULL,
  se.scale = NULL,
  offset.percent = 50,
  hetero = NULL,
  prior = NULL,
  remove.zeros = TRUE,
  sign.contrast = "both",
  ngroup.survival = 2
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>data</code></td>
<td>
<p>The input data. A list with components: x- an expression genes
in the rows, samples in the columns), and y- a vector of the class labels
for each sample.  Optional components- genenames, a vector of gene names,
and geneid- a vector of gene identifiers.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>gene.subset</code></td>
<td>
<p>Subset of genes to be used.  Can be either a logical
vector of length total number of genes, or a list of integers of the row
numbers of the genes to be used</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>sample.subset</code></td>
<td>
<p>Subset of samples to be used.  Can be either a logical
vector of length total number of samples, or a list of integers of the
column numbers of the samples to be used.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>threshold</code></td>
<td>
<p>A vector of threshold values for the centroid
shrinkage.Default is a set of 30 values chosen by the software</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>n.threshold</code></td>
<td>
<p>Number of threshold values desired (default 30)</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>scale.sd</code></td>
<td>
<p>Scale each threshold by the wthin class standard deviations?
Default: true</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>threshold.scale</code></td>
<td>
<p>Additional scaling factors to be applied to the
thresholds. Vector of length equal to the number of classes.  Default- a
vectors of ones.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>se.scale</code></td>
<td>
<p>Vector of scaling factors for the within class standard
errors. Default is sqrt(1/n.class-1/n), where n is the overall sample size
and n.class is the sample sizes in each class. This default adjusts for
different class sizes.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>offset.percent</code></td>
<td>
<p>Fudge factor added to the denominator of each
t-statistic, expressed as a percentile of the gene standard deviation
values.  This is a small positive quantity to penalize genes with expression
values near zero, which can result in very large ratios. This factor is
expecially impotant for Affy data. Default is the median of the standard
deviations of each gene.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>hetero</code></td>
<td>
<p>Should a heterogeneity transformation be done?  If yes, hetero
must be set to one of the class labels (see Details below).  Default is no
(hetero=NULL)</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>prior</code></td>
<td>
<p>Vector of length the number of classes, representing prior
probabilities for each of the classes. The prior is used in Bayes rule for
making class prediction. Default is NULL, and prior is then taken to be
n.class/n, where n is the overall sample size and n.class is the sample
sizes in each class.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>remove.zeros</code></td>
<td>
<p>Remove threshold values yielding zero genes? Default
TRUE</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>sign.contrast</code></td>
<td>
<p>Directions of allowed deviations of class-wise average
gene expression from the overall average gene expression. Default is
<code style="white-space: pre;">⁠both'' (positive or negative).  Can also be set to ⁠</code>positive” or
“negative”.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>ngroup.survival</code></td>
<td>
<p>Number of groups formed for survival data. Default 2</p>
</td>
</tr>
</table>
<h3>Details</h3>

<p><code>pamr.train</code> fits a nearest shrunken centroid classifier to gene
expression data. Details may be found in the PNAS paper referenced below.
One feature not described there is "heterogeneity analysis".  Suppose there
are two classes labelled "A" and "B".  CLass "A" is considered a normal
class, and "B" an abnormal class.  Setting hetero="A" transforms expression
values <code class="reqn">x[i,j]</code> to <code class="reqn">|x[i,j]- mean(x[i,j])|</code> where the mean is taken only over
samples in class "A". The transformed feature values are then used in Pam.
This is useful when the abnormal class "B" is heterogeneous, i.e.  a given
gene might have higher expresion than normal for some class "B" samples, and
lower for others.  With more than 2 classes, each class is centered on the
class specified by hetero.
</p>


<h3>Value</h3>

<p>A list with components </p>
<table>
<tr style="vertical-align: top;">
<td><code>y</code></td>
<td>
<p>The outcome classes.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>yhat</code></td>
<td>
<p>A
matrix of predicted classes, each column representing the results from one
threshold.</p>
</td>
</tr>
</table>
<p>.  </p>
<table>
<tr style="vertical-align: top;">
<td><code>prob</code></td>
<td>
<p>A array of predicted class probabilities. of
dimension n by nclass by n.threshold. n is the number samples, nclass is the
number of classes, n.threshold is the number of thresholds tried</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>centroids</code></td>
<td>
<p>A matrix of (unshrunken) class centroids, n by nclass</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>hetero</code></td>
<td>
<p>Value of hetero used in call to pamr.train</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>norm.cent</code></td>
<td>
<p>Centroid of "normal" group, if hetero was specified</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>centroid.overall</code></td>
<td>
<p>A vector containing the (unshrunken) overall
centroid (all classes together)</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>sd</code></td>
<td>
<p>A vector of the standard
deviations for each gene</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>threshold</code></td>
<td>
<p>A vector of the threshold tried
in the shrinkage</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>nonzero</code></td>
<td>
<p>A vector of the number of genes that
survived the thresholding, for each threshold value tried</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>threshold.scale</code></td>
<td>
<p>A vector of threshold scale factors that were used</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>se.scale</code></td>
<td>
<p>A vector of standard error scale factors that were used</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>call</code></td>
<td>
<p>The calling sequence used</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>prior</code></td>
<td>
<p>The prior probabilities
used</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>errors</code></td>
<td>
<p>The number of trainin errors for each threshold value</p>
</td>
</tr>
</table>
<h3>Author(s)</h3>

<p>Trevor Hastie,Robert Tibshirani, Balasubramanian Narasimhan, and
Gilbert Chu
</p>


<h3>References</h3>

<p>Robert Tibshirani, Trevor Hastie, Balasubramanian Narasimhan,
and Gilbert Chu Diagnosis of multiple cancer types by shrunken centroids of
gene expression PNAS 99: 6567-6572.  Available at www.pnas.org
</p>


<h3>Examples</h3>

<pre><code class="language-R">
#generate some data
suppressWarnings(RNGversion("3.5.0"))
set.seed(120)
x &lt;- matrix(rnorm(1000*20),ncol=20)
y &lt;- sample(c(1:4),size=20,replace=TRUE)
mydata &lt;- list(x=x,y=factor(y))

#train classifier
results&lt;-   pamr.train(mydata)

# train classifier on all  data except class 4
results2 &lt;- pamr.train(mydata,sample.subset=(mydata$y!=4))
 
# train classifier on  only the first 500 genes
results3 &lt;- pamr.train(mydata,gene.subset=1:500)


</code></pre>


</div>