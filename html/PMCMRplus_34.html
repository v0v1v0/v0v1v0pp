<div class="container">

<table style="width: 100%;"><tr>
<td>chenTest</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>Chen's Many-to-One Comparisons Test</h2>

<h3>Description</h3>

<p>Performs Chen's nonparametric test for contrasting increasing
(decreasing) dose levels of a treatment.
</p>


<h3>Usage</h3>

<pre><code class="language-R">chenTest(x, ...)

## Default S3 method:
chenTest(
  x,
  g,
  alternative = c("greater", "less"),
  p.adjust.method = c("SD1", p.adjust.methods),
  ...
)

## S3 method for class 'formula'
chenTest(
  formula,
  data,
  subset,
  na.action,
  alternative = c("greater", "less"),
  p.adjust.method = c("SD1", p.adjust.methods),
  ...
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>x</code></td>
<td>
<p>a numeric vector of data values, or a list of numeric data
vectors.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>...</code></td>
<td>
<p>further arguments to be passed to or from methods.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>g</code></td>
<td>
<p>a vector or factor object giving the group for the
corresponding elements of <code>"x"</code>.
Ignored with a warning if <code>"x"</code> is a list.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>alternative</code></td>
<td>
<p>the alternative hypothesis. Defaults to <code>two.sided</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>p.adjust.method</code></td>
<td>
<p>method for adjusting p values
(see <code>p.adjust</code>)</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>formula</code></td>
<td>
<p>a formula of the form <code>response ~ group</code> where
<code>response</code> gives the data values and <code>group</code> a vector or
factor of the corresponding groups.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>data</code></td>
<td>
<p>an optional matrix or data frame (or similar: see
<code>model.frame</code>) containing the variables in the
formula <code>formula</code>.  By default the variables are taken from
<code>environment(formula)</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>subset</code></td>
<td>
<p>an optional vector specifying a
subset of observations to be used.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>na.action</code></td>
<td>
<p>a function which indicates what should happen when
the data contain <code>NA</code>s.  Defaults to <code>getOption("na.action")</code>.</p>
</td>
</tr>
</table>
<h3>Details</h3>

<p>Chen's test is a non-parametric step-down trend test for
testing several treatment levels with a zero control.
Let <code class="reqn">X_{0j}</code> denote a variable with the <code class="reqn">j</code>-th
realization of the control group (<code class="reqn">1 \le j \le n_0</code>)
and <code class="reqn">X_{ij}</code> the <code class="reqn">j</code>-the realization
in the <code class="reqn">i</code>-th treatment group (<code class="reqn">1 \le i \le k</code>).
The variables are i.i.d. of a least ordinal scale with
<code class="reqn">F(x) = F(x_0) = F(x_i), ~ (1 \le i \le k)</code>.
A total of <code class="reqn">m = k</code> hypotheses can be tested:
</p>
<p style="text-align: center;"><code class="reqn">
\begin{array}{ll}
\mathrm{H}_{m}: \theta_0 = \theta_1 = \ldots = \theta_m, &amp; \mathrm{A}_{m} = \theta_0 \le \theta_1 \le \ldots \theta_m, \theta_0 &lt; \theta_m \\
\mathrm{H}_{m-1}: \theta_0 = \theta_1 = \ldots = \theta_{m-1}, &amp; \mathrm{A}_{m-1} = \theta_0 \le \theta_1 \le \ldots \theta_{m-1}, \theta_0 &lt; \theta_{m-1} \\
\vdots &amp; \vdots \\
\mathrm{H}_{1}: \theta_0 = \theta_1, &amp; \mathrm{A}_{1} = \theta_0 &lt; \theta_1\\
\end{array}
</code>
</p>

<p>The statistics <code class="reqn">T_i</code> are based on a Wilcoxon-type ranking:
</p>
<p style="text-align: center;"><code class="reqn">
T_i = \sum_{j=0}^{i=1} \sum_{u=1}^{n_i} \sum_{v=1}^{n_j} I(x_{iu} - x_{jv}), \qquad (1 \leq i \leq k),
</code>
</p>

<p>where the indicator function returns <code class="reqn">I(a) = 1, ~ \mathrm{if}~ a &gt; 0, 0.5 ~ \mathrm{if} a = 0</code>
otherwise <code class="reqn">0</code>.
</p>
<p>The expected <code class="reqn">i</code>th mean is
</p>
<p style="text-align: center;"><code class="reqn">
\mu(T_i) = n_i N_{i-1} / 2,
</code>
</p>

<p>with <code class="reqn">N_j = \sum_{j =0}^i n_j</code> and the <code class="reqn">i</code>th variance:
</p>
<p style="text-align: center;"><code class="reqn">
\sigma^2(T_i) = n_i N_{i-1} / 12 ~ \left\{N_i + 1 -
\sum_{j=1}^g t_j \left(t_j^2 - 1 \right) /
\left[N_i \left( N_i - 1 \right)\right]\right\}.
</code>
</p>

<p>The test statistic <code class="reqn">T_i^*</code> is asymptotically standard normal
</p>
<p style="text-align: center;"><code class="reqn">
 T_i^* = \frac{T_i - \mu(T_i)}
 {\sqrt{\sigma^2(T_i)}}, \qquad (1 \leq i \leq k).
</code>
</p>

<p>The p-values are calculated from the standard normal distribution.
The p-values can be adjusted with any method as available
by <code>p.adjust</code> or by the step-down procedure as proposed
by Chen (1999), if <code>p.adjust.method = "SD1"</code>.
</p>


<h3>Value</h3>

<p>A list with class <code>"PMCMR"</code> containing the following components:
</p>

<dl>
<dt>method</dt>
<dd>
<p>a character string indicating what type of test was performed.</p>
</dd>
<dt>data.name</dt>
<dd>
<p>a character string giving the name(s) of the data.</p>
</dd>
<dt>statistic</dt>
<dd>
<p>lower-triangle matrix of the estimated
quantiles of the pairwise test statistics.</p>
</dd>
<dt>p.value</dt>
<dd>
<p>lower-triangle matrix of the p-values for the pairwise tests.</p>
</dd>
<dt>alternative</dt>
<dd>
<p>a character string describing the alternative hypothesis.</p>
</dd>
<dt>p.adjust.method</dt>
<dd>
<p>a character string describing the method for p-value
adjustment.</p>
</dd>
<dt>model</dt>
<dd>
<p>a data frame of the input data.</p>
</dd>
<dt>dist</dt>
<dd>
<p>a string that denotes the test distribution.</p>
</dd>
</dl>
<h3>Note</h3>

<p>Factor labels for <code>g</code> must be assigned in such a way,
that they can be increasingly ordered from zero-dose
control to the highest dose level, e.g. integers
{0, 1, 2, ..., k} or letters {a, b, c, ...}.
Otherwise the function may not select the correct values
for intended zero-dose control.
</p>
<p>It is safer, to i) label the factor levels as given above,
and to ii) sort the data according to increasing dose-levels
prior to call the function (see <code>order</code>, <code>factor</code>).
</p>


<h3>References</h3>

<p>Chen, Y.-I., 1999, Nonparametric Identification of the
Minimum Effective Dose. <em>Biometrics</em> <strong>55</strong>, 1236â€“1240.
<a href="https://doi.org/10.1111/j.0006-341X.1999.01236.x">doi:10.1111/j.0006-341X.1999.01236.x</a>
</p>


<h3>See Also</h3>

<p><code>wilcox.test</code>, <code>Normal</code>
</p>


<h3>Examples</h3>

<pre><code class="language-R">## Chen, 1999, p. 1237,
## Minimum effective dose (MED)
## is at 2nd dose level
df &lt;- data.frame(x = c(23, 22, 14,
27, 23, 21,
28, 37, 35,
41, 37, 43,
28, 21, 30,
16, 19, 13),
g = gl(6, 3))
levels(df$g) &lt;- 0:5
ans &lt;- chenTest(x ~ g, data = df, alternative = "greater",
                p.adjust.method = "SD1")
summary(ans)

</code></pre>


</div>