<div class="container">

<table style="width: 100%;"><tr>
<td>test_f</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>Bootstrap joint confidence bands and L2-norm based test on nonlinear functions</h2>

<h3>Description</h3>

<p>This function conducts a test of overall equality of two nonlinear functions
and generates confidence bands for the estimated difference of the nonlinear functions using a bootstrap method.
</p>


<h3>Usage</h3>

<pre><code class="language-R">test_f(
  x,
  y,
  series,
  t,
  name_group_var,
  plsmm_output,
  n_boot = 1000,
  predicted = FALSE,
  show_obs = FALSE,
  verbose = TRUE
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>x</code></td>
<td>
<p>A matrix of predictors.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>y</code></td>
<td>
<p>A continuous vector of response variable.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>series</code></td>
<td>
<p>A variable representing different series or groups in the data modeled as a random intercept.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>t</code></td>
<td>
<p>A numeric vector indicating the time points.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>name_group_var</code></td>
<td>
<p>A character string specifying the name of the grouping variable.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>plsmm_output</code></td>
<td>
<p>Output object obtained from the <code>plsmm_lasso</code> function.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>n_boot</code></td>
<td>
<p>Numeric specifying the number of bootstrap samples (default is 1000).</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>predicted</code></td>
<td>
<p>Logical indicating whether to plot predicted values. If <code>FALSE</code> only the observed time points are used.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>show_obs</code></td>
<td>
<p>Logical. If <code>TRUE</code> the observed time points are used for the position scale of the x-axis.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>verbose</code></td>
<td>
<p>Logical indicating whether to display bootstrap progress. Default is <code>TRUE</code>.</p>
</td>
</tr>
</table>
<h3>Details</h3>

<p>The function generate bootstrap samples and estimate the nonlinear functions for each <code>n_boot</code> sample.
These bootstrap estimates are then used to compute the L2-norm test of equality and the joint confidence bands.
</p>


<h3>Value</h3>

<p>A plot showing the estimated difference and confidence bands of the nonlinear functions.
</p>
<p>A list containing:
</p>
<table>
<tr style="vertical-align: top;">
<td><code>overall_test_results</code></td>
<td>
<p>Results from the L2-norm test of equality.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>CI_f</code></td>
<td>
<p>Confidence intervals values for the difference of the estimated functions used for plotting.</p>
</td>
</tr>
</table>
<h3>Examples</h3>

<pre><code class="language-R">
set.seed(123)
data_sim &lt;- simulate_group_inter(
  N = 50, n_mvnorm = 3, grouped = TRUE,
  timepoints = 3:5, nonpara_inter = TRUE,
  sample_from = seq(0, 52, 13), 
  cos = FALSE, A_vec = c(1, 1.5)
)
sim &lt;- data_sim$sim
x &lt;- as.matrix(sim[, -1:-3])
y &lt;- sim$y
series &lt;- sim$series
t &lt;- sim$t
bases &lt;- create_bases(t)
lambda &lt;- 0.0046
gamma &lt;- 0.00000001
plsmm_output &lt;- plsmm_lasso(x, y, series, t,
  name_group_var = "group", bases$bases,
  gamma = gamma, lambda = lambda, timexgroup = TRUE,
  criterion = "BIC"
)
test_f_results &lt;- test_f(x, y, series, t,
 name_group_var = "group", plsmm_output,
 n_boot = 10
)
test_f_results[[1]]
test_f_results[[2]]


</code></pre>


</div>