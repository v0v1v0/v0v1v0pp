<div class="container">

<table style="width: 100%;"><tr>
<td>compute.fstats</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>Estimate the F-statistics (F2, F3, F3star, F4, Dstat) and within and across population diversity</h2>

<h3>Description</h3>

<p>Estimate the F-statistics (F2, F3, F3star, F4, Dstat) and within and across population diversity
</p>


<h3>Usage</h3>

<pre><code class="language-R">compute.fstats(
  x,
  nsnp.per.bjack.block = 0,
  computeDstat = FALSE,
  computeF3 = TRUE,
  computeF4 = TRUE,
  output.pairwise.fst = TRUE,
  output.pairwise.div = TRUE,
  computeQmat = TRUE,
  return.F2.blockjackknife.samples = FALSE,
  return.F4.blockjackknife.samples = FALSE,
  verbose = TRUE
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>x</code></td>
<td>
<p>A pooldata object containing Pool-Seq information or a countdata object containing allele count information</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>nsnp.per.bjack.block</code></td>
<td>
<p>Number of consecutive SNPs within a block for block-jackknife (default=0, i.e., no block-jackknife sampling)</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>computeDstat</code></td>
<td>
<p>If TRUE compute Dstatistics (i.e. scaled F4). This may add some non negligible computation time if the number of population is large (n&gt;15)</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>computeF3</code></td>
<td>
<p>If TRUE (default) compute all F3 and all F3star (i.e. scaled F3).</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>computeF4</code></td>
<td>
<p>If TRUE (default) compute all F4.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>output.pairwise.fst</code></td>
<td>
<p>If TRUE (default), output the npopxnpop matrix of pairwise-population Fst estimates (corresponding to the "Identity" method implemented in <code>compute.pairwiseFST</code>) in the pairwise.fst slot of the fstats output object (see help(fstats) for details) that may be visualized with e.g. heatmap function or used with a clustering function (e.g., hclust).</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>output.pairwise.div</code></td>
<td>
<p>If TRUE (default), output the npopxnpop matrix of pairwise-population divergence (1-Q2) estimates  in the pairwise.div slot of the fstats output object (see help(fstats) for details) that may be visualized with e.g. heatmap function or used with a clustering function (e.g., hclust).</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>computeQmat</code></td>
<td>
<p>If TRUE, compute the error covariance matrix between all F3 and F2 statistics (needed for admixture graph construction). This matrix may be very large if the number of pops is large. It is recommended to estimate it on a reduced sample of pops.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>return.F2.blockjackknife.samples</code></td>
<td>
<p>If TRUE (and nsnp.per.bjack.block&gt;0) return an array of dimension (npopxnpopxnblocks) in an admixtools2 compatible format</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>return.F4.blockjackknife.samples</code></td>
<td>
<p>Deprecated options (since v. 2.2.0)</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>verbose</code></td>
<td>
<p>If TRUE extra information is printed on the terminal</p>
</td>
</tr>
</table>
<h3>Details</h3>

<p>The function estimates for the n populations (or pools) represented in the input object x:
</p>

<ol>
<li>
<p> The F2 statistics for all the <code class="reqn">n(n-1)/2</code> pairs of populations (or pools) and their scaled version (equivalent, but faster, than Fst estimated with <code>compute.pairwiseFST</code> when method="Identity")
</p>
</li>
<li>
<p> If n&gt;2, The F3 statistics for all the <code class="reqn">npools(npools-1)(npools-2)/2</code> possible triplets of populations (or pools) and their scaled version (named F3star after Patterson et al., 2012)
</p>
</li>
<li>
<p> If n&gt;3, The F4 statistics and the D-statistics (a scaled version of the F4) for all the <code class="reqn">npools(npools-1)(npools-2)*(npools-3)/8</code> possible quadruplets of populations
</p>
</li>
<li>
<p> The estimated within population heterozygosities (=1-Q1)
</p>
</li>
<li>
<p> The estimated divergence for each pair of populations (=1-Q2) 
</p>
</li>
</ol>
<h3>Value</h3>

<p>An object of class fstats (see help(fstats) for details)
</p>


<h3>See Also</h3>

<p>To generate pooldata object, see <code>vcf2pooldata</code>, <code>popsync2pooldata</code>,<code>genobaypass2pooldata</code> or <code>genoselestim2pooldata</code>. To generate coundata object, see <code>genobaypass2countdata</code> or <code>genotreemix2countdata</code>.
</p>


<h3>Examples</h3>

<pre><code class="language-R"> make.example.files(writing.dir=tempdir())
 pooldata=popsync2pooldata(sync.file=paste0(tempdir(),"/ex.sync.gz"),poolsizes=rep(50,15))
 res.fstats=compute.fstats(pooldata)
</code></pre>


</div>