<div class="container">

<table style="width: 100%;"><tr>
<td>penalized.clr</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>Penalized conditional logistic regression</h2>

<h3>Description</h3>

<p>Fits conditional logistic regression models with L1 and L2 penalty allowing
for different penalties for different blocks of covariates.
</p>


<h3>Usage</h3>

<pre><code class="language-R">penalized.clr(
  response,
  stratum,
  penalized,
  unpenalized = NULL,
  lambda,
  alpha = 1,
  p = NULL,
  standardize = TRUE,
  event
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>response</code></td>
<td>
<p>The response variable, either a 0/1 vector or a factor with two levels.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>stratum</code></td>
<td>
<p>A numeric vector with stratum membership of each observation.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>penalized</code></td>
<td>
<p>A matrix of penalized covariates.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>unpenalized</code></td>
<td>
<p>A matrix of additional unpenalized covariates.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>lambda</code></td>
<td>
<p>The tuning parameter for L1. Either a single non-negative number,
or a numeric vector of the length equal to the number of blocks. See p below.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>alpha</code></td>
<td>
<p>The elastic net mixing parameter, a number between 0 and 1.
alpha=0 would give pure ridge; alpha=1 gives lasso. Pure ridge penalty is never obtained in this implementation since alpha must be positive.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>p</code></td>
<td>
<p>The sizes of blocks of covariates,
a numerical vector of the length equal to the number of blocks,
and with the sum equal to the number of penalized covariates.
If missing, all covariates are treated the same and a single penalty is applied.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>standardize</code></td>
<td>
<p>Should the covariates be standardized, a logical value.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>event</code></td>
<td>
<p>If response is a factor, the level that
should be considered a success in the logistic regression.</p>
</td>
</tr>
</table>
<h3>Details</h3>

<p>The <code>penalized.clr</code> function fits a conditional logistic regression
model for a given combination of L1 (<code>lambda</code>) and L2 penalties. L2 penalty is
obtained from <code>lambda</code> and <code>alpha</code> as <code>lambda*(1-alpha)/(2*alpha)</code>.
Note that <code>lambda</code> is a single number if all covariates are to be penalized
equally, and a vector of penatlies, if predictors are divided in blocks (of sizes provided in
<code>p</code>) that are to be penalized differently. The <code>penalized.clr</code> function
is based on the Cox model routine available in the
<code>penalized</code> package.
</p>


<h3>Value</h3>

<p>A list with the following elements:
</p>

<ul>
<li> <p><code>penalized</code> - Regression coefficients for the penalized covariates.
</p>
</li>
<li> <p><code>unpenalized</code> - Regression coefficients for the unpenalized covariates.
</p>
</li>
<li> <p><code>converged</code> - Whether the fitting process was judged to have converged.
</p>
</li>
<li> <p><code>lambda</code> - The tuning parameter for L1 used.
</p>
</li>
<li> <p><code>alpha</code> - The elastic net mixing parameter used.
</p>
</li>
</ul>
<h3>See Also</h3>

<p><code>stable.clr</code> and <code>stable.clr.g</code> for variable selection through stability selection
in penalized conditional logistic regression with a single penalty factor and multiple penalty factors, respectively.
</p>


<h3>Examples</h3>

<pre><code class="language-R">set.seed(123)
# simulate covariates (pure noise in two blocks of 20 and 80 variables)
X &lt;- cbind(matrix(rnorm(4000, 0, 1), ncol = 20), matrix(rnorm(16000, 2, 0.6), ncol = 80))

# stratum membership
stratum &lt;- sort(rep(1:100, 2))

# the response
Y &lt;- rep(c(1, 0), 100)

fit &lt;- penalized.clr( response = Y, stratum = stratum,
  penalized = X, lambda = c(1, 0.3),
  p = c(20, 80), standardize = TRUE)
fit$penalized
fit$converged
fit$lambda
</code></pre>


</div>