<div class="container">

<table style="width: 100%;"><tr>
<td>check_cofactors</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>Build a multi-QTL model using step-wise procedure of checking genetic co-factors.</h2>

<h3>Description</h3>

<p>The function <code>check_cofactors</code> initially fits all significant QTL positions as co-factors, both individually and in combination. Significance thresholds
are re-estimated each time, yielding threshold-corrected LOD scores. If this leads to a change in the estimated position of QTL, or detection of subsequent peaks, a second 
round of co-factor inclusion is performed for all new QTL or novel QTL combinations. Finally, the multi-QTL model that maximises the individual significance of each
QTL is returned as a data.frame. This can be directly passed to the function <code>PVE</code> to estimate the percentage variance explained by the full
multi-QTL model and all possible sub-models. 
Note: this function estimates the most likely QTL positions by maximising the threshold-corrected LOD at QTL peaks.
Non-additive interactions between QTL may be missed as a result. It is recommended to run a manual co-factor analysis as well,
as described in the package vignette.
</p>


<h3>Usage</h3>

<pre><code class="language-R">check_cofactors(
  IBD_list,
  Phenotype.df,
  genotype.ID,
  trait.ID,
  LOD_data = NULL,
  min_res = 20,
  test_full_model = FALSE,
  verbose = TRUE,
  ...
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>IBD_list</code></td>
<td>
<p>List of IBD_probabilities as estimated using one of the various methods available (e.g. <code>estimate_IBD</code>).</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>Phenotype.df</code></td>
<td>
<p>A data.frame containing phenotypic values</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>genotype.ID</code></td>
<td>
<p>The colname of <code>Phenotype.df</code> that contains the population identifiers (F1 names) (must be a colname of <code>Phenotype.df</code>)</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>trait.ID</code></td>
<td>
<p>The colname of <code>Phenotype.df</code> that contains the response variable to use in the model (must be a colname of <code>Phenotype.df</code>)</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>LOD_data</code></td>
<td>
<p>Output of <code>QTLscan</code> function. Since v.0.1.0 this argument is optional - function will re-run a <code>QTLscan</code> if not provided. Indeed, it may be desirable
to not specify <code>LOD_data</code> if argument <code>test_full_model</code> is <code>TRUE</code>, as this will first combine the best results using additive-effects or allelic interaction-effects models before
searching for additional QTL.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>min_res</code></td>
<td>
<p>The minimum genetic distance (resolution) assumed possible to consider 2 linked QTL (on the same linkage group) as independent. By default a value of 20 cM is used.
This is not to suggest that 20 cM is a realistic resolution in a practical mapping study, but it provides the function with a criterion to consider 2 significant QTL within this distance as one and the same. 
For this purpose, 20 cM seems a reasonable value to use. In practice, closely linked QTL will generally "explain" all the variation at nearby positions, making it unlikely to
be able to disentangle their effects. QTL positions will vary slightly when co-factors are introduced, but again this variation is presumed not to exceed 20 cM either side.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>test_full_model</code></td>
<td>
<p>By default <code>FALSE</code>, in which case the normal additive-effects model is used in <code>QTLscan</code>. If set to <code>TRUE</code>,
then both the additive and full models are run for each genome-wide scan.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>verbose</code></td>
<td>
<p>Logical, by default <code>TRUE</code> - should progress messages be printed to the console?</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>...</code></td>
<td>
<p>Option to pass extra arguments to <code>QTLscan</code>, for example specifying <code>ncores</code> for parallel processing, or changing
the default settings of the permutation test (by default the number of permutations to perform = 1000 and alpha = 0.05). For a full list of options see the documentation of <code>QTLscan</code>.</p>
</td>
</tr>
</table>
<h3>Value</h3>

<p>Data frame with the following columns:
</p>

<dl>
<dt>LG</dt>
<dd>
<p>Linkage group identifier</p>
</dd>
<dt>cM</dt>
<dd>
<p>CentiMorgan position</p>
</dd>
<dt>deltaLOD</dt>
<dd>
<p>The difference between the LOD score at the peak and the significance threshold (always positive, otherwise the QTL would not be significant)</p>
</dd>
<dt>CofactorID</dt>
<dd>
<p>An identifier giving the co-factor model used in detecting the QTL (if no co-factors were included then <code>NA</code>). The co-factor model is described
by concatenating all co-factor positions with a '+', so for example 1_10+4_20 would mean a co-factor model with 2 positions included as co-factors, namely 10 cM on linkage
group 1 and 20 cM on linkage group 4.</p>
</dd>
</dl>
<h3>Examples</h3>

<pre><code class="language-R">data("IBD_4x","BLUEs.pheno","qtl_LODs.4x")
check_cofactors(IBD_list=IBD_4x,Phenotype.df=BLUEs.pheno,
genotype.ID="Geno",trait.ID="BLUE",LOD_data=qtl_LODs.4x)
</code></pre>


</div>