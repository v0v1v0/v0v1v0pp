<div class="container">

<table style="width: 100%;"><tr>
<td>phylo.to.sim</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>Converting a phylogeny in a paleobuddy object</h2>

<h3>Description</h3>

<p>Generates a <code>sim</code> object using a <code>phylo</code> object and some 
additional information (depending on other arguments). It is the inverse of 
the <code>make.phylo</code> function. Input is (1) a phylogeny, following an 
evolutionary Hennigian (sensu Ezard et al 2011) format (i.e., a fully 
bifurcating phylogeny), (2) information on the "mother lineage" of each tip 
in the phylogeny, (3) the status ("extant" or "extinct") of each lineage, 
(4) the stem age (or age of origination of the clade), and (5) the stem 
length (or time interval between the stem age and the first speciation 
event). The user can also choose if the event dating should be done from 
root to tips or from tips-to-root. The function returns a <code>sim</code> object 
(see <code>?sim</code>). The function does not accept more than one species having
<code>NA</code> as parent (which is interpreted as if there were no single common
ancestor in the phylogeny). In that case, use <code>find.lineages</code> first.
</p>


<h3>Usage</h3>

<pre><code class="language-R">phylo.to.sim(
  phy,
  mothers,
  extant,
  dateFromPresent = TRUE,
  stemAge = NULL,
  stemLength = NULL
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>phy</code></td>
<td>
<p>A <code>phylo</code> object, which may contain only extant or extant 
and extinct lineages.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>mothers</code></td>
<td>
<p>Vector containing the mother of each tip in the phylogeny. 
First species' mother should be <code>NA</code>. See details below.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>extant</code></td>
<td>
<p>Logical vector indicating which lineages are extant and 
extinct.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>dateFromPresent</code></td>
<td>
<p>Logical vector indicating if speciation/extinction 
events should be dated from present-to-root (<code>TRUE</code>, default value) or
from root-to-present. As it is impossible to date "from present" without a
living lineage, it is internally set to <code>FALSE</code> and prints a message in
the prompt if there are no extant species.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>stemAge</code></td>
<td>
<p>Numeric vetor indicating the age, in absolute geological time
(million years ago), when the first lineage of the clade originated. It is 
not needed when <code>dateFromPresent</code> is <code>TRUE</code> and <code>stemLength</code> 
is provided, or when <code>phy</code> has a <code>root.edge</code>. This argument is 
required if <code>dateFromPresent</code> is <code>FALSE</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>stemLength</code></td>
<td>
<p>Numeric vector indicating the time difference between the 
<code>stemAge</code> and the first speciation event of the group. This argument is
required if <code>dateFromPresent</code> is <code>FALSE</code>, but users have no need 
to assign values in this parameter if <code>phy</code> has a <code>$root.edge</code>,
which is taken by the function as the <code>stemLength</code> value.</p>
</td>
</tr>
</table>
<h3>Details</h3>

<p>See Details below for more information on each argument.
</p>
<p>Mothers:
</p>
<p>The function needs the indication of a mother lineage for every tip in the 
phylogeny but one (which is interpreted as the first known lineage in the 
clade, and should have <code>NA</code> as the mother). This assignment might be 
straightforward for simulations (as in the examples section below), but is a
non-trivial task for empirical phylogenies. As there are many ways to assign
impossible combinations of motherthood, the function does not return any 
specific error message if the provided motherhood does not map to possible 
lineages given the phylogeny. Instead, the function tends to crash when an 
"impossible" motherhood is assigned, but this is not guaranteed to happen 
because the set of "impossible" ways to assign motherhood is vast, and 
therefore has not allowed for a test of every possibility. If the function 
crashes when all lineages have reasonable motherhood, users should submit an
issue report at 
<a href="https://github.com/brpetrucci/paleobuddy/issues">https://github.com/brpetrucci/paleobuddy/issues</a>.
</p>
<p>Dating:
</p>
<p>Phylogenies store the relative distances between speciation (and possibly 
extinction) times of each lineage. However, to get absolute times for those 
events (which are required to construct the output of this function), users 
should provide a moment in absolute geological time to position the 
phylogeny. This could be (1) the present, which is used as reference 
in the case at least one lineage in the phylogeny is extant (i.e., default 
behavior of the function), or (2) some time in the past, which is the 
<code>stemAge</code> parameter. Those two possible dating methods are used by 
setting <code>dateFromPresent</code> to <code>TRUE</code> or <code>FALSE</code>. If users have
extant lineages in their phylogeny but do not have a reasonable value for 
<code>stemAge</code>, they are encouraged to use present-to-root dating 
(<code>dateFromPresent = TRUE</code>), as in that case deviations in the value of 
<code>stemLength</code> will only affect the speciation time of the first lineage 
of the clade. In other words, when <code>dateFromPresent</code> is set to 
<code>FALSE</code>, user error in <code>stemAge</code> or <code>stemLength</code> will bias
the absolute (but not the relative) dating of all nodes in the phylogeny.
</p>


<h3>Value</h3>

<p>A <code>sim</code> object. For details, see <code>?sim</code>. Items in the 
object follow their tip assignment in the phylogeny.
</p>


<h3>Author(s)</h3>

<p>Matheus Januario.
</p>


<h3>References</h3>

<p>Ezard, T. H., Pearson, P. N., Aze, T., &amp; Purvis, A. (2012). The meaning of 
birth and death (in macroevolutionary birth-death models). 
<em>Biology letters</em>, 8(1), 139-142.
</p>


<h3>Examples</h3>

<pre><code class="language-R">
# to check the usage of the function, let us make sure it transforms a 
# phylogeny generated with make.phylo back into the original simulation

### 
# birth-death process

# set seed
set.seed(1)

# run simulation
sim &lt;- bd.sim(1, lambda = 0.3, mu = 0.1, tMax = 10, nFinal = c(10, Inf))

# convert birth-death into phylo
phy &lt;- make.phylo(sim)

# convert phylo into a sim object again
res &lt;- phylo.to.sim(phy = phy, extant = sim$EXTANT, mothers = sim$PAR)

# test if simulation and converted object are the same
all.equal(sim, res)

### 
# birth-death process with extinct lineages:
# set seed
set.seed(1)

# run simulation
sim &lt;- bd.sim(1, lambda = 0.1, mu = 0.3, tMax = 10, nFinal = c(2, 4))

# convert birth-death into phylo
phy &lt;- make.phylo(sim)

# convert phylo into a sim object again
res &lt;- phylo.to.sim(phy = phy, extant = sim$EXTANT, mothers = sim$PAR, stemAge = max(sim$TS))

# test if simulation and converted object are the same
all.equal(sim, res)

###
# pure birth process

# set seed
set.seed(1)

# run simulation
sim &lt;- bd.sim(1, lambda = 0.2, mu = 0, tMax = 10, nFinal = c(10, Inf))

# convert birth-death into phylo
phy &lt;- make.phylo(sim)

# convert phylo into birth-death again
# note we can supply optional arguments, see description above
res &lt;- phylo.to.sim(phy = phy, extant = sim$EXTANT, mothers = sim$PAR, 
                stemAge = 10, stemLength = (10 - sim$TS[2]))

# testing if simulation and converted object are the same
all.equal(sim, res)

</code></pre>


</div>