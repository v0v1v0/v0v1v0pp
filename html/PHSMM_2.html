<div class="container">

<table style="width: 100%;"><tr>
<td>decodeHSMM</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>State decoding</h2>

<h3>Description</h3>

<p>State decoding for the HSMM estimated using <code>pmleHSMM</code>. Decoding is based on the Viterbi algorithm and the corresponding HMM model representation.</p>


<h3>Usage</h3>

<pre><code class="language-R">decodeHSMM(y, mod)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>y</code></td>
<td>
<p>vector containing the observed time series.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>mod</code></td>
<td>
<p>model object as returned by <code>pmleHSMM</code>.</p>
</td>
</tr>
</table>
<h3>Value</h3>

<p>Returns a vector containing the decoded states.
</p>


<h3>References</h3>

<p>For more details about the Viterbi algorithm, see for example:
</p>
<p>Zucchini, W., MacDonald, I.L. and Langrock, R. (2016): <em>Hidden Markov models for time series:
An introduction using R</em>. 2nd edition. Chapman &amp; Hall/CRC, Boca Raton.
</p>


<h3>Examples</h3>

<pre><code class="language-R">
# running this example might take a few minutes
#
# 1.) 2-state gamma-HSMM for hourly muskox step length
# with an unstructured start of length of 10
#
# initial values
p_list0&lt;-list()
p_list0[[1]]&lt;-c(dgeom(0:9,0.2),1-pgeom(9,0.2))
p_list0[[2]]&lt;-c(dgeom(0:9,0.2),1-pgeom(9,0.2))
mu0&lt;-c(5,150)
sigma0&lt;-c(3,180)
#
# fit 2-state gamma-HSMM with lambda=c(100,100)
# and difference order 3
# estimation might take a few minutes
PHSMM&lt;-pmleHSMM(y=muskox$step,N=2,p_list=p_list0,mu=mu0,
                sigma=sigma0,lambda=c(100,100),order_diff=3,
                y_dist='gamma')
#
# state decoding
s_HSMM&lt;-decodeHSMM(muskox$step,mod=PHSMM)
# plot sequence of the decoded time series
plot(muskox$step[1:1000],type='h',xlab='time (h)',ylab='step (m)',
  main='',col=s_HSMM)
legend('topright',c('state 1','state 2'),lwd=2,col=1:2)




# running this example might take a few minutes
#
# 2.) 3-state gamma-HSMM for hourly muskox step length
# with an unstructured start of length of 10
#
# initial values
p_list0&lt;-list()
p_list0[[1]]&lt;-c(dgeom(0:9,0.2),1-pgeom(9,0.2))
p_list0[[2]]&lt;-c(dgeom(0:9,0.2),1-pgeom(9,0.2))
p_list0[[3]]&lt;-c(dgeom(0:9,0.2),1-pgeom(9,0.2))
omega0&lt;-matrix(0.5,3,3)
diag(omega0)&lt;-0
mu0&lt;-c(5,100,350)
sigma0&lt;-c(3,90,300)
#
# fit 3-state gamma-HSMM with lambda=c(1000,1000,1000)
# and difference order 3
# estimation might take some minutes
PHSMM&lt;-pmleHSMM(y=muskox$step,N=3,p_list=p_list0,mu=mu0,
                sigma=sigma0,omega=omega0,
                lambda=c(1000,1000,1000),
                order_diff=3,y_dist='gamma')
#
# state decoding
s_HSMM&lt;-decodeHSMM(muskox$step,mod=PHSMM)
# plot sequence of the decoded time series
plot(muskox$step[1:1000],type='h',xlab='time (h)',ylab='step (m)',
  main='',col=s_HSMM)
legend('topright',c('state 1','state 2', 'state 3'),lwd=2,col=1:3)

</code></pre>


</div>