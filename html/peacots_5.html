<div class="container">

<table style="width: 100%;"><tr>
<td>peacots-package</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>
Periodogram peaks in correlated time series
</h2>

<h3>Description</h3>

<p>Calculate the periodogram of a time series, maximum-likelihood fit an Ornstein-Uhlenbeck state space (OUSS) null model to the periodogram and evaluate the statistical significance of periodogram peaks against the OUSS null hypothesis.
</p>


<h3>Details</h3>


<table>
<tr>
<td style="text-align: left;">
Package: </td>
<td style="text-align: left;"> peacots</td>
</tr>
<tr>
<td style="text-align: left;">
Type: </td>
<td style="text-align: left;"> Package</td>
</tr>
<tr>
<td style="text-align: left;">
Version: </td>
<td style="text-align: left;"> 1.2</td>
</tr>
<tr>
<td style="text-align: left;">
Date: </td>
<td style="text-align: left;"> 2015-06-13</td>
</tr>
<tr>
<td style="text-align: left;">
License: </td>
<td style="text-align: left;"> GPL-3</td>
</tr>
<tr>
<td style="text-align: left;">
</td>
</tr>
</table>
<p>The OUSS is a parsimonious model for a stochastically fluctuating variable (e.g. population size) with linear stabilizing forces, subject to uncorrelated measurement errors. Periodogram peaks (putative periodicities) are evaluated against this null hypothesis. In contrast to the white noise null model (the classical null model against which cyclicity is often evaluated), the OUSS process accounts for non-zero correlations between measurements and corrects for the resulting increased power at low frequencies.
</p>
<p>Use <code>evaluate.pm</code> to calculate the periodogram of a time series, fit the OUSS null model and calculate the statistical significance of the periodogram maximum.
</p>
<p>Use <code>plotReport</code> to generate a simple plot of the results returned by <code>evaluate.pm</code>.
</p>
<p>Use <code>significanceOfLocalPeak</code> to evaluate the statistical significance of a secondary peak (i.e. non-global maximum) in the periodogram.
</p>
<p>Use <code>runExample</code> to run an example <code>peacots</code> analysis based on simulation data.
</p>
<p>Use <code>evaluate.pm.wn</code> to evaluate the statistical significance of the periodogram maximum against the white noise null hypothesis. This is the classical test, included for comparison.
</p>
<p>Use <code>ps_ouss_asymptotic</code> to calculate the power spectrum of a particular OUSS process.
</p>
<p>Use <code>ps_ouss</code> to calculate the expected periodogram from a finite time series of a particular OUSS process.
</p>
<p>Use <code>generate_ouss</code> to generate random time series of a particular OUSS process.
</p>


<h3>Author(s)</h3>

<p>Stilianos Louca
</p>


<h3>References</h3>

<p>Louca, S., Doebeli, M. (2015) Detecting cyclicity in ecological time series, Ecology 96: 1724â€“1732
</p>


<h3>Examples</h3>

<pre><code class="language-R"># Generate a cyclic time series and analyse using peacots

# Parameters
lambda         = 1;    # inverse correlation time of OU process
cyclePeriod    = 1;
cycleAmplitude = 0.6;
times          = seq(0,20,0.25);

# Example 1

# generate cyclic time series by adding a periodic signal to an OUSS process
signal 	= cycleAmplitude * cos(2*pi*times/cyclePeriod) +
          generate_ouss(times, mu=0, sigma=1, lambda=lambda, epsilon=0.5);

# Find periodogram peak and estimate statistical significance
# Ignore frequencies lower than a pre-defined threshold
# to avoid masking by low-frequency maximum
report 	= evaluate.pm(times=times, signal=signal, 
                      minPeakFreq=lambda/3, 
                      minFitFreq=lambda/3,
                      startRadius=2);

# plot overview of periodogram peak analysis
plotReport(sprintf("Cyclic at frequency %.2g",1/cyclePeriod), 
           times=times, signal=signal, report=report);


# Example 2 (using the same time series)
# In this example we don't use low-frequency trimming
# Instead, we will focus on a particular (local) periodogram peak
# and estimate its 'local' statistical significance

# calculate periodogram and fit OUSS model
report    = evaluate.pm(times=times, signal=signal, startRadius=2);

# find the periodogram mode approximately corresponding to the frequency we are interested in
cycleMode = which(report$frequencies&gt;=0.99/cyclePeriod)[1];

# calculate local P-value for this peak
Pvalue    = significanceOfLocalPeak(power_o     = report$power_o, 
                                    lambda      = report$lambda, 
                                    power_e     = report$power_e, 
                                    time_step   = report$time_step,
                                    series_size = length(times),
                                    Nfreq       = length(report$frequencies), 
                                    peakFreq    = report$frequencies[cycleMode], 
                                    peakPower   = report$periodogram[cycleMode]);

# print result
cat(sprintf("Local P-value = %.3g for peak at frequency=%.3g\n", 
    Pvalue, report$frequencies[cycleMode]));
</code></pre>


</div>