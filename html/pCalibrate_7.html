<div class="container">

<table style="width: 100%;"><tr>
<td>pCalibrate</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>Calibrations of two-sided p-values directly based on the p-value

</h2>

<h3>Description</h3>

<p>Transforms a two-sided p-value to a minimum Bayes factor.
That minimum Bayes factor is obtained by modelling the distributions
of the p-value under the null and the alternative hypothesis,
respectively.

</p>


<h3>Usage</h3>

<pre><code class="language-R">pCalibrate(p,  type="exploratory", transform="id")

</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>p</code></td>
<td>

<p>a vector of two-sided p-values

</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>type</code></td>
<td>

<p>either <code>"exploratory"</code> or <code>"confirmatory"</code>.
Defaults to <code>"exploratory"</code>.


Corresponds to different distrbutional assumptions for the p-value p
under the alternative.
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>transform</code></td>
<td>

<p>either <code>"id"</code>, <code>"log"</code>, <code>"log2"</code>  or <code>"log10"</code>.
Defaults to <code>"id"</code>.
Specifies how to transform the minimum Bayes factor(s).
<code>"id"</code> corresponds to no transformation.
<code>"log"</code> refers to the natural logarithm, <code>"log2"</code> to the logarithm
to the base 2 and <code>"log10"</code> to the logarithm
to the base 10.
</p>
</td>
</tr>
</table>
<h3>Details</h3>

<p>If <code>type="exploratory"</code> is used,
the so-called "- e p log(p)" calibration (Sellke et al., 2001)
is applied.
</p>
<p>If <code>type="confirmatory"</code> is used,
the  the so-called "- e q log(q)" calibration with q=1-p (Held &amp; Ott, 2018)
is applied.
</p>
<p><code>type="exploratory"</code> gives a larger minimum Bayes factor than <code>type="confirmatory"</code>.
</p>
<p>Under the null hypothesis, the distribution of the p-value
is assumed to be uniform.
Under the alternative, the p-value is assumed to have a beta-distribution
with monotonically decreasing density function under both alternatives,
with different parameters however.
If <code>type="exploratory"</code>, the prior sample size
does not exceed 2, whereas for <code>type="confirmatory"</code>,
the prior sample size is at least 2.
The latter calibration may be appropriate for small sample size,
but for larger sample size it is too conservative (Held &amp; Ott, 2018).
</p>
<p>Note that for the "- e p log(p)" calibration,
alternative derivations which do not assume a beta-distribution under the
alternative have also been given, see Sellke et al. (2001).

</p>


<h3>Value</h3>

<p>A numeric vector of minimum Bayes factors for the specified p-values
</p>


<h3>Note</h3>

<p>The argument <code>type</code> replaces the argument <code>alternative</code>
in version 0.1-1 of this package. <br><code>type="exploratory"</code> corresponds to <code>alternative="noninformative"</code>
and <br><code>type="confirmatory"</code> corresponds to <code>alternative="informative"</code>.
</p>


<h3>References</h3>

<p>Held, L. and Ott, M. (2018). On p-values and Bayes factors.
<em>Annual Review of Statistics and Its Application</em>, <b>5</b>, 393–419.
</p>
<p>Sellke, T., Bayarri, M. J. and Berger, J. O. (2001). Calibration of p values for testing precise null hypotheses.
<em>The American Statistician</em>, <b>55</b>, 62–71.
</p>
<p>Vovk, V. G. (1993). A logic of probability, with application to the foundations of statistics (with discussion and a reply by the author). <em>Journal of the Royal Statistical Society, Series B</em>, <b>55</b>, 317–351.

</p>


<h3>Examples</h3>

<pre><code class="language-R">pCalibrate(p=c(0.05, 0.01, 0.001))
pCalibrate(p=c(0.05, 0.01, 0.001), type="confirmatory")

# plot the 2 calibrations as a function of the p-value
par(las=1)
p &lt;- exp(seq(log(0.0001), log(0.3), by=0.01))
minBF1 &lt;- pCalibrate(p=p)
minBF2 &lt;- pCalibrate(p=p, type="confirmatory")
plot(p, minBF1, type="l", log="xy",
      xlab="Two sided p-value", ylab="Minimum Bayes factor", 
     axes=FALSE, lwd=2, col=1)
lines(p, minBF2, col=2, lwd=2)
axis(1, at=c(0.0001, 0.0003, 0.001, 0.003, 0.01, 0.03, 0.1, 0.3), 
     as.character(c(format(c(0.0001,0.0003), nsmall=4, digits=4, 
                  scientific=FALSE), 
     c(0.001, 0.003, 0.01, 0.03, 0.1, 0.3))))
my.values &lt;- c(3000, 1000, 300, 100, 30, 10, 3, 1)
my.at &lt;- 1/my.values
my.ylegend &lt;- c(paste("1/", my.values[-length(my.values)], sep=""), "1")
axis(2, at=my.at, my.ylegend)
box()
legend("bottomright", lty=1, lwd=2, 
        legend=c("- e p log(p)", "- e q log(q)")
                , col=c(1,2))
</code></pre>


</div>