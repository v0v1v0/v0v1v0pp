<div class="container">

<table style="width: 100%;"><tr>
<td>evol.vcv</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>Likelihood test for variation in the evolutionary variance-covariance matrix</h2>

<h3>Description</h3>

<p>Fits a multi-regime multivariate Brownian motion model following Revell &amp; Collar (2009).
</p>


<h3>Usage</h3>

<pre><code class="language-R">evol.vcv(tree, X, maxit=2000, vars=FALSE, ...)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>tree</code></td>
<td>
<p>an object of class <code>"simmap"</code>. If <code>tree</code> is an object of class <code>"phylo"</code> then a simple multivariate Brownian motion model will be fit to the data in <code>X</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>X</code></td>
<td>
<p>an <code>n</code> x <code>m</code> matrix of tip values for <code>m</code> continuously valued traits in <code>n</code> species - row names should be species names. If <code>X</code> is supplied as a data frame it will be coerced into a matrix without warning.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>maxit</code></td>
<td>
<p>an optional integer value indicating the maximum number of iterations for optimization. This quantity may need to be increased for difficult optimizations.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>vars</code></td>
<td>
<p>an optional logical value indicating whether or not to estimate the variances of the parameter estimates from the Hessian matrix.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>...</code></td>
<td>
<p>optional arguments. The most important optional argument at this time is <code>error_vcv</code> which should contain a list of matrices of sampling <em>variances</em> and covariances for (and between) the means of each species. The sampling variance for the mean is just the square of the sampling error. Sampling covariances will tend to be zero (or close to zero) if error for different traits is uncorrelated, for instance, because different specimens were used to estimate the means for different traits, and non-zero otherwise.</p>
</td>
</tr>
</table>
<h3>Details</h3>

<p>The function takes an object of class <code>"simmap"</code> with a mapped binary or multi-state trait and data for an arbitrary number of continuously valued character. It then fits the multiple evolutionary variance-covariance matrix (rate matrix) model of Revell &amp; Collar (2009; <em>Evolution</em>).
</p>
<p><code>evol.vcv</code> performs optimization by maximizing the likelihood with respect to the Cholesky matrices using <code>optim</code>.	Optimization is by <code>method="Nelder-Mead"</code>. Using box constraints does not make sense here as they would be applied to the Cholesky matrix rather than the target parameters. Users may have to increase <code>maxit</code> for large trees and/or more than two traits.
</p>


<h3>Value</h3>

<p>An object of class <code>"evol.vcv"</code> with the following elements:
</p>
<table>
<tr style="vertical-align: top;">
<td><code>R.single</code></td>
<td>
<p>vcv matrix for the single rate matrix model.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>vars.single</code></td>
<td>
<p>optionally, a matrix containing the variances of the elements of <code>R.single</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>logL1</code></td>
<td>
<p>log-likelihood for single matrix model.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>k1</code></td>
<td>
<p>number of parameters in the single matrix model.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>R.multiple</code></td>
<td>
<p><code>m</code> x <code>m</code> x <code>p</code> array containing the <code>p</code> estimated vcv matrices for the <code>p</code> regimes painted on the tree.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>vars.multiple</code></td>
<td>
<p>optionally, an array containing the variances of the parameter estimates in <code>R.multiple</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>logL.multiple</code></td>
<td>
<p>log-likelihood of the multi-matrix model.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>k2</code></td>
<td>
<p>number of parameters estimated in this model.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>P.chisq</code></td>
<td>
<p>P-value of the <code class="reqn">\chi^2</code> test on the likelihood ratio.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>convergence</code></td>
<td>
<p>logical value indicating whether or not the optimization has converged.</p>
</td>
</tr>
</table>
<h3>Author(s)</h3>

<p>Liam Revell <a href="mailto:liam.revell@umb.edu">liam.revell@umb.edu</a></p>


<h3>References</h3>

<p>Revell, L. J. (2024) phytools 2.0: an updated R ecosystem for phylogenetic comparative methods (and other things). <em>PeerJ</em>, <b>12</b>, e16505.
</p>
<p>Revell, L. J., and D. C. Collar (2009) Phylogenetic analysis of the evolutionary correlation using likelihood. <em>Evolution</em>, <b>63</b>, 1090-1100.
</p>


<h3>See Also</h3>

<p><code>evol.rate.mcmc</code>, <code>brownie.lite</code>
</p>


<h3>Examples</h3>

<pre><code class="language-R">## load data from Revell &amp; Collar (2009)
data(sunfish.tree)
data(sunfish.data)
## fit multi-correlation model
sunfish.fit&lt;-evol.vcv(sunfish.tree,sunfish.data[,2:3])
print(sunfish.fit)
</code></pre>


</div>