<div class="container">

<table style="width: 100%;"><tr>
<td>mc3_pep</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>Bayesian variable selection with MC3 algorithm</h2>

<h3>Description</h3>

<p>Given a response vector and an input data matrix, performs Bayesian variable 
selection using the MC3 algorithm. Normal linear models are assumed for 
the data with the prior distribution on the model parameters 
(beta coefficients and error variance) being the PEP or the intrinsic. The prior 
distribution on the model space can be the uniform on the model 
space or the uniform on the model dimension (special case of the beta-binomial prior).
</p>


<h3>Usage</h3>

<pre><code class="language-R">mc3_pep(
  x,
  y,
  intrinsic = FALSE,
  reference.prior = TRUE,
  beta.binom = TRUE,
  ml_constant.term = FALSE,
  burnin = 1000,
  itermc3 = 11000
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>x</code></td>
<td>
<p>A matrix of numeric (of size nxp), input data matrix.
This matrix contains the values of the p explanatory variables 
without an intercept column of 1's.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>y</code></td>
<td>
<p>A vector of numeric (of length n), response vector.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>intrinsic</code></td>
<td>
<p>Boolean, indicating whether the PEP 
(<code>FALSE</code>) or the intrinsic - which   
is a special case of it - (<code>TRUE</code>) should be used as prior on the  
regression parameters. Default value=<code>FALSE</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>reference.prior</code></td>
<td>
<p>Boolean, indicating whether the reference prior
(<code>TRUE</code>) or the dependence Jeffreys prior (<code>FALSE</code>) is used as 
baseline. Default value=<code>TRUE</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>beta.binom</code></td>
<td>
<p>Boolean, indicating whether the beta-binomial 
distribution (<code>TRUE</code>) or the uniform distribution (<code>FALSE</code>)    
should be used as prior on the model space. Default value=<code>TRUE</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>ml_constant.term</code></td>
<td>
<p>Boolean, indicating whether the constant
(marginal likelihood of the null/intercept-only model) should be
included in computing the marginal likelihood of a model (<code>TRUE</code>)  
or not (<code>FALSE</code>). Default value=<code>FALSE</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>burnin</code></td>
<td>
<p>Non-negative integer, the burnin period for the MC3 algorithm.
Default value=1000.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>itermc3</code></td>
<td>
<p>Positive integer (larger than <code>burnin</code>),
the (total) number of iterations for the MC3 algorithm. Default value=11000.</p>
</td>
</tr>
</table>
<h3>Details</h3>

<p>The function works when p&lt;=n-2 where p is the number of explanatory variables
and n is the sample size.
</p>
<p>It is suggested to use this function (i.e. MC3 algorithm) when p is 
larger than 20.
</p>
<p>The reference model is the null model (i.e. intercept-only model).
</p>
<p>The case of missing data (i.e. presence of <code>NA</code>'s either in the  
input matrix or the response vector) is not currently supported.
</p>
<p>The intercept term is included in all models.
</p>
<p>If p&gt;1, the input matrix needs to be of full rank.
</p>
<p>The reference prior as baseline corresponds to hyperparameter values
d0=0 and d1=0, while the dependence Jeffreys prior corresponds to 
model-dependent-based values for the hyperparameters d0 and d1,
see Fouskakis and Ntzoufras (2022) for more details.
</p>
<p>The MC3 algorithm was first introduced by Madigan and York (1995)
while its current implementation is described in the Appendix 
of Fouskakis and Ntzoufras (2022).
</p>
<p>When <code>ml_constant.term=FALSE</code> then the log marginal likelihood of a
model in the output is shifted by -logC1
(logC1: marginal likelihood of the null model).
</p>
<p>When the prior on the model space is beta-binomial 
(i.e. <code>beta.binom=TRUE</code>), the following special case is used: uniform 
prior on model size.
</p>


<h3>Value</h3>

<p><code>mc3_pep</code> returns an object of class <code>pep</code>, 
as this is described in detail in <code>full_enumeration_pep</code>. The
difference is that here the number of rows of the first list element
is not 2^p but the number of unique models ‘visited’ by the 
MC3 algorithm. Further, the posterior probability of a model corresponds to
the estimated posterior probability as this is computed by the relative
Monte Carlo frequency of the ‘visited’ models by the MC3 algorithm.
</p>


<h3>References</h3>

<p>Fouskakis, D. and Ntzoufras, I. (2022) Power-Expected-Posterior 
Priors as Mixtures of g-Priors in Normal Linear Models. 
Bayesian Analysis, 17(4): 1073-1099. <a href="https://doi.org/10.1214/21-BA1288">doi:10.1214/21-BA1288</a>
</p>
<p>Madigan, D. and York, J. (1995) Bayesian Graphical Models for Discrete Data.
International Statistical Review, 63(2): 215–232. <a href="https://doi.org/10.2307/1403615">doi:10.2307/1403615</a>
</p>


<h3>See Also</h3>

<p><code>full_enumeration_pep</code>
</p>


<h3>Examples</h3>

<pre><code class="language-R">data(UScrime_data)
y &lt;- UScrime_data[,"y"]
X &lt;- UScrime_data[,-15]
set.seed(123)
res &lt;- mc3_pep(X,y,itermc3=3000)
resu &lt;- mc3_pep(X,y,beta.binom=FALSE,itermc3=3000)
resj &lt;- mc3_pep(X,y,reference.prior=FALSE,burnin=500,itermc3=2200)

</code></pre>


</div>