<div class="container">

<table style="width: 100%;"><tr>
<td>textstat-class</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>S4 textstat superclass.</h2>

<h3>Description</h3>

<p>The <code>textstat</code> S4 class is the superclass for the classes <code>features</code>,
<code>context</code>, and <code>partition</code>. Usually, these subclasses, which are designed to
serve a specified analytical purpose, will be used . Common standard generic
methods such as <code>head</code>, <code>tail</code>, <code>dim</code>, <code>nrow</code>, <code>colnames</code> are defined for the
<code>textstat</code> class and are available for subclasses by inheritence. The core of
<code>textstat</code> and its childs is a <code>data.table</code> in the slot <code>stat</code> for keeping
data on text statistics of a <code>corpus</code>, or a <code>partition</code>. The <code>textstat</code> class
inherits from the <code>corpus</code> class, keeping information on the corpus
available.
</p>


<h3>Usage</h3>

<pre><code class="language-R">## S4 method for signature 'textstat'
name(x)

## S4 method for signature 'character'
name(x)

## S4 replacement method for signature 'textstat'
name(x) &lt;- value

## S4 method for signature 'textstat'
round(x, digits = 2L)

## S4 method for signature 'textstat'
sort(x, by, decreasing = TRUE)

as.bundle(object, ...)

## S4 method for signature 'textstat,textstat'
e1 + e2

## S4 method for signature 'textstat'
subset(x, subset)

## S3 method for class 'textstat'
as.data.table(x, ...)

## S4 method for signature 'textstat'
show(object)

## S4 method for signature 'textstat'
p_attributes(.Object)

## S4 method for signature 'textstat'
knit_print(x, options = knitr::opts_chunk, ...)

## S4 method for signature 'textstat'
get_corpus(x)

## S4 method for signature 'textstat'
format(x, digits = 2L)

restore(file)

cp(x)

## S4 method for signature 'textstat'
view(.Object)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>x</code></td>
<td>
<p>An object (<code>textstat</code> or class inheriting from <code>textstat</code>).</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>value</code></td>
<td>
<p>A <code>character</code> vector to assign as name to slot <code>name</code>
of a <code>textstat</code> class object.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>digits</code></td>
<td>
<p>Number of digits.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>by</code></td>
<td>
<p>Column that will serve as the key for sorting.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>decreasing</code></td>
<td>
<p>Logical, whether to return decreasing order.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>object</code></td>
<td>
<p>a textstat object</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>...</code></td>
<td>
<p>Argument that will be passed into a call of the <code>format</code> method
on the object <code>x</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>e1</code></td>
<td>
<p>A <code>texstat</code> object.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>e2</code></td>
<td>
<p>Another <code>texstat</code> object.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>subset</code></td>
<td>
<p>A logical expression indicating elements or rows to keep.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>.Object</code></td>
<td>
<p>A <code>textstat</code> object.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>options</code></td>
<td>
<p>Chunk options.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>file</code></td>
<td>
<p>An rds file to restore (filename).</p>
</td>
</tr>
</table>
<h3>Details</h3>

<p>A <code>head</code>-method will return the first rows of the <code>data.table</code> in
the <code>stat</code>-slot. Use argument <code>n</code> to specify the number of rows.
</p>
<p>A <code>tail</code>-method will return the last rows of the <code>data.table</code> in
the <code>stat</code>-slot. Use argument <code>n</code> to specify the number of rows.
</p>
<p>The methods <code>dim</code>, <code>nrow</code> and <code>ncol</code> will return information
on the dimensions, the number of rows, or the number of columns of the
<code>data.table</code> in the <code>stat</code>-slot, respectively.
</p>
<p>Objects derived from the <code>textstat</code> class can be indexed with simple
square brackets ("[") to get rows specified by an numeric/integer vector,
and with double square brackets ("[[") to get specific columns from the
<code>data.table</code> in the slot <code>stat</code>.
</p>
<p>The <code>colnames</code>-method will return the column names of the <code>data-table</code>
in the slot <code>stat</code>.
</p>
<p>The methods <code>as.data.table</code>, and <code>as.data.frame</code> will extract the
<code>data.table</code> in the slot <code>stat</code> as a <code>data.table</code>, or <code>data.frame</code>,
respectively.
</p>
<p><code>textstat</code> objects can have a name, which can be retrieved, and set using
the <code>name</code>-method and <code style="white-space: pre;">⁠name&lt;-⁠</code>, respectively.
</p>
<p>The <code>round()</code>-method looks up all numeric columns in the
<code>data.table</code> in the <code>stat</code>-slot of the <code>textstat</code> object and
rounds values of these columns to the number of decimal places specified by
argument <code>digits</code>.
</p>
<p>The <code>knit_print</code> method will be called by knitr to render
<code>textstat</code> objects or objects inheriting from the <code>textstat</code> class as a
DataTable  <code>htmlwidget</code> when rendering a R Markdown document as html.
It will usually be necessary to explicitly state "render = knit_print" in
the chunk options. The option <code>polmineR.pagelength</code> controls the number of
lines displayed in the resulting <code>htmlwidget</code>. Note that including
htmlwidgets in html documents requires that pandoc is installed. To avoid
an error, a formatted <code>data.table</code> is returned by <code>knit_print</code> if
pandoc is not available.
</p>
<p>The <code>format()</code>-method returns a pretty-printed and minimized version
of the <code>data.table</code> in the <code>stat</code>-slot of the <code>textstat</code>-object: It will
round all numeric columns to the number of decimal numbers specified by
<code>digits</code>, and drop all columns with token ids. The return value is a
<code>data.table</code>.
</p>
<p>Using the reference semantics of <code>data.table</code> objects (i.e. inplace
modification) has great advantages for  memory efficiency. But there may be
unexpected behavior when reloading an S4 <code>textstat</code> object (including classes
inheriting from <code>textstat</code>) with a <code>data.table</code> in the <code>stat</code> slot. Use
<code>restore</code> to copy the <code>data.table</code> once to have a restored object that works
for inplace operations after saving / reloading it.
</p>
<p>It is not possible to add columns to the <code>data.table</code> in the <code>stat</code>
slot of a <code>textclass</code> object, when the object has been saved and loaded
using <code>save()</code>/<code>load()</code>. This scenario applies for instance, when the
objects of an interactive R session are saved, and loaded when starting the
next interactive R session. The <code>cp()</code> function will create a copy of the
object, including an explicit copy of the <code>data.table</code> in the <code>stat</code> slot.
Inplace modifications of the new object are possible. The function can also
be used to avoid unwanted side effects of modifying an object.
</p>


<h3>Slots</h3>


<dl>
<dt><code>p_attribute</code></dt>
<dd>
<p>Object of class <code>character</code>, p-attribute of the query.</p>
</dd>
<dt><code>corpus</code></dt>
<dd>
<p>A corpus specified by a length-one <code>character</code> vector.</p>
</dd>
<dt><code>stat</code></dt>
<dd>
<p>A <code>data.table</code> with statistical information.</p>
</dd>
<dt><code>name</code></dt>
<dd>
<p>The name of the object.</p>
</dd>
<dt><code>annotation_cols</code></dt>
<dd>
<p>A <code>character</code> vector, column names of
<code>data.table</code> in slot <code>stat</code> that are annotations.</p>
</dd>
<dt><code>encoding</code></dt>
<dd>
<p>A length-one <code>character</code> vector, the encoding of the corpus.</p>
</dd>
</dl>
<h3>Examples</h3>

<pre><code class="language-R">use(pkg = "polmineR", corpus = "GERMAPARLMINI")
use(pkg = "RcppCWB", corpus = "REUTERS")

P &lt;- partition("GERMAPARLMINI", date = ".*", p_attribute = "word", regex = TRUE)
y &lt;- cooccurrences(P, query = "Arbeit")

# generics defined in the polmineR package
x &lt;- count("REUTERS", p_attribute = "word")
name(x) &lt;- "count_reuters"
name(x)
get_corpus(x)

# Standard generic methods known from data.frames work for objects inheriting
# from the textstat class

head(y)
tail(y)
nrow(y)
ncol(y)
dim(y)
colnames(y)

# Use brackets for indexing 

## Not run: 
y[1:25]
y[,c("word", "ll")]
y[1:25, "word"]
y[1:25][["word"]]
y[which(y[["word"]] %in% c("Arbeit", "Sozial"))]
y[ y[["word"]] %in% c("Arbeit", "Sozial") ]

## End(Not run)
sc &lt;- partition("GERMAPARLMINI", speaker = "Angela Dorothea Merkel")
cnt &lt;- count(sc, p_attribute = c("word", "pos"))
cnt_min &lt;- subset(cnt, pos %in% c("NN", "ADJA"))
cnt_min &lt;- subset(cnt, pos == "NE")
use(pkg = "RcppCWB", corpus = "REUTERS")

# Get statistics in textstat object as data.table
count_dt &lt;- corpus("REUTERS") %&gt;%
  subset(grep("saudi-arabia", places)) %&gt;% 
  count(p_attribute = "word") %&gt;%
  as.data.table()

# textstat objects stored as *.rds files should be loaded using restore().
# Before moving to examples, this is a brief technical dip why this is
# recommended: If we load the *.rds file with readRDS(), the data.table in
# the slot 'stat' will have the pointer '0x0', and the data.table cannot be
# augmented without having been copied previously.

k &lt;- kwic("REUTERS", query = "oil")
kwicfile &lt;- tempfile(fileext = ".rds")
saveRDS(k, file = kwicfile)
problemprone &lt;- readRDS(file = kwicfile)
problemprone@stat[, "newcol" := TRUE]
"newcol" %in% colnames(problemprone@stat) # is FALSE!

attr(problemprone@stat, ".internal.selfref")
identical(attr(problemprone@stat, ".internal.selfref"), new("externalptr"))

# Restore stored S4 object with copy of data.table in 'stat' slot
k &lt;- kwic("REUTERS", query = "oil")
kwicfile &lt;- tempfile(fileext = ".rds")
saveRDS(k, file = kwicfile)

k2 &lt;- restore(kwicfile)
enrich(k2, s_attribute = "id")
"id" %in% colnames(k2) # is TRUE
k &lt;- kwic("REUTERS", query = "oil")
rdata_file &lt;- tempfile(fileext = ".RData")
save(k, file = rdata_file)
rm(k)

load(rdata_file)
k &lt;- cp(k) # now it is possible to columns by reference
enrich(k, s_attribute = "id")
"id" %in% colnames(k)
</code></pre>


</div>