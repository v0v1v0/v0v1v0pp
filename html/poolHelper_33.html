<div class="container">

<table style="width: 100%;"><tr>
<td>remove_by_reads_matrix</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>Apply a coverage-based filter to a matrix</h2>

<h3>Description</h3>

<p>This function removes sites that have a coverage below a <code>minimum</code> value and
sites with a coverage above a <code>maximum</code> value. If a matrix of genotypes is
also supplied, then those same sites are also removed from that matrix.
</p>


<h3>Usage</h3>

<pre><code class="language-R">remove_by_reads_matrix(reads, minimum, maximum, genotypes = NA)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>reads</code></td>
<td>
<p>a matrix with the total depth of coverage. Each row of the
matrix should be the coverage of a different population and each column a
different site.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>minimum</code></td>
<td>
<p>an integer representing the minimum coverage allowed. Sites
where any population has a depth of coverage below this threshold are
removed from the data.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>maximum</code></td>
<td>
<p>an integer representing the maximum coverage allowed. Sites
where any population has a depth of coverage above this threshold are
removed from the data.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>genotypes</code></td>
<td>
<p>an optional matrix input with the genotypes. Each column of
the matrix should be a different site and each row a different individual.</p>
</td>
</tr>
</table>
<h3>Value</h3>

<p>a matrix with the total depth of coverage minus the sites (i.e.
columns) where the coverage for any of the populations was below the
minimum or above the maximum. If genotypes were supplied, then the output
will be a list, with one entry per locus. Each entry will contain the
filtered coverage in the first entry and the genotypes, minus the removed
sites, in the second entry.
</p>


<h3>Examples</h3>

<pre><code class="language-R">set.seed(10)

# simulate coverage for a single locus - select the first entry to obtain a matrix
reads &lt;- simulateCoverage(mean = c(25, 25), variance = c(200, 200), nSNPs = 10, nLoci = 1)[[1]]

# check the coverage matrix
reads

# remove sites with coverage below 10x or above 100x
remove_by_reads_matrix(reads = reads, minimum = 10, maximum = 100)

</code></pre>


</div>