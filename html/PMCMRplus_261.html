<div class="container">

<table style="width: 100%;"><tr>
<td>tamhaneT2Test</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>Tamhane's T2 Test</h2>

<h3>Description</h3>

<p>Performs Tamhane's T2 (or T2') all-pairs comparison test for normally distributed
data with unequal variances.
</p>


<h3>Usage</h3>

<pre><code class="language-R">tamhaneT2Test(x, ...)

## Default S3 method:
tamhaneT2Test(x, g, welch = TRUE, ...)

## S3 method for class 'formula'
tamhaneT2Test(formula, data, subset, na.action, welch = TRUE, ...)

## S3 method for class 'aov'
tamhaneT2Test(x, welch = TRUE, ...)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>x</code></td>
<td>
<p>a numeric vector of data values, a list of numeric data
vectors or a fitted model object, usually an aov fit.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>...</code></td>
<td>
<p>further arguments to be passed to or from methods.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>g</code></td>
<td>
<p>a vector or factor object giving the group for the
corresponding elements of <code>"x"</code>.
Ignored with a warning if <code>"x"</code> is a list.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>welch</code></td>
<td>
<p>indicates, whether Welch's approximate solution for
calculating the degree of freedom shall be used or, as usually,
<code class="reqn">df = N - 2</code>. Defaults to <code>TRUE</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>formula</code></td>
<td>
<p>a formula of the form <code>response ~ group</code> where
<code>response</code> gives the data values and <code>group</code> a vector or
factor of the corresponding groups.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>data</code></td>
<td>
<p>an optional matrix or data frame (or similar: see
<code>model.frame</code>) containing the variables in the
formula <code>formula</code>.  By default the variables are taken from
<code>environment(formula)</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>subset</code></td>
<td>
<p>an optional vector specifying a
subset of observations to be used.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>na.action</code></td>
<td>
<p>a function which indicates what should happen when
the data contain <code>NA</code>s.  Defaults to <code>getOption("na.action")</code>.</p>
</td>
</tr>
</table>
<h3>Details</h3>

<p>For all-pairs comparisons in an one-factorial layout
with normally distributed residuals but unequal groups variances
the T2 test (or T2' test) of Tamhane can be performed.
Let <code class="reqn">X_{ij}</code> denote a continuous random variable
with the <code class="reqn">j</code>-the realization (<code class="reqn">1 \le j \le n_i</code>)
in the <code class="reqn">i</code>-th group (<code class="reqn">1 \le i \le k</code>). Furthermore, the total
sample size is <code class="reqn">N = \sum_{i=1}^k n_i</code>. A total of <code class="reqn">m = k(k-1)/2</code>
hypotheses can be tested: The null hypothesis is
H<code class="reqn">_{ij}: \mu_i = \mu_j ~~ (i \ne j)</code> is tested against the alternative
A<code class="reqn">_{ij}: \mu_i \ne \mu_j</code> (two-tailed). Tamhane T2 all-pairs
test statistics are given by
</p>
<p style="text-align: center;"><code class="reqn">
 t_{ij} \frac{\bar{X}_i - \bar{X_j}}
 {\left( s^2_j / n_j + s^2_i / n_i \right)^{1/2}}, ~~
 (i \ne j)
</code>
</p>

<p>with <code class="reqn">s^2_i</code> the variance of the <code class="reqn">i</code>-th group.
The null hypothesis is rejected (two-tailed) if
</p>
<p style="text-align: center;"><code class="reqn">
 \mathrm{Pr} \left\{ |t_{ij}| \ge t_{v_{ij}\alpha'/2} | \mathrm{H} \right\}_{ij} =
 \alpha.
</code>
</p>

<p>T2 test uses Welch's approximate solution for
calculating the degree of freedom.
</p>
<p style="text-align: center;"><code class="reqn">
 v_{ij} = \frac{\left( s^2_i / n_i + s^2_j / n_j \right)^2}
 {s^4_i / n^2_i \left(n_i - 1\right) + s^4_j / n^2_j \left(n_j - 1\right)}.
</code>
</p>

<p>T2' test applies the following approximation for the degree of freedom
</p>
<p style="text-align: center;"><code class="reqn">
 v_{ij} = n_i + n_j - 2
</code>
</p>

<p>The p-values are computed from the <code>TDist</code>-distribution
and adjusted according to Dunn-Sidak.
</p>
<p style="text-align: center;"><code class="reqn">
 p'_{ij} = \min \left\{1, ~ (1 - (1 - p_{ij})^m)\right\}
</code>
</p>



<h3>Value</h3>

<p>A list with class <code>"PMCMR"</code> containing the following components:
</p>

<dl>
<dt>method</dt>
<dd>
<p>a character string indicating what type of test was performed.</p>
</dd>
<dt>data.name</dt>
<dd>
<p>a character string giving the name(s) of the data.</p>
</dd>
<dt>statistic</dt>
<dd>
<p>lower-triangle matrix of the estimated
quantiles of the pairwise test statistics.</p>
</dd>
<dt>p.value</dt>
<dd>
<p>lower-triangle matrix of the p-values for the pairwise tests.</p>
</dd>
<dt>alternative</dt>
<dd>
<p>a character string describing the alternative hypothesis.</p>
</dd>
<dt>p.adjust.method</dt>
<dd>
<p>a character string describing the method for p-value
adjustment.</p>
</dd>
<dt>model</dt>
<dd>
<p>a data frame of the input data.</p>
</dd>
<dt>dist</dt>
<dd>
<p>a string that denotes the test distribution.</p>
</dd>
</dl>
<h3>Note</h3>

<p>T2 test is basically an all-pairs pairwise-t-test. Similar results
can be obtained with <code>pairwise.t.test(..., var.equal=FALSE, p.adjust.mehod = FALSE)</code>.
</p>
<p>A warning message appears
in the modified T2' test, if none of in Tamhane (1979) given conditions
for nearly balanced
sample sizes and nearly balanced standard errors is true.
</p>
<p>Thanks to Sirio Bolaños for his kind suggestion for adding T2' test
into this function.
</p>


<h3>References</h3>

<p>Tamhane, A. C. (1979) A Comparison of Procedures for Multiple Comparisons
of Means with Unequal Variances, <em>Journal of the American
Statistical Association</em> <b>74</b>, 471–480.
</p>


<h3>See Also</h3>

<p><code>dunnettT3Test</code> <code>uryWigginsHochbergTest</code>
</p>


<h3>Examples</h3>

<pre><code class="language-R">fit &lt;- aov(weight ~ feed, chickwts)
shapiro.test(residuals(fit))
bartlett.test(weight ~ feed, chickwts) # var1 = varN
anova(fit)

## also works with fitted objects of class aov
res &lt;- tamhaneT2Test(fit)
summary(res)
summaryGroup(res)
res

## compare with pairwise.t.test
WT &lt;- pairwise.t.test(chickwts$weight,
                      chickwts$feed,
                      pool.sd = FALSE,
                      p.adjust.method = "none")
p.adj.sidak &lt;- function(p, m) sapply(p, function(p) min(1, 1 - (1 - p)^m))
p.raw &lt;- as.vector(WT$p.value)
m &lt;- length(p.raw[!is.na(p.raw)])
PADJ &lt;- matrix(ans &lt;- p.adj.sidak(p.raw, m),
               nrow = 5, ncol = 5)
colnames(PADJ) &lt;- colnames(WT$p.value)
rownames(PADJ) &lt;- rownames(WT$p.value)
PADJ

## same without Welch's approximate solution
summary(T2b &lt;- tamhaneT2Test(fit, welch = FALSE))

</code></pre>


</div>