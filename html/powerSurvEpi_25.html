<div class="container">

<table style="width: 100%;"><tr>
<td>ssizeEpiInt</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2> 
Sample Size Calculation Testing Interaction Effect for Cox Proportional Hazards Regression 
</h2>

<h3>Description</h3>

<p>Sample size calculation testing interaction effect for Cox proportional hazards regression with two covariates for Epidemiological Studies. Both covariates should be  binary variables. The formula takes
into account the correlation between the two covariates.
</p>


<h3>Usage</h3>

<pre><code class="language-R">ssizeEpiInt(X1, 
	    X2, 
	    failureFlag, 
	    power, 
	    theta, 
	    alpha = 0.05)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>X1</code></td>
<td>
<p>numeric. a <code>nPilot</code> by 1 vector, where <code>nPilot</code> is the number of subjects 
in the pilot data set. This vector records the values of the covariate of 
interest for the <code>nPilot</code> subjects in the pilot study. <code>X1</code> should 
be binary and take only two possible values: zero and one.
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>X2</code></td>
<td>
<p>numeric. a <code>nPilot</code> by 1 vector, where <code>nPilot</code> is the number of subjects
in the pilot study. This vector records the values of the second covariate 
for the <code>nPilot</code> subjects in the pilot study. 
<code>X2</code> should be binary and take only two possible values: zero and one.
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>failureFlag</code></td>
<td>
<p>numeric. a <code>nPilot</code> by 1 vector of indicators indicating if a subject is 
failure (<code>failureFlag=1</code>) or alive (<code>failureFlag=0</code>). 
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>power</code></td>
<td>
<p>numeric. postulated power. </p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>theta</code></td>
<td>
<p>numeric. postulated hazard ratio. </p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>alpha</code></td>
<td>
<p>numeric. type I error rate. </p>
</td>
</tr>
</table>
<h3>Details</h3>

<p>This is an implementation of the sample size calculation formula 
derived by Schmoor et al. (2000) for
the following Cox proportional hazards regression in the epidemoilogical
studies: 
</p>
<p style="text-align: center;"><code class="reqn">h(t|x_1, x_2)=h_0(t)\exp(\beta_1 x_1+\beta_2 x_2 + \gamma (x_1 x_2)),</code>
</p>

<p>where both covariates <code class="reqn">X_1</code> and <code class="reqn">X_2</code> are binary variables.
</p>
<p>Suppose we want to check if  
the hazard ratio of the interaction effect <code class="reqn">X_1 X_2=1</code> to <code class="reqn">X_1 X_2=0</code> is equal to <code class="reqn">1</code> 
or is equal to <code class="reqn">\exp(\gamma)=\theta</code>.
Given the type I error rate <code class="reqn">\alpha</code> for a two-sided test, the total
number of subjects required to achieve the desired power <code class="reqn">1-\beta</code> is:
</p>
<p style="text-align: center;"><code class="reqn">n=\frac{\left(z_{1-\alpha/2}+z_{1-\beta}\right)^2 G}{
[\log(\theta)]^2 \psi (1-p) p (1-\rho^2)
},</code>
</p>

<p>where <code class="reqn">z_{a}</code> is the <code class="reqn">100 a</code>-th percentile of the standard normal distribution, <code class="reqn">\psi</code> is the proportion of subjects died of
the disease of interest, and 
</p>
<p style="text-align: center;"><code class="reqn">\rho=corr(X_1, X_2)=(p_1-p_0)\times\sqrt{\frac{q(1-q)}{p(1-p)}},</code>
</p>
 
<p>and
<code class="reqn">p=Pr(X_1=1)</code>, <code class="reqn">q=Pr(X_2=1)</code>, <code class="reqn">p_0=Pr(X_1=1|X_2=0)</code>,
and <code class="reqn">p_1=Pr(X_1=1 | X_2=1)</code>, and
</p>
<p style="text-align: center;"><code class="reqn">G=\frac{[(1-q)(1-p_0)p_0+q(1-p_1)p_1]^2}{(1-q)q (1-p_0)p_0 (1-p_1) p_1},</code>
</p>

<p>and
<code class="reqn">p0=Pr(X_1=1 | X_2=0)=myc/(mya+myc)</code>,
<code class="reqn">p1=Pr(X_1=1 | X_2=1)=myd/(myb+myd)</code>,
<code class="reqn">p=Pr(X_1=1)=(myc+myd)/n</code>,
<code class="reqn">q=Pr(X_2=1)=(myb+myd)/n</code>,
<code class="reqn">n=mya+myb+myc+myd</code>.
</p>
<p><code class="reqn">p_{00}=Pr(X_1=0,\mbox{and}, X_2=0)</code>, 
<code class="reqn">p_{01}=Pr(X_1=0,\mbox{and}, X_2=1)</code>, 
<code class="reqn">p_{10}=Pr(X_1=1,\mbox{and}, X_2=0)</code>, 
<code class="reqn">p_{11}=Pr(X_1=1,\mbox{and}, X_2=1)</code>. 
</p>
<p><code class="reqn">p_{00}</code>, <code class="reqn">p_{01}</code>, <code class="reqn">p_{10}</code>, <code class="reqn">p_{11}</code>, and <code class="reqn">\psi</code> will be
estimated from the pilot data.
</p>


<h3>Value</h3>

<table>
<tr style="vertical-align: top;">
<td><code>n</code></td>
<td>
<p>the total number of subjects required.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>p</code></td>
<td>
<p>estimated <code class="reqn">Pr(X_1=1)</code></p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>q</code></td>
<td>
<p>estimated <code class="reqn">Pr(X_2=1)</code></p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>p0</code></td>
<td>
<p>estimated <code class="reqn">Pr(X_1=1 | X_2=0)</code></p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>p1</code></td>
<td>
<p>estimated <code class="reqn">Pr(X_1=1 | X_2=1)</code></p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>rho2</code></td>
<td>
<p>square of the estimated <code class="reqn">corr(X_1, X_2)</code></p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>G</code></td>
<td>
<p>a factor adjusting the sample size. The sample size needed to
detect an effect of a prognostic factor with given error probabilities has
to be multiplied by the factor <code>G</code> when an interaction of the
same magnitude is to be detected.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>mya</code></td>
<td>
<p>estimated number of subjects taking values <code class="reqn">X_1=0</code> and 
<code class="reqn">X_2=0</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>myb</code></td>
<td>
<p>estimated number of subjects taking values <code class="reqn">X_1=0</code> and 
<code class="reqn">X_2=1</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>myc</code></td>
<td>
<p>estimated number of subjects taking values <code class="reqn">X_1=1</code> and 
<code class="reqn">X_2=0</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>myd</code></td>
<td>
<p>estimated number of subjects taking values <code class="reqn">X_1=1</code> and 
<code class="reqn">X_2=1</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>psi</code></td>
<td>
<p> proportion of subjects died of the disease of interest. </p>
</td>
</tr>
</table>
<h3>References</h3>

 
<p>Schmoor C., Sauerbrei W., and Schumacher M. (2000).
Sample size considerations for the evaluation of prognostic factors in survival analysis.
<em>Statistics in Medicine</em>. 19:441-452.
</p>


<h3>See Also</h3>

 <p><code>ssizeEpiInt.default0</code>, <code>ssizeEpiInt2</code> </p>


<h3>Examples</h3>

<pre><code class="language-R">  # generate a toy pilot data set
  X1 &lt;- c(rep(1, 39), rep(0, 61))
  set.seed(123456)
  X2 &lt;- sample(c(0, 1), 100, replace = TRUE)
  failureFlag &lt;- sample(c(0, 1), 100, prob = c(0.25, 0.75), replace = TRUE)

  ssizeEpiInt(X1 = X1, 
	      X2 = X2, 
	      failureFlag = failureFlag, 
	      power = 0.88, 
	      theta = 3, 
	      alpha = 0.05)
  
</code></pre>


</div>