<div class="container">

<table style="width: 100%;"><tr>
<td>opt.ssm.GRW</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>Fit evolutionary models using state-space models (SSM)</h2>

<h3>Description</h3>

<p>Fit evolutionary models using state-space models (SSM)
</p>


<h3>Usage</h3>

<pre><code class="language-R">opt.ssm.GRW(y, pool = TRUE, cl = list(fnscale = -1), hess = FALSE)

opt.ssm.URW(y, pool = TRUE, cl = list(fnscale = -1), hess = FALSE)

opt.ssm.Stasis(y, pool = TRUE, cl = list(fnscale = -1), hess = FALSE)

opt.ssm.StrictStasis(y, pool = TRUE, cl = list(fnscale = -1), hess = FALSE)

opt.ssm.OU(y, pool = TRUE, cl = list(fnscale = -1), hess = FALSE)

opt.ssm.ACDC(y, pool = TRUE, cl = list(fnscale = -1), hess = FALSE)

opt.ssm.covOU(y, z, pool = TRUE, cl = list(fnscale = -1), hess = FALSE)

opt.ssm.URWshift(y, gg, pool = TRUE, cl = list(fnscale = -1), hess = FALSE)

opt.ssm.covOU_vshift(
  y,
  z,
  gg,
  pool = TRUE,
  cl = list(fnscale = -1),
  hess = FALSE
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>y</code></td>
<td>
<p>a <code>paleoTS</code> object</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>pool</code></td>
<td>
<p>if <code>TRUE</code>, sample variances are substituted with their pooled estimate</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>cl</code></td>
<td>
<p>optional control list, passed to <code>optim()</code></p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>hess</code></td>
<td>
<p>if <code>TRUE</code>, return standard errors of parameter estimates from the
hessian matrix</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>z</code></td>
<td>
<p>a covariate vector, used only for the covOU models</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>gg</code></td>
<td>
<p>a grouping vector, used only for the URWshift and covOU_vshift models</p>
</td>
</tr>
</table>
<h3>Details</h3>

<p>These functions use a state space model formulation to compute likelihoods and fit models.
</p>
<p>Functions to fit the OU covariate tracking models (<code>covOU</code>, <code>covOU_vshift</code>) require a covariate argument, <code>z</code>.
At present, only the OU covariate tracking with a shift in the step variance (<code>covOU_vshift</code>) requires the grouping vector argument (<code>gg</code>).
</p>


<h3>Value</h3>

<p>a <code>paleoTSfit</code> object with the model fitting results
</p>


<h3>Note</h3>

<p>For GRW, URW, Stasis, StrictStasis, ACDC and OU models, it will likely be easier to use the convenience function <code>fitSimple</code> with argument <code>method = "SSM"</code>.<br>
The grouping vector, <code>gg</code>, is a vector of length equal to the number of samples. It has one element for each sample and takes
integer value from 1 to the number of sample groups separated by shiftpoints. See the example below.
</p>


<h3>See Also</h3>

<p><code>fitSimple</code>, <code>opt.joint.GRW</code>
</p>


<h3>Examples</h3>

<pre><code class="language-R">y &lt;- sim.GRW(ns = 30, vs = 2)
w1 &lt;- opt.ssm.URW(y)
gg &lt;- rep(1:2, each = 15) # shift occurs immediately after sample 15
w2 &lt;- opt.ssm.URWshift(y, gg = gg) # test model in which the step variance shifts
compareModels(w1, w2)
</code></pre>


</div>