<div class="container">

<table style="width: 100%;"><tr>
<td>pred_stacked_regression</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>Perform Stacked Regression on Existing Prediction Models</h2>

<h3>Description</h3>

<p>This function takes a set of existing prediction models, and uses the new
dataset to combine/aggregate them into a single 'meta-model', as described in
Debray et al. 2014.
</p>


<h3>Usage</h3>

<pre><code class="language-R">pred_stacked_regression(
  x,
  positivity_constraint = FALSE,
  new_data,
  binary_outcome = NULL,
  survival_time = NULL,
  event_indicator = NULL
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>x</code></td>
<td>
<p>an object of class "<code>predinfo</code>" produced by calling
<code>pred_input_info</code> containing information on at least two
existing prediction models.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>positivity_constraint</code></td>
<td>
<p>TRUE/FALSE denoting if the weights within the
stacked regression model should be constrained to be non-negative (TRUE) or
should be allowed to take any value (FALSE). See details.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>new_data</code></td>
<td>
<p>data.frame upon which the prediction models should be
aggregated.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>binary_outcome</code></td>
<td>
<p>Character variable giving the name of the column in
<code>new_data</code> that represents the observed binary outcomes (should be
coded 0 and 1 for non-event and event, respectively). Only relevant for
<code>model_type</code>="logistic"; leave as <code>NULL</code> otherwise. Leave as
<code>NULL</code> if <code>new_data</code> does not contain any outcomes.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>survival_time</code></td>
<td>
<p>Character variable giving the name of the column in
<code>new_data</code> that represents the observed survival times. Only relevant
for <code>x$model_type</code>="survival"; leave as <code>NULL</code> otherwise.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>event_indicator</code></td>
<td>
<p>Character variable giving the name of the column in
<code>new_data</code> that represents the observed survival indicator (1 for
event, 0 for censoring). Only relevant for <code>x$model_type</code>="survival";
leave as <code>NULL</code> otherwise.</p>
</td>
</tr>
</table>
<h3>Details</h3>

<p>This function takes a set of (previously estimated) prediction
models that were each originally developed for the same prediction task,
and pool/aggregate these into a single prediction model (meta-model) using
stacked regression based on new data (data not used to develop any of the
existing models). The methodological details can be found in Debray et al.
2014.
</p>
<p>Given that the existing models are likely to be highly co-linear (since
they were each developed for the same prediction task), it has been
suggested to impose a positivity constraint on the weights of the stacked
regression model (Debray et al. 2014.). If <code>positivity_constraint</code> is
set to TRUE, then the stacked regression model will be estimated by
optimising the (log-)likelihood using bound constrained optimization
("L-BFGS-B"). This is currently only implemented for logistic regression
models (i.e., if <code>x$model_type</code>="logistic"). For survival models,
positivity_constraint = FALSE.
</p>
<p><code>new_data</code> should be a data.frame, where each row should be an
observation (e.g. patient) and each variable/column should be a predictor
variable. The predictor variables need to include (as a minimum) all of the
predictor variables that are included in the existing prediction models
(i.e., each of the variable names supplied to
<code>pred_input_info</code>, through the <code>model_info</code> parameter,
must match the name of a variables in <code>new_data</code>).
</p>
<p>Any factor variables within <code>new_data</code> must be converted to dummy
(0/1) variables before calling this function. <code>dummy_vars</code> can
help with this. See <code>pred_predict</code> for examples.
</p>
<p><code>binary_outcome</code>, <code>survival_time</code> and <code>event_indicator</code> are
used to specify the outcome variable(s) within <code>new_data</code> (use
<code>binary_outcome</code> if <code>x$model_type</code> = "logistic", or use
<code>survival_time</code> and <code>event_indicator</code> if <code>x$model_type</code> =
"survival").
</p>


<h3>Value</h3>

<p>A object of class "<code>predSR</code>". This is the same as that detailed
in <code>pred_input_info</code>, with the added element containing the
estimates of the meta-model obtained by stacked regression.
</p>


<h3>References</h3>

<p>Debray, T.P., Koffijberg, H., Nieboer, D., Vergouwe, Y.,
Steyerberg, E.W. and Moons, K.G. (2014), Meta-analysis and aggregation of
multiple published prediction models. <em>Statistics in Medicine</em>, 33:
2341-2362
</p>


<h3>See Also</h3>

<p><code>pred_input_info</code>
</p>


<h3>Examples</h3>

<pre><code class="language-R">LogisticModels &lt;- pred_input_info(model_type = "logistic",
                                  model_info = SYNPM$Existing_logistic_models)
SR &lt;- pred_stacked_regression(x = LogisticModels,
                              new_data = SYNPM$ValidationData,
                              binary_outcome = "Y")
summary(SR)

#Survival model example:
TTModels &lt;- pred_input_info(model_type = "survival",
                            model_info = SYNPM$Existing_TTE_models,
                            cum_hazard = list(SYNPM$TTE_mod1_baseline,
                                                  SYNPM$TTE_mod2_baseline,
                                                  SYNPM$TTE_mod3_baseline))
SR &lt;- pred_stacked_regression(x = TTModels,
                              new_data = SYNPM$ValidationData,
                              survival_time = "ETime",
                              event_indicator = "Status")
summary(SR)

</code></pre>


</div>