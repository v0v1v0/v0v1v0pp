<div class="container">

<table style="width: 100%;"><tr>
<td>findMRCA</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>Get the MRCA of a set of taxa</h2>

<h3>Description</h3>

<p>Finds the most recent common ancestor (MRCA) of a set of tips.
</p>


<h3>Usage</h3>

<pre><code class="language-R">findMRCA(tree, tips=NULL, type=c("node","height"))
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>tree</code></td>
<td>
<p>a phylogenetic tree as an object of class <code>"phylo"</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>tips</code></td>
<td>
<p>a vector containing a set of tip labels.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>type</code></td>
<td>
<p>either <code>"node"</code> to return the node of the MRCA; or <code>"height"</code> to return the height above the root of the MRCA of <code>tips</code>.</p>
</td>
</tr>
</table>
<h3>Details</h3>

<p>This function returns node number of the most recent common ancestor of a set of taxa.
</p>
<p>If <code>tips==NULL</code> and <code>type="node"</code> (the default) it will return the result of a normal function call to <code>mrca</code>. 
</p>
<p>If <code>tips=NULL</code> and <code>type="height"</code> it will return a matrix equal to that produced by <code>vcv.phylo</code>.
</p>
<p>From <span class="pkg">phytools</span> 0.5-66 forward, <code>findMRCA</code> uses <code>getMRCA</code> in the <span class="pkg">ape</span> package internally, which results in a big speed-up. Even though the two functions are thus totally redundant I have left <code>findMRCA</code> in the package namespace to ensure backward compatibility.
</p>


<h3>Value</h3>

<p>The node number of the MRCA, or a matrix of node numbers (if <code>tips==NULL</code>) - for <code>type="node"</code>; or the height of the MRCA, or a matrix of heights (if <code>tips==NULL</code>) - for <code>type="height"</code>.
</p>


<h3>Author(s)</h3>

<p>Liam Revell <a href="mailto:liam.revell@umb.edu">liam.revell@umb.edu</a></p>


<h3>References</h3>

<p>Revell, L. J. (2024) phytools 2.0: an updated R ecosystem for phylogenetic comparative methods (and other things). <em>PeerJ</em>, <b>12</b>, e16505.
</p>


<h3>See Also</h3>

<p><code>findMRCA</code>, <code>mrca</code>
</p>


<h3>Examples</h3>

<pre><code class="language-R">data(anoletree)
anc&lt;-findMRCA(anoletree,c("cristatellus","cooki",
  "gundlachi"))
plotTree(anoletree,type="fan",fsize=0.7,lwd=1)
nodelabels(node=anc,frame="circle",pch=21,cex=1.5,
  bg="blue")
legend("topleft","most recent common ancestor\nof Puerto Rican TG anoles",
  pch=21,pt.cex=1.5,pt.bg="blue",cex=0.7,bty="n")
par(mar=c(5.1,4.1,4.1,2.1)) ## reset margin to default
</code></pre>


</div>