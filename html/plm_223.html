<div class="container">

<table style="width: 100%;"><tr>
<td>pwfdtest</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>Wooldridge first–difference–based test for AR(1) errors in levels
or first–differenced panel models</h2>

<h3>Description</h3>

<p>First–differencing–based test of serial correlation for (the idiosyncratic
component of) the errors in either levels or first–differenced panel
models.
</p>


<h3>Usage</h3>

<pre><code class="language-R">pwfdtest(x, ...)

## S3 method for class 'formula'
pwfdtest(x, data, ..., h0 = c("fd", "fe"))

## S3 method for class 'panelmodel'
pwfdtest(x, ..., h0 = c("fd", "fe"))
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>x</code></td>
<td>
<p>an object of class <code>formula</code> or a <code>"fd"</code>-model (plm
object),</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>...</code></td>
<td>
<p>further arguments to be passed on to <code>vcovHC</code> (see Details
and Examples).</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>data</code></td>
<td>
<p>a <code>data.frame</code>,</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>h0</code></td>
<td>
<p>the null hypothesis: one of <code>"fd"</code>, <code>"fe"</code>,</p>
</td>
</tr>
</table>
<h3>Details</h3>

<p>As Wooldridge (2010), Sec. 10.6.3 observes, if the
idiosyncratic errors in the model in levels are uncorrelated (which
we label hypothesis <code>"fe"</code>), then the errors of the model in first
differences (FD) must be serially correlated with
<code class="reqn">cor(\hat{e}_{it}, \hat{e}_{is}) = -0.5</code> for each <code class="reqn">t,s</code>. If
on the contrary the levels model's errors are a random walk, then
there must be no serial correlation in the FD errors (hypothesis
<code>"fd"</code>). Both the fixed effects (FE) and the first–differenced
(FD) estimators remain consistent under either assumption, but the
relative efficiency changes: FE is more efficient under <code>"fe"</code>, FD
under <code>"fd"</code>.
</p>
<p>Wooldridge (ibid.) suggests basing a test for either hypothesis on
a pooled regression of FD residuals on their first lag:
<code class="reqn">\hat{e}_{i,t}=\alpha + \rho \hat{e}_{i,t-1} +
\eta_{i,t}</code>. Rejecting the restriction <code class="reqn">\rho = -0.5</code> makes us
conclude against the null of no serial correlation in errors of the
levels equation (<code>"fe"</code>). The null hypothesis of no serial
correlation in differenced errors (<code>"fd"</code>) is tested in a similar
way, but based on the zero restriction on <code class="reqn">\rho</code> (<code class="reqn">\rho =
0</code>). Rejecting <code>"fe"</code> favours the use of the first–differences
estimator and the contrary, although it is possible that both be
rejected.
</p>
<p><code>pwfdtest</code> estimates the <code>fd</code> model (or takes an <code>fd</code> model as
input for the panelmodel interface) and retrieves its residuals,
then estimates an AR(1) <code>pooling</code> model on them. The test statistic
is obtained by applying a F test to the latter model to test the
relevant restriction on <code class="reqn">\rho</code>, setting the covariance matrix
to <code>vcovHC</code> with the option <code>method="arellano"</code> to control for
serial correlation.
</p>
<p>Unlike the <code>pbgtest</code> and <code>pdwtest</code>, this test does not rely on
large–T asymptotics and has therefore good properties in ”short”
panels.  Furthermore, it is robust to general
heteroskedasticity. The <code>"fe"</code> version can be used to test for
error autocorrelation regardless of whether the maintained
specification has fixed or random effects
(see Drukker 2003).
</p>


<h3>Value</h3>

<p>An object of class <code>"htest"</code>.
</p>


<h3>Author(s)</h3>

<p>Giovanni Millo
</p>


<h3>References</h3>

<p>Drukker DM (2003).
“Testing for Serial Correlation in Linear Panel–Data Models.”
<em>The Stata Journal</em>, <b>3</b>(2), 168-177.
</p>
<p>Wooldridge JM (2002).
<em>Econometric Analysis of Cross–Section and Panel Data</em>.
MIT Press.
Sec. 10.6.3, pp. 282–283.
</p>
<p>Wooldridge JM (2010).
<em>Econometric Analysis of Cross–Section and Panel Data</em>, 2nd edition.
MIT Press.
Sec. 10.6.3, pp. 319–320
</p>


<h3>See Also</h3>

<p><code>pdwtest</code>, <code>pbgtest</code>, <code>pwartest</code>,
</p>


<h3>Examples</h3>

<pre><code class="language-R">
data("EmplUK" , package = "plm")
pwfdtest(log(emp) ~ log(wage) + log(capital), data = EmplUK)
pwfdtest(log(emp) ~ log(wage) + log(capital), data = EmplUK, h0 = "fe")

# pass argument 'type' to vcovHC used in test
pwfdtest(log(emp) ~ log(wage) + log(capital), data = EmplUK, type = "HC3", h0 = "fe")


# same with panelmodel interface
mod &lt;- plm(log(emp) ~ log(wage) + log(capital), data = EmplUK, model = "fd")
pwfdtest(mod)
pwfdtest(mod, h0 = "fe")
pwfdtest(mod, type = "HC3", h0 = "fe")


</code></pre>


</div>