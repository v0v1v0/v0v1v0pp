<div class="container">

<table style="width: 100%;"><tr>
<td>mbplsda</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>
Multi-block partial least squares discriminant analysis
</h2>

<h3>Description</h3>

<p>Function to perform a multi-block partial least squares discriminant analysis (MBPLSDA) of several explanatory blocks defined as an object of class ktab, to explain a dependent dataset (Y-block) defined as an object of class dudi, in order to get model parameters for the indicated number of components.
</p>


<h3>Usage</h3>

<pre><code class="language-R">mbplsda(dudiY, ktabX, scale = TRUE, option = c("uniform", "none"), 
scannf = TRUE, nf = 2)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>dudiY</code></td>
<td>

<p>an object of class dudi containing the dependent variables
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>ktabX</code></td>
<td>

<p>an object of class ktab containing the blocks of explanatory variables
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>scale</code></td>
<td>

<p>logical value indicating whether the explanatory variables should be standardized
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>option</code></td>
<td>

<p>option for the block weighting. If uniform, the weight of each explanatory block is equal to 1/number of explanatory blocks, and the weight of the Y-block is eqyual to 1. If none, the block weight is equal to the block inertia.
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>scannf</code></td>
<td>

<p>logical value indicating whether the eigenvalues bar plot should be displayed
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>nf</code></td>
<td>

<p>integer indicating the number of components to be calculated
</p>
</td>
</tr>
</table>
<h3>Details</h3>

<p>no details are needed
</p>


<h3>Value</h3>

<table>
<tr style="vertical-align: top;">
<td><code>call</code></td>
<td>
<p>the matching call</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>tabX</code></td>
<td>
<p>data frame of explanatory variables centered, eventually scaled (if scale=TRUE)and weighted (if option="uniform")</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>tabY</code></td>
<td>
<p>data frame of dependent variables centered, eventually scaled (if scale=TRUE)and weighted (if option="uniform")</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>nf</code></td>
<td>
<p>integer indicating the number of kept dimensions</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>lw</code></td>
<td>
<p>numeric vector of row weights</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>X.cw</code></td>
<td>
<p>numeric vector of column weights for the explanalatory dataset</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>blo</code></td>
<td>
<p>vector of the numbers of variables in each explanatory dataset</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>rank</code></td>
<td>
<p>rank of the analysis</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>eig</code></td>
<td>
<p>numeric vector containing the eigenvalues</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>TL</code></td>
<td>
<p>dataframe useful to manage graphical outputs</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>TC</code></td>
<td>
<p>dataframe useful to manage graphical outputs</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>faX</code></td>
<td>
<p>matrix containing the global variable loadings associated with the global explanatory dataset</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>Tc1</code></td>
<td>
<p>matrix containing the partial variable loadings associated with each explanatory dataset(unit norm)</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>Yc1</code></td>
<td>
<p>matrix of the variable loadings associated with the dependent dataset</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>lX</code></td>
<td>
<p>matrix of the global components associated with the whole explanatory dataset(scores of the individuals)</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>TlX</code></td>
<td>
<p>matrix containing the partial components associated with each explanatory dataset</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>lY</code></td>
<td>
<p>matrix of the components associated with the dependent dataset</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>cov2</code></td>
<td>
<p>squared covariance between lY and TlX</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>XYcoef</code></td>
<td>
<p>list of matrices of the regression coefficients of the whole explanatory dataset onto the dependent dataset</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>intercept</code></td>
<td>
<p>intercept of the regression of the whole explanatory dataset onto the dependent dataset</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>XYcoef.raw</code></td>
<td>
<p>list of matrices of the regression coefficients of the whole raw explanatory dataset onto the raw dependent dataset</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>intercept.raw</code></td>
<td>
<p>intercept of the regression of the whole raw explanatory dataset onto the raw dependent dataset</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>bip</code></td>
<td>
<p>block importances for a given dimension</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>bipc</code></td>
<td>
<p>cumulated block importances for a given number of dimensions</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>vip</code></td>
<td>
<p>variable importances for a given dimension</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>vipc</code></td>
<td>
<p>cumulated variable importances for a given number of dimensions</p>
</td>
</tr>
</table>
<h3>Note</h3>

<p>This function is coming from the mbpls function of the R package ade4 (application in order to explain a disjunctive table, limitation of the number of calculated components)
</p>


<h3>Author(s)</h3>

<p>Marion Brandolini-Bunlon (&lt;marion.brandolini-bunlon@inra.fr&gt;) and Stephanie Bougeard (&lt;stephanie.bougeard@anses.fr&gt;)
</p>


<h3>References</h3>

<p>Brandolini-Bunlon, M., Petera, M., Gaudreau, P., Comte, B., Bougeard, S., Pujos-Guillot, E.(2019). A new tool for multi-block PLS discriminant analysis of metabolomic data: application to systems epidemiology. Presented at 12emes Journees Scientifiques RFMF, Clermont-Ferrand, FRA(05-21-2019 - 05-23-2019).
</p>
<p>Brandolini-Bunlon, M., Petera, M., Gaudreau, P., Comte, B., Bougeard, S., Pujos-Guillot, E.(2019). Multi-block PLS discriminant analysis for the joint analysis of metabolomic and epidemiological data. Metabolomics, 15(10):134
</p>
<p>Bougeard, S. and Dray, S. (2018) Supervised Multiblock Analysis in R with the ade4 Package.Journal of Statistical Software,86(1), 1-17.
</p>


<h3>See Also</h3>

<p><code>packMBPLSDA-package</code>
</p>


<h3>Examples</h3>

<pre><code class="language-R">data(status)
data(medical)
data(omics)
data(nutrition)
ktabX &lt;- ktab.list.df(list(medical = medical, nutrition = nutrition, omics = omics))
disjonctif &lt;- (disjunctive(status))
dudiY   &lt;- dudi.pca(disjonctif , center = FALSE, scale = FALSE, scannf = FALSE)
modelembplsQ &lt;- mbplsda(dudiY, ktabX, scale = TRUE, option = "uniform", scannf = FALSE, nf = 2)
</code></pre>


</div>