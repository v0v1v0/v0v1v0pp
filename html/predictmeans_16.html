<div class="container">

<table style="width: 100%;"><tr>
<td>predictmeans</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>
Predicted Means of a Linear Model
</h2>

<h3>Description</h3>

<p>This function obtains predicted means, SE of means, SED of means, LSDs and plots of means
with SE bar or LSD bar for parametric models such as <code>aov</code>, <code>lm</code>, 
<code>glm</code>, <code>gls</code>, <code>lme</code>, and <code>lmer</code>. The function also perfomrs pairwise comparisons
and permutation tests.
</p>


<h3>Usage</h3>

<pre><code class="language-R">predictmeans(model, modelterm, data=NULL, pairwise=FALSE, atvar=NULL, adj="none", Df=NULL,
  lsd_bar=TRUE, level=NULL, covariate=NULL, meandecr=NULL, letterCI=FALSE, trans = I,
  transOff = 0, responsen=NULL, count=FALSE, plotord=NULL, lineplot=TRUE, plottitle=NULL, 
  plotxlab=NULL, plotylab=NULL, mplot=TRUE, barplot=FALSE, pplot=TRUE, bkplot=TRUE, 
  plot=TRUE, jitterv=0.2, basesz=12, prtnum=TRUE, prtplt=TRUE, newwd=TRUE, permlist=NULL, 
  ncore=3, ndecimal=4)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>model</code></td>
<td>

<p>Model object returned by <code>aov</code>, <code>lm</code>, <code>glm</code>, <code>gls</code>, <code>lme</code>, and <code>lmer</code>.
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>modelterm</code></td>
<td>

<p>Name (in "quotes") for indicating which factor term's predicted mean to be calculated. 
The <code>modelterm</code> must be factors and given exactly as it appears in the printed model, e.g. "A" or "A:B". 
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>data</code></td>
<td>

<p>In some cases, you need to provide the data set used in model fitting, especially when you have applied some 
variable trnasformation in the model.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>pairwise</code></td>
<td>

<p>An option for showing pair-wise LSDs and p-values, or not. The default is FALSE. 
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>atvar</code></td>
<td>

<p>When <code>pairwise = TRUE</code>, a quoted name indicating within levels of which variable in 
<code>modelterm</code> the multiple comparison will be performed.
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>adj</code></td>
<td>

<p>Name (in "quote") for indicating a method for adjusting p-values of pairwise comparisons. 
The choices are "none", "tukey", "holm", "hochberg", "hommel", "bonferroni", "BH", "BY" and "fdr". 
The default method is "none". Note that LSD can't be adjusted except for "bonferroni" method.
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>Df</code></td>
<td>

<p>A degree of freedom for calculating LSD. For the above models, Df is obtained from the function automatically.
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>lsd_bar</code></td>
<td>

<p>A logical variable to indicate to print an average LSD or SED bar on the means plot. The default is TRUE.
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>level</code></td>
<td>

<p>A significant level for calculating LSD, CI etc. The default value is 0.05.
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>covariate</code></td>
<td>

<p>A numerical vector to specify values of covariates for calculating predicted means. The default 
values are the means of the associated covariates.
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>meandecr</code></td>
<td>

<p>A logical variable to indicate whether to print letters for multiple comparisons by decreasing order of means in the mean_table. 
The default is NULL which indicates the mean order follows the associated factor levels.
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>letterCI</code></td>
<td>

<p>A logical variable to indicate printed letters for multiple comparisons by whether or not CI overlap in the mean_table. 
The default is FALSE.
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>trans</code></td>
<td>

<p>A function object for calculating the back transformed means, e.g. <code>trans=exp</code>.
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>transOff</code></td>
<td>

<p>When you use <code>trans=exp(x+1)</code>, then <code>transOff=1</code>, the default is 0.
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>responsen</code></td>
<td>

<p>Name (in "quotes") of the back transformed response variable in the <code>model</code>.
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>count</code></td>
<td>

<p>An option for indicating the back transformed mean values are counts or not. The default is FALSE.
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>plotord</code></td>
<td>

<p>A numeric vector specifying the order of plotting for two or three way interaction (e.g. 
<code>plotord = c(2, 1, 3)</code> will put the second variable in <code>modelterm</code> on the <code>X</code> 
axis, the first variable as the grouping variable, and the third one as the panel variable). 
The defaults are <code>c(1, 2)</code> and <code>c(1, 2, 3)</code> for two and three way interactions. 
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>lineplot</code></td>
<td>

<p>An option for drawing a line chart, or dot chart. The default is TRUE.
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>plottitle</code></td>
<td>

<p>A character vector specifying the main title for plot(s). The default is NULL. 
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>plotxlab</code></td>
<td>

<p>A character vector specifying the x label for plot(s). The default is NULL. 
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>plotylab</code></td>
<td>

<p>A character vector specifying the y label for plot(s). The default is NULL. 
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>mplot</code></td>
<td>

<p>An option for drawing a means plot, or not. The default is TRUE.
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>barplot</code></td>
<td>

<p>An option for drawing a bar chart, or not. The default is FALSE.
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>pplot</code></td>
<td>

<p>An option for drawing a p-values plot, or not when there are more than six p-values. The default is TRUE.
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>bkplot</code></td>
<td>

<p>An option for drawing back transformed plot, or not. The default is TRUE.
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>plot</code></td>
<td>

<p>An option for drawing plots, or not. The default is TRUE.
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>jitterv</code></td>
<td>

<p>A degree of jitter in x and y direction in the back transformed means graph. The default is zero.
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>basesz</code></td>
<td>

<p>The base font size. The default is 12.
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>prtnum</code></td>
<td>

<p>An option for printing covariate information on the screen, or not. The default is TRUE.
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>prtplt</code></td>
<td>

<p>An option for printing plots on the screen, or not. The default is TRUE.
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>newwd</code></td>
<td>

<p>A logical variable to indicate whether to print graph in a new window. The default is TRUE.
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>permlist</code></td>
<td>

<p>A model parameter list produced by the function <code>permmodels</code>. When <code>permlist != NULL</code>, 
the option <code>Df</code> will be non-functional. This is a key option for pairwise comparisons via 
permutation tests.
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>ncore</code></td>
<td>

<p>Number of core for parallel computing when <code>permlist != NULL</code>, the default value is 3.
</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>ndecimal</code></td>
<td>

<p>An option for specifying number of decimal point to be print at predicted means table. The default is 4.
</p>
</td>
</tr>
</table>
<h3>Value</h3>

<table>
<tr style="vertical-align: top;">
<td><code>Predicted Means</code></td>
<td>
<p>A table of predicted means.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>Standard Error of Means</code></td>
<td>
<p>A table of standard errors of predicted means.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>Standard Error of Differences</code></td>
<td>
<p>Standard errors of differences between predicted means.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>LSD</code></td>
<td>
<p>Least significant differences between predicted means.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>Pairwise p-value</code></td>
<td>
<p>A matrix with t-values above the diagonal and p-values below the diagonal, or 
matrix of pairwise comparison p-values for each level of <code>atvar</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>mean_table</code></td>
<td>
<p>A summary of predicted means result including 'Predicted means', 'Standard error', 'Df' 
and 'CIs'. When <code>trans!=NULL</code> or <code>trans!=I</code>, a table of back transformed means with CIs are also shown.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>predictmeansPlot</code></td>
<td>
<p>ggplot of predicted means.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>predictmeansBKPlot</code></td>
<td>
<p>ggplot of back transformed means.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>predictmeansBarPlot</code></td>
<td>
<p>gg bar plot of predicted means.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>p_valueMatrix</code></td>
<td>
<p>p_value matrix for pairwise comparison.</p>
</td>
</tr>
</table>
<h3>Note</h3>

<p>The <code>predictmeans</code> function becomes confused if a factor or covariate is changed to the other
in a model formula. Consequently, formulae that include calls <code>as.factor</code>, <code>factor</code>, or <code>numeric</code>
(e.g. <code>as.factor(income)</code>) will cause errors. Instead, create the modified variables outside of the model
formula (e.g., <code>fincome &lt;- as.factor(income)</code>) and then use them in the model formula.
</p>
<p>Factors cannot have colons in level names (e.g., <code>"level:A"</code>); the <code>predictmeans</code> function will confuse the
colons with interactions; rename levels to avoid colons.
</p>
<p>For <code>predictmeans</code> function, it is assumed that methods <code>coef</code>, <code>vcov</code>, <code>model.matrix</code>, <code>model.frame</code> and <code>terms</code> are available for <code>model</code>. 
</p>


<h3>Author(s)</h3>

<p>Dongwen Luo, Siva Ganesh and John Koolaard
</p>


<h3>References</h3>

<p>Torsten Hothorn, Frank Bretz and Peter Westfall (2008),
<em>Simultaneous Inference in General Parametric Models. Biometrical</em>, Journal 50(3), 346–363.
</p>
<p>Welham, S., Cullis, B., Gogel, B., Gilmour, A., &amp; Thompson, R. (2004),
<em>Prediction in linear mixed models</em>, Australian and New Zealand Journal of Statistics, 46(3), 325-347. 
</p>
<p>Vanessa, C. (05 October 2022),
<em>Confidence tricks: the 83.4% confidence interval for comparing means</em>, https://vsni.co.uk/blogs/confidence_trick. 
</p>


<h3>Examples</h3>

<pre><code class="language-R">  library(predictmeans)
  ftable(xtabs(yield ~ Block+Variety+nitro, data=Oats))
  Oats$nitro &lt;- factor(Oats$nitro)
  fm &lt;- lme(yield ~ nitro*Variety, random=~1|Block/Variety, data=Oats)
# fm &lt;- lmer(yield ~ nitro*Variety+(1|Block/Variety), data=Oats)
  predictmeans(fm, "nitro", adj="BH")
  predictmeans(fm, "nitro:Variety", atvar="Variety", adj="BH", line=FALSE)
  predictout &lt;- predictmeans(fm, "nitro:Variety", atvar="Variety", adj="BH", 
    barplot=TRUE, line=FALSE)
  names(predictout)
  print(predictout$predictmeansPlot)
  print(predictout$predictmeansBarPlot)
</code></pre>


</div>