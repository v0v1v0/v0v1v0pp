<div class="container">

<table style="width: 100%;"><tr>
<td>fitBayes</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>Evolutionary model fitting with intraspecific variability using Bayesian MCMC</h2>

<h3>Description</h3>

<p><code>fitBayes</code> uses Bayesian MCMC to sample terminal states (species means) as well as the parameters of an evolutionary model from their joint posterior distribution, following Revell &amp; Reynolds (2012).
</p>


<h3>Usage</h3>

<pre><code class="language-R">fitBayes(tree, x, ngen=10000, model="BM", method="reduced", control=list())
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>tree</code></td>
<td>
<p>an object of class <code>"phylo"</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>x</code></td>
<td>
<p>a vector of phenotypic values for individuals; <code>names(x)</code> should contain the species names (not individual IDs).</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>ngen</code></td>
<td>
<p>a integer indicating the number of generations for the MCMC.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>model</code></td>
<td>
<p>an evolutionary model: either <code>"BM"</code> or <code>"lambda"</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>method</code></td>
<td>
<p>a method: either <code>"reduced"</code> or <code>"full"</code>.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>control</code></td>
<td>
<p>a list of control parameters containing the following elements: <code>sig2</code>: starting value for <code class="reqn">\sigma^2</code> (BM rate); <code>lambda</code>: starting value for the <code class="reqn">\lambda</code> parameter; <code>a</code>: starting for the state at the root node; <code>xbar</code>: starting values for the states at the tips; <code>intV</code>: starting value for the intraspecific variance (reduced method); or <code>v</code>: starting value for the vector of intraspecific variances for all species (full method); <code>pr.mean</code>: means for the prior distributions in the following order - <code>sig2</code>, <code>lambda</code> (if applicable), <code>a</code>, <code>xbar</code>, <code>intV</code> or <code>v</code> (if applicable), note that the prior probability distribution is exponential for <code>sig2</code> and normal for <code>a</code> and <code>y</code>; <code>pr.var</code>: variances on the prior distributions, same order as <code>pr.mean</code>.</p>
</td>
</tr>
</table>
<h3>Value</h3>

<p>An object of class <code>"fitBayes"</code> that includes a matrix (<code>mcmc</code>) with a number of rows <code>ngen/control$sample+1</code> containing the posterior sample and likelihoods.
</p>
<p>Matrix columns are labeled by species (for species means and variances), or by the corresponding evolutionary parameter.
</p>


<h3>Author(s)</h3>

<p>Liam Revell <a href="mailto:liam.revell@umb.edu">liam.revell@umb.edu</a></p>


<h3>References</h3>

<p>Revell, L. J. (2024) phytools 2.0: an updated R ecosystem for phylogenetic comparative methods (and other things). <em>PeerJ</em>, <b>12</b>, e16505.
</p>
<p>Revell, L. J. and R. G. Reynolds. (2012) A new Bayesian method for fitting evolutionary models to comparative data with intraspecific variation. <em>Evolution</em>, 66, 2697-2707.
</p>


<h3>See Also</h3>

<p><code>anc.Bayes</code>, <code>brownie.lite</code>, <code>evol.rate.mcmc</code>
</p>


</div>