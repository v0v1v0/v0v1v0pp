<div class="container">

<table style="width: 100%;"><tr>
<td>VGM_expand_featurebarcodes</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>Utility for feature barcode assignment including clonal information</h2>

<h3>Description</h3>

<p>The VGM_expand_featurebarcodes function function can be used to trace back the cell origin of each sample after using cell hashing for single-cell sequencing. Replaces the original sample_id column of a vgm object with a pasted version of the original sample_id and the last digits of the feature barcode.
</p>
<p>The original sample_id is stored in a new column called original_sample_id. Additionally, a second new column is created containing final barcode assignment information.
Those barcodes match the origin FB_assignment if by.majority.barcodes is set to FALSE (default). However, if this input parameter is set to TRUE, the majority barcode assignment in stored in this colum.
</p>
<p>Note: The majority barcode of a cell is the feature barcode which is  most frequently assigned to the cells clonotype (10x default clonotype).
The majority barcode assignment can be used under the assumption that all cells which are assigned to the same clonotype (within one sample), originate from the same donor organ or at least the same donor depending on the experimental setup.
</p>
<p>For example: The original sample_id of a cell is "s1", the cell belongs to "clonotype1" and the feature barcode assigned to it is "i1-TotalSeq-C0953". If by.majority.barcodes default (FALSE) is used, the resulting new sample_id would be "s1_0953".
However, if majority barcode assignment is used AND "i1-TotalSeq-C0953" is not the most frequently occurring barcode in "clonotype1" but rather barcode "i1-TotalSeq-C0951", the new sample_id would be "s1_0951".
–&gt; e.g., if 15 cells belong to clonotype1: 3 cells have no assigned barcode, 2 are assigned to "i1-TotalSeq-C0953" and 10 are assigned to "i1-TotalSeq-C0951" –&gt; all 15 cells will have the new sample_id "s1_0951".
</p>


<h3>Usage</h3>

<pre><code class="language-R">VGM_expand_featurebarcodes(
  vgm,
  by.majority.barcodes,
  integrate.in.gex,
  vdj.only,
  platypus.version
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>vgm</code></td>
<td>
<p>VGM output of VDJ_GEX_matrix function (Platypus V3)</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>by.majority.barcodes</code></td>
<td>
<p>Logical. Default is FALSE. Indicated whether strict barcode assignment or majority barcode assignment should be used to create the new sample_id. If TRUE, for each clonotype the most frequent feature barcode will be chosen and assigned to each cell, even if that cell itself does not have this particular barcode assigned.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>integrate.in.gex</code></td>
<td>
<p>Logical. Default is FALSE. If TRUE, the newly created sample_id's are integrated into gex component as well. Not recommended if no further gex analysis is done due to much longer computational time.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>vdj.only</code></td>
<td>
<p>Logical. Defines if only vdj information is provided as input. Default is set to FALSE. If set to TRUE a vdj dataframe has to be provided as input (vgm = vdj). Also, integrate.in.gex is automatically set to FALSE since no gex (vgm[[2]]) information is provided.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>platypus.version</code></td>
<td>
<p>This function works with "v3" only, there is no need to set this parameter.</p>
</td>
</tr>
</table>
<h3>Value</h3>

<p>This function returns a vgm with new sample_id's in case vdj.only is set to FALSE (default). If vdj.only is set to true only the vdj dataframe with new sample_id's is returned.
Note: If vdj.only is set to default (FALSE), VDJ information in the metadata of the GEX object is necessary. For this set integrate.VDJ.to.GEX to TRUE in the VDJ_GEX_matrix function
</p>


<h3>Examples</h3>

<pre><code class="language-R">vgm_expanded_fb &lt;- VGM_expand_featurebarcodes(
vgm = small_vgm[[1]],
by.majority.barcodes = FALSE,
integrate.in.gex=FALSE, vdj.only= TRUE)

vgm_expanded_fb &lt;- VGM_expand_featurebarcodes(
vgm = small_vgm,
by.majority.barcodes = FALSE,
integrate.in.gex=TRUE, vdj.only= FALSE)

vgm_expanded_fb &lt;- VGM_expand_featurebarcodes(vgm = small_vgm,
by.majority.barcodes = TRUE,
integrate.in.gex=TRUE, vdj.only= FALSE)

</code></pre>


</div>