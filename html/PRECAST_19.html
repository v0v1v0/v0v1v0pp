<div class="container">

<table style="width: 100%;"><tr>
<td>ICM.EM_structure</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>ICM-EM algorithm implementation with organized paramters</h2>

<h3>Description</h3>

<p>Efficient data integration as well as  spatial clustering for multiple spatial transcriptomics data
</p>


<h3>Usage</h3>

<pre><code class="language-R">  ICM.EM_structure(XList,  K, AdjList, q=15,parameterList=NULL)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>XList</code></td>
<td>
<p>an M-length list consisting of multiple matrices with class <code>dgCMatrix</code> or <code>matrix</code> that specify the log-normalization gene expression matrix for each data sample used for PRECAST model.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>K</code></td>
<td>
<p>a positive  integer allowing scalar or vector, specify the number of clusters in model fitting.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>AdjList</code></td>
<td>
<p>an M-length list of sparse matrices with class <code>dgCMatrix</code>, specify the adjacency matrix used for Potts model and Intrisic CAR model in PRECAST model. We provide this interface for those users  who would like to define the adjacency matrix by their own.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>q</code></td>
<td>
<p>a positive integer, specify the number of latent features to be extracted, default as 15.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>parameterList</code></td>
<td>
<p>Other arguments in PRECAST model, it can be set by model_set.</p>
</td>
</tr>
</table>
<h3>Details</h3>

<p>Nothing
</p>


<h3>Value</h3>

<p>ICM.EM_structure returns a list with class "SeqK_PRECAST_Object" with the number of components equal to the length of <code>K</code>, where each component includes the model fitting results for one number of cluster and is a list consisting of following components:
</p>
<table>
<tr style="vertical-align: top;">
<td><code>cluster</code></td>
<td>
<p>an M-length list that includes the inferred class labels for each data sample.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>hZ</code></td>
<td>
<p>an M-length list that includes the batch corrected low-dimensional embeddings for each data sample.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>hV</code></td>
<td>
<p>an M-length list that includes the estimate the ICAR component for each sample.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>Rf</code></td>
<td>
<p>an M-length list that includes the posterior probability of domain clusters for each sample.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>beta</code></td>
<td>
<p>an M-length vector that includes the estimated smoothing parameters for each sample.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>Mu</code></td>
<td>
<p>mean vectors of mixtures components.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>Sigma</code></td>
<td>
<p>covariance matrix of mixtures components.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>W</code></td>
<td>
<p>estimated loading matrix</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>Lam</code></td>
<td>
<p>estimated variance of errors in probabilistic PCA model</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>loglik</code></td>
<td>
<p>pseudo observed log-likelihood.</p>
</td>
</tr>
</table>
<h3>Note</h3>

<p>nothing
</p>


<h3>Author(s)</h3>

<p>Wei Liu
</p>


<h3>References</h3>

<p><a href="https://www.nature.com/articles/s41467-023-35947-w">Wei Liu, Liao, X., Luo, Z. et al, Jin Liu* (2023). Probabilistic embedding, clustering, and alignment for integrating spatial transcriptomics data with PRECAST. Nature Communications, 14, 296</a>
</p>


<h3>See Also</h3>

<p>None
</p>


<h3>Examples</h3>

<pre><code class="language-R">
  ## we generate the spatial transcriptomics data with lattice neighborhood, i.e. ST platform.
  library(Matrix)
  q &lt;- 10; K &lt;- 4
  data(PRECASTObj)
  posList &lt;- lapply(PRECASTObj@seulist, function(x) cbind(x$row, x$col))
  AdjList &lt;- lapply(posList, getAdj_reg, platform='ST')
  XList &lt;- lapply(PRECASTObj@seulist, function(x) t(x[['RNA']]@data))
  XList &lt;- lapply(XList, scale, scale=FALSE)
  parList &lt;- model_set(maxIter=4)
  resList &lt;- ICM.EM_structure(XList,  AdjList = AdjList, 
                   q=q, K=K, parameterList=parList)

</code></pre>


</div>