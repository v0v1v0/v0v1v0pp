<div class="container">

<table style="width: 100%;"><tr>
<td>powerscale-overview</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2>Prior/likelihood power-scaling perturbation</h2>

<h3>Description</h3>

<p>Estimate posterior draws based on power-scaling perturbations of
prior or likelihood using importance sampling (and optionally
moment matching).
</p>


<h3>Usage</h3>

<pre><code class="language-R">powerscale(x, ...)

## Default S3 method:
powerscale(
  x,
  component,
  alpha,
  moment_match = FALSE,
  k_threshold = NULL,
  resample = FALSE,
  transform = NULL,
  prediction = NULL,
  variable = NULL,
  selection = NULL,
  ...
)

## S3 method for class 'priorsense_data'
powerscale(
  x,
  component,
  alpha,
  moment_match = FALSE,
  k_threshold = NULL,
  resample = FALSE,
  transform = NULL,
  prediction = NULL,
  variable = NULL,
  selection = NULL,
  ...
)

powerscale_sequence(x, ...)

## Default S3 method:
powerscale_sequence(
  x,
  lower_alpha = 0.8,
  upper_alpha = 1/lower_alpha,
  length = 3,
  variable = NULL,
  component = c("prior", "likelihood"),
  moment_match = FALSE,
  k_threshold = 0.5,
  resample = FALSE,
  transform = NULL,
  prediction = NULL,
  auto_alpha_range = FALSE,
  symmetric = TRUE,
  prior_selection = NULL,
  likelihood_selection = NULL,
  ...
)

## S3 method for class 'priorsense_data'
powerscale_sequence(
  x,
  lower_alpha = 0.8,
  upper_alpha = 1/lower_alpha,
  length = 3,
  variable = NULL,
  component = c("prior", "likelihood"),
  moment_match = FALSE,
  k_threshold = 0.5,
  resample = FALSE,
  transform = NULL,
  prediction = NULL,
  auto_alpha_range = FALSE,
  symmetric = TRUE,
  prior_selection = NULL,
  likelihood_selection = NULL,
  ...
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;">
<td><code>x</code></td>
<td>
<p>A fitted model object.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>...</code></td>
<td>
<p>Further arguments passed to internal functions.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>component</code></td>
<td>
<p>Component to be power-scaled (either "prior" or
"likelihood"). For powerscale_sequence, this can be both "prior"
and "likelihood".</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>alpha</code></td>
<td>
<p>Value by which to power-scale specified
component. (likelihood/prior).</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>moment_match</code></td>
<td>
<p>Logical; Indicate whether or not moment
matching should be performed. Can only be TRUE if <code>is_method</code> is
"psis".</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>k_threshold</code></td>
<td>
<p>Threshold value for Pareto k values above which
the moment matching algorithm is used. Default is 0.5.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>resample</code></td>
<td>
<p>Logical; Indicate whether or not draws should be
resampled based on calculated importance weights.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>transform</code></td>
<td>
<p>Indicate a transformation of posterior draws to
perform before sensitivity analysis. Either "scale" or "whiten".</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>prediction</code></td>
<td>
<p>Function taking the model fit and returning a
draws_df of predictions to be appended to the posterior draws</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>variable</code></td>
<td>
<p>Vector of variable names to return estimated
posterior draws for. If <code>NULL</code> all variables will be included.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>selection</code></td>
<td>
<p>Numeric vector specifying partitions of component
to be included in power-scaling. Default is NULL, which takes
all partitions.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>lower_alpha</code></td>
<td>
<p>Lower power-scaling alpha value in sequence.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>upper_alpha</code></td>
<td>
<p>Upper power-scaling alpha value in sequence.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>length</code></td>
<td>
<p>Length of alpha sequence.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>auto_alpha_range</code></td>
<td>
<p>Boolean. Restrict range to ensure Pareto-k
values below threshold?</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>symmetric</code></td>
<td>
<p>Boolean. Should the alpha range be symmetrical
around alpha = 1, on log-space?</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>prior_selection</code></td>
<td>
<p>Numeric vector of prior partitions to include in power-scaling. Default is NULL, which takes all partitions.</p>
</td>
</tr>
<tr style="vertical-align: top;">
<td><code>likelihood_selection</code></td>
<td>
<p>Numeric vector of likelihood partitions to include in power-scaling. Default is NULL, which takes all partitions.</p>
</td>
</tr>
</table>
<h3>Value</h3>

<p>A <code>powerscaled_draws</code> or <code>powerscaled_sequence</code> object,
which contains the estimated posterior draws resulting from the
power-scaling perturbations and details of the perturbation and
estimation methods.
</p>


<h3>References</h3>

<p>Kallioinen, N., Paananen, T., Bürkner, P-C., Vehtari, A. (2023).
Detecting and diagnosing prior and likelihood sensitivity with
power-scaling perturbations.  <em>Statistics and
Computing</em>. 34(57).  <code>doi:10.1007/s11222-023-10366-5</code>
</p>
<p>Vehtari, A., Simpson, D., Gelman, A., Yao, Y., and Gabry,
J. (2024).  Pareto smoothed importance sampling. <em>Journal of
Machine Learning Research</em>. 25(72).
<code>https://jmlr.org/papers/v25/19-556.html</code>
</p>
<p>Paananen, T., Piironen, J., Bürkner, P-C., Vehtari, A. (2021).
Implicitly adaptive importance sampling.  <em>Statistics and
Computing</em>. 31(16).  <code>doi:10.1007/s11222-020-09982-2</code>
</p>


<h3>Examples</h3>

<pre><code class="language-R">ex &lt;- example_powerscale_model()

powerscale(ex$draws, component = "prior", alpha = 0.5)

powerscale_sequence(ex$draws)
</code></pre>


</div>